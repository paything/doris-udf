{"version":3,"sources":["../src/transforms/data/map.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,KAAK,EAAE,MAAM,kBAAkB,CAAC;AAGzC,MAAM,CAAC,MAAM,SAAS,GAAG,CAAC,OAA2B,EAAE,YAAmB,EAAE,MAAY,EAAE,EAAE;IAC1F,MAAM,IAAI,GAAG,OAAO,CAAC,QAAQ,CAAC;IAC9B,MAAM,EAAE,GAAG,OAAO,CAAC,EAAE,CAAC;IAEtB,IAAI,CAAC,OAAO,CAAC,GAAG,EAAE;QAChB,YAAY,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE;YAC3B,MAAM,IAAI,GAAG,IAAI,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;YAEjC,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,EAAE;gBACd,IAAI,KAAK,CAAC,KAAK,CAAC,EAAE;oBAChB,OAAO;iBACR;gBACD,KAAK,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC;aAClB;YAED,OAAO,IAAI,CAAC;QACd,CAAC,CAAC,CAAC;QAEH,OAAO,YAAY,CAAC;KACrB;IACD,MAAM,IAAI,GAAG,IAAI,CAAC,YAAY,EAAE,MAAM,CAAC,CAAC;IAExC,IAAI,KAAK,CAAC,EAAE,CAAC,IAAI,KAAK,CAAC,YAAY,CAAC,EAAE;QACpC,OAAO,IAAI,CAAC;KACb;IAEA,YAAoB,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC;IAEjC,OAAO,YAAY,CAAC;AACtB,CAAC,CAAC","file":"map.js","sourcesContent":["import { isNil } from '@visactor/vutils';\nimport type { MapTransformOption } from '../../types';\n\nexport const transform = (options: MapTransformOption, upstreamData: any[], params?: any) => {\n  const func = options.callback;\n  const as = options.as;\n\n  if (!options.all) {\n    upstreamData.forEach(entry => {\n      const data = func(entry, params);\n\n      if (!isNil(as)) {\n        if (isNil(entry)) {\n          return;\n        }\n        entry[as] = data;\n      }\n\n      return data;\n    });\n\n    return upstreamData;\n  }\n  const data = func(upstreamData, params);\n\n  if (isNil(as) || isNil(upstreamData)) {\n    return data;\n  }\n\n  (upstreamData as any)[as] = data;\n\n  return upstreamData;\n};\n"]}