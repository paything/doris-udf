{"version":3,"sources":["../src/transforms/view/identifier.ts"],"names":[],"mappings":";;;AASA,6CAAyC;AAGzC,MAAM,YAAY,GAAG,uBAAuB,CAAC;AAEtC,MAAM,SAAS,GAAG,CAAC,OAAmC,EAAE,YAAmB,EAAE,MAAW,EAAE,IAAY,EAAE,EAAE;IAC/G,IAAI,IAAA,cAAK,EAAC,IAAI,CAAC,YAAY,CAAC,CAAC,EAAE;QAC7B,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC;KACxB;IAED,IAAI,EAAE,GAAG,IAAI,CAAC,YAAY,CAAC,CAAC;IAC5B,MAAM,EAAE,GAAG,OAAO,CAAC,EAAE,CAAC;IAEtB,YAAY,CAAC,OAAO,CAAC,CAAC,KAAU,EAAE,EAAE;QAClC,IAAI,KAAK,IAAI,IAAA,cAAK,EAAC,KAAK,CAAC,EAAE,CAAC,CAAC,EAAE;YAC7B,EAAE,IAAI,CAAC,CAAC;YACR,KAAK,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC;SAChB;IACH,CAAC,CAAC,CAAC;IACH,IAAI,CAAC,YAAY,CAAC,GAAG,EAAE,CAAC;IAExB,OAAO,EAAE,CAAC;AACZ,CAAC,CAAC;AAjBW,QAAA,SAAS,aAiBpB","file":"identifier.js","sourcesContent":["/* Adapted from vega by University of Washington Interactive Data Lab\n * https://vega.github.io/vega/\n * Licensed under the BSD-3-Clause\n\n * url: https://github.com/vega/vega/blob/main/packages/vega-view-transforms/src/Identifier.js\n * License: https://github.com/vega/vega/blob/main/LICENSE\n * @license\n */\n\nimport { isNil } from '@visactor/vutils';\nimport type { IView, IdentifierTransformOptions } from './../../types/';\n\nconst COUNTER_NAME = ':vGrammar_identifier:';\n\nexport const transform = (options: IdentifierTransformOptions, upstreamData: any[], params: any, view?: IView) => {\n  if (isNil(view[COUNTER_NAME])) {\n    view[COUNTER_NAME] = 0;\n  }\n\n  let id = view[COUNTER_NAME];\n  const as = options.as;\n\n  upstreamData.forEach((entry: any) => {\n    if (entry && isNil(entry[as])) {\n      id += 1;\n      entry[as] = id;\n    }\n  });\n  view[COUNTER_NAME] = id;\n\n  return id;\n};\n"]}