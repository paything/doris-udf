{"version":3,"sources":["../src/scenegraph/group-creater/cell-type/video-cell.ts"],"names":[],"mappings":"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","file":"video-cell.js","sourcesContent":["/* eslint-disable no-undef */\nimport type { Cursor, IImage, IThemeSpec } from './../../../vrender';\nimport { createRect, createImage } from './../../../vrender';\nimport * as icons from '../../../icons';\nimport { Group } from '../../graphic/group';\nimport { calcKeepAspectRatioSize } from '../../utils/keep-aspect-ratio';\nimport { Icon } from '../../graphic/icon';\nimport { calcStartPosition } from '../../utils/cell-pos';\nimport { _adjustWidthHeight, getCellRange, updateImageDxDy } from './image-cell';\nimport { getFunctionalProp, getProp } from '../../utils/get-prop';\nimport { isValid } from '@visactor/vutils';\nimport type { BaseTableAPI } from '../../../ts-types/base-table';\nimport { getCellBorderStrokeWidth } from '../../utils/cell-border-stroke-width';\nimport { getQuadProps } from '../../utils/padding';\nimport type { CellRange } from '../../../ts-types';\nimport { dealWithIconLayout } from '../../utils/text-icon-layout';\n\nconst regedIcons = icons.get();\n\nexport function createVideoCellGroup(\n  columnGroup: Group,\n  xOrigin: number,\n  yOrigin: number,\n  col: number,\n  row: number,\n  width: number,\n  height: number,\n  keepAspectRatio: boolean,\n  imageAutoSizing: boolean,\n  padding: [number, number, number, number],\n  textAlign: CanvasTextAlign,\n  textBaseline: CanvasTextBaseline,\n  mayHaveIcon: boolean,\n  table: BaseTableAPI,\n  cellTheme: IThemeSpec,\n  range: CellRange | undefined,\n  isAsync: boolean\n) {\n  const headerStyle = table._getCellStyle(col, row); // to be fixed\n  const functionalPadding = getFunctionalProp('padding', headerStyle, col, row, table);\n  // const margin = getProp('padding', headerStyle, col, row, table);\n  if (table.options.customConfig?.imageMargin) {\n    padding = getQuadProps(table.options.customConfig?.imageMargin);\n  } else if (isValid(functionalPadding)) {\n    padding = functionalPadding;\n  }\n  if (cellTheme?.text?.textAlign) {\n    textAlign = cellTheme?.text?.textAlign;\n  }\n  if (cellTheme?.text?.textBaseline) {\n    textBaseline = cellTheme?.text?.textBaseline;\n  }\n\n  // cell\n  const strokeArrayWidth = getCellBorderStrokeWidth(col, row, cellTheme, table);\n\n  let cellGroup: Group;\n  if (isAsync) {\n    cellGroup = table.scenegraph.highPerformanceGetCell(col, row, true);\n    if (cellGroup && cellGroup.role === 'cell') {\n      cellGroup.setAttributes({\n        x: xOrigin,\n        y: yOrigin,\n        width,\n        height,\n        // 背景相关，cell背景由cellGroup绘制\n        lineWidth: cellTheme?.group?.lineWidth ?? undefined,\n        fill: cellTheme?.group?.fill ?? undefined,\n        stroke: cellTheme?.group?.stroke ?? undefined,\n        strokeArrayWidth: strokeArrayWidth,\n        strokeArrayColor: (cellTheme?.group as any)?.strokeArrayColor ?? undefined,\n        cursor: (cellTheme?.group as any)?.cursor ?? undefined,\n        lineDash: cellTheme?.group?.lineDash ?? undefined,\n        lineCap: 'butt',\n        clip: true,\n        cornerRadius: cellTheme.group.cornerRadius\n      } as any);\n    }\n  }\n  if (!cellGroup || cellGroup.role !== 'cell') {\n    cellGroup = new Group({\n      x: xOrigin,\n      y: yOrigin,\n      width,\n      height,\n      // 背景相关，cell背景由cellGroup绘制\n      lineWidth: cellTheme?.group?.lineWidth ?? undefined,\n      fill: cellTheme?.group?.fill ?? undefined,\n      stroke: cellTheme?.group?.stroke ?? undefined,\n      strokeArrayWidth: strokeArrayWidth,\n      strokeArrayColor: (cellTheme?.group as any)?.strokeArrayColor ?? undefined,\n      cursor: (cellTheme?.group as any)?.cursor ?? undefined,\n      lineDash: cellTheme?.group?.lineDash ?? undefined,\n      lineCap: 'butt',\n      clip: true,\n      cornerRadius: cellTheme.group.cornerRadius\n    } as any);\n    cellGroup.role = 'cell';\n    cellGroup.col = col;\n    cellGroup.row = row;\n    columnGroup?.addCellGroup(cellGroup);\n  }\n\n  let cellIcons;\n  if (mayHaveIcon) {\n    let iconCol = col;\n    let iconRow = row;\n    if (range) {\n      iconCol = range.start.col;\n      iconRow = range.start.row;\n    }\n    cellIcons = table.getCellIcons(iconCol, iconRow);\n  }\n\n  let iconWidth = 0;\n  let cellLeftIconWidth = 0;\n  let cellRightIconWidth = 0;\n  if (Array.isArray(cellIcons) && cellIcons.length !== 0) {\n    const { leftIconWidth, rightIconWidth, absoluteLeftIconWidth, absoluteRightIconWidth } = dealWithIconLayout(\n      cellIcons,\n      cellGroup,\n      range,\n      table\n    );\n\n    iconWidth = leftIconWidth + rightIconWidth;\n    cellLeftIconWidth = leftIconWidth;\n    cellRightIconWidth = rightIconWidth;\n\n    // 更新各个部分横向位置\n    cellGroup.forEachChildren((child: any) => {\n      if (child.role === 'icon-left') {\n        child.setAttribute('x', child.attribute.x + padding[3]);\n      } else if (child.role === 'icon-right') {\n        child.setAttribute('x', child.attribute.x + width - rightIconWidth - padding[1]);\n      } else if (child.role === 'icon-absolute-right') {\n        child.setAttribute('x', child.attribute.x + width - absoluteRightIconWidth - padding[1]);\n      }\n    });\n\n    // 更新各个部分纵向位置\n    cellGroup.forEachChildren((child: any) => {\n      if (textBaseline === 'middle') {\n        child.setAttribute('y', (height - child.AABBBounds.height()) / 2);\n      } else if (textBaseline === 'bottom') {\n        child.setAttribute('y', height - child.AABBBounds.height() - padding[2]);\n      } else {\n        child.setAttribute('y', padding[0]);\n      }\n    });\n\n    (cellGroup as any)._cellLeftIconWidth = cellLeftIconWidth;\n    (cellGroup as any)._cellRightIconWidth = cellRightIconWidth;\n  }\n\n  // video\n  const value = table.getCellValue(col, row);\n  const video = document.createElement('video');\n  video.addEventListener('loadeddata', (): void => {\n    if (imageAutoSizing) {\n      _adjustWidthHeight(col, row, video.videoWidth, video.videoHeight, table.scenegraph, padding, cellGroup);\n    }\n    // const width = cellGroup.attribute.width;\n    // const height = cellGroup.attribute.height;\n    // 更新宽高\n    const { width: cellWidth, height: cellHeight, isMerge } = getCellRange(cellGroup, table);\n    if (keepAspectRatio) {\n      const { width: videoWidth, height: videoHeight } = calcKeepAspectRatioSize(\n        video.videoWidth,\n        video.videoHeight,\n        cellWidth - padding[1] - padding[3],\n        cellHeight - padding[0] - padding[2]\n      );\n      const pos = calcStartPosition(\n        0,\n        0,\n        cellWidth,\n        cellHeight,\n        videoWidth,\n        videoHeight,\n        textAlign,\n        textBaseline,\n        padding\n      );\n\n      image.setAttributes({\n        width: videoWidth,\n        height: videoHeight,\n        x: pos.x,\n        y: pos.y,\n        dx: 0\n      });\n    } else {\n      // const { width: cellWidth, height: cellHeight } = getCellRange(cellGroup, table);\n      image.setAttributes({\n        x: padding[3],\n        y: padding[0],\n        width: cellWidth - padding[1] - padding[3],\n        height: cellHeight - padding[2] - padding[0],\n        dy: 0\n      });\n    }\n\n    if (isMerge) {\n      updateImageDxDy(\n        cellGroup.mergeStartCol,\n        cellGroup.mergeEndCol,\n        cellGroup.mergeStartRow,\n        cellGroup.mergeEndRow,\n        table\n      );\n    }\n\n    const left = 0;\n    const top = 0;\n    // 播放按钮\n    // const iconSize = Math.floor(Math.min(width - padding[1] - padding[3], height - padding[2] - padding[0]) / 2);\n    // const anchorX =\n    //   left + (width > image.attribute.width ? image.attribute.x - left + image.attribute.width / 2 : width / 2);\n    // const anchorY =\n    //   top + (height > image.attribute.height ? image.attribute.y - top + image.attribute.height / 2 : height / 2);\n    const { width, height } = getCellRange(cellGroup, table);\n    const iconSize = Math.floor(Math.min(width - padding[1] - padding[3], height - padding[2] - padding[0]) / 2);\n    const anchorX =\n      left + (width > image.attribute.width ? image.attribute.x - left + image.attribute.width / 2 : width / 2);\n    const anchorY =\n      top + (height > image.attribute.height ? image.attribute.y - top + image.attribute.height / 2 : height / 2);\n\n    // get dx dy of image graphic for merge cell\n    const imageGraphic = cellGroup.getChildByName('image', true);\n    const { dx, dy } = imageGraphic.attribute;\n\n    const playIcon: Icon = new Icon({\n      x: anchorX - iconSize / 2,\n      y: anchorY - iconSize / 2,\n      width: iconSize,\n      height: iconSize,\n      image: (regedIcons.play as any).svg,\n      cursor: (regedIcons.play as any).cursor,\n      dx,\n      dy\n    });\n    playIcon.name = 'play-icon';\n    cellGroup.appendChild(playIcon);\n    // 触发重绘\n    table.scenegraph.updateNextFrame();\n  });\n  video.onerror = (): void => {\n    // image.setAttribute('image', (regedIcons.damage_pic as any).svg);\n    (image as any).image = (regedIcons.damage_pic as any).svg;\n  };\n  video.src = value;\n  video.setAttribute('preload', 'auto');\n\n  const image: IImage = createImage({\n    x: padding[3],\n    y: padding[0],\n    width: width - padding[1] - padding[3],\n    height: height - padding[2] - padding[0],\n    image: video as any,\n    cursor: 'pointer' as Cursor\n  });\n  image.name = 'image';\n  image.keepAspectRatio = keepAspectRatio;\n  image.textAlign = textAlign;\n  image.textBaseline = textBaseline;\n  cellGroup.appendChild(image);\n\n  return cellGroup;\n}\n\nexport type CreateVideoCellGroup = typeof createVideoCellGroup;\n"]}