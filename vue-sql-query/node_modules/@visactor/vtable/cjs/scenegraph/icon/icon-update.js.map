{"version":3,"sources":["../src/scenegraph/icon/icon-update.ts"],"names":[],"mappings":"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","file":"icon-update.js","sourcesContent":["import { isValid } from '@visactor/vutils';\nimport type { Group } from '../graphic/group';\nimport type { Scenegraph } from '../scenegraph';\nimport type { ColumnIconOption, SortOrder, SvgIcon } from '../../ts-types';\nimport { IconFuncTypeEnum } from '../../ts-types';\nimport type { Icon } from '../graphic/icon';\nimport type { TooltipOptions } from '../../ts-types/tooltip';\nimport type { IRect } from './../../vrender';\nimport { IContainPointMode, createRect } from './../../vrender';\nimport { dealWithIcon } from '../utils/text-icon-layout';\nimport type { BaseTableAPI } from '../../ts-types/base-table';\nimport { getCellMergeRange } from '../../tools/merge-range';\nimport { traverseObject } from '../../tools/util';\n\nexport function hideHoverIcon(col: number, row: number, scene: Scenegraph) {\n  if (col === -1 || row === -1) {\n    return;\n  }\n  // const cellGroup = scene.getCell(col, row);\n  // hideIcon(scene, cellGroup, 'mouseenter_cell');\n\n  // hideIcon\n  updateCellRangeIcon(\n    col,\n    row,\n    (icon: Icon) => icon.attribute.visibleTime === 'mouseenter_cell',\n    (icon: Icon) => {\n      icon.setAttribute('opacity', 0);\n\n      const iconBack = icon.parent.getChildByName('icon-back') as IRect;\n      if (iconBack) {\n        iconBack.setAttribute('visible', false);\n      }\n    },\n    scene\n  );\n  scene.updateNextFrame();\n}\n\nexport function showHoverIcon(col: number, row: number, scene: Scenegraph) {\n  if (col === -1 || row === -1) {\n    return;\n  }\n  // const cellGroup = scene.getCell(col, row);\n  // showIcon(scene, cellGroup, 'mouseenter_cell');\n\n  // showIcon\n  updateCellRangeIcon(\n    col,\n    row,\n    (icon: Icon) => icon.attribute.visibleTime === 'mouseenter_cell',\n    (icon: Icon) => {\n      icon.setAttribute('opacity', 1);\n    },\n    scene\n  );\n  scene.updateNextFrame();\n}\n\nexport function hideClickIcon(col: number, row: number, scene: Scenegraph) {\n  if (col === -1 || row === -1) {\n    return;\n  }\n  // const cellGroup = scene.getCell(col, row);\n  // hideIcon(scene, cellGroup, 'click_cell');\n\n  // hideIcon\n  updateCellRangeIcon(\n    col,\n    row,\n    (icon: Icon) => icon.attribute.visibleTime === 'click_cell',\n    (icon: Icon) => {\n      icon.setAttribute('opacity', 0);\n    },\n    scene\n  );\n  scene.updateNextFrame();\n}\n\nexport function showClickIcon(col: number, row: number, scene: Scenegraph) {\n  if (col === -1 || row === -1) {\n    return;\n  }\n  // const cellGroup = scene.getCell(col, row);\n  // showIcon(scene, cellGroup, 'click_cell');\n\n  // showIcon\n  updateCellRangeIcon(\n    col,\n    row,\n    (icon: Icon) => icon.attribute.visibleTime === 'click_cell',\n    (icon: Icon) => {\n      icon.setAttribute('opacity', 1);\n    },\n    scene\n  );\n  scene.updateNextFrame();\n}\n\n/**\n * @description: 获取指定单元格指定位置的icon mark\n * @param {number} col\n * @param {number} row\n * @param {number} x\n * @param {number} y\n * @return {*}\n */\nexport function getIconByXY(col: number, row: number, x: number, y: number, scene: Scenegraph): Icon | undefined {\n  const cellGroup = scene.getCell(col, row);\n  let pickMark;\n  cellGroup.forEachChildren((mark: Icon) => {\n    if (mark.role && mark.role.startsWith('icon') && mark.containsPoint(x, y, IContainPointMode.GLOBAL)) {\n      pickMark = mark;\n    }\n  });\n  return pickMark;\n}\n\n/**\n * @description: 将指定icon mark设置为Hover样式\n * @param {Icon} icon\n * @param {number} col\n * @param {number} row\n * @return {*}\n */\nexport function setIconHoverStyle(baseIcon: Icon, col: number, row: number, cellGroup: Group, scene: Scenegraph) {\n  if (baseIcon.attribute.backgroundColor || baseIcon.attribute.hoverImage) {\n    updateCellRangeIcon(\n      col,\n      row,\n      // filter\n      (icon: Icon) => icon.name === baseIcon.name,\n      (icon: Icon) => {\n        // hover展示背景\n        if (icon.attribute.backgroundColor) {\n          let iconBack = icon.parent.getChildByName('icon-back') as IRect;\n          if (iconBack) {\n            iconBack.setAttributes({\n              x:\n                (icon.attribute.x ?? 0) +\n                // (icon.attribute.dx ?? 0) +\n                (icon.AABBBounds.width() - icon.backgroundWidth) / 2,\n              y: (icon.attribute.y ?? 0) + (icon.AABBBounds.height() - icon.backgroundHeight) / 2,\n              dx: icon.attribute.dx ?? 0,\n              dy: icon.attribute.dy ?? 0,\n              width: icon.backgroundWidth,\n              height: icon.backgroundHeight,\n              fill: icon.attribute.backgroundColor,\n              cornerRadius: 5,\n              visible: true\n            });\n          } else {\n            iconBack = createRect({\n              x:\n                (icon.attribute.x ?? 0) +\n                // (icon.attribute.dx ?? 0) +\n                (icon.AABBBounds.width() - icon.backgroundWidth) / 2,\n              y: (icon.attribute.y ?? 0) + (icon.AABBBounds.height() - icon.backgroundHeight) / 2,\n              dx: icon.attribute.dx ?? 0,\n              dy: icon.attribute.dy ?? 0,\n              width: icon.backgroundWidth,\n              height: icon.backgroundHeight,\n              fill: icon.attribute.backgroundColor,\n              cornerRadius: 5,\n              pickable: false,\n              visible: true\n            }) as IRect;\n            iconBack.name = 'icon-back';\n            // cellGroup.appendChild(iconBack);\n          }\n          icon.parent.insertBefore(iconBack, icon);\n        }\n\n        // hover更换图片\n        if (icon.attribute.hoverImage && icon.attribute.image !== icon.attribute.hoverImage) {\n          icon.image = icon.attribute.hoverImage;\n        }\n      },\n      scene\n    );\n  }\n  // hover展示tooltip\n  if (baseIcon.tooltip) {\n    const { x1: left, x2: right, y1: top, y2: bottom } = baseIcon.globalAABBBounds;\n    const tooltipOptions: TooltipOptions = {\n      content: baseIcon.tooltip.title,\n      referencePosition: {\n        rect: {\n          left: left,\n          right: right,\n          top: top,\n          bottom: bottom,\n          width: baseIcon.globalAABBBounds.width(),\n          height: baseIcon.globalAABBBounds.height()\n        },\n        placement: baseIcon.tooltip.placement\n      },\n      disappearDelay: baseIcon.tooltip.disappearDelay,\n      style: Object.assign({}, scene.table.internalProps.theme?.tooltipStyle, baseIcon.tooltip?.style)\n    };\n    if (!scene.table.internalProps.tooltipHandler.isBinded(tooltipOptions)) {\n      scene.table.showTooltip(col, row, tooltipOptions);\n    }\n  }\n}\n\n/**\n * @description: 将指定icon mark设置为Normal样式\n * @param {Icon} icon\n * @param {number} col\n * @param {number} row\n * @return {*}\n */\nexport function setIconNormalStyle(baseIcon: Icon, col: number, row: number, scene: Scenegraph) {\n  if (baseIcon.attribute.backgroundColor || baseIcon.attribute.hoverImage) {\n    updateCellRangeIcon(\n      col,\n      row,\n      // filter\n      (icon: Icon) => icon.name === baseIcon.name,\n      (icon: Icon) => {\n        const iconBack = icon.parent.getChildByName('icon-back') as IRect;\n        if (iconBack) {\n          iconBack.setAttribute('visible', false);\n        }\n\n        // hover更换图片\n        if (icon.attribute.hoverImage && icon.attribute.image !== icon.attribute.originImage) {\n          icon.image = icon.attribute.originImage;\n        }\n      },\n      scene\n    );\n  }\n}\n\nexport function updateIcon(baseIcon: Icon, iconConfig: ColumnIconOption, col: number, row: number, scene: Scenegraph) {\n  // 直接更新mark attribute\n  // dealWithIcon(iconConfig, icon);\n  // icon.name = iconConfig.name;\n  // scene.updateNextFrame();\n  const iconName = baseIcon.name;\n  updateCellRangeIcon(\n    col,\n    row,\n    // filter\n    (icon: Icon) => icon.name === iconName,\n    // dealer\n    (icon: Icon) => {\n      dealWithIcon(iconConfig, icon);\n      icon.name = iconConfig.name;\n    },\n    scene\n  );\n\n  scene.updateNextFrame();\n}\n\nfunction resetSortIcon(oldSortCol: number, oldSortRow: number, iconConfig: ColumnIconOption, scene: Scenegraph) {\n  const oldSortCell = scene.getCell(oldSortCol, oldSortRow);\n\n  if (\n    isValid(oldSortCell.mergeStartCol) &&\n    isValid(oldSortCell.mergeStartRow) &&\n    isValid(oldSortCell.mergeEndCol) &&\n    isValid(oldSortCell.mergeEndRow)\n  ) {\n    for (let col = oldSortCell.mergeStartCol; col <= oldSortCell.mergeEndCol; col++) {\n      for (let row = oldSortCell.mergeStartRow; row <= oldSortCell.mergeEndRow; row++) {\n        let oldIconMark: Icon;\n        scene.getCell(col, row).forEachChildren((mark: Icon) => {\n          if (mark.attribute.funcType === 'sort') {\n            oldIconMark = mark;\n            return true;\n          }\n          return false;\n        });\n        if (oldIconMark) {\n          dealWithIcon(iconConfig, oldIconMark);\n          oldIconMark.name = iconConfig.name;\n        }\n      }\n    }\n  } else {\n    let oldIconMark: Icon;\n\n    //oldSortCell.forEachChildren((mark: Icon) => {\n    traverseObject(oldSortCell, 'children', (mark: Icon) => {\n      if (mark.attribute.funcType === 'sort') {\n        oldIconMark = mark;\n        return true;\n      }\n      return false;\n    });\n\n    if (oldIconMark) {\n      // updateIcon(oldIconMark, oldIcon);\n      dealWithIcon(iconConfig, oldIconMark);\n      oldIconMark.name = iconConfig.name;\n    }\n  }\n}\n\nfunction checkSameCell(col1: number, row1: number, col2: number, row2: number, table: BaseTableAPI) {\n  const range1 = table.getCellRange(col1, row1);\n  const range2 = table.getCellRange(col2, row2);\n  if (\n    range1.start.col === range2.start.col &&\n    range1.start.row === range2.start.row &&\n    range1.end.col === range2.end.col &&\n    range1.end.row === range2.end.row\n  ) {\n    return true;\n  }\n  return false;\n}\n\nexport function updateSortIcon(options: {\n  col: number;\n  row: number;\n  iconMark: Icon;\n  order: SortOrder;\n  oldSortCol: number;\n  oldSortRow: number;\n  oldIconMark: Icon | undefined;\n  scene: Scenegraph;\n}) {\n  const { col, row, iconMark, order, oldSortCol, oldSortRow, oldIconMark, scene } = options;\n  // 更新icon\n  const icon = scene.table.internalProps.headerHelper.getSortIcon(order, scene.table, col, row);\n  if (iconMark) {\n    updateIcon(iconMark, icon, col, row, scene);\n  }\n\n  // 更新旧frozen icon\n  if (!checkSameCell(col, row, oldSortCol, oldSortRow, scene.table)) {\n    const oldIcon = scene.table.internalProps.headerHelper.getSortIcon('normal', scene.table, oldSortCol, oldSortRow);\n    if (oldIconMark) {\n      updateIcon(oldIconMark, oldIcon, oldSortCol, oldSortRow, scene);\n    } else {\n      resetSortIcon(oldSortCol, oldSortRow, oldIcon, scene);\n    }\n  }\n}\n\nexport function updateFrozenIcon(scene: Scenegraph) {\n  // 依据新旧冻结列确定更新范围\n  for (let col = 0; col < scene.table.colCount; col++) {\n    for (let row = 0; row < scene.table.columnHeaderLevelCount; row++) {\n      updateCellRangeIcon(\n        col,\n        row,\n        // filter\n        (icon: Icon) => icon.attribute.funcType === 'frozen',\n        // dealer\n        (icon: Icon) => {\n          const iconConfig = scene.table.internalProps.headerHelper.getFrozenIcon(col, row);\n          dealWithIcon(iconConfig, icon);\n          icon.name = iconConfig.name;\n        },\n        scene\n      );\n    }\n  }\n}\n\nexport function updateHierarchyIcon(col: number, row: number, scene: Scenegraph) {\n  let iconConfig: SvgIcon;\n  if (scene.table.isHeader(col, row)) {\n    iconConfig = scene.table.internalProps.headerHelper.getHierarchyIcon(col, row);\n  } else {\n    iconConfig = scene.table.internalProps.bodyHelper.getHierarchyIcon(col, row);\n  }\n\n  updateCellRangeIcon(\n    col,\n    row,\n    // filter\n    (icon: Icon) =>\n      icon.attribute.funcType === IconFuncTypeEnum.collapse || icon.attribute.funcType === IconFuncTypeEnum.expand,\n    // dealer\n    (icon: Icon) => {\n      dealWithIcon(iconConfig, icon);\n      icon.name = iconConfig.name;\n    },\n    scene\n  );\n}\n\nexport function updateCellGroupIcon(cellGroup: Group, filter: (icon: Icon) => boolean, dealer: (icon: Icon) => void) {\n  if (!cellGroup || cellGroup.role === 'empty') {\n    return;\n  }\n  cellGroup.forEachChildren((child: any) => {\n    if (child.type === 'group') {\n      updateCellGroupIcon(child, filter, dealer);\n    } else if (filter(child)) {\n      dealer(child);\n    }\n  });\n}\n\nexport function updateCellRangeIcon(\n  col: number,\n  row: number,\n  filter: (icon: Icon) => boolean,\n  dealer: (icon: Icon) => void,\n  scene: Scenegraph\n) {\n  const cellGroup = scene.getCell(col, row);\n  if (\n    cellGroup.role === 'cell' &&\n    isValid(cellGroup.mergeStartCol) &&\n    isValid(cellGroup.mergeStartRow) &&\n    isValid(cellGroup.mergeEndCol) &&\n    isValid(cellGroup.mergeEndRow)\n  ) {\n    const { colStart, colEnd, rowStart, rowEnd } = getCellMergeRange(cellGroup, scene);\n    for (let col = colStart; col <= colEnd; col++) {\n      for (let row = rowStart; row <= rowEnd; row++) {\n        updateCellGroupIcon(scene.highPerformanceGetCell(col, row), filter, dealer);\n      }\n    }\n  } else {\n    updateCellGroupIcon(cellGroup, filter, dealer);\n  }\n}\n\nexport function residentHoverIcon(col: number, row: number, scene: Scenegraph) {\n  updateCellRangeIcon(\n    col,\n    row,\n    // filter\n    (icon: Icon) => icon.attribute.funcType === IconFuncTypeEnum.dropDown,\n    // dealer\n    (icon: Icon) => {\n      (icon as any).oldVisibleTime = icon.attribute.visibleTime;\n      icon.setAttribute('visibleTime', 'always');\n      icon.setAttribute('opacity', 1);\n    },\n    scene\n  );\n}\n\nexport function resetResidentHoverIcon(col: number, row: number, scene: Scenegraph) {\n  updateCellRangeIcon(\n    col,\n    row,\n    // filter\n    (icon: Icon) => icon.attribute.funcType === IconFuncTypeEnum.dropDown,\n    // dealer\n    (icon: Icon) => {\n      (icon as any).oldVisibleTime && icon.setAttribute('visibleTime', (icon as any).oldVisibleTime);\n      icon.setAttribute('opacity', icon.attribute.visibleTime === 'always' ? 1 : 0);\n    },\n    scene\n  );\n}\n"]}