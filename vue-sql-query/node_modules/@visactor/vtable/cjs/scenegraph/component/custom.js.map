{"version":3,"sources":["../src/scenegraph/component/custom.ts"],"names":[],"mappings":"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","file":"custom.js","sourcesContent":["import type { Cursor, ITimeline, Timeline } from './../../vrender';\nimport {\n  createArc,\n  createCircle,\n  createLine,\n  createRect,\n  REACT_TO_CANOPUS_EVENTS,\n  Text,\n  Group as VGroup\n} from './../../vrender';\nimport { isArray, isFunction, isObject, isString, isValid } from '@visactor/vutils';\nimport type {\n  CellRange,\n  ICustomLayout,\n  ICustomRender,\n  ICustomRenderElement,\n  ICustomRenderElements,\n  RectElement\n} from '../../ts-types';\nimport { Icon } from '../graphic/icon';\nimport type { BaseTableAPI } from '../../ts-types/base-table';\nimport type { percentCalcObj } from '../../render/layout';\nimport { emptyCustomLayout } from '../../components/react/react-custom-layout';\nimport { getTargetCell } from '../../event/util';\nimport type { Group } from '../graphic/group';\n\nexport const CUSTOM_MERGE_PRE_NAME = '_custom_';\nexport const CUSTOM_CONTAINER_NAME = 'custom-container';\nexport const CUSTOM_MERGE_CONTAINER_NAME = CUSTOM_MERGE_PRE_NAME + '_0';\n\nexport function dealWithCustom(\n  customLayout: ICustomLayout,\n  customRender: ICustomRender,\n  col: number,\n  row: number,\n  width: number,\n  height: number,\n  autoWidth: boolean,\n  autoHeight: boolean,\n  padding: [number, number, number, number],\n  range: CellRange | undefined,\n  table: BaseTableAPI\n) {\n  let renderDefault = true;\n  let enableCellPadding = false;\n  let expectedWidth: number;\n  let expectedHeight: number;\n  let customElements;\n  let elementsGroup: VGroup;\n\n  if (customLayout === 'react-custom-layout') {\n    // customLayout = table._reactCreateGraphic;\n    customLayout = table.reactCustomLayout?.getCustomLayoutFunc(col, row) || emptyCustomLayout;\n  }\n  if (typeof customLayout === 'function') {\n    const arg = {\n      col: range?.start.col ?? col,\n      row: range?.start.row ?? row,\n      dataValue: table.getCellOriginValue(col, row),\n      value: table.getCellValue(col, row) || '',\n      rect: {\n        left: 0,\n        top: 0,\n        right: width,\n        bottom: height,\n        width,\n        height\n      },\n      table,\n      originCol: col,\n      originRow: row\n    };\n    const customRenderObj = customLayout(arg);\n    if (!customRenderObj) {\n      return {\n        renderDefault: true\n      };\n    }\n    if (customRenderObj.rootContainer) {\n      customRenderObj.rootContainer = decodeReactDom(customRenderObj.rootContainer, table.animationManager.timeline);\n    }\n    // expectedWidth = customRenderObj.expectedWidth;\n    // expectedHeight = customRenderObj.expectedHeight;\n    if (customRenderObj.rootContainer instanceof VGroup) {\n      elementsGroup = customRenderObj.rootContainer;\n      elementsGroup.name = CUSTOM_CONTAINER_NAME;\n      (elementsGroup as any).col = col;\n      (elementsGroup as any).row = row;\n      // } else if (customRenderObj.rootContainer) {\n      //   customElements = customRenderObj.rootContainer.getElements(undefined, false, false);\n    }\n    renderDefault = customRenderObj.renderDefault;\n    enableCellPadding = customRenderObj.enableCellPadding;\n  } else if (typeof customRender === 'function') {\n    const arg = {\n      col,\n      row,\n      dataValue: table.getCellOriginValue(col, row),\n      value: table.getCellValue(col, row) || '',\n      rect: {\n        left: 0,\n        top: 0,\n        right: width,\n        bottom: height,\n        width,\n        height\n      },\n      table\n    };\n    const customRenderObj = customRender(arg);\n    if (customRenderObj) {\n      customElements = customRenderObj.elements;\n      renderDefault = customRenderObj.renderDefault;\n      expectedWidth = customRenderObj.expectedWidth;\n      expectedHeight = customRenderObj.expectedHeight;\n    }\n  } else if (customRender) {\n    expectedWidth = customRender.expectedWidth;\n    expectedHeight = customRender.expectedHeight;\n    customElements = customRender.elements;\n    renderDefault = customRender.renderDefault;\n  }\n\n  if (customElements) {\n    const value = table.getCellValue(col, row);\n    elementsGroup = adjustElementToGroup(\n      customElements,\n      autoWidth ? expectedWidth : width,\n      autoHeight ? expectedHeight : height,\n      value\n    );\n  }\n\n  if (enableCellPadding) {\n    elementsGroup.setAttributes({\n      x: padding[3],\n      y: padding[0],\n      width: width - padding[1] - padding[3],\n      height: height - padding[0] - padding[2]\n    });\n  }\n\n  // for percent calc\n  dealPercentCalc(elementsGroup, width, height);\n\n  // deal with merge cell attribute update\n  if (range && (range.start.col !== range.end.col || range.start.row !== range.end.row)) {\n    bindAttributeUpdate(elementsGroup, col, row, 0);\n  }\n\n  return {\n    elementsGroup,\n    renderDefault\n  };\n}\n\nfunction adjustElementToGroup(\n  elements: ICustomRenderElements,\n  width: number,\n  height: number,\n  value: any\n): VGroup | undefined {\n  const customGroup = new VGroup({\n    x: 0,\n    y: 0,\n    width,\n    height,\n    fill: false,\n    stroke: false,\n    pickable: false\n  });\n  customGroup.name = CUSTOM_CONTAINER_NAME;\n\n  const elementsAdjusted = adjustElementsPos(elements, width, height, value);\n  elementsAdjusted.forEach(element => {\n    if ((element as any).clickable) {\n      element.pickable = (element as any).clickable;\n    }\n    switch (element.type) {\n      case 'arc':\n        const arc = createArc({\n          x: element.x as number,\n          y: element.y as number,\n          dx: (element.dx ?? 0) as number,\n          dy: (element.dy ?? 0) as number,\n          fill: element.fill as string,\n          stroke: element.stroke as string,\n          outerRadius: element.radius as number,\n          startAngle: element.startAngle as number,\n          endAngle: element.endAngle as number,\n          pickable: !!element.pickable,\n          cursor: element.cursor as Cursor\n        });\n        arc.name = element.name;\n        customGroup.appendChild(arc);\n        break;\n      case 'text':\n        if (element.background) {\n          const expandX = element.background?.expandX ?? 0;\n          const expandY = element.background?.expandY ?? 0;\n          const textBackRect = createRect({\n            x: (element.x as number) - expandX,\n            y: (element.y as number) - expandY,\n            dx: (element.dx ?? 0) as number,\n            dy: (element.dy ?? 0) as number,\n            width: element.width + expandX * 2,\n            height: element.height + expandY * 2,\n            cornerRadius: element.background?.cornerRadius ?? 0,\n            // fill: true,\n            fill: element.background?.fill ?? '#888'\n          });\n          customGroup.appendChild(textBackRect);\n        }\n        const text = new Text(\n          Object.assign(\n            {\n              pickable: !!element.pickable,\n              fill: element.color ?? element.fill\n            },\n            element as any\n          )\n        );\n        text.name = element.name;\n        customGroup.appendChild(text);\n        break;\n      case 'rect':\n        const rect = createRect({\n          x: element.x as number,\n          y: element.y as number,\n          dx: (element.dx ?? 0) as number,\n          dy: (element.dy ?? 0) as number,\n          width: element.width as number,\n          height: element.height as number,\n          cornerRadius: element.radius as number,\n          fill: element.fill as string,\n          stroke: element.stroke as string,\n          pickable: !!element.pickable,\n          cursor: element.cursor as Cursor\n        });\n        rect.name = element.name;\n        customGroup.appendChild(rect);\n        break;\n      case 'circle':\n        const circle = createCircle({\n          x: element.x as number,\n          y: element.y as number,\n          dx: (element.dx ?? 0) as number,\n          dy: (element.dy ?? 0) as number,\n          radius: element.radius as number,\n          fill: element.fill as string,\n          stroke: element.stroke as string,\n          pickable: !!element.pickable,\n          cursor: element.cursor as Cursor\n        });\n        circle.name = element.name;\n        customGroup.appendChild(circle);\n        break;\n      case 'icon':\n        const icon = new Icon({\n          x: element.x as number,\n          y: element.y as number,\n          dx: (element.dx ?? 0) as number,\n          dy: (element.dy ?? 0) as number,\n          width: element.width as number,\n          height: element.height as number,\n          image: element.svg as string,\n          backgroundWidth: element.hover ? ((element.hover.width ?? element.width) as number) : undefined,\n          backgroundHeight: element.hover ? ((element.hover.width ?? element.width) as number) : undefined,\n          backgroundColor: element.hover ? element.hover.bgColor ?? 'rgba(22,44,66,0.2)' : undefined,\n          pickable: !!element.pickable,\n          cursor: element.cursor as Cursor\n        });\n        icon.name = element.name;\n        icon.role = 'icon-custom';\n        customGroup.appendChild(icon);\n        break;\n      case 'image':\n        const image = new Icon({\n          x: element.x as number,\n          y: element.y as number,\n          dx: (element.dx ?? 0) as number,\n          dy: (element.dy ?? 0) as number,\n          width: element.width as number,\n          height: element.height as number,\n          image: element.src as string,\n          backgroundWidth: element.hover ? ((element.hover.width ?? element.width) as number) : undefined,\n          backgroundHeight: element.hover ? ((element.hover.width ?? element.width) as number) : undefined,\n          backgroundColor: element.hover ? element.hover.bgColor ?? 'rgba(22,44,66,0.2)' : undefined,\n          pickable: !!element.pickable,\n          cursor: element.cursor as Cursor,\n          shape: element.shape\n        });\n        image.name = element.name;\n        image.role = 'image-custom';\n        customGroup.appendChild(image);\n        break;\n\n      case 'line':\n        const line = createLine({\n          points: element.points,\n          lineWidth: element.lineWidth ?? 1,\n          stroke: element.stroke as string,\n          pickable: !!element.pickable,\n          cursor: element.cursor as Cursor\n        });\n        line.name = element.name;\n        customGroup.appendChild(line);\n        break;\n    }\n  });\n\n  return customGroup;\n}\n\nfunction adjustElementsPos(\n  originalElements: ICustomRenderElements,\n  // rect: RectProps,\n  width: number,\n  height: number,\n  // borderLineWidths: number[],\n  value: any\n): ICustomRenderElements {\n  const result: ICustomRenderElements = [];\n  // const { left, top, width, height } = rect;\n  const left = 0;\n  const top = 0;\n  const borderLineWidths = [0, 0, 0, 0];\n\n  for (let i = 0; i < originalElements.length; i++) {\n    const originalElement = originalElements[i];\n    const element = Object.assign({}, originalElement);\n    // 执行相关函数\n    for (const name in element) {\n      if (element.hasOwnProperty(name) && isFunction(element[name])) {\n        element[name] = (element[name] as Function)(value);\n      }\n    }\n\n    // 转换字符串值（百分比、px）\n    const rect = element as RectElement;\n    if (isValid(rect.x)) {\n      rect.x = isString(rect.x)\n        ? transformString((rect as any).x as string, width - borderLineWidths[1])\n        : Number(rect.x);\n    }\n    if (isValid(rect.y)) {\n      rect.y = isString(rect.y)\n        ? transformString((rect as any).y as string, height - borderLineWidths[2])\n        : Number(rect.y);\n    }\n    if ('width' in element) {\n      element.width = isString(element.width)\n        ? transformString(element.width as string, width - borderLineWidths[1])\n        : Number(element.width);\n    }\n    if ('height' in element) {\n      element.height = isString(element.height)\n        ? transformString(element.height as string, height - borderLineWidths[2])\n        : Number(element.height);\n    }\n    if ('radius' in element) {\n      element.radius = isString(element.radius)\n        ? transformString(element.radius as string, Math.min(width - borderLineWidths[1], height - borderLineWidths[2]))\n        : Number(element.radius);\n    }\n    if ('hover' in element) {\n      // 转换字符串值（百分比、px）\n      element.hover.x = isString(element.hover.x)\n        ? transformString(element.hover.x as string, width - borderLineWidths[1])\n        : Number(element.hover.x);\n      element.hover.y = isString(element.hover.y)\n        ? transformString(element.hover.y as string, height - borderLineWidths[2])\n        : Number(element.hover.y);\n      element.hover.width = isString(element.hover.width)\n        ? transformString(element.hover.width as string, width - borderLineWidths[1])\n        : Number(element.hover.width);\n\n      element.hover.height = isString(element.hover.height)\n        ? transformString(element.hover.height as string, height - borderLineWidths[2])\n        : Number(element.hover.height);\n      element.hover.x += left;\n      element.hover.y += top;\n    }\n    // 矫正位置\n    rect.x = rect.x + left;\n    rect.y = rect.y + top;\n\n    result.push(element as unknown as ICustomRenderElement);\n  }\n\n  return result;\n}\n\nfunction transformString(str: string, size?: number): number {\n  if (str.endsWith('px')) {\n    return parseInt(str, 10);\n  } else if (str.endsWith('%') && size) {\n    return (parseInt(str, 10) / 100) * size;\n  }\n  return parseInt(str, 10);\n}\n\nexport function dealPercentCalc(group: VGroup, parentWidth: number, parentHeight: number) {\n  if (!group) {\n    return;\n  }\n  group.forEachChildren((child: VGroup) => {\n    if (!child) {\n      return;\n    }\n    if (isObject(child.attribute.width) && (child.attribute.width as percentCalcObj).percent) {\n      child.setAttribute(\n        'width',\n        Math.max(\n          0,\n          ((child.attribute.width as percentCalcObj).percent / 100) * parentWidth +\n            ((child.attribute.width as percentCalcObj).delta ?? 0)\n        )\n      );\n    }\n\n    if (child.attribute.width < 0) {\n      child.setAttribute('width', 0);\n    }\n\n    if (isObject(child.attribute.height) && (child.attribute.height as percentCalcObj).percent) {\n      child.setAttribute(\n        'height',\n        Math.max(\n          0,\n          ((child.attribute.height as percentCalcObj).percent / 100) * parentHeight +\n            ((child.attribute.height as percentCalcObj).delta ?? 0)\n        )\n      );\n    }\n\n    if (child.attribute.height < 0) {\n      child.setAttribute('height', 0);\n    }\n\n    if (child.type === 'group') {\n      dealPercentCalc(child, child.attribute.width, child.attribute.height);\n    }\n  });\n}\n\n// temp devode for react jsx customLayout\nexport function decodeReactDom(dom: any, timeline?: ITimeline) {\n  if (\n    !dom ||\n    (!isValid(dom.$$typeof) && // for react\n      !isValid(dom.vtype)) // for openinula\n  ) {\n    // not react or openinula\n    return dom;\n  }\n  const type = dom.type;\n  const { attribute, children, stateProxy, animation } = dom.props;\n  const g = type({ attribute });\n  parseToGraphic(g, dom.props);\n  if (stateProxy) {\n    g.stateProxy = stateProxy;\n  }\n\n  g.id = attribute.id;\n  g.name = attribute.name;\n  if (isArray(children)) {\n    children.forEach((item: any) => {\n      const c = decodeReactDom(item, timeline);\n      c && c.type && g.add(c);\n    });\n  } else if (children) {\n    g.add(decodeReactDom(children, timeline));\n  }\n\n  if (isArray(animation) && timeline) {\n    const animate = g.animate();\n    animate.setTimeline(timeline);\n    animation.forEach((item: any[]) => {\n      animate[item[0]](...item.slice(1));\n    });\n  }\n  return g;\n}\n\nfunction parseToGraphic(g: any, props: any) {\n  let isGraphic: boolean = false;\n  switch (g.type) {\n    case 'richtext':\n      break;\n    // case 'rich/text':\n    //   out = g.attribute || {};\n    //   childrenList[0] && (out.text = childrenList[0]);\n    //   break;\n    case 'rich/image':\n      break;\n    default:\n      isGraphic = true;\n  }\n\n  if (isGraphic) {\n    // childrenList.forEach((c: any) => {\n    //   c && g.add(c);\n    // });\n\n    Object.keys(props).forEach(k => {\n      const en = REACT_TO_CANOPUS_EVENTS[k];\n      if (en) {\n        g.on(en, props[k]);\n      }\n    });\n\n    // } else {\n    //   if (g.type === 'richtext') {\n    //     g.attribute.textConfig = childrenList.map(item => item.attribute).filter(item => item);\n    //   }\n  }\n}\n\nfunction bindAttributeUpdate(group: VGroup, col: number, row: number, index: number, preId?: string) {\n  if (!group) {\n    return;\n  }\n  group.name = `${CUSTOM_MERGE_PRE_NAME}${preId ?? ''}_${index}`;\n  group.onBeforeAttributeUpdate = onBeforeAttributeUpdate as any;\n  // group.on('afterAttributeUpdate', (e) => {console.log('afterAttributeUpdate', e)})\n  if (group.type === 'group' && group.childrenCount) {\n    group.forEachChildren((child: VGroup, childIndex: number) => {\n      bindAttributeUpdate(child, col, row, childIndex, (preId ?? '') + '_' + index);\n    });\n  }\n}\n\nfunction onBeforeAttributeUpdate(val: Record<string, any>, attribute: any) {\n  // @ts-ignore\n  const graphic = this as any;\n  if (graphic.skipMergeUpdate) {\n    return;\n  }\n  const cellGroup = getTargetCell(graphic) as Group;\n  if (!cellGroup || !cellGroup.stage) {\n    return;\n  }\n  const table = ((cellGroup as any).stage as any).table as BaseTableAPI;\n  graphic.skipAttributeUpdate = true;\n  const { mergeStartCol, mergeEndCol, mergeStartRow, mergeEndRow } = cellGroup;\n  if (\n    isValid(mergeStartCol) &&\n    isValid(mergeEndCol) &&\n    isValid(mergeStartRow) &&\n    isValid(mergeEndRow) &&\n    (mergeStartCol !== mergeEndCol || mergeStartRow !== mergeEndRow)\n  ) {\n    for (let col = mergeStartCol; col <= mergeEndCol; col++) {\n      for (let row = mergeStartRow; row <= mergeEndRow; row++) {\n        if (col === cellGroup.col && row === cellGroup.row) {\n          continue;\n        }\n        // const cell = table.scenegraph.getCell(col, row);\n        const cell = table.scenegraph.highPerformanceGetCell(col, row);\n        if (cell.role === 'cell') {\n          const target = cell.getChildByName(graphic.name, true);\n          if (!target || target.skipAttributeUpdate) {\n            continue;\n          }\n          for (const key in val) {\n            // 表格内merge 单元格布局时，会使用dx dy定位，避免重复更新值，属性同步跳过 dx dy\n            // console.log(\n            //   '[onBeforeAttributeUpdate]',\n            //   target._uid,\n            //   cellGroup.col,\n            //   cellGroup.row,\n            //   col,\n            //   row,\n            //   key,\n            //   val[key]\n            // );\n            if (val[key] !== target.attribute[key] && key !== 'dx' && key !== 'dy') {\n              target.setAttribute(key, val[key]);\n            }\n          }\n        }\n      }\n    }\n    graphic.skipAttributeUpdate = undefined;\n    // return attribute;\n  }\n}\n"]}