{"version":3,"sources":["../src/scenegraph/group-creater/cell-type/image-cell.ts"],"names":[],"mappings":"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","file":"image-cell.js","sourcesContent":["/* eslint-disable no-undef */\nimport type { Cursor, IImage, Image, IThemeSpec } from './../../../vrender';\nimport { createImage } from './../../../vrender';\nimport * as icons from '../../../icons';\nimport { Group } from '../../graphic/group';\nimport { calcKeepAspectRatioSize } from '../../utils/keep-aspect-ratio';\nimport { calcStartPosition } from '../../utils/cell-pos';\nimport type { Scenegraph } from '../../scenegraph';\nimport { getProp, getFunctionalProp } from '../../utils/get-prop';\nimport { isValid } from '@visactor/vutils';\nimport { getQuadProps } from '../../utils/padding';\nimport { getCellBorderStrokeWidth } from '../../utils/cell-border-stroke-width';\nimport type { BaseTableAPI } from '../../../ts-types/base-table';\nimport type { CellRange } from '../../../ts-types';\nimport { dealWithIconLayout } from '../../utils/text-icon-layout';\n\nexport function createImageCellGroup(\n  columnGroup: Group,\n  xOrigin: number,\n  yOrigin: number,\n  col: number,\n  row: number,\n  width: number,\n  height: number,\n  keepAspectRatio: boolean,\n  imageAutoSizing: boolean,\n  padding: [number, number, number, number],\n  textAlign: CanvasTextAlign,\n  textBaseline: CanvasTextBaseline,\n  mayHaveIcon: boolean,\n  table: BaseTableAPI,\n  cellTheme: IThemeSpec,\n  range: CellRange | undefined,\n  isAsync: boolean\n) {\n  const headerStyle = table._getCellStyle(col, row); // to be fixed\n  const functionalPadding = getFunctionalProp('padding', headerStyle, col, row, table);\n  // const margin = getProp('padding', headerStyle, col, row, table);\n  if (table.options.customConfig?.imageMargin) {\n    padding = getQuadProps(table.options.customConfig?.imageMargin);\n  } else if (isValid(functionalPadding)) {\n    padding = functionalPadding;\n  }\n  if (cellTheme?.text?.textAlign) {\n    textAlign = cellTheme?.text?.textAlign;\n  }\n  if (cellTheme?.text?.textBaseline) {\n    textBaseline = cellTheme?.text?.textBaseline;\n  }\n\n  // cell\n  const strokeArrayWidth = getCellBorderStrokeWidth(col, row, cellTheme, table);\n\n  let cellGroup: Group;\n  if (isAsync) {\n    cellGroup = table.scenegraph.highPerformanceGetCell(col, row, true);\n    if (cellGroup && cellGroup.role === 'cell') {\n      cellGroup.setAttributes({\n        x: xOrigin,\n        y: yOrigin,\n        width,\n        height,\n        // 背景相关，cell背景由cellGroup绘制\n        lineWidth: cellTheme?.group?.lineWidth ?? undefined,\n        fill: cellTheme?.group?.fill ?? undefined,\n        stroke: cellTheme?.group?.stroke ?? undefined,\n        strokeArrayWidth: strokeArrayWidth ?? undefined,\n        strokeArrayColor: (cellTheme?.group as any)?.strokeArrayColor ?? undefined,\n        cursor: (cellTheme?.group as any)?.cursor ?? undefined,\n        lineDash: cellTheme?.group?.lineDash ?? undefined,\n        lineCap: 'butt',\n        clip: true,\n        cornerRadius: cellTheme.group.cornerRadius\n      } as any);\n    }\n  }\n  if (!cellGroup || cellGroup.role !== 'cell') {\n    cellGroup = new Group({\n      x: xOrigin,\n      y: yOrigin,\n      width,\n      height,\n      // 背景相关，cell背景由cellGroup绘制\n      lineWidth: cellTheme?.group?.lineWidth ?? undefined,\n      fill: cellTheme?.group?.fill ?? undefined,\n      stroke: cellTheme?.group?.stroke ?? undefined,\n      strokeArrayWidth: strokeArrayWidth ?? undefined,\n      strokeArrayColor: (cellTheme?.group as any)?.strokeArrayColor ?? undefined,\n      cursor: (cellTheme?.group as any)?.cursor ?? undefined,\n      lineDash: cellTheme?.group?.lineDash ?? undefined,\n      lineCap: 'butt',\n      clip: true,\n      cornerRadius: cellTheme.group.cornerRadius\n    } as any);\n    cellGroup.role = 'cell';\n    cellGroup.col = col;\n    cellGroup.row = row;\n    columnGroup?.addCellGroup(cellGroup);\n  }\n\n  let cellIcons;\n  if (mayHaveIcon) {\n    let iconCol = col;\n    let iconRow = row;\n    if (range) {\n      iconCol = range.start.col;\n      iconRow = range.start.row;\n    }\n    cellIcons = table.getCellIcons(iconCol, iconRow);\n  }\n\n  let iconWidth = 0;\n  let cellLeftIconWidth = 0;\n  let cellRightIconWidth = 0;\n  if (Array.isArray(cellIcons) && cellIcons.length !== 0) {\n    const { leftIconWidth, rightIconWidth, absoluteLeftIconWidth, absoluteRightIconWidth } = dealWithIconLayout(\n      cellIcons,\n      cellGroup,\n      range,\n      table\n    );\n\n    iconWidth = leftIconWidth + rightIconWidth;\n    cellLeftIconWidth = leftIconWidth;\n    cellRightIconWidth = rightIconWidth;\n\n    // 更新各个部分横向位置\n    cellGroup.forEachChildren((child: any) => {\n      if (child.role === 'icon-left') {\n        child.setAttribute('x', child.attribute.x + padding[3]);\n      } else if (child.role === 'icon-right') {\n        child.setAttribute('x', child.attribute.x + width - rightIconWidth - padding[1]);\n      } else if (child.role === 'icon-absolute-right') {\n        child.setAttribute('x', child.attribute.x + width - absoluteRightIconWidth - padding[1]);\n      }\n    });\n\n    // 更新各个部分纵向位置\n    cellGroup.forEachChildren((child: any) => {\n      if (textBaseline === 'middle') {\n        child.setAttribute('y', (height - child.AABBBounds.height()) / 2);\n      } else if (textBaseline === 'bottom') {\n        child.setAttribute('y', height - child.AABBBounds.height() - padding[2]);\n      } else {\n        child.setAttribute('y', padding[0]);\n      }\n    });\n\n    (cellGroup as any)._cellLeftIconWidth = cellLeftIconWidth;\n    (cellGroup as any)._cellRightIconWidth = cellRightIconWidth;\n  }\n\n  // image\n  const value = table.getCellValue(col, row);\n  const image: IImage = createImage({\n    x: padding[3],\n    y: padding[0],\n    width: width - padding[1] - padding[3] - iconWidth,\n    height: height - padding[0] - padding[2],\n    image: value, //?? (regedIcons.damage_pic as any).svg,\n    cursor: 'pointer' as Cursor\n  });\n  image.name = 'image';\n  image.keepAspectRatio = keepAspectRatio;\n  image.textAlign = textAlign;\n  image.textBaseline = textBaseline;\n  if (keepAspectRatio || imageAutoSizing) {\n    if (\n      image.resources &&\n      image.resources.has(image.attribute.image) &&\n      image.resources.get(image.attribute.image).state === 'success'\n    ) {\n      image.setAttribute('opacity', 0); // hack for image update\n      setTimeout(() => {\n        image.setAttribute('opacity', 1); // hack for image update; 如果图片资源存在，会先安照单元格大小渲染一次，再异步调整大小，这样可能出现图片闪烁的问题，这里使用opacity来规避\n        updateAutoSizingAndKeepAspectRatio(\n          imageAutoSizing,\n          keepAspectRatio,\n          padding,\n          textAlign,\n          textBaseline,\n          image,\n          cellGroup,\n          table\n        );\n        table.scenegraph.updateNextFrame();\n      }, 0);\n    } else {\n      image.successCallback = () => {\n        updateAutoSizingAndKeepAspectRatio(\n          imageAutoSizing,\n          keepAspectRatio,\n          padding,\n          textAlign,\n          textBaseline,\n          image,\n          cellGroup,\n          table\n        );\n        table.scenegraph.updateNextFrame();\n      };\n    }\n  } else {\n    if (\n      image.resources &&\n      image.resources.has(image.attribute.image) &&\n      image.resources.get(image.attribute.image).state === 'success'\n    ) {\n      updateImageCellContentWhileResize(cellGroup, col, row, 0, 0, table);\n    } else {\n      image.successCallback = () => {\n        updateImageCellContentWhileResize(cellGroup, col, row, 0, 0, table);\n      };\n    }\n  }\n  (image as any).failCallback = () => {\n    const regedIcons = icons.get();\n    // image.setAttribute('image', (regedIcons.damage_pic as any).svg);\n    (image as any).image = (regedIcons.damage_pic as any).svg;\n  };\n  cellGroup.appendChild(image);\n\n  return cellGroup;\n}\n\nexport type CreateImageCellGroup = typeof createImageCellGroup;\n\n/**\n * 调整某个图片资源所在行列的行高列宽 之后重绘\n * @param col\n * @param row\n * @param img\n * @param table\n * @returns 行高或者列宽是否进行了调整\n */\nexport function _adjustWidthHeight(\n  col: number,\n  row: number,\n  // img: HTMLImageElement,\n  width: number,\n  height: number,\n  scene: Scenegraph,\n  padding: [number, number, number, number],\n  cellGroup: Group\n): boolean {\n  // const { width, height } = img as any;\n  // const currentContext = context.toCurrentContext();\n\n  let needInvalidate = false;\n  let targetWidth: number = null;\n  let targetHeight: number = null;\n  // const cellGroup = scene.getCell(col, row, true);\n  const { width: cellWidth, height: cellHeight, isMerge } = getCellRange(cellGroup, scene.table);\n\n  if (cellWidth < width + padding[1] + padding[3]) {\n    targetWidth = width + padding[1] + padding[3];\n    needInvalidate = true;\n  }\n  if (cellHeight < height + padding[2] + padding[0]) {\n    targetHeight = height + padding[2] + padding[0];\n    needInvalidate = true;\n  }\n  if (needInvalidate) {\n    if (typeof targetWidth === 'number') {\n      // table.setColWidth(col, targetWidth, true);\n      if (isMerge) {\n        for (let col = cellGroup.mergeStartCol; col <= cellGroup.mergeEndCol; col++) {\n          scene.setColWidth(col, targetWidth / (cellGroup.mergeEndCol - cellGroup.mergeStartCol + 1));\n        }\n      } else {\n        scene.setColWidth(col, targetWidth);\n      }\n    }\n    if (typeof targetHeight === 'number') {\n      // table.setRowHeight(row, targetHeight, true);\n      if (isMerge) {\n        for (let row = cellGroup.mergeStartRow; row <= cellGroup.mergeEndRow; row++) {\n          scene.setRowHeight(row, targetHeight / (cellGroup.mergeEndRow - cellGroup.mergeStartRow + 1));\n        }\n      } else {\n        scene.setRowHeight(row, targetHeight);\n      }\n    }\n    // table.updateCanvasScroll();\n    // // table.throttleInvalidate(); // 这里会造成每一张图加载后就重绘 造成多次绘制问题！节流绘制\n    // table.invalidate(); //节流绘制改回及时绘制 节流绘制在图片加载过程中的效果不太好\n\n    scene.component.updateScrollBar();\n    // scene.updateNextFrame();\n    return true;\n  }\n  return false;\n}\n\nexport function updateImageCellContentWhileResize(\n  cellGroup: Group,\n  col: number,\n  row: number,\n  deltaX: number,\n  deltaY: number,\n  table: BaseTableAPI\n) {\n  const image = cellGroup.getChildByName('image') as Image;\n  if (!image) {\n    return;\n  }\n  const originImage =\n    (typeof image.attribute.image !== 'string' && image.attribute.image) ||\n    image.resources?.get(image.attribute.image as string).data;\n\n  if (!originImage) {\n    return;\n  }\n\n  const headerStyle = table._getCellStyle(col, row); // to be fixed\n  const textAlign = getProp('textAlign', headerStyle, col, row, table) ?? 'left';\n  const textBaseline = getProp('textBaseline', headerStyle, col, row, table) ?? 'middle';\n  let padding: [number, number, number, number];\n  if (table.options.customConfig?.imageMargin) {\n    padding = getQuadProps(table.options.customConfig?.imageMargin);\n  } else {\n    padding = getQuadProps(getProp('padding', headerStyle, col, row, table)) ?? [0, 0, 0, 0];\n  }\n\n  const { width: cellWidth, height: cellHeight, isMerge } = getCellRange(cellGroup, table);\n  const colStart = cellGroup.mergeStartCol ?? cellGroup.col;\n  const rowStart = cellGroup.mergeStartRow ?? cellGroup.row;\n  const colEnd = cellGroup.mergeEndCol ?? cellGroup.col;\n  const rowEnd = cellGroup.mergeEndCol ?? cellGroup.row;\n\n  const leftIconWidth = (cellGroup as any)._cellLeftIconWidth ?? 0;\n  const rightIconWidth = (cellGroup as any)._cellRightIconWidth ?? 0;\n\n  if ((image as any).keepAspectRatio) {\n    const { width: imageWidth, height: imageHeight } = calcKeepAspectRatioSize(\n      originImage.width || (originImage as any).videoWidth,\n      originImage.height || (originImage as any).videoHeight,\n      // cellGroup.attribute.width - (padding[1] + padding[3]),\n      // cellGroup.attribute.height - (padding[0] + padding[2])\n      cellWidth - (padding[1] + padding[3]),\n      cellHeight - (padding[0] + padding[2])\n    );\n\n    const pos = calcStartPosition(\n      0,\n      0,\n      // cellGroup.attribute.width,\n      // cellGroup.attribute.height,\n      cellWidth,\n      cellHeight,\n      imageWidth,\n      imageHeight,\n      textAlign,\n      textBaseline,\n      padding\n    );\n\n    for (let col = colStart; col <= colEnd; col++) {\n      for (let row = rowStart; row <= rowEnd; row++) {\n        const cellGroup = table.scenegraph.getCell(col, row);\n        const image = cellGroup.getChildByName('image') as Image;\n        image?.setAttributes({\n          x: pos.x,\n          y: pos.y,\n          width: imageWidth,\n          height: imageHeight\n        });\n      }\n    }\n  } else {\n    for (let col = colStart; col <= colEnd; col++) {\n      for (let row = rowStart; row <= rowEnd; row++) {\n        const cellGroup = table.scenegraph.getCell(col, row);\n        const image = cellGroup.getChildByName('image') as Image;\n        image?.setAttributes({\n          x: leftIconWidth + padding[3],\n          y: padding[0],\n          // width: cellGroup.attribute.width - padding[1] - padding[3],\n          // height: cellGroup.attribute.height - padding[0] - padding[2]\n          width: cellWidth - padding[1] - padding[3] - rightIconWidth - leftIconWidth,\n          height: cellHeight - padding[0] - padding[2]\n        });\n      }\n    }\n  }\n\n  // update video play icon\n  const playIcon = cellGroup.getChildByName('play-icon');\n  if (playIcon) {\n    const left = 0;\n    const top = 0;\n    // const width = cellGroup.attribute.width;\n    // const height = cellGroup.attribute.height;\n    const { width, height } = getCellRange(cellGroup, table);\n    const iconSize = Math.floor(Math.min(width - padding[1] - padding[3], height - padding[2] - padding[0]) / 2);\n    const anchorX =\n      left + (width > image.attribute.width ? image.attribute.x - left + image.attribute.width / 2 : width / 2);\n    const anchorY =\n      top + (height > image.attribute.height ? image.attribute.y - top + image.attribute.height / 2 : height / 2);\n\n    for (let col = colStart; col <= colEnd; col++) {\n      for (let row = rowStart; row <= rowEnd; row++) {\n        const cellGroup = table.scenegraph.getCell(col, row);\n        const playIcon = cellGroup.getChildByName('play-icon') as Image;\n        playIcon.setAttributes({\n          x: anchorX - iconSize / 2,\n          y: anchorY - iconSize / 2,\n          width: iconSize,\n          height: iconSize\n        });\n      }\n    }\n  }\n\n  // 更新x方向位置\n  cellGroup.forEachChildren((child: any) => {\n    if (child.role === 'icon-left') {\n      // do nothing\n    } else if (child.role === 'icon-right') {\n      child.setAttribute('x', child.attribute.x + deltaX);\n    } else if (child.role === 'icon-absolute-right') {\n      child.setAttribute('x', child.attribute.x + deltaX);\n    }\n  });\n\n  // 更新y方向位置\n  cellGroup.forEachChildren((child: any) => {\n    if (child.type !== 'rect' && (!child.role || !child.role.startsWith('icon'))) {\n      // do nothing\n    } else if (textBaseline === 'middle') {\n      child.setAttribute('y', padding[0] + (cellHeight - padding[0] - padding[2] - child.AABBBounds.height()) / 2);\n    } else if (textBaseline === 'bottom') {\n      child.setAttribute('y', padding[0] + cellHeight - padding[0] - padding[2] - child.AABBBounds.height());\n    } else {\n      child.setAttribute('y', padding[0]);\n    }\n  });\n\n  if (isMerge) {\n    updateImageDxDy(\n      cellGroup.mergeStartCol,\n      cellGroup.mergeEndCol,\n      cellGroup.mergeStartRow,\n      cellGroup.mergeEndRow,\n      table\n    );\n  }\n}\n\nexport function getCellRange(cellGroup: Group, table: BaseTableAPI) {\n  if (\n    cellGroup.role === 'cell' &&\n    isValid(cellGroup.mergeStartCol) &&\n    isValid(cellGroup.mergeEndCol) &&\n    isValid(cellGroup.mergeStartRow) &&\n    isValid(cellGroup.mergeEndRow)\n  ) {\n    return {\n      width: table.getColsWidth(cellGroup.mergeStartCol, cellGroup.mergeEndCol),\n      height: table.getRowsHeight(cellGroup.mergeStartRow, cellGroup.mergeEndRow),\n      isMerge: true\n    };\n  }\n  return {\n    width: cellGroup.attribute.width,\n    height: cellGroup.attribute.height,\n    isMerge: false\n  };\n}\n\nexport function updateImageDxDy(\n  startCol: number,\n  endCol: number,\n  startRow: number,\n  endRow: number,\n  table: BaseTableAPI\n) {\n  for (let col = startCol; col <= endCol; col++) {\n    for (let row = startRow; row <= endRow; row++) {\n      const cellGroup = table.scenegraph.getCell(col, row);\n      if (cellGroup) {\n        const image = cellGroup.getChildByName('image');\n        if (image) {\n          image.setAttributes({\n            dx: -table.getColsWidth(cellGroup.mergeStartCol, col - 1),\n            dy: -table.getRowsHeight(cellGroup.mergeStartRow, row - 1)\n          });\n        }\n        const playIcon = cellGroup.getChildByName('play-icon');\n        if (playIcon) {\n          playIcon.setAttributes({\n            dx: -table.getColsWidth(cellGroup.mergeStartCol, col - 1),\n            dy: -table.getRowsHeight(cellGroup.mergeStartRow, row - 1)\n          });\n        }\n      }\n    }\n  }\n}\n\nfunction updateAutoSizingAndKeepAspectRatio(\n  imageAutoSizing: boolean,\n  keepAspectRatio: boolean,\n  padding: [number, number, number, number],\n  textAlign: CanvasTextAlign,\n  textBaseline: CanvasTextBaseline,\n  image: IImage,\n  cellGroup: Group,\n  table: BaseTableAPI\n) {\n  const originImage = image.resources.get(image.attribute.image as string).data;\n  const { col, row } = cellGroup;\n\n  if (imageAutoSizing && !isDamagePic(image)) {\n    _adjustWidthHeight(\n      col,\n      row,\n      (originImage as HTMLImageElement).width,\n      (originImage as HTMLImageElement).height,\n      table.scenegraph,\n      padding,\n      cellGroup\n    );\n  }\n  if (keepAspectRatio || isDamagePic(image)) {\n    const { width: cellWidth, height: cellHeight, isMerge } = getCellRange(cellGroup, table);\n\n    const { width: imageWidth, height: imageHeight } = calcKeepAspectRatioSize(\n      originImage.width,\n      originImage.height,\n      // cellGroup.attribute.width - padding[1] - padding[3],\n      // cellGroup.attribute.height - padding[0] - padding[2]\n      cellWidth - padding[1] - padding[3],\n      cellHeight - padding[0] - padding[2]\n    );\n\n    // const left = 0;\n    // const top = 0;\n    const pos = calcStartPosition(\n      0,\n      0,\n      // cellGroup.attribute.width,\n      // cellGroup.attribute.height,\n      cellWidth,\n      cellHeight,\n      imageWidth,\n      imageHeight,\n      textAlign,\n      textBaseline,\n      padding\n    );\n\n    image.setAttributes({\n      x: pos.x,\n      y: pos.y,\n      width: imageWidth,\n      height: imageHeight\n      // dx: isMerge ? -table.getColsWidth(cellGroup.mergeStartCol, col - 1) : 0,\n      // dy: isMerge ? -table.getRowsHeight(cellGroup.mergeStartRow, row - 1) : 0\n    });\n\n    if (isMerge) {\n      updateImageDxDy(\n        cellGroup.mergeStartCol,\n        cellGroup.mergeEndCol,\n        cellGroup.mergeStartRow,\n        cellGroup.mergeEndRow,\n        table\n      );\n    }\n  }\n}\n\nfunction isDamagePic(image: IImage) {\n  const regedIcons = icons.get();\n  return image.attribute.image === (regedIcons.damage_pic as any).svg;\n}\n"]}