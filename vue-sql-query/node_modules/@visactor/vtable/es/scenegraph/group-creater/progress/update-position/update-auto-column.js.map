{"version":3,"sources":["../src/scenegraph/group-creater/progress/update-position/update-auto-column.ts"],"names":[],"mappings":"AAEA,OAAO,EAAE,YAAY,EAAE,YAAY,EAAE,MAAM,QAAQ,CAAC;AAEpD,MAAM,UAAU,gBAAgB,CAC9B,QAAgB,EAChB,MAAc,EACd,KAAmB,EACnB,YAA8B,MAAM;IAGpC,KAAK,IAAI,GAAG,GAAG,QAAQ,EAAE,GAAG,IAAI,MAAM,EAAE,GAAG,EAAE,EAAE;QAC7C,MAAM,YAAY,GAAG,KAAK,CAAC,UAAU,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC;QACvD,IAAI,YAAY,EAAE;YAChB,eAAe,CAAC,YAAY,EAAE,KAAK,EAAE,SAAS,CAAC,CAAC;SACjD;QACD,MAAM,oBAAoB,GAAG,KAAK,CAAC,UAAU,CAAC,WAAW,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;QACrE,IAAI,oBAAoB,EAAE;YACxB,eAAe,CAAC,oBAAoB,EAAE,KAAK,EAAE,SAAS,CAAC,CAAC;SACzD;QACD,MAAM,cAAc,GAAG,KAAK,CAAC,UAAU,CAAC,mBAAmB,CAAC,GAAG,CAAC,CAAC;QACjE,IAAI,cAAc,EAAE;YAClB,eAAe,CAAC,cAAc,EAAE,KAAK,EAAE,SAAS,CAAC,CAAC;SACnD;KACF;IAGD,MAAM,0BAA0B,GAAG,IAAI,CAAC,GAAG,CACzC,KAAK,CAAC,UAAU,CAAC,KAAK,CAAC,QAAQ,EAC/B,KAAK,CAAC,UAAU,CAAC,KAAK,CAAC,YAAY,GAAG,KAAK,CAAC,UAAU,CAAC,KAAK,CAAC,WAAW,GAAG,CAAC,CAC7E,CAAC;IAEF,MAAM,cAAc,GAAG,KAAK,CAAC,YAAY,CAAC,KAAK,CAAC,cAAc,EAAE,KAAK,CAAC,cAAc,GAAG,0BAA0B,CAAC,CAAC;IACnH,MAAM,UAAU,GAAG,KAAK,CAAC,YAAY,CAAC,KAAK,CAAC,cAAc,EAAE,KAAK,CAAC,QAAQ,GAAG,CAAC,CAAC,CAAC;IAChF,KAAK,CAAC,UAAU,CAAC,KAAK,CAAC,UAAU,GAAG,cAAc,GAAG,CAAC,CAAC;IACvD,KAAK,CAAC,UAAU,CAAC,KAAK,CAAC,WAAW,GAAG,UAAU,GAAG,cAAc,GAAG,CAAC,CAAC;AACvE,CAAC;AAED,SAAS,eAAe,CAAC,QAAe,EAAE,KAAmB,EAAE,YAA8B,MAAM;IACjG,IAAI,SAAS,KAAK,MAAM,EAAE;QACxB,IAAI,CAAC,CAAC;QACN,MAAM,aAAa,GAAG,YAAY,CAAC,QAAQ,CAAC,CAAC;QAC7C,IAAI,aAAa,EAAE;YACjB,CAAC,GAAG,aAAa,CAAC,SAAS,CAAC,CAAC,GAAG,KAAK,CAAC,WAAW,CAAE,QAAQ,CAAC,KAAe,CAAC,GAAG,CAAC,CAAC;SAClF;aAAM;YAEL,CAAC,GAAG,KAAK,CAAC,YAAY,CAAC,KAAK,CAAC,cAAc,EAAE,QAAQ,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC;SAChE;QACD,QAAQ,CAAC,YAAY,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;KAC/B;SAAM;QACL,IAAI,CAAC,CAAC;QACN,MAAM,aAAa,GAAG,YAAY,CAAC,QAAQ,CAAC,CAAC;QAC7C,IAAI,aAAa,EAAE;YACjB,CAAC,GAAG,aAAa,CAAC,SAAS,CAAC,CAAC,GAAG,KAAK,CAAC,WAAW,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;SACjE;aAAM;YAEL,CAAC,GAAG,KAAK,CAAC,YAAY,CAAC,KAAK,CAAC,cAAc,EAAE,QAAQ,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC;SAChE;QACD,QAAQ,CAAC,YAAY,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;KAC/B;AACH,CAAC","file":"update-auto-column.js","sourcesContent":["import type { BaseTableAPI } from '../../../../ts-types/base-table';\nimport type { Group } from '../../../graphic/group';\nimport { getNextGroup, getPrevGroup } from './util';\n\nexport function updateAutoColumn(\n  colStart: number,\n  colEnd: number,\n  table: BaseTableAPI,\n  direction: 'left' | 'right' = 'left'\n) {\n  // 更新y位置\n  for (let col = colStart; col <= colEnd; col++) {\n    const bodyColGroup = table.scenegraph.getColGroup(col);\n    if (bodyColGroup) {\n      moveColumnGroup(bodyColGroup, table, direction);\n    }\n    const columnHeaderColGroup = table.scenegraph.getColGroup(col, true);\n    if (columnHeaderColGroup) {\n      moveColumnGroup(columnHeaderColGroup, table, direction);\n    }\n    const bottomColGroup = table.scenegraph.getColGroupInBottom(col);\n    if (bottomColGroup) {\n      moveColumnGroup(bottomColGroup, table, direction);\n    }\n  }\n\n  // update x limit in proxy\n  const totalActualBodyColumnCount = Math.min(\n    table.scenegraph.proxy.colLimit,\n    table.scenegraph.proxy.bodyRightCol - table.scenegraph.proxy.bodyLeftCol + 1\n  );\n  // 渐进加载总column数量\n  const totalBodyWidth = table.getColsWidth(table.frozenColCount, table.frozenColCount + totalActualBodyColumnCount);\n  const totalWidth = table.getColsWidth(table.frozenColCount, table.colCount - 1);\n  table.scenegraph.proxy.xLimitLeft = totalBodyWidth / 2;\n  table.scenegraph.proxy.xLimitRight = totalWidth - totalBodyWidth / 2;\n}\n\nfunction moveColumnGroup(colGroup: Group, table: BaseTableAPI, direction: 'left' | 'right' = 'left') {\n  if (direction === 'left') {\n    let x;\n    const prevCellGroup = getPrevGroup(colGroup);\n    if (prevCellGroup) {\n      x = prevCellGroup.attribute.x + table.getColWidth((colGroup._prev as Group).col);\n    } else {\n      // 估计位置\n      x = table.getColsWidth(table.frozenColCount, colGroup.col - 1);\n    }\n    colGroup.setAttribute('x', x);\n  } else {\n    let x;\n    const nextCellGroup = getNextGroup(colGroup);\n    if (nextCellGroup) {\n      x = nextCellGroup.attribute.x - table.getColWidth(colGroup.col);\n    } else {\n      // 估计位置\n      x = table.getColsWidth(table.frozenColCount, colGroup.col - 1);\n    }\n    colGroup.setAttribute('x', x);\n  }\n}\n"]}