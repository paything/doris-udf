{"version":3,"sources":["../src/components/empty-tip/empty-tip.ts"],"names":[],"mappings":"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","file":"empty-tip.js","sourcesContent":["import { EmptyTip as EmptyTipComponents } from './../../vrender';\n// eslint-disable-next-line no-duplicate-imports\nimport type { EmptyTipAttributes, FederatedPointerEvent } from './../../vrender';\nimport type { IEmptyTip } from '../../ts-types/component/empty-tip';\nimport type { BaseTableAPI } from '../../ts-types/base-table';\nimport { AABBBounds, isBoolean, isEqual, isValid } from '@visactor/vutils';\nimport type { ListTable } from '../../ListTable';\nimport type { PivotTable } from '../../PivotTable';\nimport type { BaseTable } from '../../core';\nconst emptyTipSvg =\n  '<svg t=\"1716726614852\" class=\"icon\" viewBox=\"0 0 1194 1024\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" p-id=\"2621\" width=\"200\" height=\"200\"><path d=\"M1038.694079 367.237067c13.265507 23.342857-16.633865-40.004445-63.05621-40.004446H219.018794c-26.558738 0-46.46393 13.334815-63.05621 40.004446S0.006238 607.277601 0.006238 650.608819V940.647979a82.351494 82.351494 0 0 0 82.961402 83.349526H1111.702885a82.337632 82.337632 0 0 0 82.975264-83.349526V650.608819c0-43.331218-155.970208-283.371753-155.970208-283.371752zM730.066575 667.284269a136.328386 136.328386 0 0 1-132.738243 133.33429 133.417459 133.417459 0 0 1-132.738243-133.33429v-6.681269a40.6698 40.6698 0 0 0-36.497473-26.66963H73.015044l119.458874-220.02445s23.231965-40.004445 53.103614-40.004446h713.481918c26.544876 0 29.871649 10.008042 46.436207 40.004446L1128.33675 633.947231H769.904682c-26.184476 0-39.838107 7.623855-39.838107 33.337038zM338.505391 210.559919l-89.601086-86.69016a22.178487 22.178487 0 0 1 0-33.26773 21.984425 21.984425 0 0 1 33.170699 0l89.601087 86.676299a22.317102 22.317102 0 0 1 0 33.26773 24.950798 24.950798 0 0 1-33.1707 0z m252.197118-40.059891a25.532983 25.532983 0 0 1-6.639685-16.633865l-3.326773-126.694606A28.263709 28.263709 0 0 1 603.995739 0.515788c13.251646-3.326773 23.204242 10.021904 26.544877 23.342858V153.866163a28.249847 28.249847 0 0 1-23.259688 26.66963c-6.611961-3.312911-13.279369-3.312911-16.578419-10.035765z m235.646421 33.337038a22.372548 22.372548 0 0 1 0-33.337038l86.288175-90.030795a22.039871 22.039871 0 0 1 33.170699 0 22.289379 22.289379 0 0 1 0 33.364761l-82.961401 90.003072a25.962691 25.962691 0 0 1-36.483611 0z\" fill=\"#8a8a8a\" p-id=\"2622\"></path></svg>';\n\nexport interface IEmptyTipComponent {\n  new (emptyTipOption: IEmptyTip | true, table: BaseTableAPI): EmptyTip;\n}\n\nexport class EmptyTip {\n  table: BaseTableAPI;\n  _emptyTipOption: IEmptyTip = {\n    spaceBetweenTextAndIcon: 20,\n    text: 'no data',\n    textStyle: {\n      fontSize: 14,\n      color: '#000'\n    },\n    icon: {\n      image: emptyTipSvg,\n      width: 100,\n      height: 100\n    }\n  };\n  isReleased: boolean = false;\n  private _emptyTipComponent: EmptyTipComponents;\n  private _cacheAttrs: EmptyTipAttributes;\n  constructor(emptyTipOption: IEmptyTip | true, table: BaseTableAPI) {\n    this.table = table;\n    this._emptyTipOption = Object.assign(this._emptyTipOption, emptyTipOption === true ? {} : emptyTipOption);\n    // deal with displayMode\n    if (!isValid(this._emptyTipOption.displayMode)) {\n      // for list table and pivot table current display effect\n      if (this.table.isListTable()) {\n        this._emptyTipOption.displayMode = 'basedOnTable';\n      } else {\n        this._emptyTipOption.displayMode = 'basedOnContainer';\n      }\n    }\n    this._emptyTipComponent = this._createOrUpdateEmptyTipComponent(this._getEmptyTipAttrs());\n  }\n\n  private _createOrUpdateEmptyTipComponent(attrs: EmptyTipAttributes): EmptyTipComponents {\n    if (this._emptyTipComponent) {\n      if (!isEqual(attrs, this._cacheAttrs)) {\n        this._emptyTipComponent.setAttributes(attrs);\n      }\n    } else {\n      const emptyTip = new EmptyTipComponents(attrs);\n      emptyTip.name = 'emptyTip';\n      this.table.scenegraph.stage.defaultLayer.appendChild(emptyTip);\n      this._emptyTipComponent = emptyTip;\n\n      // bind events\n      this.bindEvents();\n    }\n    // update table size\n    // this._adjustTableSize(this._emptyTipComponent.attribute);\n    return this._emptyTipComponent;\n  }\n\n  bindEvents() {\n    this._emptyTipComponent.on('click', (e: FederatedPointerEvent) => {\n      const bounds = new AABBBounds();\n      this._emptyTipComponent.forEachChildren((child: any) => {\n        bounds.union(child.globalAABBBounds);\n      });\n      if (bounds.contains(e.x, e.y)) {\n        this.table.fireListeners('empty_tip_click', e);\n        return;\n      }\n    });\n    this._emptyTipComponent.on('dblclick', (e: FederatedPointerEvent) => {\n      const bounds = new AABBBounds();\n      this._emptyTipComponent.forEachChildren((child: any) => {\n        bounds.union(child.globalAABBBounds);\n      });\n      if (bounds.contains(e.x, e.y)) {\n        this.table.fireListeners('empty_tip_dblclick', e);\n        return;\n      }\n    });\n  }\n\n  resize() {\n    if (!this._emptyTipComponent) {\n      return;\n    }\n    const { leftHeaderWidth, topHeaderHeight, width, height } = this.getWidthAndHeight();\n    this._emptyTipComponent.setAttributes({\n      spaceBetweenTextAndIcon: this._emptyTipOption.spaceBetweenTextAndIcon,\n      x: this.table.tableX + leftHeaderWidth,\n      y: this.table.tableY + topHeaderHeight,\n      width,\n      height,\n      text: {\n        text: this._emptyTipOption.text,\n        ...this._emptyTipOption.textStyle,\n        fill: this._emptyTipOption.textStyle?.color\n      },\n      icon: {\n        ...this._emptyTipOption.icon\n      }\n    });\n  }\n\n  release(): void {\n    this._emptyTipComponent && this.table.scenegraph.stage.defaultLayer.removeChild(this._emptyTipComponent);\n    this._emptyTipComponent = null;\n    this.isReleased = true;\n  }\n  resetVisible() {\n    if (\n      ((!this.table.recordsCount || this.table.recordsCount === 0) &&\n        this.table.internalProps.layoutMap.rowCount === this.table.internalProps.layoutMap.columnHeaderLevelCount) ||\n      this.table.internalProps.layoutMap.colCount === this.table.internalProps.layoutMap.rowHeaderLevelCount\n    ) {\n      // this._emptyTipComponent.setAttributes({\n      //   visible: true\n      // });\n      // this._emptyTipComponent.showAll();\n      if (!this.table.scenegraph.stage.defaultLayer.children.includes(this._emptyTipComponent)) {\n        this.table.scenegraph.stage.defaultLayer.appendChild(this._emptyTipComponent);\n      }\n    } else {\n      // this._emptyTipComponent.setAttributes({\n      //   visible: false\n      // });\n      // this._emptyTipComponent.hideAll();\n      if (this.table.scenegraph.stage.defaultLayer.children.includes(this._emptyTipComponent)) {\n        this.table.scenegraph.stage.defaultLayer.removeChild(this._emptyTipComponent);\n      }\n    }\n  }\n\n  getWidthAndHeight() {\n    const leftHeaderWidth =\n      (this.table as ListTable).transpose || (this.table as PivotTable).options.indicatorsAsCol === false\n        ? this.table.getFrozenColsWidth()\n        : 0;\n    const topHeaderHeight =\n      !(this.table as ListTable).transpose || (this.table as PivotTable).options.indicatorsAsCol\n        ? this.table.getFrozenRowsHeight()\n        : 0;\n    const width =\n      (this._emptyTipOption.displayMode !== 'basedOnContainer' &&\n      this.table.columnHeaderLevelCount > 0 &&\n      this.table.colCount > this.table.rowHeaderLevelCount\n        ? this.table.getDrawRange().width\n        : this.table.tableNoFrameWidth) -\n      leftHeaderWidth -\n      (this.table as BaseTable).getTheme().scrollStyle.width;\n    const height =\n      (this._emptyTipOption.displayMode !== 'basedOnContainer' &&\n      this.table.rowHeaderLevelCount > 0 &&\n      this.table.rowCount > this.table.columnHeaderLevelCount\n        ? this.table.getDrawRange().height\n        : this.table.tableNoFrameHeight) -\n      topHeaderHeight -\n      (this.table as BaseTable).getTheme().scrollStyle.width;\n    return {\n      leftHeaderWidth,\n      topHeaderHeight,\n      width,\n      height\n    };\n  }\n\n  private _getEmptyTipAttrs() {\n    const { leftHeaderWidth, topHeaderHeight, width, height } = this.getWidthAndHeight();\n\n    return {\n      spaceBetweenTextAndIcon: this._emptyTipOption.spaceBetweenTextAndIcon,\n      x: this.table.tableX + leftHeaderWidth,\n      y: this.table.tableY + topHeaderHeight,\n      width,\n      height,\n      text: {\n        text: this._emptyTipOption.text,\n        ...this._emptyTipOption.textStyle,\n        fill: this._emptyTipOption.textStyle?.color\n      },\n      icon: {\n        ...this._emptyTipOption.icon\n      }\n      // visible:this.table.recordsCount === 0?true:false\n    } as EmptyTipAttributes;\n  }\n}\n"]}