{"version":3,"sources":["../src/series/word-cloud/animation.ts"],"names":[],"mappings":"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","file":"animation.js","sourcesContent":["import type { IAnimationTypeConfig, IElement } from '@visactor/vgrammar-core';\nimport { RotateBySphereAnimate } from '@visactor/vrender-core';\nimport { DEFAULT_ANIMATION_CONFIG } from '../../animation/config';\nimport { Factory } from '../../core/factory';\nimport type { IWordcloud3dAnimationParams, IWordcloudAnimationParams, WordcloudAppearPreset } from './interface';\n\nexport const WordCloud3dAnimation = (params: IWordcloud3dAnimationParams | (() => any)): IAnimationTypeConfig => {\n  return {\n    custom: RotateBySphereAnimate,\n    customParameters: (datum: any, element: IElement) => params,\n    easing: 'linear',\n    loop: Infinity,\n    duration: 6000\n  };\n};\n\nfunction computeWordDelay(duration: number, totalTime: number, wordCount: number) {\n  if (duration * wordCount < totalTime) {\n    return duration + (totalTime - wordCount * duration) / (wordCount - 1);\n  }\n  return (totalTime - duration) / (wordCount - 1);\n}\n\nexport const WordCloudScaleInAnimation = (params: IWordcloudAnimationParams): IAnimationTypeConfig => {\n  return {\n    channel: {\n      fontSize: {\n        from: 0\n      }\n    },\n    duration: 200,\n    delay: (datum, element, vgrammarParams) => {\n      const animationConfig = params.animationConfig();\n      const duration = animationConfig?.duration || 200;\n      const totalTime = animationConfig?.totalTime || DEFAULT_ANIMATION_CONFIG.appear.duration;\n      const count = vgrammarParams.VGRAMMAR_ANIMATION_PARAMETERS.elementCount;\n      const index = vgrammarParams.VGRAMMAR_ANIMATION_PARAMETERS.elementIndex;\n      return index * computeWordDelay(duration as number, totalTime as number, count);\n    }\n  };\n};\n\nexport function wordcloudPresetAnimation(\n  params: IWordcloudAnimationParams,\n  preset: WordcloudAppearPreset | boolean\n): IAnimationTypeConfig {\n  if (preset === false) {\n    return {};\n  }\n  switch (preset) {\n    case 'fadeIn':\n      return { type: 'fadeIn' };\n    case 'scaleIn':\n    default:\n      return WordCloudScaleInAnimation(params);\n  }\n}\n\nexport const registerWordCloudAnimation = () => {\n  Factory.registerAnimation('wordCloud', (params: IWordcloudAnimationParams, preset: WordcloudAppearPreset) => ({\n    appear: wordcloudPresetAnimation(params, preset),\n    enter: { type: 'fadeIn' },\n    exit: { type: 'fadeOut' },\n    disappear: { type: 'fadeOut' }\n  }));\n};\n\nexport const registerWordCloud3dAnimation = () => {\n  Factory.registerAnimation('wordCloud3d', (params: IWordcloud3dAnimationParams) => ({\n    enter: WordCloud3dAnimation(params)\n  }));\n};\n"]}