!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).VChart={})}(this,(function(t){"use strict";function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=Array(e);i<e;i++)n[i]=t[i];return n}function i(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function n(t,e,i){return e=c(e),p(t,d()?Reflect.construct(e,i||[],c(t).constructor):e.apply(t,i))}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_(n.key),n)}}function o(t,e,i){return e&&a(t.prototype,e),i&&a(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function s(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=x(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==i.return||i.return()}finally{if(s)throw a}}}}function l(t,e,i){return(e=_(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function u(){return u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,i){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(arguments.length<3?t:i):r.value}},u.apply(null,arguments)}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}function h(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&v(t,e)}function d(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(d=function(){return!!t})()}function p(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return i(t)}function f(){f=function(){return e};var t,e={},i=Object.prototype,n=i.hasOwnProperty,r=Object.defineProperty||function(t,e,i){t[e]=i.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function u(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,i){return t[e]=i}}function c(t,e,i,n){var a=e&&e.prototype instanceof m?e:m,o=Object.create(a.prototype),s=new R(n||[]);return r(o,"_invoke",{value:T(t,i,s)}),o}function h(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var d="suspendedStart",p="suspendedYield",v="executing",g="completed",y={};function m(){}function _(){}function b(){}var x={};u(x,o,(function(){return this}));var k=Object.getPrototypeOf,S=k&&k(k(B([])));S&&S!==i&&n.call(S,o)&&(x=S);var A=b.prototype=m.prototype=Object.create(x);function M(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function i(r,a,o,s){var l=h(t[r],t,a);if("throw"!==l.type){var u=l.arg,c=u.value;return c&&"object"==typeof c&&n.call(c,"__await")?e.resolve(c.__await).then((function(t){i("next",t,o,s)}),(function(t){i("throw",t,o,s)})):e.resolve(c).then((function(t){u.value=t,o(u)}),(function(t){return i("throw",t,o,s)}))}s(l.arg)}var a;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){i(t,n,e,r)}))}return a=a?a.then(r,r):r()}})}function T(e,i,n){var r=d;return function(a,o){if(r===v)throw Error("Generator is already running");if(r===g){if("throw"===a)throw o;return{value:t,done:!0}}for(n.method=a,n.arg=o;;){var s=n.delegate;if(s){var l=C(s,n);if(l){if(l===y)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===d)throw r=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=v;var u=h(e,i,n);if("normal"===u.type){if(r=n.done?g:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=g,n.method="throw",n.arg=u.arg)}}}function C(e,i){var n=i.method,r=e.iterator[n];if(r===t)return i.delegate=null,"throw"===n&&e.iterator.return&&(i.method="return",i.arg=t,C(e,i),"throw"===i.method)||"return"!==n&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var a=h(r,e.iterator,i.arg);if("throw"===a.type)return i.method="throw",i.arg=a.arg,i.delegate=null,y;var o=a.arg;return o?o.done?(i[e.resultName]=o.value,i.next=e.nextLoc,"return"!==i.method&&(i.method="next",i.arg=t),i.delegate=null,y):o:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,y)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function B(e){if(e||""===e){var i=e[o];if(i)return i.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function i(){for(;++r<e.length;)if(n.call(e,r))return i.value=e[r],i.done=!1,i;return i.value=t,i.done=!0,i};return a.next=a}}throw new TypeError(typeof e+" is not iterable")}return _.prototype=b,r(A,"constructor",{value:b,configurable:!0}),r(b,"constructor",{value:_,configurable:!0}),_.displayName=u(b,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,l,"GeneratorFunction")),t.prototype=Object.create(A),t},e.awrap=function(t){return{__await:t}},M(w.prototype),u(w.prototype,s,(function(){return this})),e.AsyncIterator=w,e.async=function(t,i,n,r,a){void 0===a&&(a=Promise);var o=new w(c(t,i,n,r),a);return e.isGeneratorFunction(i)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},M(A),u(A,l,"Generator"),u(A,o,(function(){return this})),u(A,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),i=[];for(var n in e)i.push(n);return i.reverse(),function t(){for(;i.length;){var n=i.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=B,R.prototype={constructor:R,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var i in this)"t"===i.charAt(0)&&n.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var i=this;function r(n,r){return s.type="throw",s.arg=e,i.next=n,r&&(i.method="next",i.arg=t),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var l=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(l&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&n.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=t,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,y):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),P(i),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var r=n.arg;P(i)}return r}}throw Error("illegal catch attempt")},delegateYield:function(e,i,n){return this.delegate={iterator:B(e),resultName:i,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function v(t,e){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},v(t,e)}function g(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var n,r,a,o,s=[],l=!0,u=!1;try{if(a=(i=i.call(t)).next,0===e){if(Object(i)!==i)return;l=!1}else for(;!(l=(n=a.call(i)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(t){u=!0,r=t}finally{try{if(!l&&null!=i.return&&(o=i.return(),Object(o)!==o))return}finally{if(u)throw r}}return s}}(t,e)||x(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t,e,i,n){var r=u(c(1&n?t.prototype:t),e,i);return 2&n&&"function"==typeof r?function(t){return r.apply(i,t)}:r}function m(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||x(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}function b(t){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b(t)}function x(t,i){if(t){if("string"==typeof t)return e(t,i);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?e(t,i):void 0}}
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */var k=function(t,e){return k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},k(t,e)};function S(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}k(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var A=function(){return A=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},A.apply(this,arguments)};function M(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i}function w(t,e,i,n){return new(i||(i=Promise))((function(r,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,s)}l((n=n.apply(t,e||[])).next())}))}function T(t,e){var i,n,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(t){a=[6,t],n=0}finally{i=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function C(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],n=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function E(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var n,r,a=i.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(n=a.next()).done;)o.push(n.value)}catch(t){r={error:t}}finally{try{n&&!n.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return o}function P(t,e,i){if(i||2===arguments.length)for(var n,r=0,a=e.length;r<a;r++)!n&&r in e||(n||(n=Array.prototype.slice.call(e,0,r)),n[r]=e[r]);return t.concat(n||Array.prototype.slice.call(e))}var R,B,I=function(t){return t};function L(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}t.RenderModeEnum=void 0,(R=t.RenderModeEnum||(t.RenderModeEnum={}))["desktop-browser"]="desktop-browser",R["mobile-browser"]="mobile-browser",R.node="node",R.worker="worker",R.miniApp="miniApp",R.wx="wx",R.tt="tt",R.harmony="harmony",R["desktop-miniApp"]="desktop-miniApp",R.lynx="lynx",function(t){t.cartesianAxis="cartesianAxis",t.cartesianBandAxis="cartesianAxis-band",t.cartesianLinearAxis="cartesianAxis-linear",t.cartesianTimeAxis="cartesianAxis-time",t.cartesianLogAxis="cartesianAxis-log",t.cartesianSymlogAxis="cartesianAxis-symlog",t.polarAxis="polarAxis",t.polarBandAxis="polarAxis-band",t.polarLinearAxis="polarAxis-linear",t.crosshair="crosshair",t.cartesianCrosshair="cartesianCrosshair",t.polarCrosshair="polarCrosshair",t.dataZoom="dataZoom",t.geoCoordinate="geoCoordinate",t.indicator="indicator",t.discreteLegend="discreteLegend",t.continuousLegend="continuousLegend",t.colorLegend="colorLegend",t.sizeLegend="sizeLegend",t.mapLabel="mapLabel",t.markLine="markLine",t.markArea="markArea",t.markPoint="markPoint",t.polarMarkLine="polarMarkLine",t.polarMarkArea="polarMarkArea",t.polarMarkPoint="polarMarkPoint",t.geoMarkPoint="geoMarkPoint",t.tooltip="tooltip",t.title="title",t.player="player",t.scrollBar="scrollBar",t.label="label",t.totalLabel="totalLabel",t.brush="brush",t.poptip="poptip",t.customMark="customMark"}(B||(B={}));var D={exports:{}};!function(t){var e=Object.prototype.hasOwnProperty,i="~";function n(){}function r(t,e,i){this.fn=t,this.context=e,this.once=i||!1}function a(t,e,n,a,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new r(n,a||t,o),l=i?i+e:e;return t._events[l]?t._events[l].fn?t._events[l]=[t._events[l],s]:t._events[l].push(s):(t._events[l]=s,t._eventsCount++),t}function o(t,e){0==--t._eventsCount?t._events=new n:delete t._events[e]}function s(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(i=!1)),s.prototype.eventNames=function(){var t,n,r=[];if(0===this._eventsCount)return r;for(n in t=this._events)e.call(t,n)&&r.push(i?n.slice(1):n);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},s.prototype.listeners=function(t){var e=i?i+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,a=n.length,o=new Array(a);r<a;r++)o[r]=n[r].fn;return o},s.prototype.listenerCount=function(t){var e=i?i+t:t,n=this._events[e];return n?n.fn?1:n.length:0},s.prototype.emit=function(t,e,n,r,a,o){var s=i?i+t:t;if(!this._events[s])return!1;var l,u,c=this._events[s],h=arguments.length;if(c.fn){switch(c.once&&this.removeListener(t,c.fn,void 0,!0),h){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,e),!0;case 3:return c.fn.call(c.context,e,n),!0;case 4:return c.fn.call(c.context,e,n,r),!0;case 5:return c.fn.call(c.context,e,n,r,a),!0;case 6:return c.fn.call(c.context,e,n,r,a,o),!0}for(u=1,l=new Array(h-1);u<h;u++)l[u-1]=arguments[u];c.fn.apply(c.context,l)}else{var d,p=c.length;for(u=0;u<p;u++)switch(c[u].once&&this.removeListener(t,c[u].fn,void 0,!0),h){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,e);break;case 3:c[u].fn.call(c[u].context,e,n);break;case 4:c[u].fn.call(c[u].context,e,n,r);break;default:if(!l)for(d=1,l=new Array(h-1);d<h;d++)l[d-1]=arguments[d];c[u].fn.apply(c[u].context,l)}}return!0},s.prototype.on=function(t,e,i){return a(this,t,e,i,!1)},s.prototype.once=function(t,e,i){return a(this,t,e,i,!0)},s.prototype.removeListener=function(t,e,n,r){var a=i?i+t:t;if(!this._events[a])return this;if(!e)return o(this,a),this;var s=this._events[a];if(s.fn)s.fn!==e||r&&!s.once||n&&s.context!==n||o(this,a);else{for(var l=0,u=[],c=s.length;l<c;l++)(s[l].fn!==e||r&&!s[l].once||n&&s[l].context!==n)&&u.push(s[l]);u.length?this._events[a]=1===u.length?u[0]:u:o(this,a)}return this},s.prototype.removeAllListeners=function(t){var e;return t?(e=i?i+t:t,this._events[e]&&o(this,e)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=i,s.EventEmitter=s,t.exports=s}(D);var O=L(D.exports),F=function(t,e){return Object.prototype.toString.call(t)==="[object ".concat(e,"]")},z=function(t){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?"boolean"==typeof t:!0===t||!1===t||F(t,"Boolean")},H=function(t){return"function"==typeof t},j=function(t){return null==t},N=function(t){return null!=t},V=function(t){var e=b(t);return null!==t&&"object"===e||"function"===e},W=function(t){return"object"==b(t)&&null!==t},G=function(t){if(!W(t)||!F(t,"Object"))return!1;if(null===Object.getPrototypeOf(t))return!0;for(var e=t;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e},U=function(t){return void 0===t},Y=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=b(t);return e?"string"===i:"string"===i||F(t,"String")},X=function(t){return Array.isArray?Array.isArray(t):F(t,"Array")},K=function(t){return null!==t&&"function"!=typeof t&&Number.isFinite(t.length)},q=function(t){return F(t,"Date")},Z=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=b(t);return e?"number"===i:"number"===i||F(t,"Number")},J=function(t){return"string"==typeof t&&!isNaN(Number(t))&&!isNaN(parseFloat(t))},Q=function(t){return Z(t)&&Number.isFinite(t)},$=function(t){return new RegExp(/^(http(s)?:\/\/)\w+[^\s]+(\.[^\s]+){1,}$/).test(t)},et=function(t){return new RegExp(/^data:image\/(?:gif|png|jpeg|bmp|webp|svg\+xml)(?:;charset=utf-8)?;base64,(?:[A-Za-z0-9]|[+/])+={0,2}/g).test(t)},it=function(t){return{}.toString.call(t).replace(/^\[object /,"").replace(/]$/,"")},nt=Object.prototype,rt=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||nt)},at=Object.prototype.hasOwnProperty;function ot(t){if(j(t))return!0;if(K(t))return!t.length;var e=it(t);if("Map"===e||"Set"===e)return!t.size;if(rt(t))return!Object.keys(t).length;for(var i in t)if(at.call(t,i))return!1;return!0}var st=function(t,e,i){for(var n=Y(e)?e.split("."):e,r=0;r<n.length;r++)t=t?t[n[r]]:void 0;return void 0===t?i:t},lt=Object.prototype.hasOwnProperty,ut=function(t,e){return null!=t&&lt.call(t,e)};function ct(t,e,i){var n;if(!N(t)||"object"!=b(t)||e&&e(t))return t;var r=X(t),a=t.length;n=r?new Array(a):"object"==b(t)?{}:z(t)||Z(t)||Y(t)?t:q(t)?new Date(+t):void 0;var o=r?void 0:Object.keys(Object(t)),s=-1;if(n)for(;++s<(o||t).length;){var l=o?o[s]:s,u=t[l];i&&i.includes(l.toString())?n[l]=u:n[l]=ct(u,e,i)}return n}function ht(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(e){if(t===e)return;if(N(e)&&"object"==b(e)){var r=Object(e),a=[];for(var o in r)a.push(o);for(var s=a.length,l=-1;s--;){var u=a[++l];!N(r[u])||"object"!=b(r[u])||n&&X(t[u])?pt(t,u,r[u]):dt(t,e,u,i,n)}}}}function dt(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=t[i],o=e[i],s=e[i],l=!0;if(X(o)){if(n)s=[];else if(X(a))s=a;else if(K(a)){s=new Array(a.length);for(var u=-1,c=a.length;++u<c;)s[u]=a[u]}}else G(o)?(s=null!=a?a:{},"function"!=typeof a&&"object"==b(a)||(s={})):l=!1;l&&ht(s,o,n,r),pt(t,i,s)}function pt(t,e,i){(void 0!==i&&!function(t,e){return t===e||Number.isNaN(t)&&Number.isNaN(e)}(t[e],i)||void 0===i&&!(e in t))&&(t[e]=i)}function ft(t){for(var e=-1,i=arguments.length<=1?0:arguments.length-1;++e<i;)ht(t,e+1<1||arguments.length<=e+1?void 0:arguments[e+1],!0);return t}function vt(t,e){if(!t||!G(t))return t;var i={};return Object.keys(t).forEach((function(n){var r=t[n],a=!1;e.forEach((function(t){(Y(t)&&t===n||t instanceof RegExp&&n.match(t))&&(a=!0)})),a||(i[n]=r)})),i}function gt(t){return Object.prototype.toString.call(t)}function yt(t){return Object.keys(t)}function mt(t,e,i){if(t===e)return!0;if(b(t)!=b(e))return!1;if(null==t||null==e)return!1;if(Number.isNaN(t)&&Number.isNaN(e))return!0;if(gt(t)!==gt(e))return!1;if(H(t))return!!(null==i?void 0:i.skipFunction);if("object"!=b(t))return!1;if(X(t)){if(t.length!==e.length)return!1;for(var n=t.length-1;n>=0;n--)if(!mt(t[n],e[n],i))return!1;return!0}if(!G(t))return!1;var r=yt(t),a=yt(e);if(r.length!==a.length)return!1;r.sort(),a.sort();for(var o=r.length-1;o>=0;o--)if(r[o]!=a[o])return!1;for(var s=r.length-1;s>=0;s--){var l=r[s];if(!mt(t[l],e[l],i))return!1}return!0}function _t(t,e,i){for(var n=function(t){if(!t)return[];if(Object.keys)return Object.keys(t);var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(i);return e}(e),r=0;r<n.length;r++){var a=n[r];(i?null!=e[a]:null==t[a])&&(t[a]=e[a])}return t}function bt(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t="prototype"in t?t.prototype:t,e="prototype"in e?e.prototype:e,Object.getOwnPropertyNames)for(var n=Object.getOwnPropertyNames(e),r=0;r<n.length;r++){var a=n[r];"constructor"!==a&&(i?null!=e[a]:null==t[a])&&(t[a]=e[a])}else _t(t,e,i)}function xt(t){return N(t)?X(t)?t:[t]:[]}function kt(t){if(K(t))return t[t.length-1]}var St=function(t,e){var i;if(0!==t.length){for(var n=t[0],r=1;r<t.length;r++){var a=t[r];(null!==(i=null==e?void 0:e(a,n))&&void 0!==i?i:a-n)>0&&(n=a)}return n}},At=function(t,e){var i;if(0!==t.length){for(var n=t[0],r=1;r<t.length;r++){var a=t[r];(null!==(i=null==e?void 0:e(a,n))&&void 0!==i?i:a-n)<0&&(n=a)}return n}};function Mt(t,e){if(!X(t)||!X(e))return!1;if(t.length!==e.length)return!1;for(var i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}function wt(t){for(var e,i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Math.random,r=t.length;r;)e=Math.floor(n()*r),i=t[--r],t[r]=t[e],t[e]=i;return t}function Tt(t){if(!X(t))return[t];var e,i=[],n=s(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;i.push.apply(i,m(Tt(r)))}}catch(t){n.e(t)}finally{n.f()}return i}function Ct(t,e,i){N(e)||(e=t,t=0),N(i)||(i=1);for(var n=-1,r=0|Math.max(0,Math.ceil((e-t)/i)),a=new Array(r);++n<r;)a[n]=t+n*i;return a}function Et(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Pt(t){return Number(t)}var Rt,Bt="undefined"!=typeof console;function It(t,e,i){var n=[e].concat([].slice.call(i));Bt&&console[t].apply(console,n)}!function(t){t[t.None=0]="None",t[t.Error=1]="Error",t[t.Warn=2]="Warn",t[t.Info=3]="Info",t[t.Debug=4]="Debug"}(Rt||(Rt={}));var Lt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Rt.None,i=arguments.length>1?arguments[1]:void 0;r(this,t),this._onErrorHandler=[],this._level=e,this._method=i}return o(t,[{key:"addErrorHandler",value:function(t){this._onErrorHandler.find((function(e){return e===t}))||this._onErrorHandler.push(t)}},{key:"removeErrorHandler",value:function(t){var e=this._onErrorHandler.findIndex((function(e){return e===t}));e<0||this._onErrorHandler.splice(e,1)}},{key:"callErrorHandler",value:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];this._onErrorHandler.forEach((function(t){return t.apply(void 0,e)}))}},{key:"canLogInfo",value:function(){return this._level>=Rt.Info}},{key:"canLogDebug",value:function(){return this._level>=Rt.Debug}},{key:"canLogError",value:function(){return this._level>=Rt.Error}},{key:"canLogWarn",value:function(){return this._level>=Rt.Warn}},{key:"level",value:function(t){return arguments.length?(this._level=+t,this):this._level}},{key:"error",value:function(){for(var t,e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return this._level>=Rt.Error&&(this._onErrorHandler.length?this.callErrorHandler.apply(this,i):It(null!==(t=this._method)&&void 0!==t?t:"error","ERROR",i)),this}},{key:"warn",value:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return this._level>=Rt.Warn&&It(this._method||"warn","WARN",e),this}},{key:"info",value:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return this._level>=Rt.Info&&It(this._method||"log","INFO",e),this}},{key:"debug",value:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return this._level>=Rt.Debug&&It(this._method||"log","DEBUG",e),this}}],[{key:"getInstance",value:function(e,i){return t._instance&&Z(e)?t._instance.level(e):t._instance||(t._instance=new t(e,i)),t._instance}},{key:"setInstance",value:function(e){return t._instance=e}},{key:"setInstanceLevel",value:function(e){t._instance?t._instance.level(e):t._instance=new t(e)}},{key:"clearInstance",value:function(){t._instance=null}}])}();function Dt(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3?arguments[3]:void 0;for(j(n)&&(n=t.length);i<n;){var r=i+n>>>1;Et(t[r],e)>0?n=r:i=r+1}return i}Lt._instance=null;var Ot=function(t,e){return Ft(0,t.length,(function(i){return e(t[i])}))},Ft=function(t,e,i){for(var n=t,r=e;n<r;){var a=Math.floor((n+r)/2);i(a)>=0?r=a:n=a+1}return n},zt=function(t,e){var i=t;return!0!==e&&(i=t.sort(Et)),function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Pt,n=t.length;if(n){if(e<=0||n<2)return i(t[0],0,t);if(e>=1)return i(t[n-1],n-1,t);var r=(n-1)*e,a=Math.floor(r),o=i(t[a],a,t);return o+(i(t[a+1],a+1,t)-o)*(r-a)}}(i,.5)},Ht=1e-10,jt=1e-10;function Nt(t,e){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ht,n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:jt)*Math.max(t,e);return Math.abs(t-e)<=Math.max(i,n)}function Vt(t,e,i,n){return t>e&&!Nt(t,e,i,n)}function Wt(t,e,i,n){return t<e&&!Nt(t,e,i,n)}var Gt=function(t){var e=null,i=null;return function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e&&r.every((function(t,i){return t===e[i]}))||(e=r,i=t.apply(void 0,r)),i}},Ut=function(t,e,i){return t<e?e:t>i?i:t},Yt=function(t,e,i){var n=g(t,2),r=n[0],a=n[1];a<r&&(r=t[1],a=t[0]);var o=a-r;return o>=i-e?[e,i]:[r=Math.min(Math.max(r,e),i-o),r+o]};function Xt(t,e){var i;return t>e&&(i=t,t=e,e=i),function(i){return Math.max(t,Math.min(e,i))}}var Kt=!1;try{Kt="function"==typeof requestAnimationFrame&&"function"==typeof cancelAnimationFrame}catch(t){Kt=!1}function qt(t,e,i){var n,r,a,o,s,l,u=0,c=!1,h=!1,d=!0,p=!e&&0!==e&&Kt;if("function"!=typeof t)throw new TypeError("Expected a function");function f(e){var i=n,a=r;return n=r=void 0,u=e,o=t.apply(a,i)}function v(t,e){return p?(cancelAnimationFrame(s),requestAnimationFrame(t)):setTimeout(t,e)}function g(t){var i=t-l;return void 0===l||i>=e||i<0||h&&t-u>=a}function y(){var t=Date.now();if(g(t))return m(t);s=v(y,function(t){var i=t-u,n=e-(t-l);return h?Math.min(n,a-i):n}(t))}function m(t){return s=void 0,d&&n?f(t):(n=r=void 0,o)}function _(){for(var t=Date.now(),i=g(t),a=arguments.length,d=new Array(a),p=0;p<a;p++)d[p]=arguments[p];if(n=d,r=this,l=t,i){if(void 0===s)return function(t){return u=t,s=v(y,e),c?f(t):o}(l);if(h)return s=v(y,e),f(l)}return void 0===s&&(s=v(y,e)),o}return e=+e||0,V(i)&&(c=!!i.leading,(h="maxWait"in i)&&(a=Math.max(Q(i.maxWait)?i.maxWait:0,e)),d="trailing"in i?!!i.trailing:d),_.cancel=function(){void 0!==s&&function(t){if(p)return cancelAnimationFrame(t);clearTimeout(t)}(s),u=0,n=l=r=s=void 0},_.flush=function(){return void 0===s?o:m(Date.now())},_.pending=function(){return void 0!==s},_}function Zt(t,e,i){var n=!0,r=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return V(i)&&(n="leading"in i?!!i.leading:n,r="trailing"in i?!!i.trailing:r),qt(t,e,{leading:n,trailing:r,maxWait:e})}function Jt(t,e){return function(i){return t*(1-i)+e*i}}function Qt(t,e){return function(i){return Math.round(t*(1-i)+e*i)}}Kt=!1;var $t=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,te=new RegExp($t.source,"g");function ee(t){if(Q(t))return t;var e=+t;return Q(e)?e:0}function ie(t){return parseFloat("0."+Math.sin(t).toString().substring(6))}var ne=1e-12,re=Math.PI,ae=re/2,oe=2*re,se=2*Math.PI,le=Math.abs,ue=Math.atan2,ce=Math.cos,he=Math.max,de=Math.min,pe=Math.sin,fe=Math.sqrt,ve=Math.pow;function ge(t){return t>=1?ae:t<=-1?-ae:Math.asin(t)}function ye(t,e,i,n,r){var a=i,o=n;return"number"==typeof t&&"number"==typeof i&&(a=(1-r)*t+r*i),"number"==typeof e&&"number"==typeof n&&(o=(1-r)*e+r*n),{x:a,y:o}}function me(t,e){return t[0]*e[1]-t[1]*e[0]}function _e(t,e){for(var i=0,n=0;n<t.length;++n)i+=t[n]*e[n];return i}function be(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return Math.round(t*e)/e}function xe(t){var e=t.toString().split(/[eE]/),i=(e[0].split(".")[1]||"").length-(+e[1]||0);return i>0?i:0}function ke(t,e){return be(t+e,Math.pow(10,Math.max(xe(t),xe(e))))}function Se(t,e){return be(t-e,Math.pow(10,Math.max(xe(t),xe(e))))}var Ae=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;r(this,t),this.x=0,this.y=0,this.x=e,this.y=i,this.x1=n,this.y1=a}return o(t,[{key:"clone",value:function(){return new t(this.x,this.y)}},{key:"copyFrom",value:function(t){return this.x=t.x,this.y=t.y,this.x1=t.x1,this.y1=t.y1,this.defined=t.defined,this.context=t.context,this}},{key:"set",value:function(t,e){return this.x=t,this.y=e,this}},{key:"add",value:function(t){return Z(t)?(this.x+=t,void(this.y+=t)):(this.x+=t.x,this.y+=t.y,this)}},{key:"sub",value:function(t){return Z(t)?(this.x-=t,void(this.y-=t)):(this.x-=t.x,this.y-=t.y,this)}},{key:"multi",value:function(t){throw new Error("暂不支持")}},{key:"div",value:function(t){throw new Error("暂不支持")}}])}(),Me=function(){return o((function t(){r(this,t)}),null,[{key:"distancePP",value:function(t,e){return fe(ve(t.x-e.x,2)+ve(t.y-e.y,2))}},{key:"distanceNN",value:function(t,e,i,n){return fe(ve(t-i,2)+ve(e-n,2))}},{key:"distancePN",value:function(t,e,i){return fe(ve(e-t.x,2)+ve(i-t.y,2))}},{key:"pointAtPP",value:function(t,e,i){return new Ae((e.x-t.x)*i+t.x,(e.y-t.y)*i+t.y)}}])}();function we(t){return t*(Math.PI/180)}function Te(t){return 180*t/Math.PI}var Ce,Ee=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(t<0)for(;t<-oe;)t+=oe;else if(t>0)for(;t>oe;)t-=oe;return t};function Pe(t,e,i){return e?{x:t.x+e*Math.cos(i),y:t.y+e*Math.sin(i)}:{x:t.x,y:t.y}}function Re(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI,r=t.x,a=t.y,o=r-e.x,s=a-e.y,l=Math.sqrt(o*o+s*s);if(0===l)return{radius:0,angle:0};o/=l,s/=l;var u=Math.atan2(s,o);if(u<i)for(;u<=i;)u+=2*Math.PI;if(u>n)for(;u>=n;)u-=2*Math.PI;return{radius:l,angle:u}}function Be(t,e){return Math.atan2(e.y-t.y,e.x-t.x)}function Ie(t){for(;t<0;)t+=2*Math.PI;for(;t>=2*Math.PI;)t-=2*Math.PI;return t}function Le(t,e,i,n){var r=e.x,a=e.y,o=function(t,e){var i=Math.abs(e-t);if(i>=2*Math.PI||2*Math.PI-i<1e-6)return[0,Math.PI/2,Math.PI,1.5*Math.PI];for(var n=Ie(Math.min(t,e)),r=n+i,a=[n,r],o=Math.floor(n/Math.PI)*Math.PI/2;o<r;)o>n&&a.push(o),o+=Math.PI/2;return a}(i,n),s=t.width,l=t.height,u=[];return o.forEach((function(t){var e=Math.sin(t),i=Math.cos(t);1===e?u.push(l-a):-1===e?u.push(a):1===i?u.push(s-r):-1===i?u.push(r):(e>0?u.push(Math.abs((l-a)/e)):u.push(Math.abs(a/e)),i>0?u.push(Math.abs((s-r)/i)):u.push(Math.abs(r/i)))})),Math.min.apply(null,u)}function De(t){return(t=Ie(t))>0&&t<=Math.PI/2?2:t>Math.PI/2&&t<=Math.PI?3:t>Math.PI&&t<=3*Math.PI/2?4:1}function Oe(t,e,i){t[0]=e[0]-i[0],t[1]=e[1]-i[1]}function Fe(t,e,i,n){var r,a,o,s,l=t[0],u=e[0],c=i[0],h=n[0];return u<l&&(l=(r=[u,l])[0],u=r[1]),h<c&&(h=(a=[c,h])[0],c=a[1]),!(u<c||h<l||(l=t[1],u=e[1],c=i[1],h=n[1],u<l&&(o=[u,l],l=o[0],u=o[1]),h<c&&(s=[c,h],h=s[0],c=s[1]),u<c||h<l))}function ze(t,e,i,n){if(!Fe(t,e,i,n))return!1;var r=[0,0],a=[0,0],o=[0,0];if(Oe(r,e,t),Oe(a,n,i),function(t,e){return le(t[0]-e[0])+le(t[1]-e[1])<1e-12}(r,a))return!0;Oe(o,i,t);var s=me(o,a)/me(r,a);return s>=0&&s<=1&&[t[0]+r[0]*s,t[1]+r[1]*s]}function He(t,e,i){if(null===t)return e;if(null===e)return t;var n=Ge(t,e,i),r=n.x11,a=n.x12,o=n.y11,s=n.y12,l=n.x21,u=n.x22,c=n.y21,h=n.y22;return r>=u||a<=l||o>=h||s<=c?{x1:0,y1:0,x2:0,y2:0}:{x1:Math.max(r,l),y1:Math.max(o,c),x2:Math.min(a,u),y2:Math.min(s,h)}}!function(t){t[t.NONE=0]="NONE",t[t.BBOX1=1]="BBOX1",t[t.BBOX2=2]="BBOX2"}(Ce||(Ce={}));var je,Ne,Ve,We,Ge=function(t,e,i){var n,r,a,o,s=t.x1,l=t.x2,u=t.y1,c=t.y2,h=e.x1,d=e.x2,p=e.y1,f=e.y2;return i&&(s>l&&(s=(n=[l,s])[0],l=n[1]),u>c&&(u=(r=[c,u])[0],c=r[1]),h>d&&(h=(a=[d,h])[0],d=a[1]),p>f&&(p=(o=[f,p])[0],f=o[1])),{x11:s,x12:l,y11:u,y12:c,x21:h,x22:d,y21:p,y22:f}};function Ue(t,e,i){if(!t||!e)return Ce.NONE;var n=Ge(t,e,i),r=n.x11,a=n.x12,o=n.y11,s=n.y12,l=n.x21,u=n.x22,c=n.y21,h=n.y22;return r>l&&a<u&&o>c&&s<h?Ce.BBOX1:l>r&&u<a&&c>o&&h<s?Ce.BBOX2:Ce.NONE}function Ye(t,e,i){if(t&&e){if(!i)return!(t.x1>e.x2||t.x2<e.x1||t.y1>e.y2||t.y2<e.y1);var n=Ge(t,e,!0),r=n.x11,a=n.x12,o=n.y11,s=n.y12,l=n.x21,u=n.x22,c=n.y21,h=n.y22;return!(r>u||a<l||o>h||s<c)}return!0}function Xe(t,e,i){var n,r;if(!e)return!0;if(!i)return t.x>=e.x1&&t.x<=e.x2&&t.y>=e.y1&&t.y<=e.y2;var a=e.x1,o=e.x2,s=e.y1,l=e.y2;return a>o&&(a=(n=[o,a])[0],o=n[1]),s>l&&(s=(r=[l,s])[0],l=r[1]),t.x>=a&&t.x<=o&&t.y>=s&&t.y<=l}function Ke(t,e){return Math.abs(e[0]*t[0]+e[1]*t[1])}function qe(t,e){var i=t.x,n=t.y,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0};return{x:(i-r.x)*Math.cos(e)-(n-r.y)*Math.sin(e)+r.x,y:(i-r.x)*Math.sin(e)+(n-r.y)*Math.cos(e)+r.y}}function Ze(t){return{x:(t.x1+t.x2)/2,y:(t.y1+t.y2)/2}}function Je(t,e){var i=e?we(t.angle):t.angle,n=Ze(t);return[qe({x:t.x1,y:t.y1},i,n),qe({x:t.x2,y:t.y1},i,n),qe({x:t.x2,y:t.y2},i,n),qe({x:t.x1,y:t.y2},i,n)]}function Qe(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=Je(t,i),r=Je(e,i),a=function(t,e){return[e.x-t.x,e.y-t.y]},o=a(Ze(t),Ze(e)),s=a(n[0],n[1]),l=a(n[1],n[2]),u=a(r[0],r[1]),c=a(r[1],r[2]),h=i?we(t.angle):t.angle,d=i?we(90-t.angle):t.angle+ae,p=i?we(e.angle):e.angle,f=i?we(90-e.angle):e.angle+ae;d>se&&(d-=se),f>se&&(f-=se);var v=function(t,e,i,n){var r=[Math.cos(e),Math.sin(e)];return t+(Ke(r,i)+Ke(r,n))/2>Ke(r,o)};return v((t.x2-t.x1)/2,h,u,c)&&v((t.y2-t.y1)/2,d,u,c)&&v((e.x2-e.x1)/2,p,s,l)&&v((e.y2-e.y1)/2,f,s,l)}function $e(t){return je=1/0,Ne=1/0,Ve=-1/0,We=-1/0,t.forEach((function(t){je>t.x&&(je=t.x),Ve<t.x&&(Ve=t.x),Ne>t.y&&(Ne=t.y),We<t.y&&(We=t.y)})),{x1:je,y1:Ne,x2:Ve,y2:We}}var ti=1e-8;function ei(t,e,i,n,r){for(var a=0,o=r[r.length-1];a<r.length;a++){var s=r[a];if(Fe([t,e],[i,n],[s.x,s.y],[o.x,o.y]))return!0;o=s}return!1}function ii(t,e,i){var n=0,r=t[0];if(!r)return!1;for(var a=1;a<t.length;a++){var o=t[a];n+=ni(r.x,r.y,o.x,o.y,e,i),r=o}var s=t[0];return ri(r.x,s.x)&&ri(r.y,s.y)||(n+=ni(r.x,r.y,s.x,s.y,e,i)),0!==n}function ni(t,e,i,n,r,a){if(a>e&&a>n||a<e&&a<n)return 0;if(n===e)return 0;var o=(a-e)/(n-e),s=n<e?1:-1;1!==o&&0!==o||(s=n<e?.5:-.5);var l=o*(i-t)+t;return l===r?1/0:l>r?s:0}function ri(t,e){return Math.abs(t-e)<ti}var ai=function(t){var e=t.charCodeAt(0),i=2===t.length?t.charCodeAt(1):0,n=e;return 55296<=e&&e<=56319&&56320<=i&&i<=57343&&(n=(e&=1023)<<10|(i&=1023),n+=65536),12288===n||65281<=n&&n<=65376||65504<=n&&n<=65510?"F":8361===n||65377<=n&&n<=65470||65474<=n&&n<=65479||65482<=n&&n<=65487||65490<=n&&n<=65495||65498<=n&&n<=65500||65512<=n&&n<=65518?"H":4352<=n&&n<=4447||4515<=n&&n<=4519||4602<=n&&n<=4607||9001<=n&&n<=9002||11904<=n&&n<=11929||11931<=n&&n<=12019||12032<=n&&n<=12245||12272<=n&&n<=12283||12289<=n&&n<=12350||12353<=n&&n<=12438||12441<=n&&n<=12543||12549<=n&&n<=12589||12593<=n&&n<=12686||12688<=n&&n<=12730||12736<=n&&n<=12771||12784<=n&&n<=12830||12832<=n&&n<=12871||12880<=n&&n<=13054||13056<=n&&n<=19903||19968<=n&&n<=42124||42128<=n&&n<=42182||43360<=n&&n<=43388||44032<=n&&n<=55203||55216<=n&&n<=55238||55243<=n&&n<=55291||63744<=n&&n<=64255||65040<=n&&n<=65049||65072<=n&&n<=65106||65108<=n&&n<=65126||65128<=n&&n<=65131||110592<=n&&n<=110593||127488<=n&&n<=127490||127504<=n&&n<=127546||127552<=n&&n<=127560||127568<=n&&n<=127569||131072<=n&&n<=194367||177984<=n&&n<=196605||196608<=n&&n<=262141?"W":32<=n&&n<=126||162<=n&&n<=163||165<=n&&n<=166||172===n||175===n||10214<=n&&n<=10221||10629<=n&&n<=10630?"Na":161===n||164===n||167<=n&&n<=168||170===n||173<=n&&n<=174||176<=n&&n<=180||182<=n&&n<=186||188<=n&&n<=191||198===n||208===n||215<=n&&n<=216||222<=n&&n<=225||230===n||232<=n&&n<=234||236<=n&&n<=237||240===n||242<=n&&n<=243||247<=n&&n<=250||252===n||254===n||257===n||273===n||275===n||283===n||294<=n&&n<=295||299===n||305<=n&&n<=307||312===n||319<=n&&n<=322||324===n||328<=n&&n<=331||333===n||338<=n&&n<=339||358<=n&&n<=359||363===n||462===n||464===n||466===n||468===n||470===n||472===n||474===n||476===n||593===n||609===n||708===n||711===n||713<=n&&n<=715||717===n||720===n||728<=n&&n<=731||733===n||735===n||768<=n&&n<=879||913<=n&&n<=929||931<=n&&n<=937||945<=n&&n<=961||963<=n&&n<=969||1025===n||1040<=n&&n<=1103||1105===n||8208===n||8211<=n&&n<=8214||8216<=n&&n<=8217||8220<=n&&n<=8221||8224<=n&&n<=8226||8228<=n&&n<=8231||8240===n||8242<=n&&n<=8243||8245===n||8251===n||8254===n||8308===n||8319===n||8321<=n&&n<=8324||8364===n||8451===n||8453===n||8457===n||8467===n||8470===n||8481<=n&&n<=8482||8486===n||8491===n||8531<=n&&n<=8532||8539<=n&&n<=8542||8544<=n&&n<=8555||8560<=n&&n<=8569||8585===n||8592<=n&&n<=8601||8632<=n&&n<=8633||8658===n||8660===n||8679===n||8704===n||8706<=n&&n<=8707||8711<=n&&n<=8712||8715===n||8719===n||8721===n||8725===n||8730===n||8733<=n&&n<=8736||8739===n||8741===n||8743<=n&&n<=8748||8750===n||8756<=n&&n<=8759||8764<=n&&n<=8765||8776===n||8780===n||8786===n||8800<=n&&n<=8801||8804<=n&&n<=8807||8810<=n&&n<=8811||8814<=n&&n<=8815||8834<=n&&n<=8835||8838<=n&&n<=8839||8853===n||8857===n||8869===n||8895===n||8978===n||9312<=n&&n<=9449||9451<=n&&n<=9547||9552<=n&&n<=9587||9600<=n&&n<=9615||9618<=n&&n<=9621||9632<=n&&n<=9633||9635<=n&&n<=9641||9650<=n&&n<=9651||9654<=n&&n<=9655||9660<=n&&n<=9661||9664<=n&&n<=9665||9670<=n&&n<=9672||9675===n||9678<=n&&n<=9681||9698<=n&&n<=9701||9711===n||9733<=n&&n<=9734||9737===n||9742<=n&&n<=9743||9748<=n&&n<=9749||9756===n||9758===n||9792===n||9794===n||9824<=n&&n<=9825||9827<=n&&n<=9829||9831<=n&&n<=9834||9836<=n&&n<=9837||9839===n||9886<=n&&n<=9887||9918<=n&&n<=9919||9924<=n&&n<=9933||9935<=n&&n<=9953||9955===n||9960<=n&&n<=9983||10045===n||10071===n||10102<=n&&n<=10111||11093<=n&&n<=11097||12872<=n&&n<=12879||57344<=n&&n<=63743||65024<=n&&n<=65039||65533===n||127232<=n&&n<=127242||127248<=n&&n<=127277||127280<=n&&n<=127337||127344<=n&&n<=127386||917760<=n&&n<=917999||983040<=n&&n<=1048573||1048576<=n&&n<=1114109?"A":"N"};function oi(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;i||(i=1);var n=t.fontStyle,r=void 0===n?e.fontStyle:n,a=t.fontVariant,o=void 0===a?e.fontVariant:a,s=t.fontWeight,l=void 0===s?e.fontWeight:s,u=t.fontSize,c=void 0===u?e.fontSize:u,h=t.fontFamily;return(r?r+" ":"")+(o?o+" ":"")+(l?l+" ":"")+c*i+"px "+((void 0===h?e.fontFamily:h)||"sans-serif")}var si=function(){function t(e,i){r(this,t),this._numberCharSize=null,this._fullCharSize=null,this._letterCharSize=null,this._specialCharSizeMap={},this._canvas=null,this._context=null,this._contextSaved=!1,this._notSupportCanvas=!1,this._notSupportVRender=!1,this._userSpec={},this.specialCharSet="-/: .,@%'\"~",this._option=e,this._userSpec=null!=i?i:{},this.textSpec=this._initSpec(),N(e.specialCharSet)&&(this.specialCharSet=e.specialCharSet),this._standardMethod=N(e.getTextBounds)?this.fullMeasure.bind(this):this.measureWithNaiveCanvas.bind(this)}return o(t,[{key:"initContext",value:function(){if(this._notSupportCanvas)return!1;if(j(this._canvas)&&(N(this._option.getCanvasForMeasure)&&(this._canvas=this._option.getCanvasForMeasure()),j(this._canvas)&&"undefined"!=typeof window&&void 0!==window.document&&globalThis&&N(globalThis.document)&&(this._canvas=globalThis.document.createElement("canvas"))),j(this._context)&&N(this._canvas)){var t=this._canvas.getContext("2d");N(t)&&(t.save(),t.font=oi(this.textSpec),this._contextSaved=!0,this._context=t)}return!j(this._context)||(this._notSupportCanvas=!0,!1)}},{key:"_initSpec",value:function(){var t,e,i,n=this._option.defaultFontParams,r=void 0===n?{}:n,a=this._userSpec,o=a.fontStyle,s=void 0===o?r.fontStyle:o,l=a.fontVariant,u=void 0===l?r.fontVariant:l,c=a.fontWeight,h=void 0===c?null!==(t=r.fontWeight)&&void 0!==t?t:"normal":c,d=a.fontSize,p=void 0===d?null!==(e=r.fontSize)&&void 0!==e?e:12:d,f=a.fontFamily,v=void 0===f?null!==(i=r.fontFamily)&&void 0!==i?i:"sans-serif":f,g=a.align,y=a.textAlign,m=void 0===y?null!=g?g:"center":y,_=a.baseline,b=a.textBaseline,x=void 0===b?null!=_?_:"middle":b,k=a.ellipsis,S=a.limit,A=this._userSpec.lineHeight,M=void 0===A?p:A;if(Y(M)&&"%"===M[M.length-1]){var w=Number.parseFloat(M.substring(0,M.length-1))/100;M=p*w}return{fontStyle:s,fontVariant:u,fontFamily:v,fontSize:p,fontWeight:h,textAlign:m,textBaseline:x,ellipsis:k,limit:S,lineHeight:M}}},{key:"measure",value:function(t,e){switch(e){case"vrender":case"canopus":return this.fullMeasure(t);case"canvas":return this.measureWithNaiveCanvas(t);case"simple":return this.quickMeasureWithoutCanvas(t);default:return this.quickMeasure(t)}}},{key:"fullMeasure",value:function(t){if(j(t))return{width:0,height:0};if(j(this._option.getTextBounds)||!this._notSupportVRender)return this.measureWithNaiveCanvas(t);var e,i=this.textSpec,n=i.fontFamily,r=i.fontSize,a=i.fontWeight,o=i.textAlign,s=i.textBaseline,l=i.ellipsis,u=i.limit,c=i.lineHeight;try{var h=this._option.getTextBounds({text:t,fontFamily:n,fontSize:r,fontWeight:a,textAlign:o,textBaseline:s,ellipsis:!!l,maxLineWidth:u||1/0,lineHeight:c});e={width:h.width(),height:h.height()}}catch(i){this._notSupportVRender=!0,e=this.measureWithNaiveCanvas(t)}return e}},{key:"measureWithNaiveCanvas",value:function(t){return this._measureReduce(t,this._measureWithNaiveCanvas.bind(this))}},{key:"_measureWithNaiveCanvas",value:function(t){var e;if(!this.initContext())return this._quickMeasureWithoutCanvas(t);var i=this._context.measureText(t),n=this.textSpec,r=n.fontSize,a=n.lineHeight;return{width:i.width,height:null!==(e=a)&&void 0!==e?e:r,fontBoundingBoxAscent:i.fontBoundingBoxAscent,fontBoundingBoxDescent:i.fontBoundingBoxDescent}}},{key:"quickMeasure",value:function(t){return this._measureReduce(t,this._quickMeasure.bind(this))}},{key:"_quickMeasure",value:function(e){for(var i={width:0,height:0},n=0;n<e.length;n++){var r=e[n],a=this._measureSpecialChar(r);j(a)&&t.NUMBERS_CHAR_SET.includes(r)&&(a=this._measureNumberChar()),j(a)&&["F","W"].includes(ai(r))&&(a=this._measureFullSizeChar()),j(a)&&(a=this._measureLetterChar()),i.width+=a.width,i.height=Math.max(i.height,a.height),!j(a.fontBoundingBoxAscent)&&(i.fontBoundingBoxAscent=a.fontBoundingBoxAscent),!j(a.fontBoundingBoxDescent)&&(i.fontBoundingBoxDescent=a.fontBoundingBoxDescent)}return i}},{key:"quickMeasureWithoutCanvas",value:function(t){return this._measureReduce(t,this._quickMeasureWithoutCanvas.bind(this))}},{key:"_quickMeasureWithoutCanvas",value:function(t){for(var e,i={width:0,height:0},n=this.textSpec,r=n.fontSize,a=n.lineHeight,o=0;o<t.length;o++){var s=t[o],l=["F","W"].includes(ai(s))?1:.53;i.width+=l*r}return i.height=null!==(e=a)&&void 0!==e?e:r,i}},{key:"_measureReduce",value:function(t,e){var i,n=this.textSpec,r=n.fontSize,a=n.lineHeight,o={width:0,height:0};if(j(t))return o;if(X(t)){var s=t.filter(N).map((function(t){return t.toString()}));return 0===s.length?o:1===s.length?e(s[0]):{width:s.reduce((function(t,i){return Math.max(t,e(i).width)}),0),height:s.length*((null!==(i=a)&&void 0!==i?i:r)+1)+1}}return e(t.toString())}},{key:"_measureNumberChar",value:function(){if(j(this._numberCharSize)){var e=this._standardMethod(t.NUMBERS_CHAR_SET);this._numberCharSize={width:e.width/t.NUMBERS_CHAR_SET.length,height:e.height,fontBoundingBoxAscent:e.fontBoundingBoxAscent,fontBoundingBoxDescent:e.fontBoundingBoxDescent}}return this._numberCharSize}},{key:"_measureFullSizeChar",value:function(){return j(this._fullCharSize)&&(this._fullCharSize=this._standardMethod(t.FULL_SIZE_CHAR)),this._fullCharSize}},{key:"_measureLetterChar",value:function(){if(j(this._letterCharSize)){var e=this._standardMethod(t.ALPHABET_CHAR_SET);this._letterCharSize={width:e.width/t.ALPHABET_CHAR_SET.length,height:e.height,fontBoundingBoxAscent:e.fontBoundingBoxAscent,fontBoundingBoxDescent:e.fontBoundingBoxDescent}}return this._letterCharSize}},{key:"_measureSpecialChar",value:function(t){return N(this._specialCharSizeMap[t])?this._specialCharSizeMap[t]:this.specialCharSet.includes(t)?(this._specialCharSizeMap[t]=this._standardMethod(t),this._specialCharSizeMap[t]):null}},{key:"release",value:function(){N(this._canvas)&&(this._canvas=null),N(this._context)&&(this._contextSaved&&(this._context.restore(),this._contextSaved=!1),this._context=null)}}])}();si.ALPHABET_CHAR_SET="abcdefghijklmnopqrstuvwxyz",si.NUMBERS_CHAR_SET="0123456789",si.FULL_SIZE_CHAR="字";var li=function(t,e){var i=t.x1,n=t.x2,r=t.y1,a=t.y2,o=Math.abs(n-i),s=Math.abs(a-r),l=(i+n)/2,u=(r+a)/2,c=0,h=0;switch(e){case"top":case"inside-top":h=-.5;break;case"bottom":case"inside-bottom":h=.5;break;case"left":case"inside-left":c=-.5;break;case"right":case"inside-right":c=.5;break;case"top-right":c=.5,h=-.5;break;case"top-left":c=-.5,h=-.5;break;case"bottom-right":c=.5,h=.5;break;case"bottom-left":c=-.5,h=.5}return{x:l+=c*o,y:u+=h*s}},ui=function(t,e){return Math.max(e.x1-t.x2,t.x1-e.x2,e.y1-t.y2,t.y1-e.y2)},ci=function(t,e){function i(t,e,i){var n=t.getRotatedCorners().map((function(t){return t.x*e+t.y*i}));return{min:Math.min.apply(Math,m(n)),max:Math.max.apply(Math,m(n))}}for(var n=0,r=0,a=[{x:Math.cos(t.angle),y:Math.sin(t.angle)},{x:-Math.sin(t.angle),y:Math.cos(t.angle)},{x:Math.cos(e.angle),y:Math.sin(t.angle)},{x:-Math.sin(e.angle),y:Math.cos(t.angle)}];r<a.length;r++){var o,s=a[r],l=i(t,s.x,s.y),u=i(e,s.x,s.y);o=l.max<u.min?u.min-l.max:u.max<l.min?l.min-u.max:0,n=Math.max(n,o)}return n};function hi(t,e,i){var n=e.x1,r=e.y1,a=e.x2,o=e.y2;return i.onlyTranslate()?(t!==e&&t.setValue(e.x1,e.y1,e.x2,e.y2),t.translate(i.e,i.f),e):(t.clear(),t.add(i.a*n+i.c*r+i.e,i.b*n+i.d*r+i.f),t.add(i.a*a+i.c*r+i.e,i.b*a+i.d*r+i.f),t.add(i.a*a+i.c*o+i.e,i.b*a+i.d*o+i.f),t.add(i.a*n+i.c*o+i.e,i.b*n+i.d*o+i.f),e)}var di=function(){function t(e){r(this,t),e?this.setValue(e.x1,e.y1,e.x2,e.y2):this.clear()}return o(t,[{key:"clone",value:function(){return new t(this)}},{key:"clear",value:function(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this}},{key:"empty",value:function(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE}},{key:"equals",value:function(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2}},{key:"setValue",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return this.x1=t,this.y1=e,this.x2=i,this.y2=n,this}},{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return i<t?(this.x2=t,this.x1=i):(this.x1=t,this.x2=i),n<e?(this.y2=e,this.y1=n):(this.y1=e,this.y2=n),this}},{key:"add",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this}},{key:"expand",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return X(t)?(this.y1-=t[0],this.x2+=t[1],this.y2+=t[2],this.x1-=t[3]):(this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t),this}},{key:"round",value:function(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this}},{key:"translate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this}},{key:"rotate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=this.rotatedPoints(t,e,i);return this.clear().add(n[0],n[1]).add(n[2],n[3]).add(n[4],n[5]).add(n[6],n[7])}},{key:"scale",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=this.scalePoints(t,e,i,n);return this.clear().add(r[0],r[1]).add(r[2],r[3])}},{key:"union",value:function(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this}},{key:"intersect",value:function(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this}},{key:"encloses",value:function(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2}},{key:"alignsWith",value:function(t){return t&&(this.x1===t.x1||this.x2===t.x2||this.y1===t.y1||this.y2===t.y2)}},{key:"intersects",value:function(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)}},{key:"contains",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)}},{key:"containsPoint",value:function(t){return!(t.x<this.x1||t.x>this.x2||t.y<this.y1||t.y>this.y2)}},{key:"width",value:function(){return this.empty()?0:this.x2-this.x1}},{key:"height",value:function(){return this.empty()?0:this.y2-this.y1}},{key:"scaleX",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.x1*=t,this.x2*=t,this}},{key:"scaleY",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.y1*=t,this.y2*=t,this}},{key:"transformWithMatrix",value:function(t){return hi(this,this,t),this}},{key:"copy",value:function(t){return this.x1=t.x1,this.y1=t.y1,this.x2=t.x2,this.y2=t.y2,this}},{key:"rotatedPoints",value:function(t,e,i){var n=this.x1,r=this.y1,a=this.x2,o=this.y2,s=Math.cos(t),l=Math.sin(t),u=e-e*s+i*l,c=i-e*l-i*s;return[s*n-l*r+u,l*n+s*r+c,s*n-l*o+u,l*n+s*o+c,s*a-l*r+u,l*a+s*r+c,s*a-l*o+u,l*a+s*o+c]}},{key:"scalePoints",value:function(t,e,i,n){return[t*this.x1+(1-t)*i,e*this.y1+(1-e)*n,t*this.x2+(1-t)*i,e*this.y2+(1-e)*n]}}])}(),pi=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e)}(di),fi=function(t){function e(t){var i,a,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return r(this,e),i=n(this,e,[t]),t&&(i.angle=null!==(a=t.angle)&&void 0!==a?a:o),i}return h(e,t),o(e,[{key:"intersects",value:function(t){return Qe(this,t)}},{key:"setValue",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return y(e,"setValue",this,3)([t,i,n,r]),this.angle=a,this}},{key:"clone",value:function(){return new e(this)}},{key:"getRotatedCorners",value:function(){var t={x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2};return[qe({x:this.x1,y:this.y1},this.angle,t),qe({x:this.x2,y:this.y1},this.angle,t),qe({x:this.x1,y:this.y2},this.angle,t),qe({x:this.x2,y:this.y2},this.angle,t)]}}])}(di),vi=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;r(this,t),this.a=e,this.b=i,this.c=n,this.d=a,this.e=o,this.f=s}return o(t,[{key:"equalToMatrix",value:function(t){return!(this.e!==t.e||this.f!==t.f||this.a!==t.a||this.d!==t.d||this.b!==t.b||this.c!==t.c)}},{key:"equalTo",value:function(t,e,i,n,r,a){return!(this.e!==r||this.f!==a||this.a!==t||this.d!==n||this.b!==e||this.c!==i)}},{key:"setValue",value:function(t,e,i,n,r,a){return this.a=t,this.b=e,this.c=i,this.d=n,this.e=r,this.f=a,this}},{key:"reset",value:function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0,this}},{key:"getInverse",value:function(){var e=this.a,i=this.b,n=this.c,r=this.d,a=this.e,o=this.f,s=new t,l=e*r-i*n;return s.a=r/l,s.b=-i/l,s.c=-n/l,s.d=e/l,s.e=(n*o-r*a)/l,s.f=-(e*o-i*a)/l,s}},{key:"rotate",value:function(t){var e=Math.cos(t),i=Math.sin(t),n=this.a*e+this.c*i,r=this.b*e+this.d*i,a=this.a*-i+this.c*e,o=this.b*-i+this.d*e;return this.a=n,this.b=r,this.c=a,this.d=o,this}},{key:"rotateByCenter",value:function(t,e,i){var n=Math.cos(t),r=Math.sin(t),a=(1-n)*e+r*i,o=(1-n)*i-r*e,s=n*this.a-r*this.b,l=r*this.a+n*this.b,u=n*this.c-r*this.d,c=r*this.c+n*this.d,h=n*this.e-r*this.f+a,d=r*this.e+n*this.f+o;return this.a=s,this.b=l,this.c=u,this.d=c,this.e=h,this.f=d,this}},{key:"scale",value:function(t,e){return this.a*=t,this.b*=t,this.c*=e,this.d*=e,this}},{key:"setScale",value:function(t,e){return this.b=this.b/this.a*t,this.c=this.c/this.d*e,this.a=t,this.d=e,this}},{key:"transform",value:function(t,e,i,n,r,a){return this.multiply(t,e,i,n,r,a),this}},{key:"translate",value:function(t,e){return this.e+=this.a*t+this.c*e,this.f+=this.b*t+this.d*e,this}},{key:"transpose",value:function(){var t=this.a,e=this.b,i=this.c,n=this.d,r=this.e,a=this.f;return this.a=e,this.b=t,this.c=n,this.d=i,this.e=a,this.f=r,this}},{key:"multiply",value:function(t,e,i,n,r,a){var o=this.a,s=this.b,l=this.c,u=this.d,c=o*t+l*e,h=s*t+u*e,d=o*i+l*n,p=s*i+u*n,f=o*r+l*a+this.e,v=s*r+u*a+this.f;return this.a=c,this.b=h,this.c=d,this.d=p,this.e=f,this.f=v,this}},{key:"interpolate",value:function(e,i){var n=new t;return n.a=this.a+(e.a-this.a)*i,n.b=this.b+(e.b-this.b)*i,n.c=this.c+(e.c-this.c)*i,n.d=this.d+(e.d-this.d)*i,n.e=this.e+(e.e-this.e)*i,n.f=this.f+(e.f-this.f)*i,n}},{key:"transformPoint",value:function(t,e){var i=this.a,n=this.b,r=this.c,a=this.d,o=this.e,s=this.f,l=i*a-n*r,u=a/l,c=-n/l,h=-r/l,d=i/l,p=(r*s-a*o)/l,f=-(i*s-n*o)/l,v=t.x,g=t.y;e.x=v*u+g*h+p,e.y=v*c+g*d+f}},{key:"onlyTranslate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.a===t&&0===this.b&&0===this.c&&this.d===t}},{key:"clone",value:function(){return new t(this.a,this.b,this.c,this.d,this.e,this.f)}},{key:"toTransformAttrs",value:function(){var t=this.a,e=this.b,i=this.c,n=this.d,r=t*n-e*i,a={x:this.e,y:this.f,rotateDeg:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(0!==t||0!==e){var o=Math.sqrt(t*t+e*e);a.rotateDeg=e>0?Math.acos(t/o):-Math.acos(t/o),a.scaleX=o,a.scaleY=r/o,a.skewX=(t*i+e*n)/r,a.skewY=0}else if(0!==i||0!==n){var s=Math.sqrt(i*i+n*n);a.rotateDeg=Math.PI/2-(n>0?Math.acos(-i/s):-Math.acos(i/s)),a.scaleX=r/s,a.scaleY=s,a.skewX=0,a.skewY=(t*i+e*n)/r}return a.rotateDeg=Te(a.rotateDeg),a}}])}();var gi=function(){return o((function t(){r(this,t),this.CLEAN_THRESHOLD=1e3,this.L_TIME=1e3,this.R_COUNT=1,this.R_TIMESTAMP_MAX_SIZE=20}),[{key:"clearCache",value:function(t,e){var i=e.CLEAN_THRESHOLD,n=void 0===i?this.CLEAN_THRESHOLD:i,r=e.L_TIME,a=void 0===r?this.L_TIME:r,o=e.R_COUNT,s=void 0===o?this.R_COUNT:o;if(t.size<n)return 0;var l=0,u=function(e){l++,t.delete(e)},c=Date.now();return t.forEach((function(t,e){if(t.timestamp.length<s)return u(e);for(var i=0;c-t.timestamp[t.timestamp.length-1-i]<a&&!(++i>=s););if(i<s)return u(e);for(;c-t.timestamp[0]>a;)t.timestamp.shift()})),l}},{key:"addLimitedTimestamp",value:function(t,e,i){var n=i.R_TIMESTAMP_MAX_SIZE,r=void 0===n?this.R_TIMESTAMP_MAX_SIZE:n;t.timestamp.length>r&&t.timestamp.shift(),t.timestamp.push(e)}},{key:"clearTimeStamp",value:function(t,e){var i=e.L_TIME,n=void 0===i?this.L_TIME:i,r=Date.now();t.forEach((function(t){for(;r-t.timestamp[0]>n;)t.timestamp.shift()}))}},{key:"clearItemTimestamp",value:function(t,e){for(var i=e.L_TIME,n=void 0===i?this.L_TIME:i,r=Date.now();r-t.timestamp[0]>n;)t.timestamp.shift()}}])}();function yi(t,e,i){e/=100,i/=100;var n=(1-Math.abs(2*i-1))*e,r=n*(1-Math.abs(t/60%2-1)),a=i-n/2,o=0,s=0,l=0;return 0<=t&&t<60?(o=n,s=r,l=0):60<=t&&t<120?(o=r,s=n,l=0):120<=t&&t<180?(o=0,s=n,l=r):180<=t&&t<240?(o=0,s=r,l=n):240<=t&&t<300?(o=r,s=0,l=n):300<=t&&t<360&&(o=n,s=0,l=r),{r:o=Math.round(255*(o+a)),g:s=Math.round(255*(s+a)),b:l=Math.round(255*(l+a))}}function mi(t,e,i){t/=255,e/=255,i/=255;var n=Math.min(t,e,i),r=Math.max(t,e,i),a=r-n,o=0,s=0;return o=0===a?0:r===t?(e-i)/a%6:r===e?(i-t)/a+2:(t-e)/a+4,(o=Math.round(60*o))<0&&(o+=360),s=(r+n)/2,{h:o,s:+(100*(0===a?0:a/(1-Math.abs(2*s-1)))).toFixed(1),l:s=+(100*s).toFixed(1)}}var _i=/^#([0-9a-f]{3,8})$/,bi={transparent:4294967040},xi={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function ki(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function Si(t){return Z(t)?new Ci(t>>16,t>>8&255,255&t,1):X(t)?new Ci(t[0],t[1],t[2]):new Ci(255,255,255)}function Ai(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function Mi(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}var wi=function(t,e){var i=_i.exec(t);if(e||i){var n=parseInt(i[1],16),r=i[1].length;return 3===r?new Ci((n>>8&15)+((n>>8&15)<<4),(n>>4&15)+((n>>4&15)<<4),(15&n)+((15&n)<<4),1):6===r?Si(n):8===r?new Ci(n>>24&255,n>>16&255,n>>8&255,(255&n)/255):null}},Ti=function(){function t(e){r(this,t);var i=t.parseColorString(e);i?this.color=i:(console.warn("Warn: 传入".concat(e,"无法解析为Color")),this.color=new Ci(255,255,255))}return o(t,[{key:"toRGBA",value:function(){return this.color.formatRgb()}},{key:"toString",value:function(){return this.color.formatRgb()}},{key:"toHex",value:function(){return this.color.formatHex()}},{key:"toHsl",value:function(){return this.color.formatHsl()}},{key:"brighter",value:function(t){var e=this.color,i=e.r,n=e.g,r=e.b;return this.color.r=Math.max(0,Math.min(255,Math.floor(i*t))),this.color.g=Math.max(0,Math.min(255,Math.floor(n*t))),this.color.b=Math.max(0,Math.min(255,Math.floor(r*t))),this}},{key:"add",value:function(t){var e=this.color,i=e.r,n=e.g,r=e.b;return this.color.r+=Math.min(255,i+t.color.r),this.color.g+=Math.min(255,n+t.color.g),this.color.b+=Math.min(255,r+t.color.b),this}},{key:"sub",value:function(t){return this.color.r=Math.max(0,this.color.r-t.color.r),this.color.g=Math.max(0,this.color.g-t.color.g),this.color.b=Math.max(0,this.color.b-t.color.b),this}},{key:"multiply",value:function(t){var e=this.color,i=e.r,n=e.g,r=e.b;return this.color.r=Math.max(0,Math.min(255,Math.floor(i*t.color.r))),this.color.g=Math.max(0,Math.min(255,Math.floor(n*t.color.g))),this.color.b=Math.max(0,Math.min(255,Math.floor(r*t.color.b))),this}},{key:"getHSVBrightness",value:function(){return Math.max(this.color.r,this.color.g,this.color.b)/255}},{key:"getHSLBrightness",value:function(){return.5*(Math.max(this.color.r,this.color.g,this.color.b)/255+Math.min(this.color.r,this.color.g,this.color.b)/255)}},{key:"setHsl",value:function(t,e,i){var n=this.color.opacity,r=mi(this.color.r,this.color.g,this.color.b),a=yi(j(t)?r.h:Ut(t,0,360),j(e)?r.s:e>=0&&e<=1?100*e:e,j(i)?r.l:i<=1&&i>=0?100*i:i);return this.color=new Ci(a.r,a.g,a.b,n),this}},{key:"setRGB",value:function(t,e,i){return!j(t)&&(this.color.r=t),!j(e)&&(this.color.g=e),!j(i)&&(this.color.b=i),this}},{key:"setHex",value:function(t){var e="".concat(t).trim().toLowerCase(),i=wi(e,!0);return null!=i?i:this}},{key:"setColorName",value:function(t){var e=xi[t.toLowerCase()];return void 0!==e?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this}},{key:"setScalar",value:function(t){return this.color.r=t,this.color.g=t,this.color.b=t,this}},{key:"setOpacity",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.color.opacity=t,this}},{key:"getLuminance",value:function(){return(.2126*this.color.r+.7152*this.color.g+.0722*this.color.b)/255}},{key:"getLuminance2",value:function(){return(.2627*this.color.r+.678*this.color.g+.0593*this.color.b)/255}},{key:"getLuminance3",value:function(){return(.299*this.color.r+.587*this.color.g+.114*this.color.b)/255}},{key:"getLuminanceWCAG",value:function(){var t=this.color.r/255,e=this.color.g/255,i=this.color.b/255;return.2126*(t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4))+.7152*(e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4))+.0722*(i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4))}},{key:"clone",value:function(){return new t(this.color.toString())}},{key:"copyGammaToLinear",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return this.color.r=Math.pow(t.color.r,e),this.color.g=Math.pow(t.color.g,e),this.color.b=Math.pow(t.color.b,e),this}},{key:"copyLinearToGamma",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,i=e>0?1/e:1;return this.color.r=Math.pow(t.color.r,i),this.color.g=Math.pow(t.color.g,i),this.color.b=Math.pow(t.color.b,i),this}},{key:"convertGammaToLinear",value:function(t){return this.copyGammaToLinear(this,t),this}},{key:"convertLinearToGamma",value:function(t){return this.copyLinearToGamma(this,t),this}},{key:"copySRGBToLinear",value:function(t){return this.color.r=Ai(t.color.r),this.color.g=Ai(t.color.g),this.color.b=Ai(t.color.b),this}},{key:"copyLinearToSRGB",value:function(t){return this.color.r=Mi(t.color.r),this.color.g=Mi(t.color.g),this.color.b=Mi(t.color.b),this}},{key:"convertSRGBToLinear",value:function(){return this.copySRGBToLinear(this),this}},{key:"convertLinearToSRGB",value:function(){return this.copyLinearToSRGB(this),this}}],[{key:"Brighter",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return 1===i?e:new t(e).brighter(i).toRGBA()}},{key:"SetOpacity",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return 1===i?e:new t(e).setOpacity(i).toRGBA()}},{key:"getColorBrightness",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"hsl",n=e instanceof t?e:new t(e);switch(i){case"hsv":default:return n.getHSVBrightness();case"hsl":return n.getHSLBrightness();case"lum":return n.getLuminance();case"lum2":return n.getLuminance2();case"lum3":return n.getLuminance3();case"wcag":return n.getLuminanceWCAG()}}},{key:"parseColorString",value:function(t){if(N(bi[t]))return function(t){return Z(t)?new Ci(t>>>24,t>>>16&255,t>>>8&255,255&t):X(t)?new Ci(t[0],t[1],t[2],t[3]):new Ci(255,255,255,1)}(bi[t]);if(N(xi[t]))return Si(xi[t]);var e="".concat(t).trim().toLowerCase(),i=wi(e);if(void 0!==i)return i;if(/^(rgb|RGB|rgba|RGBA)/.test(e)){var n=e.replace(/(?:\(|\)|rgba|RGBA|rgb|RGB)*/g,"").split(",");return new Ci(parseInt(n[0],10),parseInt(n[1],10),parseInt(n[2],10),parseFloat(n[3]))}if(/^(hsl|HSL|hsla|HSLA)/.test(e)){var r=e.replace(/(?:\(|\)|hsla|HSLA|hsl|HSL)*/g,"").split(","),a=yi(parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10));return new Ci(a.r,a.g,a.b,parseFloat(r[3]))}}}])}(),Ci=function(){return o((function t(e,i,n,a){r(this,t),this.r=isNaN(+e)?255:Math.max(0,Math.min(255,+e)),this.g=isNaN(+i)?255:Math.max(0,Math.min(255,+i)),this.b=isNaN(+n)?255:Math.max(0,Math.min(255,+n)),N(a)?this.opacity=isNaN(+a)?1:Math.max(0,Math.min(1,+a)):this.opacity=1}),[{key:"formatHex",value:function(){return"#".concat(ki(this.r)+ki(this.g)+ki(this.b)+(1===this.opacity?"":ki(255*this.opacity)))}},{key:"formatRgb",value:function(){var t=this.opacity;return"".concat(1===t?"rgb(":"rgba(").concat(this.r,",").concat(this.g,",").concat(this.b).concat(1===t?")":",".concat(t,")"))}},{key:"formatHsl",value:function(){var t=this.opacity,e=mi(this.r,this.g,this.b),i=e.h,n=e.s,r=e.l;return"".concat(1===t?"hsl(":"hsla(").concat(i,",").concat(n,"%,").concat(r,"%").concat(1===t?")":",".concat(t,")"))}},{key:"toString",value:function(){return this.formatHex()}}])}();function Ei(t){if(Q(t))return[t,t,t,t];if(X(t)){var e=t.length;if(1===e){var i=t[0];return[i,i,i,i]}if(2===e){var n=g(t,2),r=n[0],a=n[1];return[r,a,r,a]}if(3===e){var o=g(t,3),s=o[0],l=o[1];return[s,l,o[2],l]}if(4===e)return t}if(V(t)){var u=t.top,c=void 0===u?0:u,h=t.right,d=void 0===h?0:h,p=t.bottom,f=void 0===p?0:p,v=t.left;return[c,d,f,void 0===v?0:v]}return[0,0,0,0]}function Pi(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!t)return{width:i,height:n};try{e=null===window||void 0===window?void 0:window.getComputedStyle}catch(t){e=function(){return{}}}var r=e(t);if(/^(\d*\.?\d+)(px)$/.exec(r.width)){var a=parseFloat(r.width)-parseFloat(r.paddingLeft)-parseFloat(r.paddingRight)||t.clientWidth-1,o=parseFloat(r.height)-parseFloat(r.paddingTop)-parseFloat(r.paddingBottom)||t.clientHeight-1;return{width:a<=0?i:a,height:o<=0?n:o}}return{width:i,height:n}}var Ri=function(t){return t.replace(/([A-Z])/g,"-$1").toLowerCase()};function Bi(t){return t.replace(/-([a-z])/g,(function(t,e){return e.toUpperCase()}))}var Ii=6371008.8,Li={centimeters:637100880,centimetres:637100880,degrees:57.22891354143274,feet:20902260.511392,inches:39.37*Ii,kilometers:6371.0088,kilometres:6371.0088,meters:Ii,metres:Ii,miles:3958.761333810546,millimeters:6371008800,millimetres:6371008800,nauticalmiles:Ii/1852,radians:1,yards:6967335.223679999};function Di(t,e,i){void 0===i&&(i={});var n={type:"Feature"};return(0===i.id||i.id)&&(n.id=i.id),i.bbox&&(n.bbox=i.bbox),n.properties=e||{},n.geometry=t,n}function Oi(t,e){void 0===e&&(e={});var i={type:"FeatureCollection"};return e.id&&(i.id=e.id),e.bbox&&(i.bbox=e.bbox),i.features=t,i}function Fi(t,e){if(!t)return!1;if(!e)return!1;var i,n="Feature"===(i=e).type?i.geometry:i,r=n.type,a=e.bbox,o=n.coordinates;if(a&&!0===Xe(t,{x1:a[0],x2:a[1],y1:a[1],y2:a[3]},!0))return!1;"Polygon"===r&&(o=[o]);for(var s=!1,l=0;l<o.length;++l)for(var u=0;u<o[l].length;++u)if(ii(o[l][u].map((function(t){return{x:t[0],y:t[1]}})),t.x,t.y))return s=!0;return s}function zi(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=we(t[0]),a=we(t[1]),o=we(i),s=function(t,e){void 0===e&&(e="kilometers");var i=Li[e];if(!i)throw new Error(e+" units is invalid");return t/i}(e,n.units),l=Math.asin(Math.sin(a)*Math.cos(s)+Math.cos(a)*Math.sin(s)*Math.cos(o));return{x:Te(r+Math.atan2(Math.sin(o)*Math.sin(s)*Math.cos(a),Math.cos(s)-Math.sin(a)*Math.sin(l))),y:Te(l)}}var Hi=1e-10;function ji(t,e){var i=function(t){for(var e=[],i=0;i<t.length;++i)for(var n=i+1;n<t.length;++n)for(var r=Wi(t[i],t[n]),a=0;a<r.length;++a){var o=r[a];o.parentIndex=[i,n],e.push(o)}return e}(t),n=i.filter((function(e){return function(t,e){for(var i=0;i<e.length;++i)if(Me.distancePP(t,e[i])>e[i].radius+Hi)return!1;return!0}(e,t)})),r=0,a=0,o=[];if(n.length>1){for(var s=Gi(n),l=0;l<n.length;++l){var u=n[l];u.angle=Math.atan2(u.x-s.x,u.y-s.y)}n.sort((function(t,e){return e.angle-t.angle}));for(var c=n[n.length-1],h=0;h<n.length;++h){var d=n[h];a+=(c.x+d.x)*(d.y-c.y);for(var p={x:(d.x+c.x)/2,y:(d.y+c.y)/2},f=null,v=0;v<d.parentIndex.length;++v)if(c.parentIndex.indexOf(d.parentIndex[v])>-1){var g=t[d.parentIndex[v]],y=Math.atan2(d.x-g.x,d.y-g.y),m=Math.atan2(c.x-g.x,c.y-g.y),_=m-y;_<0&&(_+=2*Math.PI);var b=m-_/2,x=Me.distancePP(p,{x:g.x+g.radius*Math.sin(b),y:g.y+g.radius*Math.cos(b)});x>2*g.radius&&(x=2*g.radius),(null===f||f.width>x)&&(f={circle:g,width:x,p1:d,p2:c})}null!==f&&(o.push(f),r+=Ni(f.circle.radius,f.width),c=d)}}else{for(var k=t[0],S=1;S<t.length;++S)t[S].radius<k.radius&&(k=t[S]);for(var A=!1,M=0;M<t.length;++M)if(Me.distancePP(t[M],k)>Math.abs(k.radius-t[M].radius)){A=!0;break}A?r=a=0:(r=k.radius*k.radius*Math.PI,o.push({circle:k,p1:{x:k.x,y:k.y+k.radius},p2:{x:k.x-Hi,y:k.y+k.radius},width:2*k.radius}))}return a/=2,e&&(e.area=r+a,e.arcArea=r,e.polygonArea=a,e.arcs=o,e.innerPoints=n,e.intersectionPoints=i),r+a}function Ni(t,e){return t*t*Math.acos(1-e/t)-(t-e)*Math.sqrt(e*(2*t-e))}function Vi(t,e,i){if(i>=t+e)return 0;if(i<=Math.abs(t-e))return Math.PI*Math.min(t,e)*Math.min(t,e);var n=e-(i*i-t*t+e*e)/(2*i);return Ni(t,t-(i*i-e*e+t*t)/(2*i))+Ni(e,n)}function Wi(t,e){var i=Me.distancePP(t,e),n=t.radius,r=e.radius;if(i>=n+r||i<=Math.abs(n-r))return[];var a=(n*n-r*r+i*i)/(2*i),o=Math.sqrt(n*n-a*a),s=t.x+a*(e.x-t.x)/i,l=t.y+a*(e.y-t.y)/i,u=-(e.y-t.y)*(o/i),c=-(e.x-t.x)*(o/i);return[{x:s+u,y:l-c},{x:s-u,y:l+c}]}function Gi(t){for(var e={x:0,y:0},i=0;i<t.length;++i)e.x+=t[i].x,e.y+=t[i].y;return e.x/=t.length,e.y/=t.length,e}var Ui,Yi=function(){function t(){var e=this;r(this,t),this.locale_shortWeekdays=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],this.locale_periods=["AM","PM"],this.locale_weekdays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],this.locale_shortMonths=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],this.numberRe=/^\s*\d+/,this.pads={"-":"",_:" ",0:"0"},this.requoteRe=/[\\^$*+?|[\]().{}]/g,this.locale_months=["January","February","March","April","May","June","July","August","September","October","November","December"],this.formatShortWeekday=function(t){return e.locale_shortWeekdays[t.getDay()]},this.formatWeekday=function(t){return e.locale_weekdays[t.getDay()]},this.formatShortMonth=function(t){return e.locale_shortMonths[t.getMonth()]},this.formatMonth=function(t){return e.locale_months[t.getMonth()]},this.formatDayOfMonth=function(t,i){return e.pad(t.getDate(),i,2)},this.formatHour24=function(t,i){return e.pad(t.getHours(),i,2)},this.formatHour12=function(t,i){return e.pad(t.getHours()%12||12,i,2)},this.formatMilliseconds=function(t,i){return e.pad(t.getMilliseconds(),i,3)},this.formatMonthNumber=function(t,i){return e.pad(t.getMonth()+1,i,2)},this.formatMinutes=function(t,i){return e.pad(t.getMinutes(),i,2)},this.formatPeriod=function(t){return e.locale_periods[+(t.getHours()>=12)]},this.formatSeconds=function(t,i){return e.pad(t.getSeconds(),i,2)},this.formatFullYear=function(t,i){return e.pad(t.getFullYear()%1e4,i,4)},this.formatUTCShortWeekday=function(t){return e.locale_shortWeekdays[t.getUTCDay()]},this.formatUTCWeekday=function(t){return e.locale_weekdays[t.getUTCDay()]},this.formatUTCShortMonth=function(t){return e.locale_shortMonths[t.getUTCMonth()]},this.formatUTCMonth=function(t){return e.locale_months[t.getUTCMonth()]},this.formatUTCDayOfMonth=function(t,i){return e.pad(t.getUTCDate(),i,2)},this.formatUTCHour24=function(t,i){return e.pad(t.getUTCHours(),i,2)},this.formatUTCHour12=function(t,i){return e.pad(t.getUTCHours()%12||12,i,2)},this.formatUTCMilliseconds=function(t,i){return e.pad(t.getUTCMilliseconds(),i,3)},this.formatUTCMonthNumber=function(t,i){return e.pad(t.getUTCMonth()+1,i,2)},this.formatUTCMinutes=function(t,i){return e.pad(t.getUTCMinutes(),i,2)},this.formatUTCPeriod=function(t){return e.locale_periods[+(t.getUTCHours()>=12)]},this.formatUTCSeconds=function(t,i){return e.pad(t.getUTCSeconds(),i,2)},this.formatUTCFullYear=function(t,i){return e.pad(t.getUTCFullYear()%1e4,i,4)},this.formats={a:this.formatShortWeekday,A:this.formatWeekday,b:this.formatShortMonth,B:this.formatMonth,d:this.formatDayOfMonth,e:this.formatDayOfMonth,H:this.formatHour24,I:this.formatHour12,L:this.formatMilliseconds,m:this.formatMonthNumber,M:this.formatMinutes,p:this.formatPeriod,S:this.formatSeconds,Y:this.formatFullYear},this.utcFormats={a:this.formatUTCShortWeekday,A:this.formatUTCWeekday,b:this.formatUTCShortMonth,B:this.formatUTCMonth,d:this.formatUTCDayOfMonth,e:this.formatUTCDayOfMonth,H:this.formatUTCHour24,I:this.formatUTCHour12,L:this.formatUTCMilliseconds,m:this.formatUTCMonthNumber,M:this.formatUTCMinutes,p:this.formatUTCPeriod,S:this.formatUTCSeconds,Y:this.formatUTCFullYear},this.parseShortWeekday=function(t,i,n){var r=e.shortWeekdayRe.exec(i.slice(n));return r?(t.w=e.shortWeekdayLookup.get(r[0].toLowerCase()),n+r[0].length):-1},this.parseWeekday=function(t,i,n){var r=e.weekdayRe.exec(i.slice(n));return r?(t.w=e.weekdayLookup.get(r[0].toLowerCase()),n+r[0].length):-1},this.parseShortMonth=function(t,i,n){var r=e.shortMonthRe.exec(i.slice(n));return r?(t.m=e.shortMonthLookup.get(r[0].toLowerCase()),n+r[0].length):-1},this.parseMonth=function(t,i,n){var r=e.monthRe.exec(i.slice(n));return r?(t.m=e.monthLookup.get(r[0].toLowerCase()),n+r[0].length):-1},this.parseDayOfMonth=function(t,i,n){var r=e.numberRe.exec(i.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1},this.parseHour24=function(t,i,n){var r=e.numberRe.exec(i.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1},this.parseMilliseconds=function(t,i,n){var r=e.numberRe.exec(i.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1},this.parseMonthNumber=function(t,i,n){var r=e.numberRe.exec(i.slice(n,n+2));return r?(t.m=r-1,n+r[0].length):-1},this.parseMinutes=function(t,i,n){var r=e.numberRe.exec(i.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1},this.parsePeriod=function(t,i,n){var r=e.periodRe.exec(i.slice(n));return r?(t.p=e.periodLookup.get(r[0].toLowerCase()),n+r[0].length):-1},this.parseSeconds=function(t,i,n){var r=e.numberRe.exec(i.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1},this.parseFullYear=function(t,i,n){var r=e.numberRe.exec(i.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1},this.parses={a:this.parseShortWeekday,A:this.parseWeekday,b:this.parseShortMonth,B:this.parseMonth,d:this.parseDayOfMonth,e:this.parseDayOfMonth,H:this.parseHour24,I:this.parseHour24,L:this.parseMilliseconds,m:this.parseMonthNumber,M:this.parseMinutes,p:this.parsePeriod,S:this.parseSeconds,Y:this.parseFullYear},this.timeFormat=function(t,i){return e.newFormat(t,e.formats)(new Date(e.getFullTimeStamp(i)))},this.timeUTCFormat=function(t,i){return e.newFormat(t,e.utcFormats)(new Date(e.getFullTimeStamp(i)))},this.timeParse=function(t,i){return e.newParse(t,!1)(i+"")},this.requoteF=this.requote.bind(this),this.periodRe=this.formatRe(this.locale_periods),this.periodLookup=this.formatLookup(this.locale_periods),this.weekdayRe=this.formatRe(this.locale_weekdays),this.weekdayLookup=this.formatLookup(this.locale_weekdays),this.shortWeekdayRe=this.formatRe(this.locale_shortWeekdays),this.shortWeekdayLookup=this.formatLookup(this.locale_shortWeekdays),this.monthRe=this.formatRe(this.locale_months),this.monthLookup=this.formatLookup(this.locale_months),this.shortMonthRe=this.formatRe(this.locale_shortMonths),this.shortMonthLookup=this.formatLookup(this.locale_shortMonths)}return o(t,[{key:"requote",value:function(t){return t.replace(this.requoteRe,"\\$&")}},{key:"localDate",value:function(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}},{key:"utcDate",value:function(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}},{key:"newDate",value:function(t,e,i){return{y:t,m:e,d:i,H:0,M:0,S:0,L:0}}},{key:"formatRe",value:function(t){return new RegExp("^(?:"+t.map(this.requoteF).join("|")+")","i")}},{key:"formatLookup",value:function(t){return new Map(t.map((function(t,e){return[t.toLowerCase(),e]})))}},{key:"pad",value:function(t,e,i){var n=t<0?"-":"",r=(n?-t:t)+"",a=r.length;return n+(a<i?new Array(i-a+1).join(e)+r:r)}},{key:"parseSpecifier",value:function(t,e,i,n){for(var r,a,o=0,s=e.length,l=i.length;o<s;){if(n>=l)return-1;if(37===(r=e.charCodeAt(o++))){if(r=e.charAt(o++),!(a=this.parses[r in this.pads?e.charAt(o++):r])||(n=a(t,i,n))<0)return-1}else if(r!==i.charCodeAt(n++))return-1}return n}},{key:"newParse",value:function(t,e){var i=this;return function(n){var r=i.newDate(1900,void 0,1);return i.parseSpecifier(r,t,n+="",0)!==n.length?null:"Q"in r?new Date(r.Q):"s"in r?new Date(1e3*r.s+("L"in r?r.L:0)):(e&&!("Z"in r)&&(r.Z=0),"p"in r&&(r.H=r.H%12+12*r.p),void 0===r.m&&(r.m="q"in r?r.q:0),"Z"in r?(r.H+=r.Z/100|0,r.M+=r.Z%100,i.utcDate(r)):i.localDate(r))}}},{key:"newFormat",value:function(t,e){var i=this;return function(n){var r,a,o=[],s=-1,l=0,u=t.length;for(n instanceof Date||(n=new Date(+n));++s<u;)37===t.charCodeAt(s)&&(o.push(t.slice(l,s)),(a=i.pads[r=t.charAt(++s)])?r=t.charAt(++s):a="e"===r?" ":"0",r=(0,e[r])(n,a),o.push(r),l=s+1);return o.push(t.slice(l,s)),o.join("")}}},{key:"getFullTimeStamp",value:function(t){var e=parseInt(t+"",10);return 10===String(e).length?1e3*e:e}}],[{key:"getInstance",value:function(){return t.instance||(t.instance=new t),t.instance}}])}();function Xi(t,e){var i=e?t.toExponential(e-1):t.toExponential(),n=i.indexOf("e");if(n<0)return null;var r=i.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+i.slice(n+1)]}function Ki(t,e){var i=Xi(t,e);if(!i)return t+"";var n=i[0],r=i[1];return r<0?"0."+new Array(-r).join("0")+n:n.length>r+1?n.slice(0,r+1)+"."+n.slice(r+1):n+new Array(r-n.length+2).join("0")}var qi=function(){return o((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,t),this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}),[{key:"toString",value:function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type}}])}(),Zi=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Ji(t){var e;if(e=Zi.exec(t))return new qi({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]});Lt.getInstance().error("invalid format: "+t)}var Qi=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"],$i=function(){function t(){var e,i,n,a=this;r(this,t),this.locale={thousands:",",grouping:[3],currency:["$",""]},this.group=void 0===this.locale.grouping||void 0===this.locale.thousands?function(t){return t}:(i=m(this.locale.grouping).map(Number),n="".concat(this.locale.thousands),function(t,e){for(var r=t.length,a=[],o=0,s=i[0],l=0;r>0&&s>0&&(l+s+1>e&&(s=Math.max(1,e-l)),a.push(t.substring(r-=s,r+s)),!((l+=s+1)>e));)s=i[o=(o+1)%i.length];return a.reverse().join(n)}),this.currencyPrefix=void 0===this.locale.currency?"":this.locale.currency[0]+"",this.currencySuffix=void 0===this.locale.currency?"":this.locale.currency[1]+"",this.decimal=void 0===this.locale.decimal?".":this.locale.decimal+"",this.numerals=void 0===this.locale.numerals?function(t){return t}:(e=m(this.locale.numerals).map(String),function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}),this.percent=void 0===this.locale.percent?"%":this.locale.percent+"",this.minus=void 0===this.locale.minus?"−":this.locale.minus+"",this.nan=void 0===this.locale.nan?"NaN":this.locale.nan+"",this.formatter=function(t){return a.newFormat(t)},this.format=function(t,e){return a.formatter(t)(e)},this.formatPrefix=function(t,e){return a._formatPrefix(t,e)}}return o(t,[{key:"newFormat",value:function(t){var e=Ji(t),i=e.fill,n=e.align,r=e.sign,a=e.symbol,o=e.zero,s=e.width,l=e.comma,u=e.precision,c=e.trim,h=e.type;"n"===h?(l=!0,h="g"):tn[h]||(void 0===u&&(u=12),c=!0,h="g"),(o||"0"===i&&"="===n)&&(o=!0,i="0",n="=");var d="$"===a?this.currencyPrefix:"#"===a&&/[boxX]/.test(h)?"0"+h.toLowerCase():"",p="$"===a?this.currencySuffix:/[%p]/.test(h)?this.percent:"",f=tn[h],v=/[defgprstz%]/.test(h);u=void 0===u?6:/[gprs]/.test(h)?Math.max(1,Math.min(21,u)):Math.max(0,Math.min(20,u));var g=this.nan,y=this.minus,m=this.decimal,_=this.group,b=this.numerals;function x(t){var e,a,x,k=d,S=p,A=t;if("c"===h)S=f(A)+S,A="";else{var M=(A=+A)<0||1/A<0;if(A=isNaN(A)?g:f(Math.abs(A),u),c&&(A=function(t){var e,i=t.length,n=-1;t:for(var r=1;r<i;++r)switch(t[r]){case".":n=e=r;break;case"0":0===n&&(n=r),e=r;break;default:if(!+t[r])break t;n>0&&(n=0)}return n>0?t.slice(0,n)+t.slice(e+1):t}(A)),M&&0==+A&&"+"!==r&&(M=!1),k=(M?"("===r?r:y:"-"===r||"("===r?"":r)+k,S=("s"===h?Qi[8+Ui/3]:"")+S+(M&&"("===r?")":""),v)for(e=-1,a=A.length;++e<a;)if(48>(x=A.charCodeAt(e))||x>57){S=(46===x?m+A.slice(e+1):A.slice(e))+S,A=A.slice(0,e);break}}l&&!o&&(A=_(A,1/0));var w=k.length+A.length+S.length,T=w<s?new Array(s-w+1).join(i):"";switch(l&&o&&(A=_(T+A,T.length?s-S.length:1/0),T=""),n){case"<":A=k+A+S+T;break;case"=":A=k+T+A+S;break;case"^":A=T.slice(0,w=T.length>>1)+k+A+S+T.slice(w);break;default:A=T+k+A+S}return b(A)}return x.toString=function(){return t+""},x}},{key:"_formatPrefix",value:function(t,e){var i=Ji(t);i.type="f";var n,r,a=this.newFormat(i.toString()),o=3*Math.max(-8,Math.min(8,Math.floor((n=e,((r=Xi(Math.abs(n)))?r[1]:NaN)/3)))),s=Math.pow(10,-o),l=Qi[8+o/3];return function(t){return a(s*t)+l}}}],[{key:"getInstance",value:function(){return t.instance||(t.instance=new t),t.instance}}])}(),tn={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},f:function(t,e){return t.toFixed(e)},e:function(t,e){return t.toExponential(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return Ki(100*t,e)},r:Ki,s:function(t,e){var i=Xi(t,e);if(!i)return t+"";var n=i[0],r=i[1],a=r-(Ui=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,o=n.length;return a===o?n:a>o?n+new Array(a-o+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+Xi(t,Math.max(0,e+a-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)},t:function(t,e){return Number.isInteger(t)?t.toFixed(2):Math.floor(t*Math.pow(10,e))/Math.pow(10,e)+""},z:function(t,e){return t%1==0?t+"":t.toFixed(e)}};function en(t){for(var e=new Array(t),i=0;i<t;++i)e[i]=0;return e}function nn(t,e){return en(t).map((function(){return en(e)}))}function rn(t){return Math.sqrt(_e(t,t))}function an(t,e,i){for(var n=0;n<e.length;++n)t[n]=e[n]*i}function on(t,e,i,n,r){for(var a=0;a<t.length;++a)t[a]=e*i[a]+n*r[a]}function sn(t,e,i){var n,r=(i=i||{}).maxIterations||200*e.length,a=i.nonZeroDelta||1.05,o=i.zeroDelta||.001,s=i.minErrorDelta||1e-6,l=i.minErrorDelta||1e-5,u=void 0!==i.rho?i.rho:1,c=void 0!==i.chi?i.chi:2,h=void 0!==i.psi?i.psi:-.5,d=void 0!==i.sigma?i.sigma:.5,p=e.length,f=new Array(p+1);f[0]=e,f[0].fx=t(e),f[0].id=0;for(var v=0;v<p;++v){var g=e.slice();g[v]=g[v]?g[v]*a:o,f[v+1]=g,f[v+1].fx=t(g),f[v+1].id=v+1}function y(t){for(var e=0;e<t.length;e++)f[p][e]=t[e];f[p].fx=t.fx}for(var m=function(t,e){return t.fx-e.fx},_=e.slice(),b=e.slice(),x=e.slice(),k=e.slice(),S=0;S<r;++S){if(f.sort(m),i.history){var A=f.map((function(t){var e=t.slice();return e.fx=t.fx,e.id=t.id,e}));A.sort((function(t,e){return t.id-e.id})),i.history.push({x:f[0].slice(),fx:f[0].fx,simplex:A})}n=0;for(var M=0;M<p;++M)n=Math.max(n,Math.abs(f[0][M]-f[1][M]));if(Math.abs(f[0].fx-f[p].fx)<s&&n<l)break;for(var w=0;w<p;++w){_[w]=0;for(var T=0;T<p;++T)_[w]+=f[T][w];_[w]/=p}var C=f[p];if(on(b,1+u,_,-u,C),b.fx=t(b),b.fx<f[0].fx)on(k,1+c,_,-c,C),k.fx=t(k),k.fx<b.fx?y(k):y(b);else if(b.fx>=f[p-1].fx){var E=!1;if(b.fx>C.fx?(on(x,1+h,_,-h,C),x.fx=t(x),x.fx<C.fx?y(x):E=!0):(on(x,1-h*u,_,h*u,C),x.fx=t(x),x.fx<b.fx?y(x):E=!0),E){if(d>=1)break;for(var P=1;P<f.length;++P)on(f[P],1-d,f[0],d,f[P]),f[P].fx=t(f[P])}}else y(b)}return f.sort(m),{fx:f[0].fx,x:f[0]}}function ln(t,e,i,n,r,a,o){var s=i.fx,l=_e(i.fxprime,e),u=s,c=s,h=l,d=0;function p(c,d,p){for(var f=0;f<16;++f)if(r=(c+d)/2,on(n.x,1,i.x,r,e),u=n.fx=t(n.x,n.fxprime),h=_e(n.fxprime,e),u>s+a*r*l||u>=p)d=r;else{if(Math.abs(h)<=-o*l)return r;h*(d-c)>=0&&(d=c),c=r,p=u}return 0}r=r||1,a=a||1e-6,o=o||.1;for(var f=0;f<10;++f){if(on(n.x,1,i.x,r,e),u=n.fx=t(n.x,n.fxprime),h=_e(n.fxprime,e),u>s+a*r*l||f&&u>=c)return p(d,r,c);if(Math.abs(h)<=-o*l)return r;if(h>=0)return p(r,d,u);c=u,d=r,r*=2}return r}function un(t,e,i){var n,r={x:e.slice(),fx:0,fxprime:e.slice()},a={x:e.slice(),fx:0,fxprime:e.slice()},o=e.slice(),s=1,l=(i=i||{}).maxIterations||20*e.length;r.fx=t(r.x,r.fxprime);var u=r.fxprime.slice();an(u,r.fxprime,-1);for(var c=0;c<l;++c){if(s=ln(t,u,r,a,s),i.history&&i.history.push({x:r.x.slice(),fx:r.fx,fxprime:r.fxprime.slice(),alpha:s}),s){on(o,1,a.fxprime,-1,r.fxprime);var h=_e(r.fxprime,r.fxprime);on(u,Math.max(0,_e(o,a.fxprime)/h),u,-1,a.fxprime),n=r,r=a,a=n}else an(u,r.fxprime,-1);if(rn(r.fxprime)<=1e-5)break}return i.history&&i.history.push({x:r.x.slice(),fx:r.fx,fxprime:r.fxprime.slice(),alpha:s}),r}var cn=function(t,e){var i=e.callback;return i&&(t=t.filter(i)),t};function hn(){return new dn}function dn(){this.reset()}dn.prototype={constructor:dn,reset:function(){this.s=this.t=0},add:function(t){fn(pn,t,this.t),fn(this,pn.s,this.s),this.s?this.t+=pn.t:this.s=pn.t},valueOf:function(){return this.s}};var pn=new dn;function fn(t,e,i){var n=t.s=e+i,r=n-e,a=n-r;t.t=e-a+(i-r)}var vn=1e-6,gn=Math.PI,yn=gn/2,mn=gn/4,_n=2*gn,bn=180/gn,xn=gn/180,kn=Math.abs,Sn=Math.atan,An=Math.atan2,Mn=Math.cos,wn=Math.exp,Tn=Math.log,Cn=Math.pow,En=Math.sin,Pn=Math.sign||function(t){return t>0?1:t<0?-1:0},Rn=Math.sqrt,Bn=Math.tan;function In(t){return t>1?0:t<-1?gn:Math.acos(t)}function Ln(t){return t>1?yn:t<-1?-yn:Math.asin(t)}function Dn(){}function On(t,e){t&&zn.hasOwnProperty(t.type)&&zn[t.type](t,e)}var Fn={Feature:function(t,e){On(t.geometry,e)},FeatureCollection:function(t,e){for(var i=t.features,n=-1,r=i.length;++n<r;)On(i[n].geometry,e)}},zn={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var i=t.coordinates,n=-1,r=i.length;++n<r;)t=i[n],e.point(t[0],t[1],t[2])},LineString:function(t,e){Hn(t.coordinates,e,0)},MultiLineString:function(t,e){for(var i=t.coordinates,n=-1,r=i.length;++n<r;)Hn(i[n],e,0)},Polygon:function(t,e){jn(t.coordinates,e)},MultiPolygon:function(t,e){for(var i=t.coordinates,n=-1,r=i.length;++n<r;)jn(i[n],e)},GeometryCollection:function(t,e){for(var i=t.geometries,n=-1,r=i.length;++n<r;)On(i[n],e)}};function Hn(t,e,i){var n,r=-1,a=t.length-i;for(e.lineStart();++r<a;)n=t[r],e.point(n[0],n[1],n[2]);e.lineEnd()}function jn(t,e){var i=-1,n=t.length;for(e.polygonStart();++i<n;)Hn(t[i],e,1);e.polygonEnd()}function Nn(t,e){t&&Fn.hasOwnProperty(t.type)?Fn[t.type](t,e):On(t,e)}function Vn(t){return[An(t[1],t[0]),Ln(t[2])]}function Wn(t){var e=t[0],i=t[1],n=Mn(i);return[n*Mn(e),n*En(e),En(i)]}function Gn(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Un(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Yn(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function Xn(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function Kn(t){var e=Rn(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function qn(t,e){function i(i,n){return i=t(i,n),e(i[0],i[1])}return t.invert&&e.invert&&(i.invert=function(i,n){return(i=e.invert(i,n))&&t.invert(i[0],i[1])}),i}function Zn(t,e){return[kn(t)>gn?t+Math.round(-t/_n)*_n:t,e]}function Jn(t,e,i){return(t%=_n)?e||i?qn($n(t),tr(e,i)):$n(t):e||i?tr(e,i):Zn}function Qn(t){return function(e,i){return[(e+=t)>gn?e-_n:e<-gn?e+_n:e,i]}}function $n(t){var e=Qn(t);return e.invert=Qn(-t),e}function tr(t,e){var i=Mn(t),n=En(t),r=Mn(e),a=En(e);function o(t,e){var o=Mn(e),s=Mn(t)*o,l=En(t)*o,u=En(e),c=u*i+s*n;return[An(l*r-c*a,s*i-u*n),Ln(c*r+l*a)]}return o.invert=function(t,e){var o=Mn(e),s=Mn(t)*o,l=En(t)*o,u=En(e),c=u*r-l*a;return[An(l*r+u*a,s*i+c*n),Ln(c*i-s*n)]},o}function er(t,e){(e=Wn(e))[0]-=t,Kn(e);var i=In(-e[1]);return((-e[2]<0?-i:i)+_n-vn)%_n}function ir(){var t,e=[];return{point:function(e,i,n){t.push([e,i,n])},lineStart:function(){e.push(t=[])},lineEnd:Dn,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var i=e;return e=[],t=null,i}}}function nr(t,e){return kn(t[0]-e[0])<vn&&kn(t[1]-e[1])<vn}function rr(t,e,i,n){this.x=t,this.z=e,this.o=i,this.e=n,this.v=!1,this.n=this.p=null}function ar(t,e,i,n,r){var a,o,s=[],l=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,i,n=t[0],o=t[e];if(nr(n,o)){if(!n[2]&&!o[2]){for(r.lineStart(),a=0;a<e;++a)r.point((n=t[a])[0],n[1]);return void r.lineEnd()}o[0]+=2*vn}s.push(i=new rr(n,t,null,!0)),l.push(i.o=new rr(n,null,i,!1)),s.push(i=new rr(o,t,null,!1)),l.push(i.o=new rr(o,null,i,!0))}})),s.length){for(l.sort(e),or(s),or(l),a=0,o=l.length;a<o;++a)l[a].e=i=!i;for(var u,c,h=s[0];;){for(var d=h,p=!0;d.v;)if((d=d.n)===h)return;u=d.z,r.lineStart();do{if(d.v=d.o.v=!0,d.e){if(p)for(a=0,o=u.length;a<o;++a)r.point((c=u[a])[0],c[1]);else n(d.x,d.n.x,1,r);d=d.n}else{if(p)for(u=d.p.z,a=u.length-1;a>=0;--a)r.point((c=u[a])[0],c[1]);else n(d.x,d.p.x,-1,r);d=d.p}u=(d=d.o).z,p=!p}while(!d.v);r.lineEnd()}}}function or(t){if(e=t.length){for(var e,i,n=0,r=t[0];++n<e;)r.n=i=t[n],i.p=r,r=i;r.n=i=t[0],i.p=r}}Zn.invert=Zn;var sr,lr,ur=hn();function cr(t){return kn(t[0])<=gn?t[0]:Pn(t[0])*((kn(t[0])+gn)%_n-gn)}function hr(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function dr(t){for(var e,i,n,r=t.length,a=-1,o=0;++a<r;)o+=t[a].length;for(i=new Array(o);--r>=0;)for(e=(n=t[r]).length;--e>=0;)i[--o]=n[e];return i}function pr(t,e,i,n){return function(r){var a,o,s,l=e(r),u=ir(),c=e(u),h=!1,d={point:p,lineStart:v,lineEnd:g,polygonStart:function(){d.point=y,d.lineStart=m,d.lineEnd=_,o=[],a=[]},polygonEnd:function(){d.point=p,d.lineStart=v,d.lineEnd=g,o=dr(o);var t=function(t,e){var i=cr(e),n=e[1],r=En(n),a=[En(i),-Mn(i),0],o=0,s=0;ur.reset(),1===r?n=yn+vn:-1===r&&(n=-yn-vn);for(var l=0,u=t.length;l<u;++l)if(h=(c=t[l]).length)for(var c,h,d=c[h-1],p=cr(d),f=d[1]/2+mn,v=En(f),g=Mn(f),y=0;y<h;++y,p=_,v=x,g=k,d=m){var m=c[y],_=cr(m),b=m[1]/2+mn,x=En(b),k=Mn(b),S=_-p,A=S>=0?1:-1,M=A*S,w=M>gn,T=v*x;if(ur.add(An(T*A*En(M),g*k+T*Mn(M))),o+=w?S+A*_n:S,w^p>=i^_>=i){var C=Un(Wn(d),Wn(m));Kn(C);var E=Un(a,C);Kn(E);var P=(w^S>=0?-1:1)*Ln(E[2]);(n>P||n===P&&(C[0]||C[1]))&&(s+=w^S>=0?1:-1)}}return(o<-vn||o<vn&&ur<-vn)^1&s}(a,n);o.length?(h||(r.polygonStart(),h=!0),ar(o,vr,t,i,r)):t&&(h||(r.polygonStart(),h=!0),r.lineStart(),i(null,null,1,r),r.lineEnd()),h&&(r.polygonEnd(),h=!1),o=a=null},sphere:function(){r.polygonStart(),r.lineStart(),i(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function p(e,i){t(e,i)&&r.point(e,i)}function f(t,e){l.point(t,e)}function v(){d.point=f,l.lineStart()}function g(){d.point=p,l.lineEnd()}function y(t,e){s.push([t,e]),c.point(t,e)}function m(){c.lineStart(),s=[]}function _(){y(s[0][0],s[0][1]),c.lineEnd();var t,e,i,n,l=c.clean(),d=u.result(),p=d.length;if(s.pop(),a.push(s),s=null,p)if(1&l){if((e=(i=d[0]).length-1)>0){for(h||(r.polygonStart(),h=!0),r.lineStart(),t=0;t<e;++t)r.point((n=i[t])[0],n[1]);r.lineEnd()}}else p>1&&2&l&&d.push(d.pop().concat(d.shift())),o.push(d.filter(fr))}return d}}function fr(t){return t.length>1}function vr(t,e){return((t=t.x)[0]<0?t[1]-yn-vn:yn-t[1])-((e=e.x)[0]<0?e[1]-yn-vn:yn-e[1])}1===(sr=hr).length&&(lr=sr,sr=function(t,e){return hr(lr(t),e)});var gr=pr((function(){return!0}),(function(t){var e,i=NaN,n=NaN,r=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(a,o){var s=a>0?gn:-gn,l=kn(a-i);kn(l-gn)<vn?(t.point(i,n=(n+o)/2>0?yn:-yn),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(s,n),t.point(a,n),e=0):r!==s&&l>=gn&&(kn(i-r)<vn&&(i-=r*vn),kn(a-s)<vn&&(a-=s*vn),n=function(t,e,i,n){var r,a,o=En(t-i);return kn(o)>vn?Sn((En(e)*(a=Mn(n))*En(i)-En(n)*(r=Mn(e))*En(t))/(r*a*o)):(e+n)/2}(i,n,a,o),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(s,n),e=0),t.point(i=a,n=o),r=s},lineEnd:function(){t.lineEnd(),i=n=NaN},clean:function(){return 2-e}}}),(function(t,e,i,n){var r;if(null==t)r=i*yn,n.point(-gn,r),n.point(0,r),n.point(gn,r),n.point(gn,0),n.point(gn,-r),n.point(0,-r),n.point(-gn,-r),n.point(-gn,0),n.point(-gn,r);else if(kn(t[0]-e[0])>vn){var a=t[0]<e[0]?gn:-gn;r=i*a/2,n.point(-a,r),n.point(0,r),n.point(a,r)}else n.point(e[0],e[1])}),[-gn,-yn]);function yr(t){var e=Mn(t),i=6*xn,n=e>0,r=kn(e)>vn;function a(t,i){return Mn(t)*Mn(i)>e}function o(t,i,n){var r=[1,0,0],a=Un(Wn(t),Wn(i)),o=Gn(a,a),s=a[0],l=o-s*s;if(!l)return!n&&t;var u=e*o/l,c=-e*s/l,h=Un(r,a),d=Xn(r,u);Yn(d,Xn(a,c));var p=h,f=Gn(d,p),v=Gn(p,p),g=f*f-v*(Gn(d,d)-1);if(!(g<0)){var y=Rn(g),m=Xn(p,(-f-y)/v);if(Yn(m,d),m=Vn(m),!n)return m;var _,b=t[0],x=i[0],k=t[1],S=i[1];x<b&&(_=b,b=x,x=_);var A=x-b,M=kn(A-gn)<vn;if(!M&&S<k&&(_=k,k=S,S=_),M||A<vn?M?k+S>0^m[1]<(kn(m[0]-b)<vn?k:S):k<=m[1]&&m[1]<=S:A>gn^(b<=m[0]&&m[0]<=x)){var w=Xn(p,(-f+y)/v);return Yn(w,d),[m,Vn(w)]}}}function s(e,i){var r=n?t:gn-t,a=0;return e<-r?a|=1:e>r&&(a|=2),i<-r?a|=4:i>r&&(a|=8),a}return pr(a,(function(t){var e,i,l,u,c;return{lineStart:function(){u=l=!1,c=1},point:function(h,d){var p,f=[h,d],v=a(h,d),g=n?v?0:s(h,d):v?s(h+(h<0?gn:-gn),d):0;if(!e&&(u=l=v)&&t.lineStart(),v!==l&&(!(p=o(e,f))||nr(e,p)||nr(f,p))&&(f[2]=1),v!==l)c=0,v?(t.lineStart(),p=o(f,e),t.point(p[0],p[1])):(p=o(e,f),t.point(p[0],p[1],2),t.lineEnd()),e=p;else if(r&&e&&n^v){var y;g&i||!(y=o(f,e,!0))||(c=0,n?(t.lineStart(),t.point(y[0][0],y[0][1]),t.point(y[1][0],y[1][1]),t.lineEnd()):(t.point(y[1][0],y[1][1]),t.lineEnd(),t.lineStart(),t.point(y[0][0],y[0][1],3)))}!v||e&&nr(e,f)||t.point(f[0],f[1]),e=f,l=v,i=g},lineEnd:function(){l&&t.lineEnd(),e=null},clean:function(){return c|(u&&l)<<1}}}),(function(e,n,r,a){!function(t,e,i,n,r,a){if(i){var o=Mn(e),s=En(e),l=n*i;null==r?(r=e+n*_n,a=e-l/2):(r=er(o,r),a=er(o,a),(n>0?r<a:r>a)&&(r+=n*_n));for(var u,c=r;n>0?c>a:c<a;c-=l)u=Vn([o,-s*Mn(c),-s*En(c)]),t.point(u[0],u[1])}}(a,t,i,r,e,n)}),n?[0,-t]:[-gn,t-gn])}var mr=1e9,_r=-mr;function br(t,e,i,n){function r(r,a){return t<=r&&r<=i&&e<=a&&a<=n}function a(r,a,s,u){var c=0,h=0;if(null==r||(c=o(r,s))!==(h=o(a,s))||l(r,a)<0^s>0)do{u.point(0===c||3===c?t:i,c>1?n:e)}while((c=(c+s+4)%4)!==h);else u.point(a[0],a[1])}function o(n,r){return kn(n[0]-t)<vn?r>0?0:3:kn(n[0]-i)<vn?r>0?2:1:kn(n[1]-e)<vn?r>0?1:0:r>0?3:2}function s(t,e){return l(t.x,e.x)}function l(t,e){var i=o(t,1),n=o(e,1);return i!==n?i-n:0===i?e[1]-t[1]:1===i?t[0]-e[0]:2===i?t[1]-e[1]:e[0]-t[0]}return function(o){var l,u,c,h,d,p,f,v,g,y,m,_=o,b=ir(),x={point:k,lineStart:function(){x.point=S,u&&u.push(c=[]);y=!0,g=!1,f=v=NaN},lineEnd:function(){l&&(S(h,d),p&&g&&b.rejoin(),l.push(b.result()));x.point=k,g&&_.lineEnd()},polygonStart:function(){_=b,l=[],u=[],m=!0},polygonEnd:function(){var e=function(){for(var e=0,i=0,r=u.length;i<r;++i)for(var a,o,s=u[i],l=1,c=s.length,h=s[0],d=h[0],p=h[1];l<c;++l)a=d,o=p,d=(h=s[l])[0],p=h[1],o<=n?p>n&&(d-a)*(n-o)>(p-o)*(t-a)&&++e:p<=n&&(d-a)*(n-o)<(p-o)*(t-a)&&--e;return e}(),i=m&&e,r=(l=dr(l)).length;(i||r)&&(o.polygonStart(),i&&(o.lineStart(),a(null,null,1,o),o.lineEnd()),r&&ar(l,s,e,a,o),o.polygonEnd());_=o,l=u=c=null}};function k(t,e){r(t,e)&&_.point(t,e)}function S(a,o){var s=r(a,o);if(u&&c.push([a,o]),y)h=a,d=o,p=s,y=!1,s&&(_.lineStart(),_.point(a,o));else if(s&&g)_.point(a,o);else{var l=[f=Math.max(_r,Math.min(mr,f)),v=Math.max(_r,Math.min(mr,v))],b=[a=Math.max(_r,Math.min(mr,a)),o=Math.max(_r,Math.min(mr,o))];!function(t,e,i,n,r,a){var o,s=t[0],l=t[1],u=0,c=1,h=e[0]-s,d=e[1]-l;if(o=i-s,h||!(o>0)){if(o/=h,h<0){if(o<u)return;o<c&&(c=o)}else if(h>0){if(o>c)return;o>u&&(u=o)}if(o=r-s,h||!(o<0)){if(o/=h,h<0){if(o>c)return;o>u&&(u=o)}else if(h>0){if(o<u)return;o<c&&(c=o)}if(o=n-l,d||!(o>0)){if(o/=d,d<0){if(o<u)return;o<c&&(c=o)}else if(d>0){if(o>c)return;o>u&&(u=o)}if(o=a-l,d||!(o<0)){if(o/=d,d<0){if(o>c)return;o>u&&(u=o)}else if(d>0){if(o<u)return;o<c&&(c=o)}return u>0&&(t[0]=s+u*h,t[1]=l+u*d),c<1&&(e[0]=s+c*h,e[1]=l+c*d),!0}}}}}(l,b,t,e,i,n)?s&&(_.lineStart(),_.point(a,o),m=!1):(g||(_.lineStart(),_.point(l[0],l[1])),_.point(b[0],b[1]),s||_.lineEnd(),m=!1)}f=a,v=o,g=s}return x}}function xr(t){return t}var kr,Sr,Ar,Mr,wr=hn(),Tr=hn(),Cr={point:Dn,lineStart:Dn,lineEnd:Dn,polygonStart:function(){Cr.lineStart=Er,Cr.lineEnd=Br},polygonEnd:function(){Cr.lineStart=Cr.lineEnd=Cr.point=Dn,wr.add(kn(Tr)),Tr.reset()},result:function(){var t=wr/2;return wr.reset(),t}};function Er(){Cr.point=Pr}function Pr(t,e){Cr.point=Rr,kr=Ar=t,Sr=Mr=e}function Rr(t,e){Tr.add(Mr*t-Ar*e),Ar=t,Mr=e}function Br(){Rr(kr,Sr)}var Ir=Cr,Lr=1/0,Dr=Lr,Or=-Lr,Fr=Or;var zr,Hr,jr,Nr,Vr={point:function(t,e){t<Lr&&(Lr=t);t>Or&&(Or=t);e<Dr&&(Dr=e);e>Fr&&(Fr=e)},lineStart:Dn,lineEnd:Dn,polygonStart:Dn,polygonEnd:Dn,result:function(){var t=[[Lr,Dr],[Or,Fr]];return Or=Fr=-(Dr=Lr=1/0),t}},Wr=0,Gr=0,Ur=0,Yr=0,Xr=0,Kr=0,qr=0,Zr=0,Jr=0,Qr={point:$r,lineStart:ta,lineEnd:na,polygonStart:function(){Qr.lineStart=ra,Qr.lineEnd=aa},polygonEnd:function(){Qr.point=$r,Qr.lineStart=ta,Qr.lineEnd=na},result:function(){var t=Jr?[qr/Jr,Zr/Jr]:Kr?[Yr/Kr,Xr/Kr]:Ur?[Wr/Ur,Gr/Ur]:[NaN,NaN];return Wr=Gr=Ur=Yr=Xr=Kr=qr=Zr=Jr=0,t}};function $r(t,e){Wr+=t,Gr+=e,++Ur}function ta(){Qr.point=ea}function ea(t,e){Qr.point=ia,$r(jr=t,Nr=e)}function ia(t,e){var i=t-jr,n=e-Nr,r=Rn(i*i+n*n);Yr+=r*(jr+t)/2,Xr+=r*(Nr+e)/2,Kr+=r,$r(jr=t,Nr=e)}function na(){Qr.point=$r}function ra(){Qr.point=oa}function aa(){sa(zr,Hr)}function oa(t,e){Qr.point=sa,$r(zr=jr=t,Hr=Nr=e)}function sa(t,e){var i=t-jr,n=e-Nr,r=Rn(i*i+n*n);Yr+=r*(jr+t)/2,Xr+=r*(Nr+e)/2,Kr+=r,qr+=(r=Nr*t-jr*e)*(jr+t),Zr+=r*(Nr+e),Jr+=3*r,$r(jr=t,Nr=e)}var la=Qr;function ua(t){this._context=t}ua.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,_n)}},result:Dn};var ca,ha,da,pa,fa,va=hn(),ga={point:Dn,lineStart:function(){ga.point=ya},lineEnd:function(){ca&&ma(ha,da),ga.point=Dn},polygonStart:function(){ca=!0},polygonEnd:function(){ca=null},result:function(){var t=+va;return va.reset(),t}};function ya(t,e){ga.point=ma,ha=pa=t,da=fa=e}function ma(t,e){pa-=t,fa-=e,va.add(Rn(pa*pa+fa*fa)),pa=t,fa=e}var _a=ga;function ba(){this._string=[]}function xa(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function ka(t,e){var i,n,r=4.5;function a(t){return t&&("function"==typeof r&&n.pointRadius(+r.apply(this,arguments)),Nn(t,i(n))),n.result()}return a.area=function(t){return Nn(t,i(Ir)),Ir.result()},a.measure=function(t){return Nn(t,i(_a)),_a.result()},a.bounds=function(t){return Nn(t,i(Vr)),Vr.result()},a.centroid=function(t){return Nn(t,i(la)),la.result()},a.projection=function(e){return arguments.length?(i=null==e?(t=null,xr):(t=e).stream,a):t},a.context=function(t){return arguments.length?(n=null==t?(e=null,new ba):new ua(e=t),"function"!=typeof r&&n.pointRadius(r),a):e},a.pointRadius=function(t){return arguments.length?(r="function"==typeof t?t:(n.pointRadius(+t),+t),a):r},a.projection(t).context(e)}function Sa(t){return function(e){var i=new Aa;for(var n in t)i[n]=t[n];return i.stream=e,i}}function Aa(){}function Ma(t,e,i){var n=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=n&&t.clipExtent(null),Nn(i,t.stream(Vr)),e(Vr.result()),null!=n&&t.clipExtent(n),t}function wa(t,e,i){return Ma(t,(function(i){var n=e[1][0]-e[0][0],r=e[1][1]-e[0][1],a=Math.min(n/(i[1][0]-i[0][0]),r/(i[1][1]-i[0][1])),o=+e[0][0]+(n-a*(i[1][0]+i[0][0]))/2,s=+e[0][1]+(r-a*(i[1][1]+i[0][1]))/2;t.scale(150*a).translate([o,s])}),i)}function Ta(t,e,i){return wa(t,[[0,0],e],i)}function Ca(t,e,i){return Ma(t,(function(i){var n=+e,r=n/(i[1][0]-i[0][0]),a=(n-r*(i[1][0]+i[0][0]))/2,o=-r*i[0][1];t.scale(150*r).translate([a,o])}),i)}function Ea(t,e,i){return Ma(t,(function(i){var n=+e,r=n/(i[1][1]-i[0][1]),a=-r*i[0][0],o=(n-r*(i[1][1]+i[0][1]))/2;t.scale(150*r).translate([a,o])}),i)}ba.prototype={_radius:4.5,_circle:xa(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:null==this._circle&&(this._circle=xa(this._radius)),this._string.push("M",t,",",e,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}},Aa.prototype={constructor:Aa,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var Pa=16,Ra=Mn(30*xn);function Ba(t,e){return+e?function(t,e){function i(n,r,a,o,s,l,u,c,h,d,p,f,v,g){var y=u-n,m=c-r,_=y*y+m*m;if(_>4*e&&v--){var b=o+d,x=s+p,k=l+f,S=Rn(b*b+x*x+k*k),A=Ln(k/=S),M=kn(kn(k)-1)<vn||kn(a-h)<vn?(a+h)/2:An(x,b),w=t(M,A),T=w[0],C=w[1],E=T-n,P=C-r,R=m*E-y*P;(R*R/_>e||kn((y*E+m*P)/_-.5)>.3||o*d+s*p+l*f<Ra)&&(i(n,r,a,o,s,l,T,C,M,b/=S,x/=S,k,v,g),g.point(T,C),i(T,C,M,b,x,k,u,c,h,d,p,f,v,g))}}return function(e){var n,r,a,o,s,l,u,c,h,d,p,f,v={point:g,lineStart:y,lineEnd:_,polygonStart:function(){e.polygonStart(),v.lineStart=b},polygonEnd:function(){e.polygonEnd(),v.lineStart=y}};function g(i,n){i=t(i,n),e.point(i[0],i[1])}function y(){c=NaN,v.point=m,e.lineStart()}function m(n,r){var a=Wn([n,r]),o=t(n,r);i(c,h,u,d,p,f,c=o[0],h=o[1],u=n,d=a[0],p=a[1],f=a[2],Pa,e),e.point(c,h)}function _(){v.point=g,e.lineEnd()}function b(){y(),v.point=x,v.lineEnd=k}function x(t,e){m(n=t,e),r=c,a=h,o=d,s=p,l=f,v.point=m}function k(){i(c,h,u,d,p,f,r,a,n,o,s,l,Pa,e),v.lineEnd=_,_()}return v}}(t,e):function(t){return Sa({point:function(e,i){e=t(e,i),this.stream.point(e[0],e[1])}})}(t)}var Ia=Sa({point:function(t,e){this.stream.point(t*xn,e*xn)}});function La(t,e,i,n,r){function a(a,o){return[e+t*(a*=n),i-t*(o*=r)]}return a.invert=function(a,o){return[(a-e)/t*n,(i-o)/t*r]},a}function Da(t,e,i,n,r,a){var o=Mn(a),s=En(a),l=o*t,u=s*t,c=o/t,h=s/t,d=(s*i-o*e)/t,p=(s*e+o*i)/t;function f(t,a){return[l*(t*=n)-u*(a*=r)+e,i-u*t-l*a]}return f.invert=function(t,e){return[n*(c*t-h*e+d),r*(p-h*t-c*e)]},f}function Oa(t){return Fa((function(){return t}))()}function Fa(t){var e,i,n,r,a,o,s,l,u,c,h=150,d=480,p=250,f=0,v=0,g=0,y=0,m=0,_=0,b=1,x=1,k=null,S=gr,A=null,M=xr,w=.5;function T(t){return l(t[0]*xn,t[1]*xn)}function C(t){return(t=l.invert(t[0],t[1]))&&[t[0]*bn,t[1]*bn]}function E(){var t=Da(h,0,0,b,x,_).apply(null,e(f,v)),n=(_?Da:La)(h,d-t[0],p-t[1],b,x,_);return i=Jn(g,y,m),s=qn(e,n),l=qn(i,s),o=Ba(s,w),P()}function P(){return u=c=null,T}return T.stream=function(t){return u&&c===t?u:u=Ia(function(t){return Sa({point:function(e,i){var n=t(e,i);return this.stream.point(n[0],n[1])}})}(i)(S(o(M(c=t)))))},T.preclip=function(t){return arguments.length?(S=t,k=void 0,P()):S},T.postclip=function(t){return arguments.length?(M=t,A=n=r=a=null,P()):M},T.clipAngle=function(t){return arguments.length?(S=+t?yr(k=t*xn):(k=null,gr),P()):k*bn},T.clipExtent=function(t){return arguments.length?(M=null==t?(A=n=r=a=null,xr):br(A=+t[0][0],n=+t[0][1],r=+t[1][0],a=+t[1][1]),P()):null==A?null:[[A,n],[r,a]]},T.scale=function(t){return arguments.length?(h=+t,E()):h},T.translate=function(t){return arguments.length?(d=+t[0],p=+t[1],E()):[d,p]},T.center=function(t){return arguments.length?(f=t[0]%360*xn,v=t[1]%360*xn,E()):[f*bn,v*bn]},T.rotate=function(t){return arguments.length?(g=t[0]%360*xn,y=t[1]%360*xn,m=t.length>2?t[2]%360*xn:0,E()):[g*bn,y*bn,m*bn]},T.angle=function(t){return arguments.length?(_=t%360*xn,E()):_*bn},T.reflectX=function(t){return arguments.length?(b=t?-1:1,E()):b<0},T.reflectY=function(t){return arguments.length?(x=t?-1:1,E()):x<0},T.precision=function(t){return arguments.length?(o=Ba(s,w=t*t),P()):Rn(w)},T.fitExtent=function(t,e){return wa(T,t,e)},T.fitSize=function(t,e){return Ta(T,t,e)},T.fitWidth=function(t,e){return Ca(T,t,e)},T.fitHeight=function(t,e){return Ea(T,t,e)},function(){return e=t.apply(this,arguments),T.invert=e.invert&&C,E()}}function za(t){var e=0,i=gn/3,n=Fa(t),r=n(e,i);return r.parallels=function(t){return arguments.length?n(e=t[0]*xn,i=t[1]*xn):[e*bn,i*bn]},r}function Ha(t,e){var i=En(t),n=(i+En(e))/2;if(kn(n)<vn)return function(t){var e=Mn(t);function i(t,i){return[t*e,En(i)/e]}return i.invert=function(t,i){return[t/e,Ln(i*e)]},i}(t);var r=1+i*(2*n-i),a=Rn(r)/n;function o(t,e){var i=Rn(r-2*n*En(e))/n;return[i*En(t*=n),a-i*Mn(t)]}return o.invert=function(t,e){var i=a-e,o=An(t,kn(i))*Pn(i);return i*n<0&&(o-=gn*Pn(t)*Pn(i)),[o/n,Ln((r-(t*t+i*i)*n*n)/(2*n))]},o}function ja(){return za(Ha).scale(155.424).center([0,33.6442])}function Na(){return ja().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function Va(t){return function(e,i){var n=Mn(e),r=Mn(i),a=t(n*r);return[a*r*En(e),a*En(i)]}}function Wa(t){return function(e,i){var n=Rn(e*e+i*i),r=t(n),a=En(r),o=Mn(r);return[An(e*a,n*o),Ln(n&&i*a/n)]}}var Ga=Va((function(t){return Rn(2/(1+t))}));Ga.invert=Wa((function(t){return 2*Ln(t/2)}));var Ua=Va((function(t){return(t=In(t))&&t/En(t)}));function Ya(t,e){return[t,Tn(Bn((yn+e)/2))]}function Xa(t){var e,i,n,r=Oa(t),a=r.center,o=r.scale,s=r.translate,l=r.clipExtent,u=null;function c(){var a=gn*o(),s=r(function(t){function e(e){return(e=t(e[0]*xn,e[1]*xn))[0]*=bn,e[1]*=bn,e}return t=Jn(t[0]*xn,t[1]*xn,t.length>2?t[2]*xn:0),e.invert=function(e){return(e=t.invert(e[0]*xn,e[1]*xn))[0]*=bn,e[1]*=bn,e},e}(r.rotate()).invert([0,0]));return l(null==u?[[s[0]-a,s[1]-a],[s[0]+a,s[1]+a]]:t===Ya?[[Math.max(s[0]-a,u),e],[Math.min(s[0]+a,i),n]]:[[u,Math.max(s[1]-a,e)],[i,Math.min(s[1]+a,n)]])}return r.scale=function(t){return arguments.length?(o(t),c()):o()},r.translate=function(t){return arguments.length?(s(t),c()):s()},r.center=function(t){return arguments.length?(a(t),c()):a()},r.clipExtent=function(t){return arguments.length?(null==t?u=e=i=n=null:(u=+t[0][0],e=+t[0][1],i=+t[1][0],n=+t[1][1]),c()):null==u?null:[[u,e],[i,n]]},c()}function Ka(t){return Bn((yn+t)/2)}function qa(t,e){var i=Mn(t),n=t===e?En(t):Tn(i/Mn(e))/Tn(Ka(e)/Ka(t)),r=i*Cn(Ka(t),n)/n;if(!n)return Ya;function a(t,e){r>0?e<-yn+vn&&(e=-yn+vn):e>yn-vn&&(e=yn-vn);var i=r/Cn(Ka(e),n);return[i*En(n*t),r-i*Mn(n*t)]}return a.invert=function(t,e){var i=r-e,a=Pn(n)*Rn(t*t+i*i),o=An(t,kn(i))*Pn(i);return i*n<0&&(o-=gn*Pn(t)*Pn(i)),[o/n,2*Sn(Cn(r/a,1/n))-yn]},a}function Za(t,e){return[t,e]}function Ja(t,e){var i=Mn(t),n=t===e?En(t):(i-Mn(e))/(e-t),r=i/n+t;if(kn(n)<vn)return Za;function a(t,e){var i=r-e,a=n*t;return[i*En(a),r-i*Mn(a)]}return a.invert=function(t,e){var i=r-e,a=An(t,kn(i))*Pn(i);return i*n<0&&(a-=gn*Pn(t)*Pn(i)),[a/n,r-Pn(n)*Rn(t*t+i*i)]},a}Ua.invert=Wa((function(t){return t})),Ya.invert=function(t,e){return[t,2*Sn(wn(e))-yn]},Za.invert=Za;var Qa=1.340264,$a=-.081106,to=893e-6,eo=.003796,io=Rn(3)/2;function no(t,e){var i=Ln(io*En(e)),n=i*i,r=n*n*n;return[t*Mn(i)/(io*(Qa+3*$a*n+r*(7*to+9*eo*n))),i*(Qa+$a*n+r*(to+eo*n))]}function ro(t,e){var i=Mn(e),n=Mn(t)*i;return[i*En(t)/n,En(e)/n]}function ao(t,e){var i=e*e,n=i*i;return[t*(.8707-.131979*i+n*(n*(.003971*i-.001529*n)-.013791)),e*(1.007226+i*(.015085+n*(.028874*i-.044475-.005916*n)))]}function oo(t,e){return[Mn(e)*En(t),En(e)]}function so(t,e){var i=Mn(e),n=1+Mn(t)*i;return[i*En(t)/n,En(e)/n]}function lo(t,e){return[Tn(Bn((yn+e)/2)),-t]}function uo(t){return t}function co(t,e){var i=e.id,n=e.bbox,r=null==e.properties?{}:e.properties,a=function(t,e){var i=function(t){if(null==t)return uo;var e,i,n=t.scale[0],r=t.scale[1],a=t.translate[0],o=t.translate[1];return function(t,s){s||(e=i=0);var l=2,u=t.length,c=new Array(u);for(c[0]=(e+=t[0])*n+a,c[1]=(i+=t[1])*r+o;l<u;)c[l]=t[l],++l;return c}}(t.transform),n=t.arcs;function r(t,e){e.length&&e.pop();for(var r=n[t<0?~t:t],a=0,o=r.length;a<o;++a)e.push(i(r[a],a));t<0&&function(t,e){for(var i,n=t.length,r=n-e;r<--n;)i=t[r],t[r++]=t[n],t[n]=i}(e,o)}function a(t){return i(t)}function o(t){for(var e=[],i=0,n=t.length;i<n;++i)r(t[i],e);return e.length<2&&e.push(e[0]),e}function s(t){for(var e=o(t);e.length<4;)e.push(e[0]);return e}function l(t){return t.map(s)}function u(t){var e,i=t.type;switch(i){case"GeometryCollection":return{type:i,geometries:t.geometries.map(u)};case"Point":e=a(t.coordinates);break;case"MultiPoint":e=t.coordinates.map(a);break;case"LineString":e=o(t.arcs);break;case"MultiLineString":e=t.arcs.map(o);break;case"Polygon":e=l(t.arcs);break;case"MultiPolygon":e=t.arcs.map(l);break;default:return null}return{type:i,coordinates:e}}return u(e)}(t,e);return null==i&&null==n?{type:"Feature",properties:r,geometry:a}:null==n?{type:"Feature",id:i,properties:r,geometry:a}:{type:"Feature",id:i,bbox:n,properties:r,geometry:a}}no.invert=function(t,e){for(var i,n=e,r=n*n,a=r*r*r,o=0;o<12&&(a=(r=(n-=i=(n*(Qa+$a*r+a*(to+eo*r))-e)/(Qa+3*$a*r+a*(7*to+9*eo*r)))*n)*r*r,!(kn(i)<1e-12));++o);return[io*t*(Qa+3*$a*r+a*(7*to+9*eo*r))/Mn(n),Ln(En(n)/io)]},ro.invert=Wa(Sn),ao.invert=function(t,e){var i,n=e,r=25;do{var a=n*n,o=a*a;n-=i=(n*(1.007226+a*(.015085+o*(.028874*a-.044475-.005916*o)))-e)/(1.007226+a*(.045255+o*(.259866*a-.311325-.005916*11*o)))}while(kn(i)>vn&&--r>0);return[t/(.8707+(a=n*n)*(a*(a*a*a*(.003971-.001529*a)-.013791)-.131979)),n]},oo.invert=Wa(Ln),so.invert=Wa((function(t){return 2*Sn(t)})),lo.invert=function(t,e){return[-e,2*Sn(wn(t))-yn]};var ho={exports:{}},po=function(t,e){this.p1=t,this.p2=e};po.prototype.rise=function(){return this.p2[1]-this.p1[1]},po.prototype.run=function(){return this.p2[0]-this.p1[0]},po.prototype.slope=function(){return this.rise()/this.run()},po.prototype.yIntercept=function(){return this.p1[1]-this.p1[0]*this.slope(this.p1,this.p2)},po.prototype.isVertical=function(){return!isFinite(this.slope())},po.prototype.isHorizontal=function(){return this.p1[1]==this.p2[1]},po.prototype._perpendicularDistanceHorizontal=function(t){return Math.abs(this.p1[1]-t[1])},po.prototype._perpendicularDistanceVertical=function(t){return Math.abs(this.p1[0]-t[0])},po.prototype._perpendicularDistanceHasSlope=function(t){var e=this.slope(),i=this.yIntercept();return Math.abs(e*t[0]-t[1]+i)/Math.sqrt(Math.pow(e,2)+1)},po.prototype.perpendicularDistance=function(t){return this.isVertical()?this._perpendicularDistanceVertical(t):this.isHorizontal()?this._perpendicularDistanceHorizontal(t):this._perpendicularDistanceHasSlope(t)};var fo=po,vo=function(t,e){for(var i=0,n=0,r=1;r<=t.length-2;r++){var a=new fo(t[0],t[t.length-1]).perpendicularDistance(t[r]);a>i&&(n=r,i=a)}if(i>e)var o=vo(t.slice(0,n),e),s=vo(t.slice(n,t.length),e),l=o.concat(s);else l=t.length>1?[t[0],t[t.length-1]]:[t[0]];return l},go=vo;!function(t){var e=go;function i(e,i){var n=e.geometry,r=n.type;if("LineString"===r)n.coordinates=t.exports.simplify(n.coordinates,i);else if("Polygon"===r||"MultiLineString"===r)for(var a=0;a<n.coordinates.length;a++)n.coordinates[a]=t.exports.simplify(n.coordinates[a],i);else if("MultiPolygon"===r)for(var o=0;o<n.coordinates.length;o++)for(var s=0;s<n.coordinates[o].length;s++)n.coordinates[o][s]=t.exports.simplify(n.coordinates[o][s],i);return e}t.exports=function(t,e,n){return n||(t=JSON.parse(JSON.stringify(t))),t.features?function(t,e){for(var n=0;n<t.features.length;n++)t.features[n]=i(t.features[n],e);return t}(t,e):t.type&&"Feature"===t.type?i(t,e):new Error("FeatureCollection or individual Feature required")},t.exports.simplify=function(t,i){return e(t,i)}}(ho);var yo=L(ho.exports),mo=function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return xo.apply(void 0,[ct(t)].concat(i))};function _o(t,e,i){var n=e[i];if(void 0===n)t[i]=null;else if(V(n))for(var r in V(t[i])||(t[i]={}),n)_o(t[i],n,r);else t[i]=n}function bo(t,e){if(V(e)&&t!==e)for(var i in e)_o(t,e,i)}function xo(t){t||(t={});for(var e=-1,i=arguments.length<=1?0:arguments.length-1;++e<i;)bo(t,e+1<1||arguments.length<=e+1?void 0:arguments[e+1]);return t}var ko,So={tolerance:.01},Ao=function(t,e){var i=mo(So,e).tolerance;return yo(t,i)};!function(t){t.DSV="dsv",t.TREE="tree",t.GEO="geo",t.BYTE="bytejson",t.HEX="hex",t.GRAPH="graph",t.TABLE="table",t.GEO_GRATICULE="geo-graticule"}(ko||(ko={}));var Mo=function(t,e){for(var i=e.fields,n=e.key,r=e.value,a=e.retains,o=[],s=function(e){i.forEach((function(s){var l={};if(l[n]=s,l[r]=t[e][s],a)a.forEach((function(i){l[i]=t[e][i]}));else for(var u in t[e])-1===i.indexOf(u)&&(l[u]=t[e][u]);o.push(l)}))},l=0;l<t.length;l++)s(l);return o},wo=function(t,e){var i,n;if(!(null==e?void 0:e.fields))return t;if(0===t.length)return t;var r=e.fields,a=t[0],o={},s=[],l=function(e){if(Object.prototype.hasOwnProperty.call(r,e)){var l,u=r[e];if(!u.type){var c=a;e in a||(c=null!==(i=t.find((function(t){return e in t})))&&void 0!==i?i:a),u.type="number"==typeof c[e]?"linear":"ordinal"}if("number"==typeof u.sortIndex&&(l={key:e,type:u.type,index:u.sortIndex,sortIndex:{},sortIndexCount:0,sortReverse:!0===u.sortReverse},s.push(l)),(null===(n=u.domain)||void 0===n?void 0:n.length)>0)if("ordinal"===u.type){u._domainCache={},o[e]=u;var h={};u.domain.forEach((function(t,e){h[t]=e,u._domainCache[t]=e})),l&&(l.sortIndex=h,l.sortIndexCount=u.domain.length)}else u.domain.length>=2&&(o[e]=u)}};for(var u in r)l(u);return Object.keys(o).length>0&&(t=t.filter((function(t){for(var e in o){var i=o[e];if("ordinal"===i.type){if(!(t[e]in i._domainCache))return!1}else if(i.domain[0]>t[e]||i.domain[1]<t[e])return!1}return!0}))),s.sort((function(t,e){return t.index-e.index})),t.sort((function(t,e){return function(t,e,i){for(var n=0;n<i.length;n++){var r=i[n],a=0;if("ordinal"===r.type?(void 0===r.sortIndex[e[r.key]]&&(r.sortIndex[e[r.key]]=r.sortIndexCount++),void 0===r.sortIndex[t[r.key]]&&(r.sortIndex[t[r.key]]=r.sortIndexCount++),a=r.sortIndex[t[r.key]]-r.sortIndex[e[r.key]]):"linear"===r.type&&(a=t[r.key]-e[r.key]),r.sortReverse&&(a=-a),0!==a)return a}return 0}(t,e,s)})),t};var To={},Co={};function Eo(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'})).join(",")+"}")}function Po(t){var e=Object.create(null),i=[];return t.forEach((function(t){for(var n in t)n in e||i.push(e[n]=n)})),i}function Ro(t,e){var i=t+"",n=i.length;return n<e?new Array(e-n+1).join(0)+i:i}function Bo(t){var e,i=t.getUTCHours(),n=t.getUTCMinutes(),r=t.getUTCSeconds(),a=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":((e=t.getUTCFullYear())<0?"-"+Ro(-e,6):e>9999?"+"+Ro(e,6):Ro(e,4))+"-"+Ro(t.getUTCMonth()+1,2)+"-"+Ro(t.getUTCDate(),2)+(a?"T"+Ro(i,2)+":"+Ro(n,2)+":"+Ro(r,2)+"."+Ro(a,3)+"Z":r?"T"+Ro(i,2)+":"+Ro(n,2)+":"+Ro(r,2)+"Z":n||i?"T"+Ro(i,2)+":"+Ro(n,2)+"Z":"")}function Io(t){var e=new RegExp('["'+t+"\n\r]"),i=t.charCodeAt(0);function n(t,e){var n,r=[],a=t.length,o=0,s=0,l=a<=0,u=!1;function c(){if(l)return Co;if(u)return u=!1,To;var e,n,r=o;if(34===t.charCodeAt(r)){for(;o++<a&&34!==t.charCodeAt(o)||34===t.charCodeAt(++o););return(e=o)>=a?l=!0:10===(n=t.charCodeAt(o++))?u=!0:13===n&&(u=!0,10===t.charCodeAt(o)&&++o),t.slice(r+1,e-1).replace(/""/g,'"')}for(;o<a;){if(10===(n=t.charCodeAt(e=o++)))u=!0;else if(13===n)u=!0,10===t.charCodeAt(o)&&++o;else if(n!==i)continue;return t.slice(r,e)}return l=!0,t.slice(r,a)}for(10===t.charCodeAt(a-1)&&--a,13===t.charCodeAt(a-1)&&--a;(n=c())!==Co;){for(var h=[];n!==To&&n!==Co;)h.push(n),n=c();e&&null==(h=e(h,s++))||r.push(h)}return r}function r(e,i){return e.map((function(e){return i.map((function(t){return o(e[t])})).join(t)}))}function a(e){return e.map(o).join(t)}function o(t){return null==t?"":t instanceof Date?Bo(t):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var i,r,a=n(t,(function(t,n){if(i)return i(t,n-1);r=t,i=e?function(t,e){var i=Eo(t);return function(n,r){return e(i(n),r,t)}}(t,e):Eo(t)}));return a.columns=r||[],a},parseRows:n,format:function(e,i){return null==i&&(i=Po(e)),[i.map(o).join(t)].concat(r(e,i)).join("\n")},formatBody:function(t,e){return null==e&&(e=Po(t)),r(t,e).join("\n")},formatRows:function(t){return t.map(a).join("\n")},formatRow:a,formatValue:o}}var Lo=Io(",").parse,Do=Io("\t").parse,Oo={delimiter:","},Fo=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(arguments.length>2?arguments[2]:void 0).type=ko.DSV;var i=mo(Oo,e).delimiter;if(!Y(i))throw new TypeError("Invalid delimiter: must be a string!");return Io(i).parse(t)},zo=function(t){return(arguments.length>2?arguments[2]:void 0).type=ko.DSV,Lo(t)},Ho=function(t){return(arguments.length>2?arguments[2]:void 0).type=ko.DSV,Do(t)};function jo(t){if(!t)throw new Error("geojson is required");switch(t.type){case"Feature":return No(t);case"FeatureCollection":return function(t){var e={type:"FeatureCollection"};return Object.keys(t).forEach((function(i){switch(i){case"type":case"features":return;default:e[i]=t[i]}})),e.features=t.features.map((function(t){return No(t)})),e}(t);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return Wo(t);default:throw new Error("unknown GeoJSON type")}}function No(t){var e={type:"Feature"};return Object.keys(t).forEach((function(i){switch(i){case"type":case"properties":case"geometry":return;default:e[i]=t[i]}})),e.properties=Vo(t.properties),e.geometry=Wo(t.geometry),e}function Vo(t){var e={};return t?(Object.keys(t).forEach((function(i){var n=t[i];"object"===b(n)?null===n?e[i]=null:Array.isArray(n)?e[i]=n.map((function(t){return t})):e[i]=Vo(n):e[i]=n})),e):e}function Wo(t){var e={type:t.type};return t.bbox&&(e.bbox=t.bbox),"GeometryCollection"===t.type?(e.geometries=t.geometries.map((function(t){return Wo(t)})),e):(e.coordinates=Go(t.coordinates),e)}function Go(t){var e=t;return"object"!==b(e[0])?e.slice():e.map((function(t){return Go(t)}))}function Uo(t){if(Array.isArray(t))return t;if("Feature"===t.type){if(null!==t.geometry)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function Yo(t){for(var e,i,n=Uo(t),r=0,a=1;a<n.length;)e=i||n[0],r+=((i=n[a])[0]-e[0])*(i[1]+e[1]),a++;return r>0}function Xo(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var i=0;i<t.features.length&&!1!==e(t.features[i],i);i++);}function Ko(t,e){var i,n,r,a,o,s,l,u,c,h,d=0,p="FeatureCollection"===t.type,f="Feature"===t.type,v=p?t.features.length:1;for(i=0;i<v;i++){for(s=p?t.features[i].geometry:f?t.geometry:t,u=p?t.features[i].properties:f?t.properties:{},c=p?t.features[i].bbox:f?t.bbox:void 0,h=p?t.features[i].id:f?t.id:void 0,o=(l=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,r=0;r<o;r++)if(null!==(a=l?s.geometries[r]:s))switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(a,d,u,c,h))return!1;break;case"GeometryCollection":for(n=0;n<a.geometries.length;n++)if(!1===e(a.geometries[n],d,u,c,h))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,d,u,c,h))return!1;d++}}function qo(t,e){if(!(i=e=e||{})||i.constructor!==Object)throw new Error("options is invalid");var i,n=e.reverse||!1,r=e.mutate||!1;if(!t)throw new Error("<geojson> is required");if("boolean"!=typeof n)throw new Error("<reverse> must be a boolean");if("boolean"!=typeof r)throw new Error("<mutate> must be a boolean");!1===r&&(t=jo(t));var a=[];switch(t.type){case"GeometryCollection":return Ko(t,(function(t){Zo(t,n)})),t;case"FeatureCollection":return Xo(t,(function(t){Xo(Zo(t,n),(function(t){a.push(t)}))})),Oi(a)}return Zo(t,n)}function Zo(t,e){switch("Feature"===t.type?t.geometry.type:t.type){case"GeometryCollection":return Ko(t,(function(t){Zo(t,e)})),t;case"LineString":return Jo(Uo(t),e),t;case"Polygon":return Qo(Uo(t),e),t;case"MultiLineString":return Uo(t).forEach((function(t){Jo(t,e)})),t;case"MultiPolygon":return Uo(t).forEach((function(t){Qo(t,e)})),t;case"Point":case"MultiPoint":return t}}function Jo(t,e){Yo(t)===e&&t.reverse()}function Qo(t,e){Yo(t[0])!==e&&t[0].reverse();for(var i=1;i<t.length;i++)Yo(t[i])===e&&t[i].reverse()}function $o(t){if(!t)throw new Error("geojson is required");var e=[];return function(t,e){Ko(t,(function(t,i,n,r,a){var o,s=null===t?null:t.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return!1!==e(Di(t,n,{bbox:r,id:a}),i,0)&&void 0}switch(s){case"MultiPoint":o="Point";break;case"MultiLineString":o="LineString";break;case"MultiPolygon":o="Polygon"}for(var l=0;l<t.coordinates.length;l++){var u=t.coordinates[l];if(!1===e(Di({type:o,coordinates:u},n),i,l))return!1}}))}(t,(function(t){e.push(t)})),Oi(e)}var ts=ka(),es={centroid:!1,name:!1,bbox:!1,rewind:!1},is=function(t){if(t.geometry.type.startsWith("Multi")){var e=$o(t).features[0];return Object.assign(Object.assign({},e),e.properties)}return Object.assign(Object.assign({},t),t.properties)},ns=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(arguments.length>2?arguments[2]:void 0).type=ko.GEO;var i=mo(es,e),n=i.centroid,r=i.name,a=i.bbox,o=i.rewind;if(Array.isArray(t))return function(t){var e=[];return t.forEach((function(t){"FeatureCollection"===t.type?t.features.forEach((function(t){e.push(is(t))})):e.push(is(t))})),e}(t);var s=t.features;return o&&(s=qo(t,{reverse:!V(o)||o.reverse}).features),s.forEach((function(t){if(n){var e=ts.centroid(t);t.centroidX=e[0],t.centroidY=e[1]}if(r&&(t.name=t.properties.name),a){var i=ts.bounds(t);t.bbox=i}})),t.features=s,t},rs={},as=function(t,e,i){i.type=ko.GEO;var n=mo(es,rs,e),r=n.object;if(!Y(r))throw new TypeError("Invalid object: must be a string!");var a,o,s=(a=t,"string"==typeof(o=t.objects[r])&&(o=a.objects[o]),"GeometryCollection"===o.type?{type:"FeatureCollection",features:o.geometries.map((function(t){return co(a,t)}))}:co(a,o));return ns(s,n,i)},os=function(t,e,i){var n=!z(null==e?void 0:e.dependencyUpdate)||(null==e?void 0:e.dependencyUpdate);if(!t||!X(t))throw new TypeError("Invalid data: must be DataView array!");return X(i.rawData)&&i.rawData.forEach((function(t){t.target&&(t.target.removeListener("change",i.reRunAllTransform),t.target.removeListener("markRunning",i.markRunning))})),n&&t.forEach((function(t){t.target.addListener("change",i.reRunAllTransform),t.target.addListener("markRunning",i.markRunning)})),t},ss={svg:"group",rect:"rect",line:"rule",polygon:"polygon",path:"path",polyline:"line",g:"group",circle:"arc",ellipse:"arc"},ls=Object.keys(ss),us=["g","svg","text","tspan","switch"],cs=["font-size","font-family","font-weight","font-style","text-align","text-anchor"],hs=["visibility","x","y","width","height","d","points","stroke","stroke-width","fill","fill-opacity","stroke-opacity"].concat(cs,["cx","cy","r"],["cx","cy","rx","ry"],["x1","x2","y1","y2"]),ds=["visible","fill","stroke","stroke-width","fill-opacity","stroke-opacity"].concat(cs),ps=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g;var fs=function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).customDOMParser;if(e||(null===window||void 0===window?void 0:window.DOMParser)&&(e=function(t){return(new DOMParser).parseFromString(t,"text/xml")}),!e)throw new Error("No Available DOMParser!");for(var i=e(t),n=9===i.nodeType?i.firstChild:i;n&&("svg"!==n.nodeName.toLowerCase()||1!==n.nodeType);)n=n.nextSibling;return n?function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=[],n=ms(t,null),r=parseFloat(t.getAttribute("width")||e.width),a=parseFloat(t.getAttribute("height")||e.height);!Q(r)&&(r=null),!Q(a)&&(a=null);var o,s=t.getAttribute("viewBox");if(s){var l=s.match(ps)||[];if(l.length>=4&&(o={x:parseFloat(l[0]||0),y:parseFloat(l[1]||0),width:parseFloat(l[2]),height:parseFloat(l[3])},r||a)){var u={x:0,y:0,width:r,height:a},c=u.width/o.width,h=u.height/o.height,d=Math.min(c,h),p=-(o.x+o.width/2)*d+(u.x+u.width/2),f=-(o.y+o.height/2)*d+(u.y+u.height/2),v=(new vi).translate(p,f).scale(d,d);n.transform=v}}return bs(t,n,i),{root:n,width:r,height:a,elements:i,viewBoxRect:o}}(n):null},vs=0;function gs(t){var e,i=t.parent,n=t.attributes,r=function(t){return t?ds.reduce((function(e,i){var n=Bi(i);return N(t[n])&&(e[n]=t[n]),e}),{}):{}};return i?(i._inheritStyle||(i._inheritStyle=r(i.attributes)),e=ft({},i._inheritStyle,r(n))):e=r(n),e}function ys(t){for(var e,i,n,r={},a=null!==(e=t.attributes)&&void 0!==e?e:{},o=null!==(i=t.style)&&void 0!==i?i:{},s=0;s<hs.length;s++){var l=hs[s],u=N(o[l])&&""!==o[l]?o[l]:null===(n=a[l])||void 0===n?void 0:n.value;N(u)&&(r[Bi(l)]=isNaN(+u)?u:parseFloat(u))}return"none"===o.display&&(r.visible=!1),["fontSize","strokeWidth","width","height"].forEach((function(t){var e=r[t];Y(r[t])&&(r[t]=parseFloat(e))})),r}function ms(t,e){var i,n,r,a,o,s=null===(i=t.tagName)||void 0===i?void 0:i.toLowerCase();if(3===t.nodeType||"text"===s||"tspan"===s)return function(t,e){var i,n,r,a,o,s;if(!e)return null;var l=null===(i=t.tagName)||void 0===i?void 0:i.toLowerCase();if(!l&&"group"!==e.graphicType)return null;var u,c="text"===l||"tspan"===l,h=c?"group":"text",d=c||null===(n=t.textContent)||void 0===n?void 0:n.replace(/\n/g," ").replace(/\s+/g," ");return" "===d?null:(u=c?{tagName:l,graphicType:h,attributes:ys(t),parent:e,name:t.getAttribute("name"),id:null!==(r=t.getAttribute("id"))&&void 0!==r?r:"".concat(l,"-").concat(vs++),transform:_s(t),value:d}:{tagName:l,graphicType:"text",attributes:ys(t),parent:e,name:null==e?void 0:e.name,id:null!==(o=null===(a=t.getAttribute)||void 0===a?void 0:a.call(t,"id"))&&void 0!==o?o:"".concat(l,"-").concat(vs++),value:d},u._inheritStyle=gs(u),N(u.name)||(u._nameFromParent=null!==(s=e.name)&&void 0!==s?s:e._nameFromParent),c?e._textGroupStyle?u._textGroupStyle=ft({},e._textGroupStyle,ys(t)):u._textGroupStyle=ys(t):u.attributes=u._inheritStyle,u)}(t,e);if(!ls.includes(s))return null;var l={tagName:s,graphicType:ss[s],attributes:ys(t),parent:e,name:null!==(n=t.getAttribute("name"))&&void 0!==n?n:null===(r=null==e?void 0:e.attributes)||void 0===r?void 0:r.name,id:null!==(a=t.getAttribute("id"))&&void 0!==a?a:"".concat(s,"-").concat(vs++),transform:_s(t)};return l._inheritStyle=gs(l),e&&!N(l.name)&&(l._nameFromParent=null!==(o=e.name)&&void 0!==o?o:e._nameFromParent),l}function _s(t){var e,i,n=null===(e=t.transform)||void 0===e?void 0:e.baseVal;if(!n)return null;var r=null===(i=n.consolidate())||void 0===i?void 0:i.matrix;if(!r)return null;var a=r.a,o=r.b,s=r.c,l=r.d,u=r.e,c=r.f;return new vi(a,o,s,l,u,c)}function bs(t,e){var i,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(t){var r;"svg"!==t.nodeName&&(r=ms(t,e)),r&&n.push(r);for(var a=us.includes(null===(i=t.tagName)||void 0===i?void 0:i.toLocaleLowerCase())?t.firstChild:null;a;)bs(a,null!=r?r:e,n),a=a.nextSibling}}var xs=0;function ks(){return xs>1e8&&(xs=0),(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"dataset")+"_"+xs++}var Ss=function(){return o((function t(e){var i,n;r(this,t),this.options=e,this.isDataSet=!0,this.transformMap={},this.parserMap={},this.dataViewMap={},this.target=new O,n=(null==e?void 0:e.name)?e.name:ks("dataset"),this.name=n,this._logger=null!==(i=null==e?void 0:e.logger)&&void 0!==i?i:Lt.getInstance()}),[{key:"setLogger",value:function(t){this._logger=t}},{key:"getDataView",value:function(t){return this.dataViewMap[t]}},{key:"setDataView",value:function(t,e){var i;this.dataViewMap[t]&&(null===(i=this._logger)||void 0===i||i.error("Error: dataView ".concat(t," 之前已存在，请重新命名"))),this.dataViewMap[t]=e}},{key:"removeDataView",value:function(t){this.dataViewMap[t]=null,delete this.dataViewMap[t]}},{key:"registerParser",value:function(t,e){var i;this.parserMap[t]&&(null===(i=this._logger)||void 0===i||i.warn("Warn: transform ".concat(t," 之前已注册，执行覆盖逻辑"))),this.parserMap[t]=e}},{key:"removeParser",value:function(t){this.parserMap[t]=null,delete this.parserMap[t]}},{key:"getParser",value:function(t){return this.parserMap[t]||this.parserMap.default}},{key:"registerTransform",value:function(t,e){var i;this.transformMap[t]&&(null===(i=this._logger)||void 0===i||i.warn("Warn: transform ".concat(t," 之前已注册，执行覆盖逻辑"))),this.transformMap[t]=e}},{key:"removeTransform",value:function(t){this.transformMap[t]=null,delete this.transformMap[t]}},{key:"getTransform",value:function(t){return this.transformMap[t]}},{key:"multipleDataViewAddListener",value:function(t,e,i){this._callMap||(this._callMap=new Map);var n=this._callMap.get(i);n||(n=function(){t.some((function(t){return t.isRunning}))||i()}),t.forEach((function(t){t.target.addListener(e,n)})),this._callMap.set(i,n)}},{key:"allDataViewAddListener",value:function(t,e){this.multipleDataViewAddListener(Object.values(this.dataViewMap),t,e)}},{key:"multipleDataViewRemoveListener",value:function(t,e,i){if(this._callMap){var n=this._callMap.get(i);n&&t.forEach((function(t){t.target.removeListener(e,n)})),this._callMap.delete(i)}}},{key:"multipleDataViewUpdateInParse",value:function(t){var e=this;t.forEach((function(t){var i;return null===(i=e.getDataView(t.name))||void 0===i?void 0:i.markRunning()})),t.forEach((function(t){var i;return null===(i=e.getDataView(t.name))||void 0===i?void 0:i.parseNewData(t.data,t.options)}))}},{key:"multipleDataViewUpdateInRawData",value:function(t){var e=this;t.forEach((function(t){var i;return null===(i=e.getDataView(t.name))||void 0===i?void 0:i.markRunning()})),t.forEach((function(t){var i;return null===(i=e.getDataView(t.name))||void 0===i?void 0:i.updateRawData(t.data,t.options)}))}},{key:"destroy",value:function(){this.transformMap=null,this.parserMap=null,this.dataViewMap=null,this._callMap=null,this.target.removeAllListeners()}}])}(),As="_data-view-diff-rank",Ms=function(){function t(e,i){var n,a=this;r(this,t),this.dataSet=e,this.options=i,this.isDataView=!0,this.target=new O,this.parseOption=null,this.transformsArr=[],this.isRunning=!1,this.rawData={},this.history=!1,this.parserData={},this.latestData={},this._fields=null,this.reRunAllTransform=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{pushHistory:!0,emitMessage:!0};return a.isRunning=!0,a.resetTransformData(),a.transformsArr.forEach((function(e){a.executeTransform(e,{pushHistory:t.pushHistory,emitMessage:!1}),a.isLastTransform(e)&&a.diffLastData()})),a.isRunning=!1,!1!==t.emitMessage&&a.target.emit("change",[]),a},this.markRunning=function(){a.isRunning=!0,a.target.emit("markRunning",[])},n=(null==i?void 0:i.name)?i.name:ks("dataview"),this.name=n,(null==i?void 0:i.history)&&(this.history=i.history,this.historyData=[]),this.dataSet.setDataView(n,this),this.setFields(null==i?void 0:i.fields)}return o(t,[{key:"parse",value:function(t,e){var i,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.isRunning=!0,n&&this.target.emit("beforeParse",[]),e&&(this.parseOption=e);var r=this.cloneParseData(t,e);if(null==e?void 0:e.type){var a=(null!==(i=this.dataSet.getParser(e.type))&&void 0!==i?i:this.dataSet.getParser("bytejson"))(r,e.options,this);this.rawData=r,this.parserData=a,this.history&&this.historyData.push(r,a),this.latestData=a}else this.parserData=r,this.rawData=r,this.history&&this.historyData.push(r),this.latestData=r;return this.isRunning=!1,n&&this.target.emit("afterParse",[]),this}},{key:"transform",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.isRunning=!0,t&&t.type){var i=!0;if("fields"===t.type){this._fields=t.options.fields;var n=this.transformsArr.findIndex((function(e){return e.type===t.type}));n>=0&&(i=!1,this.transformsArr[n].options.fields=this._fields)}if(i&&this.transformsArr.push(t),e){var r=this.isLastTransform(t);this.executeTransform(t),r&&this.diffLastData()}}return this.sortTransform(),this.isRunning=!1,this}},{key:"isLastTransform",value:function(t){return this.transformsArr[this.transformsArr.length-1]===t}},{key:"sortTransform",value:function(){this.transformsArr.length>=2&&this.transformsArr.sort((function(t,e){var i,n;return(null!==(i=t.level)&&void 0!==i?i:0)-(null!==(n=e.level)&&void 0!==n?n:0)}))}},{key:"executeTransform",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{pushHistory:!0,emitMessage:!0},i=e.pushHistory,n=e.emitMessage,r=this.dataSet.getTransform(t.type)(this.latestData,t.options);this.history&&!1!==i&&this.historyData.push(r),this.latestData=r,!1!==n&&this.target.emit("change",[])}},{key:"resetTransformData",value:function(){this.latestData=this.parserData,this.history&&(this.historyData.length=0,this.historyData.push(this.rawData,this.parserData))}},{key:"enableDiff",value:function(t){this._diffData=!0,this._diffKeys=t,this._diffMap=new Map,this._diffRank=0}},{key:"disableDiff",value:function(){this._diffData=!1,this._diffMap=null,this._diffRank=null}},{key:"resetDiff",value:function(){this._diffMap=new Map,this._diffRank=0}},{key:"diffLastData",value:function(){var t,e=this;if(this._diffData&&this.latestData.forEach&&(null===(t=this._diffKeys)||void 0===t?void 0:t.length)){var i,n=this._diffRank+1;if(0===this._diffRank)this.latestData.forEach((function(t){t[As]=n,e._diffMap.set(e._diffKeys.reduce((function(e,i){return e+t[i]}),""),t)})),this.latestDataAUD={add:Array.from(this.latestData),del:[],update:[]};else this.latestDataAUD={add:[],del:[],update:[]},this.latestData.forEach((function(t){t[As]=n,i=e._diffKeys.reduce((function(e,i){return e+t[i]}),""),e._diffMap.get(i)?e.latestDataAUD.update.push(t):e.latestDataAUD.add.push(t),e._diffMap.set(i,t)})),this._diffMap.forEach((function(t,i){t[As]<n&&(e.latestDataAUD.del.push(t),e._diffMap.delete(i))}));this._diffRank=n}}},{key:"cloneParseData",value:function(e,i){var n=!1;return e instanceof t||!0!==(null==i?void 0:i.clone)||(n=!0),n?ct(e):e}},{key:"parseNewData",value:function(t,e){this.parse(t,e||this.parseOption),this.reRunAllTransform()}},{key:"updateRawData",value:function(t,e){var i=this.cloneParseData(t,e);this.rawData=i,this.parserData=i,this.latestData=i,this.reRunAllTransform()}},{key:"getFields",value:function(){var t;return this._fields?this._fields:"dataview"===(null===(t=this.parseOption)||void 0===t?void 0:t.type)&&1===this.rawData.length&&this.rawData[0].getFields?this.rawData[0].getFields():null}},{key:"setFields",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._fields=t&&e?ft({},this._fields,t):t;var i=this.transformsArr.find((function(t){return"fields"===t.type}));!j(this._fields)&&j(i)?(this.dataSet.registerTransform("fields",wo),this.transform({type:"fields",options:{fields:this._fields}},!1)):i&&(i.options.fields=this._fields)}},{key:"destroy",value:function(){this.dataSet.removeDataView(this.name),this._diffMap=null,this._diffRank=null,this.latestData=null,this.rawData=null,this.parserData=null,this.transformsArr=null,this.target=null}}])}();var ws=function(){function t(){r(this,t)}return o(t,null,[{key:"GenAutoIncrementId",value:function(){return t.auto_increment_id++}}])}();ws.auto_increment_id=0;var Ts=o((function t(e){r(this,t),this.id=ws.GenAutoIncrementId(),this.registry=e})),Cs="named",Es="inject",Ps="multi_inject",Rs="inversify:tagged",Bs="inversify:paramtypes",Is=function(){return o((function t(e,i){r(this,t),this.key=e,this.value=i}),[{key:"toString",value:function(){return this.key===Cs?"named: ".concat(String(this.value).toString()," "):"tagged: { key:".concat(this.key.toString(),", value: ").concat(String(this.value)," }")}}])}(),Ls=function(t){var e;return function(t){var e="function"==typeof Symbol&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",i=Object.getPrototypeOf(Function),n=("object"==("undefined"==typeof process?"undefined":b(process))&&process.env&&process.env.REFLECT_METADATA_USE_MAP_POLYFILL,Map),r=new WeakMap;function a(t,e,i){var a=r.get(t);if(u(a)){if(!i)return;a=new n,r.set(t,a)}var o=a.get(e);if(u(o)){if(!i)return;o=new n,a.set(e,o)}return o}function o(t,e,i){if(s(t,e,i))return!0;var n=v(e);return!c(n)&&o(t,n,i)}function s(t,e,i){var n=a(e,i,!1);return!u(n)&&!!n.has(t)}function l(t,e,i){if(s(t,e,i))return function(t,e,i){var n=a(e,i,!1);if(!u(n))return n.get(t)}(t,e,i);var n=v(e);return c(n)?void 0:l(t,n,i)}function u(t){return void 0===t}function c(t){return null===t}function h(t){return"object"==b(t)?null!==t:"function"==typeof t}function d(t,i){switch(function(t){if(null===t)return 1;switch(b(t)){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===t?1:6;default:return 6}}(t)){case 0:case 1:case 2:case 3:case 4:case 5:return t}var n=3===i?"string":5===i?"number":"default",r=function(t,e){var i=t[e];if(null!=i){if(!f(i))throw new TypeError;return i}}(t,e);if(void 0!==r){var a=r.call(t,n);if(h(a))throw new TypeError;return a}return function(t,e){if("string"===e){var i=t.toString;if(f(i)){var n=i.call(t);if(!h(n))return n}var r=t.valueOf;if(f(r)){var a=r.call(t);if(!h(a))return a}}else{var o=t.valueOf;if(f(o)){var s=o.call(t);if(!h(s))return s}var l=t.toString;if(f(l)){var u=l.call(t);if(!h(u))return u}}throw new TypeError}(t,"default"===n?"number":n)}function p(t){var e=d(t,3);return"symbol"==b(e)?e:function(t){return""+t}(e)}function f(t){return"function"==typeof t}function v(t){var e=Object.getPrototypeOf(t);if("function"!=typeof t||t===i)return e;if(e!==i)return e;var n=t.prototype,r=n&&Object.getPrototypeOf(n);if(null==r||r===Object.prototype)return e;var a=r.constructor;return"function"!=typeof a||a===t?e:a}t("defineMetadata",(function(t,e,i,n){if(!h(i))throw new TypeError;return r=t,o=e,void a(i,n,!0).set(r,o);var r,o})),t("hasMetadata",(function(t,e,i){if(!h(e))throw new TypeError;return u(i)||(i=p(i)),o(t,e,i)})),t("hasOwnMetadata",(function(t,e,i){if(!h(e))throw new TypeError;return u(i)||(i=p(i)),s(t,e,i)})),t("getMetadata",(function(t,e,i){if(!h(e))throw new TypeError;return u(i)||(i=p(i)),l(t,e,i)}))}((e=t,function(t,i){"function"!=typeof e[t]&&Object.defineProperty(e,t,{configurable:!0,writable:!0,value:i})})),t}({});function Ds(t,e,i,n){!function(t,e,i,n){var r,a=[n],o={};Ls.hasOwnMetadata(t,e)&&(o=Ls.getMetadata(t,e));var s=o[i];void 0===s&&(s=[]),(r=s).push.apply(r,a),o[i]=s,Ls.defineMetadata(t,o,e)}(Rs,t,i.toString(),n)}function Os(t){return function(e,i,n){Ds(e,0,n,t)}}function Fs(t){return function(e){return function(i,n,r){return Os(new Is(t,e))(i,n,r)}}}var zs=Fs(Es),Hs=Fs(Ps);function js(){return function(t){return Ls.defineMetadata(Bs,null,t),t}}function Ns(t){return Os(new Is(Cs,t))}var Vs,Ws="Singleton",Gs="Transient",Us="ConstantValue",Ys="DynamicValue",Xs="Factory",Ks="Function",qs="Instance",Zs="Invalid",Js=function(){function t(e,i){r(this,t),this.id=ws.GenAutoIncrementId(),this.activated=!1,this.serviceIdentifier=e,this.scope=i,this.type=Zs,this.constraint=function(t){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.dynamicValue=null}return o(t,[{key:"clone",value:function(){var e=new t(this.serviceIdentifier,this.scope);return e.activated=e.scope===Ws&&this.activated,e.implementationType=this.implementationType,e.dynamicValue=this.dynamicValue,e.scope=this.scope,e.type=this.type,e.provider=this.provider,e.constraint=this.constraint,e.cache=this.cache,e}}])}(),Qs=function(){return o((function t(){r(this,t)}),[{key:"getConstructorMetadata",value:function(t){return{compilerGeneratedMetadata:Ls.getMetadata(Bs,t),userGeneratedMetadata:Ls.getMetadata(Rs,t)||{}}}},{key:"getPropertiesMetadata",value:function(t){throw new Error("暂未实现")}}])}(),$s=(Vs=Cs,function(t){var e=function(e){if(null==e)return!1;if(e.key===Vs&&e.value===t)return!0;if(null==e.constructorArgsMetadata)return!1;for(var i=e.constructorArgsMetadata,n=0;n<i.length;n++)if(i[n].key===Vs&&i[n].value===t)return!0;return!1};return e.metaData=new Is(Vs,t),e}),tl=function(){return o((function t(e){r(this,t),this._binding=e}),[{key:"inRequestScope",value:function(){throw new Error("暂未实现")}},{key:"inSingletonScope",value:function(){return this._binding.scope=Ws,this}},{key:"inTransientScope",value:function(){return this._binding.scope=Gs,this}},{key:"whenTargetNamed",value:function(t){return this._binding.constraint=$s(t),this}}])}(),el=function(){return o((function t(e){r(this,t),this._binding=e}),[{key:"to",value:function(t){return this._binding.type=qs,this._binding.implementationType=t,new tl(this._binding)}},{key:"toSelf",value:function(){var t=this._binding.serviceIdentifier;return this.to(t)}},{key:"toDynamicValue",value:function(t){return this._binding.type=Ys,this._binding.cache=null,this._binding.dynamicValue=t,this._binding.implementationType=null,new tl(this._binding)}},{key:"toConstantValue",value:function(t){return this._binding.type=Us,this._binding.cache=t,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=Ws,new tl(this._binding)}},{key:"toFactory",value:function(t){return this._binding.type=Xs,this._binding.factory=t,this._binding.scope=Ws,new tl(this._binding)}},{key:"toService",value:function(t){this.toDynamicValue((function(e){return e.container.get(t)}))}}])}(),il=function(){return o((function t(e){r(this,t);var i=e||{};i.defaultScope=i.defaultScope||Gs,this.options=i,this.id=ws.GenAutoIncrementId(),this._bindingDictionary=new Map,this._metadataReader=new Qs}),[{key:"load",value:function(t){var e=this._getContainerModuleHelpersFactory()(t.id);t.registry(e.bindFunction,e.unbindFunction,e.isboundFunction,e.rebindFunction)}},{key:"get",value:function(t){var e=this._getNotAllArgs(t,!1);return this._get(e)}},{key:"getAll",value:function(t){var e=this._getAllArgs(t);return this._get(e)}},{key:"getTagged",value:function(t,e,i){var n=this._getNotAllArgs(t,!1,e,i);return this._get(n)}},{key:"getNamed",value:function(t,e){return this.getTagged(t,Cs,e)}},{key:"isBound",value:function(t){return this._bindingDictionary.has(t)}},{key:"bind",value:function(t){var e=this.options.defaultScope,i=new Js(t,e),n=this._bindingDictionary.get(t)||[];return n.push(i),this._bindingDictionary.set(t,n),new el(i)}},{key:"unbind",value:function(t){this._bindingDictionary.delete(t)}},{key:"rebind",value:function(t){return this.unbind(t),this.bind(t)}},{key:"_getContainerModuleHelpersFactory",value:function(){var t=this,e=function(t,e){t._binding.moduleId=e},i=function(i){return function(n){var r=t.rebind(n);return e(r,i),r}};return function(n){return{bindFunction:(r=n,function(i){var n=t.bind(i);return e(n,r),n}),isboundFunction:function(e){return t.isBound(e)},rebindFunction:i(n),unbindFunction:function(e){return t.unbind(e)},unbindAsyncFunction:function(t){return null}};var r}}},{key:"_getNotAllArgs",value:function(t,e,i,n){return{avoidConstraints:!1,isMultiInject:e,serviceIdentifier:t,key:i,value:n}}},{key:"_getAllArgs",value:function(t){return{avoidConstraints:!0,isMultiInject:!0,serviceIdentifier:t}}},{key:"_get",value:function(t){var e=this,i=[];return this._bindingDictionary.get(t.serviceIdentifier).filter((function(e){return e.constraint(t)})).forEach((function(t){i.push(e._resolveFromBinding(t))})),t.isMultiInject||1!==i.length?i:i[0]}},{key:"_getChildRequest",value:function(t){for(var e=this,i=t.implementationType,n=this._metadataReader.getConstructorMetadata(i).userGeneratedMetadata,r=Object.keys(n),a=[],o=function(){var t=n[s],i={};t.forEach((function(t){i[t.key]=t.value}));var r={inject:i[Es],multiInject:i[Ps]},o=r.inject||r.multiInject,l={serviceIdentifier:o,constructorArgsMetadata:t},u=(e._bindingDictionary.get(o)||[]).filter((function(t){return t.constraint(l)}));if(u.length){var c={injectIdentifier:o,metadata:t,bindings:u};a.push(c)}},s=0;s<r.length;s++)o();return a}},{key:"_resolveFromBinding",value:function(t){var e=this._getResolvedFromBinding(t);return this._saveToScope(t,e),e}},{key:"_getResolvedFromBinding",value:function(t){var e;switch(t.type){case Us:case Ks:e=t.cache;break;case qs:e=this._resolveInstance(t,t.implementationType);break;default:e=t.dynamicValue({container:this})}return e}},{key:"_resolveInstance",value:function(t,e){if(t.activated)return t.cache;var i=this._getChildRequest(t);return this._createInstance(e,i)}},{key:"_createInstance",value:function(t,e){return e.length?function(t,e,i){if(d())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var r=new(t.bind.apply(t,n));return i&&v(r,i.prototype),r}(t,m(this._resolveRequests(e))):new t}},{key:"_resolveRequests",value:function(t){var e=this;return t.map((function(t){return t.bindings.length>1?t.bindings.map((function(t){return e._resolveFromBinding(t)})):e._resolveFromBinding(t.bindings[0])}))}},{key:"_saveToScope",value:function(t,e){t.scope===Ws&&(t.cache=e,t.activated=!0)}}])}(),nl=Symbol("ContributionProvider"),rl=function(){return o((function t(e,i){r(this,t),this.serviceIdentifier=e,this.container=i}),[{key:"getContributions",value:function(){var t;return this.caches||(this.caches=[],this.container&&this.container.isBound(this.serviceIdentifier)&&(t=this.caches).push.apply(t,m(this.container.getAll(this.serviceIdentifier)))),this.caches}}])}();function al(t,e){t(nl).toDynamicValue((function(t){var i=t.container;return new rl(e,i)})).inSingletonScope().whenTargetNamed(e)}var ol,sl=function(){return o((function t(e,i){r(this,t),this._args=e,this.name=i,this.taps=[]}),[{key:"tap",value:function(t,e){this._tap("sync",t,e)}},{key:"unTap",value:function(t,e){var i="string"==typeof t?t.trim():t.name;i&&(this.taps=this.taps.filter((function(t){return!(t.name===i&&(!e||t.fn===e))})))}},{key:"_parseOptions",value:function(t,e,i){var n;if("string"==typeof e)n={name:e.trim()};else if("object"!=b(e)||null===e)throw new Error("Invalid tap options");if("string"!=typeof n.name||""===n.name)throw new Error("Missing name for tap");return n=Object.assign({type:t,fn:i},n)}},{key:"_tap",value:function(t,e,i){this._insert(this._parseOptions(t,e,i))}},{key:"_insert",value:function(t){var e;"string"==typeof t.before?e=new Set([t.before]):Array.isArray(t.before)&&(e=new Set(t.before));var i=0;"number"==typeof t.stage&&(i=t.stage);for(var n=this.taps.length;n>0;){n--;var r=this.taps[n];this.taps[n+1]=r;var a=r.stage||0;if(e){if(e.has(r.name)){e.delete(r.name);continue}if(e.size>0)continue}if(!(a>i)){n++;break}}this.taps[n]=t}}])}(),ll=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"call",value:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];this.taps.map((function(t){return t.fn})).forEach((function(t){return t.apply(void 0,e)}))}}])}(sl),ul=Symbol.for("EnvContribution"),cl=Symbol.for("VGlobal"),hl=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},dl=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},pl=function(t,e){return function(i,n){e(i,n,t)}},fl=function(t,e,i,n){return new(i||(i=Promise))((function(r,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,s)}l((n=n.apply(t,e||[])).next())}))},vl=function(){return o((function t(e){r(this,t),this.contributions=e,this._isImageAnonymous=!0,this.id=ws.GenAutoIncrementId(),this.hooks={onSetEnv:new ll(["lastEnv","env","global"])},this.measureTextMethod="native",this.optimizeVisible=!1}),[{key:"env",get:function(){return this._env}},{key:"isImageAnonymous",get:function(){return this._isImageAnonymous},set:function(t){this._isImageAnonymous=t}},{key:"devicePixelRatio",get:function(){return this._env||this.setEnv("browser"),this.envContribution.getDevicePixelRatio()}},{key:"supportEvent",get:function(){return this._env||this.setEnv("browser"),this.envContribution.supportEvent},set:function(t){this._env||this.setEnv("browser"),this.envContribution.supportEvent=t}},{key:"supportsTouchEvents",get:function(){return this._env||this.setEnv("browser"),this.envContribution.supportsTouchEvents},set:function(t){this._env||this.setEnv("browser"),this.envContribution.supportsTouchEvents=t}},{key:"supportsPointerEvents",get:function(){return this._env||this.setEnv("browser"),this.envContribution.supportsPointerEvents},set:function(t){this._env||this.setEnv("browser"),this.envContribution.supportsPointerEvents=t}},{key:"supportsMouseEvents",get:function(){return this._env||this.setEnv("browser"),this.envContribution.supportsMouseEvents},set:function(t){this._env||this.setEnv("browser"),this.envContribution.supportsMouseEvents=t}},{key:"applyStyles",get:function(){return this._env||this.setEnv("browser"),this.envContribution.applyStyles},set:function(t){this._env||this.setEnv("browser"),this.envContribution.applyStyles=t}},{key:"bindContribution",value:function(t){var e=this,i=[];if(this.contributions.getContributions().forEach((function(n){var r=n.configure(e,t);r&&r.then&&i.push(r)})),i.length)return Promise.all(i)}},{key:"getDynamicCanvasCount",value:function(){return this._env||this.setEnv("browser"),this.envContribution.getDynamicCanvasCount()}},{key:"getStaticCanvasCount",value:function(){return this._env||this.setEnv("browser"),this.envContribution.getStaticCanvasCount()}},{key:"setEnv",value:function(t,e){if(e&&!0===e.force||this._env!==t)return this.deactiveCurrentEnv(),this.activeEnv(t,e)}},{key:"deactiveCurrentEnv",value:function(){this.envContribution&&this.envContribution.release()}},{key:"activeEnv",value:function(t,e){var i=this,n=this._env;this._env=t;var r=this.bindContribution(e);if(r&&r.then)return r.then((function(){i.envParams=e,i.hooks.onSetEnv.call(n,t,i)}));this.envParams=e,this.hooks.onSetEnv.call(n,t,this)}},{key:"setActiveEnvContribution",value:function(t){this.envContribution=t}},{key:"createCanvas",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.createCanvas(t)}},{key:"createOffscreenCanvas",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.createOffscreenCanvas(t)}},{key:"releaseCanvas",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.releaseCanvas(t)}},{key:"addEventListener",value:function(t,e,i){return this._env||this.setEnv("browser"),this.envContribution.addEventListener(t,e,i)}},{key:"removeEventListener",value:function(t,e,i){return this._env||this.setEnv("browser"),this.envContribution.removeEventListener(t,e,i)}},{key:"dispatchEvent",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.dispatchEvent(t)}},{key:"getRequestAnimationFrame",value:function(){return this._env||this.setEnv("browser"),this.envContribution.getRequestAnimationFrame()}},{key:"getCancelAnimationFrame",value:function(){return this._env||this.setEnv("browser"),this.envContribution.getCancelAnimationFrame()}},{key:"getElementById",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.getElementById?this.envContribution.getElementById(t):null}},{key:"getRootElement",value:function(){return this._env||this.setEnv("browser"),this.envContribution.getRootElement?this.envContribution.getRootElement():null}},{key:"getDocument",value:function(){return this._env||this.setEnv("browser"),this.envContribution.getDocument?this.envContribution.getDocument():null}},{key:"mapToCanvasPoint",value:function(t,e){return this._env||this.setEnv("browser"),this.envContribution.mapToCanvasPoint?this.envContribution.mapToCanvasPoint(t,e):null}},{key:"loadImage",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.loadImage(t)}},{key:"loadSvg",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.loadSvg(t)}},{key:"loadJson",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.loadJson(t)}},{key:"loadArrayBuffer",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.loadArrayBuffer(t)}},{key:"loadBlob",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.loadBlob(t)}},{key:"loadFont",value:function(t,e,i){return fl(this,void 0,void 0,f().mark((function n(){return f().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(this._env||this.setEnv("browser"),this.envContribution.loadFont(t,e,i)));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"isChrome",value:function(){return null!=this._isChrome||(this._env||this.setEnv("browser"),this._isChrome="browser"===this._env&&navigator.userAgent.indexOf("Chrome")>-1),this._isChrome}},{key:"isSafari",value:function(){return null!=this._isSafari||(this._env||this.setEnv("browser"),this._isSafari="browser"===this._env&&/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)),this._isSafari}},{key:"getNativeAABBBounds",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.getNativeAABBBounds(t)}},{key:"removeDom",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.removeDom(t)}},{key:"createDom",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.createDom(t)}},{key:"updateDom",value:function(t,e){return this._env||this.setEnv("browser"),this.envContribution.updateDom(t,e)}},{key:"getElementTop",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._env||this.setEnv("browser"),this.envContribution.getElementTop(t,e)}},{key:"getElementLeft",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._env||this.setEnv("browser"),this.envContribution.getElementLeft(t,e)}},{key:"getElementTopLeft",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._env||this.setEnv("browser"),this.envContribution.getElementTopLeft(t,e)}},{key:"isMacOS",value:function(){return this._env||this.setEnv("browser"),this.envContribution.isMacOS()}},{key:"copyToClipBoard",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.copyToClipBoard(t)}}])}();vl=hl([js(),pl(0,zs(nl)),pl(0,Ns(ul)),dl("design:paramtypes",[Object])],vl),function(t){t[t.estimate=0]="estimate",t[t.actualBounding=1]="actualBounding",t[t.fontBounding=2]="fontBounding"}(ol||(ol={}));var gl,yl,ml,_l,bl,xl,kl,Sl,Al,Ml,wl,Tl,Cl,El,Pl,Rl=oe-1e-8,Bl=function(){return o((function t(e){r(this,t),this.init(e)}),[{key:"init",value:function(t){this.bounds=t}},{key:"arc",value:function(t,e,i,n,r,a){if(Math.abs(r-n)>Rl)return this.bounds.add(t-i,e-i),void this.bounds.add(t+i,e+i);var o,s,l,u,c=1/0,h=-1/0,d=1/0,p=-1/0;function f(t){l=i*Math.cos(t),u=i*Math.sin(t),l<c&&(c=l),l>h&&(h=l),u<d&&(d=u),u>p&&(p=u)}if(f(n),f(r),r!==n)if((n%=oe)<0&&(n+=oe),(r%=oe)<0&&(r+=oe),r<n&&(a=!a,o=n,n=r,r=o),a)for(r-=oe,o=n-n%ae,s=0;s<4&&o>r;++s,o-=ae)f(o);else for(o=n-n%ae+ae,s=0;s<4&&o<r;++s,o+=ae)f(o);this.bounds.add(t+c,e+d),this.bounds.add(t+h,e+p)}},{key:"arcTo",value:function(t,e,i,n,r){this.bounds.add(t,e)}},{key:"bezierCurveTo",value:function(t,e,i,n,r,a){this.bounds.add(t,e),this.bounds.add(i,n),this.bounds.add(r,a)}},{key:"closePath",value:function(){}},{key:"ellipse",value:function(){throw new Error("不支持ellipse")}},{key:"lineTo",value:function(t,e){this.bounds.add(t,e)}},{key:"moveTo",value:function(t,e){this.bounds.add(t,e)}},{key:"quadraticCurveTo",value:function(t,e,i,n){this.bounds.add(t,e),this.bounds.add(i,n)}},{key:"rect",value:function(t,e,i,n){this.bounds.add(t,e),this.bounds.add(t+i,e+n)}},{key:"clear",value:function(){this.bounds.clear()}},{key:"release",value:function(){}}])}(),Il=function(){return o((function t(){r(this,t),this._curves=[],this.bounds=new pi}),[{key:"curves",get:function(){return this._curves}},{key:"getCurveLengths",value:function(){return this._curves.map((function(t){return t.getLength()}))}},{key:"getPointAt",value:function(t){return{x:0,y:0}}},{key:"getLength",value:function(){return 0}},{key:"getBounds",value:function(){return this.bounds}}])}(),Ll=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/gi,Dl={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,M:2,L:2,H:1,V:1,C:6,S:4,Q:4,T:2,A:7},Ol={A:0,AT:1,C:2,Z:3,E:4,L:5,M:6,Q:7,R:8};function Fl(t){var e=t[0],i=t[1],n=t[2],r=t[3],a=t[4],o=t[5],s=t[6],l=t[7],u=l*a,c=-s*o,h=s*a,d=l*o,p=Math.cos(n),f=Math.sin(n),v=Math.cos(r),g=Math.sin(r),y=.5*(r-n),m=Math.sin(.5*y),_=8/3*m*m/Math.sin(y),b=e+p-_*f,x=i+f+_*p,k=e+v,S=i+g,A=k+_*g,M=S-_*v;return[u*b+c*x,h*b+d*x,u*A+c*M,h*A+d*M,u*k+c*S,h*k+d*S]}function zl(t,e,i,n){for(var r=function(t,e,i,n,r,a,o,s,l){var u=we(o),c=Math.sin(u),h=Math.cos(u),d=h*(s-t)*.5+c*(l-e)*.5,p=h*(l-e)*.5-c*(s-t)*.5,f=d*d/((i=Math.abs(i))*i)+p*p/((n=Math.abs(n))*n);f>1&&(i*=f=Math.sqrt(f),n*=f);var v=h/i,g=c/i,y=-c/n,m=h/n,_=v*s+g*l,b=y*s+m*l,x=v*t+g*e,k=y*t+m*e,S=1/((x-_)*(x-_)+(k-b)*(k-b))-.25;S<0&&(S=0);var A=Math.sqrt(S);a===r&&(A=-A);var M=.5*(_+x)-A*(k-b),w=.5*(b+k)+A*(x-_),T=Math.atan2(b-w,_-M),C=Math.atan2(k-w,x-M)-T;C<0&&1===a?C+=oe:C>0&&0===a&&(C-=oe);for(var E=Math.ceil(Math.abs(C/(ae+.001))),P=[],R=0;R<E;++R){var B=T+R*C/E,I=T+(R+1)*C/E;P[R]=[M,w,B,I,i,n,c,h]}return P}(n[5],n[6],n[0],n[1],n[3],n[4],n[2],e,i),a=0;a<r.length;++a){var o=Fl(r[a]);t.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}!function(t){t[t.NONE=0]="NONE",t[t.UPDATE_BOUNDS=1]="UPDATE_BOUNDS",t[t.UPDATE_SHAPE=2]="UPDATE_SHAPE",t[t.CLEAR_SHAPE=253]="CLEAR_SHAPE",t[t.UPDATE_SHAPE_AND_BOUNDS=3]="UPDATE_SHAPE_AND_BOUNDS",t[t.INIT=179]="INIT",t[t.CLEAR_BOUNDS=254]="CLEAR_BOUNDS",t[t.UPDATE_GLOBAL_MATRIX=32]="UPDATE_GLOBAL_MATRIX",t[t.CLEAR_GLOBAL_MATRIX=223]="CLEAR_GLOBAL_MATRIX",t[t.UPDATE_LOCAL_MATRIX=16]="UPDATE_LOCAL_MATRIX",t[t.CLEAR_LOCAL_MATRIX=239]="CLEAR_LOCAL_MATRIX",t[t.UPDATE_GLOBAL_LOCAL_MATRIX=48]="UPDATE_GLOBAL_LOCAL_MATRIX",t[t.UPDATE_LAYOUT=128]="UPDATE_LAYOUT",t[t.CLEAR_LAYOUT=127]="CLEAR_LAYOUT"}(kl||(kl={})),function(t){t[t.GLOBAL=1]="GLOBAL",t[t.LOCAL=16]="LOCAL",t[t.GLOBAL_ACCURATE=3]="GLOBAL_ACCURATE",t[t.LOCAL_ACCURATE=48]="LOCAL_ACCURATE"}(Sl||(Sl={})),function(t){t[t.INIT=0]="INIT",t[t.DEFAULT=1]="DEFAULT",t[t.STATE=2]="STATE",t[t.ANIMATE_BIND=10]="ANIMATE_BIND",t[t.ANIMATE_PLAY=11]="ANIMATE_PLAY",t[t.ANIMATE_START=12]="ANIMATE_START",t[t.ANIMATE_UPDATE=13]="ANIMATE_UPDATE",t[t.ANIMATE_END=14]="ANIMATE_END",t[t.TRANSLATE=20]="TRANSLATE",t[t.TRANSLATE_TO=21]="TRANSLATE_TO",t[t.SCALE=22]="SCALE",t[t.SCALE_TO=23]="SCALE_TO",t[t.ROTATE=24]="ROTATE",t[t.ROTATE_TO=25]="ROTATE_TO"}(Al||(Al={})),function(t){t[t.INITIAL=0]="INITIAL",t[t.RUNNING=1]="RUNNING",t[t.PAUSED=2]="PAUSED",t[t.END=3]="END"}(Ml||(Ml={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.SET_ATTR_IMMEDIATELY=1]="SET_ATTR_IMMEDIATELY"}(wl||(wl={})),function(t){t.wait="wait",t.from="from",t.to="to",t.customAnimate="customAnimate"}(Tl||(Tl={})),function(t){t[t.ROW=1]="ROW",t[t.COLUMN=2]="COLUMN"}(Cl||(Cl={})),function(t){t[t.CubicBezierCurve=0]="CubicBezierCurve",t[t.QuadraticBezierCurve=1]="QuadraticBezierCurve",t[t.ArcCurve=2]="ArcCurve",t[t.LineCurve=3]="LineCurve",t[t.EllipseCurve=4]="EllipseCurve",t[t.MoveCurve=5]="MoveCurve"}(El||(El={})),function(t){t[t.beforeFillStroke=0]="beforeFillStroke",t[t.afterFillStroke=1]="afterFillStroke"}(Pl||(Pl={}));var Hl=function(t,e,i,n,r,a,o){for(var s=Math.abs(i-e),l=s>.5*Math.PI?Math.ceil(2*s/Math.PI):1,u=(i-e)/l,c=0;c<l;c++){var h=e+u*c,d=e+u*(c+1),p=4*Math.tan(Math.abs(u)/4)/3,f=d<h?-1:1,v=Math.cos(h),g=Math.sin(h),y=Math.cos(d),m=Math.sin(d),_=v*a+n,b=g*o+r,x=y*a+n,k=m*o+r,S=a*p*f,A=o*p*f;t.push(_-S*g,b+A*v,x+S*m,k-A*y,x,k)}},jl=[function(t,e,i,n,r,a,o){return e.arc(t[1]*r+i,t[2]*a+n,t[3]*(r+a)/2,t[4],t[5],t[6],o)},function(t,e,i,n,r,a,o){return e.arcTo(t[1]*r+i,t[2]*a+n,t[3]*r+i,t[4]*a+n,t[5]*(r+a)/2,o)},function(t,e,i,n,r,a,o){return e.bezierCurveTo(t[1]*r+i,t[2]*a+n,t[3]*r+i,t[4]*a+n,t[5]*r+i,t[6]*a+n,o)},function(t,e,i,n){return e.closePath()},function(t,e,i,n,r,a){return e.ellipse(t[1]*r+i,t[2]*a+n,t[3]*r,t[4]*a,t[5],t[6],t[7],t[8])},function(t,e,i,n,r,a,o){return e.lineTo(t[1]*r+i,t[2]*a+n,o)},function(t,e,i,n,r,a,o){return e.moveTo(t[1]*r+i,t[2]*a+n,o)},function(t,e,i,n,r,a,o){return e.quadraticCurveTo(t[1]*r+i,t[2]*a+n,t[3]*r+i,t[4]*a+n,o)},function(t,e,i,n,r,a,o){return e.rect(t[1]*r+i,t[2]*a+n,t[3]*r,t[4]*a,o)}];function Nl(t,e){for(var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6?arguments[6]:void 0,s=0;s<t.length;s++){var l=t[s];jl[l[0]](l,e,i,n,r,a,o)}}var Vl=function(){return o((function t(){r(this,t)}),[{key:"getLength",value:function(t){return null!=t?this.calcProjLength(t):(Number.isFinite(this.length)||(this.length=this.calcLength()),this.length)}}])}();function Wl(t,e){for(var i=0,n=t.length,r=0;r<n;r++){var a=t[r],o=e[r],s=t[(r+1)%n],l=e[(r+1)%n];i+=Me.distanceNN(a,o,s,l)}return i/2}function Gl(t,e,i,n,r){var a=1-r;return a*a*a*t+3*e*r*a*a+3*i*r*r*a+n*r*r*r}function Ul(t,e,i,n,r){var a=Gl(t.x,e.x,i.x,n.x,r),o=Gl(t.y,e.y,i.y,n.y,r);return new Ae(a,o)}function Yl(t,e,i,n){var r=1-n;return r*r*t+2*r*n*e+n*n*i}function Xl(t,e,i,n){var r=Yl(t.x,e.x,i.x,n),a=Yl(t.y,e.y,i.y,n);return new Ae(r,a)}var Kl=function(t){function e(t,i,a){var o;return r(this,e),(o=n(this,e)).type=El.QuadraticBezierCurve,o.p0=t,o.p1=i,o.p2=a,o}return h(e,t),o(e,[{key:"_validPoint",value:function(){return Number.isFinite(this.p0.x+this.p0.y+this.p1.x+this.p1.y+this.p2.x+this.p2.y)}},{key:"getPointAt",value:function(t){if(!1!==this.defined)return Xl(this.p0,this.p1,this.p2,t);throw new Error("defined为false的点不能getPointAt")}},{key:"calcLength",value:function(){return this._validPoint()?(t=this.p0,e=this.p1,i=this.p2,Wl([t.x,e.x,i.x],[t.y,e.y,i.y])):60;var t,e,i}},{key:"calcProjLength",value:function(t){return t===Cl.ROW?le(this.p0.x-this.p2.x):t===Cl.COLUMN?le(this.p0.y-this.p2.y):0}},{key:"getAngleAt",value:function(t){var e=he(t-.01,0),i=de(t+.01,1),n=this.getPointAt(e),r=this.getPointAt(i);return ue(r.y-n.y,r.x-n.x)}},{key:"draw",value:function(t,e,i,n,r,a){if(t.moveTo(this.p0.x*n+e,this.p0.y*r+i),a>=1)t.quadraticCurveTo(this.p1.x*n+e,this.p1.y*r+i,this.p2.x*n+e,this.p2.y*r+i);else if(a>0){var o=g(Zl(this,a),1)[0];t.quadraticCurveTo(o.p1.x*n+e,o.p1.y*r+i,o.p2.x*n+e,o.p2.y*r+i)}}},{key:"getYAt",value:function(t){throw new Error("QuadraticBezierCurve暂不支持getYAt")}},{key:"includeX",value:function(t){throw new Error("QuadraticBezierCurve暂不支持includeX")}}])}(Vl);function ql(t,e){var i=t.p0,n=t.p1,r=t.p2,a=t.p3,o=Ul(i,n,r,a,e),s=Me.pointAtPP(i,n,e),l=Me.pointAtPP(n,r,e),u=Me.pointAtPP(r,a,e),c=Me.pointAtPP(s,l,e),h=Me.pointAtPP(l,u,e);return[new Jl(i,s,c,o),new Jl(o,h,u,a)]}function Zl(t,e){var i=t.p0,n=t.p1,r=t.p2,a=Xl(i,n,r,e),o=Me.pointAtPP(i,n,e),s=Me.pointAtPP(n,r,e);return[new Kl(i,o,a),new Kl(a,s,r)]}var Jl=function(t){function e(t,i,a,o){var s;return r(this,e),(s=n(this,e)).type=El.CubicBezierCurve,s.p0=t,s.p1=i,s.p2=a,s.p3=o,s}return h(e,t),o(e,[{key:"_validPoint",value:function(){return Number.isFinite(this.p0.x+this.p0.y+this.p1.x+this.p1.y+this.p2.x+this.p2.y+this.p3.x+this.p3.y)}},{key:"getPointAt",value:function(t){if(!1!==this.defined)return Ul(this.p0,this.p1,this.p2,this.p3,t);throw new Error("defined为false的点不能getPointAt")}},{key:"calcLength",value:function(){return this._validPoint()?(t=this.p0,e=this.p1,i=this.p2,n=this.p3,Wl([t.x,e.x,i.x,n.x],[t.y,e.y,i.y,n.y])):60;var t,e,i,n}},{key:"calcProjLength",value:function(t){return t===Cl.ROW?le(this.p0.x-this.p3.x):t===Cl.COLUMN?le(this.p0.y-this.p3.y):0}},{key:"getAngleAt",value:function(t){var e=he(t-.01,0),i=de(t+.01,1),n=this.getPointAt(e),r=this.getPointAt(i);return ue(r.y-n.y,r.x-n.x)}},{key:"draw",value:function(t,e,i,n,r,a){if(t.moveTo(this.p0.x*n+e,this.p0.y*r+i),a>=1)t.bezierCurveTo(this.p1.x*n+e,this.p1.y*r+i,this.p2.x*n+e,this.p2.y*r+i,this.p3.x*n+e,this.p3.y*r+i);else if(a>0){var o=g(ql(this,a),1)[0];t.bezierCurveTo(o.p1.x*n+e,o.p1.y*r+i,o.p2.x*n+e,o.p2.y*r+i,o.p3.x*n+e,o.p3.y*r+i)}}},{key:"includeX",value:function(t){var e=de(this.p0.x,this.p1.x,this.p2.x,this.p3.x),i=he(this.p0.x,this.p1.x,this.p2.x,this.p3.x);return t>=e&&t<=i}},{key:"getYAt",value:function(t){var e=de(this.p0.x,this.p1.x,this.p2.x,this.p3.x),i=(t-e)/(he(this.p0.x,this.p1.x,this.p2.x,this.p3.x)-e);return this.getPointAt(i).y}}])}(Vl);function Ql(t,e){var i=t.p0,n=t.p1,r=Me.pointAtPP(i,n,e);return[new $l(i,r),new $l(r,n)]}var $l=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e)).type=El.LineCurve,a.p0=t,a.p1=i,a}return h(e,t),o(e,[{key:"getPointAt",value:function(t){if(!1!==this.defined)return Me.pointAtPP(this.p0,this.p1,t);throw new Error("defined为false的点不能getPointAt")}},{key:"getAngleAt",value:function(t){return null==this.angle&&(this.angle=ue(this.p1.y-this.p0.y,this.p1.x-this.p0.x)),this.angle}},{key:"_validPoint",value:function(){return Number.isFinite(this.p0.x+this.p0.y+this.p1.x+this.p1.y)}},{key:"calcLength",value:function(){return this._validPoint()?Me.distancePP(this.p0,this.p1):60}},{key:"calcProjLength",value:function(t){return t===Cl.ROW?le(this.p0.x-this.p1.x):t===Cl.COLUMN?le(this.p0.y-this.p1.y):0}},{key:"draw",value:function(t,e,i,n,r,a){if(t.moveTo(this.p0.x*n+e,this.p0.y*r+i),a>=1)t.lineTo(this.p1.x*n+e,this.p1.y*r+i);else if(a>0){var o=this.getPointAt(a);t.lineTo(o.x*n+e,o.y*r+i)}}},{key:"includeX",value:function(t){return t>=this.p0.x&&t<=this.p1.x||t>=this.p1.x&&t<=this.p0.x}},{key:"getYAt",value:function(t){if(this.includeX(t)){var e=this.p0,i=this.p1;this.p0.x>this.p1.x&&(e=this.p1,i=this.p0);var n=(t-e.x)/(i.x-e.x);return e.y+n*(i.y-e.y)}return 1/0}}])}(Vl),tu=function(){return o((function t(e,i){r(this,t),this.init(e,i)}),[{key:"endX",get:function(){return this._lastX}},{key:"endY",get:function(){return this._lastY}},{key:"init",value:function(t,e){this._lastX=this._lastY=this._startX=this._startY=0,this.curveType=t,this.direction=e,this.curves=[]}},{key:"bezierCurveTo",value:function(t,e,i,n,r,a,o,s){var l=new Jl(new Ae(this._lastX,this._lastY),new Ae(t,e),new Ae(i,n),new Ae(r,a));l.originP1=this._lastOriginP,l.originP2=s,l.defined=o,this.curves.push(l),this._lastX=r,this._lastY=a,this._lastOriginP=s}},{key:"closePath",value:function(){if(!(this.curves.length<2)){var t=this.curves[this.curves.length-1];this.lineTo(this._startX,this._startY,t.defined,this._startOriginP)}}},{key:"ellipse",value:function(){throw new Error("SegContext不支持调用ellipse")}},{key:"lineTo",value:function(t,e,i,n){var r=this.addLinearCurve(t,e,i,this._lastOriginP,n);this.curves.push(r),this._lastX=t,this._lastY=e,this._lastOriginP=n}},{key:"moveTo",value:function(t,e,i){return this._lastX=this._startX=t,this._lastY=this._startY=e,this._lastOriginP=i,this._startOriginP=i,this}},{key:"quadraticCurveTo",value:function(t,e,i,n){throw new Error("SegContext不支持调用quadraticCurveTo")}},{key:"clear",value:function(){this.curves=[],this.length=NaN}},{key:"tryUpdateLength",value:function(t){return this.getLength(t)}},{key:"addLinearCurve",value:function(t,e,i,n,r){var a=new $l(new Ae(this._lastX,this._lastY),new Ae(t,e));return a.originP1=n,a.originP2=r,a.defined=i,a}},{key:"getPointAt",value:function(t){throw new Error("暂未实现")}},{key:"getCurveLengths",value:function(){return[]}},{key:"getLength",value:function(t){var e,i;if(t===Cl.COLUMN){if(!this.curves.length)return 0;var n=this.curves[0],r=this.curves[this.curves.length-1],a=null!==(e=r.p3)&&void 0!==e?e:r.p1;return le(n.p0.y-a.y)}if(t===Cl.ROW){if(!this.curves.length)return 0;var o=this.curves[0],s=this.curves[this.curves.length-1],l=null!==(i=s.p3)&&void 0!==i?i:s.p1;return le(o.p0.x-l.x)}return Number.isFinite(this.length)||(this.length=this.curves.reduce((function(t,e){return t+e.getLength()}),0)),this.length}}])}(),eu=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"bezierCurveTo",value:function(t,i,n,r,a,o,s,l){return y(e,"bezierCurveTo",this,3)([i,t,r,n,o,a,s,l])}},{key:"lineTo",value:function(t,i,n,r){return y(e,"lineTo",this,3)([i,t,n,r])}},{key:"moveTo",value:function(t,i,n){return y(e,"moveTo",this,3)([i,t,n])}},{key:"clear",value:function(){return y(e,"clear",this,3)([])}}])}(tu);function iu(t,e){for(var i=!1,n=0,r=e.length;n<=r;n++)n>=r===i&&((i=!i)?t.lineStart():t.lineEnd()),i&&t.point(e[n])}function nu(t,e,i){var n=null!=e?e:le(i[i.length-1].x-i[0].x)>le(i[i.length-1].y-i[0].y)?Cl.ROW:Cl.COLUMN;return"monotoneY"===t?new eu(t,n):new tu(t,n)}var ru=function(){return o((function t(e,i){r(this,t),this.context=e,i&&(this.startPoint=i)}),[{key:"areaStart",value:function(){this._line=0}},{key:"areaEnd",value:function(){this._line=NaN}},{key:"lineStart",value:function(){this._point=0,this.startPoint&&this.point(this.startPoint)}},{key:"lineEnd",value:function(){(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line=1-this._line}},{key:"point",value:function(t){var e=t.x,i=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,i,!1!==this._lastDefined&&!1!==t.defined,t):this.context.moveTo(e,i,t);break;case 1:this._point=2;default:this.context.lineTo(e,i,!1!==this._lastDefined&&!1!==t.defined,t)}this._lastDefined=t.defined}},{key:"tryUpdateLength",value:function(){return this.context.tryUpdateLength()}}])}();function au(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.direction,n=e.startPoint;if(t.length<2-Number(!!n))return null;var r=nu("linear",i,t);return function(t,e){iu(t,e)}(new ru(r,n),t),r}function ou(t,e,i,n,r){t.context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+i)/6,n,t.lastPoint1)}var su=function(){return o((function t(e,i){r(this,t),this.context=e,this.startPoint=i}),[{key:"areaStart",value:function(){this._line=0}},{key:"areaEnd",value:function(){this._line=NaN}},{key:"lineStart",value:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0,this.startPoint&&this.point(this.startPoint)}},{key:"lineEnd",value:function(){2===this._point&&ou(this,6*this._x1-(this._x0+4*this._x1),6*this._y1-(this._y0+4*this._y1),!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1),(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line=1-this._line}},{key:"point",value:function(t){var e=t.x,i=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,i,!1!==this._lastDefined1&&!1!==this._lastDefined2,t):this.context.moveTo(e,i,t);break;case 1:this._point=2;break;default:ou(this,e,i,!1!==this._lastDefined1&&!1!==this._lastDefined2)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=i,this._lastDefined1=this._lastDefined2,this._lastDefined2=t.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}},{key:"tryUpdateLength",value:function(){return this.context.tryUpdateLength()}}])}();function lu(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.direction,n=e.startPoint;if(t.length<2-Number(!!n))return null;if(t.length<3-Number(!!n))return au(t,e);var r=nu("basis",i,t);return function(t,e){iu(t,e)}(new su(r,n),t),r}function uu(t){return t<0?-1:1}function cu(t,e,i){var n=t._x1-t._x0,r=e-t._x1,a=(t._y1-t._y0)/(n||Number(r<0&&-0)),o=(i-t._y1)/(r||Number(n<0&&-0)),s=(a*r+o*n)/(n+r);return(uu(a)+uu(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(s))||0}function hu(t,e){var i=t._x1-t._x0;return i?(3*(t._y1-t._y0)/i-e)/2:e}function du(t,e,i,n,r){var a=t._x0,o=t._y0,s=t._x1,l=t._y1,u=(s-a)/3;t.context.bezierCurveTo(a+u,o+u*e,s-u,l-u*i,s,l,n,t.lastPoint1)}var pu=function(){return o((function t(e,i){r(this,t),this.context=e,this.startPoint=i}),[{key:"areaStart",value:function(){this._line=0}},{key:"areaEnd",value:function(){this._line=NaN}},{key:"lineStart",value:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0,this.startPoint&&this.point(this.startPoint)}},{key:"lineEnd",value:function(){switch(this._point){case 2:this.context.lineTo(this._x1,this._y1,!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1);break;case 3:du(this,this._t0,hu(this,this._t0),!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1)}(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line=1-this._line}},{key:"point",value:function(t){var e=NaN,i=t.x,n=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(i,n,!1!==this._lastDefined1&&!1!==this._lastDefined2,t):this.context.moveTo(i,n,t);break;case 1:this._point=2;break;case 2:this._point=3,du(this,hu(this,e=cu(this,i,n)),e,!1!==this._lastDefined1&&!1!==this._lastDefined2);break;default:du(this,this._t0,e=cu(this,i,n),!1!==this._lastDefined1&&!1!==this._lastDefined2)}this._x0=this._x1,this._x1=i,this._y0=this._y1,this._y1=n,this._t0=e,this._lastDefined1=this._lastDefined2,this._lastDefined2=!1!==t.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}},{key:"tryUpdateLength",value:function(){return this.context.tryUpdateLength()}}])}(),fu=function(t){function e(t,i){return r(this,e),n(this,e,[t,i])}return h(e,t),o(e,[{key:"point",value:function(t){return y(e,"point",this,3)([{y:t.x,x:t.y,defined:t.defined}])}}])}(pu);function vu(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.direction,n=e.startPoint;if(t.length<2-Number(!!n))return null;if(t.length<3-Number(!!n))return au(t,e);var r=nu("monotoneX",i,t);return function(t,e){iu(t,e)}(new pu(r,n),t),r}function gu(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.direction,n=e.startPoint;if(t.length<2-Number(!!n))return null;if(t.length<3-Number(!!n))return au(t,e);var r=nu("monotoneY",i,t);return function(t,e){iu(t,e)}(new fu(r,n),t),r}var yu=function(){return o((function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,n=arguments.length>2?arguments[2]:void 0;r(this,t),this.context=e,this._t=i,this.startPoint=n}),[{key:"areaStart",value:function(){this._line=0}},{key:"areaEnd",value:function(){this._line=NaN}},{key:"lineStart",value:function(){this._x=this._y=NaN,this._point=0,this.startPoint&&this.point(this.startPoint)}},{key:"lineEnd",value:function(){0<this._t&&this._t<1&&2===this._point&&this.context.lineTo(this._x,this._y,!1!==this._lastDefined,this.lastPoint),(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)}},{key:"point",value:function(t){var e=t.x,i=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,i,!1!==this._lastDefined&&!1!==t.defined,t):this.context.moveTo(e,i,t);break;case 1:this._point=2;default:if(this._t<=0)this.context.lineTo(this._x,i,!1!==this._lastDefined&&!1!==t.defined,this.lastPoint),this.context.lineTo(e,i,!1!==this._lastDefined&&!1!==t.defined,t);else{var n=this._x*(1-this._t)+e*this._t;.5===this._t?this.context.lineTo(n,this._y,!1!==this._lastDefined,this.lastPoint):this.context.lineTo(n,this._y,!1!==this._lastDefined&&!1!==t.defined,this.lastPoint),this.context.lineTo(n,i,!1!==this._lastDefined&&!1!==t.defined,t)}}this._lastDefined=t.defined,this._x=e,this._y=i,this.lastPoint=t}},{key:"tryUpdateLength",value:function(){return this.context.tryUpdateLength()}}])}(),mu=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"lineEnd",value:function(){this.context.closePath()}}])}(yu);function _u(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=i.direction,r=i.startPoint;if(t.length<2-Number(!!r))return null;var a=new tu("step",null!=n?n:le(t[t.length-1].x-t[0].x)>le(t[t.length-1].y-t[0].y)?Cl.ROW:Cl.COLUMN);return bu(new yu(a,e,r),t),a}function bu(t,e){return iu(t,e)}var xu=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"lineEnd",value:function(){this.context.closePath()}}])}(ru);function ku(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.direction,n=e.startPoint;if(t.length<2-Number(!!n))return null;var r=nu("linear",i,t);return function(t,e){iu(t,e)}(new xu(r,n),t),r}function Su(t,e,i,n,r){var a=t._x1,o=t._y1,s=t._x2,l=t._y2;if(t._l01_a>ne){var u=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,c=3*t._l01_a*(t._l01_a+t._l12_a);a=(a*u-t._x0*t._l12_2a+t._x2*t._l01_2a)/c,o=(o*u-t._y0*t._l12_2a+t._y2*t._l01_2a)/c}if(t._l23_a>ne){var h=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,d=3*t._l23_a*(t._l23_a+t._l12_a);s=(s*h+t._x1*t._l23_2a-e*t._l12_2a)/d,l=(l*h+t._y1*t._l23_2a-i*t._l12_2a)/d}t.context.bezierCurveTo(a,o,s,l,t._x2,t._y2,n,t.lastPoint1)}var Au=function(){return o((function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,n=arguments.length>2?arguments[2]:void 0;r(this,t),this.context=e,this.startPoint=n,this._alpha=i}),[{key:"areaStart",value:function(){this._line=0}},{key:"areaEnd",value:function(){this._line=NaN}},{key:"lineStart",value:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0}},{key:"lineEnd",value:function(){switch(this._point){case 2:this.context.lineTo(this._x2,this._y2,!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1);break;case 3:this.point({x:this._x2,y:this._y2})}(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line=1-this._line}},{key:"point",value:function(t){var e=t.x,i=t.y;if(this._point){var n=this._x2-e,r=this._y2-i;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,i,!1!==this._lastDefined1&&!1!==this._lastDefined2):this.context.moveTo(e,i);break;case 1:this._point=2;break;case 2:this._point=3;default:Su(this,e,i,!1!==this._lastDefined1&&!1!==this._lastDefined2)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=i,this._lastDefined1=this._lastDefined2,this._lastDefined2=t.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}},{key:"tryUpdateLength",value:function(){return this.context.tryUpdateLength()}}])}();function Mu(t,e){return function(i,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=r.direction,o=r.startPoint;if(i.length<2-Number(!!o))return null;if(i.length<3-Number(!!o))return au(i,r);var s=nu(t,a,i);return iu(new e(s,n,o),i),s}}var wu=Mu("catmullRom",Au),Tu=function(){return o((function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,n=arguments.length>2?arguments[2]:void 0;r(this,t),this.context=e,this.startPoint=n,this._alpha=i}),[{key:"areaStart",value:function(){this._line=0}},{key:"areaEnd",value:function(){this._line=NaN}},{key:"lineStart",value:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0}},{key:"lineEnd",value:function(){switch(this._point){case 1:this.context.moveTo(this._x3,this._y3,this.lastPoint1),this.context.closePath();break;case 2:this.context.lineTo(this._x3,this._y3,!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1),this.context.closePath();break;case 3:this.point({x:this._x3,y:this._y3}),this.point({x:this._x4,y:this._y4}),this.point({x:this._x5,y:this._y5})}}},{key:"point",value:function(t){var e=t.x,i=t.y;if(this._point){var n=this._x2-e,r=this._y2-i;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=i;break;case 1:this._point=2,this.context.moveTo(this._x4=e,this._y4=i,t);break;case 2:this._point=3,this._x5=e,this._y5=i;break;default:Su(this,e,i,!1!==this._lastDefined1&&!1!==this._lastDefined2)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=i,this._lastDefined1=this._lastDefined2,this._lastDefined2=t.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}},{key:"tryUpdateLength",value:function(){return this.context.tryUpdateLength()}}])}(),Cu=Mu("catmullRomClosed",Tu),Eu=function(){return o((function t(e){r(this,t),this.path=e,this._lastX=this._lastY=this._startX=this._startY=0}),[{key:"moveTo",value:function(t,e){return this._lastX=this._startX=t,this._lastY=this._startY=e,this}},{key:"lineTo",value:function(t,e){var i=this.addLinearCurve(t,e);this.path.addCurve(i),this._lastX=t,this._lastY=e}},{key:"addLinearCurve",value:function(t,e){return new $l(new Ae(this._lastX,this._lastY),new Ae(t,e))}},{key:"quadraticCurveTo",value:function(t,e,i,n){var r=new Kl(new Ae(this._lastX,this._lastY),new Ae(t,e),new Ae(i,n));this.path.addCurve(r),this._lastX=i,this._lastY=n}},{key:"bezierCurveTo",value:function(t,e,i,n,r,a){var o=new Jl(new Ae(this._lastX,this._lastY),new Ae(t,e),new Ae(i,n),new Ae(r,a));this.path.addCurve(o),this._lastX=r,this._lastY=a}},{key:"arcTo",value:function(t,e,i,n,r){throw new Error("CurveContext不支持调用arcTo")}},{key:"ellipse",value:function(t,e,i,n,r,a,o,s){throw new Error("CurveContext不支持调用ellipse")}},{key:"rect",value:function(t,e,i,n){throw new Error("CurveContext不支持调用rect")}},{key:"arc",value:function(t,e,i,n,r,a){throw new Error("CurveContext不支持调用arc")}},{key:"closePath",value:function(){this.path.curves.length<2||this.lineTo(this._startX,this._startY)}}])}();function Pu(t,e,i){var n,r;switch(e){case"linear":default:return au(t,i);case"basis":return lu(t,i);case"monotoneX":return vu(t,i);case"monotoneY":return gu(t,i);case"step":return _u(t,.5,i);case"stepClosed":return function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=i.direction,r=i.startPoint;if(t.length<2-Number(!!r))return null;var a=new tu("step",null!=n?n:le(t[t.length-1].x-t[0].x)>le(t[t.length-1].y-t[0].y)?Cl.ROW:Cl.COLUMN);return bu(new mu(a,e,r),t),a}(t,.5,i);case"stepBefore":return _u(t,0,i);case"stepAfter":return _u(t,1,i);case"catmullRom":return wu(t,null!==(n=null==i?void 0:i.curveTension)&&void 0!==n?n:.5,i);case"catmullRomClosed":return Cu(t,null!==(r=null==i?void 0:i.curveTension)&&void 0!==r?r:.5,i);case"linearClosed":return ku(t,i)}}var Ru=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).commandList=[],t&&(i._ctx=t),i._boundsContext=new Bl(i.bounds),i}return h(e,t),o(e,[{key:"curves",get:function(){return this.tryBuildCurves()}},{key:"setCtx",value:function(t){this._ctx=t}},{key:"moveTo",value:function(t,e){return this.commandList.push([Ol.M,t,e]),this._ctx&&this._ctx.moveTo(t,e),this}},{key:"lineTo",value:function(t,e){return this.commandList.push([Ol.L,t,e]),this._ctx&&this._ctx.lineTo(t,e),this}},{key:"quadraticCurveTo",value:function(t,e,i,n){return this.commandList.push([Ol.Q,t,e,i,n]),this._ctx&&this._ctx.quadraticCurveTo(t,e,i,n),this}},{key:"bezierCurveTo",value:function(t,e,i,n,r,a){return this.commandList.push([Ol.C,t,e,i,n,r,a]),this._ctx&&this._ctx.bezierCurveTo(t,e,i,n,r,a),this}},{key:"arcTo",value:function(t,e,i,n,r){return this.commandList.push([Ol.AT,t,e,i,n,r]),this._ctx&&this._ctx.arcTo(t,e,i,n,r),this}},{key:"ellipse",value:function(t,e,i,n,r,a,o,s){return this.commandList.push([Ol.E,t,e,i,n,r,a,o,s]),this._ctx&&this._ctx.ellipse(t,e,i,n,r,a,o,s),this}},{key:"rect",value:function(t,e,i,n){return this.commandList.push([Ol.R,t,e,i,n]),this._ctx&&this._ctx.rect(t,e,i,n),this}},{key:"arc",value:function(t,e,i,n,r,a){return this.commandList.push([Ol.A,t,e,i,n,r,a]),this._ctx&&this._ctx.arc(t,e,i,n,r,a),this}},{key:"closePath",value:function(){return this.commandList.push([Ol.Z]),this._ctx&&this._ctx.closePath(),this}},{key:"addCurve",value:function(t){this._curves.push(t)}},{key:"clear",value:function(){this.transformCbList=null,this.commandList.length=0,this._curves.length=0}},{key:"beginPath",value:function(){this.clear()}},{key:"tryBuildCurves",value:function(){if(!this._curves||!this._curves.length){var t=new Eu(this);Nl(this.commandList,t,0,0,1,1)}return this._curves}},{key:"toString",value:function(){if(!this.toStringCbList){var t=[];t[Ol.M]=function(t){return"M".concat(t[1]," ").concat(t[2])},t[Ol.L]=function(t){return"L".concat(t[1]," ").concat(t[2])},t[Ol.Q]=function(t){return"Q".concat(t[1]," ").concat(t[2]," ").concat(t[3]," ").concat(t[4])},t[Ol.C]=function(t){return"C".concat(t[1]," ").concat(t[2]," ").concat(t[3]," ").concat(t[4]," ").concat(t[5]," ").concat(t[6])},t[Ol.A]=function(t){var e=[];Hl(e,t[4],t[5],t[1],t[2],t[3],t[3]);for(var i="",n=0;n<e.length;n+=6)i+="C".concat(e[n]," ").concat(e[n+1]," ").concat(e[n+2]," ").concat(e[n+3]," ").concat(e[n+4]," ").concat(e[n+5]);return i},t[Ol.R]=function(t){return"M".concat(t[1]," ").concat(t[2]," h").concat(t[3]," v").concat(t[4]," H").concat(t[1],"Z")},t[Ol.Z]=function(t){return"Z"},this.toStringCbList=t}var e=this.toStringCbList,i="";return this.commandList.forEach((function(t){i+=e[t[0]](t)})),i}},{key:"fromString",value:function(t,e,i,n,r){this.clear();var a=function(t){if(!t)return[];var e,i,n=t.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);if(null===n)return[];for(var r=[],a=0,o=n.length;a<o;a++)if(gl=n[a],yl=gl.slice(1),e=[ml=gl[0]],null!==(i=yl.match(Ll))){for(var s=0,l=i.length;s<l;s++)_l=i[s],bl=parseFloat(_l),Number.isNaN(bl)||e.push(bl);if(xl=Dl[ml],e.length-1>xl)for(var u=void 0,c=ml,h=1,d=e.length;h<d;h+=xl){u=[c];for(var p=h,f=h+xl;p<f;p++)u.push(e[p]);r.push(u),"m"===c?c="l":"M"===c&&(c="L")}else r.push(e)}else r.push(e);return r}(t);return this._runCommandStrList(a,e,i,n,r),this._updateBounds(),this}},{key:"fromLine",value:function(t){var e=t.attribute,i=e.points,n=e.curveType,r=e.clipRangeByDimension;if(i){var a=Pu(i,n);"x"===r?this.direction=Cl.ROW:"y"===r?this.direction=Cl.COLUMN:"auto"===r&&(this.direction=a.direction),this._curves=a.curves}}},{key:"fromCustomPath2D",value:function(t,e,i,n,r){return this.clear(),this._runCommandList(t.commandList,e,i,n,r),this._updateBounds(),this}},{key:"transform",value:function(t,e,i,n){var r=this,a=this.commandList;if(!this.transformCbList){var o=[];o[Ol.M]=this.moveToTransform,o[Ol.L]=this.lineToTransform,o[Ol.Q]=this.quadraticCurveToTransform,o[Ol.C]=this.bezierCurveToTransform,o[Ol.AT]=this.arcToTransform,o[Ol.E]=this.ellipseTransform,o[Ol.R]=this.rectTransform,o[Ol.A]=this.arcTransform,o[Ol.Z]=this.closePathTransform,this.transformCbList=o}a.forEach((function(a){r.transformCbList[a[0]](a,t,e,i,n)})),this._updateBounds()}},{key:"moveToTransform",value:function(t,e,i,n,r){t[1]=t[1]*n+e,t[2]=t[2]*r+i}},{key:"lineToTransform",value:function(t,e,i,n,r){t[1]=t[1]*n+e,t[2]=t[2]*r+i}},{key:"quadraticCurveToTransform",value:function(t,e,i,n,r){t[1]=t[1]*n+e,t[2]=t[2]*r+i,t[3]=t[3]*n+e,t[4]=t[4]*r+i}},{key:"bezierCurveToTransform",value:function(t,e,i,n,r){t[1]=t[1]*n+e,t[2]=t[2]*r+i,t[3]=t[3]*n+e,t[4]=t[4]*r+i,t[5]=t[5]*n+e,t[6]=t[6]*r+i}},{key:"arcToTransform",value:function(t,e,i,n,r){t[1]=t[1]*n+e,t[2]=t[2]*r+i,t[3]=t[3]*n+e,t[4]=t[4]*r+i,t[5]=t[5]*(n+r)/2}},{key:"ellipseTransform",value:function(t,e,i,n,r){t[1]=t[1]*n+e,t[2]=t[2]*r+i,t[3]=t[3]*n,t[4]=t[4]*r}},{key:"rectTransform",value:function(t,e,i,n,r){t[1]=t[1]*n+e,t[2]=t[2]*r+i,t[3]=t[3]*n,t[4]=t[4]*r}},{key:"arcTransform",value:function(t,e,i,n,r){t[1]=t[1]*n+e,t[2]=t[2]*r+i,t[3]=t[3]*(n+r)/2}},{key:"closePathTransform",value:function(){}},{key:"_runCommandStrList",value:function(t){for(var e,i,n,r,a,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,c=null,h=0,d=0,p=0,f=0,v=0,g=t.length;v<g;++v){switch(e=t[v],1===l&&1===u||(e=Iu(e,l,u)),e[0]){case"l":h+=e[1],d+=e[2],this.lineTo(h+o,d+s);break;case"L":h=e[1],d=e[2],this.lineTo(h+o,d+s);break;case"h":h+=e[1],this.lineTo(h+o,d+s);break;case"H":h=e[1],this.lineTo(h+o,d+s);break;case"v":d+=e[1],this.lineTo(h+o,d+s);break;case"V":d=e[1],this.lineTo(h+o,d+s);break;case"m":h+=e[1],d+=e[2],this.moveTo(h+o,d+s);break;case"M":h=e[1],d=e[2],this.moveTo(h+o,d+s);break;case"c":i=h+e[5],n=d+e[6],p=h+e[3],f=d+e[4],this.bezierCurveTo(h+e[1]+o,d+e[2]+s,p+o,f+s,i+o,n+s),h=i,d=n;break;case"C":h=e[5],d=e[6],p=e[3],f=e[4],this.bezierCurveTo(e[1]+o,e[2]+s,p+o,f+s,h+o,d+s);break;case"s":i=h+e[3],n=d+e[4],null===c[0].match(/[CcSs]/)?(p=h,f=d):(p=2*h-p,f=2*d-f),r=h+e[1],a=d+e[2],this.bezierCurveTo(p+o,f+s,r+o,a+s,i+o,n+s),p=r,f=a,h=i,d=n;break;case"S":i=e[3],n=e[4],null===c[0].match(/[CcSs]/)?(p=h,f=d):(p=2*h-p,f=2*d-f),r=e[1],a=e[2],this.bezierCurveTo(p+o,f+s,r+o,a+s,i+o,n+s),p=r,f=a,h=i,d=n;break;case"q":i=h+e[3],n=d+e[4],p=h+e[1],f=d+e[2],this.quadraticCurveTo(p+o,f+s,i+o,n+s),h=i,d=n;break;case"Q":i=e[3],n=e[4],this.quadraticCurveTo(e[1]+o,e[2]+s,i+o,n+s),h=i,d=n,p=e[1],f=e[2];break;case"t":i=h+e[1],n=d+e[2],null===c[0].match(/[QqTt]/)?(p=h,f=d):"t"===c[0]?(p=2*h-r,f=2*d-a):"q"===c[0]&&(p=2*h-p,f=2*d-f),r=p,a=f,this.quadraticCurveTo(p+o,f+s,i+o,n+s),d=n,p=(h=i)+e[1],f=d+e[2];break;case"T":i=e[1],n=e[2],p=2*h-p,f=2*d-f,this.quadraticCurveTo(p+o,f+s,i+o,n+s),h=i,d=n;break;case"a":zl(this,h+o,d+s,[e[1],e[2],e[3],e[4],e[5],e[6]+h+o,e[7]+d+s]),h+=e[6],d+=e[7];break;case"A":zl(this,h+o,d+s,[e[1],e[2],e[3],e[4],e[5],e[6]+o,e[7]+s]),h=e[6],d=e[7];break;case"z":case"Z":this.closePath()}c=e}}},{key:"_runCommandList",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;if(0!==e||0!==i||1!==n||1!==r)for(var a=0,o=t.length;a<o;++a){var s=t[a].slice();switch(s[0]){case Ol.L:this.lineToTransform(s,e,i,n,r);break;case Ol.M:this.moveToTransform(s,e,i,n,r);break;case Ol.C:this.bezierCurveToTransform(s,e,i,n,r);break;case Ol.Q:this.quadraticCurveToTransform(s,e,i,n,r);break;case Ol.A:this.arcToTransform(s,e,i,n,r);break;case Ol.E:this.ellipseTransform(s,e,i,n,r);break;case Ol.R:this.rectTransform(s,e,i,n,r);break;case Ol.AT:this.arcToTransform(s,e,i,n,r);break;case Ol.Z:this.closePath()}}else this.commandList=t.map((function(t){return t.slice()}))}},{key:"_updateBounds",value:function(){this.bounds.clear(),Nl(this.commandList,this._boundsContext)}},{key:"release",value:function(){this.commandList=[],this._boundsContext=null,this._ctx=null}},{key:"getLength",value:function(){if(this.direction===Cl.COLUMN){if(!this._curves.length)return 0;var t=this._curves[0],e=this._curves[this._curves.length-1];return le(t.p0.y-e.p1.y)}if(this.direction===Cl.ROW){if(!this._curves.length)return 0;var i=this._curves[0],n=this._curves[this._curves.length-1];return le(i.p0.x-n.p1.x)}return this._curves.reduce((function(t,e){return t+e.getLength()}),0)}},{key:"getYAt",value:function(t){if(!this.curves)return 1/0;for(var e=0;e<this.curves.length;e++){var i=this.curves[e];if(i.includeX(t))return i.getYAt(t)}return 1/0}},{key:"getAttrAt",value:function(t){if(!this._curves)return{pos:{x:0,y:0},angle:0};for(var e,i=0,n=0;n<this._curves.length;n++){var r=(e=this._curves[n]).getLength(this.direction);if(i+r>=t)break;i+=r}var a=(t-i)/e.getLength(this.direction);return{pos:e.getPointAt(a),angle:e.getAngleAt(a)}}},{key:"drawWithClipRange",value:function(t,e,i,n,r){this.tryBuildCurves();for(var a=this.getLength()*r,o=0,s=0;s<this._curves.length;s++){var l=this._curves[s],u=l.getLength(this.direction);if(!(o+u<=a)){var c=1-(o+u-a)/u;l.draw(t,i,n,e,e,c);break}l.draw(t,i,n,e,e,1),o+=u}}}])}(Il),Bu=["l",0,0,0,0,0,0,0];function Iu(t,e,i){var n=Bu[0]=t[0];if("a"===n||"A"===n)Bu[1]=e*t[1],Bu[2]=i*t[2],Bu[3]=t[3],Bu[4]=t[4],Bu[5]=t[5],Bu[6]=e*t[6],Bu[7]=i*t[7];else if("h"===n||"H"===n)Bu[1]=e*t[1];else if("v"===n||"V"===n)Bu[1]=i*t[1];else for(var r=1,a=t.length;r<a;++r)Bu[r]=(r%2==1?e:i)*t[r];return Bu}var Lu={x:0,y:0,z:0,dx:0,dy:0,dz:0,scrollX:0,scrollY:0,scaleX:1,scaleY:1,scaleZ:1,angle:0,alpha:0,beta:0,scaleCenter:[0,0],anchor:[0,0],anchor3d:[0,0],postMatrix:new vi},Du={fillOpacity:1,fill:!1,shadowBlur:0,shadowColor:"black",shadowOffsetX:0,shadowOffsetY:0},Ou={strokeOpacity:1,lineDash:[],lineDashOffset:0,lineWidth:1,lineCap:"butt",lineJoin:"miter",miterLimit:10,strokeBoundsBuffer:2,stroke:!1},Fu=Object.assign({outerBorder:Object.assign(Object.assign({},Ou),{distance:0}),innerBorder:Object.assign(Object.assign({},Ou),{distance:0})},Ou),zu={text:"",maxLineWidth:1/0,maxWidth:1/0,textAlign:"left",textBaseline:"alphabetic",fontSize:16,fontFamily:"PingFang SC,Microsoft Yahei,system-ui,-apple-system,segoe ui,\n    Roboto,Helvetica,Arial,sans-serif, apple color emoji,segoe ui emoji,segoe ui symbol",fontWeight:"",ellipsis:"…",fontVariant:"",fontStyle:"",lineHeight:void 0,underline:0,lineThrough:0,scaleIn3d:!1,direction:"horizontal",wordBreak:"break-all",ignoreBuf:!1,verticalMode:0,wrap:!1,whiteSpace:"no-wrap",heightLimit:1/0,lineClamp:1/0,suffixPosition:"end",underlineDash:[],underlineOffset:0,disableAutoClipedPoptip:void 0,measureMode:ol.fontBounding,keepCenterInLine:!1},Hu=Object.assign(Object.assign(Object.assign(Object.assign({forceBoundsWidth:void 0,forceBoundsHeight:void 0,opacity:1,background:null,autoAnimateTexture:!1,textureRatio:1,textureOptions:null,backgroundOpacity:1,backgroundCornerRadius:0,texture:null,textureColor:"black",textureSize:10,texturePadding:2,backgroundMode:"no-repeat",backgroundFit:!0,backgroundKeepAspectRatio:!1,backgroundClip:!0,backgroundScale:1,backgroundOffsetX:0,backgroundOffsetY:0,blur:0,filter:"",cursor:null,html:null,react:null,vue:null},Du),Fu),{alignSelf:"auto"}),{pickStrokeBuffer:0}),ju={connectedType:"none",connectedStyle:{},connectedX:NaN,connectedY:NaN},Nu=Object.assign(Object.assign(Object.assign({strokeSeg:null,renderable:!0,pickable:!0,shadowGraphic:void 0,childrenPickable:!0,fillPickable:!0,strokePickable:!0,visible:!0,zIndex:0,layout:null,boundsPadding:0,fillStrokeOrder:0,renderStyle:"default",pickMode:"accurate",customPickShape:null,boundsMode:"accurate",keepDirIn3d:!0,shadowRootIdx:1,globalZIndex:1,globalCompositeOperation:"",overflow:"hidden",shadowPickMode:"graphic",keepStrokeScale:!1,clipConfig:null},{_debug_bounds:!1}),Hu),Lu),Vu=Object.assign(Object.assign({},Nu),{startAngle:0,endAngle:se,innerRadius:0,outerRadius:1,innerPadding:0,outerPadding:0,cornerRadius:0,padRadius:0,padAngle:0,cap:!1,forceShowCap:!1}),Wu=Object.assign(Object.assign(Object.assign({},Nu),ju),{points:[],segments:[],curveType:"linear",clipRange:1,closePath:!1,curveTension:1}),Gu=Object.assign(Object.assign({},Nu),{radius:1,startAngle:0,endAngle:se}),Uu=Object.assign(Object.assign({},Nu),{width:0,height:0,cornerRadius:0,path:[],clip:!1,visibleAll:!0,display:"relative",flexDirection:"row",flexWrap:"wrap",justifyContent:"flex-start",alignItems:"flex-start",alignContent:"flex-start",baseOpacity:1,cornerType:"round"}),Yu=Object.assign(Object.assign({},Nu),{path:"",width:0,height:0,cornerRadius:0,clip:!1}),Xu=Object.assign(Object.assign(Object.assign({},Nu),ju),{points:[],segments:[],curveType:"linear",clipRange:1,clipRangeByDimension:"default",closePath:!1,curveTension:1}),Ku=Object.assign(Object.assign({},Nu),{path:new Ru,fillStrokeOrder:1,clipRange:1,customPath:function(){Lt.getInstance().warn("空函数")}}),qu=Object.assign(Object.assign({},Nu),{points:[],cornerRadius:0,closePath:!0}),Zu=Object.assign(Object.assign({},Nu),{width:100,height:100,spikes:5,thickness:.5}),Ju=Object.assign(Object.assign({},Nu),{width:0,height:0,x1:0,y1:0,strokeBoundsBuffer:0,cornerRadius:0,cornerType:"round"});Object.assign(Object.assign({},Nu),{width:0,height:0,x1:0,y1:0,cornerRadius:0,length:0,cornerType:"round"});var Qu=Object.assign(Object.assign({},Nu),{symbolType:"circle",size:10,keepDirIn3d:!0,clipRange:1}),$u=Object.assign(Object.assign(Object.assign({},Nu),zu),{strokeBoundsBuffer:0,keepDirIn3d:!0}),tc=Object.assign(Object.assign(Object.assign({},Nu),zu),{upgradeAttrs:null,editable:!1,editOptions:null,ascentDescentMode:"actual",width:300,height:300,ellipsis:!0,wordBreak:"break-word",verticalDirection:"top",textAlign:"left",textBaseline:"top",layoutDirection:"horizontal",textConfig:[],disableAutoWrapLine:!1,maxHeight:void 0,maxWidth:void 0,singleLine:!1}),ec=Object.assign(Object.assign({repeatX:"no-repeat",repeatY:"no-repeat",image:"",width:0,height:0,maxWidth:500,maxHeight:500},Nu),{fill:!0,cornerRadius:0,cornerType:"round"}),ic=Object.assign(Object.assign({},ec),{backgroundShowMode:"never",backgroundWidth:0,backgroundHeight:0,textAlign:"left",textBaseline:"middle",direction:"horizontal",margin:0,id:"",width:20,height:20,backgroundFill:"rgba(101, 117, 168, 0.1)",backgroundFillOpacity:1,backgroundStroke:!1,backgroundStrokeOpacity:1,backgroundRadius:4,opacity:1}),nc=new(o((function t(){r(this,t)}))),rc=function(){var t={linearGradient:/^(linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,fromAngleValue:/^from\s*(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/(^\#[0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^(rgb\(\d{1,3},\s*\d{1,3},\s*\d{1,3}\))/i,rgbaColor:/^(rgba\(\d{1,3},\s*\d{1,3},\s*\d{1,3},\s*((\d\.\d+)|\d{1,3})\))/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},e="";function i(t){var i=new Error(e+": "+t);throw i.source=e,i}function n(){return r("linear",t.linearGradient,a)||r("radial",t.radialGradient,s)||r("conic",t.conicGradient,o)}function r(e,n,r){return function(n,a){var o,s=y(n);if(s){y(t.startCall)||i("Missing (");var l=((o=r())&&(y(t.comma)||i("Missing comma before color stops")),{type:e,orientation:o,colorStops:d(p)});return y(t.endCall)||i("Missing )"),l}}(n)}function a(){return g("directional",t.sideOrCorner,1)||g("angular",t.angleValue,1)}function o(){return g("angular",t.fromAngleValue,1)}function s(){var i,n,r=l();return r&&((i=[]).push(r),n=e,y(t.comma)&&((r=l())?i.push(r):e=n)),i}function l(){var t,e=function(){var t=g("shape",/^(circle)/i,0);return t&&(t.style=v()||u()),t}()||((t=g("shape",/^(ellipse)/i,0))&&(t.style=f()||u()),t);if(e)e.at=c();else{var i=u();if(i){e=i;var n=c();n&&(e.at=n)}else{var r=h();r&&(e={type:"default-radial",at:r})}}return e}function u(){return g("extent-keyword",t.extentKeywords,1)}function c(){if(g("position",/^at/,0)){var t=h();return t||i("Missing positioning value"),t}}function h(){var t={x:f(),y:f()};if(t.x||t.y)return{type:"position",value:t}}function d(e){var n=e(),r=[];if(n)for(r.push(n);y(t.comma);)(n=e())?r.push(n):i("One extra comma");return r}function p(){var e=g("hex",t.hexColor,1)||g("rgba",t.rgbaColor,1)||g("rgb",t.rgbColor,1)||g("literal",t.literalColor,0);return e||i("Expected color definition"),e.length=f(),e}function f(){return g("%",t.percentageValue,1)||g("position-keyword",t.positionKeywords,1)||v()}function v(){return g("px",t.pixelValue,1)||g("em",t.emValue,1)}function g(t,e,i){var n=y(e);if(n)return{type:t,value:n[i]}}function y(t){var i=/^[\n\r\t\s]+/.exec(e);i&&m(i[0].length);var n=t.exec(e);return n&&m(n[0].length),n}function m(t){e=e.substr(t)}return function(t){return e=t.toString(),r=d(n),e.length>0&&i("Invalid input not EOF"),r;var r}}(),ac=function(){function t(){r(this,t)}return o(t,null,[{key:"IsGradient",value:function(t){return!("string"==typeof t&&!t.includes("gradient"))}},{key:"IsGradientStr",value:function(t){return"string"==typeof t&&t.includes("gradient")}},{key:"Parse",value:function(e){if(t.IsGradientStr(e))try{var i=rc(e)[0];if(i){if("linear"===i.type)return t.ParseLinear(i);if("radial"===i.type)return t.ParseRadial(i);if("conic"===i.type)return t.ParseConic(i)}}catch(t){return e}return e}},{key:"ParseConic",value:function(t){var e=t.orientation,i=t.colorStops,n=void 0===i?[]:i,r=re/2,a=parseFloat(e.value)/180*re-r;return{gradient:"conical",x:.5,y:.5,startAngle:a,endAngle:a+se,stops:n.map((function(t){return{color:t.value,offset:parseFloat(t.length.value)/100}}))}}},{key:"ParseRadial",value:function(t){var e=t.colorStops;return{gradient:"radial",x0:.5,y0:.5,x1:.5,y1:.5,r0:0,r1:1,stops:(void 0===e?[]:e).map((function(t){return{color:t.value,offset:parseFloat(t.length.value)/100}}))}}},{key:"ParseLinear",value:function(t){for(var e=t.orientation,i=t.colorStops,n=void 0===i?[]:i,r=re/2,a="angular"===e.type?parseFloat(e.value)/180*re:0;a<0;)a+=se;for(;a>=se;)a-=se;var o=0,s=0,l=0,u=0;return a<r?(o=0,s=1,l=Math.sin(a),u=s-Math.cos(a)):a<re?(o=0,s=0,l=Math.cos(a-r),u=Math.sin(a-r)):a<re+r?(s=0,l=(o=1)-Math.sin(a-re),u=Math.cos(a-re)):(l=(o=1)-Math.cos(a-r-re),u-=Math.sin(a-r-re)),{gradient:"linear",x0:o,y0:s,x1:l,y1:u,stops:n.map((function(t){return{color:t.value,offset:parseFloat(t.length.value)/100}}))}}}])}();function oc(t,e,i){var n=e,r=t.currentMatrix,a=r.a,o=r.b,s=r.c,l=r.d,u=Math.sign(a)*Math.sqrt(a*a+o*o),c=Math.sign(l)*Math.sqrt(s*s+l*l);return u+c===0?0:n=n/Math.abs(u+c)*2*i}function sc(t,e,i){var n,r,a,o,s,l,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(!e||!0===e)return"black";if(X(e))for(var h=0;h<e.length&&!(l=e[h]);h++);else l=e;if("string"==typeof(l=ac.Parse(l)))return l;if(i.AABBBounds&&(!i.attribute||0!==i.attribute.scaleX||0!==i.attribute.scaleY)){var d=i.AABBBounds,p=d.x2-d.x1,f=d.y2-d.y1,v=d.x1-u,g=d.y1-c;if(i.attribute){var y=i.attribute,m=y.scaleX,_=void 0===m?1:m,b=y.scaleY,x=void 0===b?1:b,k=y.angle;p/=_,f/=x,v/=_,g/=x,((void 0===k?0:k)||1!==_||1!==x)&&(v=null!==(n=i.x1WithoutTransform)&&void 0!==n?n:0,g=null!==(r=i.y1WithoutTransform)&&void 0!==r?r:0,p=null!==(a=i.widthWithoutTransform)&&void 0!==a?a:p,f=null!==(o=i.heightWithoutTransform)&&void 0!==o?o:f)}"linear"===l.gradient?s=function(t,e,i,n,r,a){var o,s,l,u,c=t.createLinearGradient(i+(null!==(o=e.x0)&&void 0!==o?o:0)*r,n+(null!==(s=e.y0)&&void 0!==s?s:0)*a,i+(null!==(l=e.x1)&&void 0!==l?l:1)*r,n+(null!==(u=e.y1)&&void 0!==u?u:0)*a);return e.stops.forEach((function(t){c.addColorStop(t.offset,t.color)})),c}(t,l,v,g,p,f):"conical"===l.gradient?s=function(t,e,i,n,r,a){var o,s,l=t.createConicGradient(i+(null!==(o=e.x)&&void 0!==o?o:0)*r,n+(null!==(s=e.y)&&void 0!==s?s:0)*a,e.startAngle,e.endAngle);return e.stops.forEach((function(t){l.addColorStop(t.offset,t.color)})),l.GetPattern?l.GetPattern(r+i,a+n,void 0):l}(t,l,v,g,p,f):"radial"===l.gradient&&(s=function(t,e,i,n,r,a){var o,s,l,u,c,h,d=t.createRadialGradient(i+(null!==(o=e.x0)&&void 0!==o?o:.5)*r,n+(null!==(s=e.y0)&&void 0!==s?s:.5)*a,Math.max(r,a)*(null!==(l=e.r0)&&void 0!==l?l:0),i+(null!==(u=e.x1)&&void 0!==u?u:.5)*r,n+(null!==(c=e.y1)&&void 0!==c?c:.5)*a,Math.max(r,a)*(null!==(h=e.r1)&&void 0!==h?h:.5));return e.stops.forEach((function(t){d.addColorStop(t.offset,t.color)})),d}(t,l,v,g,p,f))}return s||"orange"}var lc={horizontal:{width:"width",height:"height",left:"left",top:"top",x:"x",y:"y",bottom:"bottom"},vertical:{width:"height",height:"width",left:"top",top:"left",x:"y",y:"x",bottom:"right"}},uc=!0,cc=!1,hc=/\w|\(|\)|-/,dc=/[.?!,;:/，。？！、；：]/,pc=/\S/,fc=function(t,e){var i=e.fontSize||16;switch(e.script){case"super":case"sub":i*=.8}t.setTextStyle({textAlign:"left",textBaseline:e.textBaseline||"alphabetic",fontStyle:e.fontStyle||"",fontWeight:e.fontWeight||"",fontSize:i,fontFamily:e.fontFamily})};function vc(t,e,i,n,r){if(t.length<=1)return 0;if(!e||e<=0)return 0;for(var a=nc.graphicUtil.textMeasure,o=n,s=t.slice(0,o),l=Math.floor(a.measureText(s,i).width),u=t.slice(0,o+1),c=Math.floor(a.measureText(u,i).width);l>e||c<=e;){if(l>e?o--:o++,o>t.length){o=t.length;break}if(o<0){o=0;break}s=t.slice(0,o),l=Math.floor(a.measureText(s,i).width),u=t.slice(0,o+1),c=Math.floor(a.measureText(u,i).width)}return r&&(o=gc(t,o)),o}function gc(t,e){for(var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e;hc.test(t[n-1])&&hc.test(t[n])||dc.test(t[n]);)if(--n<=0)return i?yc(t,e):e;return n}function yc(t,e){for(var i=e;hc.test(t[i+1])&&hc.test(t[i])||dc.test(t[i]);)if(++i>=t.length)return i;return i+1}function mc(t,e){var i,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"actual";if(""===t)return{ascent:0,height:0,descent:0,width:0};var r=nc.graphicUtil.textMeasure.measureText(t,e),a={ascent:0,height:0,descent:0,width:0},o="actual"===n?r.actualBoundingBoxAscent:r.fontBoundingBoxAscent,s="actual"===n?r.actualBoundingBoxDescent:r.fontBoundingBoxDescent;"number"!=typeof o||"number"!=typeof s?(a.width=Math.floor(r.width),a.height=e.fontSize||0,a.ascent=a.height,a.descent=0):(a.width=Math.floor(r.width),a.height=Math.floor(o+s),a.ascent=Math.floor(o),a.descent=a.height-a.ascent);var l=null!==(i=e.space)&&void 0!==i?i:0;return a.width+=l,a}var _c=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},bc=function(){return o((function t(){r(this,t)}),[{key:"configure",value:function(t,e){this.canvas=t.canvas,this.context=t.context,t.bindTextMeasure(this)}},{key:"_measureTextWithoutAlignBaseline",value:function(t,e,i){this.context.setTextStyleWithoutAlignBaseline(e);var n=this.context.measureText(t);return i?this.compatibleMetrics(n,e):n}},{key:"_measureTextWithAlignBaseline",value:function(t,e,i){this.context.setTextStyle(e);var n=this.context.measureText(t);return i?this.compatibleMetrics(n,e):n}},{key:"compatibleMetrics",value:function(t,e){if(null==t.actualBoundingBoxAscent||null==t.actualBoundingBoxDescent||null==t.fontBoundingBoxAscent||null==t.fontBoundingBoxDescent){t={width:t.width};var i=this.measureTextBoundADscentEstimate(e),n=i.ascent,r=i.descent;t.actualBoundingBoxAscent=n,t.actualBoundingBoxDescent=r,t.fontBoundingBoxAscent=n,t.fontBoundingBoxDescent=r}if(null==t.actualBoundingBoxLeft||null==t.actualBoundingBoxRight){t={width:t.width,actualBoundingBoxAscent:t.actualBoundingBoxAscent,actualBoundingBoxDescent:t.actualBoundingBoxDescent,fontBoundingBoxAscent:t.fontBoundingBoxAscent,fontBoundingBoxDescent:t.fontBoundingBoxDescent};var a=this.measureTextBoundLeftRightEstimate(e),o=a.left,s=a.right;t.actualBoundingBoxLeft=o,t.actualBoundingBoxRight=s}return t}},{key:"estimate",value:function(t,e){for(var i=e.fontSize,n=void 0===i?$u.fontSize:i,r=0,a=0,o=0;o<t.length;o++)t.charCodeAt(o)<128?r++:a++;return{width:~~(.8*r*n+a*n),height:n}}},{key:"measureTextWidth",value:function(t,e,i){return this.context?(i=null!=i?i:this._measureTextWithoutAlignBaseline(t,e)).width:this.estimate(t,e).width}},{key:"measureTextBoundsWidth",value:function(t,e,i){return this.context?(i=null!=i?i:this._measureTextWithoutAlignBaseline(t,e)).width:this.estimate(t,e).width}},{key:"measureTextBoundsLeftRight",value:function(t,e,i){return this.context?{left:(i=null!=i?i:this._measureTextWithAlignBaseline(t,e,!0)).actualBoundingBoxLeft,right:i.actualBoundingBoxRight}:this.measureTextBoundLeftRightEstimate(e)}},{key:"measureTextPixelHeight",value:function(t,e,i){var n;return this.context?(i=null!=i?i:this._measureTextWithoutAlignBaseline(t,e,!0),Math.abs(i.actualBoundingBoxAscent-i.actualBoundingBoxDescent)):null!==(n=e.fontSize)&&void 0!==n?n:zu.fontSize}},{key:"measureTextPixelADscent",value:function(t,e,i){return this.context?{ascent:(i=null!=i?i:this._measureTextWithAlignBaseline(t,e,!0)).actualBoundingBoxAscent,descent:i.actualBoundingBoxDescent}:this.measureTextBoundADscentEstimate(e)}},{key:"measureTextBoundHieght",value:function(t,e,i){var n;return this.context?(i=null!=i?i:this._measureTextWithoutAlignBaseline(t,e,!0),Math.abs(i.fontBoundingBoxAscent-i.fontBoundingBoxDescent)):null!==(n=e.fontSize)&&void 0!==n?n:zu.fontSize}},{key:"measureTextBoundADscent",value:function(t,e,i){return this.context?{ascent:(i=null!=i?i:this._measureTextWithAlignBaseline(t,e,!0)).fontBoundingBoxAscent,descent:i.fontBoundingBoxDescent}:this.measureTextBoundADscentEstimate(e)}},{key:"measureTextBoundADscentEstimate",value:function(t){var e,i=null!==(e=t.fontSize)&&void 0!==e?e:zu.fontSize;return{ascent:.79*i,descent:.21*i}}},{key:"measureTextBoundLeftRightEstimate",value:function(t){var e,i=null!==(e=t.fontSize)&&void 0!==e?e:zu.fontSize,n=t.textAlign;return"center"===n?{left:i/2,right:i/2}:"right"===n||"end"===n?{left:i,right:0}:{left:0,right:i}}},{key:"measureTextPixelADscentAndWidth",value:function(t,e,i){if(!this.context)return Object.assign(Object.assign({},this.measureTextBoundADscentEstimate(e)),{width:this.estimate(t,e).width});var n=this._measureTextWithoutAlignBaseline(t,e,!0);if(i===ol.actualBounding)return{ascent:n.actualBoundingBoxAscent,descent:n.actualBoundingBoxDescent,width:n.width};if(i===ol.estimate)return Object.assign(Object.assign({},this.measureTextBoundADscentEstimate(e)),{width:n.width});if(i===ol.fontBounding){var r=n.fontBoundingBoxAscent,a=n.fontBoundingBoxDescent;if(n.actualBoundingBoxDescent&&a<n.actualBoundingBoxDescent){var o=n.actualBoundingBoxDescent-a;a+=o,r-=o}else if(n.actualBoundingBoxAscent&&r<n.actualBoundingBoxAscent){var s=n.actualBoundingBoxAscent-r;r+=s,a-=s}return{ascent:r,descent:a,width:n.width}}return{ascent:n.actualBoundingBoxAscent,descent:n.actualBoundingBoxDescent,width:n.width}}},{key:"measureText",value:function(t,e){return this.context?(this.context.setTextStyleWithoutAlignBaseline(e),this.context.measureText(t)):this.estimate(t,e)}},{key:"clipTextVertical",value:function(t,e,i,n){var r=this;if(0===t.length)return{verticalList:t,width:0};var a=e.fontSize,o=void 0===a?12:a;t.forEach((function(t){t.width=0===t.direction?o:r.measureTextWidth(t.text,e)}));for(var s=[],l=0,u=0;u<t.length&&l+t[u].width<i;u++)l+=t[u].width,s.push(t[u]);if(t[u]&&t[u].text.length>1){var c=this._clipText(t[u].text,e,i-l,0,t[u].text.length-1,"end",!1);if(n&&c.str!==t[u].text){for(var h="",d=0,p=0;p<u;p++){var f=t[p];h+=f.text,d+=f.text.length}var v=gc(h+=t[u].text,d+c.str.length);(v-=d)!==c.str.length-1&&(c.str=c.str.substring(0,v),c.width=this.measureTextWidth(c.str,e))}s.push(Object.assign(Object.assign({},t[u]),{text:c.str,width:c.width})),l+=c.width}return{verticalList:s,width:l}}},{key:"clipText",value:function(t,e,i,n,r){if(0===t.length)return{str:"",width:0};var a=this.measureTextWidth(t,e);if(a<=i)return{str:t,width:a};if((a=this.measureTextWidth(t[0],e))>i)return{str:"",width:0};var o=this._clipText(t,e,i,0,t.length-1,"end",!1);if(n&&o.str!==t){var s=gc(t,o.str.length,r);s!==o.str.length&&(s>o.str.length&&(o.wordBreaked=s,s=o.str.length),o.str=t.substring(0,s),o.width=this.measureTextWidth(o.str,e))}return o}},{key:"_clipText",value:function(t,e,i,n,r,a,o){var s;if("start"===a)s=this._clipTextStart(t,e,i,n,r),o&&(s.result=o+s.str);else if("middle"===a){var l=this._clipTextMiddle(t,e,i,"","",0,0,1);s={str:"none",width:l.width,result:l.left+o+l.right}}else s=this._clipTextEnd(t,e,i,n,r),o&&(s.result=s.str+o);return s}},{key:"_clipTextEnd",value:function(t,e,i,n,r){if(n===r){Lt.getInstance().warn("【_clipTextEnd】不应该走到这里".concat(t,", ").concat(n,", ").concat(r));var a=t.substring(0,r+1);return{str:a,width:this.measureTextWidth(a,e)}}var o,s=Math.floor((n+r)/2),l=t.substring(0,s+1),u=this.measureTextWidth(l,e);if(u>i){if(l.length<=1)return{str:"",width:0};var c=t.substring(0,s);return(o=this.measureTextWidth(c,e))<=i?{str:c,width:o}:this._clipTextEnd(t,e,i,n,s)}if(u<i){if(s>=t.length-1)return{str:t,width:this.measureTextWidth(t,e)};var h=t.substring(0,s+2);return(o=this.measureTextWidth(h,e))>=i?{str:l,width:u}:this._clipTextEnd(t,e,i,s,r)}return{str:l,width:u}}},{key:"_clipTextStart",value:function(t,e,i,n,r){var a,o=Math.ceil((n+r)/2),s=t.substring(o-1,t.length),l=this.measureTextWidth(s,e);if(l>i){if(s.length<=1)return{str:"",width:0};var u=t.substring(o,t.length);return(a=this.measureTextWidth(u,e))<=i?{str:u,width:a}:this._clipTextStart(t,e,i,o,t.length)}if(l<i){if(o<=0)return{str:t,width:this.measureTextWidth(t,e)};var c=t.substring(o-2,t.length);return(a=this.measureTextWidth(c,e))>=i?{str:s,width:l}:this._clipTextStart(t,e,i,n,o)}return{str:s,width:l}}},{key:"_clipTextMiddle",value:function(t,e,i,n,r,a,o,s){var l=t.substring(0,s),u=this.measureTextWidth(l,e);if(u+o>i)return{left:n,right:r,width:a+o};var c=t.substring(t.length-s,t.length),h=this.measureTextWidth(c,e);return u+h>i?{left:l,right:r,width:u+o}:this._clipTextMiddle(t,e,i,l,c,u,h,s+1)}},{key:"clipTextWithSuffixVertical",value:function(t,e,i,n,r,a){if(""===n)return this.clipTextVertical(t,e,i,r);if(0===t.length)return{verticalList:t,width:0};var o=this.clipTextVertical(t,e,i,r);if(o.verticalList.length===t.length&&o.verticalList[o.verticalList.length-1].width===t[t.length-1].width)return o;var s,l=this.measureTextWidth(n,e);if(l>i)return o;if(i-=l,"start"===a){var u=this.revertVerticalList(t);s=this.clipTextVertical(u,e,i,r);var c=this.revertVerticalList(s.verticalList);c.unshift({text:n,direction:1,width:l}),s.verticalList=c}else if("middle"===a){var h=this.clipTextVertical(t,e,i/2,r),d=this.revertVerticalList(t),p=this.clipTextVertical(d,e,i/2,r);h.verticalList.push({text:n,direction:1,width:l}),this.revertVerticalList(p.verticalList).forEach((function(t){return h.verticalList.push(t)})),s={verticalList:h.verticalList,width:h.width+p.width}}else(s=this.clipTextVertical(t,e,i,r)).verticalList.push({text:n,direction:1,width:l});return s.width+=l,s}},{key:"revertVerticalList",value:function(t){return t.reverse().map((function(t){var e=t.text.split("").reverse().join("");return Object.assign(Object.assign({},t),{text:e})}))}},{key:"clipTextWithSuffix",value:function(t,e,i,n,r,a){var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6];if(""===n)return this.clipText(t,e,i,r);if(0===t.length)return{str:"",width:0};var s=this.measureTextWidth(t,e);if(!o&&s<=i)return{str:t,width:s};var l=this.measureTextWidth(n,e);if(l>i)return{str:"",width:0};if(o&&s+l<=i)return{str:t+n,width:s+l};i-=l;var u=this._clipText(t,e,i,0,t.length-1,a,n);if(r&&u.str!==t){var c=gc(t,u.str.length);c!==u.str.length&&(u.result=t.substring(0,c),u.width=this.measureTextWidth(u.str,e))}else o&&u.str===t&&(u.result=t+n);return u.str=u.result,u.width+=l,u}}])}();bc=_c([js()],bc);var xc=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},kc=Symbol.for("TextMeasureContribution"),Sc=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e)}(bc);Sc=xc([js()],Sc);var Ac=new il,Mc=Symbol.for("CanvasFactory"),wc=Symbol.for("Context2dFactory");function Tc(t){return Ac.getNamed(Mc,nc.global.env)(t)}var Cc=1e-4,Ec=Math.sqrt(3),Pc=1/3;function Rc(t){return t>-Gc&&t<Gc}function Bc(t){return t>Gc||t<-Gc}var Ic=[0,0],Lc=[0,0],Dc=[0,0];function Oc(t,e){return(t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])}function Fc(t,e,i,n){var r=1-n;return r*(r*t+2*n*e)+n*n*i}function zc(t,e,i,n,r){var a=1-r;return a*a*(a*t+3*r*e)+r*r*(r*n+3*a*i)}function Hc(t){return(t%=se)<0&&(t+=se),t}function jc(t,e,i,n,r,a,o,s,l){if(0===o)return!1;var u=o;return!(l>e+u&&l>n+u&&l>a+u||l<e-u&&l<n-u&&l<a-u||s>t+u&&s>i+u&&s>r+u||s<t-u&&s<i-u&&s<r-u)&&function(t,e,i,n,r,a,o,s,l){var u=0,c=.005,h=1/0;Ic[0]=o,Ic[1]=s;for(var d=0;d<1;d+=.05){Lc[0]=Fc(t,i,r,d),Lc[1]=Fc(e,n,a,d);var p=Oc(Ic,Lc);p<h&&(u=d,h=p)}h=1/0;for(var f=0;f<32&&!(c<Cc);f++){var v=u-c,g=u+c;Lc[0]=Fc(t,i,r,v),Lc[1]=Fc(e,n,a,v);var y=Oc(Lc,Ic);if(v>=0&&y<h)u=v,h=y;else{Dc[0]=Fc(t,i,r,g),Dc[1]=Fc(e,n,a,g);var m=Oc(Dc,Ic);g<=1&&m<h?(u=g,h=m):c*=.5}}return l&&(l[0]=Fc(t,i,r,u),l[1]=Fc(e,n,a,u)),Math.sqrt(h)}(t,e,i,n,r,a,s,l,null)<=u/2}function Nc(t,e,i,n,r,a,o,s,l,u,c){if(0===l)return!1;var h=l;return!(c>e+h&&c>n+h&&c>a+h&&c>s+h||c<e-h&&c<n-h&&c<a-h&&c<s-h||u>t+h&&u>i+h&&u>r+h&&u>o+h||u<t-h&&u<i-h&&u<r-h&&u<o-h)&&function(t,e,i,n,r,a,o,s,l,u,c){var h,d,p,f,v=0,g=.005,y=1/0;Ic[0]=l,Ic[1]=u;for(var m=0;m<1;m+=.05)Lc[0]=zc(t,i,r,o,m),Lc[1]=zc(e,n,a,s,m),(p=Oc(Ic,Lc))<y&&(v=m,y=p);y=1/0;for(var _=0;_<32&&!(g<Cc);_++)h=v-g,d=v+g,Lc[0]=zc(t,i,r,o,h),Lc[1]=zc(e,n,a,s,h),p=Oc(Lc,Ic),h>=0&&p<y?(v=h,y=p):(Dc[0]=zc(t,i,r,o,d),Dc[1]=zc(e,n,a,s,d),f=Oc(Dc,Ic),d<=1&&f<y?(v=d,y=f):g*=.5);return c&&(c[0]=zc(t,i,r,o,v),c[1]=zc(e,n,a,s,v)),Math.sqrt(y)}(t,e,i,n,r,a,o,s,u,c,null)<=h/2}function Vc(t,e,i,n,r,a,o,s,l){if(0===o)return!1;var u=o;s-=t,l-=e;var c=Math.sqrt(s*s+l*l);if(c-u>i||c+u<i)return!1;if(Math.abs(n-r)%se<1e-4)return!0;if(a){var h=n;n=Hc(r),r=Hc(h)}else n=Hc(n),r=Hc(r);n>r&&(r+=se);var d=Math.atan2(l,s);return d<0&&(d+=se),d>=n&&d<=r||d+se>=n&&d+se<=r}function Wc(t,e,i,n,r,a,o){if(0===r)return!1;var s,l=r,u=r/2;if(o>e+u&&o>n+u||o<e-u&&o<n-u||a>t+u&&a>i+u||a<t-u&&a<i-u)return!1;if(t===i)return Math.abs(a-t)<=l/2;var c=(s=(e-n)/(t-i))*a-o+(t*n-i*e)/(t-i);return c*c/(s*s+1)<=l/2*l/2}var Gc=1e-4;function Uc(t,e,i,n,r){var a=6*i-12*e+6*t,o=9*e+3*n-3*t-9*i,s=3*e-3*t,l=0;if(Rc(o)){if(Bc(a)){var u=-s/a;u>=0&&u<=1&&(r[l++]=u)}}else{var c=a*a-4*o*s;if(Rc(c))r[0]=-a/(2*o);else if(c>0){var h=Math.sqrt(c),d=(-a+h)/(2*o),p=(-a-h)/(2*o);d>=0&&d<=1&&(r[l++]=d),p>=0&&p<=1&&(r[l++]=p)}}return l}var Yc=[-1,-1,-1],Xc=[-1,-1];function Kc(t,e,i,n,r,a,o,s,l,u){if(u>e&&u>n&&u>a&&u>s||u<e&&u<n&&u<a&&u<s)return 0;var c=function(t,e,i,n,r,a){var o=n+3*(e-i)-t,s=3*(i-2*e+t),l=3*(e-t),u=t-r,c=s*s-3*o*l,h=s*l-9*o*u,d=l*l-3*s*u,p=0;if(Rc(c)&&Rc(h))if(Rc(s))a[0]=0;else{var f=-l/s;f>=0&&f<=1&&(a[p++]=f)}else{var v=h*h-4*c*d;if(Rc(v)){var g=h/c,y=-s/o+g,m=-g/2;y>=0&&y<=1&&(a[p++]=y),m>=0&&m<=1&&(a[p++]=m)}else if(v>0){var _=Math.sqrt(v),b=c*s+1.5*o*(-h+_),x=c*s+1.5*o*(-h-_),k=(-s-((b=b<0?-Math.pow(-b,Pc):Math.pow(b,Pc))+(x=x<0?-Math.pow(-x,Pc):Math.pow(x,Pc))))/(3*o);k>=0&&k<=1&&(a[p++]=k)}else{var S=(2*c*s-3*o*h)/(2*Math.sqrt(c*c*c)),A=Math.acos(S)/3,M=Math.sqrt(c),w=Math.cos(A),T=(-s-2*M*w)/(3*o),C=(-s+M*(w+Ec*Math.sin(A)))/(3*o),E=(-s+M*(w-Ec*Math.sin(A)))/(3*o);T>=0&&T<=1&&(a[p++]=T),C>=0&&C<=1&&(a[p++]=C),E>=0&&E<=1&&(a[p++]=E)}}return p}(e,n,a,s,u,Yc);if(0===c)return 0;for(var h,d=0,p=-1,f=0,v=0,g=0;g<c;g++){var y=Yc[g],m=0===y||1===y?.5:1;zc(t,i,r,o,y)<l||(p<0&&(p=Uc(e,n,a,s,Xc),Xc[1]<Xc[0]&&p>1&&(h=void 0,h=Xc[0],Xc[0]=Xc[1],Xc[1]=h),f=zc(e,n,a,s,Xc[0]),p>1&&(v=zc(e,n,a,s,Xc[1]))),2===p?y<Xc[0]?d+=f<e?m:-m:y<Xc[1]?d+=v<f?m:-m:d+=s<v?m:-m:y<Xc[0]?d+=f<e?m:-m:d+=s<f?m:-m)}return d}function qc(t,e,i,n,r,a,o,s){if(s>e&&s>n&&s>a||s<e&&s<n&&s<a)return 0;var l=function(t,e,i,n,r){var a=t-2*e+i,o=2*(e-t),s=t-n,l=0;if(Rc(a)){if(Bc(o)){var u=-s/o;u>=0&&u<=1&&(r[l++]=u)}}else{var c=o*o-4*a*s;if(Rc(c)){var h=-o/(2*a);h>=0&&h<=1&&(r[l++]=h)}else if(c>0){var d=Math.sqrt(c),p=(-o+d)/(2*a),f=(-o-d)/(2*a);p>=0&&p<=1&&(r[l++]=p),f>=0&&f<=1&&(r[l++]=f)}}return l}(e,n,a,s,Yc);if(0===l)return 0;var u,c,h,d=0===(h=(u=e)+a-2*(c=n))?.5:(u-c)/h;if(d>=0&&d<=1){for(var p=0,f=Fc(e,n,a,d),v=0;v<l;v++){var g=0===Yc[v]||1===Yc[v]?.5:1;Fc(t,i,r,Yc[v])<o||(Yc[v]<d?p+=f<e?g:-g:p+=a<f?g:-g)}return p}var y=0===Yc[0]||1===Yc[0]?.5:1;return Fc(t,i,r,Yc[0])<o?0:a<e?y:-y}function Zc(t,e,i,n,r,a,o,s){if((s-=e)>i||s<-i)return 0;var l=Math.sqrt(i*i-s*s);Yc[0]=-l,Yc[1]=l;var u=Math.abs(n-r);if(u<1e-4)return 0;if(u>=se-1e-4){n=0,r=se;var c=a?1:-1;return o>=Yc[0]+t&&o<=Yc[1]+t?c:0}if(n>r){var h=n;n=r,r=h}n<0&&(n+=se,r+=se);for(var d=0,p=0;p<2;p++){var f=Yc[p];if(f+t>o){var v=Math.atan2(s,f),g=a?1:-1;v<0&&(v=se+v),(v>=n&&v<=r||v+se>=n&&v+se<=r)&&(v>re/2&&v<1.5*re&&(g=-g),d+=g)}}return d}function Jc(t){return Math.round(t/re*1e8)/1e8%2*re}function Qc(t,e){var i=Jc(t[0]);i<0&&(i+=se);var n=i-t[0],r=t[1];r+=n,!e&&r-i>=se?r=i+se:e&&i-r>=se?r=i-se:!e&&i>r?r=i+(se-Jc(i-r)):e&&i<r&&(r=i-(se-Jc(r-i))),t[0]=i,t[1]=r}var $c=[0,0];function th(t,e,i,n,r){for(var a,o,s=t,l=t.length,u=0,c=0,h=0,d=0,p=0,f=0;f<l;f++){var v=s[f],g=0===f;v[0]===Ol.M&&f>1&&(i||(u+=ni(c,h,d,p,n,r))),g&&(d=c=v[1],p=h=v[2]);var y=v[0],m=v[1],_=v[2],b=v[3],x=v[4],k=v[5],S=v[6],A=x,M=k;$c[0]=A,$c[1]=M,Qc($c,Boolean(v[6]));var w=A=$c[0],T=(M=$c[1])-A,C=!!(1-(v[6]?0:1)),E=(n-m)*b/b+m;switch(y){case Ol.M:c=d=m,h=p=_;break;case Ol.L:if(i){if(Wc(c,h,m,_,e,n,r))return!0}else u+=ni(c,h,m,_,n,r)||0;c=m,h=_;break;case Ol.C:if(i){if(Nc(c,h,m,_,b,x,k,S,e,n,r))return!0}else u+=Kc(c,h,m,_,b,x,k,S,n,r)||0;c=k,h=S;break;case Ol.Q:if(i){if(jc(c,h,m,_,b,x,e,n,r))return!0}else u+=qc(c,h,m,_,b,x,n,r)||0;c=b,h=x;break;case Ol.A:if(a=Math.cos(w)*b+m,o=Math.sin(w)*b+_,g?(d=a,p=o):u+=ni(c,h,a,o,n,r),i){if(Vc(m,_,b,w,w+T,C,e,E,r))return!0}else u+=Zc(m,_,b,w,w+T,C,E,r);c=Math.cos(w+T)*b+m,h=Math.sin(w+T)*b+_;break;case Ol.R:if(a=(d=c=m)+b,o=(p=h=_)+x,i){if(Wc(d,p,a,p,e,n,r)||Wc(a,p,a,o,e,n,r)||Wc(a,o,d,o,e,n,r)||Wc(d,o,d,p,e,n,r))return!0}else u+=ni(a,p,a,o,n,r),u+=ni(d,o,d,p,n,r);break;case Ol.Z:if(i){if(Wc(c,h,d,p,e,n,r))return!0}else u+=ni(c,h,d,p,n,r);c=d,h=p}}return i||function(t,e){return Math.abs(t-e)<Gc}(h,p)||(u+=ni(c,h,d,p,n,r)||0),0!==u}var eh=function(){return o((function t(){r(this,t),this.pools=[],this.allocatedCanvas=[]}),[{key:"shareCanvas",value:function(){return this.allocatedCanvas.length?this.allocatedCanvas[0]:this.getCommonCanvas()}},{key:"getCommonCanvas",value:function(){return this._commonCanvas||(this._commonCanvas=this.allocate({width:100,height:100,dpr:2})),this._commonCanvas}},{key:"allocate",value:function(t){if(!this.pools.length){var e=Tc(Object.assign({nativeCanvas:nc.global.createCanvas(t)},t));return this.allocatedCanvas.push(e),e}var i=this.pools.pop();return i.resize(t.width,t.height),i.dpr=t.dpr,i}},{key:"allocateByObj",value:function(t){if(!this.pools.length){var e={width:t.width/t.dpr,height:t.height/t.dpr,dpr:t.dpr},i=Tc(Object.assign({nativeCanvas:nc.global.createCanvas(e)},e));return this.allocatedCanvas.push(i),i}var n=this.pools.pop();return n.width=t.width,n.height=t.height,n}},{key:"free",value:function(t){this.pools.push(t)}},{key:"length",get:function(){return this.pools.length}},{key:"release",value:function(){this.pools=[]}}])}(),ih=new eh,nh=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},rh=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},ah=Symbol.for("VWindow"),oh=Symbol.for("WindowHandlerContribution"),sh=function(){return o((function t(){var e=this;r(this,t),this.hooks={onChange:new ll(["x","y","width","height"])},this.active=function(){var t=e.global;t.env&&!e.actived&&(Ac.getNamed(oh,t.env).configure(e,t),e.actived=!0)},this._uid=ws.GenAutoIncrementId(),this.global=nc.global,this.postInit()}),[{key:"width",get:function(){if(this._handler){var t=this._handler.getWH();return this._width=t.width}return this._width}},{key:"height",get:function(){if(this._handler){var t=this._handler.getWH();return this._height=t.height}return this._height}},{key:"dpr",get:function(){return this._handler.getDpr()}},{key:"postInit",value:function(){this.global.hooks.onSetEnv.tap("window",this.active),this.active()}},{key:"style",get:function(){var t;return null!==(t=this._handler.getStyle())&&void 0!==t?t:{}},set:function(t){this._handler.setStyle(t)}},{key:"create",value:function(t){var e,i;this._handler.createWindow(t);var n=this._handler.getWH();this._width=n.width,this._height=n.height,t.viewBox?this.setViewBox(t.viewBox):!1!==t.canvasControled?this.setViewBox({x1:0,y1:0,x2:this._width,y2:this._height}):this.setViewBox({x1:0,y1:0,x2:null!==(e=t.width)&&void 0!==e?e:this._width,y2:null!==(i=t.height)&&void 0!==i?i:this._height}),this.title=this._handler.getTitle(),this.resizable=!0}},{key:"setWindowHandler",value:function(t){this._handler=t}},{key:"setDpr",value:function(t){return this._handler.setDpr(t)}},{key:"resize",value:function(t,e){return this._handler.resizeWindow(t,e)}},{key:"configure",value:function(){throw new Error("暂不支持")}},{key:"release",value:function(){return this.global.hooks.onSetEnv.unTap("window",this.active),this._handler.releaseWindow()}},{key:"getContext",value:function(){return this._handler.getContext()}},{key:"getNativeHandler",value:function(){return this._handler.getNativeHandler()}},{key:"getImageBuffer",value:function(t){return this._handler.getImageBuffer?this._handler.getImageBuffer(t):null}},{key:"addEventListener",value:function(t,e,i){return this._handler.addEventListener(t,e,i)}},{key:"removeEventListener",value:function(t,e,i){return this._handler.removeEventListener(t,e,i)}},{key:"dispatchEvent",value:function(t){return this._handler.dispatchEvent(t)}},{key:"getBoundingClientRect",value:function(){return this._handler.getBoundingClientRect()}},{key:"getContainer",value:function(){return this._handler.container}},{key:"clearViewBox",value:function(t){this._handler.clearViewBox(t)}},{key:"setViewBox",value:function(t){this._handler.setViewBox(t)}},{key:"setViewBoxTransform",value:function(t,e,i,n,r,a){this._handler.setViewBoxTransform(t,e,i,n,r,a)}},{key:"getViewBox",value:function(){return this._handler.getViewBox()}},{key:"getViewBoxTransform",value:function(){return this._handler.getViewBoxTransform()}},{key:"pointTransform",value:function(t,e){var i=this._handler.getViewBox(),n={x:t,y:e};return this._handler.getViewBoxTransform().transformPoint({x:t,y:e},n),n.x-=i.x1,n.y-=i.y1,n}},{key:"hasSubView",value:function(){var t=this._handler.getViewBox();return!(0===t.x1&&0===t.y1&&Nt(this.width,t.width())&&Nt(this.height,t.height()))}},{key:"isVisible",value:function(t){return this._handler.isVisible(t)}},{key:"onVisibleChange",value:function(t){return this._handler.onVisibleChange(t)}},{key:"getTopLeft",value:function(t){return this._handler.getTopLeft(t)}}])}();sh=nh([js(),rh("design:paramtypes",[])],sh);var lh,uh=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},ch=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},hh=function(t,e){return function(i,n){e(i,n,t)}},dh=function(){return o((function t(e){var i=this;r(this,t),this.contributions=e,this.configured=!1,this.global=nc.global,this.global.hooks.onSetEnv.tap("graphic-util",(function(t,e,n){i.configured=!1,i.configure(n,e)}))}),[{key:"canvas",get:function(){return this.tryInitCanvas(),this._canvas}},{key:"context",get:function(){return this.tryInitCanvas(),this._context}},{key:"textMeasure",get:function(){return this._textMeasure||this.configure(this.global,this.global.env),this._textMeasure}},{key:"configure",value:function(t,e){var i=this;this.configured||(this.contributions.getContributions().forEach((function(t){t.configure(i,e)})),this.configured=!0)}},{key:"tryInitCanvas",value:function(){if(!this._canvas){var t=ih.shareCanvas();this._canvas=t,this._context=t.getContext("2d")}}},{key:"bindTextMeasure",value:function(t){this._textMeasure=t}},{key:"measureText",value:function(t,e){var i,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"native";this.configure(this.global,this.global.env);var r=this.global.measureTextMethod;this.global.measureTextMethod=n;var a={width:this._textMeasure.measureTextWidth(t,e),height:null!==(i=e.fontSize)&&void 0!==i?i:zu.fontSize};return this.global.measureTextMethod=r,a}},{key:"createTextMeasureInstance",value:function(t,e,i){var n=this;return this.configure(this.global,this.global.env),new si(Object.assign({defaultFontParams:{fontFamily:zu.fontFamily,fontSize:zu.fontSize},getCanvasForMeasure:i||function(){return n.canvas},getTextBounds:void 0,specialCharSet:"-/: .,@%'\"~"+si.ALPHABET_CHAR_SET+si.ALPHABET_CHAR_SET.toUpperCase()},null!=e?e:{}),t)}},{key:"drawGraphicToCanvas",value:function(t,e,i){if(!e.defaultLayer)return null;var n=Ac.get(ah),r=t.AABBBounds,a=r.width(),o=r.height(),s=-r.x1,l=-r.y1;n.create({viewBox:{x1:s,y1:l,x2:r.x2,y2:r.y2},width:a,height:o,canvas:i,dpr:e.window.dpr,canvasControled:!0,offscreen:!0,title:""});var u=e.params.optimize.disableCheckGraphicWidthOutRange;e.params.optimize.disableCheckGraphicWidthOutRange=!0,e.defaultLayer.getNativeHandler().drawTo(n,[t],{transMatrix:n.getViewBoxTransform(),viewBox:n.getViewBox(),stage:e,layer:e.defaultLayer,renderService:e.renderService,background:"transparent",clear:!0,updateBounds:!1}),e.params.optimize.disableCheckGraphicWidthOutRange=u;var c=n.getNativeHandler();return c.nativeCanvas?c.nativeCanvas:null}}])}();dh=uh([js(),hh(0,zs(nl)),hh(0,Ns(kc)),ch("design:paramtypes",[Object])],dh),function(t){t[t.transform=0]="transform",t[t.matrix=1]="matrix"}(lh||(lh={}));var ph=new vi,fh=function(){return o((function t(){r(this,t),this.matrix=new vi}),[{key:"init",value:function(t){return this.mode=lh.transform,this.originTransform=t,this.matrix.reset(),this}},{key:"fromMatrix",value:function(t,e){return this.mode=lh.matrix,this.outSourceMatrix=t,this.outTargetMatrix=e,this}},{key:"scaleMatrix",value:function(t,e,i){var n=this.outSourceMatrix;if(ph.setValue(n.a,n.b,n.c,n.d,n.e,n.f),this.outTargetMatrix.reset(),i){var r=i.x,a=i.y;this.outTargetMatrix.translate(r,a),this.outTargetMatrix.scale(t,e),this.outTargetMatrix.translate(-r,-a)}else this.outTargetMatrix.scale(t,e);return this.outTargetMatrix.multiply(ph.a,ph.b,ph.c,ph.d,ph.e,ph.f),this}},{key:"rotateMatrix",value:function(t,e){var i=this.outSourceMatrix;if(ph.setValue(i.a,i.b,i.c,i.d,i.e,i.f),this.outTargetMatrix.reset(),e){var n=e.x,r=e.y;this.outTargetMatrix.translate(n,r),this.outTargetMatrix.rotate(t),this.outTargetMatrix.translate(-n,-r)}else this.outTargetMatrix.rotate(t);return this.outTargetMatrix.multiply(ph.a,ph.b,ph.c,ph.d,ph.e,ph.f),this}},{key:"scale",value:function(t,e,i){return this.mode===lh.matrix?this.scaleMatrix(t,e,i):this}},{key:"rotate",value:function(t,e){return this.mode===lh.matrix?this.rotateMatrix(t,e):this}},{key:"translateMatrix",value:function(t,e){var i=this.outSourceMatrix;return ph.setValue(i.a,i.b,i.c,i.d,i.e,i.f),this.outTargetMatrix.reset(),this.outTargetMatrix.translate(t,e),this.outTargetMatrix.multiply(ph.a,ph.b,ph.c,ph.d,ph.e,ph.f),this}},{key:"translate",value:function(t,e){return this.mode===lh.matrix?this.translateMatrix(t,e):this}},{key:"simplify",value:function(t){return this.mode===lh.matrix?this.simplifyMatrix(t):this}},{key:"simplifyMatrix",value:function(t){return this}}])}();fh=uh([js(),ch("design:paramtypes",[])],fh);var vh={arc:Vu,area:Wu,circle:Gu,line:Xu,path:Ku,symbol:Qu,text:$u,rect:Ju,polygon:qu,star:Zu,richtext:tc,richtextIcon:ic,image:ec,group:Uu,glyph:Yu},gh=Object.keys(vh);function yh(t,e){Object.keys(e).forEach((function(i){t[i]=e[i]}))}var mh={arc:Object.assign({},vh.arc),area:Object.assign({},vh.area),circle:Object.assign({},vh.circle),line:Object.assign({},vh.line),path:Object.assign({},vh.path),symbol:Object.assign({},vh.symbol),text:Object.assign({},vh.text),rect:Object.assign({},vh.rect),polygon:Object.assign({},vh.polygon),star:Object.assign({},vh.star),richtext:Object.assign({},vh.richtext),richtextIcon:Object.assign({},vh.richtextIcon),image:Object.assign({},vh.image),group:Object.assign({},vh.group),glyph:Object.assign({},vh.glyph)},_h=function(){return o((function t(){r(this,t),this.initTheme(),this.dirty=!1}),[{key:"initTheme",value:function(){var t=this;this._defaultTheme={},gh.forEach((function(e){t._defaultTheme[e]=Object.create(mh[e])})),this.combinedTheme=this._defaultTheme}},{key:"getTheme",value:function(t){if(!t)return this.combinedTheme;if(!this.dirty)return this.combinedTheme;var e={},i=this.getParentWithTheme(t);return i&&(e=i.theme),this.applyTheme(t,e),this.combinedTheme}},{key:"getParentWithTheme",value:function(t){for(;t.parent;)if((t=t.parent).theme)return t;return null}},{key:"applyTheme",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.dirty){var n=this.getParentWithTheme(t);if(n){var r=n.theme;(r.dirty||i)&&r.applyTheme(n,e,!0)}this.userTheme?this.doCombine(n&&n.theme.combinedTheme):(n?this.combinedTheme=n.theme.combinedTheme:(this.combinedTheme=this._defaultTheme,Lt.getInstance().warn("未知错误，走到不应该走的区域里")),this.dirty=!1)}return this.combinedTheme}},{key:"doCombine",value:function(t){var e=this,i=this.userTheme,n=this.combinedTheme;gh.forEach((function(r){var a=Object.create(mh[r]);t&&t[r]&&yh(a,t[r]),n[r]&&yh(a,n[r]),i[r]&&yh(a,i[r]),e.combinedTheme[r]=a})),i.common&&gh.forEach((function(t){yh(e.combinedTheme[t],i.common)})),this.dirty=!1}},{key:"setTheme",value:function(t,e){var i=this.userTheme;i?Object.keys(t).forEach((function(e){i[e]?Object.assign(i[e],t[e]):i[e]=Object.assign({},t[e])})):i=t,this.userTheme=i,this.dirty=!0,this.dirtyChildren(e)}},{key:"resetTheme",value:function(t,e){this.userTheme=t,this.dirty=!0,this.dirtyChildren(e)}},{key:"dirtyChildren",value:function(t){var e=this;t.forEachChildren((function(t){t.isContainer&&(t.theme&&(t.theme.dirty=!0),e.dirtyChildren(t))}))}}])}(),bh=new _h;function xh(t,e){return t.glyphHost?xh(t.glyphHost):e?(t.isContainer,e):function(t){var e;if(e=t.isContainer?t:t.parent,e){for(;e&&!e.theme;)e=e.parent;return e?(e.theme||e.createTheme(),e.theme.getTheme(e)):bh.getTheme()}return null}(t)||t.attachedThemeGraphic&&xh(t.attachedThemeGraphic)||bh.getTheme()}var kh=function(t,e,i,n){return new(i||(i=Promise))((function(r,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,s)}l((n=n.apply(t,e||[])).next())}))},Sh=function(t){function e(){var t;return r(this,e),(t=n(this,e))._uid=ws.GenAutoIncrementId(),t._firstChild=null,t._lastChild=null,t.parent=null,t._count=1,t}return h(e,t),o(e,[{key:"previousSibling",get:function(){return this._prev}},{key:"nextSibling",get:function(){return this._next}},{key:"children",get:function(){return this.getChildren()}},{key:"firstChild",get:function(){return this._firstChild}},{key:"lastChild",get:function(){return this._lastChild}},{key:"count",get:function(){return this._count}},{key:"childrenCount",get:function(){return this._idMap?this._idMap.size:0}},{key:"forEachChildren",value:function(t){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1])for(var e=this._lastChild,i=0;e;){if(t(e,i++))return;e=e._prev}else for(var n=this._firstChild,r=0;n;){if(t(n,r++))return;n=n._next}}},{key:"forEachChildrenAsync",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return kh(this,void 0,void 0,f().mark((function i(){var n,r,a,o,s,l;return f().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!e){i.next=16;break}n=this._lastChild,r=0;case 2:if(!n){i.next=14;break}if(a=t(n,r++),i.t0=a.then,!i.t0){i.next=9;break}return i.next=8,a;case 8:a=i.sent;case 9:if(!a){i.next=11;break}return i.abrupt("return");case 11:n=n._prev;case 12:i.next=2;break;case 14:i.next=29;break;case 16:o=this._firstChild,s=0;case 17:if(!o){i.next=29;break}if(l=t(o,s++),i.t1=l.then,!i.t1){i.next=24;break}return i.next=23,l;case 23:l=i.sent;case 24:if(!l){i.next=26;break}return i.abrupt("return");case 26:o=o._next;case 27:i.next=17;break;case 29:case"end":return i.stop()}}),i,this)})))}},{key:"forEach",value:function(t){return this.forEachChildren(t)}},{key:"appendChild",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this._uid===t._uid)return null;if(!e&&t.isAncestorsOf(this))throw new Error("【Node::appendChild】不能将父辈元素append为子元素");return t.parent&&t.parent.removeChild(t),t.parent=this,this._lastChild?(this._lastChild._next=t,t._prev=this._lastChild,this._lastChild=t):(this._firstChild=this._lastChild=t,t._prev=t._next=null),this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this.setCount(t.count),this._structEdit=!0,t}},{key:"appendChildArrHighPerformance",value:function(t){return console.error("暂不支持该函数"),t}},{key:"insertBefore",value:function(t,e){if(!e)return this.appendChild(t);if(this===t||t===e)return null;if(t.isAncestorsOf(this))throw new Error("【Node::insertBefore】不能将父辈元素insert为子元素");return e.parent!==this?null:(t.parent&&t.parent.removeChild(t),t.parent=this,t._prev=e._prev,e._prev?e._prev._next=t:this._firstChild=t,e._prev=t,t._next=e,this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this._structEdit=!0,this.setCount(t.count),t)}},{key:"insertAfter",value:function(t,e){if(!e)return this.appendChild(t);if(this===t||t===e)return null;if(t.isAncestorsOf(this))throw new Error("【Node::insertAfter】不能将父辈元素insert为子元素");return e.parent!==this?null:(t.parent&&t.parent.removeChild(t),t.parent=this,e._next?(e._next._prev=t,t._next=e._next):this._lastChild=t,e._next=t,t._prev=e,this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this._structEdit=!0,this.setCount(t.count),t)}},{key:"insertInto",value:function(t,e){if(!this._ignoreWarn&&this._nodeList&&Lt.getInstance().warn("insertIntoKeepIdx和insertInto混用可能会存在错误"),e>=this.childrenCount)return this.appendChild(t);if(this===t)return null;if(t.isAncestorsOf(this))throw new Error("【Node::insertBefore】不能将父辈元素insert为子元素");if(t.parent&&t.parent.removeChild(t),t.parent=this,0===e)t._next=this._firstChild,this._firstChild&&(this._firstChild._prev=t),t._prev=null,this._firstChild=t;else{for(var i=this._firstChild,n=0;n<e;n++){if(!i)return null;n>0&&(i=i._next)}if(!i)return null;t._next=i._next,t._prev=i,i._next=t,t._next&&(t._next._prev=t)}return this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this._structEdit=!0,this.setCount(t.count),t}},{key:"insertIntoKeepIdx",value:function(t,e){if(this._nodeList||(this._nodeList=this.children),this._nodeList[e]){var i=this._nodeList[e];return this._nodeList.splice(e,0,t),this.insertBefore(t,i)}var n;this._nodeList[e]=t;for(var r=e-1;r>=0&&!(n=this._nodeList[r]);r--);if(n)return n._next?this.insertBefore(t,n._next):this.appendChild(t);this._ignoreWarn=!0;var a=this.insertInto(t,0);return this._ignoreWarn=!1,a}},{key:"removeChild",value:function(t){if(!this._idMap)return null;if(!this._idMap.has(t._uid))return null;if(this._idMap.delete(t._uid),this._nodeList){var e=this._nodeList.findIndex((function(e){return e===t}));e>=0&&this._nodeList.splice(e,1)}return t._prev?t._prev._next=t._next:this._firstChild=t._next,t._next?t._next._prev=t._prev:this._lastChild=t._prev,t.parent=null,t._prev=null,t._next=null,this._structEdit=!0,this.setCount(-t.count),t}},{key:"delete",value:function(){this.parent&&this.parent.removeChild(this)}},{key:"removeAllChild",value:function(t){if(this._idMap){this._nodeList&&(this._nodeList.length=0);for(var e=this._firstChild;e;){var i=e._next;e.parent=null,e._prev=null,e._next=null,e=e._next,e=i}this._firstChild=null,this._lastChild=null,this._idMap.clear(),this._structEdit=!0,this.setCount(1-this._count)}}},{key:"replaceChild",value:function(t,e){throw new Error("暂不支持")}},{key:"find",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=null;return this.forEachChildren((function(i,r){return!(i===e||!t(i,r)||(n=i,0))})),i&&this.forEachChildren((function(e){if(e.isContainer){var i=e.find(t,!0);if(i)return n=i,!0}return!1})),n}},{key:"findAll",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[];return this.forEachChildren((function(i,r){i!==e&&t(i,r)&&n.push(i)})),i&&this.forEachChildren((function(e){if(e.isContainer){var i=e.findAll(t,!0);i.length&&(n=n.concat(i))}})),n}},{key:"getElementById",value:function(t){return this.find((function(e){return e.id===t}),!0)}},{key:"findChildById",value:function(t){return this.getElementById(t)}},{key:"findChildByUid",value:function(t){return this._idMap&&this._idMap.get(t)||null}},{key:"getElementsByName",value:function(t){return this.findAll((function(e){return e.name===t}),!0)}},{key:"findChildrenByName",value:function(t){return this.getElementsByName(t)}},{key:"getElementsByType",value:function(t){return this.findAll((function(e){return e.type===t}),!0)}},{key:"getChildByName",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.find((function(e){return e.name===t}),e)}},{key:"getChildAt",value:function(t){var e=this._firstChild;if(!e)return null;for(var i=0;i<t;i++){if(!e._next)return null;e=e._next}return e}},{key:"at",value:function(t){return this.getChildAt(t)}},{key:"containNode",value:function(t){if(!this._idMap)return!1;if(this._idMap.has(t._uid))return!0;for(var e=this._firstChild;e;){if(e.containNode(t))return!0;e=e._next}return!1}},{key:"getRootNode",value:function(){for(var t=this.parent;null==t?void 0:t.parent;)t=t.parent;return t||this}},{key:"hasChildNodes",value:function(){return null!==this._firstChild}},{key:"addChild",value:function(t){return this.appendChild(t)}},{key:"add",value:function(t){return this.appendChild(t)}},{key:"getChildren",value:function(){for(var t=[],e=this._firstChild;e;)t.push(e),e=e._next;return t}},{key:"isChildOf",value:function(t){return!!this.parent&&this.parent._uid===t._uid}},{key:"isParentOf",value:function(t){return t.isChildOf(this)}},{key:"isDescendantsOf",value:function(t){var e=this.parent;if(!e)return!1;do{if(e._uid===t._uid)return!0;e=e.parent}while(null!==e);return!1}},{key:"isAncestorsOf",value:function(t){return t.isDescendantsOf(this)}},{key:"getAncestor",value:function(t){throw new Error("暂不支持")}},{key:"setAllDescendantsProps",value:function(t,e){for(var i=this._firstChild;i;)i[t]=e,i.setAllDescendantsProps(t,e),i=i._next}},{key:"setCount",value:function(t){this._count+=t;var e=this.parent;if(e)do{e._count+=t,e=e.parent}while(null!==e)}},{key:"clone",value:function(){throw new Error("暂不支持")}},{key:"cloneTo",value:function(t){throw new Error("暂不支持")}},{key:"getParent",value:function(){return this.parent}},{key:"del",value:function(t){return this.removeChild(t)}},{key:"addEventListener",value:function(t,i,n){var r=z(n,!0)&&n||V(n)&&n.capture,a=V(n)&&n.once,o=H(i)?void 0:i;return t=r?"".concat(t,"capture"):t,i=H(i)?i:i.handleEvent,a?y(e,"once",this,3)([t,i,o]):y(e,"on",this,3)([t,i,o]),this}},{key:"on",value:function(t,e,i){return this.addEventListener(t,e,i)}},{key:"removeEventListener",value:function(t,i,n){var r=z(n,!0)&&n||V(n)&&n.capture,a=H(i)?void 0:i;t=r?"".concat(t,"capture"):t,i=H(i)?i:i.handleEvent;var o=V(n)&&n.once;return y(e,"off",this,3)([t,i,a,o]),this}},{key:"off",value:function(t,e,i){return this.removeEventListener(t,e,i)}},{key:"once",value:function(t,e,i){return V(i)?(i.once=!0,this.addEventListener(t,e,i)):this.addEventListener(t,e,{once:!0})}},{key:"removeAllEventListeners",value:function(){return y(e,"removeAllListeners",this,3)([]),this}},{key:"removeAllListeners",value:function(){return this.removeAllEventListeners()}},{key:"dispatchEvent",value:function(t){for(var i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];return y(e,"emit",this,3)([t.type,t].concat(n)),!t.defaultPrevented}},{key:"emit",value:function(t,e){return this.dispatchEvent(t,e)}},{key:"release",value:function(){this.removeAllListeners()}}])}(O),Ah=function(){return o((function t(e){r(this,t),this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=t.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer={x:0,y:0},this.page={x:0,y:0},this.canvas={x:0,y:0},this.viewport={x:0,y:0},this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}),[{key:"layerX",get:function(){return this.layer.x}},{key:"layerY",get:function(){return this.layer.y}},{key:"pageX",get:function(){return this.page.x}},{key:"pageY",get:function(){return this.page.y}},{key:"x",get:function(){return this.canvas.x}},{key:"y",get:function(){return this.canvas.y}},{key:"canvasX",get:function(){return this.canvas.x}},{key:"canvasY",get:function(){return this.canvas.y}},{key:"viewX",get:function(){return this.viewport.x}},{key:"viewY",get:function(){return this.viewport.y}},{key:"composedPath",value:function(){return!this.manager||this.path&&this.path[this.path.length-1]===this.target||(this.path=this.target?this.manager.propagationPath(this.target):[]),this.composedDetailPath(),this.path}},{key:"composedDetailPath",value:function(){return this.pickParams&&this.pickParams.graphic?(this.detailPath=this.path.slice(),this._composedDetailPath(this.pickParams)):this.detailPath=this.path.slice(),this.detailPath}},{key:"_composedDetailPath",value:function(t){if(t&&t.graphic){var e=t.graphic;if(e.stage){var i=e.stage.eventSystem.manager.propagationPath(e);this.detailPath.push(i),this._composedDetailPath(t.params)}}}},{key:"preventDefault",value:function(){try{this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault()}catch(t){this.nativeEvent.preventDefault&&H(this.nativeEvent.preventDefault)&&this.nativeEvent.preventDefault()}this.defaultPrevented=!0}},{key:"stopImmediatePropagation",value:function(){this.propagationImmediatelyStopped=!0}},{key:"stopPropagation",value:function(){try{this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.stopPropagation()}catch(t){this.nativeEvent.stopPropagation&&H(this.nativeEvent.stopPropagation)&&this.nativeEvent.stopPropagation()}this.propagationStopped=!0}},{key:"initEvent",value:function(){}},{key:"initUIEvent",value:function(){}},{key:"clone",value:function(){throw new Error("Method not implemented.")}}])}(),Mh=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).client={x:0,y:0},t.movement={x:0,y:0},t.offset={x:0,y:0},t.global={x:0,y:0},t.screen={x:0,y:0},t}return h(e,t),o(e,[{key:"clientX",get:function(){return this.client.x}},{key:"clientY",get:function(){return this.client.y}},{key:"movementX",get:function(){return this.movement.x}},{key:"movementY",get:function(){return this.movement.y}},{key:"offsetX",get:function(){return this.offset.x}},{key:"offsetY",get:function(){return this.offset.y}},{key:"globalX",get:function(){return this.global.x}},{key:"globalY",get:function(){return this.global.y}},{key:"screenX",get:function(){return this.screen.x}},{key:"screenY",get:function(){return this.screen.y}},{key:"getModifierState",value:function(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}},{key:"initMouseEvent",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d,p,f){throw new Error("Method not implemented.")}}])}(Ah),wh=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).width=0,t.height=0,t.isPrimary=!1,t}return h(e,t),o(e,[{key:"getCoalescedEvents",value:function(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]}},{key:"getPredictedEvents",value:function(){throw new Error("getPredictedEvents is not supported!")}},{key:"clone",value:function(){var t,i,n,r=new e(this.manager);r.eventPhase=r.NONE,r.currentTarget=null,r.path=[],r.detailPath=[],r.target=null,r.nativeEvent=this.nativeEvent,r.originalEvent=this.originalEvent,null===(t=this.manager)||void 0===t||t.copyPointerData(this,r),null===(i=this.manager)||void 0===i||i.copyMouseData(this,r),null===(n=this.manager)||void 0===n||n.copyData(this,r),r.target=this.target,r.path=this.composedPath().slice();var a=this.composedDetailPath();return r.detailPath=a&&a.slice(),r.type=this.type,r}}])}(Mh),Th=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).DOM_DELTA_PIXEL=0,t.DOM_DELTA_LINE=1,t.DOM_DELTA_PAGE=2,t}return h(e,t),o(e,[{key:"clone",value:function(){var t,i,n,r=new e(this.manager);r.eventPhase=r.NONE,r.currentTarget=null,r.path=[],r.detailPath=[],r.target=null,r.nativeEvent=this.nativeEvent,r.originalEvent=this.originalEvent,null===(t=this.manager)||void 0===t||t.copyWheelData(this,r),null===(i=this.manager)||void 0===i||i.copyMouseData(this,r),null===(n=this.manager)||void 0===n||n.copyData(this,r),r.target=this.target,r.path=this.composedPath().slice();var a=this.composedDetailPath();return r.detailPath=a&&a.slice(),r.type=this.type,r}}])}(Mh);Th.DOM_DELTA_PIXEL=0,Th.DOM_DELTA_LINE=1,Th.DOM_DELTA_PAGE=2;var Ch=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e)).type=t,a.detail=i,a}return h(e,t),o(e)}(Ah),Eh="object"==("undefined"==typeof performance?"undefined":b(performance))&&performance.now?performance:Date;function Ph(t){return"mouse"===t||"pen"===t}var Rh,Bh=function(){return o((function t(e,i){var n=this;r(this,t),this.dispatch=new O,this.cursorTarget=null,this.pauseNotify=!1,this.mappingState={trackingData:{}},this.eventPool=new Map,this.onPointerDown=function(t,e){if(t instanceof wh){var i=n.createPointerEvent(t,t.type,e);if(n.dispatchEvent(i,"pointerdown"),"touch"===i.pointerType)n.dispatchEvent(i,"touchstart");else if(Ph(i.pointerType)){var r=2===i.button;n.dispatchEvent(i,r?"rightdown":"mousedown")}n.trackingData(t.pointerId).pressTargetsByButton[t.button]=i.composedPath(),n.freeEvent(i)}else Lt.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event")},this.onPointerMove=function(t,e){var i,r;if(t instanceof wh){var a=n.createPointerEvent(t,t.type,e),o=Ph(a.pointerType),s=n.trackingData(t.pointerId),l=n.findMountedTarget(s.overTargets);if(s.overTargets&&l&&l!==n.rootTarget&&l!==a.target){var u="mousemove"===t.type?"mouseout":"pointerout",c=n.createPointerEvent(t,u,l||void 0);if(n.dispatchEvent(c,"pointerout"),o&&n.dispatchEvent(c,"mouseout"),!a.composedPath().includes(l)){var h=n.createPointerEvent(t,"pointerleave",l||void 0);for(h.eventPhase=h.AT_TARGET;h.target&&!a.composedPath().includes(h.target);)h.currentTarget=h.target,n.notifyTarget(h),o&&n.notifyTarget(h,"mouseleave"),h.target=h.target.parent;n.freeEvent(h)}n.freeEvent(c)}if(l!==a.target){var d="mousemove"===t.type?"mouseover":"pointerover",p=n.clonePointerEvent(a,d);n.dispatchEvent(p,"pointerover"),o&&n.dispatchEvent(p,"mouseover");for(var f=null==l?void 0:l.parent;f&&f!==n.rootTarget.parent&&f!==a.target;)f=f.parent;if(!f||f===n.rootTarget.parent){var v=n.clonePointerEvent(a,"pointerenter");v.eventPhase=v.AT_TARGET;for(var g=v.target,y=new Set,m=l;m&&m!==n.rootTarget;)y.add(m),m=m.parent;for(;g&&g!==l&&g!==n.rootTarget.parent;)y.has(g)||(v.currentTarget=g,n.notifyTarget(v),o&&n.notifyTarget(v,"mouseenter")),g=g.parent;n.freeEvent(v)}n.freeEvent(p)}n.dispatchEvent(a,"pointermove"),"touch"===a.pointerType&&n.dispatchEvent(a,"touchmove"),o&&(n.dispatchEvent(a,"mousemove"),n.cursorTarget=a.target,n.cursor=(null===(r=null===(i=a.target)||void 0===i?void 0:i.attribute)||void 0===r?void 0:r.cursor)||n.rootTarget.getCursor()),s.overTargets=a.composedPath(),n.freeEvent(a)}else Lt.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event")},this.onPointerOver=function(t,e){var i,r;if(t instanceof wh){var a=n.trackingData(t.pointerId),o=n.createPointerEvent(t,t.type,e),s=Ph(o.pointerType);n.dispatchEvent(o,"pointerover"),s&&n.dispatchEvent(o,"mouseover"),"mouse"===o.pointerType&&(n.cursorTarget=o.target,n.cursor=(null===(r=null===(i=o.target)||void 0===i?void 0:i.attribute)||void 0===r?void 0:r.cursor)||n.rootTarget.getCursor());var l=n.clonePointerEvent(o,"pointerenter");for(l.eventPhase=l.AT_TARGET;l.target&&l.target!==n.rootTarget.parent;)l.currentTarget=l.target,n.notifyTarget(l),s&&n.notifyTarget(l,"mouseenter"),l.target=l.target.parent;a.overTargets=o.composedPath(),n.freeEvent(o),n.freeEvent(l)}else Lt.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event")},this.onPointerOut=function(t,e){if(t instanceof wh){var i=n.trackingData(t.pointerId);if(i.overTargets){var r=Ph(t.pointerType),a=n.findMountedTarget(i.overTargets),o=n.createPointerEvent(t,"pointerout",a||void 0);n.dispatchEvent(o),r&&n.dispatchEvent(o,"mouseout");var s=n.createPointerEvent(t,"pointerleave",a||void 0);for(s.eventPhase=s.AT_TARGET;s.target&&s.target!==n.rootTarget.parent;)s.currentTarget=s.target,n.notifyTarget(s),r&&n.notifyTarget(s,"mouseleave"),s.target=s.target.parent;i.overTargets=[],n.freeEvent(o),n.freeEvent(s)}n.cursorTarget=null,n.cursor=""}else Lt.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event")},this.onPointerUp=function(t,e){var i;if(t instanceof wh){var r=Eh.now(),a=n.createPointerEvent(t,t.type,e);if(n.dispatchEvent(a,"pointerup"),"touch"===a.pointerType)n.dispatchEvent(a,"touchend");else if(Ph(a.pointerType)){var o=2===a.button;n.dispatchEvent(a,o?"rightup":"mouseup")}var s=n.trackingData(t.pointerId),l=n.findMountedTarget(s.pressTargetsByButton[t.button]),u=l;if(l&&!a.composedPath().includes(l)){for(var c=l;c&&!a.composedPath().includes(c);){if(a.currentTarget=c,n.notifyTarget(a,"pointerupoutside"),"touch"===a.pointerType)n.notifyTarget(a,"touchendoutside");else if(Ph(a.pointerType)){var h=2===a.button;n.notifyTarget(a,h?"rightupoutside":"mouseupoutside")}c=c.parent}delete s.pressTargetsByButton[t.button],u=c}if(u){var d=n.clonePointerEvent(a,"click");d.target=u,d.path=[],d.detailPath=[],s.clicksByButton[t.button]||(s.clicksByButton[t.button]={clickCount:0,target:d.target,timeStamp:r});var p=s.clicksByButton[t.button];p.target===d.target&&r-p.timeStamp<(null!==(i=n._config.clickInterval)&&void 0!==i?i:200)?++p.clickCount:p.clickCount=1,p.target=d.target,p.timeStamp=r,d.detail=p.clickCount,Ph(d.pointerType)?(n.dispatchEvent(d,"click"),2===p.clickCount&&n.dispatchEvent(d,"dblclick")):"touch"===d.pointerType&&n._config.supportsTouchEvents&&(n.dispatchEvent(d,"tap"),2===p.clickCount&&n.dispatchEvent(d,"dbltap")),n.dispatchEvent(d,"pointertap"),n.freeEvent(d)}n.freeEvent(a)}else Lt.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event")},this.onPointerUpOutside=function(t,e){if(t instanceof wh){var i=n.trackingData(t.pointerId),r=n.findMountedTarget(i.pressTargetsByButton[t.button]),a=n.createPointerEvent(t,t.type,e);if(r){for(var o=r;o;)a.currentTarget=o,n.notifyTarget(a,"pointerupoutside"),"touch"===a.pointerType?n.notifyTarget(a,"touchendoutside"):Ph(a.pointerType)&&n.notifyTarget(a,2===a.button?"rightupoutside":"mouseupoutside"),o=o.parent;delete i.pressTargetsByButton[t.button]}n.freeEvent(a)}else Lt.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event")},this.onWheel=function(t,e){if(t instanceof Th){var i=n.createWheelEvent(t,e);n.dispatchEvent(i),n.freeEvent(i)}else Lt.getInstance().warn("EventManager cannot map a non-wheel event as a wheel event")},this.rootTarget=e,this.mappingTable={},this._config=Object.assign({clickInterval:200},i),this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel)}),[{key:"addEventMapping",value:function(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort((function(t,e){return t.priority-e.priority}))}},{key:"dispatchEvent",value:function(t,e){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e),this.dispatch.emit(e||t.type,t)}},{key:"mapEvent",value:function(t){var e,i,n,r,a,o,s;if(this.rootTarget){var u,c=this.mappingTable[t.type],h="".concat(t.canvasX,"-").concat(t.canvasY);if((null===(e=this._prePointTargetCache)||void 0===e?void 0:e[h])&&(null===(n=null===(i=this._prePointTargetCache)||void 0===i?void 0:i[h])||void 0===n?void 0:n.stage)&&(null===(a=null===(r=this._prePointTargetCache)||void 0===r?void 0:r[h])||void 0===a?void 0:a.stage.renderCount)===(null===(o=this._prePointTargetCache)||void 0===o?void 0:o.stageRenderCount)?u=this._prePointTargetCache[h]:(u=this.pickTarget(t.viewX,t.viewY,t),t.pickParams||(this._prePointTargetCache=l(l({},h,u),"stageRenderCount",null!==(s=null==u?void 0:u.stage.renderCount)&&void 0!==s?s:-1))),c)for(var d=0,p=c.length;d<p;d++)c[d].fn(t,u);else Lt.getInstance().warn("[EventManager]: Event mapping not defined for ".concat(t.type))}}},{key:"propagate",value:function(t,e){if(t.target){var i=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(var n=0,r=i.length-1;n<r;n++)if(t.currentTarget=i[n],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!t.propagationStopped&&!t.propagationImmediatelyStopped){t.eventPhase=t.BUBBLING_PHASE;for(var a=i.length-2;a>=0;a--)if(t.currentTarget=i[a],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}}},{key:"propagationPath",value:function(t){for(var e=[t],i=0;i<2048&&t!==this.rootTarget&&t.parent;i++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");e.push(t.parent),t=t.parent}return e.reverse(),e}},{key:"notifyTarget",value:function(t,e){if(!this.pauseNotify){e=null!=e?e:t.type;var i=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?"".concat(e,"capture"):e;this.notifyListeners(t,i),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}}},{key:"findMountedTarget",value:function(t){if(!t)return null;for(var e=t[0],i=1;i<t.length&&t[i].parent===e;i++)e=t[i];return e}},{key:"createPointerEvent",value:function(t,e,i){var n,r,a=this.allocateEvent(wh);return this.copyPointerData(t,a),this.copyMouseData(t,a),this.copyData(t,a),a.nativeEvent=t.nativeEvent,a.originalEvent=t,a.target=i||this.pickTarget(null!==(n=a.viewX)&&void 0!==n?n:a.global.x,null!==(r=a.viewY)&&void 0!==r?r:a.global.y,a),"string"==typeof e&&(a.type=e),a}},{key:"createWheelEvent",value:function(t,e){var i,n,r=this.allocateEvent(Th);return this.copyWheelData(t,r),this.copyMouseData(t,r),this.copyData(t,r),r.nativeEvent=t.nativeEvent,r.originalEvent=t,r.target=e||this.pickTarget(null!==(i=r.viewX)&&void 0!==i?i:r.global.x,null!==(n=r.viewY)&&void 0!==n?n:r.global.y,r),r}},{key:"clonePointerEvent",value:function(t,e){var i=this.allocateEvent(wh);i.nativeEvent=t.nativeEvent,i.originalEvent=t.originalEvent,this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.target=t.target,i.path=t.composedPath().slice();var n=t.composedDetailPath();return i.detailPath=n&&n.slice(),i.type=null!=e?e:i.type,i}},{key:"copyWheelData",value:function(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}},{key:"copyPointerData",value:function(t,e){t instanceof wh&&e instanceof wh&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)}},{key:"copyMouseData",value:function(t,e){t instanceof Mh&&e instanceof Mh&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.ctrlKey=t.ctrlKey,e.shiftKey=t.shiftKey,e.metaKey=t.metaKey,["client","movement","canvas","screen","global","offset","viewport"].forEach((function(i){e[i].x=t[i].x,e[i].y=t[i].y})))}},{key:"copyData",value:function(t,e){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=Eh.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.which=t.which,e.layer.x=t.layer.x,e.layer.y=t.layer.y,e.page.x=t.page.x,e.page.y=t.page.y,e.pickParams=t.pickParams}},{key:"trackingData",value:function(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}},{key:"allocateEvent",value:function(t){var e;this.eventPool.has(t)||this.eventPool.set(t,[]);var i=(null===(e=this.eventPool.get(t))||void 0===e?void 0:e.pop())||new t(this);return i.eventPhase=i.NONE,i.currentTarget=null,i.path=[],i.detailPath=[],i.target=null,i}},{key:"freeEvent",value:function(t){var e;if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventManager!");var i=t.constructor;this.eventPool.has(i)||this.eventPool.set(i,[]),null===(e=this.eventPool.get(i))||void 0===e||e.push(t)}},{key:"notifyListeners",value:function(t,e){var i=t.currentTarget._events[e];if(i)if("fn"in i)i.once&&t.currentTarget.removeEventListener(e,i.fn,{once:!0}),i.fn.call(i.context,t);else for(var n=0,r=i.length;n<r&&!t.propagationImmediatelyStopped;n++)i[n].once&&t.currentTarget.removeEventListener(e,i[n].fn,{once:!0}),i[n].fn.call(i[n].context,t);this.emitDelegation(t,e)}},{key:"emitDelegation",value:function(t,e){var i=t.currentTarget._events["*"];if(i)if("fn"in i)i.fn.call(i.context,t,e);else for(var n=0,r=i.length;n<r&&!t.propagationImmediatelyStopped;n++)i[n].fn.call(i[n].context,t,e)}},{key:"pickTarget",value:function(t,e,i){var n,r=this.rootTarget.pick(t,e);return n=r&&r.graphic?r.graphic:r&&r.group?r.group:this.rootTarget.AABBBounds.contains(t,e)?this.rootTarget:null,i&&(i.pickParams=r.params),n}},{key:"release",value:function(){this.dispatch.removeAllListeners(),this.eventPool.clear(),this.rootTarget=null,this.mappingTable=null,this.mappingState=null,this.cursorTarget=null}}])}(),Ih={dispatchEvent:function(t){var e;if(!(t instanceof Ah))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return t.defaultPrevented=!1,t.path=[],t.detailPath&&(t.detailPath=[]),t.target=this,null===(e=null==t?void 0:t.manager)||void 0===e||e.dispatchEvent(t),!t.defaultPrevented},emit:function(t,e){return this.dispatchEvent(new Ch(t,e))}},Lh={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},Dh=function(){return o((function t(e){var i=this;r(this,t),this.resolution=1,this.onPointerDown=function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){var e=i.normalizeToPointerData(t);i.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(var n=0,r=e.length;n<r;n++){var a=e[n],o=i.bootstrapEvent(i.rootPointerEvent,a);i.manager.mapEvent(o)}i.setCursor(i.manager.cursor,i.manager.cursorTarget),i.rootPointerEvent.nativeEvent=null}},this.onPointerMove=function(t){if(!(i.supportsTouchEvents&&"touch"===t.pointerType||i.isEventOutsideOfTargetElement(t))){for(var e=i.normalizeToPointerData(t),n=0,r=e.length;n<r;n++){var a=i.bootstrapEvent(i.rootPointerEvent,e[n]);i.manager.mapEvent(a)}i.setCursor(i.manager.cursor,i.manager.cursorTarget),i.rootPointerEvent.nativeEvent=null}},this.onPointerUp=function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){for(var e=i.isEventOutsideOfTargetViewPort(t)?"outside":"",n=i.normalizeToPointerData(t),r=0,a=n.length;r<a;r++){var o=i.bootstrapEvent(i.rootPointerEvent,n[r]);o.type+=e,i.manager.mapEvent(o)}i.setCursor(i.manager.cursor,i.manager.cursorTarget),i.rootPointerEvent.nativeEvent=null}},this.onPointerOverOut=function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){for(var e=i.normalizeToPointerData(t),n=0,r=e.length;n<r;n++){var a=i.bootstrapEvent(i.rootPointerEvent,e[n]);i.manager.mapEvent(a)}i.setCursor(i.manager.cursor,i.manager.cursorTarget),i.rootPointerEvent.nativeEvent=null}},this.onWheel=function(t){var e=i.normalizeWheelEvent(t);i.manager.mapEvent(e)};var n=e.targetElement,a=e.resolution,o=e.rootNode,s=e.global,l=e.autoPreventDefault,u=void 0!==l&&l,c=e.clickInterval,h=e.supportsTouchEvents,d=void 0===h?s.supportsTouchEvents:h,p=e.supportsPointerEvents,f=void 0===p?s.supportsPointerEvents:p;this.manager=new Bh(o,{clickInterval:c,supportsTouchEvents:d}),this.globalObj=s,this.supportsPointerEvents=f,this.supportsTouchEvents=d,this.supportsMouseEvents=s.supportsMouseEvents,this.applyStyles=s.applyStyles,this.autoPreventDefault=u,this.eventsAdded=!1,this.rootPointerEvent=new wh,this.rootWheelEvent=new Th,this.cursorStyles={default:"inherit",pointer:"pointer"},this.resolution=a,this.setTargetElement(n)}),[{key:"release",value:function(){this.removeEvents(),this.manager&&this.manager.release(),this.domElement=null,this.manager=null,this.globalObj=null}},{key:"setCursor",value:function(t,e){if(e||this.manager.rootTarget.window._handler.canvas.controled){t||(t="default");var i=this.applyStyles,n=this.domElement;if(this.currentCursor!==t){this.currentCursor=t;var r=this.cursorStyles[t];r?"string"==typeof r&&i?n.style.cursor=r:"function"==typeof r?r(t):"object"==b(r)&&i&&Object.assign(n.style,r):i&&Y(t)&&!ut(this.cursorStyles,t)&&(n.style.cursor=t)}}}},{key:"setTargetElement",value:function(t){this.removeEvents(),this.domElement=t,this.addEvents()}},{key:"addEvents",value:function(){if(!this.eventsAdded&&this.domElement){var t=this.globalObj,e=this.domElement;this.supportsPointerEvents?(t.getDocument()?(t.getDocument().addEventListener("pointermove",this.onPointerMove,!0),t.getDocument().addEventListener("pointerup",this.onPointerUp,!0)):(e.addEventListener("pointermove",this.onPointerMove,!0),e.addEventListener("pointerup",this.onPointerUp,!0)),e.addEventListener("pointerdown",this.onPointerDown,!0),e.addEventListener("pointerleave",this.onPointerOverOut,!0),e.addEventListener("pointerover",this.onPointerOverOut,!0)):(t.getDocument()?(t.getDocument().addEventListener("mousemove",this.onPointerMove,!0),t.getDocument().addEventListener("mouseup",this.onPointerUp,!0)):(e.addEventListener("mousemove",this.onPointerMove,!0),e.addEventListener("mouseup",this.onPointerUp,!0)),e.addEventListener("mousedown",this.onPointerDown,!0),e.addEventListener("mouseout",this.onPointerOverOut,!0),e.addEventListener("mouseover",this.onPointerOverOut,!0)),this.supportsTouchEvents&&(e.addEventListener("touchstart",this.onPointerDown,!0),e.addEventListener("touchend",this.onPointerUp,!0),e.addEventListener("touchmove",this.onPointerMove,!0)),e.addEventListener("wheel",this.onWheel,{capture:!0}),this.eventsAdded=!0}}},{key:"removeEvents",value:function(){var t;if(this.eventsAdded&&this.domElement){var e=this.globalObj,i=this.domElement,n=null!==(t=e.getDocument())&&void 0!==t?t:i;this.supportsPointerEvents?(n.removeEventListener("pointermove",this.onPointerMove,!0),n.removeEventListener("pointerup",this.onPointerUp,!0),i.removeEventListener("pointerdown",this.onPointerDown,!0),i.removeEventListener("pointerleave",this.onPointerOverOut,!0),i.removeEventListener("pointerover",this.onPointerOverOut,!0)):(n.removeEventListener("mousemove",this.onPointerMove,!0),n.removeEventListener("mouseup",this.onPointerUp,!0),i.removeEventListener("mousedown",this.onPointerDown,!0),i.removeEventListener("mouseout",this.onPointerOverOut,!0),i.removeEventListener("mouseover",this.onPointerOverOut,!0)),this.supportsTouchEvents&&(i.removeEventListener("touchstart",this.onPointerDown,!0),i.removeEventListener("touchend",this.onPointerUp,!0),i.removeEventListener("touchmove",this.onPointerMove,!0)),i.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}}},{key:"mapToViewportPoint",value:function(t){return this.domElement.pointTransform?this.domElement.pointTransform(t.x,t.y):t}},{key:"mapToCanvasPoint",value:function(t){var e,i,n=null===(e=this.globalObj)||void 0===e?void 0:e.mapToCanvasPoint(t,this.domElement);if(n)return n;var r=0,a=0;if(t.changedTouches){var o=null!==(i=t.changedTouches[0])&&void 0!==i?i:{};r=o.clientX||0,a=o.clientY||0}else r=t.clientX||0,a=t.clientY||0;var s=this.domElement.getBoundingClientRect();return{x:r-s.left,y:a-s.top}}},{key:"normalizeToPointerData",value:function(t){var e=[];if(this.supportsTouchEvents&&t.changedTouches&&t.changedTouches.length)for(var i=0,n=t.changedTouches.length;i<n;i++){var r=t.changedTouches[i];U(r.button)&&(r.button=0),U(r.buttons)&&(r.buttons=1),U(r.isPrimary)&&(r.isPrimary=1===t.touches.length&&"touchstart"===t.type),U(r.width)&&(r.width=r.radiusX||1),U(r.height)&&(r.height=r.radiusY||1),U(r.tiltX)&&(r.tiltX=0),U(r.tiltY)&&(r.tiltY=0),U(r.pointerType)&&(r.pointerType="touch"),U(r.pointerId)&&(r.pointerId=r.identifier||0),U(r.pressure)&&(r.pressure=r.force||.5),U(r.twist)&&(r.twist=0),U(r.tangentialPressure)&&(r.tangentialPressure=0),U(r.layerX)&&(r.layerX=r.offsetX=r.clientX),U(r.layerY)&&(r.layerY=r.offsetY=r.clientY),r.isNormalized=!0,r.type=t.type,e.push(r)}else if(!this.globalObj.supportsMouseEvents||t instanceof MouseEvent&&!(this.supportsPointerEvents&&t instanceof PointerEvent)){var a=t;U(a.isPrimary)&&(a.isPrimary=!0),U(a.width)&&(a.width=1),U(a.height)&&(a.height=1),U(a.tiltX)&&(a.tiltX=0),U(a.tiltY)&&(a.tiltY=0),U(a.pointerType)&&(a.pointerType="mouse"),U(a.pointerId)&&(a.pointerId=1),U(a.pressure)&&(a.pressure=.5),U(a.twist)&&(a.twist=0),U(a.tangentialPressure)&&(a.tangentialPressure=0),a.isNormalized=!0,e.push(a)}else e.push(t);return e}},{key:"normalizeWheelEvent",value:function(t){var e=this.rootWheelEvent;this.transferMouseData(e,t),e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;var i=this.mapToCanvasPoint(t),n=i.x,r=i.y;e.canvas.x=n,e.canvas.y=r,e.global.x=n,e.global.y=r,e.offset.x=n,e.offset.y=r;var a=this.mapToViewportPoint(e),o=a.x,s=a.y;return e.viewport.x=o,e.viewport.y=s,e.nativeEvent=t,e.type=t.type,e}},{key:"bootstrapEvent",value:function(t,e){t.originalEvent=null,t.nativeEvent=e,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);var i=this.mapToCanvasPoint(e),n=i.x,r=i.y;t.canvas.x=n,t.canvas.y=r,t.global.x=n,t.global.y=r,t.offset.x=n,t.offset.y=r;var a=this.mapToViewportPoint(t),o=a.x,s=a.y;return t.viewport.x=o,t.viewport.y=s,t.isTrusted=e.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=Lh[t.type]||t.type),t}},{key:"transferMouseData",value:function(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=Eh.now(),t.type=e.type,t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.ctrlKey=e.ctrlKey,t.shiftKey=e.shiftKey,t.metaKey=e.metaKey,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.relatedTarget=null}},{key:"isEventOutsideOfTargetViewPort",value:function(t){if(this.isEventOutsideOfTargetElement(t))return!0;if(this.domElement.getViewBox){var e=this.mapToViewportPoint(this.mapToCanvasPoint(t)),i=this.domElement.getViewBox(),n=i.width(),r=i.height();return!(e.x<n&&e.y<r&&e.x>0&&e.y>0)}return!1}},{key:"isEventOutsideOfTargetElement",value:function(t){var e=t.target;return t.composedPath&&t.composedPath().length>0&&(e=t.composedPath()[0]),e!==(this.domElement.getNativeHandler?this.domElement.getNativeHandler().nativeCanvas:this.domElement)}},{key:"pauseTriggerEvent",value:function(){this.manager.pauseNotify=!0}},{key:"resumeTriggerEvent",value:function(){this.manager.pauseNotify=!1}}])}();!function(t){t[t.INITIAL=0]="INITIAL",t[t.RUNNING=1]="RUNNING",t[t.PAUSE=2]="PAUSE"}(Rh||(Rh={}));var Oh=function(){function t(){r(this,t)}return o(t,[{key:"avaliable",value:function(){return t.Avaliable()}},{key:"tick",value:function(t,e){var i=this;nc.global.getRequestAnimationFrame()((function(){i.released||e(i)}))}},{key:"release",value:function(){this.released=!0}},{key:"getTime",value:function(){return Date.now()}}],[{key:"Avaliable",value:function(){return!!nc.global.getRequestAnimationFrame()}}])}(),Fh=function(){function t(){r(this,t)}return o(t,[{key:"avaliable",value:function(){return t.Avaliable()}},{key:"tick",value:function(t,e){var i=this;this.timerId=setTimeout((function(){e(i)}),t)}},{key:"release",value:function(){this.timerId>0&&(clearTimeout(this.timerId),this.timerId=-1)}},{key:"getTime",value:function(){return Date.now()}}],[{key:"Avaliable",value:function(){return!0}}])}(),zh=function(t){function e(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return r(this,e),(t=n(this,e)).handleTick=function(e,i){var n=(null!=i?i:{}).once,r=void 0!==n&&n;t.ifCanStop()?t.stop():(t._handlerTick(),r||e.tick(t.interval,t.handleTick))},t._handlerTick=function(){var e=t.tickerHandler.getTime(),i=0;t.lastFrameTime>=0&&(i=e-t.lastFrameTime),t.lastFrameTime=e,t.status===Rh.RUNNING&&(t.tickCounts++,t.timelines.forEach((function(t){t.tick(i)})),t.emit("tick"))},t.init(),t.lastFrameTime=-1,t.tickCounts=0,t.timelines=i,t.autoStop=!0,t}return h(e,t),o(e,[{key:"mode",get:function(){return this._mode},set:function(t){this._mode!==t&&(this._mode=t,this.setupTickHandler())}},{key:"init",value:function(){var t=this;this.interval=NaN,this.status=Rh.INITIAL,nc.global.hooks.onSetEnv.tap("default-ticker",(function(){t.initHandler()})),nc.global.env&&this.initHandler()}},{key:"addTimeline",value:function(t){this.timelines.push(t)}},{key:"remTimeline",value:function(t){this.timelines=this.timelines.filter((function(e){return e!==t}))}},{key:"getTimelines",value:function(){return this.timelines}},{key:"initHandler",value:function(){if(this._mode)return null;for(var t=[{mode:"raf",cons:Oh},{mode:"timeout",cons:Fh}],e=0;e<t.length;e++)if(t[e].cons.Avaliable()){this.mode=t[e].mode;break}return null}},{key:"setupTickHandler",value:function(){var t;switch(this._mode){case"raf":t=new Oh;break;case"timeout":t=new Fh;break;default:Lt.getInstance().warn("非法的计时器模式"),t=new Oh}return!!t.avaliable()&&(this.tickerHandler&&this.tickerHandler.release(),this.tickerHandler=t,!0)}},{key:"setInterval",value:function(t){this.interval=t}},{key:"getInterval",value:function(){return this.interval}},{key:"setFPS",value:function(t){this.setInterval(1e3/t)}},{key:"getFPS",value:function(){return 1e3/this.interval}},{key:"tick",value:function(t){var e=this;this.tickerHandler.tick(t,(function(t){e.handleTick(t,{once:!0})}))}},{key:"tickTo",value:function(t){var e=this;this.tickerHandler.tickTo&&this.tickerHandler.tickTo(t,(function(t){e.handleTick(t,{once:!0})}))}},{key:"pause",value:function(){return this.status!==Rh.INITIAL&&(this.status=Rh.PAUSE,!0)}},{key:"resume",value:function(){return this.status!==Rh.INITIAL&&(this.status=Rh.RUNNING,!0)}},{key:"ifCanStop",value:function(){if(this.autoStop){if(!this.timelines.length)return!0;if(0===this.timelines.reduce((function(t,e){return t+e.animateCount}),0))return!0}return!1}},{key:"start",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.status===Rh.RUNNING)return!1;if(!this.tickerHandler)return!1;if(!t){if(this.status===Rh.PAUSE)return!1;if(!this.timelines.length)return!1;if(0===this.timelines.reduce((function(t,e){return t+e.animateCount}),0))return!1}return this.status=Rh.RUNNING,this.tickerHandler.tick(0,this.handleTick),!0}},{key:"stop",value:function(){this.status=Rh.INITIAL,this.setupTickHandler(),this.lastFrameTime=-1}},{key:"release",value:function(){this.stop(),this.timelines=[],this.tickerHandler.release(),this.emit("afterTick")}},{key:"trySyncTickStatus",value:function(){this.status===Rh.RUNNING&&this._handlerTick()}}])}(O),Hh=function(){function t(){r(this,t)}return o(t,null,[{key:"linear",value:function(t){return t}},{key:"none",value:function(){return this.linear}},{key:"get",value:function(t){return t<-1?t=-1:t>1&&(t=1),function(e){return 0===t?e:t<0?e*(e*-t+1+t):e*((2-e)*t+(1-t))}}},{key:"getPowIn",value:function(t){return function(e){return Math.pow(e,t)}}},{key:"getPowOut",value:function(t){return function(e){return 1-Math.pow(1-e,t)}}},{key:"getPowInOut",value:function(t){return function(e){return(e*=2)<1?.5*Math.pow(e,t):1-.5*Math.abs(Math.pow(2-e,t))}}},{key:"getBackIn",value:function(t){return function(e){return e*e*((t+1)*e-t)}}},{key:"getBackOut",value:function(t){return function(e){return--e*e*((t+1)*e+t)+1}}},{key:"getBackInOut",value:function(t){return t*=1.525,function(e){return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}}},{key:"sineIn",value:function(t){return 1-Math.cos(t*Math.PI/2)}},{key:"sineOut",value:function(t){return Math.sin(t*Math.PI/2)}},{key:"sineInOut",value:function(t){return-(Math.cos(Math.PI*t)-1)/2}},{key:"expoIn",value:function(t){return 0===t?0:Math.pow(2,10*t-10)}},{key:"expoOut",value:function(t){return 1===t?1:1-Math.pow(2,-10*t)}},{key:"expoInOut",value:function(t){return 0===t?0:1===t?1:t<.5?Math.pow(2,20*t-10)/2:(2-Math.pow(2,-20*t+10))/2}},{key:"circIn",value:function(t){return-(Math.sqrt(1-t*t)-1)}},{key:"circOut",value:function(t){return Math.sqrt(1- --t*t)}},{key:"circInOut",value:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},{key:"bounceOut",value:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}},{key:"bounceIn",value:function(e){return 1-t.bounceOut(1-e)}},{key:"bounceInOut",value:function(e){return e<.5?.5*t.bounceIn(2*e):.5*t.bounceOut(2*e-1)+.5}},{key:"getElasticIn",value:function(t,e){return function(i){if(0===i||1===i)return i;var n=e/se*Math.asin(1/t);return-t*Math.pow(2,10*(i-=1))*Math.sin((i-n)*se/e)}}},{key:"getElasticOut",value:function(t,e){return function(i){if(0===i||1===i)return i;var n=e/se*Math.asin(1/t);return t*Math.pow(2,-10*i)*Math.sin((i-n)*se/e)+1}}},{key:"getElasticInOut",value:function(t,e){return function(i){var n=e/se*Math.asin(1/t);return(i*=2)<1?t*Math.pow(2,10*(i-=1))*Math.sin((i-n)*se/e)*-.5:t*Math.pow(2,-10*(i-=1))*Math.sin((i-n)*se/e)*.5+1}}},{key:"registerFunc",value:function(e,i){t[e]=i}}])}();Hh.quadIn=Hh.getPowIn(2),Hh.quadOut=Hh.getPowOut(2),Hh.quadInOut=Hh.getPowInOut(2),Hh.cubicIn=Hh.getPowIn(3),Hh.cubicOut=Hh.getPowOut(3),Hh.cubicInOut=Hh.getPowInOut(3),Hh.quartIn=Hh.getPowIn(4),Hh.quartOut=Hh.getPowOut(4),Hh.quartInOut=Hh.getPowInOut(4),Hh.quintIn=Hh.getPowIn(5),Hh.quintOut=Hh.getPowOut(5),Hh.quintInOut=Hh.getPowInOut(5),Hh.backIn=Hh.getBackIn(1.7),Hh.backOut=Hh.getBackOut(1.7),Hh.backInOut=Hh.getBackInOut(1.7),Hh.elasticIn=Hh.getElasticIn(1,.3),Hh.elasticOut=Hh.getElasticOut(1,.3),Hh.elasticInOut=Hh.getElasticInOut(1,.3*1.5),Hh.easeInOutQuad=function(t){return(t/=.5)<1?.5*Math.pow(t,2):-.5*((t-=2)*t-2)},Hh.easeOutElastic=function(t){var e=2*Math.PI/3;return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin((10*t-.75)*e)+1},Hh.easeInOutElastic=function(t){var e=2*Math.PI/4.5;return 0===t?0:1===t?1:t<.5?-Math.pow(2,20*t-10)*Math.sin((20*t-11.125)*e)/2:Math.pow(2,-20*t+10)*Math.sin((20*t-11.125)*e)/2+1};for(var jh=function(t){Hh["flicker".concat(t)]=function(e){return function(t,e){for(var i=1/e,n=1;t>i;)t-=i,n*=-1;var r=n*t/i;return r>0?r:1+r}(e,t)}},Nh=0;Nh<10;Nh++)jh(Nh);for(var Vh=function(t){Hh["aIn".concat(t)]=function(e){return t*e*e+(1-t)*e}},Wh=2;Wh<10;Wh++)Vh(Wh);var Gh=function(){return o((function t(){r(this,t),this.id=ws.GenAutoIncrementId(),this.animateHead=null,this.animateTail=null,this.animateCount=0,this.paused=!1}),[{key:"addAnimate",value:function(t){this.animateTail?(this.animateTail.nextAnimate=t,t.prevAnimate=this.animateTail,this.animateTail=t,t.nextAnimate=null):(this.animateHead=t,this.animateTail=t),this.animateCount++}},{key:"pause",value:function(){this.paused=!0}},{key:"resume",value:function(){this.paused=!1}},{key:"tick",value:function(t){if(!this.paused){var e=this.animateHead;for(this.animateCount=0;e;)e.status===Ml.END?this.removeAnimate(e):e.status===Ml.RUNNING||e.status===Ml.INITIAL?(this.animateCount++,e.advance(t)):e.status===Ml.PAUSED&&this.animateCount++,e=e.nextAnimate}}},{key:"clear",value:function(){for(var t=this.animateHead;t;)t.release(),t=t.nextAnimate;this.animateHead=null,this.animateTail=null,this.animateCount=0}},{key:"removeAnimate",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t._onRemove&&t._onRemove.forEach((function(t){return t()})),t===this.animateHead?(this.animateHead=t.nextAnimate,t===this.animateTail?this.animateTail=null:this.animateHead.prevAnimate=null):t===this.animateTail?(this.animateTail=t.prevAnimate,this.animateTail.nextAnimate=null):(t.prevAnimate.nextAnimate=t.nextAnimate,t.nextAnimate.prevAnimate=t.prevAnimate),e&&t.release()}}])}(),Uh=new Gh,Yh=function(){return o((function t(e,i,n,a,o){r(this,t),this.from=e,this.to=i,this.duration=n,this.easing=a,this.params=o,this.updateCount=0}),[{key:"bind",value:function(t,e){this.target=t,this.subAnimate=e,this.onBind()}},{key:"onBind",value:function(){}},{key:"onFirstRun",value:function(){}},{key:"onStart",value:function(){}},{key:"onEnd",value:function(){}},{key:"getEndProps",value:function(){return this.to}},{key:"getFromProps",value:function(){return this.from}},{key:"getMergedEndProps",value:function(){var t,e=this.getEndProps();return e?this._endProps===e?this._mergedEndProps:(this._endProps=e,void(this._mergedEndProps=Object.assign({},null!==(t=this.step.prev.getLastProps())&&void 0!==t?t:{},e))):this.step.prev?this.step.prev.getLastProps():e}},{key:"update",value:function(t,e,i){var n=this;if(0===this.updateCount){this.onFirstRun();var r=this.step.getLastProps();Object.keys(r).forEach((function(t){n.subAnimate.animate.validAttr(t)&&(i[t]=r[t])}))}this.updateCount+=1,this.onUpdate(t,e,i),t&&this.onEnd()}}])}(),Xh=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[null,null,0,"linear"])).cb=t,i}return h(e,t),o(e,[{key:"onUpdate",value:function(t,e,i){}},{key:"onStart",value:function(){this.cb()}}])}(Yh),Kh=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ws.GenAutoIncrementId(),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Uh,n=arguments.length>2?arguments[2]:void 0;r(this,t),this.id=e,this.timeline=i||Uh,this.status=Ml.INITIAL,this.tailAnimate=new Zh(this),this.subAnimates=[this.tailAnimate],this.timeScale=1,this.rawPosition=-1,this._startTime=0,this._duringTime=0,this.timeline.addAnimate(this),this.slience=n}return o(t,[{key:"setTimeline",value:function(t){t!==this.timeline&&(this.timeline.removeAnimate(this,!1),t.addAnimate(this))}},{key:"getStartTime",value:function(){return this._startTime}},{key:"getDuration",value:function(){return this.subAnimates.reduce((function(t,e){return t+e.totalDuration}),0)}},{key:"after",value:function(t){var e=t.getDuration();return this._startTime=e,this}},{key:"afterAll",value:function(t){var e=-1/0;return t.forEach((function(t){e=he(t.getDuration(),e)})),this._startTime=e,this}},{key:"parallel",value:function(t){return this._startTime=t.getStartTime(),this}},{key:"play",value:function(t){if(this.tailAnimate.play(t),this.target){var e=this.target.stage;e&&e.renderNextFrame()}return 1===this.subAnimates.length&&this.tailAnimate.totalDuration===t.duration&&this.trySetAttribute(t.getFromProps(),t.mode),this}},{key:"trySetAttribute",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.mode;e&&i&wl.SET_ATTR_IMMEDIATELY&&this.target.setAttributes&&this.target.setAttributes(e,!1,{type:Al.ANIMATE_PLAY})}},{key:"runCb",value:function(t){var e=this,i=new Xh((function(){t(e,i.step.prev)}));return this.tailAnimate.play(i),this}},{key:"customInterpolate",value:function(e,i,n,r,a,o){var s=t.interpolateMap.get(e)||t.interpolateMap.get("");return!!s&&s(e,i,n,r,a,o)}},{key:"pause",value:function(){this.status===Ml.RUNNING&&(this.status=Ml.PAUSED)}},{key:"resume",value:function(){this.status===Ml.PAUSED&&(this.status=Ml.RUNNING)}},{key:"to",value:function(t,e,i,n){if(this.tailAnimate.to(t,e,i,n),this.target){var r=this.target.stage;r&&r.renderNextFrame()}return this}},{key:"from",value:function(t,e,i,n){if(this.tailAnimate.from(t,e,i,n),this.target){var r=this.target.stage;r&&r.renderNextFrame()}return this}},{key:"wait",value:function(t){if(this.tailAnimate.wait(t),this.target){var e=this.target.stage;e&&e.renderNextFrame()}return this}},{key:"startAt",value:function(t){if(this.tailAnimate.startAt(t),this.target){var e=this.target.stage;e&&e.renderNextFrame()}return this}},{key:"loop",value:function(t){if(this.tailAnimate.loop=t,this.target){var e=this.target.stage;e&&e.renderNextFrame()}return this}},{key:"reversed",value:function(t){if(this.tailAnimate.reversed=t,this.target){var e=this.target.stage;e&&e.renderNextFrame()}return this}},{key:"bounce",value:function(t){if(this.tailAnimate.bounce=t,this.target){var e=this.target.stage;e&&e.renderNextFrame()}return this}},{key:"subAnimate",value:function(){var t=new Zh(this,this.tailAnimate);return this.tailAnimate=t,this.subAnimates.push(t),t.bind(this.target),this}},{key:"getStartProps",value:function(){return this.subAnimates[0].getStartProps()}},{key:"getEndProps",value:function(){return this.tailAnimate.getEndProps()}},{key:"depreventAttr",value:function(t){this._preventAttrs&&this._preventAttrs.delete(t)}},{key:"preventAttr",value:function(t){this._preventAttrs||(this._preventAttrs=new Set),this._preventAttrs.add(t)}},{key:"preventAttrs",value:function(t){var e=this;t.forEach((function(t){return e.preventAttr(t)}))}},{key:"validAttr",value:function(t){return!this._preventAttrs||!this._preventAttrs.has(t)}},{key:"bind",value:function(t){return this.target=t,this.target.onAnimateBind&&!this.slience&&this.target.onAnimateBind(this),this.subAnimates.forEach((function(e){e.bind(t)})),this}},{key:"advance",value:function(t){if(this._duringTime<this._startTime){if(this._duringTime+t*this.timeScale<this._startTime)return void(this._duringTime+=t*this.timeScale);t=this._duringTime+t*this.timeScale-this._startTime,this._duringTime=this._startTime}this.status===Ml.INITIAL&&(this.status=Ml.RUNNING,this._onStart&&this._onStart.forEach((function(t){return t()}))),this.setPosition(Math.max(this.rawPosition,0)+t*this.timeScale)&&this.status===Ml.RUNNING&&(this.status=Ml.END,this._onEnd&&this._onEnd.forEach((function(t){return t()})))}},{key:"setPosition",value:function(t){var e,i=0,n=this.rawPosition,r=this.subAnimates.reduce((function(t,e){return t+e.totalDuration}),0);t<0&&(t=0);var a=t>=r;if(a&&(t=r),t===n)return a;for(var o=0;o<this.subAnimates.length&&!(i+(e=this.subAnimates[o]).totalDuration>=t);o++)i+=e.totalDuration,e=void 0;return this.rawPosition=t,e.setPosition(t-i),a}},{key:"onStart",value:function(t){this._onStart||(this._onStart=[]),this._onStart.push(t)}},{key:"onEnd",value:function(t){this._onEnd||(this._onEnd=[]),this._onEnd.push(t)}},{key:"onRemove",value:function(t){this._onRemove||(this._onRemove=[]),this._onRemove.push(t)}},{key:"onFrame",value:function(t){this._onFrame||(this._onFrame=[]),this._onFrame.push(t)}},{key:"release",value:function(){this.status=Ml.END}},{key:"stop",value:function(t){t||this.target.onStop(),"start"===t?this.target.onStop(this.getStartProps()):"end"===t?this.target.onStop(this.getEndProps()):this.target.onStop(t),this.release()}}],[{key:"AddInterpolate",value:function(e,i){t.interpolateMap.set(e,i)}}])}();Kh.mode=wl.NORMAL,Kh.interpolateMap=new Map;var qh,Zh=function(){return o((function t(e,i){r(this,t),this.rawPosition=-1,this.position=0,this.loop=0,this.duration=0,this.animate=e,this.stepHead=new Jh(0,0,i?Object.assign({},i.stepTail.props):{}),this.stepTail=this.stepHead,this.dirty=!0,this._startAt=0}),[{key:"totalDuration",get:function(){return this.calcAttr(),this._totalDuration+this._startAt}},{key:"calcAttr",value:function(){this.dirty&&(this._totalDuration=this.duration*(this.loop+1))}},{key:"bind",value:function(t){return this.target=t,this}},{key:"play",value:function(t){var e=t.duration;(null==e||e<0)&&(e=0);var i=t.easing,n="string"==typeof i?Hh[i]:i,r=this._addStep(e,null,n);return r.type=Tl.customAnimate,this._appendProps(t.getEndProps(),r,!1),this._appendCustomAnimate(t,r),this}},{key:"to",value:function(t,e,i,n){var r=this;(null==e||e<0)&&(e=0);var a="string"==typeof i?Hh[i]:i,o=this._addStep(e,null,a);return o.type=Tl.to,this._appendProps(t,o,!!n&&n.tempProps),o.propKeys||(o.propKeys=Object.keys(o.props)),n&&n.noPreventAttrs||this.target.animates&&this.target.animates.forEach((function(t){t.id!==r.animate.id&&t.preventAttrs(o.propKeys)})),this}},{key:"from",value:function(t,e,i,n){var r=this;this.to(t,0,i,n);var a={};this.stepTail.propKeys||(this.stepTail.propKeys=Object.keys(this.stepTail.props)),this.stepTail.propKeys.forEach((function(t){a[t]=r.getLastPropByName(t,r.stepTail)})),this.to(a,e,i,n),this.stepTail.type=Tl.from}},{key:"startAt",value:function(t){return t<0&&(t=0),this._startAt=t,this}},{key:"getStartProps",value:function(){var t;return null===(t=this.stepHead)||void 0===t?void 0:t.props}},{key:"getEndProps",value:function(){return this.stepTail.props}},{key:"getLastStep",value:function(){return this._lastStep}},{key:"wait",value:function(t){if(t>0){var e=this._addStep(+t,null);e.type=Tl.wait,e.prev.customAnimate?e.props=e.prev.customAnimate.getEndProps():e.props=e.prev.props,this.target.onAddStep&&this.target.onAddStep(e)}return this}},{key:"_addStep",value:function(t,e,i){var n=new Jh(this.duration,t,e,i);return this.duration+=t,this.stepTail.append(n),this.stepTail=n,n}},{key:"_appendProps",value:function(t,e,i){var n=this;e.props=i?t:Object.assign({},t);var r=e.prev,a=e.props;for(e.propKeys||(e.propKeys=Object.keys(e.props)),e.propKeys.forEach((function(t){void 0===e.props[t]&&(e.props[t]=n.target.getDefaultAttribute(t))}));r.prev;)r.props&&(r.propKeys||(r.propKeys=Object.keys(r.props)),r.propKeys.forEach((function(t){void 0===a[t]&&(a[t]=r.props[t])}))),e.propKeys=Object.keys(e.props),r=r.prev;var o=this.stepHead.props;e.propKeys||(e.propKeys=Object.keys(a)),e.propKeys.forEach((function(t){if(void 0===o[t]){var e=n.animate.getStartProps();o[t]=e[t]=n.target.getComputedAttribute(t)}})),this.target.onAddStep&&this.target.onAddStep(e)}},{key:"_appendCustomAnimate",value:function(t,e){e.customAnimate=t,t.step=e,t.bind(this.target,this)}},{key:"setPosition",value:function(t){var e,i,n,r=this.duration,a=this.loop,o=this.rawPosition,s=!1,l=null!==(e=this._startAt)&&void 0!==e?e:0;if(t<0&&(t=0),t<l)return this.rawPosition=t,!1;if(r<=0&&(s=!0,r<0))return s;if(n=(t-=l)-(i=Math.floor(t/r))*r,(s=t>=a*r+r)&&(t=(n=r)*(i=a)+r),t===o)return s;var u=!this.reversed!=!(this.bounce&&i%2);return u&&(n=r-n),this._deltaPosition=n-this.position,this.position=n,this.rawPosition=t+l,this.updatePosition(s,u),s}},{key:"updatePosition",value:function(t,e){if(this.stepHead){var i=this.stepHead.next,n=this.position,r=this.duration;if(this.target&&i){for(var a=i.next;a&&a.position<=n;)a=(i=a).next;var o=t?0===r?1:n/r:(n-i.position)/i.duration;i.easing&&(o=i.easing(o)),this.tryCallCustomAnimateLifeCycle(i,this._lastStep||(e?this.stepTail:this.stepHead),e),this.updateTarget(i,o,t),this._lastStep=i,this.animate._onFrame&&this.animate._onFrame.forEach((function(t){return t(i,o)}))}}}},{key:"tryCallCustomAnimateLifeCycle",value:function(t,e,i){if(t!==e)if(i){for(var n=e.prev;n&&n!==t;)n.customAnimate&&(n.customAnimate.onStart&&n.customAnimate.onStart(),n.customAnimate.onEnd&&n.customAnimate.onEnd()),n=t.prev;e&&e.customAnimate&&e.customAnimate.onEnd&&e.customAnimate.onEnd(),t&&t.customAnimate&&t.customAnimate.onStart&&t.customAnimate.onStart()}else{for(var r=e.next;r&&r!==t;)r.customAnimate&&(r.customAnimate.onStart&&r.customAnimate.onStart(),r.customAnimate.onEnd&&r.customAnimate.onEnd()),r=r.next;e&&e.customAnimate&&e.customAnimate.onEnd&&e.customAnimate.onEnd(),t&&t.customAnimate&&t.customAnimate.onStart&&t.customAnimate.onStart()}}},{key:"getLastPropByName",value:function(t,e){for(var i=e.prev;i;){if(i.props&&void 0!==i.props[t])return i.props[t];if(i.customAnimate){var n=i.customAnimate.getEndProps()[t];if(void 0!==n)return n}i=i.prev}return Lt.getInstance().warn("未知错误，step中找不到属性"),e.props[t]}},{key:"updateTarget",value:function(t,e,i){null==t.props&&null==t.customAnimate||this.target.onStep(this,this.animate,t,e,i)}}])}(),Jh=function(){return o((function t(e,i,n,a){r(this,t),this.duration=i,this.position=e,this.props=n,this.easing=a}),[{key:"append",value:function(t){t.prev=this,t.next=this.next,this.next=t}},{key:"getLastProps",value:function(){for(var t=this.prev;t;){if(t.props)return t.props;if(t.customAnimate)return t.customAnimate.getMergedEndProps();t=t.prev}return null}}])}(),Qh=200,$h="cubicOut",td=1e3,ed="quadInOut";!function(t){t[t.Top=1]="Top",t[t.Right=2]="Right",t[t.Bottom=4]="Bottom",t[t.Left=8]="Left",t[t.ALL=15]="ALL"}(qh||(qh={}));var id=[!1,!1,!1,!1],nd=[0,0,0,0],rd=function(t){return t?X(t)?0===t.length?0:1===t.length?t[0]:2===t.length?(nd[0]=t[0],nd[2]=t[0],nd[1]=t[1],nd[3]=t[1],nd):t:t:0},ad=[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],od=[1,2,3,0,1,2,3,0];function sd(t,e,i,n){for(;t>=se;)t-=se;for(;t<0;)t+=se;for(;t>e;)e+=se;ad[0].x=i,ad[1].y=i,ad[2].x=-i,ad[3].y=-i;var r=Math.ceil(t/ae)%4,a=Math.ceil(e/ae)%4;if(n.add(ce(t)*i,pe(t)*i),n.add(ce(e)*i,pe(e)*i),r!==a||e-t>re)for(var o=!1,s=0;s<od.length;s++)if(o||r!==od[s]){if(o&&a===od[s])break;if(o){var l=ad[od[s]];n.add(l.x,l.y)}}else{o=!0;var u=ad[r];n.add(u.x,u.y)}}function ld(t,e,i){var n=ye(t.x,t.y,e.x,e.y,i),r=n.x,a=n.y,o=ye(t.x1,t.y1,e.x1,e.y1,i),s=o.x,l=o.y,u=new Ae(r,a,s,l);return u.defined=e.defined,u}function ud(t,e,i){if(!t||!e)return[];Array.isArray(t)||(t=[t]),Array.isArray(e)||(e=[e]);var n=[];if(t.length>e.length){n=e.map((function(t){var e=new Ae(t.x,t.y,t.x1,t.y1);return e.defined=t.defined,e}));for(var r=0;r<e.length;r++)n[r]=ld(t[r],e[r],i)}else{n=e.map((function(t){var e=new Ae(t.x,t.y,t.x1,t.y1);return e.defined=t.defined,e}));for(var a=0;a<t.length;a++)n[a]=ld(t[a],e[a],i)}return n}var cd=["x","y","dx","dy","scaleX","scaleY","angle","anchor","postMatrix","scrollX","scrollY"];function hd(t,e){if(X(t)){for(var i,n=0;n<t.length&&void 0===i;n++)i=t[n][e];return i}return t[e]}var dd=function(){return o((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.TimeOut;r(this,t),this.durations=[],this.timeout=e,this.lastDate=0,this.durationsListThreshold=30}),[{key:"call",value:function(t){var e=this;return this.lastDate=Date.now(),setTimeout((function(){e.appendDuration(Date.now()-e.lastDate),t(0)}),this.timeout,!0)}},{key:"clear",value:function(t){clearTimeout(t)}},{key:"appendDuration",value:function(t){this.durations.push(t),this.durations.length>this.durationsListThreshold&&this.durations.shift(),this.timeout=Math.min(Math.max(this.durations.reduce((function(t,e){return t+e}),0)/this.durations.length,1e3/60),1e3/30)}}])}();dd.TimeOut=1e3/60;var pd,fd=new dd,vd=function(t,e){var i=function(t,e){return Y(t)&&"%"===t[t.length-1]?e*(Number.parseFloat(t.substring(0,t.length-1))/100):t}(t,e);return isNaN(i)?i:Math.max(e,i)},gd=function(t){function e(t,i,a,o,s){return r(this,e),n(this,e,[t,i,a,o,s])}return h(e,t),o(e,[{key:"getEndProps",value:function(){return!1===this.valid?{}:{text:this.to}}},{key:"onBind",value:function(){var t,e,i,n,r,a,o,s;this.fromNumber=Z(null===(t=this.from)||void 0===t?void 0:t.text)?null===(e=this.from)||void 0===e?void 0:e.text:Number.parseFloat(null===(i=this.from)||void 0===i?void 0:i.text),this.toNumber=Z(null===(n=this.to)||void 0===n?void 0:n.text)?null===(r=this.to)||void 0===r?void 0:r.text:Number.parseFloat(null===(a=this.to)||void 0===a?void 0:a.text),Number.isFinite(this.toNumber)||(this.fromNumber=0),Number.isFinite(this.toNumber)||(this.valid=!1),!1!==this.valid&&(this.decimalLength=null!==(s=null===(o=this.params)||void 0===o?void 0:o.fixed)&&void 0!==s?s:Math.max(xe(this.fromNumber),xe(this.toNumber)))}},{key:"onEnd",value:function(){}},{key:"onUpdate",value:function(t,e,i){var n;!1!==this.valid&&(i.text=t?null===(n=this.to)||void 0===n?void 0:n.text:(this.fromNumber+(this.toNumber-this.fromNumber)*e).toFixed(this.decimalLength))}}])}(Yh);!function(t){t[t.LEFT_TO_RIGHT=0]="LEFT_TO_RIGHT",t[t.RIGHT_TO_LEFT=1]="RIGHT_TO_LEFT",t[t.TOP_TO_BOTTOM=2]="TOP_TO_BOTTOM",t[t.BOTTOM_TO_TOP=3]="BOTTOM_TO_TOP",t[t.STROKE=4]="STROKE"}(pd||(pd={}));var yd=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).fromText="",t.toText="",t}return h(e,t),o(e,[{key:"getEndProps",value:function(){return!1===this.valid?{}:{text:this.to}}},{key:"onBind",value:function(){var t,e,i;this.fromText=null!==(e=null===(t=this.from)||void 0===t?void 0:t.text)&&void 0!==e?e:"",this.toText=(null===(i=this.to)||void 0===i?void 0:i.text)||"",(!this.toText||X(this.toText)&&0===this.toText.length)&&(this.valid=!1),X(this.toText)&&(this.toText=this.toText.map((function(t){return(t||"").toString()})))}},{key:"onEnd",value:function(){this.target.detachShadow()}},{key:"onUpdate",value:function(t,e,i){if(!1!==this.valid){var n=this.fromText.length,r=X(this.toText),a=r?this.toText.reduce((function(t,e){return t+(e||"").length}),0):this.toText.length,o=Math.ceil(n+(a-n)*e);if(r){i.text=[];var s=0;this.toText.forEach((function(t){s+t.length>o?(i.text.push(t.substr(0,o-s)),s=o):(i.text.push(t),s+=t.length)}))}else i.text=this.toText.substr(0,o)}}}])}(Yh),md=function(t){function e(t,i,a,o,s){var l,u,c;return r(this,e),(l=n(this,e,[t,i,a,o,s])).newPointAnimateType=null!==(u=null==s?void 0:s.newPointAnimateType)&&void 0!==u?u:"grow",l.clipRangeByDimension=null!==(c=null==s?void 0:s.clipRangeByDimension)&&void 0!==c?c:"x",l}return h(e,t),o(e,[{key:"getPoints",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t.points)return t.points;if(t.segments){var n=[];return this.segmentsCache||(this.segmentsCache=[]),t.segments.map((function(t){var r,a;t.points&&n.push.apply(n,m(t.points)),i&&e.segmentsCache.push(null!==(a=null===(r=t.points)||void 0===r?void 0:r.length)&&void 0!==a?a:0)})),n}return[]}},{key:"onBind",value:function(){var t=this,e=this.getPoints(this.from),i=this.getPoints(this.to,!0);this.fromPoints=e?Array.isArray(e)?e:[e]:[],this.toPoints=i?Array.isArray(i)?i:[i]:[];var n=new Map;this.fromPoints.forEach((function(t){t.context&&n.set(t.context,t)}));for(var r,a,o=1/0,s=-1/0,l=0;l<this.toPoints.length;l+=1)if(n.has(this.toPoints[l].context)){o=l,r=n.get(this.toPoints[l].context);break}for(var u=this.toPoints.length-1;u>=0;u-=1)if(n.has(this.toPoints[u].context)){s=u,a=n.get(this.toPoints[u].context);break}"clip"===this.newPointAnimateType&&0!==this.toPoints.length&&(Number.isFinite(s)?(this.clipRange=this.toPoints[s][this.clipRangeByDimension]/this.toPoints[this.toPoints.length-1][this.clipRangeByDimension],1===this.clipRange&&(this.shrinkClipRange=this.toPoints[s][this.clipRangeByDimension]/this.fromPoints[this.fromPoints.length-1][this.clipRangeByDimension]),Q(this.clipRange)?this.clipRange=Ut(this.clipRange,0,1):this.clipRange=0):this.clipRange=0);var c=this.toPoints[0];this.interpolatePoints=this.toPoints.map((function(e,i){var l=n.get(e.context);return l?(c=l,[l,e]):"appear"===t.newPointAnimateType||"clip"===t.newPointAnimateType?[e,e]:i<o&&r?[r,e]:i>s&&a?[a,e]:[c,e]})),this.points=this.interpolatePoints.map((function(t){var e=t[0],i=t[1],n=new Ae(e.x,e.y,e.x1,e.y1);return n.defined=i.defined,n.context=i.context,n}))}},{key:"onFirstRun",value:function(){var t=this.target.attribute.clipRange;Q(t*this.clipRange)&&(this.clipRange*=t)}},{key:"onUpdate",value:function(t,e,i){var n=this;if(this.points=this.points.map((function(t,i){var r=ld(n.interpolatePoints[i][0],n.interpolatePoints[i][1],e);return r.context=t.context,r})),this.clipRange){if(this.shrinkClipRange)return void(t?(i.points=this.toPoints,i.clipRange=1):(i.points=this.fromPoints,i.clipRange=this.clipRange-(this.clipRange-this.shrinkClipRange)*e));i.clipRange=this.clipRange+(1-this.clipRange)*e}if(this.segmentsCache&&this.to.segments){var r=0;i.segments=this.to.segments.map((function(t,e){var i=r+n.segmentsCache[e],a=n.points.slice(r,i);return r=i,Object.assign(Object.assign({},t),{points:a})}))}else i.points=this.points}}])}(Yh),_d=function(t){function e(t,i,a,o,s){var l;return r(this,e),(l=n(this,e,[null,null,a,o,s])).clipFromAttribute=t,l.clipToAttribute=i,l._group=null==s?void 0:s.group,l._clipGraphic=null==s?void 0:s.clipGraphic,l}return h(e,t),o(e,[{key:"onBind",value:function(){this._group&&this._clipGraphic&&(this._lastClip=this._group.attribute.clip,this._lastPath=this._group.attribute.path,this._group.setAttributes({clip:!0,path:[this._clipGraphic]},!1,{type:Al.ANIMATE_BIND}))}},{key:"onEnd",value:function(){this._group&&this._group.setAttributes({clip:this._lastClip,path:this._lastPath},!1,{type:Al.ANIMATE_END})}},{key:"onUpdate",value:function(t,e,i){var n=this;if(this._clipGraphic){var r={};Object.keys(this.clipFromAttribute).forEach((function(t){r[t]=n.clipFromAttribute[t]+(n.clipToAttribute[t]-n.clipFromAttribute[t])*e})),this._clipGraphic.setAttributes(r,!1,{type:Al.ANIMATE_UPDATE,animationState:{ratio:e,end:t}})}}}])}(Yh),bd=function(t){function e(t,i,a,o,s){var l,u,c,h,d,p,f,v,g,y,m,_;r(this,e);var b=null!==(u=null===(l=null==s?void 0:s.group)||void 0===l?void 0:l.attribute)&&void 0!==u?u:{},x=null!==(c=b.width)&&void 0!==c?c:0,k=null!==(h=b.height)&&void 0!==h?h:0,S=null!==(d=null==s?void 0:s.animationType)&&void 0!==d?d:"in",A=null!==(p=null==s?void 0:s.startAngle)&&void 0!==p?p:0,M=null!==(f=null==s?void 0:s.orient)&&void 0!==f?f:"clockwise",w=0,T=0;"anticlockwise"===M?(T="in"===S?A+2*Math.PI:A,T=A+2*Math.PI):(w=A,T="out"===S?A+2*Math.PI:A);var C,E,P=nc.graphicService.creator.arc({x:null!==(g=null===(v=null==s?void 0:s.center)||void 0===v?void 0:v.x)&&void 0!==g?g:x/2,y:null!==(m=null===(y=null==s?void 0:s.center)||void 0===y?void 0:y.y)&&void 0!==m?m:k/2,outerRadius:null!==(_=null==s?void 0:s.radius)&&void 0!==_?_:(x+k)/2,innerRadius:0,startAngle:w,endAngle:T,fill:!0});return"anticlockwise"===M?(C={startAngle:A+2*Math.PI},E={startAngle:A}):(C={endAngle:A},E={endAngle:A+2*Math.PI}),n(this,e,["in"===S?C:E,"in"===S?E:C,a,o,{group:null==s?void 0:s.group,clipGraphic:P}])}return h(e,t),o(e)}(_d),xd=function(t){function e(t,i,a,o,s){var l,u,c,h,d,p,f,v,g;r(this,e);var y=null!==(u=null===(l=null==s?void 0:s.group)||void 0===l?void 0:l.attribute)&&void 0!==u?u:{},m=null!==(h=null!==(c=null==s?void 0:s.width)&&void 0!==c?c:y.width)&&void 0!==h?h:0,_=null!==(p=null!==(d=null==s?void 0:s.height)&&void 0!==d?d:y.height)&&void 0!==p?p:0,b=null!==(f=null==s?void 0:s.animationType)&&void 0!==f?f:"in",x=null!==(v=null==s?void 0:s.direction)&&void 0!==v?v:"x",k=null!==(g=null==s?void 0:s.orient)&&void 0!==g?g:"positive",S=nc.graphicService.creator.rect({x:0,y:0,width:"in"===b&&"x"===x?0:m,height:"in"===b&&"y"===x?0:_,fill:!0}),A={},M={};return"y"===x?"negative"===k?(A={y:_,height:0},M={y:0,height:_}):(A={height:0},M={height:_}):"negative"===k?(A={x:m,width:0},M={x:0,width:m}):(A={width:0},M={width:m}),n(this,e,["in"===b?A:M,"in"===b?M:A,a,o,{group:null==s?void 0:s.group,clipGraphic:S}])}return h(e,t),o(e)}(_d),kd=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onStart",value:function(){var t="function"==typeof this.params?this.params():this.params,e=t.center,i=t.r,n=this.target.getComputedAttribute("x"),r=this.target.getComputedAttribute("y"),a=this.target.getComputedAttribute("z"),o=Math.acos((r-e.y)/i),s=Math.acos((n-e.x)/i/Math.sin(o));a-e.z<0&&(s=se-s),this.theta=s,this.phi=o}},{key:"onBind",value:function(){}},{key:"onEnd",value:function(){}},{key:"onUpdate",value:function(t,e,i){if(null!=this.phi&&null!=this.theta){var n="function"==typeof this.params?this.params():this.params,r=n.center,a=n.r,o=n.cb,s=2*Math.PI*e,l=this.theta+s,u=this.phi,c=a*Math.sin(u)*Math.cos(l)+r.x,h=a*Math.cos(u)+r.y,d=a*Math.sin(u)*Math.sin(l)+r.z;for(i.x=c,i.y=h,i.z=d,i.alpha=l+re/2;i.alpha>se;)i.alpha-=se;i.alpha=se-i.alpha,i.zIndex=-1e4*i.z,o&&o(i)}}}])}(Yh),Sd=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[null,null,t,"linear"])).customAnimates=i,a}return h(e,t),o(e,[{key:"initAnimates",value:function(){var t=this;this.customAnimates.forEach((function(e){e.step=t.step,e.subAnimate=t.subAnimate,e.target=t.target}))}},{key:"getEndProps",value:function(){var t={};return this.customAnimates.forEach((function(e){Object.assign(t,e.getEndProps())})),t}},{key:"onBind",value:function(){this.initAnimates(),this.customAnimates.forEach((function(t){t.onBind()}))}},{key:"onEnd",value:function(){this.customAnimates.forEach((function(t){t.onEnd()}))}},{key:"onStart",value:function(){this.customAnimates.forEach((function(t){t.onStart()}))}},{key:"onUpdate",value:function(t,e,i){this.updating||(this.updating=!0,this.customAnimates.forEach((function(n){var r=n.easing,a="string"==typeof r?Hh[r]:r;e=a(e),n.onUpdate(t,e,i)})),this.updating=!1)}}])}(Yh);function Ad(t,e,i,n,r,a){var o=(e-t)*r+t,s=(i-e)*r+e,l=(n-i)*r+i,u=(s-o)*r+o,c=(l-s)*r+s,h=(c-u)*r+u;a[0]=t,a[1]=o,a[2]=u,a[3]=h,a[4]=h,a[5]=c,a[6]=l,a[7]=n}function Md(t,e){var i=t.length,n=e.length;if(i===n)return[t,e];for(var r=[],a=[],o=i<n?t:e,s=Math.min(i,n),l=Math.abs(n-i)/6,u=(s-2)/6,c=Math.ceil(l/u),h=[o[0],o[1]],d=l,p=2;p<s;p+=6){var f=o[p-2],v=o[p-1],g=o[p],y=o[p+1],m=o[p+2],_=o[p+3],b=o[p+4],x=o[p+5];if(d<=0)h.push(g,y,m,_,b,x);else{for(var k=Math.min(d,c)+1,S=1;S<=k;S++){var A=S/k;Ad(f,g,m,b,A,r),Ad(v,y,_,x,A,a),f=r[3],v=a[3],h.push(r[1],a[1],r[2],a[2],f,v),g=r[5],y=a[5],m=r[6],_=a[6]}d-=k-1}}return o===t?[h,e]:[t,h]}function wd(t,e){for(var i=t||e,n=i.length,r=i[n-2],a=i[n-1],o=[],s=0;s<e.length;s+=2)o[s]=r,o[s+1]=a;return o}function Td(t){for(var e=[],i=t.length,n=0;n<i;n+=2)e[n]=t[i-n-2],e[n+1]=t[i-n-1];return e}function Cd(t){for(var e=0,i=0,n=0,r=t.length,a=0,o=r-2;a<r;o=a,a+=2){var s=t[o],l=t[o+1],u=t[a],c=t[a+1],h=s*c-u*l;e+=h,i+=(s+u)*h,n+=(l+c)*h}return 0===e?[t[0]||0,t[1]||0,0]:[i/e/3,n/e/3,e]}function Ed(t,e,i,n){for(var r=(t.length-2)/6,a=1/0,o=0,s=t.length,l=s-2,u=0;u<r;u++){for(var c=6*u,h=0,d=0;d<s;d+=2){var p=0===d?c:(c+d-2)%l+2,f=t[p]-i[0],v=t[p+1]-i[1],g=e[d]-n[0]-f,y=e[d+1]-n[1]-v;h+=g*g+y*y}h<a&&(a=h,o=u)}return o}var Pd=function(t,e,i,n,r){Nt(e,n)&&Nt(i,r)||t.push(e,i,n,r,n,r)};function Rd(t){for(var e,i,n,r,a,o=t.commandList,s=[],l=0,u=0,c=0,h=0,d=function(t,i){e&&e.length>2&&s.push(e),e=[t,i]},p=0,f=o.length;p<f;p++){var v=o[p],g=0===p;switch(g&&(c=l=v[1],h=u=v[2],[Ol.L,Ol.C,Ol.Q].includes(v[0])&&(e=[c,h])),v[0]){case Ol.M:l=c=v[1],u=h=v[2],d(c,h);break;case Ol.L:i=v[1],n=v[2],Pd(e,l,u,i,n),l=i,u=n;break;case Ol.C:e.push(v[1],v[2],v[3],v[4],l=v[5],u=v[6]);break;case Ol.Q:i=v[1],n=v[2],r=v[3],a=v[4],e.push(l+2/3*(i-l),u+2/3*(n-u),r+2/3*(i-r),a+2/3*(n-a),r,a),l=r,u=a;break;case Ol.A:var y=v[1],m=v[2],_=v[3],b=_,x=v[4],k=v[5],S=!!v[6];i=Math.cos(x)*_+y,n=Math.sin(x)*_+m,g?d(c=i,h=n):Pd(e,l,u,i,n),l=Math.cos(k)*_+y,u=Math.sin(k)*_+m;for(var A=(S?-1:1)*Math.PI/2,M=x;S?M>k:M<k;M+=A){var w=S?Math.max(M+A,k):Math.min(M+A,k);Hl(e,M,w,y,m,_,b)}break;case Ol.E:var T=v[1],C=v[2],E=v[3],P=v[4],R=v[5],B=v[6],I=v[7]+B,L=!!v[8],D=!Nt(R,0),O=Math.cos(R),F=Math.sin(R),z=Math.cos(B)*E,H=Math.sin(B)*P;D?(i=z*O-H*F+T,n=z*F+H*O+C):(i=z+T,n=H+C),g?d(c=i,h=n):Pd(e,l,u,i,n),z=Math.cos(I)*E,H=Math.sin(I)*P,D?(l=z*O-H*F+T,u=z*F+H*O+C):(l=z+T,u=H+C);for(var j=(L?-1:1)*Math.PI/2,N=B;L?N>I:N<I;N+=j){var V=L?Math.max(N+j,I):Math.min(N+j,I);if(Hl(e,N,V,T,C,E,P),D)for(var W=e.length,G=W-6;G<=W-1;G+=2)z=e[G],H=e[G+1],e[G]=(z-T)*O-(H-C)*F+T,e[G+1]=(z-T)*F+(H-C)*O+C}break;case Ol.R:c=l=v[1],h=u=v[2],i=c+v[3],n=h+v[4],d(i,h),Pd(e,i,h,i,n),Pd(e,i,n,c,n),Pd(e,c,n,c,h),Pd(e,c,h,i,h);break;case Ol.AT:var U=v[1],Y=v[2],X=v[3],K=v[4],q=v[5],Z=Me.distancePP({x:l,y:u},{x:U,y:Y}),J=Me.distancePP({x:X,y:K},{x:U,y:Y}),Q=((l-U)*(X-U)+(u-Y)*(K-Y))/(Z*J),$=q/Math.sin(Q/2),tt=(l+X-2*U)/2,et=(u+K-2*Y)/2,it=Me.distancePP({x:tt,y:et},{x:0,y:0}),nt=U+$*tt/it,rt=X+$*et/it,at=Math.sqrt($*$-q*q);Pd(e,l,u,c=U+at*(l-U)/Z,h=Y+at*(u-Y)/Z),l=U+at*(X-U)/J,u=Y+at*(K-Y)/J;var ot=Be({x:nt,y:rt},{x:c,y:h}),st=Be({x:nt,y:rt},{x:l,y:u});Hl(e,ot,st,nt,rt,q,q);break;case Ol.Z:e&&Pd(e,l,u,c,h),l=c,u=h}}return e&&e.length>2&&s.push(e),s}function Bd(t,e){for(var i=0;i<t.length;i++)for(var n=t[i],r=0;r<n.length;r+=2){var a=n[r],o=n[r+1],s={x:a,y:o};e.transformPoint({x:a,y:o},s),n[r]=s.x,n[r+1]=s.y}}function Id(t){for(var e=new Ru,i=0;i<t.length;i++){var n=t[i];if(n.length>2){e.moveTo(n[0],n[1]);for(var r=2;r<n.length;r+=6)e.bezierCurveTo(n[r],n[r+1],n[r+2],n[r+3],n[r+4],n[r+5])}}return e}var Ld=function(t){if(!t)return{x:0,y:0,width:0,height:0};var e=j(t.width)?t.x1-t.x:t.width,i=j(t.height)?t.y1-t.y:t.height,n=0,r=0;return e<0?(n=e,e=-e):Number.isNaN(e)&&(e=0),i<0?(r=i,i=-i):Number.isNaN(i)&&(i=0),{x:n,y:r,width:e,height:i}};function Dd(t,e,i){var n,r,a=t/e;t>=e?(r=Math.ceil(Math.sqrt(i*a)),0===(n=Math.floor(i/r))&&(n=1,r=i)):(n=Math.ceil(Math.sqrt(i/a)),0===(r=Math.floor(i/n))&&(r=1,n=i));for(var o=[],s=0;s<n;s++)o.push(r);var l=i-n*r;if(l>0)for(var u=0;u<l;u+=r)u+r<l?o.push(r):o.push(l-u);return o}var Od=function(t,e){var i=t.filter((function(t){return!1!==t.defined&&Z(t.x)&&Z(t.y)}));if(0===i.length)return[];if(1===i.length)return new Array(e).fill(0).map((function(t){return i[0]}));var n=[];if(e<=i.length){for(var r=i.length/e,a=0,o=0;a<e;)n.push(i[Math.floor(o)]),o+=r,a++;return n}for(var s=e-i.length,l=1/(s/(i.length-1)+1),u=0,c=0,h=t.length;c<h;c++)if(n.push(t[c]),c<h-1)for(var d=l,p=t[c].x,f=t[c].y,v=t[c+1].x,g=t[c+1].y;d<1&&u<s;)n.push({x:p+(v-p)*d,y:f+(g-f)*d}),d+=l,u+=1;return n};var Fd,zd=function(t){return t.map((function(t){return{x:t.x,y:t.y}}))},Hd=function(t,e,i){for(var n,r,a,o=t.length,s=[],l=0;l<o;l++){var u=t[l],c=l===o-1?t[0]:t[l+1],h=ze([e.x,e.y],[i.x,i.y],[u.x,u.y],[c.x,c.y]);h&&"boolean"!=typeof h&&s.push({dot:(r=[h[0]-e.x,h[1]-e.x],a=[i.x-e.x,i.y-e.x],r[0]*a[1]-r[1]*a[0]),point:{x:h[0],y:h[1]},edgeIndex:l})}if(s.length<2)return[zd(t),zd(t)];s.sort((function(t,e){return t.dot-e.dot}));var d=s[0],p=s[s.length-1];d.edgeIndex>p.edgeIndex&&(d=(n=[p,d])[0],p=n[1]);for(var f=d.point,v=p.point,g=[{x:f.x,y:f.y}],y=d.edgeIndex+1;y<=p.edgeIndex;y++)g.push({x:t[y].x,y:t[y].y});g.push({x:v.x,y:v.y});for(var m=[{x:v.x,y:v.y}],_=p.edgeIndex+1,b=d.edgeIndex+o;_<=b;_++){var x=t[_%o];m.push({x:x.x,y:x.y})}return m.push({x:f.x,y:f.y}),[g,m]},jd=function(t,e,i){if(1===e)i.push({points:t});else{var n=Math.floor(e/2),r=function(t){var e=new di;t.forEach((function(t){e.add(t.x,t.y)}));var i=e.width(),n=e.height();if(i>=n){var r=e.x1+i/2;return Hd(t,{x:r,y:e.y1},{x:r,y:e.y2})}var a=e.y1+n/2;return Hd(t,{x:e.x1,y:a},{x:e.x2,y:a})}(t);jd(r[0],n,i),jd(r[1],e-n,i)}};!function(t){t[t.Color255=0]="Color255",t[t.Color1=1]="Color1"}(Fd||(Fd={}));var Nd=function(){function t(){r(this,t)}return o(t,null,[{key:"Get",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Fd.Color1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,0,1];if(i===Fd.Color1){var r=t.store1[e];if(r)return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n;var a=Ti.parseColorString(e);if(a){var o=[a.r/255,a.g/255,a.b/255,a.opacity];t.store1[e]=o,t.store255[e]=[a.r,a.g,a.b,a.opacity],n[0]=o[0],n[1]=o[1],n[2]=o[2],n[3]=o[3]}return n}var s=t.store255[e];if(s)return n[0]=s[0],n[1]=s[1],n[2]=s[2],n[3]=s[3],n;var l=Ti.parseColorString(e);return l&&(t.store1[e]=[l.r/255,l.g/255,l.b/255,l.opacity],t.store255[e]=[l.r,l.g,l.b,l.opacity],n[0]=l.r,n[1]=l.g,n[2]=l.b,n[3]=l.opacity),n}},{key:"Set",value:function(e,i,n){if(i===Fd.Color1){if(t.store1[e])return;t.store1[e]=n,t.store255[e]=[Math.floor(255*n[0]),Math.floor(255*n[1]),Math.floor(255*n[2]),Math.floor(255*n[3])]}else{if(t.store255[e])return;t.store255[e]=n,t.store1[e]=[n[0]/255,n[1]/255,n[2]/255,n[3]]}}}])}();function Vd(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Array.isArray(t)&&Z(t[0])?e?"rgb(".concat(Math.round(t[0]),",").concat(Math.round(t[1]),",").concat(Math.round(t[2]),",").concat(t[3].toFixed(2),")"):"rgb(".concat(Math.round(t[0]),",").concat(Math.round(t[1]),",").concat(Math.round(t[2]),")"):t}function Wd(t,e,i,n,r){return Array.isArray(t)&&!Z(t[0])||Array.isArray(e)&&!Z(e[0])?new Array(4).fill(0).map((function(r,a){return Gd(X(t)?t[a]:t,X(e)?e[a]:e,i,n)})):Gd(t,e,i,n,r)}function Gd(t,e,i,n,r){if(!t||!e)return t&&Vd(t)||e&&Vd(e)||!1;var a,o,s=!1,l=!1;if(Array.isArray(t)?a=t:"string"==typeof t?a=Nd.Get(t,Fd.Color255):s=!0,Array.isArray(e)?o=e:"string"==typeof e?o=Nd.Get(e,Fd.Color255):l=!0,s!==l){var u=s?t:e,c=s?e:t,h=Object.assign(Object.assign({},u),{stops:u.stops.map((function(t){return Object.assign(Object.assign({},t),{color:Vd(c)})}))});return s?Wd(u,h,i,n,r):Wd(h,u,i,n,r)}if(s){if(t.gradient===e.gradient){var d=t,p=e,f=d.stops,v=p.stops;if(f.length!==v.length)return!1;if("linear"===d.gradient)return function(t,e,i){var n=t.stops,r=e.stops;return{gradient:"linear",x0:t.x0+(e.x0-t.x0)*i,x1:t.x1+(e.x1-t.x1)*i,y0:t.y0+(e.y0-t.y0)*i,y1:t.y1+(e.y1-t.y1)*i,stops:new Array(n.length).fill(0).map((function(t,e){return{color:Xd(n[e].color,r[e].color,i),offset:n[e].offset+(r[e].offset-n[e].offset)*i}}))}}(d,p,i);if("radial"===d.gradient)return function(t,e,i){var n=t.stops,r=e.stops;return{gradient:"radial",x0:t.x0+(e.x0-t.x0)*i,x1:t.x1+(e.x1-t.x1)*i,y0:t.y0+(e.y0-t.y0)*i,y1:t.y1+(e.y1-t.y1)*i,r0:t.r0+(e.r0-t.r0)*i,r1:t.r1+(e.r1-t.r1)*i,stops:new Array(n.length).fill(0).map((function(t,e){return{color:Xd(n[e].color,r[e].color,i),offset:n[e].offset+(r[e].offset-n[e].offset)*i}}))}}(d,p,i);if("conical"===d.gradient)return function(t,e,i){var n=t.stops,r=e.stops;return{gradient:"conical",startAngle:t.startAngle+(e.startAngle-t.startAngle)*i,endAngle:t.endAngle+(e.endAngle-t.endAngle)*i,x:t.x+(e.x-t.x)*i,y:t.y+(e.y-t.y)*i,stops:new Array(n.length).fill(0).map((function(t,e){return{color:Xd(n[e].color,r[e].color,i),offset:n[e].offset+(r[e].offset-n[e].offset)*i}}))}}(d,p,i)}return!1}return r&&r(a,o),Vd(function(t,e,i){return[t[0]+(e[0]-t[0])*i,t[1]+(e[1]-t[1])*i,t[2]+(e[2]-t[2])*i,t[3]+(e[3]-t[3])*i]}(a,o,i),n)}Nd.store255={},Nd.store1={};var Ud=[0,0,0,0],Yd=[0,0,0,0];function Xd(t,e,i){return Nd.Get(t,Fd.Color255,Ud),Nd.Get(e,Fd.Color255,Yd),"rgba(".concat(Math.round(Ud[0]+(Yd[0]-Ud[0])*i),",").concat(Math.round(Ud[1]+(Yd[1]-Ud[1])*i),",").concat(Math.round(Ud[2]+(Yd[2]-Ud[2])*i),",").concat(Ud[3]+(Yd[3]-Ud[3])*i,")")}var Kd=function(t,e,i){t.forEach((function(t){if(Number.isFinite(t.to))e[t.key]=t.from+(t.to-t.from)*i;else if("fill"===t.key||"stroke"===t.key){var n=Wd(t.from,t.to,i,!1);n&&(e[t.key]=n)}}))},qd=function(t,e,i){var n=[],r=[];e.clear();for(var a=0;a<t.length;a++){var o=t[a],s=o.from,l=o.to,u=o.rotation*i,c=o.fromCp,h=o.toCp,d=Math.sin(u),p=Math.cos(u);r[0]=c[0]+(h[0]-c[0])*i,r[1]=c[1]+(h[1]-c[1])*i;for(var f=0;f<s.length;f+=2){var v=s[f],g=s[f+1],y=v*(1-i)+l[f]*i,m=g*(1-i)+l[f+1]*i;n[f]=y*p-m*d+r[0],n[f+1]=y*d+m*p+r[1]}var _=n[0],b=n[1];e.moveTo(_,b);for(var x=2;x<s.length;x+=6){var k=n[x],S=n[x+1],A=n[x+2],M=n[x+3],w=n[x+4],T=n[x+5];_===k&&b===S&&A===w&&M===T?e.lineTo(w,T):e.bezierCurveTo(k,S,A,M,w,T),_=w,b=T}}},Zd=function(t,e,i){var n=t?Rd(t):[],r=Rd(e);i&&n&&(i.fromTransform&&Bd(n,i.fromTransform.clone().getInverse()),Bd(n,i.toTransfrom));var a=function(t,e){for(var i,n,r=[],a=[],o=0;o<Math.max(t.length,e.length);o++){var s,l=t[o],u=e[o],c=void 0,h=void 0;l?u?(i=c=(s=g(Md(l,u),2))[0],n=h=s[1]):(h=wd(n,l),c=l):(c=wd(i,u),h=u),r.push(c),a.push(h)}return[r,a]}(n,r),o=g(a,2),s=o[0],l=o[1];return t?function(t,e,i,n){for(var r,a=[],o=0;o<t.length;o++){var s=t[o],l=e[o],u=Cd(s),c=Cd(l);null==r&&(r=u[2]<0!=c[2]<0);var h=[],d=[],p=0,f=1/0,v=[],g=s.length;r&&(s=Td(s));for(var y=6*Ed(s,l,u,c),m=g-2,_=0;_<m;_+=2){var b=(y+_)%m+2;h[_+2]=s[b]-u[0],h[_+3]=s[b+1]-u[1]}if(h[0]=s[y]-u[0],h[1]=s[y+1]-u[1],i>0)for(var x=n/i,k=-n/2;k<=n/2;k+=x){for(var S=Math.sin(k),A=Math.cos(k),M=0,w=0;w<s.length;w+=2){var T=h[w],C=h[w+1],E=l[w]-c[0],P=l[w+1]-c[1],R=E*A-P*S,B=E*S+P*A;v[w]=R,v[w+1]=B;var I=R-T,L=B-C;M+=I*I+L*L}if(M<f){f=M,p=k;for(var D=0;D<v.length;D++)d[D]=v[D]}}else for(var O=0;O<g;O+=2)d[O]=l[O]-c[0],d[O+1]=l[O+1]-c[1];a.push({from:h,to:d,fromCp:u,toCp:c,rotation:-p})}return a}(s,l,10,Math.PI):l.map((function(t,e){return{from:s[e],to:t,fromCp:[0,0],toCp:[0,0],rotation:0}}))},Jd=["fill","fillOpacity","shadowBlur","shadowColor","shadowOffsetX","shadowOffsetY","stroke","strokeOpacity","lineDashOffset"],Qd=function(t,e){if(!t||!e)return null;var i=[],n=!1;return Object.keys(t).forEach((function(r){if(Jd.includes(r)){var a=e[r];j(a)||j(t[r])||a===t[r]||("fill"===r||"stroke"===r?i.push({from:"string"==typeof t[r]?Nd.Get(t[r],Fd.Color255):t[r],to:"string"==typeof a?Nd.Get(a,Fd.Color255):a,key:r}):i.push({from:t[r],to:a,key:r}),n=!0)}})),n?i:null},$d=function(t){function e(t,i,a){var o;return r(this,e),(o=n(this,e,[0,1,i,a])).morphingData=t.morphingData,o.otherAttrs=t.otherAttrs,o.saveOnEnd=t.saveOnEnd,o}return h(e,t),o(e,[{key:"getEndProps",value:function(){return{}}},{key:"onBind",value:function(){this.target.createPathProxy(),this.onUpdate(!1,0,this.target.attribute)}},{key:"onEnd",value:function(){}},{key:"onUpdate",value:function(t,e,i){var n=this.target,r="function"==typeof n.pathProxy?n.pathProxy(n.attribute):n.pathProxy;qd(this.morphingData,r,e),this.otherAttrs&&this.otherAttrs.length&&Kd(this.otherAttrs,i,e),t&&!this.saveOnEnd&&(this.target.pathProxy=null)}}])}(Yh),tp=function(t,e,i,n){var r,a,o;if(t&&(!t.valid||!t.toCustomPath))return __DEV__&&console.error(t," is not validate"),null;if(!e.valid||!e.toCustomPath)return __DEV__&&console.error(e," is not validate"),null;var s=null==t?void 0:t.globalTransMatrix;n&&s&&(s=n.clone().multiply(s.a,s.b,s.c,s.d,s.e,s.f));var l=Zd(null===(r=null==t?void 0:t.toCustomPath)||void 0===r?void 0:r.call(t),e.toCustomPath(),{fromTransform:s,toTransfrom:e.globalTransMatrix}),u=Qd(null==t?void 0:t.attribute,e.attribute),c=e.animate(i);return(null==i?void 0:i.delay)&&c.wait(i.delay),c.play(new $d({morphingData:l,otherAttrs:u},null!==(a=null==i?void 0:i.duration)&&void 0!==a?a:td,null!==(o=null==i?void 0:i.easing)&&void 0!==o?o:ed)),c},ep=function(t){function e(t,i,a){var o;return r(this,e),(o=n(this,e,[0,1,i,a])).morphingData=t.morphingData,o.otherAttrs=t.otherAttrs,o}return h(e,t),o(e,[{key:"getEndProps",value:function(){return{}}},{key:"onBind",value:function(){this.addPathProxy()}},{key:"addPathProxy",value:function(){this.target.shadowRoot.forEachChildren((function(t){t.createPathProxy()})),this.onUpdate(!1,0,this.target.attribute)}},{key:"clearPathProxy",value:function(){this.target.shadowRoot.forEachChildren((function(t){t.pathProxy=null}))}},{key:"onEnd",value:function(){}},{key:"onUpdate",value:function(t,e,i){var n=this;this.target.shadowRoot.forEachChildren((function(t,i){var r;qd(n.morphingData[i],"function"==typeof t.pathProxy?t.pathProxy(t.attribute):t.pathProxy,e),(null===(r=n.otherAttrs)||void 0===r?void 0:r[i])&&n.otherAttrs[i].length&&Kd(n.otherAttrs[i],t.attribute,e)})),t&&(this.clearPathProxy(),this.morphingData=null)}}])}(Yh),ip=function(t){var e={};return Object.keys(t).forEach((function(i){(function(t){return cd.includes(t)})(i)||(e[i]=t[i])})),e},np=function(t,e,i){var n=ip(t.attribute),r=t.attachShadow();if(e.length)r.setTheme(l({},e[0].type,n)),e.forEach((function(t){t.setAttributes({pickable:!1}),r.appendChild(t)}));else{var a=t.AABBBounds,o=a.width(),s=a.height();r.setTheme({rect:n}),new Array(i).fill(0).forEach((function(t){var i=nc.graphicService.creator.rect({x:0,y:0,width:o,height:s,pickable:!1});r.appendChild(i),e.push(i)}))}},rp=function(t,e,i){for(var n=[],r=i?null:ip(t.attribute),a=t.toCustomPath(),o=0;o<e;o++){var s={path:(new Ru).fromCustomPath2D(a)};n.push(nc.graphicService.creator.path(i?s:Object.assign({},r,s)))}return i&&np(t,n,e),n},ap=function(t,e,i){var n=[],r=i?null:ip(t.attribute);if("rect"===t.type)(function(t,e){for(var i=Ld(t.attribute),n=i.width,r=i.height,a=Dd(n,r,e),o=[],s=r/a.length,l=0,u=a.length;l<u;l++)for(var c=a[l],h=n/c,d=0;d<c;d++)o.push({x:0+d*h,y:0+l*s,width:h,height:s});return o})(t,e).forEach((function(t){n.push(nc.graphicService.creator.rect(i?t:Object.assign({},r,t)))}));else if("arc"===t.type)(function(t,e){for(var i=t.getParsedAngle(),n=i.startAngle,r=i.endAngle,a=t.getComputedAttribute("innerRadius"),o=t.getComputedAttribute("outerRadius"),s=Math.abs(n-r),l=Math.abs(o-a),u=Dd(s*(a+o)/2,l,e),c=[],h=l/u.length,d=o>=a?1:-1,p=r>=n?1:-1,f=0,v=u.length;f<v;f++)for(var g=u[f],y=s/g,m=0;m<g;m++)c.push({innerRadius:o-h*f*d,outerRadius:o-h*(f+1)*d,startAngle:n+y*m*p,endAngle:n+y*(m+1)*p});return c})(t,e).forEach((function(t){n.push(nc.graphicService.creator.arc(i?t:Object.assign({},r,t)))}));else if("circle"===t.type)(function(t,e){for(var i=t.getComputedAttribute("startAngle"),n=t.getComputedAttribute("endAngle"),r=t.getComputedAttribute("radius"),a=Math.abs(i-n),o=Dd(a*r,r,e),s=[],l=a/o[0],u=r/o.length,c=n>=i?1:-1,h=0,d=o.length;h<d;h++)for(var p=0,f=o[h];p<f;p++)s.push({innerRadius:u*h,outerRadius:u*(h+1),startAngle:i+l*p*c,endAngle:i+l*(p+1)*c});return s})(t,e).forEach((function(t){n.push(nc.graphicService.creator.arc(i?t:Object.assign({},r,t)))}));else if("line"===t.type){var a=function(t,e){var i=t.attribute,n=i.points;if(n)return Od(n,e);if(i.segments){var r=i.segments.reduce((function(t,e){var i;return t.concat(null!==(i=e.points)&&void 0!==i?i:[])}),[]);return Od(r,e)}return[]}(t,e),o={size:10,symbolType:"circle"};a.forEach((function(t){n.push(nc.graphicService.creator.symbol(i?Object.assign({},t,o):Object.assign({},r,t,o)))}))}else"polygon"===t.type?function(t,e){var i=t.attribute.points;if(!i||!i.length)return[];if(1===e)return[{points:zd(i)}];var n=[];return jd(i,e,n),n}(t,e).forEach((function(t){n.push(nc.graphicService.creator.polygon(i?t:Object.assign({},r,t)))})):"area"===t.type?function(t,e){var i,n,r=t.attribute,a=r.points,o=r.segments;a||(a=o.reduce((function(t,e){var i;return t.concat(null!==(i=e.points)&&void 0!==i?i:[])}),[]));var s=a.filter((function(t){return!1!==t.defined&&Z(t.x)&&Z(t.y)}));if(!s.length)return[];var l=[];s.forEach((function(t){l.push({x:t.x,y:t.y})}));for(var u=s.length-1;u>=0;u--){var c=s[u];l.push({x:null!==(i=c.x1)&&void 0!==i?i:c.x,y:null!==(n=c.y1)&&void 0!==n?n:c.y})}var h=[];return jd(a,e,h),h}(t,e).forEach((function(t){n.push(nc.graphicService.creator.polygon(i?t:Object.assign({},r,t)))})):"path"===t.type&&function(t,e){var i=Rd(t.getParsedPathShape());if(!i.length||e<0)return[];var n=i.length;if(i.length>=e){for(var r=[],a=Math.floor(i.length/e),o=0;o<e;o++){var s=i.slice(o*a,o===e-1?n:(o+1)*a);r.push({path:Id(s)})}return r}for(var l=[],u=Math.floor(e/n),c=e,h=0;h<n;h++){for(var d=[],p=2,f=i[h].length;p<f;p+=2)d.push({x:i[0][p],y:i[0][p+1]});jd(d,h===n-1?c:u,l),c-=u}return l}(t,e).forEach((function(t){"path"in t?n.push(nc.graphicService.creator.path(i?t:Object.assign({},r,t))):n.push(nc.graphicService.creator.polygon(i?t:Object.assign({},r,t)))}));return i&&np(t,n,e),n},op=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"getEndProps",value:function(){return{}}},{key:"onBind",value:function(){this.target.setTheme({common:{opacity:0}})}},{key:"onEnd",value:function(){this.target.setTheme({common:{opacity:1}})}},{key:"onUpdate",value:function(t,e,i){this.target.setTheme({common:{opacity:e}})}}])}(Yh),sp=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"getEndProps",value:function(){return{}}},{key:"onBind",value:function(){this.target.setTheme({common:{opacity:1}})}},{key:"onEnd",value:function(){this.target.setTheme({common:{opacity:0}})}},{key:"onUpdate",value:function(t,e,i){this.target.setTheme({common:{opacity:1-e}})}}])}(Yh),lp=function(){function t(){r(this,t)}return o(t,null,[{key:"GetImage",value:function(e,i){var n,r=t.cache.get(e);r?"fail"===r.loadState?nc.global.getRequestAnimationFrame()((function(){i.imageLoadFail(e)})):"init"===r.loadState||"loading"===r.loadState?null===(n=r.waitingMark)||void 0===n||n.push(i):i&&i.imageLoadSuccess(e,r.data):t.loadImage(e,i)}},{key:"GetSvg",value:function(e,i){var n,r=t.cache.get(e);r?"fail"===r.loadState?nc.global.getRequestAnimationFrame()((function(){i.imageLoadFail(e)})):"init"===r.loadState||"loading"===r.loadState?null===(n=r.waitingMark)||void 0===n||n.push(i):i&&i.imageLoadSuccess(e,r.data):(r={type:"image",loadState:"init"},t.cache.set(e,r),r.dataPromise=nc.global.loadSvg(e),r.dataPromise?(r.waitingMark=[i],r.dataPromise.then((function(t){var i;r.loadState=(null==t?void 0:t.data)?"success":"fail",r.data=null==t?void 0:t.data,null===(i=r.waitingMark)||void 0===i||i.map((function(i,n){(null==t?void 0:t.data)?(r.loadState="success",r.data=t.data,i.imageLoadSuccess(e,t.data)):(r.loadState="fail",i.imageLoadFail(e))})),r.waitingMark&&(r.waitingMark=[])}))):(r.loadState="fail",i.imageLoadFail(e)))}},{key:"GetFile",value:function(e,i){var n=t.cache.get(e);return n?"fail"===n.loadState?Promise.reject():"init"===n.loadState||"loading"===n.loadState?n.dataPromise.then((function(t){return t.data})):Promise.resolve(n.data):(n={type:i,loadState:"init"},t.cache.set(e,n),"arrayBuffer"===i?n.dataPromise=nc.global.loadArrayBuffer(e):"blob"===i?n.dataPromise=nc.global.loadBlob(e):"json"===i&&(n.dataPromise=nc.global.loadJson(e)),n.dataPromise.then((function(t){return t.data})))}},{key:"loading",value:function(){var e=this;setTimeout((function(){if(!t.isLoading&&t.toLoadAueue.length){t.isLoading=!0;var i=t.toLoadAueue.splice(0,10),n=[];i.forEach((function(e){var i=e.url,r=e.marks,a={type:"image",loadState:"init"};if(t.cache.set(i,a),a.dataPromise=nc.global.loadImage(i),a.dataPromise){a.waitingMark=r;var o=a.dataPromise.then((function(t){var e;a.loadState=(null==t?void 0:t.data)?"success":"fail",a.data=null==t?void 0:t.data,null===(e=a.waitingMark)||void 0===e||e.map((function(e,n){(null==t?void 0:t.data)?(a.loadState="success",a.data=t.data,e.imageLoadSuccess(i,t.data)):(a.loadState="fail",e.imageLoadFail(i))})),a.waitingMark&&(a.waitingMark=[])}));n.push(o)}else a.loadState="fail",r.forEach((function(t){return t.imageLoadFail(i)}))})),Promise.all(n).then((function(){t.isLoading=!1,e.onLoadSuccessCb.forEach((function(t){return t()})),t.loading()})).catch((function(i){console.error(i),t.isLoading=!1,e.onLoadSuccessCb.forEach((function(t){return t()})),t.loading()}))}}),0)}},{key:"loadImage",value:function(e,i){var n=up(e,t.toLoadAueue);if(-1!==n)return t.toLoadAueue[n].marks.push(i),void t.loading();t.toLoadAueue.push({url:e,marks:[i]}),t.loading()}},{key:"improveImageLoading",value:function(e){var i=up(e,t.toLoadAueue);if(-1!==i){var n=t.toLoadAueue.splice(i,1);t.toLoadAueue.unshift(n[0])}}},{key:"onLoadSuccess",value:function(t){this.onLoadSuccessCb.push(t)}}])}();function up(t,e){for(var i=0;i<e.length;i++)if(e[i].url===t)return i;return-1}lp.cache=new Map,lp.isLoading=!1,lp.toLoadAueue=[],lp.onLoadSuccessCb=[];var cp=function(){return o((function t(){r(this,t)}),[{key:"bounds",value:function(t,e){if(Z(t)){var i=t/2;e.x1=-i,e.x2=i,e.y1=-i,e.y2=i}else e.x1=-t[0]/2,e.x2=t[0]/2,e.y1=-t[1]/2,e.y2=t[1]/2}},{key:"parseSize",value:function(t){return Z(t)?t:Math.min(t[0],t[1])}}])}();function hp(t,e,i,n,r){return r?t.arc(i,n,e,0,oe,!1,r):t.arc(i,n,e,0,oe),!1}var dp=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="circle",t.pathStr="M0.5,0A0.5,0.5,0,1,1,-0.5,0A0.5,0.5,0,1,1,0.5,0",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n,r){return hp(t,this.parseSize(e)/2,i,n,r)}},{key:"drawOffset",value:function(t,e,i,n,r,a){return hp(t,this.parseSize(e)/2+r,i,n,a)}},{key:"drawToSvgPath",value:function(t,e,i,n){var r=this.parseSize(t)/2;return"M ".concat(e-r,", ").concat(i," a ").concat(r,",").concat(r," 0 1,0 ").concat(2*r,",0 a ").concat(r,",").concat(r," 0 1,0 -").concat(2*r,",0")}}])}(cp),pp=new dp;var fp=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="cross",t.pathStr="M-0.5,-0.2L-0.5,0.2L-0.2,0.2L-0.2,0.5L0.2,0.5L0.2,0.2L0.5,0.2L0.5,-0.2L0.2,-0.2L0.2,-0.5L-0.2,-0.5L-0.2,-0.2Z",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n,r){return function(t,e,i,n,r){return t.moveTo(-3*e+i,-e+n,r),t.lineTo(-e+i,-e+n,r),t.lineTo(-e+i,-3*e+n,r),t.lineTo(e+i,-3*e+n,r),t.lineTo(e+i,-e+n,r),t.lineTo(3*e+i,-e+n,r),t.lineTo(3*e+i,e+n,r),t.lineTo(e+i,e+n,r),t.lineTo(e+i,3*e+n,r),t.lineTo(-e+i,3*e+n,r),t.lineTo(-e+i,e+n,r),t.lineTo(-3*e+i,e+n,r),t.closePath(),!0}(t,this.parseSize(e)/6,i,n,r)}},{key:"drawOffset",value:function(t,e,i,n,r,a){return function(t,e,i,n,r,a){return t.moveTo(-3*e+i-r,-e+n-r,a),t.lineTo(-e+i-r,-e+n-r,a),t.lineTo(-e+i-r,-3*e+n-r,a),t.lineTo(e+i+r,-3*e+n-r,a),t.lineTo(e+i+r,-e+n-r,a),t.lineTo(3*e+i+r,-e+n-r,a),t.lineTo(3*e+i+r,e+n+r,a),t.lineTo(e+i+r,e+n+r,a),t.lineTo(e+i+r,3*e+n+r,a),t.lineTo(-e+i-r,3*e+n+r,a),t.lineTo(-e+i-r,e+n+r,a),t.lineTo(-3*e+i-r,e+n+r,a),t.closePath(),!0}(t,this.parseSize(e)/6,i,n,r,a)}}])}(cp),vp=new fp;function gp(t,e,i,n,r){return t.moveTo(i,n-e,r),t.lineTo(e+i,n,r),t.lineTo(i,n+e,r),t.lineTo(i-e,n,r),t.closePath(),!0}var yp=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="diamond",t.pathStr="M-0.5,0L0,-0.5L0.5,0L0,0.5Z",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n,r){return gp(t,this.parseSize(e)/2,i,n,r)}},{key:"drawFitDir",value:function(t,e,i,n,r){return gp(t,this.parseSize(e)/2,i,n,r)}},{key:"drawOffset",value:function(t,e,i,n,r,a){return gp(t,this.parseSize(e)/2+r,i,n,a)}}])}(cp),mp=new yp;function _p(t,e,i,n){var r=2*e;return t.rect(i-e,n-e,r,r),!1}var bp=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="square",t.pathStr="M-0.5,-0.5h1v1h-1Z",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return _p(t,this.parseSize(e)/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return _p(t,this.parseSize(e)/2+r,i,n)}}])}(cp),xp=new bp;function kp(t,e,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return t.moveTo(i+e+2*r,e+n+r),t.lineTo(i-e-2*r,e+n+r),t.lineTo(i,n-e-2*r),t.closePath(),!0}var Sp=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="triangleUp",t.pathStr="M0.5,0.5 L-0.5,0.5 L0,-0.5 Z",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return kp(t,this.parseSize(e)/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return kp(t,this.parseSize(e)/2,i,n,r)}}])}(cp),Ap=new Sp,Mp=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="triangle",t}return h(e,t),o(e)}(Sp),wp=new Mp,Tp=Math.sin(Math.PI/10)/Math.sin(7*Math.PI/10),Cp=Math.sin(oe/10)*Tp,Ep=-Math.cos(oe/10)*Tp;function Pp(t,e,i,n){var r=Cp*e,a=Ep*e;t.moveTo(i,-e+n),t.lineTo(r+i,a+n);for(var o=1;o<5;++o){var s=oe*o/5,l=Math.cos(s),u=Math.sin(s);t.lineTo(u*e+i,-l*e+n),t.lineTo(l*r-u*a+i,u*r+l*a+n)}return t.closePath(),!0}var Rp=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="star",t.pathStr="M0 -1L0.22451398828979266 -0.3090169943749474L0.9510565162951535 -0.30901699437494745L0.3632712640026804 0.1180339887498948L0.5877852522924732 0.8090169943749473L8.326672684688674e-17 0.3819660112501051L-0.587785252292473 0.8090169943749476L-0.3632712640026804 0.11803398874989487L-0.9510565162951536 -0.30901699437494723L-0.22451398828979274 -0.30901699437494734Z",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return Pp(t,this.parseSize(e)/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return Pp(t,this.parseSize(e)/2+r,i,n)}}])}(cp),Bp=new Rp,Ip=fe(3);function Lp(t,e,i,n){var r=e,a=r/Ip,o=a/5,s=e;return t.moveTo(0+i,-r+n),t.lineTo(a/2+i,n),t.lineTo(o/2+i,n),t.lineTo(o/2+i,s+n),t.lineTo(-o/2+i,s+n),t.lineTo(-o/2+i,n),t.lineTo(-a/2+i,n),t.closePath(),!0}var Dp=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="arrow",t.pathStr="M-0.07142857142857142,0.5L0.07142857142857142,0.5L0.07142857142857142,-0.0625L0.2,-0.0625L0,-0.5L-0.2,-0.0625L-0.07142857142857142,-0.0625Z",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return Lp(t,this.parseSize(e)/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return Lp(t,this.parseSize(e)/2+r,i,n)}}])}(cp),Op=new Dp;function Fp(t,e,i,n){var r=2*e;return t.moveTo(i,-e+n),t.lineTo(r/3/2+i,e+n),t.lineTo(-r/3/2+i,e+n),t.closePath(),!0}var zp=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="wedge",t.pathStr="M0,-0.5773502691896257L-0.125,0.28867513459481287L0.125,0.28867513459481287Z",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return Fp(t,this.parseSize(e)/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return Fp(t,this.parseSize(e)/2+r,i,n)}}])}(cp),Hp=new zp;function jp(t,e,i,n){return t.moveTo(-e+i,n),t.lineTo(i,e+n),!1}var Np=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="stroke",t.pathStr="",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return jp(t,this.parseSize(e)/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return jp(t,this.parseSize(e)/2+r,i,n)}}])}(cp),Vp=new Np,Wp=-.5,Gp=fe(3)/2,Up=1/fe(12);function Yp(t,e,i,n){var r=e/2,a=e*Up,o=r,s=e*Up+e,l=-o,u=s;return t.moveTo(r+i,a+n),t.lineTo(o+i,s+n),t.lineTo(l+i,u+n),t.lineTo(Wp*r-Gp*a+i,Gp*r+Wp*a+n),t.lineTo(Wp*o-Gp*s+i,Gp*o+Wp*s+n),t.lineTo(Wp*l-Gp*u+i,Gp*l+Wp*u+n),t.lineTo(Wp*r+Gp*a+i,Wp*a-Gp*r+n),t.lineTo(Wp*o+Gp*s+i,Wp*s-Gp*o+n),t.lineTo(Wp*l+Gp*u+i,Wp*u-Gp*l+n),t.closePath(),!1}var Xp=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="wye",t.pathStr="M0.25 0.14433756729740646L0.25 0.6443375672974064L-0.25 0.6443375672974064L-0.25 0.14433756729740643L-0.6830127018922193 -0.10566243270259357L-0.4330127018922193 -0.5386751345948129L0 -0.28867513459481287L0.4330127018922193 -0.5386751345948129L0.6830127018922193 -0.10566243270259357Z",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return Yp(t,this.parseSize(e)/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return Yp(t,this.parseSize(e)/2+r,i,n)}}])}(cp),Kp=new Xp;function qp(t,e,i,n,r){return t.moveTo(-e+i-2*r,n),t.lineTo(e+i+r,e+n+2*r),t.lineTo(e+i+r,n-e-2*r),t.closePath(),!0}var Zp=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="triangleLeft",t.pathStr="M-0.5,0 L0.5,0.5 L0.5,-0.5 Z",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return qp(t,this.parseSize(e)/2,i,n,0)}},{key:"drawOffset",value:function(t,e,i,n,r){return qp(t,this.parseSize(e)/2,i,n,r)}}])}(cp),Jp=new Zp;function Qp(t,e,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return t.moveTo(i-e-r,e+n+2*r),t.lineTo(e+i+2*r,n),t.lineTo(i-e-r,n-e-2*r),t.closePath(),!0}var $p=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="triangleRight",t.pathStr="M-0.5,0.5 L0.5,0 L-0.5,-0.5 Z",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return Qp(t,this.parseSize(e)/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return Qp(t,this.parseSize(e)/2,i,n,r)}}])}(cp),tf=new $p;function ef(t,e,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return t.moveTo(i-e-2*r,n-e-r),t.lineTo(i+e+2*r,n-e-r),t.lineTo(i,n+e+2*r),t.closePath(),!0}var nf=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="triangleDown",t.pathStr="M-0.5,-0.5 L0.5,-0.5 L0,0.5 Z",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return ef(t,this.parseSize(e)/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return ef(t,this.parseSize(e)/2,i,n,r)}}])}(cp),rf=new nf,af=fe(3);function of(t,e,i,n){var r=e*af;return t.moveTo(i,n+-r/3*2),t.lineTo(e+i,n+r),t.lineTo(i-e,n+r),t.closePath(),!0}var sf=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="thinTriangle",t.pathStr="M0,-0.5773502691896257L-0.5,0.28867513459481287L0.5,0.28867513459481287Z",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return of(t,this.parseSize(e)/2/af,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return of(t,this.parseSize(e)/2/af+r,i,n)}}])}(cp),lf=new sf;function uf(t,e,i,n){var r=2*e;return t.moveTo(e+i,n-r),t.lineTo(i-e,n),t.lineTo(e+i,r+n),!0}var cf=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="arrow2Left",t.pathStr="M 0.25 -0.5 L -0.25 0 l 0.25 0.5",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return uf(t,this.parseSize(e)/4,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return uf(t,this.parseSize(e)/4+r,i,n)}}])}(cp),hf=new cf;function df(t,e,i,n){var r=2*e;return t.moveTo(i-e,n-r),t.lineTo(i+e,n),t.lineTo(i-e,r+n),!0}var pf=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="arrow2Right",t.pathStr="M -0.25 -0.5 l 0.25 0 l -0.25 0.5",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return df(t,this.parseSize(e)/4,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return df(t,this.parseSize(e)/4+r,i,n)}}])}(cp),ff=new pf;function vf(t,e,i,n){var r=2*e;return t.moveTo(i-r,n+e),t.lineTo(i,n-e),t.lineTo(i+r,n+e),!0}var gf=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="arrow2Up",t.pathStr="M -0.5 0.25 L 0 -0.25 l 0.5 0.25",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return vf(t,this.parseSize(e)/4,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return vf(t,this.parseSize(e)/4+r,i,n)}}])}(cp),yf=new gf;function mf(t,e,i,n){var r=2*e;return t.moveTo(i-r,n-e),t.lineTo(i,n+e),t.lineTo(i+r,n-e),!0}var _f=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="arrow2Down",t.pathStr="M -0.5 -0.25 L 0 0.25 l 0.5 -0.25",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return mf(t,this.parseSize(e)/4,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return mf(t,this.parseSize(e)/4+r,i,n)}}])}(cp),bf=new _f;function xf(t,e,i,n,r){return t.moveTo(i,n-e),t.lineTo(i,n+e),!0}var kf=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="lineV",t.pathStr="M0,-0.5L0,0.5",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n,r){return xf(t,this.parseSize(e)/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r,a){return xf(t,this.parseSize(e)/2+r,i,n)}},{key:"drawToSvgPath",value:function(t,e,i,n){var r=this.parseSize(t)/2;return"M ".concat(e,", ").concat(i-r," L ").concat(e,",").concat(i+r)}}])}(cp),Sf=new kf;function Af(t,e,i,n,r){return t.moveTo(i-e,n),t.lineTo(i+e,n),!0}var Mf=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="lineH",t.pathStr="M-0.5,0L0.5,0",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n,r){return Af(t,this.parseSize(e)/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r,a){return Af(t,this.parseSize(e)/2+r,i,n)}},{key:"drawToSvgPath",value:function(t,e,i,n){var r=this.parseSize(t)/2;return"M ".concat(e-r,", ").concat(i," L ").concat(e+r,",").concat(i)}}])}(cp),wf=new Mf;function Tf(t,e,i,n,r){return t.moveTo(i-e,n-e),t.lineTo(i+e,n+e),t.moveTo(i+e,n-e),t.lineTo(i-e,n+e),!0}var Cf=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="close",t.pathStr="M-0.5,-0.5L0.5,0.5,M0.5,-0.5L-0.5,0.5",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n,r){return Tf(t,this.parseSize(e)/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r,a){return Tf(t,this.parseSize(e)/2+r,i,n)}},{key:"drawToSvgPath",value:function(t,e,i,n){var r=this.parseSize(t)/2;return"M ".concat(e-r,", ").concat(i-r," L ").concat(e+r,",").concat(i+r," M ").concat(e+r,", ").concat(i-r," L ").concat(e-r,",").concat(i+r)}}])}(cp),Ef=new Cf;function Pf(t,e,i,n){return t.rect(i-e[0]/2,n-e[1]/2,e[0],e[1]),!1}function Rf(t,e,i,n){var r=e,a=e/2;return t.rect(i-r/2,n-a/2,r,a),!1}var Bf=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="rect",t.pathStr="M -0.5,0.25 L 0.5,0.25 L 0.5,-0.25,L -0.5,-0.25 Z",t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){return Z(e)?Rf(t,e,i,n):Pf(t,e,i,n)}},{key:"drawWithClipRange",value:function(t,e,i,n,r,a,o){Z(e)&&(e=[e,e/2]);var s=2*(e[0]+e[1])*r,l=[{x:i+e[0]/2,y:n-e[1]/2},{x:i+e[0]/2,y:n+e[1]/2},{x:i-e[0]/2,y:n+e[1]/2},{x:i-e[0]/2,y:n-e[1]/2}],u=0,c=l[3];t.moveTo(c.x,c.y);for(var h=0;h<l.length;h++){var d=l[h],p=Math.sqrt((d.x-c.x)*(d.x-c.x)+(d.y-c.y)*(d.y-c.y));if(u+p>s){var f=(d.x-c.x)*(s-u)/p,v=(d.y-c.y)*(s-u)/p;t.lineTo(c.x+f,c.y+v);break}t.lineTo(d.x,d.y),c=d,u+=p}return!1}},{key:"drawOffset",value:function(t,e,i,n,r){return Z(e)?Rf(t,e+2*r,i,n):Pf(t,[e[0]+2*r,e[1]+2*r],i,n)}}])}(cp),If=new Bf,Lf=new pi,Df=function(){return o((function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r(this,t),this.pathStr="",this.type=e,X(i)?this.svgCache=i:this.path=i,this.isSvg=n}),[{key:"drawOffset",value:function(t,e,i,n,r,a,o){return e=this.parseSize(e),this.isSvg?!!this.svgCache&&(this.svgCache.forEach((function(r){t.beginPath(),Nl(r.path.commandList,t,i,n,e,e),o&&o(r.path,r.attribute)})),!1):(Nl(this.path.commandList,t,i,n,e+r,e+r),!1)}},{key:"draw",value:function(t,e,i,n,r,a){return e=this.parseSize(e),this.drawOffset(t,e,i,n,0,r,a)}},{key:"parseSize",value:function(t){return Z(t)?t:Math.min(t[0],t[1])}},{key:"drawWithClipRange",value:function(t,e,i,n,r,a,o){return e=this.parseSize(e),this.isSvg?!!this.svgCache&&(this.svgCache.forEach((function(a){a.path.drawWithClipRange(t,e,i,n,r),o&&o(a.path,a.attribute)})),!1):(this.path.drawWithClipRange(t,e,i,n,r),!1)}},{key:"bounds",value:function(t,e){if(t=this.parseSize(t),this.isSvg){if(!this.svgCache)return;return e.clear(),void this.svgCache.forEach((function(i){var n=i.path;Lf.x1=n.bounds.x1*t,Lf.y1=n.bounds.y1*t,Lf.x2=n.bounds.x2*t,Lf.y2=n.bounds.y2*t,e.union(Lf)}))}this.path.bounds&&(e.x1=this.path.bounds.x1*t,e.y1=this.path.bounds.y1*t,e.x2=this.path.bounds.x2*t,e.y2=this.path.bounds.y2*t)}}])}(),Of={};[pp,vp,mp,xp,lf,wp,Bp,Op,Hp,Vp,Kp,Jp,tf,Ap,rf,hf,ff,yf,bf,If,Sf,wf,Ef].forEach((function(t){Of[t.type]=t}));var Ff={arrowLeft:"M 0.25 -0.5 L -0.25 0 l 0.5 0.5",arrowRight:"M -0.25 -0.5 l 0.5 0.5 l -0.5 0.5",rectRound:"M 0.3 -0.5 C 0.41 -0.5 0.5 -0.41 0.5 -0.3 C 0.5 -0.3 0.5 0.3 0.5 0.3 C 0.5 0.41 0.41 0.5 0.3 0.5 C 0.3 0.5 -0.3 0.5 -0.3 0.5 C -0.41 0.5 -0.5 0.41 -0.5 0.3 C -0.5 0.3 -0.5 -0.3 -0.5 -0.3 C -0.5 -0.41 -0.41 -0.5 -0.3 -0.5 C -0.3 -0.5 0.3 -0.5 0.3 -0.5 Z",roundLine:"M 1.2392 -0.258 L -1.3432 -0.258 C -1.4784 -0.258 -1.588 -0.1436 -1.588 -0.002 c 0 0.1416 0.1096 0.256 0.2448 0.256 l 2.5824 0 c 0.1352 0 0.2448 -0.1144 0.2448 -0.256 C 1.484 -0.1436 1.3744 -0.258 1.2392 -0.258 z"};var zf=function(){return o((function t(e){r(this,t),this.tagname=e,this.child=[],this[":@"]={}}),[{key:"add",value:function(t,e){"__proto__"===t&&(t="#__proto__"),this.child.push(l({},t,e))}},{key:"addChild",value:function(t){"__proto__"===t.tagname&&(t.tagname="#__proto__"),t[":@"]&&Object.keys(t[":@"]).length>0?this.child.push(l(l({},t.tagname,t.child),":@",t[":@"])):this.child.push(l({},t.tagname,t.child))}}])}();function Hf(t,e,i,n){var r=t.indexOf(e,i);if(-1===r)throw new Error(n);return r+e.length-1}function jf(t,e,i){var n=function(t,e){for(var i,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:">",r="",a=e;a<t.length;a++){var o=t[a];if(i)o===i&&(i="");else if('"'===o||"'"===o)i=o;else if(o===n[0]){if(!n[1])return{data:r,index:a};if(t[a+1]===n[1])return{data:r,index:a}}else"\t"===o&&(o=" ");r+=o}}(t,e+1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:">");if(n){var r=n.data,a=n.index,o=r.search(/\s/),s=r,l=!0;-1!==o&&(s=r.substr(0,o).replace(/\s\s*$/,""),r=r.substr(o+1));var u=s;if(i){var c=s.indexOf(":");-1!==c&&(l=(s=s.substr(c+1))!==n.data.substr(c+1))}return{tagName:s,tagExp:r,closeIndex:a,attrExpPresent:l,rawTagName:u}}}var Nf=new RegExp("([^\\s=]+)\\s*(=\\s*(['\"])([\\s\\S]*?)\\3)?","gm"),Vf=function(){return o((function t(e){r(this,t),this.currentNode=null,this.options=e,this.tagsNodeStack=[],this.docTypeEntities={}}),[{key:"addChild",value:function(t,e,i){var n=e.tagname;"string"==typeof n?(e.tagname=n,t.addChild(e)):t.addChild(e)}},{key:"buildAttributesMap",value:function(t,e,i){var n={};if(t){for(var r=function(t,e){for(var i=[],n=e.exec(t);n;){var r=[];r.startIndex=e.lastIndex-n[0].length;for(var a=n.length,o=0;o<a;o++)r.push(n[o]);i.push(r),n=e.exec(t)}return i}(t,Nf),a=r.length,o=0;o<a;o++){var s=r[o][1],l=r[o][4];s&&(n[s]=void 0===l||(isNaN(l)?l:Number(l)))}return n}}},{key:"parseXml",value:function(t){t=t.replace(/\r\n?/g,"\n");for(var e=new zf("!xml"),i=e,n="",r="",a=0;a<t.length;a++)if("<"===t[a])if("/"===t[a+1]){var o=Hf(t,">",a,"Closing Tag is not closed."),s=r.lastIndexOf(".");r=r.substring(0,s),(i=this.tagsNodeStack.pop())&&i.child&&n&&i.child[i.child.length-1][":@"]&&(i.child[i.child.length-1][":@"].text=n),n="",a=o}else if("?"===t[a+1])a=jf(t,a,!1,"?>").closeIndex+1;else if("!--"===t.substr(a+1,3))a=Hf(t,"--\x3e",a+4,"Comment is not closed.");else{var l=jf(t,a,!1),u=l.tagName,c=l.tagExp,h=l.attrExpPresent,d=l.closeIndex;if(u!==e.tagname&&(r+=r?"."+u:u),c.length>0&&c.lastIndexOf("/")===c.length-1){"/"===u[u.length-1]?(u=u.substr(0,u.length-1),r=r.substr(0,r.length-1),c=u):c=c.substr(0,c.length-1);var p=new zf(u);u!==c&&h&&(p[":@"]=this.buildAttributesMap(c,r,u)),this.addChild(i,p,r),r=r.substr(0,r.lastIndexOf("."))}else{var f=new zf(u);this.tagsNodeStack.push(i),u!==c&&h&&(f[":@"]=this.buildAttributesMap(c,r,u)),this.addChild(i,f,r),i=f}n="",a=d}else n+=t[a];return e.child}}])}();function Wf(t,e){return Gf(t)}function Gf(t,e){for(var i,n={},r=0;r<t.length;r++){var a=t[r],o=Uf(a);if(void 0!==o&&a[o]){var s=Gf(a[o]);i=s,Object.keys(i).length,a[":@"]&&Yf(s,a[":@"]),void 0!==n[o]&&n.hasOwnProperty(o)?(Array.isArray(n[o])||(n[o]=[n[o]]),n[o].push(s)):n[o]=s}}return n}function Uf(t){for(var e=Object.keys(t),i=0;i<e.length;i++){var n=e[i];if(":@"!==n)return n}}function Yf(t,e,i){if(e)for(var n=Object.keys(e),r=n.length,a=0;a<r;a++){var o=n[a];t[o]=e[o]}}var Xf=function(){return o((function t(e){r(this,t),this.options=Object.assign({},t.defaultOptions,e)}),[{key:"valid",value:function(t){return t.startsWith("<")}},{key:"parse",value:function(t){return!!this.valid&&Wf(new Vf(this.options).parseXml(t),this.options)}}])}();Xf.defaultOptions={};var Kf=function(t,e,i,n){return new(i||(i=Promise))((function(r,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,s)}l((n=n.apply(t,e||[])).next())}))};function qf(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return t.expand(e+(n/2+(i?function(t,e){return t?e:0}(i,e):0))),t}var Zf,Jf=0;function Qf(){return Jf++}!function(t){t[t.HORIZONTAL=0]="HORIZONTAL",t[t.VERTICAL=1]="VERTICAL"}(Zf||(Zf={}));var $f=new Map;["…","（","）","—","【","】","「","」","《","》"].forEach((function(t){return $f.set(t,!0)}));var tv=new Map;function ev(t){if($f.has(t))return!0;if(tv.has(t))return!1;var e=!1;return t.codePointAt(0)<256&&(e=!0),e}[""].forEach((function(t){return tv.set(t,!0)}));var iv=Qf(),nv=Qf(),rv=Qf(),av=Qf(),ov=Qf(),sv=Qf(),lv=Qf(),uv=Qf(),cv=Qf(),hv=Qf(),dv=Qf(),pv=Qf(),fv=Qf(),vv=Qf();Qf();var gv=Qf(),yv=Qf(),mv=Symbol.for("GraphicService"),_v=Symbol.for("GraphicCreator"),bv={"stroke-linecap":"lineCap","stroke-linejoin":"lineJoin","stroke-dasharray":"lineDash","stroke-dashoffset":"lineDashOffset","stroke-width":"lineWidth","fill-opacity":"fillOpacity","stroke-opacity":"strokeOpacity",stroke:"stroke",fill:"fill"},xv=Object.keys(bv),kv=new pi,Sv=new vi;new pi;var Av,Mv=["lineWidth","scaleX","scaleY","angle","anchor","visible"],wv=["x","y"],Tv=["scaleX","scaleY"],Cv=["angle"],Ev=new Ae,Pv={strokeSeg:1,boundsPadding:2,pickMode:1,boundsMode:1,customPickShape:1,pickable:1,childrenPickable:1,visible:1,zIndex:1,layout:1,keepDirIn3d:1,globalZIndex:1,outerBorder:1,innerBorder:1,lineDash:1,lineCap:1,lineJoin:1,miterLimit:2,strokeBoundsBuffer:2,scaleCenter:1,anchor:1,anchor3d:1,postMatrix:1,backgroundMode:2,background:1,texture:1,cursor:1,html:1},Rv=function(t){function e(){var t,i,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r(this,e),(t=n(this,e))._AABBBounds=new pi,t._updateTag=kl.INIT,t.attribute=a,t.valid=t.isValid(),t.updateAABBBoundsStamp=0,a.background?t.loadImage(null!==(i=a.background.background)&&void 0!==i?i:a.background,!0):a.shadowGraphic&&t.setShadowGraphic(a.shadowGraphic),t}return h(e,t),o(e,[{key:"AABBBounds",get:function(){return this.tryUpdateAABBBounds()}},{key:"OBBBounds",get:function(){return this.tryUpdateOBBBounds()}},{key:"globalAABBBounds",get:function(){return this.tryUpdateGlobalAABBBounds()}},{key:"transMatrix",get:function(){return this.tryUpdateLocalTransMatrix(!0)}},{key:"globalTransMatrix",get:function(){return this.tryUpdateGlobalTransMatrix(!0)}},{key:"setMode",value:function(t){"3d"===t?this.set3dMode():this.set2dMode()}},{key:"set3dMode",value:function(){this.in3dMode=!0}},{key:"set2dMode",value:function(){this.in3dMode=!1}},{key:"getOffsetXY",value:function(t){var e,i,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.attribute,a=r.dx,o=void 0===a?t.dx:a,s=r.dy,l=void 0===s?t.dy:s;if(n&&this.parent){var u=this.parent.attribute;Ev.x=o+(null!==(e=u.scrollX)&&void 0!==e?e:0),Ev.y=l+(null!==(i=u.scrollY)&&void 0!==i?i:0)}else Ev.x=o,Ev.y=l;return Ev}},{key:"onAnimateBind",value:function(t){this._emitCustomEvent("animate-bind",t)}},{key:"tryUpdateAABBBounds",value:function(){var t="imprecise"===this.attribute.boundsMode;if(!this.shouldUpdateAABBBounds())return this._AABBBounds;if(!this.valid)return this._AABBBounds.clear(),this._AABBBounds;nc.graphicService.beforeUpdateAABBBounds(this,this.stage,!0,this._AABBBounds);var e=this.doUpdateAABBBounds(t);return nc.graphicService.afterUpdateAABBBounds(this,this.stage,this._AABBBounds,this,!0),"empty"===this.attribute.boundsMode&&e.clear(),e}},{key:"tryUpdateOBBBounds",value:function(){return this._OBBBounds||(this._OBBBounds=new fi),this.tryUpdateAABBBounds(),this.updateOBBBoundsStamp===this.updateAABBBoundsStamp?this._OBBBounds:(this.updateOBBBoundsStamp=this.updateAABBBoundsStamp,this.valid?this.doUpdateOBBBounds():(this._OBBBounds.clear(),this._OBBBounds))}},{key:"combindShadowAABBBounds",value:function(t){if(this.shadowRoot){var e=this.shadowRoot.AABBBounds.clone();t.union(e)}}},{key:"doUpdateOBBBounds",value:function(){return this._OBBBounds}},{key:"getClipPath",value:function(){var t=this.attribute.clipConfig;if(!t)return null;this.clipPathMap||(this.clipPathMap=new Map);var e=t.shape,i=this.clipPathMap.get(e)||null;return i||(this.clipPathMap.size>10&&this.clipPathMap.clear(),(i=this.parsePath(e))&&this.clipPathMap.set(e,i)),i}},{key:"parsePath",value:function(t){if(!t)return null;var i,n=Of[t];if(n)return n;if(n=e.userSymbolMap[t])return n;if(!0===((i=t=Ff[t]||t).startsWith("<svg")||i.startsWith("<?xml"))){var r=(new Xf).parse(t).svg;if(!r)return null;var a=X(r.path)?r.path:[r.path];kv.clear();var o=[];a.forEach((function(t){var e=(new Ru).fromString(t.d),i={};xv.forEach((function(e){t[e]&&(i[bv[e]]=t[e])})),o.push({path:e,attribute:i}),kv.union(e.bounds)}));var s=kv.width(),l=kv.height(),u=1/he(s,l);o.forEach((function(t){return t.path.transform(0,0,u,u)}));var c=new Df(t,o,!0);return e.userSymbolMap[t]=c,c}var h=(new Ru).fromString(t),d=h.bounds.width(),p=h.bounds.height(),f=1/he(d,p);h.transform(0,0,f,f);var v=new Df(t,h);return e.userSymbolMap[t]=v,v}},{key:"doUpdateAABBBounds",value:function(t){this.updateAABBBoundsStamp++;var e=this.getGraphicTheme();this._AABBBounds.clear();var i=this.attribute,n=this.updateAABBBounds(i,e,this._AABBBounds,t),r=i.boundsPadding,a=void 0===r?e.boundsPadding:r,o=rd(a);return o&&n.expand(o),this.clearUpdateBoundTag(),n}},{key:"updatePathProxyAABBBounds",value:function(t){var e="function"==typeof this.pathProxy?this.pathProxy(this.attribute):this.pathProxy;if(!e)return!1;var i=new Bl(t);return Nl(e.commandList,i,0,0),!0}},{key:"tryUpdateGlobalAABBBounds",value:function(){var t=this.AABBBounds;return this._globalAABBBounds?this._globalAABBBounds.setValue(t.x1,t.y1,t.x2,t.y2):this._globalAABBBounds=t.clone(),this._globalAABBBounds.empty()||this.parent&&this._globalAABBBounds.transformWithMatrix(this.parent.globalTransMatrix),this._globalAABBBounds}},{key:"tryUpdateGlobalTransMatrix",value:function(){if(this._globalTransMatrix){if(this.parent){var t=this.parent.globalTransMatrix;this._globalTransMatrix.setValue(t.a,t.b,t.c,t.d,t.e,t.f)}}else this._globalTransMatrix=this.parent?this.parent.globalTransMatrix.clone():this.transMatrix.clone();return this.shouldUpdateGlobalMatrix()&&this.doUpdateGlobalMatrix(),this._globalTransMatrix}},{key:"shouldUpdateGlobalMatrix",value:function(){return!0}},{key:"tryUpdateLocalTransMatrix",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._transMatrix||(this._transMatrix=new vi),this.shouldUpdateLocalMatrix()&&(this.doUpdateLocalMatrix(),t&&this.clearUpdateLocalPositionTag()),this._transMatrix}},{key:"shouldUpdateAABBBounds",value:function(){return this.shadowRoot?(!!(this._updateTag&kl.UPDATE_BOUNDS)||this.shadowRoot.shouldUpdateAABBBounds())&&nc.graphicService.validCheck(this.attribute,this.getGraphicTheme(),this._AABBBounds,this):!!(this._updateTag&kl.UPDATE_BOUNDS)&&nc.graphicService.validCheck(this.attribute,this.getGraphicTheme(),this._AABBBounds,this)}},{key:"shouldSelfChangeUpdateAABBBounds",value:function(){return this.shadowRoot?!!(this._updateTag&kl.UPDATE_BOUNDS)||this.shadowRoot.shouldUpdateAABBBounds():!!(this._updateTag&kl.UPDATE_BOUNDS)}},{key:"shouldUpdateLocalMatrix",value:function(){return!!(this._updateTag&kl.UPDATE_LOCAL_MATRIX)}},{key:"isValid",value:function(){var t,e,i=this.attribute;return Number.isFinite((null!==(t=i.x)&&void 0!==t?t:0)+(null!==(e=i.y)&&void 0!==e?e:0))}},{key:"_validNumber",value:function(t){return null==t||Number.isFinite(t)}},{key:"shouldUpdateShape",value:function(){return!!(this._updateTag&kl.UPDATE_SHAPE)}},{key:"clearUpdateShapeTag",value:function(){this._updateTag&=kl.CLEAR_SHAPE}},{key:"containsPoint",value:function(t,e,i,n){if(!n)return!1;if(i===Sl.GLOBAL){var r=new Ae(t,e);this.parent&&this.parent.globalTransMatrix.transformPoint(r,r),t=r.x,e=r.y}return n.containsPoint(this,{x:t,y:e})}},{key:"setWidthHeightWithoutTransform",value:function(t){this.widthWithoutTransform=t.x2-t.x1,this.heightWithoutTransform=t.y2-t.y1}},{key:"setAttributes",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0;(t=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,null,i)||t).background?this.loadImage(t.background,!0):t.shadowGraphic&&this.setShadowGraphic(t.shadowGraphic),this._setAttributes(t,e,i)}},{key:"_setAttributes",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0,n=Object.keys(t),r=0;r<n.length;r++){var a=n[r];this.attribute[a]=t[a]}this.valid=this.isValid(),this.updateShapeAndBoundsTagSetted()||!e&&!this.needUpdateTags(n)?this.addUpdateBoundTag():this.addUpdateShapeAndBoundsTag(),this.addUpdatePositionTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(i)}},{key:"setAttribute",value:function(t,e,i,n){var r,a=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(l({},t,e),this.attribute,t,n);a?this._setAttributes(a,i,n):j(null===(r=this.normalAttrs)||void 0===r?void 0:r[t])?(this.attribute[t]=e,this.valid=this.isValid(),this.updateShapeAndBoundsTagSetted()||!i&&!this.needUpdateTag(t)?this.addUpdateBoundTag():this.addUpdateShapeAndBoundsTag(),this.addUpdatePositionTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(n)):this.normalAttrs[t]=e,"background"===t?this.loadImage(e,!0):"shadowGraphic"===t&&this.setShadowGraphic(e)}},{key:"needUpdateTags",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Mv,i=0;i<e.length;i++){var n=e[i];if(-1!==t.indexOf(n))return!0}return!1}},{key:"needUpdateTag",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Mv,i=0;i<e.length;i++)if(t===e[i])return!0;return!1}},{key:"initAttributes",value:function(t){var e={type:Al.INIT};t=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,null,e)||t,this.attribute=t,t.background?this.loadImage(t.background,!0):t.shadowGraphic&&this.setShadowGraphic(t.shadowGraphic),this._updateTag=kl.INIT,this.valid=this.isValid(),this.onAttributeUpdate(e)}},{key:"translate",value:function(t,e){var i,n;if(0===t&&0===e)return this;var r={type:Al.TRANSLATE},a=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({x:t,y:e},this.attribute,wv,r);a&&(t=a.x,e=a.y,delete a.x,delete a.y,this._setAttributes(a));var o=this.attribute,s=o.postMatrix;return s?nc.transformUtil.fromMatrix(s,s).translate(t,e):(o.x=(null!==(i=o.x)&&void 0!==i?i:Lu.x)+t,o.y=(null!==(n=o.y)&&void 0!==n?n:Lu.y)+e),this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(r),this}},{key:"translateTo",value:function(t,e){var i=this.attribute;if(i.x===t&&i.y===e)return this;var n={type:Al.TRANSLATE_TO},r=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({x:t,y:e},this.attribute,wv,n);return r?(this._setAttributes(r,!1,n),this):(i.x=t,i.y=e,this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(n),this)}},{key:"scale",value:function(t,e,i){var n,r;if(1===t&&1===e)return this;var a={type:Al.SCALE},o=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({scaleX:t,scaleY:e,scaleCenter:i},this.attribute,Tv,a);o&&(t=o.scaleX,e=o.scaleY,delete o.scaleX,delete o.scaleY,this._setAttributes(o));var s=this.attribute;if(i){var l=this.attribute.postMatrix;l||(l=new vi,s.postMatrix=l),nc.transformUtil.fromMatrix(l,l).scale(t,e,i)}else s.scaleX=(null!==(n=s.scaleX)&&void 0!==n?n:Lu.scaleX)*t,s.scaleY=(null!==(r=s.scaleY)&&void 0!==r?r:Lu.scaleY)*e;return this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(a),this}},{key:"scaleTo",value:function(t,e){var i=this.attribute;if(i.scaleX===t&&i.scaleY===e)return this;var n={type:Al.SCALE_TO},r=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({scaleX:t,scaleY:e},this.attribute,Tv,n);return r?(this._setAttributes(r,!1,n),this):(i.scaleX=t,i.scaleY=e,this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(n),this)}},{key:"rotate",value:function(t,e){var i;if(0===t)return this;var n={type:Al.ROTATE},r=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({angle:t,rotateCenter:e},this.attribute,Cv,n);r&&(delete r.angle,this._setAttributes(r,!1,n));var a=this.attribute;if(e){var o=this.attribute.postMatrix;o||(o=new vi,a.postMatrix=o),nc.transformUtil.fromMatrix(o,o).rotate(t,e)}else a.angle=(null!==(i=a.angle)&&void 0!==i?i:Lu.angle)+t;return this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(n),this}},{key:"rotateTo",value:function(t){var e=this.attribute;if(e.angle===t)return this;var i={type:Al.ROTATE_TO},n=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,Cv,i);return n?(this._setAttributes(n,!1,i),this):(e.angle=t,this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(i),this)}},{key:"skewTo",value:function(t,e){return this}},{key:"animate",value:function(t){var e,i=this;this.animates||(this.animates=new Map);var n=new Kh(null==t?void 0:t.id,null!==(e=null==t?void 0:t.timeline)&&void 0!==e?e:this.stage&&this.stage.getTimeline(),null==t?void 0:t.slience);if(n.bind(this),t){var r=t.onStart,a=t.onFrame,o=t.onEnd,s=t.onRemove;null!=r&&n.onStart(r),null!=a&&n.onFrame(a),null!=o&&n.onEnd(o),null!=s&&n.onRemove(s),n.interpolateFunc=t.interpolate}return this.animates.set(n.id,n),n.onRemove((function(){n.stop(),i.animates.delete(n.id)})),n}},{key:"onAttributeUpdate",value:function(t){t&&t.skipUpdateCallback||(nc.graphicService.onAttributeUpdate(this),this._emitCustomEvent("afterAttributeUpdate",t))}},{key:"update",value:function(t){t?(t.bounds&&this.tryUpdateAABBBounds(),t.trans&&this.tryUpdateLocalTransMatrix()):(this.tryUpdateAABBBounds(),this.tryUpdateLocalTransMatrix())}},{key:"hasState",value:function(t){return!(!this.currentStates||!this.currentStates.length)&&(!!j(t)||this.currentStates.includes(t))}},{key:"getState",value:function(t){var e;return null===(e=this.states)||void 0===e?void 0:e[t]}},{key:"applyStateAttrs",value:function(t,e,i,n){var r,a,o,s,l=this;if(i){var u,c=Object.keys(t),h=this.getNoWorkAnimateAttr(),d={};c.forEach((function(e){h[e]?(u||(u={}),u[e]=t[e]):d[e]=n&&void 0===t[e]?l.getDefaultAttribute(e):t[e]}));var p=this.animate({slience:!0});p.stateNames=e,p.to(d,null!==(a=null===(r=this.stateAnimateConfig)||void 0===r?void 0:r.duration)&&void 0!==a?a:Qh,null!==(s=null===(o=this.stateAnimateConfig)||void 0===o?void 0:o.easing)&&void 0!==s?s:$h),u&&this.setAttributes(u,!1,{type:Al.STATE})}else this.stopStateAnimates(),this.setAttributes(t,!1,{type:Al.STATE})}},{key:"updateNormalAttrs",value:function(t){var e=this,i={};this.normalAttrs?(Object.keys(t).forEach((function(t){t in e.normalAttrs?(i[t]=e.normalAttrs[t],delete e.normalAttrs[t]):i[t]=e.getNormalAttribute(t)})),Object.keys(this.normalAttrs).forEach((function(i){t[i]=e.normalAttrs[i]}))):Object.keys(t).forEach((function(t){i[t]=e.getNormalAttribute(t)})),this.normalAttrs=i}},{key:"stopStateAnimates",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"end";this.animates&&this.animates.forEach((function(i){i.stateNames&&(i.stop(e),t.animates.delete(i.id))}))}},{key:"getNormalAttribute",value:function(t){var e=this.attribute[t];return this.animates&&this.animates.forEach((function(i){if(i.stateNames){var n=i.getEndProps();ut(n,t)&&(e=n[t])}})),e}},{key:"clearStates",value:function(t){this.hasState()&&this.normalAttrs?(this.currentStates=[],this.applyStateAttrs(this.normalAttrs,this.currentStates,t,!0)):this.currentStates=[],this.normalAttrs=null}},{key:"removeState",value:function(t,e){if(this.currentStates){var i=X(t)?function(e){return!t.includes(e)}:function(e){return e!==t},n=this.currentStates.filter(i);n.length!==this.currentStates.length&&this.useStates(n,e)}}},{key:"toggleState",value:function(t,e){if(this.hasState(t))this.removeState(t,e);else if((this.currentStates?this.currentStates.indexOf(t):-1)<0){var i=this.currentStates?this.currentStates.slice():[];i.push(t),this.useStates(i,e)}}},{key:"addState",value:function(t,e,i){var n;if(!this.currentStates||!this.currentStates.includes(t)||!e&&1!==this.currentStates.length){var r=e&&(null===(n=this.currentStates)||void 0===n?void 0:n.length)?this.currentStates.concat([t]):[t];this.useStates(r,i)}}},{key:"useStates",value:function(t,e){var i,n=this;if(t.length){if((null===(i=this.currentStates)||void 0===i?void 0:i.length)!==t.length||t.some((function(t,e){return n.currentStates[e]!==t}))){var r={};t.forEach((function(e){var i,a=n.stateProxy?n.stateProxy(e,t):null===(i=n.states)||void 0===i?void 0:i[e];a&&Object.assign(r,a)})),this.updateNormalAttrs(r),this.currentStates=t,this.applyStateAttrs(r,t,e)}}else this.clearStates(e)}},{key:"addUpdateBoundTag",value:function(){this._updateTag|=kl.UPDATE_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag(),this.glyphHost&&this.glyphHost.addUpdateBoundTag()}},{key:"addUpdateShapeTag",value:function(){this._updateTag|=kl.UPDATE_SHAPE}},{key:"addUpdateShapeAndBoundsTag",value:function(){this._updateTag|=kl.UPDATE_SHAPE_AND_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag(),this.glyphHost&&this.glyphHost.addUpdateBoundTag()}},{key:"updateShapeAndBoundsTagSetted",value:function(){return(this._updateTag&kl.UPDATE_SHAPE_AND_BOUNDS)===kl.UPDATE_SHAPE_AND_BOUNDS}},{key:"clearUpdateBoundTag",value:function(){this._updateTag&=kl.CLEAR_BOUNDS}},{key:"addUpdatePositionTag",value:function(){this.shadowRoot&&this.shadowRoot.addUpdateGlobalPositionTag(),this._updateTag|=kl.UPDATE_GLOBAL_LOCAL_MATRIX}},{key:"addUpdateGlobalPositionTag",value:function(){this.shadowRoot&&this.shadowRoot.addUpdateGlobalPositionTag(),this._updateTag|=kl.UPDATE_GLOBAL_MATRIX}},{key:"clearUpdateLocalPositionTag",value:function(){this._updateTag&=kl.CLEAR_LOCAL_MATRIX}},{key:"clearUpdateGlobalPositionTag",value:function(){this._updateTag&=kl.CLEAR_GLOBAL_MATRIX}},{key:"addUpdateLayoutTag",value:function(){this._updateTag|=kl.UPDATE_LAYOUT}},{key:"clearUpdateLayoutTag",value:function(){this._updateTag&=kl.CLEAR_LAYOUT}},{key:"needUpdateLayout",value:function(){return!!(this._updateTag&kl.UPDATE_LAYOUT)}},{key:"getAnchor",value:function(t,e,i){var n=this,r=[0,0],a=function(){if(e.b)return e.b;var t=n.clone();return t.attribute.angle=0,t.attribute.scaleCenter=null,i&&(t.attribute.scaleX=1,t.attribute.scaleY=1),e.b=t.AABBBounds,e.b};if("string"==typeof t[0]){var o=parseFloat(t[0])/100,s=a();r[0]=s.x1+(s.x2-s.x1)*o}else r[0]=t[0];if("string"==typeof t[1]){var l=parseFloat(t[1])/100,u=a();r[1]=u.y1+(u.y2-u.y1)*l}else r[1]=t[1];return r}},{key:"doUpdateLocalMatrix",value:function(){var t=this.attribute,e=t.x,i=void 0===e?Lu.x:e,n=t.y,r=void 0===n?Lu.y:n,a=t.scaleX,o=void 0===a?Lu.scaleX:a,s=t.scaleY,l=void 0===s?Lu.scaleY:s,u=t.angle,c=void 0===u?Lu.angle:u,h=t.scaleCenter,d=t.anchor,p=t.postMatrix,f=[0,0],v={};if(d&&c&&(f=this.getAnchor(d,v)),!h||1===o&&1===l)!function(t,e,i,n,r,a,o,s){var l,u,c=e.a,h=e.b,d=e.c,p=e.d,f=e.e,v=e.f,g=ce(o),y=pe(o);s?(l=s[0],u=s[1]):(l=i,u=n);var m=l-i,_=u-n,b=c*g+d*y,x=h*g+p*y,k=d*g-c*y,S=p*g-h*y;t.a=r*b,t.b=r*x,t.c=a*k,t.d=a*S,t.e=f+c*l+d*u-b*m-k*_,t.f=v+h*l+p*u-x*m-S*_}(this._transMatrix,this._transMatrix.reset(),i,r,o,l,c,d&&f);else{var g=this._transMatrix;g.reset(),g.translate(f[0],f[1]),g.rotate(c),g.translate(-f[0],-f[1]),g.translate(i,r),f=this.getAnchor(h,v,!0),nc.transformUtil.fromMatrix(g,g).scale(o,l,{x:f[0],y:f[1]})}var y=this.getOffsetXY(Lu);if(this._transMatrix.e+=y.x,this._transMatrix.f+=y.y,p){var m=Sv.setValue(p.a,p.b,p.c,p.d,p.e,p.f),_=this._transMatrix;m.multiply(_.a,_.b,_.c,_.d,_.e,_.f),_.setValue(m.a,m.b,m.c,m.d,m.e,m.f)}}},{key:"doUpdateGlobalMatrix",value:function(){if(this.parent){this._globalTransMatrix.multiply(this.transMatrix.a,this.transMatrix.b,this.transMatrix.c,this.transMatrix.d,this.transMatrix.e,this.transMatrix.f);var t=this.parent.attribute,e=t.scrollX,i=void 0===e?0:e,n=t.scrollY,r=void 0===n?0:n;this._globalTransMatrix.translate(i,r)}}},{key:"setStage",value:function(t,e){if(this.stage!==t){if(this.stage=t,this.layer=e,this.setStageToShadowRoot(t,e),this.animates&&this.animates.size){var i=t.getTimeline();this.animates.forEach((function(t){t.timeline===Uh&&t.setTimeline(i)}))}this._onSetStage&&this._onSetStage(this,t,e),nc.graphicService.onSetStage(this,t)}}},{key:"setStageToShadowRoot",value:function(t,e){this.shadowRoot&&this.shadowRoot.setStage(t,e)}},{key:"onAddStep",value:function(t){}},{key:"onStop",value:function(t){t&&this.setAttributes(t,!1,{type:Al.ANIMATE_END})}},{key:"onStep",value:function(t,e,i,n,r){var a={};if(i.customAnimate)i.customAnimate.update(r,n,a);else{var o=i.props,s=i.parsedProps,l=i.propKeys;this.stepInterpolate(t,e,a,i,n,r,o,void 0,s,l)}this.setAttributes(a,!1,{type:Al.ANIMATE_UPDATE,animationState:{ratio:n,end:r,step:i,isFirstFrameOfStep:t.getLastStep()!==i}}),this.stage&&this.stage.renderNextFrame()}},{key:"stepInterpolate",value:function(t,e,i,n,r,a,o,s,l,u){var c=this;u||(u=Object.keys(o),n.propKeys=u),a?n.propKeys.forEach((function(t){e.validAttr(t)&&(i[t]=o[t])})):u.forEach((function(a){var u;if(e.validAttr(a)){var h=o[a],d=null!==(u=s&&s[a])&&void 0!==u?u:t.getLastPropByName(a,n);if(null!=h&&null!=d&&h!==d)e.interpolateFunc&&e.interpolateFunc(a,r,d,h,i)||(e.customInterpolate(a,r,d,h,c,i)||c.defaultInterpolate(h,d,a,i,l,r)||c._interpolate(a,r,d,h,i));else i[a]=h}})),n.parsedProps=l}},{key:"defaultInterpolate",value:function(t,e,i,n,r,a){if(Number.isFinite(t)&&Number.isFinite(e))return n[i]=e+(t-e)*a,!0;if("fill"===i){r||(r={});var o=r.fillColorArray,s=Wd(e,null!=o?o:t,a,!1,(function(t,e){r.fillColorArray=e}));return s&&(n[i]=s),!0}if("stroke"===i){r||(r={});var l=r.strokeColorArray,u=Wd(e,null!=l?l:t,a,!1,(function(t,e){r.strokeColorArray=e}));return u&&(n[i]=u),!0}if("shadowColor"===i){r||(r={});var c=r.shadowColorArray,h=Wd(e,null!=c?c:t,a,!0,(function(t,e){r.shadowColorArray=e}));return h&&(n[i]=h),!0}if(Array.isArray(t)&&t.length===e.length){for(var d=[],p=!0,f=0;f<t.length;f++){var v=e[f],g=v+(t[f]-v)*a;if(!Number.isFinite(g)){p=!1;break}d.push(g)}p&&(n[i]=d)}return!1}},{key:"_interpolate",value:function(t,e,i,n,r){}},{key:"getDefaultAttribute",value:function(t){return this.getGraphicTheme()[t]}},{key:"getComputedAttribute",value:function(t){var e;return null!==(e=this.attribute[t])&&void 0!==e?e:this.getDefaultAttribute(t)}},{key:"onSetStage",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._onSetStage=t,e&&this.stage&&t(this,this.stage)}},{key:"attachShadow",value:function(t){return t&&(t.shadowHost=this),this.shadowRoot=null!=t?t:nc.graphicService.creator.shadowRoot(this),this.addUpdateBoundTag(),this.shadowRoot.setStage(this.stage,this.layer),this.shadowRoot}},{key:"detachShadow",value:function(){this.shadowRoot&&(this.addUpdateBoundTag(),this.shadowRoot.release(!0),this.shadowRoot=null)}},{key:"toJson",value:function(){return{attribute:this.attribute,_uid:this._uid,type:this.type,name:this.name,children:this.children.map((function(t){return t.toJson()}))}}},{key:"createPathProxy",value:function(t){return Y(t,!0)?this.pathProxy=(new Ru).fromString(t):this.pathProxy=new Ru,this.pathProxy}},{key:"loadImage",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!(!t||e&&function(t){return!(!t.fill&&!t.stroke)}(t))){var i=t;this.resources||(this.resources=new Map);var n={data:"init",state:null};this.resources.set(i,n),"string"==typeof t?(n.state="loading",t.startsWith("<svg")?(lp.GetSvg(t,this),this.backgroundImg=this.backgroundImg||e):($(t)||t.includes("/")||et(t))&&(lp.GetImage(t,this),this.backgroundImg=this.backgroundImg||e)):V(t)?(n.state="success",n.data=t,this.backgroundImg=this.backgroundImg||e):n.state="fail"}}},{key:"setShadowGraphic",value:function(t){t?this.attachShadow().add(t):this.detachShadow()}},{key:"imageLoadSuccess",value:function(t,e,i){if(this.resources){var n=this.resources.get(t);n&&(n.state="success",n.data=e,i&&i(),this.addUpdateBoundTag(),this.stage&&this.stage.renderNextFrame())}}},{key:"imageLoadFail",value:function(t,e){if(this.resources){var i=this.resources.get(t);i&&(i.state="fail",e&&e())}}},{key:"_stopAnimates",value:function(t){t&&t.forEach((function(t){t.stop()}))}},{key:"stopAnimates",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._stopAnimates(this.animates),this.shadowRoot&&this.shadowRoot.stopAnimates(!0),this.isContainer&&t&&this.forEachChildren((function(e){e.stopAnimates(t)}))}},{key:"release",value:function(){this.releaseStatus="released",this.stopAnimates(),nc.graphicService.onRelease(this)}},{key:"_emitCustomEvent",value:function(t,e){var i,n;if(this._events&&t in this._events){var r=new Ch(t,e);r.bubbles=!1,r.manager=null===(n=null===(i=this.stage)||void 0===i?void 0:i.eventSystem)||void 0===n?void 0:n.manager,this.dispatchEvent(r)}}}],[{key:"mixin",value:function(t){for(var i=Object.keys(t),n=0;n<i.length;++n){var r=i[n];Object.defineProperty(e.prototype,r,Object.getOwnPropertyDescriptor(t,r))}}}])}(Sh);Rv.userSymbolMap={},Rv.mixin(Ih),function(t){t[t.LESS_GROUP=0]="LESS_GROUP",t[t.MORE_GROUP=1]="MORE_GROUP"}(Av||(Av={}));var Bv=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[t])).type="group",i.parent=null,i.isContainer=!0,i.numberType=sv,i._childUpdateTag=kl.UPDATE_BOUNDS,i}return h(e,t),o(e,[{key:"setMode",value:function(t){"3d"===t?this.set3dMode():this.set2dMode()}},{key:"set3dMode",value:function(){this.in3dMode=!0}},{key:"set2dMode",value:function(){this.in3dMode=!1}},{key:"setTheme",value:function(t){return this.theme||(this.theme=new _h),this.theme.setTheme(t,this)}},{key:"createTheme",value:function(){this.theme||(this.theme=new _h)}},{key:"visibleAll",value:function(t){this.setAttribute("visible",t),this.forEachChildren((function(e){e.isContainer&&e.visibleAll?e.visibleAll(t):e.setAttribute("visible",t)}))}},{key:"hideAll",value:function(){this.visibleAll(!1)}},{key:"showAll",value:function(){this.visibleAll(!0)}},{key:"containsPoint",value:function(t,e,i){if(i===Sl.GLOBAL){var n=new Ae(t,e);return this.parent&&this.parent.globalTransMatrix.transformPoint(n,n),this.AABBBounds.contains(n.x,n.y)}return this.AABBBounds.contains(t,e)}},{key:"shouldUpdateAABBBounds",value:function(){return!!y(e,"shouldUpdateAABBBounds",this,3)([])||!!(this._childUpdateTag&kl.UPDATE_BOUNDS)}},{key:"tryUpdateAABBBounds",value:function(){if(!this.shouldUpdateAABBBounds())return this._AABBBounds;nc.graphicService.beforeUpdateAABBBounds(this,this.stage,!0,this._AABBBounds);var t=this.shouldSelfChangeUpdateAABBBounds(),e=this.doUpdateAABBBounds();return this.addUpdateLayoutTag(),nc.graphicService.afterUpdateAABBBounds(this,this.stage,this._AABBBounds,this,t),"empty"===this.attribute.boundsMode&&e.clear(),e}},{key:"doUpdateLocalMatrix",value:function(){var t=this.attribute,i=t.x,n=void 0===i?Lu.x:i,r=t.y,a=void 0===r?Lu.y:r,o=t.dx,s=void 0===o?Lu.dx:o,l=t.dy,u=void 0===l?Lu.dy:l,c=t.scaleX,h=void 0===c?Lu.scaleX:c,d=t.scaleY,p=void 0===d?Lu.scaleY:d,f=t.angle,v=void 0===f?Lu.angle:f,g=t.postMatrix;if(0!==n||0!==a||0!==s||0!==u||1!==h||1!==p||0!==v||g)return y(e,"doUpdateLocalMatrix",this,3)([]);this._transMatrix.reset()}},{key:"getGraphicTheme",value:function(){return xh(this).group}},{key:"updateAABBBounds",value:function(t,e,i){var n=i;i=i.clone();var r=t.width,a=t.height,o=t.path,s=t.clip,l=void 0===s?e.clip:s;if(o&&o.length?o.forEach((function(t){i.union(t.AABBBounds)})):null!=r&&null!=a&&i.set(0,0,Math.max(0,r),Math.max(0,a)),!l){this.forEachChildren((function(t){i.union(t.AABBBounds)}));var u=t.scrollX,c=void 0===u?0:u,h=t.scrollY,d=void 0===h?0:h;i.translate(c,d)}return nc.graphicService.updateTempAABBBounds(i),nc.graphicService.transformAABBBounds(t,i,e,!1,this),n.copy(i),n}},{key:"doUpdateAABBBounds",value:function(){this.updateAABBBoundsStamp++;var t=y(e,"doUpdateAABBBounds",this,3)([]);return this.parent&&this.parent.addChildUpdateBoundTag(),this._emitCustomEvent("AAABBBoundsChange"),t}},{key:"clearUpdateBoundTag",value:function(){this._updateTag&=kl.CLEAR_BOUNDS,this._childUpdateTag&=kl.CLEAR_BOUNDS}},{key:"addUpdateBoundTag",value:function(){this._updateTag|=kl.UPDATE_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag()}},{key:"addChildUpdateBoundTag",value:function(){this._childUpdateTag&kl.UPDATE_BOUNDS||(this._childUpdateTag|=kl.UPDATE_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag())}},{key:"getTheme",value:function(){return this.theme.getTheme(this)}},{key:"incrementalAppendChild",value:function(t){var i=y(e,"appendChild",this,3)([t]);return this.stage&&i&&(i.stage=this.stage,i.layer=this.layer),this.addUpdateBoundTag(),nc.graphicService.onAddIncremental(t,this,this.stage),i}},{key:"incrementalClearChild",value:function(){y(e,"removeAllChild",this,3)([]),this.addUpdateBoundTag(),nc.graphicService.onClearIncremental(this,this.stage)}},{key:"_updateChildToStage",value:function(t){return this.stage&&t&&t.setStage(this.stage,this.layer),this.addUpdateBoundTag(),t}},{key:"appendChild",value:function(t){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=y(e,"appendChild",this,3)([t]);return i&&this.stage&&n&&n.setStage(this.stage,this.layer),this.addUpdateBoundTag(),n}},{key:"insertBefore",value:function(t,i){return this._updateChildToStage(y(e,"insertBefore",this,3)([t,i]))}},{key:"insertAfter",value:function(t,i){return this._updateChildToStage(y(e,"insertAfter",this,3)([t,i]))}},{key:"insertInto",value:function(t,i){return this._updateChildToStage(y(e,"insertInto",this,3)([t,i]))}},{key:"removeChild",value:function(t){var i=y(e,"removeChild",this,3)([t]);return t.stage=null,nc.graphicService.onRemove(t),this.addUpdateBoundTag(),i}},{key:"removeAllChild",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.forEachChildren((function(e){nc.graphicService.onRemove(e),t&&e.isContainer&&e.removeAllChild(t)})),y(e,"removeAllChild",this,3)([]),this.addUpdateBoundTag()}},{key:"setStage",value:function(t,e){var i=this;this.stage!==t&&(this.stage=t,this.layer=e,this.setStageToShadowRoot(t,e),this._onSetStage&&this._onSetStage(this,t,e),nc.graphicService.onSetStage(this,t),this.forEachChildren((function(e){e.setStage(t,i.layer)})))}},{key:"addUpdatePositionTag",value:function(){y(e,"addUpdatePositionTag",this,3)([]),this.forEachChildren((function(t){t.isContainer&&t.addUpdateGlobalPositionTag()}))}},{key:"addUpdateGlobalPositionTag",value:function(){y(e,"addUpdateGlobalPositionTag",this,3)([]),this.forEachChildren((function(t){t.isContainer&&t.addUpdateGlobalPositionTag()}))}},{key:"tryUpdateGlobalTransMatrix",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.shouldUpdateGlobalMatrix()){if(this._globalTransMatrix){if(this.parent){var e=this.parent.globalTransMatrix;this._globalTransMatrix.setValue(e.a,e.b,e.c,e.d,e.e,e.f)}}else this._globalTransMatrix=this.parent?this.parent.globalTransMatrix.clone():this.transMatrix.clone();this.doUpdateGlobalMatrix(),t&&this.clearUpdateGlobalPositionTag()}return this._globalTransMatrix}},{key:"shouldUpdateGlobalMatrix",value:function(){return!!(this._updateTag&kl.UPDATE_GLOBAL_MATRIX)}},{key:"_getChildByName",value:function(t,e){return this.find((function(e){return e.name===t}),e)}},{key:"createOrUpdateChild",value:function(t,e,i){var n=this._getChildByName(t);return n?n.setAttributes(e):((n=nc.graphicService.creator[i](e)).name=t,this.add(n)),n}},{key:"clone",value:function(){return new e(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}},{key:"release",value:function(t){t&&this.forEachChildren((function(e){e.release(t)})),y(e,"release",this,3)([])}}])}(Rv);function Iv(t){return new Bv(t)}Bv.NOWORK_ANIMATE_ATTR=Pv;var Lv,Dv=function(t){function e(t,a,o,s){var l,u;return r(this,e),(l=n(this,e,[{}])).stage=t,l.global=a,l.window=o,l.main=s.main,l.layerHandler=s.layerHandler,l.layerHandler.init(i(l),o,{main:s.main,canvasId:s.canvasId,width:l.viewWidth,height:l.viewHeight,zIndex:null!==(u=s.zIndex)&&void 0!==u?u:0}),l.layer=i(l),l.subLayers=new Map,l.theme=new _h,l.background="rgba(0, 0, 0, 0)",l.afterDrawCbs=[],l}return h(e,t),o(e,[{key:"offscreen",get:function(){return this.layerHandler.offscreen}},{key:"layerMode",get:function(){return this.layerHandler.type}},{key:"width",get:function(){return this.stage?this.stage.width:0}},{key:"height",get:function(){return this.stage?this.stage.height:0}},{key:"viewWidth",get:function(){return this.stage?this.stage.viewWidth:0}},{key:"viewHeight",get:function(){return this.stage?this.stage.viewHeight:0}},{key:"dirtyBound",get:function(){throw new Error("暂不支持")}},{key:"dpr",get:function(){return this._dpr}},{key:"combineSubLayer",value:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=Array.from(this.subLayers.values()).sort((function(t,e){return t.zIndex-e.zIndex}));this.layerHandler.merge(i.map((function(t){return t.layer.subLayers.size&&t.layer.combineSubLayer(e),t.layer.getNativeHandler()}))),e&&i.forEach((function(t){t.group&&(t.group.incremental=0)})),i.forEach((function(e){nc.layerService.releaseLayer(t.stage,e.layer)})),this.subLayers.clear()}},{key:"getNativeHandler",value:function(){return this.layerHandler}},{key:"setStage",value:function(t,i){y(e,"setStage",this,3)([t,this])}},{key:"pick",value:function(t,e){throw new Error("暂不支持")}},{key:"tryRenderSecondaryLayer",value:function(t,e){var i=this;this.layerHandler.secondaryHandlers&&this.layerHandler.secondaryHandlers.length&&this.layerHandler.secondaryHandlers.forEach((function(n){n.layer.renderCount=i.renderCount,n.layer.render(t,e)}))}},{key:"render",value:function(t,e){var i,n=this;this.layerHandler.render([this],{renderService:t.renderService,stage:this.stage,layer:this,viewBox:t.viewBox,transMatrix:t.transMatrix,background:null!==(i=t.background)&&void 0!==i?i:this.background,updateBounds:t.updateBounds},e),this.afterDrawCbs.forEach((function(t){return t(n)})),this.tryRenderSecondaryLayer(t,e)}},{key:"resize",value:function(t,e){this.layerHandler.resize(t,e)}},{key:"resizeView",value:function(t,e){this.layerHandler.resizeView(t,e)}},{key:"setDpr",value:function(t){this.layerHandler.setDpr(t)}},{key:"afterDraw",value:function(t){this.afterDrawCbs.push(t)}},{key:"startAnimate",value:function(t){throw new Error("暂不支持")}},{key:"setToFrame",value:function(t){throw new Error("暂不支持")}},{key:"prepare",value:function(t,e){}},{key:"release",value:function(){var t=this;y(e,"release",this,3)([]),this.layerHandler.release(),this.subLayers&&this.subLayers.forEach((function(e){nc.layerService.releaseLayer(t.stage,e.layer)}))}},{key:"drawTo",value:function(t,e){var i,n=this;this.layerHandler.drawTo(t,[this],Object.assign({background:null!==(i=e.background)&&void 0!==i?i:this.background,renderService:e.renderService,viewBox:e.viewBox,transMatrix:e.transMatrix,stage:this.stage,layer:this},e)),this.afterDrawCbs.forEach((function(t){return t(n)}))}}])}(Bv),Ov=Symbol.for("TransformUtil"),Fv=Symbol.for("GraphicUtil"),zv=Symbol.for("LayerService"),Hv=Symbol.for("StaticLayerHandlerContribution"),jv=Symbol.for("DynamicLayerHandlerContribution"),Nv=Symbol.for("VirtualLayerHandlerContribution"),Vv=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Wv=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Gv=Lv=function(){return o((function t(){r(this,t),this.layerMap=new Map,this.global=nc.global}),[{key:"tryInit",value:function(){this.inited||(this.staticLayerCountInEnv=this.global.getStaticCanvasCount(),this.dynamicLayerCountInEnv=this.global.getDynamicCanvasCount(),this.inited=!0)}},{key:"getStageLayer",value:function(t){return this.layerMap.get(t)}},{key:"getRecommendedLayerType",value:function(t){return t||(0!==this.staticLayerCountInEnv?"static":0!==this.dynamicLayerCountInEnv?"dynamic":"virtual")}},{key:"getLayerHandler",value:function(t){return"static"===t?Ac.get(Hv):"dynamic"===t?Ac.get(jv):Ac.get(Nv)}},{key:"createLayer",value:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{main:!1};this.tryInit();var n=this.getRecommendedLayerType(i.layerMode);n=i.main||i.canvasId?"static":n;var r=this.getLayerHandler(n),a=new Dv(t,this.global,t.window,Object.assign(Object.assign({main:!1},i),{layerMode:n,canvasId:null!==(e=i.canvasId)&&void 0!==e?e:Lv.GenerateLayerId(),layerHandler:r})),o=this.layerMap.get(t)||[];return o.push(a),this.layerMap.set(t,o),this.staticLayerCountInEnv--,a}},{key:"prepareStageLayer",value:function(t){var e;t.forEachChildren((function(t){var i=t.getNativeHandler();"virtual"===i.type?(i.mainHandler=e,e.secondaryHandlers.push(i)):(e=i).secondaryHandlers=[]}))}},{key:"releaseLayer",value:function(t,e){e.release();var i=this.layerMap.get(t)||[];this.layerMap.set(t,i.filter((function(t){return t!==e})))}},{key:"layerCount",value:function(t){return(this.layerMap.get(t)||[]).length}},{key:"restLayerCount",value:function(t){return"browser"===this.global.env?10:0}},{key:"releaseStage",value:function(t){this.layerMap.delete(t)}}],[{key:"GenerateLayerId",value:function(){return"".concat(Lv.idprefix,"_").concat(Lv.prefix_count++)}}])}();Gv.idprefix="visactor_layer",Gv.prefix_count=0,Gv=Lv=Vv([js(),Wv("design:paramtypes",[])],Gv);var Uv=new Ts((function(t){t(cl).to(vl).inSingletonScope(),t(ah).to(sh),t(Fv).to(dh).inSingletonScope(),t(Ov).to(fh).inSingletonScope(),t(zv).to(Gv).inSingletonScope()}));function Yv(t,e){return!(!t&&!e)}function Xv(t,e){return(X(t)?t.some((function(t){return t||void 0===t})):!!t)&&e>0}function Kv(t,e,i){return i&&t*e>0}function qv(t,e,i,n,r){return r&&t*e>0&&0!==i&&0!==n}function Zv(t,e){return t*e>0}function Jv(t,e,i,n){return t*e>0&&0!==i&&0!==n}function Qv(t,e,i,n,r,a,o){var s=t-i,l=e-n,u=(o?a:-a)/Math.sqrt(s*s+l*l),c=u*l,h=-u*s,d=t+c,p=e+h,f=i+c,v=n+h,g=(d+f)/2,y=(p+v)/2,m=f-d,_=v-p,b=m*m+_*_,x=r-a,k=d*v-f*p,S=(_<0?-1:1)*Math.sqrt(Math.max(0,x*x*b-k*k)),A=(k*_-m*S)/b,M=(-k*m-_*S)/b,w=(k*_+m*S)/b,T=(-k*m+_*S)/b,C=A-g,E=M-y,P=w-g,R=T-y;return C*C+E*E>P*P+R*R&&(A=w,M=T),{cx:A,cy:M,x01:-c,y01:-h,x11:A*(r/x-1),y11:M*(r/x-1)}}function $v(t,e,i,n,r){var a,o,s,l,u,c=le(i-e),h=t.getParsedCornerRadius(),d=X(h),p=t.getParsePadAngle(e,i),f=p.outerDeltaAngle,v=p.innerDeltaAngle,g=p.outerStartAngle,y=p.outerEndAngle,m=p.innerEndAngle,_=p.innerStartAngle,b=d?h[0]:h,x=d?h[1]:h,k=d?h[2]:h,S=d?h[3]:h,A=Math.max(x,b),M=Math.max(k,S),w=A,T=M,C=r*ce(g),E=r*pe(g),P=n*ce(m),R=n*pe(m);if((M>ne||A>ne)&&(a=r*ce(y),o=r*pe(y),s=n*ce(_),l=n*pe(_),c<re)){var B=function(t,e,i,n,r,a,o,s){var l=i-t,u=n-e,c=o-r,h=s-a,d=h*l-c*u;return d*d<ne?[]:[t+(d=(c*(e-a)-h*(t-r))/d)*l,e+d*u]}(C,E,s,l,a,o,P,R);if(B){var I=C-B[0],L=E-B[1],D=a-B[0],O=o-B[1],F=1/pe(((u=(I*D+L*O)/(fe(I*I+L*L)*fe(D*D+O*O)))>1?0:u<-1?re:Math.acos(u))/2),z=fe(B[0]*B[0]+B[1]*B[1]);T=de(M,(n-z)/(F-1)),w=de(A,(r-z)/(F+1))}}return{outerDeltaAngle:f,xors:C,yors:E,xirs:s,yirs:l,xore:a,yore:o,xire:P,yire:R,limitedOcr:w,limitedIcr:T,outerCornerRadiusStart:b,outerCornerRadiusEnd:x,maxOuterCornerRadius:A,maxInnerCornerRadius:M,outerStartAngle:g,outerEndAngle:y,innerDeltaAngle:v,innerEndAngle:m,innerStartAngle:_,innerCornerRadiusStart:S,innerCornerRadiusEnd:k}}function tg(t,e,i,n,r,a,o){var s=t.getParsedAngle(),l=s.startAngle,u=s.endAngle,c=le(u-l),h=u>l,d=!1;if(r<a){var p=r;r=a,a=p}if(r<=ne)e.moveTo(i,n);else if(c>=se-ne)e.moveTo(i+r*ce(l),n+r*pe(l)),e.arc(i,n,r,l,u,!h),a>ne&&(e.moveTo(i+a*ce(u),n+a*pe(u)),e.arc(i,n,a,u,l,h));else{var f=$v(t,l,u,a,r),v=f.outerDeltaAngle,g=f.xors,y=f.yors,m=f.xirs,_=f.yirs,b=f.limitedOcr,x=f.outerCornerRadiusStart,k=f.outerCornerRadiusEnd,S=f.maxOuterCornerRadius,A=f.xore,M=f.yore,w=f.xire,T=f.yire,C=f.outerStartAngle,E=f.outerEndAngle,P=f.limitedIcr,R=f.innerDeltaAngle,B=f.innerEndAngle,I=f.innerStartAngle,L=f.innerCornerRadiusStart,D=f.innerCornerRadiusEnd,O=f.maxInnerCornerRadius;if(v<.001)o&&(o[3]||o[1])&&e.moveTo(i+g,n+y),d=!0;else if(b>ne){var F=de(x,b),z=de(k,b),H=Qv(m,_,g,y,r,F,Number(h)),j=Qv(A,M,w,T,r,z,Number(h));b<S&&F===z?!o||o[0]?(e.moveTo(i+H.cx+H.x01,n+H.cy+H.y01),e.arc(i+H.cx,n+H.cy,b,ue(H.y01,H.x01),ue(j.y01,j.x01),!h)):e.moveTo(i+H.cx+b*ce(ue(j.y01,j.x01)),n+H.cy+b*pe(ue(j.y01,j.x01))):!o||o[0]?(e.moveTo(i+H.cx+H.x01,n+H.cy+H.y01),F>0&&e.arc(i+H.cx,n+H.cy,F,ue(H.y01,H.x01),ue(H.y11,H.x11),!h),e.arc(i,n,r,ue(H.cy+H.y11,H.cx+H.x11),ue(j.cy+j.y11,j.cx+j.x11),!h),z>0&&e.arc(i+j.cx,n+j.cy,z,ue(j.y11,j.x11),ue(j.y01,j.x01),!h)):z>0?e.moveTo(i+j.cx+z*ce(ue(j.y01,j.x01)),n+j.cy+z*pe(ue(j.y01,j.x01))):e.moveTo(i+A,n+r*pe(E))}else!o||o[0]?(e.moveTo(i+g,n+y),e.arc(i,n,r,C,E,!h)):e.moveTo(i+r*ce(E),n+r*pe(E));if(!(a>ne)||R<.001)!o||o[1]?e.lineTo(i+w,n+T):e.moveTo(i+w,n+T),d=!0;else if(P>ne){var N=de(L,P),V=de(D,P),W=Qv(w,T,A,M,a,-V,Number(h)),G=Qv(g,y,m,_,a,-N,Number(h));if(!o||o[1]?e.lineTo(i+W.cx+W.x01,n+W.cy+W.y01):e.moveTo(i+W.cx+W.x01,n+W.cy+W.y01),P<O&&N===V){var U=ue(G.y01,G.x01);!o||o[2]?e.arc(i+W.cx,n+W.cy,P,ue(W.y01,W.x01),U,!h):e.moveTo(i+W.cx+ce(U),n+W.cy+pe(U))}else!o||o[2]?(V>0&&e.arc(i+W.cx,n+W.cy,V,ue(W.y01,W.x01),ue(W.y11,W.x11),!h),e.arc(i,n,a,ue(W.cy+W.y11,W.cx+W.x11),ue(G.cy+G.y11,G.cx+G.x11),h),N>0&&e.arc(i+G.cx,n+G.cy,N,ue(G.y11,G.x11),ue(G.y01,G.x01),!h)):N>0?e.moveTo(i+G.cx+N*ce(ue(G.y01,G.x01)),n+G.cy+N*pe(ue(G.y01,G.x01))):e.moveTo(i+m,n+_)}else!o||o[1]?e.lineTo(i+w,n+T):e.moveTo(i+w,n+T),!o||o[2]?e.arc(i,n,a,B,I,h):e.moveTo(i+a*ce(I),n+a*pe(I))}return o?o[3]&&e.lineTo(i+r*ce(l),n+r*pe(l)):e.closePath(),d}var eg=function(){function t(){r(this,t)}return o(t,null,[{key:"GetCanvas",value:function(){try{return t.canvas||(t.canvas=nc.global.createCanvas({})),t.canvas}catch(t){return null}}},{key:"GetCtx",value:function(){if(!t.ctx){var e=t.GetCanvas();t.ctx=e.getContext("2d")}return t.ctx}}])}(),ig=function(t){function e(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;r(this,e),(t=n(this,e)).cacheParams={CLEAN_THRESHOLD:100,L_TIME:1e3},t.dataMap=new Map;var o=eg.GetCanvas(),s=eg.GetCtx();if(o.width=a,o.height=1,!s)return p(t);if(s.translate(0,0),!s)throw new Error("获取ctx发生错误");var l=s.createLinearGradient(0,0,a,0);return i.forEach((function(t){l.addColorStop(t[0],t[1])})),s.fillStyle=l,s.fillRect(0,0,a,1),t.rgbaSet=s.getImageData(0,0,a,1).data,t}return h(e,t),o(e,[{key:"getColor",value:function(t){var e=this.rgbaSet.slice(4*t,4*t+4);return"rgba(".concat(e[0],", ").concat(e[1],", ").concat(e[2],", ").concat(e[3]/255,")")}},{key:"GetOrCreate",value:function(t,i,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:100,s="".concat(t).concat(i).concat(n).concat(r);a.forEach((function(t){return s+=t.join()})),s+=o;var l=this.dataMap.get(s);return l||(l={data:new e(a,o),timestamp:[]},this.addLimitedTimestamp(l,Date.now(),{}),this.dataMap.set(s,l)),this.clearCache(this.dataMap,this.cacheParams),l.data}}],[{key:"getInstance",value:function(){return e._instance||(e._instance=new e),e._instance}}])}(gi),ng=function(){function t(){r(this,t)}return o(t,null,[{key:"GetSize",value:function(e){for(var i=0;i<t.ImageSize.length;i++)if(t.ImageSize[i]>=e)return t.ImageSize[i];return e}},{key:"Get",value:function(e,i,n,r,a,o,s){var l=t.GenKey(e,i,n,r,a),u=t.cache[l];if(!u||0===u.length)return null;for(var c=0;c<u.length;c++)if(u[c].width>=o&&u[c].height>=s)return u[c].pattern;return null}},{key:"Set",value:function(e,i,n,r,a,o,s,l){var u=t.GenKey(e,i,n,r,a);t.cache[u]?t.cache[u].push({width:s,height:l,pattern:o}):t.cache[u]=[{width:s,height:l,pattern:o}]}},{key:"GenKey",value:function(t,e,i,n,r){return"".concat(e,",").concat(i,",").concat(n,",").concat(r,",").concat(t.join())}}])}();ng.cache={},ng.ImageSize=[20,40,80,160,320,640,1280,2560];var rg=Symbol.for("ArcRenderContribution"),ag=Symbol.for("AreaRenderContribution"),og=Symbol.for("CircleRenderContribution"),sg=Symbol.for("GroupRenderContribution"),lg=Symbol.for("ImageRenderContribution"),ug=Symbol.for("PathRenderContribution"),cg=Symbol.for("PolygonRenderContribution"),hg=Symbol.for("RectRenderContribution"),dg=Symbol.for("SymbolRenderContribution"),pg=Symbol.for("TextRenderContribution"),fg=Symbol.for("InteractiveSubRenderContribution");function vg(t,e){return"end"===t||"right"===t?-e:"center"===t?-e/2:0}function gg(t,e,i){return"middle"===t?-e/2:"top"===t?0:"bottom"===t?(arguments.length>3&&void 0!==arguments[3]?arguments[3]:0)-e:t&&"alphabetic"!==t?0:(i||(i=e),-(e-i)/2-.79*i)}function yg(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function mg(t,e,i){var n,r,a,o,s,l,u,c,h,d,p,f,v=i[0],g=i[1],y=i[2];return e===t?(t[12]=e[0]*v+e[4]*g+e[8]*y+e[12],t[13]=e[1]*v+e[5]*g+e[9]*y+e[13],t[14]=e[2]*v+e[6]*g+e[10]*y+e[14],t[15]=e[3]*v+e[7]*g+e[11]*y+e[15]):(n=e[0],r=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],p=e[10],f=e[11],t[0]=n,t[1]=r,t[2]=a,t[3]=o,t[4]=s,t[5]=l,t[6]=u,t[7]=c,t[8]=h,t[9]=d,t[10]=p,t[11]=f,t[12]=n*v+s*g+h*y+e[12],t[13]=r*v+l*g+d*y+e[13],t[14]=a*v+u*g+p*y+e[14],t[15]=o*v+c*g+f*y+e[15]),t}function _g(t,e){t[0]=e.a,t[1]=e.b,t[2]=0,t[3]=0,t[4]=e.c,t[5]=e.d,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e.e,t[13]=e.f,t[14]=0,t[15]=1}function bg(t,e,i){var n=e[0],r=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],p=e[10],f=e[11],v=e[12],g=e[13],y=e[14],m=e[15],_=i[0],b=i[1],x=i[2],k=i[3];return t[0]=_*n+b*s+x*h+k*v,t[1]=_*r+b*l+x*d+k*g,t[2]=_*a+b*u+x*p+k*y,t[3]=_*o+b*c+x*f+k*m,_=i[4],b=i[5],x=i[6],k=i[7],t[4]=_*n+b*s+x*h+k*v,t[5]=_*r+b*l+x*d+k*g,t[6]=_*a+b*u+x*p+k*y,t[7]=_*o+b*c+x*f+k*m,_=i[8],b=i[9],x=i[10],k=i[11],t[8]=_*n+b*s+x*h+k*v,t[9]=_*r+b*l+x*d+k*g,t[10]=_*a+b*u+x*p+k*y,t[11]=_*o+b*c+x*f+k*m,_=i[12],b=i[13],x=i[14],k=i[15],t[12]=_*n+b*s+x*h+k*v,t[13]=_*r+b*l+x*d+k*g,t[14]=_*a+b*u+x*p+k*y,t[15]=_*o+b*c+x*f+k*m,t}function xg(t,e,i){var n=e[0],r=e[1],a=e[2],o=i[3]*n+i[7]*r+i[11]*a+i[15];return o=o||1,t[0]=(i[0]*n+i[4]*r+i[8]*a+i[12])/o,t[1]=(i[1]*n+i[5]*r+i[9]*a+i[13])/o,t[2]=(i[2]*n+i[6]*r+i[10]*a+i[14])/o,t}var kg=function(){return o((function t(){r(this,t),this.pools=[]}),[{key:"allocate",value:function(t,e,i,n,r,a){if(!this.pools.length)return new vi(t,e,i,n,r,a);var o=this.pools.pop();return o.a=t,o.b=e,o.c=i,o.d=n,o.e=r,o.f=a,o}},{key:"allocateByObj",value:function(t){if(!this.pools.length)return new vi(t.a,t.b,t.c,t.d,t.e,t.f);var e=this.pools.pop();return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e.e=t.e,e.f=t.f,e}},{key:"free",value:function(t){this.pools.push(t)}},{key:"length",get:function(){return this.pools.length}},{key:"release",value:function(){this.pools=[]}}])}(),Sg=function(){function t(){r(this,t),this.pools=[]}return o(t,[{key:"allocate",value:function(){if(!this.pools.length)return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];var e=this.pools.pop();return t.identity(e),e}},{key:"allocateByObj",value:function(t){var e;e=this.pools.length?this.pools.pop():[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];for(var i=0;i<e.length;i++)e[i]=t[i];return e}},{key:"free",value:function(t){t&&this.pools.push(t)}},{key:"length",get:function(){return this.pools.length}},{key:"release",value:function(){this.pools=[]}}],[{key:"identity",value:function(t){return yg(t)}}])}(),Ag=new kg,Mg=new Sg,wg=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Tg=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Cg=function(t,e){return function(i,n){e(i,n,t)}};function Eg(t,e,i){var n,r=e.attribute,a=r.x,o=void 0===a?i.x:a,s=r.y,l=void 0===s?i.y:s,u=r.z,c=void 0===u?i.z:u,h=r.dx,d=void 0===h?i.dx:h,p=r.dy,f=void 0===p?i.dy:p,v=r.dz,g=void 0===v?i.dz:v,y=r.scaleX,m=void 0===y?i.scaleX:y,_=r.scaleY,b=void 0===_?i.scaleY:_,x=r.scaleZ,k=void 0===x?i.scaleZ:x,S=r.alpha,A=void 0===S?i.alpha:S,M=r.beta,w=void 0===M?i.beta:M,T=r.angle,C=void 0===T?i.angle:T,E=r.anchor3d,P=void 0===E?e.attribute.anchor:E,R=r.anchor,B=[0,0,0];if(P){if("string"==typeof P[0]){var I=parseFloat(P[0])/100,L=e.AABBBounds;B[0]=L.x1+(L.x2-L.x1)*I}else B[0]=P[0];if("string"==typeof P[1]){var D=parseFloat(P[1])/100,O=e.AABBBounds;B[1]=O.x1+(O.x2-O.x1)*D}else B[1]=P[1];B[2]=null!==(n=P[2])&&void 0!==n?n:0}if(yg(t),mg(t,t,[o+d,l+f,c+g]),mg(t,t,[B[0],B[1],B[2]]),function(t,e,i){var n=Math.sin(i),r=Math.cos(i),a=e[4],o=e[5],s=e[6],l=e[7],u=e[8],c=e[9],h=e[10],d=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*r+u*n,t[5]=o*r+c*n,t[6]=s*r+h*n,t[7]=l*r+d*n,t[8]=u*r-a*n,t[9]=c*r-o*n,t[10]=h*r-s*n,t[11]=d*r-l*n}(t,t,w),function(t,e,i){var n=Math.sin(i),r=Math.cos(i),a=e[0],o=e[1],s=e[2],l=e[3],u=e[8],c=e[9],h=e[10],d=e[11];e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*r-u*n,t[1]=o*r-c*n,t[2]=s*r-h*n,t[3]=l*r-d*n,t[8]=a*n+u*r,t[9]=o*n+c*r,t[10]=s*n+h*r,t[11]=l*n+d*r}(t,t,A),mg(t,t,[-B[0],-B[1],B[2]]),function(t,e,i){var n=i[0],r=i[1],a=i[2];t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]}(t,t,[m,b,k]),C){var F=Mg.allocate(),z=[0,0];if(R){if("string"==typeof P[0]){var H=parseFloat(P[0])/100,j=e.AABBBounds;z[0]=j.x1+(j.x2-j.x1)*H}else z[0]=P[0];if("string"==typeof P[1]){var N=parseFloat(P[1])/100,V=e.AABBBounds;z[1]=V.x1+(V.x2-V.x1)*N}else z[1]=P[1]}mg(F,F,[z[0],z[1],0]),function(t,e,i){var n=Math.sin(i),r=Math.cos(i),a=e[0],o=e[1],s=e[2],l=e[3],u=e[4],c=e[5],h=e[6],d=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*r+u*n,t[1]=o*r+c*n,t[2]=s*r+h*n,t[3]=l*r+d*n,t[4]=u*r-a*n,t[5]=c*r-o*n,t[6]=h*r-s*n,t[7]=d*r-l*n}(F,F,C),mg(F,F,[-z[0],-z[1],0]),bg(t,t,F)}}var Pg=function(){return o((function t(e){r(this,t),this.creator=e,this.hooks={onAttributeUpdate:new ll(["graphic"]),onSetStage:new ll(["graphic","stage"]),onRemove:new ll(["graphic"]),onRelease:new ll(["graphic"]),onAddIncremental:new ll(["graphic","group","stage"]),onClearIncremental:new ll(["graphic","group","stage"]),beforeUpdateAABBBounds:new ll(["graphic","stage","willUpdate","aabbBounds"]),afterUpdateAABBBounds:new ll(["graphic","stage","aabbBounds","globalAABBBounds","selfChange"]),clearAABBBounds:new ll(["graphic","stage","aabbBounds"])},this.tempAABBBounds1=new pi,this.tempAABBBounds2=new pi}),[{key:"onAttributeUpdate",value:function(t){this.hooks.onAttributeUpdate.taps.length&&this.hooks.onAttributeUpdate.call(t)}},{key:"onSetStage",value:function(t,e){this.hooks.onSetStage.taps.length&&this.hooks.onSetStage.call(t,e)}},{key:"onRemove",value:function(t){this.hooks.onRemove.taps.length&&this.hooks.onRemove.call(t)}},{key:"onRelease",value:function(t){this.hooks.onRelease.taps.length&&this.hooks.onRelease.call(t)}},{key:"onAddIncremental",value:function(t,e,i){this.hooks.onAddIncremental.taps.length&&this.hooks.onAddIncremental.call(t,e,i)}},{key:"onClearIncremental",value:function(t,e){this.hooks.onClearIncremental.taps.length&&this.hooks.onClearIncremental.call(t,e)}},{key:"beforeUpdateAABBBounds",value:function(t,e,i,n){this.hooks.beforeUpdateAABBBounds.taps.length&&this.hooks.beforeUpdateAABBBounds.call(t,e,i,n)}},{key:"afterUpdateAABBBounds",value:function(t,e,i,n,r){this.hooks.afterUpdateAABBBounds.taps.length&&this.hooks.afterUpdateAABBBounds.call(t,e,i,n,r)}},{key:"clearAABBBounds",value:function(t,e,i){this.hooks.clearAABBBounds.taps.length&&this.hooks.clearAABBBounds.call(t,e,i)}},{key:"updatePathProxyAABBBounds",value:function(t,e){var i="function"==typeof e.pathProxy?e.pathProxy(e.attribute):e.pathProxy;if(!i)return!1;var n=new Bl(t);return Nl(i.commandList,n,0,0),!0}},{key:"updateHTMLTextAABBBounds",value:function(t,e,i,n){var r=t.textAlign,a=t.textBaseline;if(null!=t.forceBoundsHeight){var o=Z(t.forceBoundsHeight)?t.forceBoundsHeight:t.forceBoundsHeight(),s=gg(a,o,o);i.set(i.x1,s,i.x2,s+o)}if(null!=t.forceBoundsWidth){var l=Z(t.forceBoundsWidth)?t.forceBoundsWidth:t.forceBoundsWidth(),u=vg(r,l);i.set(u,i.y1,u+l,i.y2)}}},{key:"combindShadowAABBBounds",value:function(t,e){if(e&&e.shadowRoot){var i=e.shadowRoot.AABBBounds;t.union(i)}}},{key:"transformAABBBounds",value:function(t,e,i,n,r){if(!e.empty()){var a=t.scaleX,o=void 0===a?i.scaleX:a,s=t.scaleY,l=void 0===s?i.scaleY:s,u=t.stroke,c=void 0===u?i.stroke:u,h=t.shadowBlur,d=void 0===h?i.shadowBlur:h,p=t.lineWidth,f=void 0===p?i.lineWidth:p,v=t.pickStrokeBuffer,g=void 0===v?i.pickStrokeBuffer:v,y=t.strokeBoundsBuffer,m=void 0===y?i.strokeBoundsBuffer:y,_=this.tempAABBBounds1,b=this.tempAABBBounds2;if(c&&f)qf(_,(f+g)/Math.abs(o+l),n,m),e.union(_),_.setValue(b.x1,b.y1,b.x2,b.y2);if(d){var x=t.shadowOffsetX,k=void 0===x?i.shadowOffsetX:x,S=t.shadowOffsetY,A=void 0===S?i.shadowOffsetY:S;qf(_,d/Math.abs(o+l)*2,!1,m+1),_.translate(k,A),e.union(_)}}if(this.combindShadowAABBBounds(e,r),!e.empty()){var M=!0,w=r.transMatrix;r&&r.isContainer&&(M=!(1===w.a&&0===w.b&&0===w.c&&1===w.d&&0===w.e&&0===w.f)),M&&hi(e,e,w)}}},{key:"validCheck",value:function(t,e,i,n){if(!n)return!0;if(null!=t.forceBoundsHeight||null!=t.forceBoundsWidth)return!0;if(n.shadowRoot||n.isContainer)return!0;var r=t.visible,a=void 0===r?e.visible:r;return!(!n.valid||!a)||(i.empty()||(n.parent&&i.transformWithMatrix(n.parent.globalTransMatrix),nc.graphicService.clearAABBBounds(n,n.stage,i),i.clear()),!1)}},{key:"updateTempAABBBounds",value:function(t){var e=this.tempAABBBounds1,i=this.tempAABBBounds2;return e.setValue(t.x1,t.y1,t.x2,t.y2),i.setValue(t.x1,t.y1,t.x2,t.y2),{tb1:e,tb2:i}}}])}();Pg=wg([js(),Cg(0,zs(_v)),Tg("design:paramtypes",[Object])],Pg);var Rg=function(t,e,i){var n=t.outerBorder,r=t.shadowBlur,a=void 0===r?e.shadowBlur:r;if(n){var o=e.outerBorder,s=n.distance,l=void 0===s?o.distance:s,u=n.lineWidth,c=void 0===u?o.lineWidth:u;i.expand(l+(a+c)/2)}return i},Bg=["radius","startAngle","endAngle"].concat(m(Mv)),Ig=function(t){function e(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{radius:1};return r(this,e),(t=n(this,e,[i])).type="circle",t.numberType=av,t}return h(e,t),o(e,[{key:"isValid",value:function(){return y(e,"isValid",this,3)([])&&this._isValid()}},{key:"_isValid",value:function(){var t=this.attribute,e=t.startAngle,i=t.endAngle,n=t.radius;return this._validNumber(e)&&this._validNumber(i)&&this._validNumber(n)}},{key:"getGraphicTheme",value:function(){return xh(this).circle}},{key:"updateAABBBounds",value:function(t,e,i,n){this.updatePathProxyAABBBounds(i)||(n?this.updateCircleAABBBoundsImprecise(t,e,i):this.updateCircleAABBBoundsAccurate(t,e,i));var r=nc.graphicService.updateTempAABBBounds(i),a=r.tb1,o=r.tb2;return Rg(t,e,a),i.union(a),a.setValue(o.x1,o.y1,o.x2,o.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,nc.graphicService.transformAABBBounds(t,i,e,!1,this),i}},{key:"updateCircleAABBBoundsImprecise",value:function(t,e,i){var n=t.radius,r=void 0===n?e.radius:n;return i.set(-r,-r,r,r),i}},{key:"updateCircleAABBBoundsAccurate",value:function(t,e,i){var n=t.startAngle,r=void 0===n?e.startAngle:n,a=t.endAngle,o=void 0===a?e.endAngle:a,s=t.radius,l=void 0===s?e.radius:s;return o-r>se-ne?i.set(-l,-l,l,l):sd(r,o,l,i),i}},{key:"needUpdateTags",value:function(t){return y(e,"needUpdateTags",this,3)([t,Bg])}},{key:"needUpdateTag",value:function(t){return y(e,"needUpdateTag",this,3)([t,Bg])}},{key:"toCustomPath",value:function(){var t,e,i,n=this.attribute,r=null!==(t=n.radius)&&void 0!==t?t:this.getDefaultAttribute("radius"),a=null!==(e=n.startAngle)&&void 0!==e?e:this.getDefaultAttribute("startAngle"),o=null!==(i=n.endAngle)&&void 0!==i?i:this.getDefaultAttribute("endAngle"),s=new Ru;return s.arc(0,0,r,a,o),s}},{key:"clone",value:function(){return new e(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}}])}(Rv);function Lg(t){return new Ig(t)}Ig.NOWORK_ANIMATE_ATTR=Pv;var Dg=function(){return o((function t(e,i,n){r(this,t),this.fontFamily=e,this.textOptions=i,this.textMeasure=n}),[{key:"LayoutBBox",value:function(t,e,i,n){if(t.xOffset="left"===e||"start"===e?0:"center"===e?t.width/-2:"right"===e||"end"===e?-t.width:0,"top"===i)t.yOffset=0;else if("middle"===i)t.yOffset=t.height/-2;else if("alphabetic"===i){var r=.79;if(1===n.length){var a=n[0];r=a.ascent/(a.ascent+a.descent)}t.yOffset=t.height*-r}else t.yOffset=-t.height;return t}},{key:"GetLayoutByLines",value:function(t,e,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",a=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,s=null!=o?o:{},l=s.lineWidth,u=s.suffixPosition,c=void 0===u?"end":u,h=s.measureMode,d=void 0===h?ol.actualBounding:h,p=s.keepCenterInLine,f=void 0!==p&&p;t=t.map((function(t){return t.toString()}));var v=[],g=[0,0];if("number"==typeof l&&l!==1/0){for(var y,m=0,_=t.length;m<_;m++){var b=this.textMeasure.measureTextPixelADscentAndWidth(t[m],this.textOptions,d),x=t[m].toString();if(b.width>l){var k=this.textMeasure.clipTextWithSuffix(t[m],this.textOptions,l,r,a,c);x=k.str,y=k.width}else y=b.width;v.push({str:x,width:y,ascent:b.ascent,descent:b.descent,keepCenterInLine:f})}g[0]=l}else{for(var S,A,M=0,w=0,T=t.length;w<T;w++){A=t[w];var C=this.textMeasure.measureTextPixelADscentAndWidth(t[w],this.textOptions,d);S=C.width,M=Math.max(M,S),v.push({str:A,width:S,ascent:C.ascent,descent:C.descent,keepCenterInLine:f})}g[0]=M}g[1]=v.length*n,g[0]=v.reduce((function(t,e){return Math.max(t,e.width)}),0);var E={xOffset:0,yOffset:0,width:g[0],height:g[1]};return this.LayoutBBox(E,e,i,v),this.layoutWithBBox(E,v,e,i,n)}},{key:"layoutWithBBox",value:function(t,e,i,n,r){var a=[0,0],o=e.length*r;"top"===n||("middle"===n?a[1]=(t.height-o)/2:"bottom"===n&&(a[1]=t.height-o));for(var s=0;s<e.length;s++)this.lineOffset(t,e[s],i,n,r,a);return{bbox:t,lines:e,fontFamily:this.fontFamily,fontSize:this.textOptions.fontSize,fontWeight:this.textOptions.fontWeight,lineHeight:r,textAlign:i,textBaseline:n}}},{key:"lineOffset",value:function(t,e,i,n,r,a){if("left"===i||"start"===i?e.leftOffset=0:"center"===i?e.leftOffset=(t.width-e.width)/2:"right"!==i&&"end"!==i||(e.leftOffset=t.width-e.width),e.topOffset=r/2+(e.ascent-e.descent)/2+a[1],!e.keepCenterInLine){var o=e.ascent+e.descent+0;if(o<r-0&&("bottom"===n?e.topOffset+=(r-o)/2:"top"===n&&(e.topOffset-=(r-o)/2)),"alphabetic"===n){var s=r/(e.ascent+e.descent);e.topOffset=r/2+(e.ascent-e.descent)/2*s+a[1]}}return a[1]+=r,e}}])}(),Og=["text","maxLineWidth","maxWidth","textAlign","textBaseline","heightLimit","lineClamp","fontSize","fontFamily","fontWeight","ellipsis","lineHeight","direction","wordBreak","heightLimit","lineClamp"].concat(m(Mv)),Fg=function(t){function e(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{text:"",fontSize:16};return r(this,e),(t=n(this,e,[i])).type="text",t.numberType=yv,t.cache={},t}return h(e,t),o(e,[{key:"font",get:function(){var t=this.getGraphicTheme();return this._font||(this._font=oi(this.attribute,t)),this._font}},{key:"clipedText",get:function(){var t,e=this.attribute,i=this.getGraphicTheme(),n=this.getMaxWidth(i);return Number.isFinite(n)?(this.tryUpdateAABBBounds(),this.cache.clipedText):(null!==(t=e.text)&&void 0!==t?t:i.text).toString()}},{key:"clipedWidth",get:function(){return this.tryUpdateAABBBounds(),this.cache.clipedWidth}},{key:"cliped",get:function(){var t,e,i=this.getGraphicTheme(),n=this.attribute,r=this.getMaxWidth(i);if(!Number.isFinite(r))return!1;var a=this.attribute.text;if(this.tryUpdateAABBBounds(),null===(e=null===(t=this.cache)||void 0===t?void 0:t.layoutData)||void 0===e?void 0:e.lines){var o="";return this.cache.layoutData.lines.forEach((function(t){o+=t.str})),(Array.isArray(a)?a.join(""):a)!==o}return"vertical"===n.direction&&this.cache.verticalList&&this.cache.verticalList[0]?this.cache.verticalList[0].map((function(t){return t.text})).join("")!==n.text.toString():null!=this.clipedText&&this.clipedText!==n.text.toString()}},{key:"multilineLayout",get:function(){return this.tryUpdateAABBBounds(),this.cache.layoutData}},{key:"isMultiLine",get:function(){return Array.isArray(this.attribute.text)||"normal"===this.attribute.whiteSpace}},{key:"isValid",value:function(){return y(e,"isValid",this,3)([])&&this._isValid()}},{key:"_isValid",value:function(){var t=this.attribute.text;return X(t)?!t.every((function(t){return null==t||""===t})):null!=t&&""!==t}},{key:"getGraphicTheme",value:function(){return xh(this).text}},{key:"doUpdateOBBBounds",value:function(){var t=this.getGraphicTheme();this._OBBBounds.clear();var i=this.attribute,n=i.angle,r=void 0===n?t.angle:n;if(!r){var a=this.AABBBounds;return this._OBBBounds.setValue(a.x1,a.y1,a.x2,a.y2),this._OBBBounds}this.obbText||(this.obbText=new e({})),this.obbText.setAttributes(Object.assign(Object.assign({},i),{angle:0}));var o=this.obbText.AABBBounds,s=i.x,l=i.y,u={x:(o.x1+o.x2)/2,y:(o.y1+o.y2)/2},c=qe(u,r,{x:s,y:l});return this._OBBBounds.copy(o),this._OBBBounds.translate(c.x-u.x,c.y-u.y),this._OBBBounds.angle=r,this._OBBBounds}},{key:"updateAABBBounds",value:function(t,e,i){var n=this.attribute.text,r=void 0===n?e.text:n;Array.isArray(r)?this.updateMultilineAABBBounds(r):this.updateSingallineAABBBounds(r);var a=nc.graphicService.updateTempAABBBounds(i).tb1,o=t.scaleX,s=void 0===o?e.scaleX:o,l=t.scaleY,u=void 0===l?e.scaleY:l,c=t.shadowBlur,h=void 0===c?e.shadowBlur:c,d=t.strokeBoundsBuffer,p=void 0===d?e.strokeBoundsBuffer:d;h&&(qf(a,h/Math.abs(s+u),!0,p),i.union(a));return nc.graphicService.combindShadowAABBBounds(i,this),null==t.forceBoundsHeight&&null==t.forceBoundsWidth||nc.graphicService.updateHTMLTextAABBBounds(t,e,i),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,hi(i,i,this.transMatrix),i}},{key:"updateSingallineAABBBounds",value:function(t){this.updateMultilineAABBBounds([t]);var e=this.cache.layoutData;if(e&&e.lines&&e.lines.length){var i=e.lines[0];this.cache.clipedText=i.str,this.cache.clipedWidth=i.width}return this._AABBBounds}},{key:"updateMultilineAABBBounds",value:function(t){var e=this.getGraphicTheme(),i=this.attribute,n=i.direction,r=void 0===n?e.direction:n,a=i.underlineOffset,o=void 0===a?e.underlineOffset:a,s="horizontal"===r?this.updateHorizontalMultilineAABBBounds(t):this.updateVerticalMultilineAABBBounds(t);return"horizontal"===r&&o&&this._AABBBounds.add(this._AABBBounds.x1,this._AABBBounds.y2+o),s}},{key:"guessLineHeightBuf",value:function(t){return t?.1*t:0}},{key:"updateHorizontalMultilineAABBBounds",value:function(t){var e,i=this.getGraphicTheme(),n=this.attribute,r=n.fontFamily,a=void 0===r?i.fontFamily:r,o=n.textAlign,s=void 0===o?i.textAlign:o,l=n.textBaseline,u=void 0===l?i.textBaseline:l,c=n.fontSize,h=void 0===c?i.fontSize:c,d=n.fontWeight,p=void 0===d?i.fontWeight:d,f=n.ellipsis,v=void 0===f?i.ellipsis:f,g=n.maxLineWidth,y=n.stroke,m=void 0===y?i.stroke:y,_=n.wrap,b=void 0===_?i.wrap:_,x=n.measureMode,k=void 0===x?i.measureMode:x,S=n.lineWidth,A=void 0===S?i.lineWidth:S,M=n.whiteSpace,w=void 0===M?i.whiteSpace:M,T=n.suffixPosition,C=void 0===T?i.suffixPosition:T,E=n.ignoreBuf,P=void 0===E?i.ignoreBuf:E,R=n.keepCenterInLine,B=void 0===R?i.keepCenterInLine:R,I=P?0:this.guessLineHeightBuf(h),L=this.getLineHeight(n,i,I);if("normal"===w||b)return this.updateWrapAABBBounds(t);if(!this.shouldUpdateShape()&&(null===(e=this.cache)||void 0===e?void 0:e.layoutData)){var D=this.cache.layoutData.bbox;return this._AABBBounds.set(D.xOffset,D.yOffset,D.xOffset+D.width,D.yOffset+D.height),m&&this._AABBBounds.expand(A/2),this._AABBBounds}var O=nc.graphicUtil.textMeasure,F=new Dg(a,{fontSize:h,fontWeight:p,fontFamily:a,lineHeight:L},O).GetLayoutByLines(t,s,u,L,!0===v?i.ellipsis:v||void 0,!1,{lineWidth:g,suffixPosition:C,measureMode:k,keepCenterInLine:B}),z=F.bbox;return this.cache.layoutData=F,this.clearUpdateShapeTag(),this._AABBBounds.set(z.xOffset,z.yOffset,z.xOffset+z.width,z.yOffset+z.height),m&&this._AABBBounds.expand(A/2),this._AABBBounds}},{key:"updateWrapAABBBounds",value:function(t){var e,i,n,r=this.getGraphicTheme(),a=this.attribute,o=a.fontFamily,s=void 0===o?r.fontFamily:o,l=a.textAlign,u=void 0===l?r.textAlign:l,c=a.textBaseline,h=void 0===c?r.textBaseline:c,d=a.fontSize,p=void 0===d?r.fontSize:d,f=a.ellipsis,v=void 0===f?r.ellipsis:f,g=a.maxLineWidth,y=a.stroke,m=void 0===y?r.stroke:y,_=a.lineWidth,b=void 0===_?r.lineWidth:_,x=a.wordBreak,k=void 0===x?r.wordBreak:x,S=a.fontWeight,A=void 0===S?r.fontWeight:S,M=a.ignoreBuf,w=void 0===M?r.ignoreBuf:M,T=a.measureMode,C=void 0===T?r.measureMode:T,E=a.suffixPosition,P=void 0===E?r.suffixPosition:E,R=a.heightLimit,B=void 0===R?0:R,I=a.lineClamp,L=a.keepCenterInLine,D=void 0===L?r.keepCenterInLine:L,O=w?0:this.guessLineHeightBuf(p),F=this.getLineHeight(this.attribute,r,O);if(!this.shouldUpdateShape()&&(null===(e=this.cache)||void 0===e?void 0:e.layoutData)){var z=this.cache.layoutData.bbox;return this._AABBBounds.set(z.xOffset,z.yOffset,z.xOffset+z.width,z.yOffset+z.height),m&&this._AABBBounds.expand(b/2),this._AABBBounds}var H=nc.graphicUtil.textMeasure,j={fontSize:p,fontWeight:A,fontFamily:s,lineHeight:F},N=new Dg(s,j,H),V=X(t)?t.map((function(t){return t.toString()})):[t.toString()],W=[],G=[0,0],U=1/0;if(B>0&&(U=Math.max(Math.floor(B/F),1)),I&&(U=Math.min(U,I)),"number"==typeof g&&g!==1/0){if(g>0)for(var Y=0;Y<V.length;Y++){var K=V[Y],q=!0;if(Y===U-1){var Z=H.clipTextWithSuffix(K,j,g,v,!1,P,Y!==V.length-1),J=H.measureTextPixelADscentAndWidth(Z.str,j,C);W.push({str:Z.str,width:Z.width,ascent:J.ascent,descent:J.descent,keepCenterInLine:D});break}var Q=H.clipText(K,j,g,"break-all"!==k,"keep-all"===k);if(""!==K&&""===Q.str||Q.wordBreaked){if(v){var $=H.clipTextWithSuffix(K,j,g,v,!1,P);Q.str=null!==(i=$.str)&&void 0!==i?i:"",Q.width=null!==(n=$.width)&&void 0!==n?n:0}else Q.str="",Q.width=0;q=!1}var tt=H.measureTextPixelADscentAndWidth(Q.str,j,C);W.push({str:Q.str,width:Q.width,ascent:tt.ascent,descent:tt.descent,keepCenterInLine:D});var et=Q.str.length;if(!Q.wordBreaked||""!==K&&""===Q.str||(q=!0,et=Q.wordBreaked),Q.str.length===K.length);else if(q){var it=K.substring(et);"keep-all"===k&&(it=it.replace(/^\s+/g,"")),V.splice(Y+1,0,it)}}var nt=0;W.forEach((function(t){nt=Math.max(nt,t.width)})),G[0]=nt}else{for(var rt,at,ot=0,st=0,lt=V.length;st<lt;st++){if(st===U-1){var ut=H.clipTextWithSuffix(V[st],j,g,v,!1,P),ct=H.measureTextPixelADscentAndWidth(ut.str,j,C);W.push({str:ut.str,width:ut.width,ascent:ct.ascent,descent:ct.descent,keepCenterInLine:D}),ot=Math.max(ot,ut.width);break}at=V[st],rt=H.measureTextWidth(at,j),ot=Math.max(ot,rt);var ht=H.measureTextPixelADscentAndWidth(at,j,C);W.push({str:at,width:rt,ascent:ht.ascent,descent:ht.descent,keepCenterInLine:D})}G[0]=ot}G[1]=W.length*F;var dt={xOffset:0,yOffset:0,width:G[0],height:G[1]};N.LayoutBBox(dt,u,h,W);var pt=N.layoutWithBBox(dt,W,u,h,F);return this.cache.layoutData=pt,this.clearUpdateShapeTag(),this._AABBBounds.set(dt.xOffset,dt.yOffset,dt.xOffset+dt.width,dt.yOffset+dt.height),m&&this._AABBBounds.expand(b/2),this._AABBBounds}},{key:"updateVerticalMultilineAABBBounds",value:function(t){var i,n,r,a=this.getGraphicTheme(),o=nc.graphicUtil.textMeasure,s=this.attribute,l=s.maxLineWidth,u=void 0===l?a.maxLineWidth:l,c=s.ellipsis,h=void 0===c?a.ellipsis:c,d=s.fontFamily,p=void 0===d?a.fontFamily:d,f=s.fontSize,v=void 0===f?a.fontSize:f,g=s.fontWeight,y=void 0===g?a.fontWeight:g,m=s.stroke,_=void 0===m?a.stroke:m,b=s.lineWidth,x=void 0===b?a.lineWidth:b,k=s.verticalMode,S=void 0===k?a.verticalMode:k,A=s.suffixPosition,M=void 0===A?a.suffixPosition:A,w=this.getLineHeight(s,a,0),T=s.textAlign,C=void 0===T?a.textAlign:T,E=s.textBaseline,P=void 0===E?a.textBaseline:E;if(!S){var R=C;C=null!==(i=e.baselineMapAlign[P])&&void 0!==i?i:"left",P=null!==(n=e.alignMapBaseline[R])&&void 0!==n?n:"top"}if(r=0,!this.shouldUpdateShape()&&this.cache){this.cache.verticalList.forEach((function(t){var e=t.reduce((function(t,e){return t+e.width}),0);r=he(e,r)}));var B=vg(C,r),I=this.cache.verticalList.length*w,L=gg(P,I,v);return this._AABBBounds.set(L,B,L+I,B+r),_&&this._AABBBounds.expand(x/2),this._AABBBounds}var D=t.map((function(t){return function(t){for(var e=[],i=0,n="",r=0;r<t.length;r++)ev(t[r])?i?n+=t[r]:(i=1,n=t[r]):(i&&(e.push({text:n,direction:Zf.VERTICAL}),n="",i=0),e.push({text:t[r],direction:Zf.HORIZONTAL}));return n&&e.push({text:n,direction:Zf.VERTICAL}),e}(t.toString())}));D.forEach((function(t,e){if(Number.isFinite(u))if(h){var i=!0===h?a.ellipsis:h,n=o.clipTextWithSuffixVertical(t,{fontSize:v,fontWeight:y,fontFamily:p},u,i,!1,M);D[e]=n.verticalList,r=n.width}else{var s=o.clipTextVertical(t,{fontSize:v,fontWeight:y,fontFamily:p},u,!1);D[e]=s.verticalList,r=s.width}else r=0,t.forEach((function(t){var e=t.direction===Zf.HORIZONTAL?v:o.measureTextWidth(t.text,{fontSize:v,fontWeight:y,fontFamily:p});r+=e,t.width=e}))})),this.cache.verticalList=D,this.clearUpdateShapeTag(),this.cache.verticalList.forEach((function(t){var e=t.reduce((function(t,e){return t+e.width}),0);r=he(e,r)}));var O=vg(C,r),F=this.cache.verticalList.length*w,z=gg(P,F,v);return this._AABBBounds.set(z,O,z+F,O+r),_&&this._AABBBounds.expand(x/2),this._AABBBounds}},{key:"getMaxWidth",value:function(t){var e,i,n=this.attribute;return null!==(i=null!==(e=n.maxLineWidth)&&void 0!==e?e:n.maxWidth)&&void 0!==i?i:t.maxWidth}},{key:"getLineHeight",value:function(t,e,i){var n;return null!==(n=vd(t.lineHeight,t.fontSize||e.fontSize))&&void 0!==n?n:(t.fontSize||e.fontSize)+i}},{key:"needUpdateTags",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Og;return y(e,"needUpdateTags",this,3)([t,i])}},{key:"needUpdateTag",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Og;return y(e,"needUpdateTag",this,3)([t,i])}},{key:"_interpolate",value:function(t,e,i,n,r){"text"===t&&(r.text=n)}},{key:"clone",value:function(){return new e(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}},{key:"getBaselineMapAlign",value:function(){return e.baselineMapAlign}},{key:"getAlignMapBaseline",value:function(){return e.alignMapBaseline}}])}(Rv);function zg(t){return new Fg(t)}Fg.NOWORK_ANIMATE_ATTR=Object.assign({ellipsis:1,wordBreak:1,direction:1,textAlign:1,textBaseline:1,fontFamily:1,fontWeight:1},Pv),Fg.baselineMapAlign={top:"left",bottom:"right",middle:"center"},Fg.alignMapBaseline={left:"top",right:"bottom",center:"middle"};var Hg=["symbolType","size"].concat(m(Mv)),jg=function(t){function e(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{symbolType:"circle"};return r(this,e),(t=n(this,e,[i])).type="symbol",t.numberType=gv,t}return h(e,t),o(e,[{key:"getParsedPath",value:function(){return this.shouldUpdateShape()&&(this._parsedPath=this.doUpdateParsedPath(),this.clearUpdateShapeTag()),this._parsedPath}},{key:"getParsedPath2D",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=null;try{n=new Path2D}catch(t){return null}var r=this.getParsedPath();if(!r)return null;r.draw(n,i,t,e)}},{key:"isValid",value:function(){return y(e,"isValid",this,3)([])&&this._isValid()}},{key:"_isValid",value:function(){var t=this.attribute.size;return X(t)?2===t.length&&t.every(this._validNumber):this._validNumber(t)}},{key:"doUpdateParsedPath",value:function(){var t=this.attribute.symbolType,i=void 0===t?"circle":t;return y(e,"parsePath",this,3)([i])}},{key:"getGraphicTheme",value:function(){return xh(this).symbol}},{key:"updateAABBBounds",value:function(t,e,i,n){this.updatePathProxyAABBBounds(i)||(n?this.updateSymbolAABBBoundsImprecise(t,e,i):this.updateSymbolAABBBoundsAccurate(t,e,i));var r=nc.graphicService.updateTempAABBBounds(i),a=r.tb1,o=r.tb2;(function(t,e,i){var n=t.outerBorder,r=t.shadowBlur,a=void 0===r?e.shadowBlur:r,o=t.strokeBoundsBuffer,s=void 0===o?e.strokeBoundsBuffer:o;if(n){var l=e.outerBorder,u=n.distance,c=void 0===u?l.distance:u,h=n.lineWidth;qf(i,c+(a+(void 0===h?l.lineWidth:h))/2,!0,s)}})(t,e,a),i.union(a),a.setValue(o.x1,o.y1,o.x2,o.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,this.x1WithoutTransform=i.x1,this.y1WithoutTransform=i.y1;var s=t.lineJoin,l=void 0===s?e.lineJoin:s;return nc.graphicService.transformAABBBounds(t,i,e,"miter"===l,this),i}},{key:"updateSymbolAABBBoundsImprecise",value:function(t,e,i){var n=t.size,r=void 0===n?e.size:n;if(X(r))i.set(-r[0]/2,-r[1]/2,r[0]/2,r[1]/2);else{var a=r/2;i.set(-a,-a,a,a)}return i}},{key:"updateSymbolAABBBoundsAccurate",value:function(t,e,i){var n=t.size,r=void 0===n?e.size:n;return this.getParsedPath().bounds(r,i),i}},{key:"needUpdateTags",value:function(t){return y(e,"needUpdateTags",this,3)([t,Hg])}},{key:"needUpdateTag",value:function(t){return y(e,"needUpdateTag",this,3)([t,Hg])}},{key:"toCustomPath",value:function(){var t=this.getParsedPath(),e=this.attribute.size,i=X(e)?e:[e,e];return t.path?(new Ru).fromCustomPath2D(t.path,0,0,i[0],i[1]):(new Ru).fromString(t.pathStr,0,0,i[0],i[1])}},{key:"clone",value:function(){return new e(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}}])}(Rv);function Ng(t){return new jg(t)}jg.NOWORK_ANIMATE_ATTR=Object.assign({symbolType:1},Pv);var Vg=["segments","points","curveType","curveTension"].concat(m(Mv)),Wg=function(t){function e(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r(this,e),(t=n(this,e,[i])).type="line",t.numberType=uv,t}return h(e,t),o(e,[{key:"isValid",value:function(){return y(e,"isValid",this,3)([])&&this._isValid()}},{key:"_isValid",value:function(){if(this.pathProxy)return!0;var t=this.attribute,e=t.points,i=t.segments;return i?0!==i.length:!(!e||e.length<=1)}},{key:"_interpolate",value:function(t,e,i,n,r){"points"===t&&(r.points=ud(i,n,e))}},{key:"getGraphicTheme",value:function(){return xh(this).line}},{key:"updateAABBBounds",value:function(t,e,i){this.updatePathProxyAABBBounds(i)||(t.segments?this.updateLineAABBBoundsBySegments(t,e,i):this.updateLineAABBBoundsByPoints(t,e,i)),nc.graphicService.updateTempAABBBounds(i),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1;var n=t.lineJoin,r=void 0===n?e.lineJoin:n;return nc.graphicService.transformAABBBounds(t,i,e,"miter"===r,this),i}},{key:"updateLineAABBBoundsByPoints",value:function(t,e,i,n){var r=t.points,a=void 0===r?e.points:r,o=t.connectedType,s=i;return a.forEach((function(t){!1===t.defined&&"connect"!==o||s.add(t.x,t.y)})),s}},{key:"updateLineAABBBoundsBySegments",value:function(t,e,i,n){var r=t.segments,a=void 0===r?e.segments:r,o=t.connectedType,s=i;return a.forEach((function(t){t.points.forEach((function(t){!1===t.defined&&"connect"!==o||s.add(t.x,t.y)}))})),s}},{key:"needUpdateTags",value:function(t){return y(e,"needUpdateTags",this,3)([t,Vg])}},{key:"needUpdateTag",value:function(t){return y(e,"needUpdateTag",this,3)([t,Vg])}},{key:"toCustomPath",value:function(){var t=this.attribute,e=new Ru,i=t.segments,n=function(t){if(t&&t.length){var i=!0;t.forEach((function(t){!1!==t.defined&&(i?e.moveTo(t.x,t.y):e.lineTo(t.x,t.y),i=!1)}))}};return i&&i.length?i.forEach((function(t){n(t.points)})):t.points&&n(t.points),e}},{key:"clone",value:function(){return new e(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}}])}(Rv);function Gg(t){return new Wg(t)}Wg.NOWORK_ANIMATE_ATTR=Object.assign({segments:1,curveType:1},Pv);var Ug=["width","x1","y1","height","cornerRadius"].concat(m(Mv)),Yg=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[t])).type="rect",i.numberType=pv,i}return h(e,t),o(e,[{key:"isValid",value:function(){return y(e,"isValid",this,3)([])&&this._isValid()}},{key:"_isValid",value:function(){return!0}},{key:"getGraphicTheme",value:function(){return xh(this).rect}},{key:"updateAABBBounds",value:function(t,e,i){if(!this.updatePathProxyAABBBounds(i)){var n=t.width,r=t.height,a=t.x1,o=t.y1,s=t.x,l=t.y;n=null!=n?n:a-s,r=null!=r?r:o-l,(isFinite(n)||isFinite(r)||isFinite(s)||isFinite(l))&&i.set(0,0,n||0,r||0)}var u=nc.graphicService.updateTempAABBBounds(i),c=u.tb1,h=u.tb2;return Rg(t,e,c),i.union(c),c.setValue(h.x1,h.y1,h.x2,h.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,nc.graphicService.transformAABBBounds(t,i,e,!1,this),i}},{key:"needUpdateTags",value:function(t){return y(e,"needUpdateTags",this,3)([t,Ug])}},{key:"needUpdateTag",value:function(t){return y(e,"needUpdateTag",this,3)([t,Ug])}},{key:"toCustomPath",value:function(){var t=this.attribute,e=Ld(t),i=e.x,n=e.y,r=e.width,a=e.height,o=new Ru;return o.moveTo(i,n),o.rect(i,n,r,a),o}},{key:"clone",value:function(){return new e(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}}])}(Rv);function Xg(t){return new Yg(t)}Yg.NOWORK_ANIMATE_ATTR=Pv;var Kg=[[0,0,0],[1,0,0],[1,1,0],[0,1,0],[0,0,1],[1,0,1],[1,1,1],[0,1,1]],qg=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[t])).type="rect3d",i.numberType=fv,i}return h(e,t),o(e,[{key:"findFace",value:function(){var t={polygons:[],vertices:[],edges:[]},e=this.getGraphicTheme(),i=this.attribute,n=i.x1,r=i.y1,a=i.x,o=i.y,s=i.length,l=void 0===s?de(e.width,e.height):s,u=this.attribute,c=u.width,h=u.height;c=null!=c?c:n-a,h=null!=h?h:r-o;for(var d=0;d<Kg.length;d++){var p=Kg[d];t.vertices.push([p[0]*c,p[1]*h,p[2]*l])}return t.polygons.push({polygon:[0,1,5,4],normal:[0,-1,0]}),t.polygons.push({polygon:[2,3,7,6],normal:[0,1,0]}),t.polygons.push({polygon:[4,7,3,0],normal:[-1,0,0]}),t.polygons.push({polygon:[1,2,6,5],normal:[1,0,0]}),t.polygons.push({polygon:[0,1,2,3],normal:[0,0,-1]}),t.polygons.push({polygon:[4,5,6,7],normal:[0,0,1]}),t.edges=[[0,1],[1,2],[2,3],[3,0],[4,5],[5,6],[6,7],[7,4],[0,4],[3,7],[1,5],[2,6]],t}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}}])}(Yg);function Zg(t){return new qg(t)}qg.NOWORK_ANIMATE_ATTR=Pv;var Jg=function(t){function e(t){var a;return r(this,e),(a=n(this,e,[t])).type="glyph",a.numberType=ov,a.subGraphic=[],a._onInit&&a._onInit(i(a)),a.valid=a.isValid(),a}return h(e,t),o(e,[{key:"setSubGraphic",value:function(t){var e=this;this.detachSubGraphic(),this.subGraphic=t,t.forEach((function(t){t.glyphHost=e,Object.setPrototypeOf(t.attribute,e.attribute)})),this.valid=this.isValid(),this.addUpdateBoundTag()}},{key:"detachSubGraphic",value:function(){this.subGraphic.forEach((function(t){t.glyphHost=null,Object.setPrototypeOf(t.attribute,{})}))}},{key:"getSubGraphic",value:function(){return this.subGraphic}},{key:"onInit",value:function(t){this._onInit=t}},{key:"onUpdate",value:function(t){this._onUpdate=t}},{key:"isValid",value:function(){return!0}},{key:"setAttribute",value:function(t,i,n,r){y(e,"setAttribute",this,3)([t,i,n,r]),this.subGraphic.forEach((function(t){t.addUpdateShapeAndBoundsTag(),t.addUpdatePositionTag()}))}},{key:"setAttributes",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;y(e,"setAttributes",this,3)([t,i,n]),this.subGraphic.forEach((function(t){t.addUpdateShapeAndBoundsTag(),t.addUpdatePositionTag()}))}},{key:"translate",value:function(t,i){return y(e,"translate",this,3)([t,i]),this.subGraphic.forEach((function(t){t.addUpdatePositionTag(),t.addUpdateBoundTag()})),this}},{key:"translateTo",value:function(t,i){return y(e,"translateTo",this,3)([t,i]),this.subGraphic.forEach((function(t){t.addUpdatePositionTag(),t.addUpdateBoundTag()})),this}},{key:"scale",value:function(t,i,n){return y(e,"scale",this,3)([t,i,n]),this.subGraphic.forEach((function(t){t.addUpdatePositionTag(),t.addUpdateBoundTag()})),this}},{key:"scaleTo",value:function(t,i){return y(e,"scaleTo",this,3)([t,i]),this.subGraphic.forEach((function(t){t.addUpdatePositionTag(),t.addUpdateBoundTag()})),this}},{key:"rotate",value:function(t){return y(e,"rotate",this,3)([t]),this.subGraphic.forEach((function(t){t.addUpdatePositionTag(),t.addUpdateBoundTag()})),this}},{key:"rotateTo",value:function(t){return y(e,"rotate",this,3)([t]),this.subGraphic.forEach((function(t){t.addUpdatePositionTag(),t.addUpdateBoundTag()})),this}},{key:"getGraphicTheme",value:function(){return xh(this).glyph}},{key:"updateAABBBounds",value:function(t,e,i){return this.getSubGraphic().forEach((function(t){i.union(t.AABBBounds)})),i}},{key:"doUpdateAABBBounds",value:function(){this.updateAABBBoundsStamp++,this._AABBBounds.clear();var t=this.updateAABBBounds(this.attribute,this.getGraphicTheme(),this._AABBBounds);return this.clearUpdateBoundTag(),t}},{key:"needUpdateTags",value:function(t){return!1}},{key:"needUpdateTag",value:function(t){return!1}},{key:"useStates",value:function(t,e){var i,n=this;if(t.length){if((null===(i=this.currentStates)||void 0===i?void 0:i.length)!==t.length||t.some((function(t,e){return n.currentStates[e]!==t}))){this.stopStateAnimates();var r={},a=this.subGraphic.map((function(){return{}}));t.forEach((function(e){var i,o=n.glyphStateProxy?n.glyphStateProxy(e,t):n.glyphStates[e];o&&(Object.assign(r,o.attributes),(null===(i=o.subAttributes)||void 0===i?void 0:i.length)&&a.forEach((function(t,e){Object.assign(t,o.subAttributes[e])})))})),this.subGraphic.forEach((function(i,n){i.updateNormalAttrs(a[n]),i.applyStateAttrs(a[n],t,e)})),this.updateNormalAttrs(r),this.currentStates=t,this.applyStateAttrs(r,t,e)}}else this.clearStates(e)}},{key:"clearStates",value:function(t){var e=this;this.stopStateAnimates(),this.hasState()&&this.normalAttrs?(this.currentStates=[],this.subGraphic.forEach((function(i){i.applyStateAttrs(i.normalAttrs,e.currentStates,t,!0),i.normalAttrs=null})),this.applyStateAttrs(this.normalAttrs,this.currentStates,t,!0)):this.currentStates=[],this.normalAttrs=null}},{key:"clone",value:function(){var t=new e(Object.assign({},this.attribute));return t.setSubGraphic(this.subGraphic.map((function(t){return t.clone()}))),t}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}}])}(Rv);function Qg(t){return new Jg(t)}Jg.NOWORK_ANIMATE_ATTR=Pv;var $g=function(){return o((function t(e,i,n,a,o,s,l,u,c,h,d,p,f,v){r(this,t),this.left=e,this.top=i,this.width=n,this.height=a,this.actualHeight=0,this.bottom=i+a,this.right=e+n,this.ellipsis=o,this.wordBreak=s,this.verticalDirection=l,this.lines=[],this.globalAlign=u,this.globalBaseline=c,this.layoutDirection=h,this.directionKey=lc[this.layoutDirection],this.isWidthMax=d,this.isHeightMax=p,this.singleLine=f,v?(v.clear(),this.icons=v):this.icons=new Map}),[{key:"draw",value:function(t,e){var i=this.getActualSize(),n=i.width,r=i.height,a=this.isWidthMax?Math.min(this.width,n):this.width||n||0,o=this.isHeightMax?Math.min(this.height,r):this.height||r||0;o=Math.min(o,r);var s=0;switch(this.globalBaseline){case"top":s=0;break;case"middle":s=-o/2;break;case"bottom":s=-o}var l=0;"right"===this.globalAlign||"end"===this.globalAlign?l=-a:"center"===this.globalAlign&&(l=-a/2);var u=this[this.directionKey.height];this.singleLine&&(u=this.lines[0].height+1);var c=!1;if("middle"===this.verticalDirection)if(this.actualHeight>=u&&0!==u)for(var h=0;h<this.lines.length;h++){var d=this.lines[h],p=d.top,f=d.height;if(p+f<this[this.directionKey.top]||p+f>this[this.directionKey.top]+u)return c;var v=!1;this.ellipsis&&this.lines[h+1]&&this.lines[h+1].top+this.lines[h+1].height>this[this.directionKey.top]+u&&(v=!0,c=!0),this.lines[h].draw(t,v,this.lines[h][this.directionKey.left]+l,this.lines[h][this.directionKey.top]+s,this.ellipsis,e)}else{var g=Math.floor((u-this.actualHeight)/2);"vertical"===this.layoutDirection?l+=g:s+=g;for(var y=0;y<this.lines.length;y++)this.lines[y].draw(t,!1,this.lines[y][this.directionKey.left]+l,this.lines[y][this.directionKey.top]+s,this.ellipsis,e)}else if("bottom"===this.verticalDirection&&"vertical"!==this.layoutDirection)for(var m=0;m<this.lines.length;m++){var _=this.lines[m];_.top;var b=_.height,x=u-this.lines[m].top-this.lines[m].height;if(0===u)this.lines[m].draw(t,!1,l,x+s,this.ellipsis,e);else{if(x+b>this[this.directionKey.top]+u||x<this[this.directionKey.top])return c;var k=!1;this.ellipsis&&this.lines[m+1]&&x-this.lines[m+1].height<this[this.directionKey.top]&&(k=!0,c=!0),this.lines[m].draw(t,k,l,x+s,this.ellipsis,e)}}else{"bottom"===this.verticalDirection&&"vertical"===this.layoutDirection&&this.singleLine&&this.isWidthMax&&(l+=this.lines[0].height+1);for(var S=0;S<this.lines.length;S++){"bottom"===this.verticalDirection&&"vertical"===this.layoutDirection&&(l-=this.lines[S].height+this.lines[S].top);var A=this.lines[S],M=A.top,w=A.height;if(0===u)this.lines[S].draw(t,!1,this.lines[S][this.directionKey.left]+l,this.lines[S][this.directionKey.top]+s,this.ellipsis,e);else{if(M+w<this[this.directionKey.top]||M+w>this[this.directionKey.top]+u)return c;var T=!1;this.ellipsis&&this.lines[S+1]&&this.lines[S+1].top+this.lines[S+1].height>this[this.directionKey.top]+u&&(T=!0,c=!0),this.lines[S].draw(t,T,this.lines[S][this.directionKey.left]+l,this.lines[S][this.directionKey.top]+s,this.ellipsis,e)}}}return c}},{key:"getActualSize",value:function(){return this.ellipsis?this.getActualSizeWidthEllipsis():this.getRawActualSize()}},{key:"getRawActualSize",value:function(){for(var t=0,e=0,i=0;i<this.lines.length;i++){var n=this.lines[i];n.actualWidth>t&&(t=n.actualWidth),e+=n.height}return{width:"vertical"===this.layoutDirection?e:t,height:"vertical"===this.layoutDirection?t:e}}},{key:"getActualSizeWidthEllipsis",value:function(){var t=0,e=0,i=this.getRawActualSize();i.width;i.height;this.width,this.height;var n=this[this.directionKey.height];if(this.singleLine&&(n=this.lines[0].height+1),"middle"===this.verticalDirection)if(this.actualHeight>=n&&0!==n)for(var r=0;r<this.lines.length;r++){var a=this.lines[r],o=a.top,s=a.height;if(o+s<this[this.directionKey.top]||o+s>this[this.directionKey.top]+n);else if(this.ellipsis&&this.lines[r+1]&&this.lines[r+1].top+this.lines[r+1].height>this[this.directionKey.top]+n){var l=!0===this.ellipsis?"...":this.ellipsis||"",u=this.lines[r].getWidthWithEllips(l);u>t&&(t=u),e+=this.lines[r].height}else this.lines[r].actualWidth>t&&(t=this.lines[r].actualWidth),e+=this.lines[r].height}else{Math.floor((n-this.actualHeight)/2);for(var c=0;c<this.lines.length;c++)this.lines[c].actualWidth>t&&(t=this.lines[c].actualWidth),e+=this.lines[c].height}else if("bottom"===this.verticalDirection)for(var h=0;h<this.lines.length;h++){var d=this.lines[h];d.top;var p=d.height,f=n-this.lines[h].top-this.lines[h].height;if(0===n)this.lines[h].actualWidth>t&&(t=this.lines[h].actualWidth),e+=this.lines[h].height;else if(f+p>this[this.directionKey.top]+n||f<this[this.directionKey.top]);else if(this.ellipsis&&this.lines[h+1]&&f-this.lines[h+1].height<this[this.directionKey.top]){var v=!0===this.ellipsis?"...":this.ellipsis||"",g=this.lines[h].getWidthWithEllips(v);g>t&&(t=g),e+=this.lines[h].height}else this.lines[h].actualWidth>t&&(t=this.lines[h].actualWidth),e+=this.lines[h].height}else for(var y=0;y<this.lines.length;y++){var m=this.lines[y],_=m.top,b=m.height;if(0===n)this.lines[y].actualWidth>t&&(t=this.lines[y].actualWidth),e+=this.lines[y].height;else if(_+b<this[this.directionKey.top]||_+b>this[this.directionKey.top]+n);else if(this.ellipsis&&this.lines[y+1]&&this.lines[y+1].top+this.lines[y+1].height>this[this.directionKey.top]+n){var x=!0===this.ellipsis?"...":this.ellipsis||"",k=this.lines[y].getWidthWithEllips(x);k>t&&(t=k),e+=this.lines[y].height}else this.lines[y].actualWidth>t&&(t=this.lines[y].actualWidth),e+=this.lines[y].height}return{width:"vertical"===this.layoutDirection?e:t,height:"vertical"===this.layoutDirection?t:e}}}])}();function ty(t,e,i,n){var r=Math.round(t),a=Math.round(i),o=Math.round(e),s=Math.round(n);return{left:t>r?r:r-.5,top:i>a?a:a-.5,right:o>e?o:o+.5,bottom:s>n?s:s+.5}}var ey=function(){return o((function t(e,i,n,a){var o,s;r(this,t),this.fontSize=n.fontSize||16,this.textBaseline=n.textBaseline||"alphabetic",this.ascentDescentMode=a;var l=vd(n.lineHeight,this.fontSize);this.lineHeight="number"==typeof l?l>this.fontSize?l:this.fontSize:Math.floor(1.2*this.fontSize),this.height=this.lineHeight;var u=mc(e,n,this.ascentDescentMode),c=u.ascent,h=u.height,d=u.descent,p=u.width,f=0,v=0,g=0;this.height>h&&(f=(this.height-h)/2,v=Math.ceil(f),g=Math.floor(f)),"top"===this.textBaseline?(this.ascent=f,this.descent=h-f):"bottom"===this.textBaseline?(this.ascent=h-f,this.descent=f):"middle"===this.textBaseline?(this.ascent=this.height/2,this.descent=this.height/2):(this.ascent=c+v,this.descent=d+g),this.length=e.length,this.width=p||0,this.text=e||"",this.newLine=i||!1,this.character=n,this.left=0,this.top=0,this.ellipsis="normal",this.ellipsisWidth=0,this.ellipsisOtherParagraphWidth=0,this.space=n.space,this.dx=null!==(o=n.dx)&&void 0!==o?o:0,this.dy=null!==(s=n.dy)&&void 0!==s?s:0,"vertical"===n.direction&&(this.direction=n.direction,this.widthOrigin=this.width,this.heightOrigin=this.height,this.width=this.heightOrigin,this.height=this.widthOrigin,this.lineHeight=this.height),this.ellipsisStr="..."}),[{key:"updateWidth",value:function(){var t=mc(this.text,this.character,this.ascentDescentMode).width;this.width=t,"vertical"===this.direction&&(this.widthOrigin=this.width,this.width=this.heightOrigin,this.height=this.widthOrigin)}},{key:"drawBackground",value:function(t,e,i,n,r,a,o){if(""!==this.text&&"\n"!==this.text&&this.character.background&&(!this.character.backgroundOpacity||this.character.backgroundOpacity>0)){var s=this.text,l=this.left+n;this.top;var u=this.direction;if(this.verticalEllipsis)s=this.ellipsisStr,u="vertical",this.ellipsisWidth/2;else{if("hide"===this.ellipsis)return;if("add"===this.ellipsis)s+=this.ellipsisStr,"right"!==a&&"end"!==a||(l-=this.ellipsisWidth);else if("replace"===this.ellipsis){var c=vc(s,("vertical"===u?this.height:this.width)-this.ellipsisWidth+this.ellipsisOtherParagraphWidth,this.character,s.length-1);if(s=s.slice(0,c),s+=this.ellipsisStr,"right"===a||"end"===a)if("vertical"===u);else{var h=mc(this.text.slice(c),this.character,this.ascentDescentMode).width;l-=this.ellipsisWidth-h}}}var d=ty(l,l+(this.widthOrigin||this.width),e,e+o);return Object.assign(Object.assign({},d),{fillStyle:this.character.background,globalAlpha:this.character.backgroundOpacity})}}},{key:"draw",value:function(t,e,i,n,r,a,o){var s,l=e+i,u=this.text,c=this.left+n+(null!==(s=this.space)&&void 0!==s?s:0)/2;l+=this.top;var h=this.direction;if(this.verticalEllipsis)u=this.ellipsisStr,h="vertical",l-=this.ellipsisWidth/2;else{if("hide"===this.ellipsis)return;if("add"===this.ellipsis)u+=this.ellipsisStr,"right"!==a&&"end"!==a||(c-=this.ellipsisWidth);else if("replace"===this.ellipsis){var d=vc(u,("vertical"===h?this.height:this.width)-this.ellipsisWidth+this.ellipsisOtherParagraphWidth,this.character,u.length-1);if(u=u.slice(0,d),u+=this.ellipsisStr,"right"===a||"end"===a)if("vertical"===h);else{var p=mc(this.text.slice(d),this.character,this.ascentDescentMode).width;c-=this.ellipsisWidth-p}}}switch(this.character.script){case"super":l-=this.ascent*(1/3);break;case"sub":l+=this.descent/2}"vertical"===h&&(t.save(),t.rotateAbout(Math.PI/2,c,l),t.translate(-this.heightOrigin||-this.lineHeight/2,-this.descent/2),t.translate(c,l),c=0,l=0);var f=this.character.lineWidth,v=void 0===f?1:f;if(this.character.stroke&&v&&t.strokeText(u,c,l+this.dy),this.character.fill&&t.fillText(u,c,l+this.dy),this.character.fill)if(this.character.lineThrough||this.character.underline){if(this.character.underline){var g=1+l,y=ty(c,c+(this.widthOrigin||this.width),g,g+(this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1));t.fillRect(y.left,1+l,y.right-y.left,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)}if(this.character.lineThrough){var m=1+l-this.ascent/2,_=ty(c,c+(this.widthOrigin||this.width),m,m+(this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1));t.fillRect(_.left,1+l-this.ascent/2,_.right-_.left,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)}}else if("underline"===this.character.textDecoration){var b=1+l,x=ty(c,c+(this.widthOrigin||this.width),b,b+(this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1));t.fillRect(x.left,1+l,x.right-x.left,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)}else if("line-through"===this.character.textDecoration){var k=1+l-this.ascent/2,S=ty(c,c+(this.widthOrigin||this.width),k,k+(this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1));t.fillRect(S.left,1+l-this.ascent/2,S.right-S.left,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)}"vertical"===h&&t.restore()}},{key:"getWidthWithEllips",value:function(t){var e=this.text,i="vertical"===t?this.height:this.width;if("hide"===this.ellipsis)return i;if("add"===this.ellipsis)return i+this.ellipsisWidth;if("replace"===this.ellipsis){var n=vc(e,i-this.ellipsisWidth+this.ellipsisOtherParagraphWidth,this.character,e.length-1);e=e.slice(0,n),e+=this.ellipsisStr;var r=mc(this.text.slice(n),this.character,this.ascentDescentMode).width;return i+this.ellipsisWidth-r}return i}}])}();var iy=["width","height","image"].concat(m(Mv)),ny=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[t])).type="image",i.numberType=lv,i.loadImage(i.attribute.image),i}return h(e,t),o(e,[{key:"getImageElement",value:function(){var t=this.attribute.image;if(!t||!this.resources)return null;var e=this.resources.get(t);return"success"!==e.state?null:e.data}},{key:"width",get:function(){return this.tryUpdateAABBBounds(),this._actualWidth}},{key:"height",get:function(){return this.tryUpdateAABBBounds(),this._actualHeight}},{key:"repeatX",get:function(){var t;return null!==(t=this.attribute.repeatX)&&void 0!==t?t:"no-repeat"},set:function(t){this.attribute.repeatX===t&&(this.attribute.repeatX=t)}},{key:"repeatY",get:function(){var t;return null!==(t=this.attribute.repeatY)&&void 0!==t?t:"no-repeat"},set:function(t){this.attribute.repeatY===t&&(this.attribute.repeatY=t)}},{key:"image",get:function(){return this.attribute.image},set:function(t){t!==this.attribute.image&&(this.attribute.image=t,this.loadImage(this.attribute.image))}},{key:"imageLoadSuccess",value:function(t,i,n){var r=this;y(e,"imageLoadSuccess",this,3)([t,i,function(){r.successCallback&&r.successCallback()}]),this.addUpdateBoundTag()}},{key:"imageLoadFail",value:function(t,i){var n=this;y(e,"imageLoadFail",this,3)([t,function(){n.failCallback&&n.failCallback()}])}},{key:"setAttributes",value:function(t,i,n){return t.image&&this.loadImage(t.image),y(e,"setAttributes",this,3)([t,i,n])}},{key:"setAttribute",value:function(t,i,n,r){return"image"===t&&this.loadImage(i),y(e,"setAttribute",this,3)([t,i,n,r])}},{key:"getGraphicTheme",value:function(){return xh(this).image}},{key:"updateAABBBounds",value:function(t,e,i){if(!this.updatePathProxyAABBBounds(i)){var n=t.maxWidth,r=void 0===n?e.maxWidth:n,a=t.maxHeight,o=void 0===a?e.maxHeight:a,s=t.width,l=t.height;if(null==s||null==l){var u=this.getImageElement();if(u){var c=u.width,h=u.height;if(null!=s)l=s*(h/c);else if(null!=l)s=l*(c/h);else{var d=c/h;d>r/o?(s=r,l=r/d):(l=o,s=o*d)}}else s=r,l=o}this._actualWidth=s,this._actualHeight=l,i.set(0,0,s,l)}var p=nc.graphicService.updateTempAABBBounds(i),f=p.tb1,v=p.tb2;return Rg(t,e,f),i.union(f),f.setValue(v.x1,v.y1,v.x2,v.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,nc.graphicService.transformAABBBounds(t,i,e,!1,this),i}},{key:"getDefaultAttribute",value:function(t){return ec[t]}},{key:"needUpdateTags",value:function(t){return y(e,"needUpdateTags",this,3)([t,iy])}},{key:"needUpdateTag",value:function(t){return y(e,"needUpdateTag",this,3)([t,iy])}},{key:"clone",value:function(){return new e(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}}])}(Rv);function ry(t){return new ny(t)}ny.NOWORK_ANIMATE_ATTR=Object.assign({image:1,repeatX:1,repeatY:1},Pv);var ay=function(t){function e(t){var i;if(r(this,e),(i=n(this,e,[t]))._x=0,i._y=0,i._hovered=!1,i._marginArray=[0,0,0,0],"always"===t.backgroundShowMode&&(i._hovered=!0),t.margin){var a=rd(t.margin);i._marginArray="number"==typeof a?[a,a,a,a]:a}return i.onBeforeAttributeUpdate=function(t,e,n){if(X(n)&&-1!==n.indexOf("margin")||"margin"===n)if(e.margin){var r=rd(e.margin);i._marginArray="number"==typeof r?[r,r,r,r]:r}else i._marginArray=[0,0,0,0]},i}return h(e,t),o(e,[{key:"width",get:function(){var t;return(null!==(t=this.attribute.width)&&void 0!==t?t:0)+this._marginArray[1]+this._marginArray[3]}},{key:"height",get:function(){var t;return(null!==(t=this.attribute.height)&&void 0!==t?t:0)+this._marginArray[0]+this._marginArray[2]}},{key:"tryUpdateAABBBounds",value:function(){if(!this.shouldUpdateAABBBounds())return this._AABBBounds;this.doUpdateAABBBounds();var t=this.attribute,e=t.width,i=void 0===e?ec.width:e,n=t.height,r=void 0===n?ec.height:n,a=this.attribute,o=a.backgroundWidth,s=void 0===o?i:o,l=a.backgroundHeight,u=(s-i)/2,c=((void 0===l?r:l)-r)/2;return this._AABBBounds.expand([0,2*u,2*c,0]),this._AABBBounds}},{key:"setHoverState",value:function(t){"hover"===this.attribute.backgroundShowMode&&this._hovered!==t&&(this._hovered=t)}}])}(ny),oy=function(){return o((function t(e,i,n,a,o,s,l,u){var c=this;r(this,t),this.left=e,this.width=i,this.baseline=n,this.ascent=a,this.descent=o,this.top=n-a,this.paragraphs=s.map((function(t){return t})),this.textAlign=(this.paragraphs[0]instanceof ay?this.paragraphs[0].attribute.textAlign:this.paragraphs[0].character.textAlign)||"left",this.direction=l,this.directionKey=lc[this.direction],this.actualWidth=0;var h=0;this.paragraphs.forEach((function(t,e){if(0===e&&t instanceof ey){var i=pc.exec(t.text);0!==(null==i?void 0:i.index)&&(t.text=t.text.slice(null==i?void 0:i.index),t.updateWidth())}c.actualWidth+=t[c.directionKey.width],h=Math.max(t[c.directionKey.height],h)})),this.height=h,this.blankWidth=u?0:this.width-this.actualWidth,this.calcOffset(i,u)}),[{key:"calcOffset",value:function(t,e){var i=this.directionKey,n=this.height,r=this.left,a=0;this.actualWidth<t&&!e&&("right"===this.textAlign||"end"===this.textAlign?r=t-this.actualWidth:"center"===this.textAlign?r=(t-this.actualWidth)/2:"justify"===this.textAlign&&(this.paragraphs.length<2?r=(t-this.actualWidth)/2:a=(t-this.actualWidth)/(this.paragraphs.length-1))),this.paragraphs.map((function(t){t instanceof ay?(t["_"+i.x]=r,r+=t[i.width]+a,t["_"+i.y]="top"===t.attribute.textBaseline?0:"bottom"===t.attribute.textBaseline?n-t.height:(n-t.height)/2):(t[i.left]=r,r+=t[i.width]+a)}))}},{key:"draw",value:function(t,e,i,n,r,a){var o=this;if(r&&(e||this.paragraphs.some((function(t){return t.overflow})))){for(var s=!0,l=!1,u=this.paragraphs.length-1;u>=0;u--){var c=this.paragraphs[u];if(c.overflow)s=s&&""===c.text;else if(s){l=!0;break}}var h=0;if(!l)for(var d=this.paragraphs.length-1;d>=0;d--){var p=this.paragraphs[d];if(p.overflow){if(""===p.text)break}else{if(p instanceof ay)break;if("vertical"===this.direction&&"vertical"!==p.direction){p.verticalEllipsis=!0;break}var f=!0===r?"...":r||"";p.ellipsisStr=f;var v=mc(f,p.character,p.ascentDescentMode).width||0;if(v<=this.blankWidth+h){e&&(p.ellipsis="add");break}if(v<=this.blankWidth+h+p.width){p.ellipsis="replace",p.ellipsisWidth=v,p.ellipsisOtherParagraphWidth=this.blankWidth+h;break}p.ellipsis="hide",h+=p.width}}}var g="",y=-1,m=[],_=[m];this.paragraphs.forEach((function(e,r){if(!(e instanceof ay)){var a=e.drawBackground(t,n,o.ascent,i,0===r,o.textAlign,o.height);a&&(g===a.fillStyle&&y===a.globalAlpha||(m=[],_.push(m),g=a.fillStyle,y=a.globalAlpha),m.push(a))}})),_.forEach((function(e){if(0!==e.length){var i=e[0],n=e[e.length-1];t.fillStyle=i.fillStyle,t.globalAlpha=i.globalAlpha,t.fillRect(i.left,i.top,n.right-i.left,n.bottom-i.top)}})),this.paragraphs.forEach((function(e,r){if(e instanceof ay)return e.setAttributes({x:i+e._x,y:n+e._y}),void a(e,t,i+e._x,n+e._y,o.ascent);var s={x1:o.left,y1:o.top,x2:o.left+o.actualWidth,y2:o.top+o.height};(function(t,e){var i=e&&e.stroke||cc;if(i){var n=e.strokeOpacity,r=void 0===n?1:n,a=e.opacity,o=void 0===a?1:a;t.globalAlpha=r*o,t.lineWidth=e&&"number"==typeof e.lineWidth?e.lineWidth:1,t.strokeStyle=i,fc(t,e)}else t.globalAlpha=0})(t,e.character),function(t,e,i){var n=e&&e.fill||uc;if(n){var r=e.fillOpacity,a=void 0===r?1:r,o=e.opacity,s=void 0===o?1:o;t.globalAlpha=a*s,t.fillStyle=i?sc(t,n,{AABBBounds:i}):n,fc(t,e)}else t.globalAlpha=0}(t,e.character,s),e.draw(t,n,o.ascent,i,0===r,o.textAlign,o.height)}))}},{key:"getWidthWithEllips",value:function(t){for(var e=this,i=0,n=this.paragraphs.length-1;n>=0;n--){var r=this.paragraphs[n];if(r instanceof ay)break;var a=mc(t,r.character,r.ascentDescentMode).width||0;if(a<=this.blankWidth+i){r.ellipsis="add",r.ellipsisWidth=a;break}if(a<=this.blankWidth+i+r.width){r.ellipsis="replace",r.ellipsisWidth=a,r.ellipsisOtherParagraphWidth=this.blankWidth+i;break}r.ellipsis="hide",i+=r.width}var o=0;return this.paragraphs.forEach((function(t,i){o+=t instanceof ay?t.width:t.getWidthWithEllips(e.direction)})),o}}])}(),sy=function(){return o((function t(e){r(this,t),this.frame=e,this.width=this.frame.width,this.height=this.frame.height,this.lineWidth=0,this.y=this.frame.top,this.maxAscent=0,this.maxDescent=0,this.maxAscentForBlank=0,this.maxDescentForBlank=0,this.lineBuffer=[],this.direction=e.layoutDirection,this.directionKey=lc[this.direction]}),[{key:"store",value:function(t){if(t instanceof ay){this.frame.icons.set(t.richtextId,t),this.lineBuffer.push(t),this.lineWidth+=t[this.directionKey.width];var e=0,i=0;"top"===t.attribute.textBaseline?(e=0,i=t.height):"bottom"===t.attribute.textBaseline?(e=t.height,i=0):(e=t.height/2,i=t.height/2),this.maxAscent=Math.max(this.maxAscent,e),this.maxDescent=Math.max(this.maxDescent,i)}else this.lineBuffer.push(t),0!==t.text.length?(this.lineWidth+=t[this.directionKey.width],this.maxAscent=Math.max(this.maxAscent,t.ascent),this.maxDescent=Math.max(this.maxDescent,t.descent)):(this.maxAscentForBlank=Math.max(this.maxAscentForBlank,t.ascent),this.maxDescentForBlank=Math.max(this.maxDescentForBlank,t.descent))}},{key:"send",value:function(){if(0!==this.lineBuffer.length){var t=0===this.maxAscent?this.maxAscentForBlank:this.maxAscent,e=0===this.maxDescent?this.maxDescentForBlank:this.maxDescent,i=new oy(this.frame.left,this[this.directionKey.width],this.y+t,t,e,this.lineBuffer,this.direction,"horizontal"===this.direction?this.frame.isWidthMax:this.frame.isHeightMax);this.frame.lines.push(i),this.frame.actualHeight+=i.height,this.y+=i.height,this.lineBuffer.length=0,this.lineWidth=this.maxAscent=this.maxDescent=this.maxAscentForBlank=this.maxDescentForBlank=0}}},{key:"deal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t instanceof ay?"horizontal"===this.direction&&0===this.width||"vertical"===this.direction&&0===this.height||this.lineWidth+t[this.directionKey.width]<=this[this.directionKey.width]?this.store(t):0===this.lineBuffer.length?(this.store(t),this.send()):(this.send(),this.deal(t)):"number"!=typeof this.width||this.width<0||(t.newLine&&this.send(),(0!==t.text.length||this.newLine)&&("horizontal"===this.direction&&0===this.width||"vertical"===this.direction&&0===this.height||this.lineWidth+t[this.directionKey.width]<=this[this.directionKey.width]?this.store(t):this.lineWidth===this[this.directionKey.width]?(this.send(),this.deal(t)):this.cut(t,e)))}},{key:"cut",value:function(t,e){var i=this[this.directionKey.width]-this.lineWidth||0,n=Math.ceil(i/t[this.directionKey.width]*t.length)||0,r=vc(t.text,i,t.character,n,"break-word"===this.frame.wordBreak);if(0!==r){var a=function(t,e){var i=t.text.slice(0,e),n=t.text.slice(e);return[new ey(i,t.newLine,t.character,t.ascentDescentMode),new ey(n,!0,t.character,t.ascentDescentMode)]}(t,r),o=g(a,2),s=o[0],l=o[1];this.store(s),e?this.send():this.deal(l)}else 0!==this.lineBuffer.length&&(this.send(),this.deal(t))}}])}(),ly=!1;try{ly=Intl&&"function"==typeof Intl.Segmenter}catch(t){ly=!1}var uy=["width","height","ellipsis","wordBreak","verticalDirection","maxHeight","maxWidth","textAlign","textBaseline","textConfig","layoutDirection","fill","stroke","fontSize","fontFamily","fontStyle","fontWeight","lineWidth","opacity","fillOpacity","strokeOpacity"].concat(m(Mv)),cy=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[t])).type="richtext",i._currentHoverIcon=null,i.numberType=vv,i.onBeforeAttributeUpdate=function(t,e,n){for(var r in t)if("hoverIconId"===r){if(t[r]===e[r])continue;var a=i._frameCache.icons.get(t[r]);i.updateHoverIconState(a)}},i}return h(e,t),o(e,[{key:"width",get:function(){var t;return null!==(t=this.attribute.width)&&void 0!==t?t:tc.width},set:function(t){this.attribute.width!==t&&(this.attribute.width=t,this.addUpdateShapeAndBoundsTag())}},{key:"height",get:function(){var t;return null!==(t=this.attribute.height)&&void 0!==t?t:tc.height},set:function(t){this.attribute.height!==t&&(this.attribute.height=t,this.addUpdateShapeAndBoundsTag())}},{key:"maxWidth",get:function(){return this.attribute.maxWidth},set:function(t){this.attribute.maxWidth!==t&&(this.attribute.maxWidth=t,this.addUpdateShapeAndBoundsTag())}},{key:"maxHeight",get:function(){return this.attribute.maxHeight},set:function(t){this.attribute.maxHeight!==t&&(this.attribute.maxHeight=t,this.addUpdateShapeAndBoundsTag())}},{key:"ellipsis",get:function(){var t;return null!==(t=this.attribute.ellipsis)&&void 0!==t?t:tc.ellipsis},set:function(t){this.attribute.ellipsis!==t&&(this.attribute.ellipsis=t,this.addUpdateShapeAndBoundsTag())}},{key:"wordBreak",get:function(){var t;return null!==(t=this.attribute.wordBreak)&&void 0!==t?t:tc.wordBreak},set:function(t){this.attribute.wordBreak!==t&&(this.attribute.wordBreak=t,this.addUpdateShapeAndBoundsTag())}},{key:"verticalDirection",get:function(){var t;return null!==(t=this.attribute.verticalDirection)&&void 0!==t?t:tc.verticalDirection},set:function(t){this.attribute.verticalDirection!==t&&(this.attribute.verticalDirection=t,this.addUpdateShapeAndBoundsTag())}},{key:"textAlign",get:function(){var t;return null!==(t=this.attribute.textAlign)&&void 0!==t?t:tc.textAlign},set:function(t){this.attribute.textAlign!==t&&(this.attribute.textAlign=t,this.addUpdateShapeAndBoundsTag())}},{key:"textBaseline",get:function(){var t;return null!==(t=this.attribute.textBaseline)&&void 0!==t?t:tc.textBaseline},set:function(t){this.attribute.textBaseline!==t&&(this.attribute.textBaseline=t,this.addUpdateShapeAndBoundsTag())}},{key:"textConfig",get:function(){var t;return null!==(t=this.attribute.textConfig)&&void 0!==t?t:tc.textConfig},set:function(t){this.attribute.textConfig=t,this.addUpdateShapeAndBoundsTag()}},{key:"getGraphicTheme",value:function(){return xh(this).richtext}},{key:"updateAABBBounds",value:function(t,e,i){var n,r,a,o,s=t.width,l=void 0===s?e.width:s,u=t.height,c=void 0===u?e.height:u,h=t.maxWidth,d=void 0===h?e.maxWidth:h,p=t.maxHeight,f=void 0===p?e.maxHeight:p,v=t.textAlign,g=void 0===v?e.textAlign:v,y=t.textBaseline,m=void 0===y?null!==(r=null!==(n=t.textBaseline)&&void 0!==n?n:e.textBaseline)&&void 0!==r?r:"top":y,_=t.editOptions;if(l>0&&c>0)i.set(0,0,l,c);else{var b=this.getFrameCache().getActualSize(),x=b.width,k=b.height,S=l||x||0,A=c||k||0;A="number"==typeof f&&A>f?f:A||0,S="number"==typeof d&&S>d?d:S||0,i.set(0,0,S,A)}_&&_.keepHeightWhileEmpty&&!i.height()&&!(null===(a=t.textConfig)||void 0===a?void 0:a.length)&&(i.y2=i.y1+(null!==(o=t.fontSize)&&void 0!==o?o:12),i.x2=i.x1+2);var M=0;switch(m){case"top":M=0;break;case"middle":M=-i.height()/2;break;case"bottom":M=-i.height()}var w=0;switch(g){case"left":w=0;break;case"center":w=-i.width()/2;break;case"right":w=-i.width()}return i.translate(w,M),nc.graphicService.updateTempAABBBounds(i),null==t.forceBoundsHeight&&null==t.forceBoundsWidth||nc.graphicService.updateHTMLTextAABBBounds(t,e,i),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,nc.graphicService.transformAABBBounds(t,i,e,!1,this),0===i.width()&&0===i.height()&&i.clear(),i}},{key:"needUpdateTags",value:function(t){return y(e,"needUpdateTags",this,3)([t,uy])}},{key:"needUpdateTag",value:function(t){return y(e,"needUpdateTag",this,3)([t,uy])}},{key:"getFrameCache",value:function(){return this.shouldUpdateShape()&&(this.doUpdateFrameCache(),this.clearUpdateShapeTag()),this._frameCache}},{key:"cliped",get:function(){var t=this.getFrameCache();if(t.actualHeight>t.height)return!0;if(this.attribute.disableAutoWrapLine)for(var e=0;e<t.lines.length;e++)for(var i=t.lines[e],n=0;n<i.paragraphs.length;n++){var r=i.paragraphs[n];if(r.overflow&&""!==r.text)return!0}return!1}},{key:"combinedStyleToCharacter",value:function(t){var e=this.attribute,i=e.fill,n=e.stroke,r=e.fontSize,a=e.fontFamily,o=e.fontStyle,s=e.fontWeight,l=e.lineWidth,u=e.opacity,c=e.fillOpacity,h=e.lineHeight,d=e.strokeOpacity,p=e.upgradeAttrs,f=Object.assign({fill:i,stroke:n,fontSize:r,fontFamily:a,fontStyle:o,fontWeight:s,lineWidth:l,opacity:u,fillOpacity:c,strokeOpacity:d},t);return(null==p?void 0:p.lineHeight)&&(f.lineHeight=h),f}},{key:"doUpdateFrameCache",value:function(t){var i,n=this,r=this.attribute,a=r.maxWidth,o=r.maxHeight,s=r.width,l=r.height,u=r.ellipsis,c=r.wordBreak,h=r.verticalDirection,d=r.textAlign,p=r.textBaseline,f=r.layoutDirection,v=r.singleLine,g=r.disableAutoWrapLine,y=r.editable,m=r.ascentDescentMode,_=r.upgradeAttrs,b=_&&_.multiBreakLine,x=this.attribute.textConfig,k=void 0===x?[]:x;y&&k.length>0&&!e.AllSingleCharacter(k)&&(k=e.TransformTextConfig2SingleCharacter(k),this.attribute.textConfig=k);for(var S=[],A=null!=t?t:k,M=0;M<A.length;M++)if("image"in A[M]){var w=this.combinedStyleToCharacter(A[M]);w.lineWidth=void 0;var T=w.id&&this._frameCache&&this._frameCache.icons&&this._frameCache.icons.get(w.id);if(T)S.push(T);else{var C=new ay(w);C.successCallback=function(){var t;n.addUpdateBoundTag(),null===(t=n.stage)||void 0===t||t.renderNextFrame()},C.richtextId=w.id,S.push(C)}}else{var E=this.combinedStyleToCharacter(A[M]);if(Z(E.text)&&(E.text="".concat(E.text)),E.text&&E.text.includes("\n"))for(var P=E.text.split("\n"),R=0;R<P.length;R++)if(0===R)S.push(new ey(P[R],!1,E,m));else if(P[R]||M===A.length-1)S.push(new ey(P[R],!0,E,m));else{var B=this.combinedStyleToCharacter(A[M+1]);S.push(new ey(P[R],!0,B,m))}else E.text&&S.push(new ey(E.text,!1,E,m))}var I="number"==typeof a&&Number.isFinite(a)&&a>0,L="number"==typeof o&&Number.isFinite(o)&&o>0,D="number"==typeof s&&Number.isFinite(s)&&s>0&&(!I||s<=a),O="number"==typeof l&&Number.isFinite(l)&&l>0&&(!L||l<=o),F=new $g(0,0,(D?s:I?a:0)||0,(O?l:L?o:0)||0,u,c,h,d,p,f||"horizontal",!D&&I,!O&&L,v||!1,null===(i=this._frameCache)||void 0===i?void 0:i.icons),z=new sy(F);if(z.newLine=b,g)for(var H=0,j=!1,N=0;N<S.length;N++){var V=S[N];j?(V.overflow=!0,V.left=1/0,V.top=1/0,!V.newLine&&F.lines[F.lines.length-1].paragraphs.push(V)):z.deal(V,!0),F.lines.length!==H&&(H=F.lines.length,z.lineBuffer.length=0,V.overflow=!0,V.left=1e3,V.top=1e3,F.lines[F.lines.length-1].paragraphs.push(V),j=!0),V.newLine&&(j=!1,z.lineWidth=0),z.send()}else for(var W=0;W<S.length;W++)z.deal(S[W]);if(z.send(),!("horizontal"===F.layoutDirection?D:O)){var G=F.getActualSizeWidthEllipsis(),U="horizontal"===F.layoutDirection?G.width:G.height;("horizontal"===F.layoutDirection?I:L)&&(U=Math.min(U,"horizontal"===F.layoutDirection?a:o)),F.lines.forEach((function(t){t.calcOffset(U,!1)}))}b&&F.lines.forEach((function(t){var e=t.paragraphs;t.paragraphs=t.paragraphs.filter((function(t){return""!==t.text})),0===t.paragraphs.length&&e.length&&(e[0].text="\n",t.paragraphs.push(e[0]))})),this._frameCache=F}},{key:"clone",value:function(){return new e(Object.assign({},this.attribute))}},{key:"setStage",value:function(t,i){y(e,"setStage",this,3)([t,i]),this.getFrameCache().icons.forEach((function(e){e.setStage(t,i)}))}},{key:"bindIconEvent",value:function(){var t=this;this.addEventListener("pointermove",(function(e){var i=t.pickIcon(e.global);i&&i===t._currentHoverIcon||(i?t.setAttribute("hoverIconId",i.richtextId):!i&&t._currentHoverIcon&&t.setAttribute("hoverIconId",void 0))})),this.addEventListener("pointerleave",(function(e){t._currentHoverIcon&&t.setAttribute("hoverIconId",void 0)}))}},{key:"updateHoverIconState",value:function(t){var e,i,n,r,a;t?(null===(e=this._currentHoverIcon)||void 0===e||e.setHoverState(!1),this._currentHoverIcon=t,this._currentHoverIcon.setHoverState(!0),null===(i=this.stage)||void 0===i||i.setCursor(t.attribute.cursor),null===(n=this.stage)||void 0===n||n.renderNextFrame()):(this._currentHoverIcon.setHoverState(!1),this._currentHoverIcon=null,null===(r=this.stage)||void 0===r||r.setCursor(),null===(a=this.stage)||void 0===a||a.renderNextFrame())}},{key:"pickIcon",value:function(t){var e,i=this.getFrameCache(),n=this.globalTransMatrix,r=n.e,a=n.f;return i.icons.forEach((function(i,n){var o,s,l=i.AABBBounds.clone();l.translate(i._marginArray[3],i._marginArray[0]),l.containsPoint({x:t.x-r,y:t.y-a})&&(e=i,e.globalX=(null!==(o=e.attribute.x)&&void 0!==o?o:0)+r+i._marginArray[3],e.globalY=(null!==(s=e.attribute.y)&&void 0!==s?s:0)+a+i._marginArray[0])})),e}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}}],[{key:"AllSingleCharacter",value:function(t){return t.lines?t.lines.every((function(t){return t.paragraphs.every((function(t){return!(t.text&&Y(t.text)&&e.splitText(t.text).length>1)}))})):t.every((function(t){return t.isComposing||!(t.text&&Y(t.text)&&e.splitText(t.text).length>1)}))}},{key:"splitText",value:function(t){if(ly){var e,i=[],n=s(new Intl.Segmenter(void 0,{granularity:"grapheme"}).segment(t));try{for(n.s();!(e=n.n()).done;){var r=e.value.segment;i.push(r)}}catch(t){n.e(t)}finally{n.f()}return i}return Array.from(t)}},{key:"TransformTextConfig2SingleCharacter",value:function(t){var i=[];return t.forEach((function(t){var n=e.splitText(t.text.toString());if(Y(t.text)&&n.length>1)for(var r=0;r<n.length;r++){var a=n[r];i.push(Object.assign(Object.assign({},t),{text:a}))}else i.push(t)})),i}}])}(Rv);function hy(t){return new cy(t)}cy.NOWORK_ANIMATE_ATTR=Object.assign({ellipsis:1,wordBreak:1,verticalDirection:1,textAlign:1,textBaseline:1,textConfig:1,layoutDirection:1},Pv);var dy=["path","customPath"].concat(m(Mv)),py=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[t])).type="path",i.numberType=cv,i}return h(e,t),o(e,[{key:"pathShape",get:function(){return this.tryUpdateAABBBounds(),this.getParsedPathShape()}},{key:"isValid",value:function(){return y(e,"isValid",this,3)([])&&this._isValid()}},{key:"_isValid",value:function(){var t=this.attribute.path;return null!=t&&""!==t}},{key:"getParsedPathShape",value:function(){var t=this.getGraphicTheme();if(!this.valid)return t.path;var e=this.attribute;return e.path instanceof Ru?e.path:(j(this.cache)&&this.doUpdatePathShape(),this.cache instanceof Ru?this.cache:t.path)}},{key:"getGraphicTheme",value:function(){return xh(this).path}},{key:"updateAABBBounds",value:function(t,e,i){if(!this.updatePathProxyAABBBounds(i)){var n=this.getParsedPathShape();i.union(n.getBounds())}var r=nc.graphicService.updateTempAABBBounds(i),a=r.tb1,o=r.tb2;Rg(t,e,a),i.union(a),a.setValue(o.x1,o.y1,o.x2,o.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1;var s=t.lineJoin,l=void 0===s?e.lineJoin:s;return nc.graphicService.transformAABBBounds(t,i,e,"miter"===l,this),i}},{key:"doUpdateAABBBounds",value:function(t){return this.doUpdatePathShape(),y(e,"doUpdateAABBBounds",this,3)([t])}},{key:"doUpdatePathShape",value:function(){var t=this.attribute;Y(t.path,!0)?this.cache=(new Ru).fromString(t.path):t.customPath&&(this.cache=new Ru,t.customPath(this.cache,this))}},{key:"needUpdateTags",value:function(t){return y(e,"needUpdateTags",this,3)([t,dy])}},{key:"needUpdateTag",value:function(t){return y(e,"needUpdateTag",this,3)([t,dy])}},{key:"toCustomPath",value:function(){return(new Ru).fromCustomPath2D(this.getParsedPathShape(),0,0)}},{key:"clone",value:function(){return new e(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}}])}(Rv);function fy(t){return new py(t)}py.NOWORK_ANIMATE_ATTR=Object.assign({path:1,customPath:1},Pv);var vy=["segments","points","curveType","curveTension"].concat(m(Mv)),gy=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[t])).type="area",i.numberType=rv,i}return h(e,t),o(e,[{key:"isValid",value:function(){return y(e,"isValid",this,3)([])&&this._isValid()}},{key:"_isValid",value:function(){if(this.pathProxy)return!0;var t=this.attribute,e=t.points,i=t.segments;return i?0!==i.length:!!e&&0!==e.length}},{key:"getGraphicTheme",value:function(){return xh(this).area}},{key:"updateAABBBounds",value:function(t,e,i){this.updatePathProxyAABBBounds(i)||(t.segments?this.updateAreaAABBBoundsBySegments(t,e,i):this.updateAreaAABBBoundsByPoints(t,e,i)),nc.graphicService.updateTempAABBBounds(i),this.setWidthHeightWithoutTransform(i);var n=t.lineJoin,r=void 0===n?e.lineJoin:n;return nc.graphicService.transformAABBBounds(t,i,e,"miter"===r,this),i}},{key:"updateAreaAABBBoundsByPoints",value:function(t,e,i,n){var r=t.points,a=void 0===r?e.points:r,o=i;return a.forEach((function(t){var e,i;o.add(t.x,t.y),o.add(null!==(e=t.x1)&&void 0!==e?e:t.x,null!==(i=t.y1)&&void 0!==i?i:t.y)})),o}},{key:"updateAreaAABBBoundsBySegments",value:function(t,e,i,n){var r=t.segments,a=void 0===r?e.segments:r,o=i;return a.forEach((function(t){t.points.forEach((function(t){var e,i;o.add(t.x,t.y),o.add(null!==(e=t.x1)&&void 0!==e?e:t.x,null!==(i=t.y1)&&void 0!==i?i:t.y)}))})),o}},{key:"_interpolate",value:function(t,e,i,n,r){"points"===t&&(r.points=ud(i,n,e))}},{key:"needUpdateTags",value:function(t){return y(e,"needUpdateTags",this,3)([t,vy])}},{key:"needUpdateTag",value:function(t){return y(e,"needUpdateTag",this,3)([t,vy])}},{key:"toCustomPath",value:function(){var t=new Ru,e=this.attribute,i=e.segments,n=function(e){if(e&&e.length){var i=!0,n=[];if(e.forEach((function(e){var r,a;!1!==e.defined&&(i?t.moveTo(e.x,e.y):t.lineTo(e.x,e.y),n.push({x:null!==(r=e.x1)&&void 0!==r?r:e.x,y:null!==(a=e.y1)&&void 0!==a?a:e.y}),i=!1)})),n.length){for(var r=n.length-1;r>=0;r--)t.lineTo(n[r].x,n[r].y);t.closePath()}}};return e.points?n(e.points):i&&i.length&&i.forEach((function(t){n(t.points)})),t}},{key:"clone",value:function(){return new e(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}}])}(Rv);function yy(t){return new gy(t)}gy.NOWORK_ANIMATE_ATTR=Object.assign({segments:1,curveType:1},Pv);var my=["innerRadius","outerRadius","startAngle","endAngle","cornerRadius","padAngle","padRadius","cap"].concat(m(Mv)),_y=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[t])).type="arc",i.numberType=iv,i}return h(e,t),o(e,[{key:"isValid",value:function(){return y(e,"isValid",this,3)([])&&this._isValid()}},{key:"_isValid",value:function(){var t=this.attribute,e=t.startAngle,i=t.endAngle,n=t.outerRadius,r=t.innerRadius;return this._validNumber(e)&&this._validNumber(i)&&this._validNumber(n)&&this._validNumber(r)}},{key:"getParsedCornerRadius",value:function(){var t=this.getGraphicTheme(),e=this.attribute,i=e.cornerRadius,n=void 0===i?t.cornerRadius:i,r=e.innerPadding,a=void 0===r?t.innerPadding:r,o=e.outerPadding,s=void 0===o?t.outerPadding:o,l=this.attribute,u=l.outerRadius,c=void 0===u?t.outerRadius:u,h=l.innerRadius,d=void 0===h?t.innerRadius:h;if(c+=s,d-=a,0===n||"0%"===n)return 0;var p=Math.abs(c-d),f=function(t){return Math.min(Z(t,!0)?t:p*parseFloat(t)/100,p/2)};if(X(n)){var v=n.map((function(t){return f(t)||0}));return 0===v.length?[v[0],v[0],v[0],v[0]]:2===v.length?[v[0],v[1],v[0],v[1]]:(3===v.length&&v.push(0),v)}return f(n)}},{key:"getParsedAngle",value:function(){var t=this.getGraphicTheme(),e=this.attribute,i=e.startAngle,n=void 0===i?t.startAngle:i,r=e.endAngle,a=void 0===r?t.endAngle:r,o=this.attribute.cap,s=void 0===o?t.cap:o,l=a-n>=0?1:-1,u=a-n;if(a=(n=Ee(n))+u,s&&le(u)<se-ne){var c=1,h=1;s.length&&(c=Number(s[0]),h=Number(s[1]));var d=this.attribute,p=d.outerRadius,f=void 0===p?t.outerRadius:p,v=d.innerRadius,g=void 0===v?t.innerRadius:v,y=this.attribute,m=y.outerPadding,_=void 0===m?t.outerPadding:m,b=y.innerPadding;f+=_,g-=void 0===b?t.innerPadding:b;var x=Math.abs(f-g)/2,k=x/f;if(x>ne&&f>ne)return{startAngle:n-l*k*c,endAngle:a+l*k*h,sc:l*k*c,ec:l*k*h}}return{startAngle:n,endAngle:a}}},{key:"getParsePadAngle",value:function(t,e){var i=this.getGraphicTheme(),n=this.attribute,r=n.innerPadding,a=void 0===r?i.innerPadding:r,o=n.outerPadding,s=void 0===o?i.outerPadding:o,l=n.padAngle,u=void 0===l?i.padAngle:l,c=this.attribute,h=c.outerRadius,d=void 0===h?i.outerRadius:h,p=c.innerRadius,f=void 0===p?i.innerRadius:p;d+=s,f-=a;var v=this.attribute.padRadius,g=void 0===v?fe(d*d+f*f):v,y=le(e-t),m=t,_=e,b=t,x=e,k=u/2,S=y,A=y;if(k>ne&&g>ne){var M=e>t?1:-1,w=ge(Number(g)/f*pe(k)),T=ge(Number(g)/d*pe(k));return(S-=2*w)>ne?(b+=w*=M,x-=w):(S=0,b=x=(t+e)/2),(A-=2*T)>ne?(m+=T*=M,_-=T):(A=0,m=_=(t+e)/2),{outerStartAngle:m,outerEndAngle:_,innerStartAngle:b,innerEndAngle:x,innerDeltaAngle:S,outerDeltaAngle:A}}return{outerStartAngle:m,outerEndAngle:_,innerStartAngle:b,innerEndAngle:x,innerDeltaAngle:S,outerDeltaAngle:A}}},{key:"getGraphicTheme",value:function(){return xh(this).arc}},{key:"updateAABBBounds",value:function(t,e,i,n){this.updatePathProxyAABBBounds(i)||(n?this.updateArcAABBBoundsImprecise(t,e,i):this.updateArcAABBBoundsAccurate(t,e,i));var r=nc.graphicService.updateTempAABBBounds(i),a=r.tb1,o=r.tb2;Rg(t,e,a),i.union(a),a.setValue(o.x1,o.y1,o.x2,o.y2),this.setWidthHeightWithoutTransform(i);var s=t.lineJoin,l=void 0===s?e.lineJoin:s;return nc.graphicService.transformAABBBounds(t,i,e,"miter"===l,this),i}},{key:"updateArcAABBBoundsImprecise",value:function(t,e,i){var n=t.outerRadius,r=void 0===n?e.outerRadius:n,a=t.innerRadius,o=void 0===a?e.innerRadius:a,s=t.outerPadding,l=void 0===s?e.outerPadding:s,u=t.innerPadding;return(r+=l)<(o-=void 0===u?e.innerPadding:u)&&(r=o),i.set(-r,-r,r,r),i}},{key:"updateArcAABBBoundsAccurate",value:function(t,e,i){var n=t.outerRadius,r=void 0===n?e.outerRadius:n,a=t.innerRadius,o=void 0===a?e.innerRadius:a,s=t.outerPadding,l=void 0===s?e.outerPadding:s,u=t.innerPadding;if((r+=l)<(o-=void 0===u?e.innerPadding:u)){var c=r;r=o,o=c}var h=t.endAngle,d=void 0===h?e.endAngle:h,p=t.startAngle,f=void 0===p?e.startAngle:p;if(f>d){var v=f;f=d,d=v}return r<=ne?i.set(0,0,0,0):Math.abs(d-f)>se-ne?i.set(-r,-r,r,r):(sd(f,d,r,i),sd(f,d,o,i)),i}},{key:"needUpdateTags",value:function(t){return y(e,"needUpdateTags",this,3)([t,my])}},{key:"needUpdateTag",value:function(t){return y(e,"needUpdateTag",this,3)([t,my])}},{key:"toCustomPath",value:function(){var t,e,i,n,r=this.attribute,a=this.getParsedAngle(),o=a.startAngle,s=a.endAngle,l=(null!==(t=r.innerRadius)&&void 0!==t?t:0)-(null!==(e=r.innerPadding)&&void 0!==e?e:0),u=(null!==(i=r.outerRadius)&&void 0!==i?i:0)-(null!==(n=r.outerPadding)&&void 0!==n?n:0),c=le(s-o),h=s>o;if(u<l){var d=u;u=l,l=d}var p=new Ru;if(u<=ne)p.moveTo(0,0);else if(c>=se-ne)p.moveTo(0+u*ce(o),0+u*pe(o)),p.arc(0,0,u,o,s,!h),l>ne&&(p.moveTo(0+l*ce(s),0+l*pe(s)),p.arc(0,0,l,s,o,h));else{var f=u*ce(o),v=u*pe(o),g=l*ce(s),y=l*pe(s);p.moveTo(0+f,0+v),p.arc(0,0,u,o,s,!h),p.lineTo(0+g,0+y),p.arc(0,0,l,s,o,h),p.closePath()}return p}},{key:"clone",value:function(){return new e(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}}])}(Rv);function by(t){return new _y(t)}_y.NOWORK_ANIMATE_ATTR=Object.assign({cap:1},Pv);var xy=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[t])).type="arc3d",i.numberType=nv,i}return h(e,t),o(e,[{key:"updateAABBBounds",value:function(t,e,i){var n=this.stage;if(!n||!n.camera)return i;var r=t.outerRadius,a=void 0===r?e.outerRadius:r,o=t.height,s=a+(void 0===o?0:o);return i.setValue(-s,-s,s,s),nc.graphicService.updateTempAABBBounds(i),nc.graphicService.transformAABBBounds(t,i,e,!1,this),i}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}}])}(_y);function ky(t){return new xy(t)}xy.NOWORK_ANIMATE_ATTR=Object.assign({cap:1},Pv);var Sy=["points","cornerRadius"].concat(m(Mv)),Ay=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[t])).type="polygon",i.numberType=hv,i}return h(e,t),o(e,[{key:"isValid",value:function(){return y(e,"isValid",this,3)([])&&this._isValid()}},{key:"_isValid",value:function(){var t=this.attribute.points;return t&&t.length>=2}},{key:"getGraphicTheme",value:function(){return xh(this).polygon}},{key:"updateAABBBounds",value:function(t,e,i){this.updatePathProxyAABBBounds(i)||this.updatePolygonAABBBoundsImprecise(t,e,i),nc.graphicService.updateTempAABBBounds(i),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1;var n=t.lineJoin,r=void 0===n?e.lineJoin:n;return nc.graphicService.transformAABBBounds(t,i,e,"miter"===r,this),i}},{key:"updatePolygonAABBBoundsImprecise",value:function(t,e,i){var n=t.points;return(void 0===n?e.points:n).forEach((function(t){i.add(t.x,t.y)})),i}},{key:"_interpolate",value:function(t,e,i,n,r){"points"===t&&(r.points=ud(i,n,e))}},{key:"needUpdateTags",value:function(t){return y(e,"needUpdateTags",this,3)([t,Sy])}},{key:"needUpdateTag",value:function(t){return y(e,"needUpdateTag",this,3)([t,Sy])}},{key:"toCustomPath",value:function(){var t=this.attribute.points,e=new Ru;return t.forEach((function(t,i){0===i?e.moveTo(t.x,t.y):e.lineTo(t.x,t.y)})),e.closePath(),e}},{key:"clone",value:function(){return new e(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}}])}(Rv);function My(t){return new Ay(t)}Ay.NOWORK_ANIMATE_ATTR=Pv;var wy=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[t])).type="pyramid3d",i.numberType=dv,i}return h(e,t),o(e,[{key:"updateAABBBounds",value:function(t,e,i){var n=this.stage;return n&&n.camera?(this.findFace().vertices.forEach((function(t){var e=t[0],n=t[1];i.add(e,n)})),nc.graphicService.updateTempAABBBounds(i),nc.graphicService.transformAABBBounds(t,i,e,!1,this),i):i}},{key:"findFace",value:function(){for(var t=this.attribute.points,e=t.map((function(e,i){var n=3===i?t[0]:t[i+1],r=e.x-n.x;return 0===r?0:(e.y-n.y)/r})),i=t.map((function(t){return{p:t,d:0}})),n=!1,r=0,a=0;a<e.length-1;a++){for(var o=a+1;o<e.length;o++){if(e[a]===e[o]){n=!0;var s=Me.distancePP(i[a].p,i[a+1].p);i[a].d=s,i[a+1].d=s,r=he(r,s);var l=Me.distancePP(i[o].p,i[o+1].p);i[o].d=l,i[o+1].d=l,r=he(r,l)}if(n)break}if(n)break}for(var u=t.length-1;u>=0;u--){var c=t[u];i.unshift({p:c,d:0})}for(var h=0;h<t.length;h++){var d=(r-i[h+t.length].d)/2;i[h].d+=d,i[h+t.length].d+=d}var p={polygons:[],vertices:[],edges:[]};return i.forEach((function(t){p.vertices.push([t.p.x,t.p.y,t.d])})),p.polygons.push({polygon:[0,4,5,1],normal:[0,-1,0]}),p.polygons.push({polygon:[7,6,2,3],normal:[0,1,0]}),p.polygons.push({polygon:[0,4,7,3],normal:[-1,0,0]}),p.polygons.push({polygon:[1,5,6,2],normal:[1,0,0]}),p.polygons.push({polygon:[0,1,2,3],normal:[0,0,-1]}),p.polygons.push({polygon:[4,5,6,7],normal:[0,0,1]}),p.edges=[[0,1],[1,2],[2,3],[3,0],[4,5],[5,6],[6,7],[7,4],[0,4],[3,7],[1,5],[2,6]],p}},{key:"_isValid",value:function(){return y(e,"_isValid",this,3)([])&&4===this.attribute.points.length}},{key:"getNoWorkAnimateAttr",value:function(){return e.NOWORK_ANIMATE_ATTR}}])}(Ay);function Ty(t){return new wy(t)}wy.NOWORK_ANIMATE_ATTR=Pv;var Cy=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[{x:0,y:0}])).type="shadowroot",i.shadowHost=t,i}return h(e,t),o(e,[{key:"clearUpdateBoundTag",value:function(){y(e,"clearUpdateBoundTag",this,3)([]),this.shadowHost&&this.shadowHost.clearUpdateBoundTag()}},{key:"addUpdateBoundTag",value:function(){y(e,"addUpdateBoundTag",this,3)([]),this.shadowHost&&this.shadowHost.addUpdateBoundTag()}},{key:"addUpdateShapeAndBoundsTag",value:function(){y(e,"addUpdateShapeAndBoundsTag",this,3)([]),this.shadowHost&&this.shadowHost.addUpdateBoundTag()}},{key:"tryUpdateGlobalTransMatrix",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.shouldUpdateGlobalMatrix()){var e=this.transMatrix;this._globalTransMatrix?this._globalTransMatrix.setValue(e.a,e.b,e.c,e.d,e.e,e.f):this._globalTransMatrix=e.clone(),this.doUpdateGlobalMatrix(),t&&this.clearUpdateGlobalPositionTag()}return this._globalTransMatrix}},{key:"doUpdateGlobalMatrix",value:function(){if(this.shadowHost){var t=this.shadowHost.globalTransMatrix;this._globalTransMatrix.multiply(t.a,t.b,t.c,t.d,t.e,t.f)}}},{key:"tryUpdateGlobalAABBBounds",value:function(){return this._globalAABBBounds?this._globalAABBBounds.setValue(this._AABBBounds.x1,this._AABBBounds.y1,this._AABBBounds.x2,this._AABBBounds.y2):this._globalAABBBounds=this._AABBBounds.clone(),this.shadowHost&&this._globalAABBBounds.transformWithMatrix(this.shadowHost.globalTransMatrix),this._globalAABBBounds}}])}(Bv);function Ey(t){return new Cy(t)}var Py,Ry,By=new(function(){return o((function t(){r(this,t),this.store=new Map}),[{key:"RegisterGraphicCreator",value:function(t,e){this.store.set(t,e),this[t]=e}},{key:"CreateGraphic",value:function(t,e){var i=this.store.get(t);return i?i(e):null}}])}());function Iy(t){return Py||(Py=By.CreateGraphic("text",{})),Py.initAttributes(t),Py.AABBBounds}var Ly=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Dy=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Oy=function(t,e){return function(i,n){e(i,n,t)}},Fy=function(){return o((function t(){r(this,t),this.time=Pl.beforeFillStroke,this.useStyle=!0,this.order=0}),[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d){var p,f=t.attribute,v=f.background,g=f.backgroundOpacity,y=void 0===g?null!==(p=t.attribute.fillOpacity)&&void 0!==p?p:l.backgroundOpacity:g,m=f.opacity,_=void 0===m?l.opacity:m,b=f.backgroundMode,x=void 0===b?l.backgroundMode:b,k=f.backgroundFit,S=void 0===k?l.backgroundFit:k,A=f.backgroundKeepAspectRatio,M=void 0===A?l.backgroundKeepAspectRatio:A,w=f.backgroundScale,T=void 0===w?l.backgroundScale:w,C=f.backgroundOffsetX,E=void 0===C?l.backgroundOffsetX:C,P=f.backgroundOffsetY,R=void 0===P?l.backgroundOffsetY:P,B=f.backgroundClip,I=void 0===B?l.backgroundClip:B;if(v)if(t.backgroundImg&&t.resources){var L=t.resources.get(v);if("success"!==L.state||!L.data)return;if(e.save(),t.parent&&!t.transMatrix.onlyTranslate()){var D=xh(t.parent).group,O=t.parent.attribute,F=O.scrollX,z=void 0===F?D.scrollX:F,H=O.scrollY,j=void 0===H?D.scrollY:H;e.setTransformFromMatrix(t.parent.globalTransMatrix,!0),e.translate(z,j)}I&&e.clip();var N=t.AABBBounds;e.setCommonStyle(t,t.attribute,i,n,l),e.globalAlpha=y*_,this.doDrawImage(e,L.data,N,{backgroundMode:x,backgroundFit:S,backgroundKeepAspectRatio:M,backgroundScale:T,backgroundOffsetX:E,backgroundOffsetY:R}),e.restore(),t.transMatrix.onlyTranslate()||e.setTransformForCurrent()}else e.highPerformanceSave(),e.setCommonStyle(t,t.attribute,i,n,l),e.globalAlpha=y*_,e.fillStyle=v,e.fill(),e.highPerformanceRestore()}},{key:"doDrawImage",value:function(t,e,i,n){var r=n.backgroundMode,a=n.backgroundFit,o=n.backgroundKeepAspectRatio,s=n.backgroundScale,l=void 0===s?1:s,u=n.backgroundOffsetX,c=void 0===u?0:u,h=n.backgroundOffsetY,d=void 0===h?0:h,p=i.width(),f=i.height(),v=p,g=f;if("no-repeat"===r)if(a)if(o){var y=Math.max(p/e.width,f/e.height);t.drawImage(e,i.x1+c,i.y1+d,e.width*y*l,e.height*y*l)}else t.drawImage(e,i.x1,i.y1,i.width(),i.height());else{var m=e.width*l,_=e.height*l;t.drawImage(e,i.x1+c,i.y1+d,m,_)}else{if(a&&"repeat"!==r&&(e.width||e.height)){var b=e.width,x=e.height;"repeat-x"===r?(v=b*(f/x),g=f):"repeat-y"===r&&(g=x*(p/b),v=p);var k=t.dpr,S=ih.allocate({width:v,height:g,dpr:k}),A=S.getContext("2d");A&&(A.inuse=!0,A.clearMatrix(),A.setTransformForCurrent(!0),A.clearRect(0,0,v,g),A.drawImage(e,0,0,v,g),e=S.nativeCanvas),ih.free(S)}var M=t.dpr,w=t.createPattern(e,r);w.setTransform&&w.setTransform(new DOMMatrix([1/M,0,0,1/M,0,0])),t.fillStyle=w,t.translate(i.x1,i.y1),t.fillRect(0,0,p,f),t.translate(-i.x1,-i.y1)}}}])}(),zy=new Fy,Hy=function(){return o((function t(e){r(this,t),this.subRenderContribitions=e,this.time=Pl.afterFillStroke,this.useStyle=!0,this.order=0}),[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d){this._subRenderContribitions||(this._subRenderContribitions=this.subRenderContribitions.getContributions()),this._subRenderContribitions.forEach((function(p){p.render(t,e,i,n,r,a,o,s,l,u,c,h,d)}))}}])}();Hy=Ly([js(),Oy(0,zs(nl)),Oy(0,Ns(fg)),Dy("design:paramtypes",[Object])],Hy);var jy=function(){return o((function t(){r(this,t),this.time=Pl.beforeFillStroke,this.useStyle=!0,this.order=0}),[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d){var p,f;if(t.attribute.clipConfig){var v=t.getClipPath();if(v){var g=!(c||h),y=t.AABBBounds,m=null!==(p=t.attribute.width)&&void 0!==p?p:y.width(),_=null!==(f=t.attribute.height)&&void 0!==f?f:y.height();g&&e.save(),e.beginPath(),!1===v.draw(e,[m,_],i+m/2,n+_/2,0)&&e.closePath(),c&&c(e,t.attribute,l,!0),g&&e.clip()}}}}])}(),Ny=new jy,Vy=new(function(){return o((function t(){r(this,t),this.time=Pl.afterFillStroke,this.useStyle=!0,this.order=0}),[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d){t.attribute.clipConfig&&t.getClipPath()&&(c||h||e.restore())}}])}());var Wy=function(){return o((function t(){r(this,t),this.time=Pl.afterFillStroke,this.useStyle=!0,this.order=10,this._tempSymbolGraphic=null}),[{key:"createCommonPattern",value:function(t,e,i,n,r){var a=(t-2*e)/2,o=n.dpr,s=ih.allocate({width:t,height:t,dpr:o}),l=s.getContext("2d");if(!l)return null;l.inuse=!0,l.clearMatrix(),l.setTransformForCurrent(!0),l.clearRect(0,0,t,t),r(a,l);var u=n.createPattern(s.nativeCanvas,"repeat");return u.setTransform&&u.setTransform(new DOMMatrix([1/o,0,0,1/o,0,0])),ih.free(s),u}},{key:"createCirclePattern",value:function(t,e,i,n){return this.createCommonPattern(t,e,i,n,(function(t,e){e.fillStyle=i,e.arc(t,t,t,0,se),e.fill()}))}},{key:"createDiamondPattern",value:function(t,e,i,n){return this.createCommonPattern(t,e,i,n,(function(e,n){var r=t/2,a=r;n.fillStyle=i,n.moveTo(r,a-e),n.lineTo(e+r,a),n.lineTo(r,a+e),n.lineTo(r-e,a),n.closePath(),n.fill()}))}},{key:"createRectPattern",value:function(t,e,i,n){return this.createCommonPattern(t,e,i,n,(function(t,n){var r=e,a=r;n.fillStyle=i,n.fillRect(r,a,2*t,2*t)}))}},{key:"createVerticalLinePattern",value:function(t,e,i,n){return this.createCommonPattern(t,e,i,n,(function(n,r){var a=e;r.fillStyle=i,r.fillRect(a,0,2*n,t)}))}},{key:"createHorizontalLinePattern",value:function(t,e,i,n){return this.createCommonPattern(t,e,i,n,(function(n,r){var a=e;r.fillStyle=i,r.fillRect(0,a,t,2*n)}))}},{key:"createBiasLRLinePattern",value:function(t,e,i,n){return this.createCommonPattern(t,e,i,n,(function(e,n){n.strokeStyle=i,n.lineWidth=e,n.moveTo(0,0),n.lineTo(t,t);var r=t/2,a=-r;n.moveTo(r,a),n.lineTo(r+t,a+t),n.moveTo(-r,-a),n.lineTo(-r+t,-a+t),n.stroke()}))}},{key:"createBiasRLLinePattern",value:function(t,e,i,n){return this.createCommonPattern(t,e,i,n,(function(e,n){n.strokeStyle=i,n.lineWidth=e,n.moveTo(t,0),n.lineTo(0,t);var r=t/2,a=r;n.moveTo(t+r,a),n.lineTo(r,a+t),n.moveTo(t-r,-a),n.lineTo(-r,-a+t),n.stroke()}))}},{key:"createGridPattern",value:function(t,e,i,n){return this.createCommonPattern(t,e,i,n,(function(t,n){var r=e,a=r;n.fillStyle=i,n.fillRect(r,a,t,t),n.fillRect(r+t,a+t,t,t)}))}},{key:"initTextureMap",value:function(t,e){this.textureMap=new Map}},{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d){this.textureMap||this.initTextureMap(e,t.stage);var p=t.attribute,f=p.texture,v=void 0===f?l.texture:f,g=p.textureColor,y=void 0===g?l.textureColor:g,m=p.textureSize,_=void 0===m?l.textureSize:m,b=p.texturePadding,x=void 0===b?l.texturePadding:b;v&&this.drawTexture(v,t,e,i,n,l,y,_,x)}},{key:"drawTexture",value:function(t,e,i,n,r,a,o,s,l){var u,c=e.attribute,h=c.textureRatio,d=void 0===h?a.textureRatio:h,p=c.textureOptions,f=void 0===p?null:p,v=this.textureMap.get(t);if(!v)switch(t){case"circle":v=this.createCirclePattern(s,l,o,i);break;case"diamond":v=this.createDiamondPattern(s,l,o,i);break;case"rect":v=this.createRectPattern(s,l,o,i);break;case"vertical-line":v=this.createVerticalLinePattern(s,l,o,i);break;case"horizontal-line":v=this.createHorizontalLinePattern(s,l,o,i);break;case"bias-lr":v=this.createBiasLRLinePattern(s,l,o,i);break;case"bias-rl":v=this.createBiasRLLinePattern(s,l,o,i);break;case"grid":v=this.createGridPattern(s,l,o,i)}if(f&&f.dynamicTexture){var g=f.gridConfig,y=void 0===g?{}:g,m=f.useNewCanvas,_=e.AABBBounds;n=_.x1,r=_.y1;var b,x=i;if(m){var k=(b=ih.allocate({width:_.width(),height:_.height(),dpr:i.dpr})).getContext("2d");k.clearRect(0,0,_.width(),_.height()),n=0,r=0,i=k}if(x.save(),e.parent&&!e.transMatrix.onlyTranslate()){var S=e.parent.attribute,A=S.scrollX,M=void 0===A?0:A,w=S.scrollY,T=void 0===w?0:w;x.setTransformFromMatrix(e.parent.globalTransMatrix),x.translate(M,T,!0)}x.setCommonStyle(e,e.attribute,n,r,a),x.clip();var C=_.width(),E=_.height(),P=l,R=s,B=y.columns?y.columns:Math.ceil(C/R),I=y.rows?y.rows:Math.ceil(E/R),L=y.gutterColumn?y.gutterColumn:2*P,D=y.gutterRow?y.gutterRow:2*P;this._tempSymbolGraphic||(this._tempSymbolGraphic=Ng({}));var O=y.columns?C/y.columns:R,F=y.rows?E/y.rows:R;this._tempSymbolGraphic.setAttributes({size:[O-L,F-D],symbolType:t});for(var z=this._tempSymbolGraphic.getParsedPath(),H=0;H<I;H++)for(var j=0;j<B;j++){var N=n+R/2+j*R,V=r+R/2+H*R;null===(u=f.beforeDynamicTexture)||void 0===u||u.call(f,i,H,j,I,B,d,e,_.width(),_.height()),i.beginPath(),!1===z.draw(i,Math.min(O-L,F-D),N,V,0)&&i.closePath(),i.fillStyle=o,f.dynamicTexture(i,H,j,I,B,d,e,_.width(),_.height())}m&&(x.globalAlpha=1,x.drawImage(b.nativeCanvas,0,0,b.nativeCanvas.width,b.nativeCanvas.height,_.x1,_.y1,_.width()*x.dpr,_.height()*x.dpr)),x.restore()}else if(v)i.highPerformanceSave(),i.setCommonStyle(e,e.attribute,n,r,a),i.fillStyle=v,i.fill(),i.highPerformanceRestore();else if("wave"===t){i.save(),i.setCommonStyle(e,e.attribute,n,r,a),i.clip();var W=e.AABBBounds;(function(t,e,i,n,r,a,o){var s=r.fill,l=void 0===s?"orange":s,u=r.percent,c=void 0===u?.6:u,h=r.frequency,d=void 0===h?4:h,p=r.opacity,f=r.phi,v=void 0===f?0:f,g=r.amplitude,y=void 0===g?10:g;y*=function(t){return t<=.5?4*t-1:-4*t+3}(e);var m=n*(1-c),_=i,b=Math.max(Math.round(_/70),2);t.beginPath(),t.moveTo(0+a,n+o),t.lineTo(0+a,m+o);for(var x=_/d*e,k=_/Math.PI/(2*d),S=0;S<_;S+=b){var A=y*Math.sin((S+x+v)/k+v);t.lineTo(S+a,m+A+o)}t.lineTo(_+a,n+o),t.closePath(),t.fillStyle=l,isFinite(p)&&(t.globalAlpha=p),t.fill()})(i,d,W.width(),W.height(),Object.assign(Object.assign({},f||{}),{fill:o}),n+W.x1-n,r+W.y1-r),i.restore()}}}])}(),Gy=new Wy,Uy=function(){return o((function t(){r(this,t),this.time=Pl.afterFillStroke,this.useStyle=!0,this.order=0}),[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h){var d=t.attribute,p=d.outerBorder,f=d.innerBorder,v=p&&!1!==p.visible,g=f&&!1!==f.visible;if(v||g){var y=t.attribute,m=y.innerPadding,_=void 0===m?l.innerPadding:m,b=y.outerPadding,x=void 0===b?l.outerPadding:b,k=y.startAngle,S=void 0===k?l.startAngle:k,A=y.endAngle,M=void 0===A?l.endAngle:A,w=y.opacity,T=void 0===w?l.opacity:w,C=y.x,E=void 0===C?l.x:C,P=y.y,R=void 0===P?l.y:P,B=y.scaleX,I=void 0===B?l.scaleX:B,L=y.scaleY,D=void 0===L?l.scaleY:L,O=y.keepStrokeScale,F=void 0===O?l.keepStrokeScale:O,z=t.attribute,H=z.innerRadius,j=void 0===H?l.innerRadius:H,N=z.outerRadius,V=void 0===N?l.outerRadius:N;V+=x,j-=_;var W=function(r,a){var o=!(!r||!r.stroke),s=r.distance,u=void 0===s?l[a].distance:s,c=F?u:oc(e,u,e.dpr),d=u/V,p="outerBorder"===a?1:-1;if(t.setAttributes({outerRadius:V+p*c,innerRadius:j-p*c,startAngle:S-p*d,endAngle:M+p*d}),e.beginPath(),tg(t,e,i,n,V+p*c,j-p*c),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),h)h(e,r,l[a]);else if(o){var f=l[a].opacity;l[a].opacity=T,e.setStrokeStyle(t,r,(E-i)/I,(R-n)/D,l[a]),l[a].opacity=f,e.stroke()}};v&&W(p,"outerBorder"),g&&W(f,"innerBorder"),t.setAttributes({outerRadius:V,innerRadius:j,startAngle:S,endAngle:M})}}}])}(),Yy=new Uy,Xy=Gy,Ky=zy,qy=function(){return o((function t(){r(this,t),this.time=Pl.afterFillStroke,this.useStyle=!0,this.order=0}),[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h){var d=t.attribute,p=d.outerBorder,f=d.innerBorder,v=p&&!1!==p.visible,g=f&&!1!==f.visible;if(v||g){var y=t.attribute,m=y.radius,_=void 0===m?l.radius:m,b=y.startAngle,x=void 0===b?l.startAngle:b,k=y.endAngle,S=void 0===k?l.endAngle:k,A=y.opacity,M=void 0===A?l.opacity:A,w=y.x,T=void 0===w?l.x:w,C=y.y,E=void 0===C?l.y:C,P=y.scaleX,R=void 0===P?l.scaleX:P,B=y.scaleY,I=void 0===B?l.scaleY:B,L=y.keepStrokeScale,D=void 0===L?l.keepStrokeScale:L,O=function(r,a){var o=!(!r||!r.stroke),s=r.distance,u=void 0===s?l[a].distance:s,c=D?u:oc(e,u,e.dpr),d="outerBorder"===a?1:-1;if(e.beginPath(),e.arc(i,n,_+d*c,x,S),e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),h)h(e,r,l[a]);else if(o){var p=l[a].opacity;l[a].opacity=M,e.setStrokeStyle(t,r,(T-i)/R,(E-n)/I,l[a]),l[a].opacity=p,e.stroke()}};v&&O(p,"outerBorder"),g&&O(f,"innerBorder")}}}])}(),Zy=new qy,Jy=Gy,Qy=zy,$y=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).time=Pl.beforeFillStroke,t}return h(e,t),o(e,[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h){var d=t.attribute,p=d.background,f=d.backgroundMode,v=void 0===f?l.backgroundMode:f,g=d.backgroundFit,y=void 0===g?l.backgroundFit:g,m=d.backgroundKeepAspectRatio,_=void 0===m?l.backgroundKeepAspectRatio:m,b=d.backgroundScale,x=void 0===b?l.backgroundScale:b,k=d.backgroundOffsetX,S=void 0===k?l.backgroundOffsetX:k,A=d.backgroundOffsetY,M=void 0===A?l.backgroundOffsetY:A;if(p)if(t.backgroundImg&&t.resources){var w=t.resources.get(p);if("success"!==w.state||!w.data)return;e.highPerformanceSave(),e.setTransformFromMatrix(t.parent.globalTransMatrix,!0);var T=t.AABBBounds;this.doDrawImage(e,w.data,T,{backgroundMode:v,backgroundFit:y,backgroundKeepAspectRatio:_,backgroundScale:x,backgroundOffsetX:S,backgroundOffsetY:M}),e.highPerformanceRestore(),e.setTransformForCurrent()}else e.highPerformanceSave(),e.fillStyle=p,e.fill(),e.highPerformanceRestore()}}])}(Fy),tm=new $y,em=re/2;function im(t,e,i,n,r,a){var o,s=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],l=arguments.length>7?arguments[7]:void 0;if(Array.isArray(s)&&(l=s,s=!0),n<0&&(e+=n,n=-n),r<0&&(i+=r,r=-r),Z(a,!0))o=[a=le(a),a,a,a];else if(Array.isArray(a)){var u,c,h=a;switch(h.length){case 0:o=[0,0,0,0];break;case 1:o=[u=le(h[0]),u,u,u];break;case 2:case 3:o=[u=le(h[0]),c=le(h[1]),u,c];break;default:(o=h)[0]=le(o[0]),o[1]=le(o[1]),o[2]=le(o[2]),o[3]=le(o[3])}}else o=[0,0,0,0];if(n<0||o[0]+o[1]+o[2]+o[3]<1e-12)return t.rect(e,i,n,r);var d=[e,i],p=[e+n,i],f=[e+n,i+r],v=[e,i+r],g=Math.min(n/2,r/2),y=[Math.min(g,o[0]),Math.min(g,o[1]),Math.min(g,o[2]),Math.min(g,o[3])],m=[d[0]+y[0],d[1]],_=[d[0],d[1]+y[0]],b=[p[0]-y[1],p[1]],x=[p[0],p[1]+y[1]],k=[f[0]-y[2],f[1]],S=[f[0],f[1]-y[2]],A=[v[0]+y[3],v[1]],M=[v[0],v[1]-y[3]];if(t.moveTo(m[0],m[1]),s){if(l&&l[0]?l[0](m[0],m[1],b[0],b[1]):t.lineTo(b[0],b[1]),!Mt(b,x)){l&&l[0]&&t.moveTo(b[0],b[1]);var w=b[0],T=b[1]+y[1];t.arc(w,T,y[1],-em,0,!1)}if(l&&l[1]?l[1](x[0],x[1],S[0],S[1]):t.lineTo(S[0],S[1]),!Mt(k,S)){var C=S[0]-y[2],E=S[1];l&&l[1]&&t.moveTo(S[0],S[1]),t.arc(C,E,y[2],0,em,!1)}if(l&&l[2]?l[2](k[0],k[1],A[0],A[1]):t.lineTo(A[0],A[1]),!Mt(A,M)){var P=A[0],R=A[1]-y[3];l&&l[2]&&t.moveTo(A[0],A[1]),t.arc(P,R,y[3],em,re,!1)}if(l&&l[3]?l[3](M[0],M[1],_[0],_[1]):t.lineTo(_[0],_[1]),!Mt(m,_)){var B=m[0],I=m[1]+y[0];l&&l[3]&&t.moveTo(_[0],_[1]),t.arc(B,I,y[0],re,re+em,!1)}}else l&&l[0]?l[0](m[0],m[1],b[0],b[1]):t.lineTo(b[0],b[1]),l&&l[1]?l[1](b[0],b[1],k[0],k[1]):t.lineTo(k[0],k[1]),l&&l[2]?l[2](k[0],k[1],A[0],A[1]):t.lineTo(A[0],A[1]),l&&l[2]?l[2](A[0],A[1],m[0],m[1]):t.lineTo(m[0],m[1]);return!l&&t.closePath(),t}var nm=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},rm=function(){return o((function t(){r(this,t),this.time=Pl.afterFillStroke,this.useStyle=!0,this.order=0}),[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h){var d=t.attribute,p=d.outerBorder,f=d.innerBorder,v=p&&!1!==p.visible,g=f&&!1!==f.visible;if(v||g){var y=t.attribute,m=y.cornerRadius,_=void 0===m?l.cornerRadius:m,b=y.cornerType,x=void 0===b?l.cornerType:b,k=y.opacity,S=void 0===k?l.opacity:k,A=y.x,M=void 0===A?l.x:A,w=y.y,T=void 0===w?l.y:w,C=y.scaleX,E=void 0===C?l.scaleX:C,P=y.scaleY,R=void 0===P?l.scaleY:P,B=y.x1,I=y.y1,L=y.keepStrokeScale,D=void 0===L?l.keepStrokeScale:L,O=t.attribute,F=O.width,z=O.height;F=(null!=F?F:B-i)||0,z=(null!=z?z:I-n)||0;var H=function(r,a){var o=!(!r||!r.stroke),s="outerBorder"===a?-1:1,u=r.distance,c=void 0===u?l[a].distance:u,d=D?c:oc(e,c,e.dpr),p=i+s*d,f=n+s*d,v=2*d;if(0===_||X(_)&&_.every((function(t){return 0===t}))?(e.beginPath(),e.rect(p,f,F-s*v,z-s*v)):(e.beginPath(),im(e,p,f,F-s*v,z-s*v,_,"bevel"!==x)),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),h)h(e,r,l[a]);else if(o){var g=l[a].opacity;l[a].opacity=S,e.setStrokeStyle(t,r,(M-i)/E,(T-n)/R,l[a]),l[a].opacity=g,e.stroke()}};v&&H(p,"outerBorder"),g&&H(f,"innerBorder")}}}])}(),am=function(){return o((function t(){r(this,t),this.time=Pl.beforeFillStroke,this.useStyle=!0,this.order=0}),[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d){var p=t.attribute.stroke,f=void 0===p?l.stroke:p;Array.isArray(f)&&f.some((function(t){return!1===t}))&&(d.doStroke=!1)}}])}();am=nm([js()],am);var om=function(){return o((function t(){r(this,t),this.time=Pl.afterFillStroke,this.useStyle=!0,this.order=0}),[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h){var d=t.attribute,p=d.x1,f=d.y1,v=d.x,g=void 0===v?l.x:v,y=d.y,m=void 0===y?l.y:y,_=d.stroke,b=void 0===_?l.stroke:_,x=d.cornerRadius,k=void 0===x?l.cornerRadius:x,S=d.cornerType,A=void 0===S?l.cornerType:S,M=t.attribute,w=M.width,T=M.height;if(w=(null!=w?w:p-g)||0,T=(null!=T?T:f-m)||0,Array.isArray(b)&&b.some((function(t){return!1===t}))){if(e.setStrokeStyle(t,t.attribute,i,n,l),!(0===k||X(k)&&k.every((function(t){return 0===t})))){var C,E=0;return im(e,i,n,w,T,k,"bevel"!==A,new Array(4).fill(0).map((function(r,a){return function(r,o,s,u){b[a]&&(E===a-1&&b[a]===C||(e.setStrokeStyle(t,Object.assign(Object.assign({},t.attribute),{stroke:b[a]}),i,n,l),e.beginPath(),e.moveTo(r,o),C=b[a]),E=a,e.lineTo(s,u),e.stroke(),3===a&&e.beginPath())}}))),void e.stroke()}if(e.beginPath(),e.moveTo(i,n),b[0]?e.lineTo(i+w,n):e.moveTo(i+w,n),b[1]?e.lineTo(i+w,n+T):e.moveTo(i+w,n+T),b[2]?e.lineTo(i,n+T):e.moveTo(i,n+T),b[3]){var P=b[0]?n-e.lineWidth/2:n;e.lineTo(i,P)}else e.moveTo(i,n);e.stroke()}}}])}();om=nm([js()],om);var sm=new rm,lm=Gy,um=zy,cm=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).time=Pl.afterFillStroke,t.useStyle=!0,t.order=0,t}return h(e,t),o(e,[{key:"drawShape",value:function(t,i,n,r,a,o,s,l,u,c,h,d){return y(e,"drawShape",this,3)([t,i,n,r,a,o,s,l,u,c,h,d])}}])}(rm),hm=new cm,dm=zy,pm=function(){return o((function t(){r(this,t),this.time=Pl.afterFillStroke,this.useStyle=!0,this.order=0}),[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h){var d=t.getParsedPath();if(d){var p=t.attribute,f=p.outerBorder,v=p.innerBorder,g=f&&!1!==f.visible,y=v&&!1!==v.visible;if(g||y){var m=t.attribute,_=m.size,b=void 0===_?l.size:_,x=m.opacity,k=void 0===x?l.opacity:x,S=m.x,A=void 0===S?l.x:S,M=m.y,w=void 0===M?l.y:M,T=m.scaleX,C=void 0===T?l.scaleX:T,E=m.scaleY,P=void 0===E?l.scaleY:E,R=m.keepStrokeScale,B=void 0===R?l.keepStrokeScale:R,I=function(r,a){var o=!(!r||!r.stroke),s=r.distance,u=void 0===s?l[a].distance:s,c=B?u:oc(e,u,e.dpr),p="outerBorder"===a?1:-1;if(e.beginPath(),!1===d.drawOffset(e,b,i,n,p*c)&&e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),h)h(e,r,l[a]);else if(o){var f=l[a].opacity;l[a].opacity=k,e.setStrokeStyle(t,r,(A-i)/C,(w-n)/P,l[a]),l[a].opacity=f,e.stroke()}};g&&I(f,"outerBorder"),y&&I(v,"innerBorder")}}}}])}(),fm=function(){return o((function t(){r(this,t),this.time=Pl.afterFillStroke,this.useStyle=!0,this.order=0}),[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d){var p=t.attribute,f=p.clipRange,v=void 0===f?l.clipRange:f,g=p.x,y=void 0===g?l.x:g,m=p.y,_=void 0===m?l.y:m,b=p.z,x=void 0===b?l.z:b,k=p.size,S=void 0===k?l.size:k,A=p.scaleX,M=void 0===A?l.scaleX:A,w=p.scaleY,T=void 0===w?l.scaleY:w,C=t.getParsedPath();C&&v<1&&v>0&&(e.beginPath(),C.drawWithClipRange&&C.drawWithClipRange(e,S,i,n,v,x,(function(r,a){var o,u,c,d;if(t._parsedPath.svgCache){var p=Object.assign({},a);p.fill=null!==(o=a.fill)&&void 0!==o?o:t.attribute.fill,p.opacity=null!==(u=a.opacity)&&void 0!==u?u:t.attribute.opacity,p.fillOpacity=t.attribute.fillOpacity,p.stroke=null!==(c=a.stroke)&&void 0!==c?c:t.attribute.stroke,p.lineWidth=null!==(d=a.lineWidth)&&void 0!==d?d:t.attribute.lineWidth,a=p}a.stroke&&(h?h(e,t.attribute,l):s&&(e.setStrokeStyle(t,a,(y-i)/M,(_-n)/T,l),e.stroke()))})),a&&!C.isSvg&&(h?h(e,t.attribute,l):s&&(e.setStrokeStyle(t,t.attribute,(y-i)/M,(_-n)/T,l),e.stroke())))}}])}(),vm=new pm,gm=new fm,ym=Gy,mm=zy,_m=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).time=Pl.afterFillStroke,t}return h(e,t),o(e,[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d){var p,f,v,g;this.textureMap||this.initTextureMap(e,t.stage);var y=(d||{}).attribute,m=void 0===y?t.attribute:y,_=m.texture,b=void 0===_?null!==(p=t.attribute.texture)&&void 0!==p?p:hd(l,"texture"):_,x=m.textureColor,k=void 0===x?null!==(f=t.attribute.textureColor)&&void 0!==f?f:hd(l,"textureColor"):x,S=m.textureSize,A=void 0===S?null!==(v=t.attribute.textureSize)&&void 0!==v?v:hd(l,"textureSize"):S,M=m.texturePadding,w=void 0===M?null!==(g=t.attribute.texturePadding)&&void 0!==g?g:hd(l,"texturePadding"):M;b&&this.drawTexture(b,t,e,i,n,l,k,A,w)}}])}(Wy),bm={x:0,y:0,z:0,lastModelMatrix:null},xm=function(){return o((function t(){r(this,t)}),[{key:"init",value:function(t){var e=this;t&&(this._renderContribitions=t.getContributions()),this._renderContribitions||(this._renderContribitions=[]),this.builtinContributions||(this.builtinContributions=[]),this.builtinContributions.push(Ny),this.builtinContributions.push(Vy),this.builtinContributions.forEach((function(t){return e._renderContribitions.push(t)})),this._renderContribitions.length&&(this._renderContribitions.sort((function(t,e){return e.order-t.order})),this._beforeRenderContribitions=this._renderContribitions.filter((function(t){return t.time===Pl.beforeFillStroke})),this._afterRenderContribitions=this._renderContribitions.filter((function(t){return t.time===Pl.afterFillStroke})))}},{key:"beforeRenderStep",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d){this._beforeRenderContribitions&&this._beforeRenderContribitions.forEach((function(p){p.supportedAppName&&t.stage&&t.stage.params&&t.stage.params.context&&t.stage.params.context.appName&&!(Array.isArray(p.supportedAppName)?p.supportedAppName:[p.supportedAppName]).includes(t.stage.params.context.appName)||p.drawShape(t,e,i,n,r,a,o,s,l,u,c,h,d)}))}},{key:"afterRenderStep",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d){this._afterRenderContribitions&&this._afterRenderContribitions.forEach((function(p){p.supportedAppName&&t.stage&&t.stage.params&&t.stage.params.context&&t.stage.params.context.appName&&!(Array.isArray(p.supportedAppName)?p.supportedAppName:[p.supportedAppName]).includes(t.stage.params.context.appName)||p.drawShape(t,e,i,n,r,a,o,s,l,u,c,h,d)}))}},{key:"drawPathProxy",value:function(t,e,i,n,r,a,o,s){if(!t.pathProxy)return!1;var l=xh(t,null==a?void 0:a.theme)[t.type.replace("3d","")],u=t.attribute,c=u.fill,h=void 0===c?l.fill:c,d=u.stroke,p=void 0===d?l.stroke:d,f=u.opacity,v=void 0===f?l.opacity:f,g=u.fillOpacity,y=void 0===g?l.fillOpacity:g,m=u.lineWidth,_=void 0===m?l.lineWidth:m,b=u.strokeOpacity,x=void 0===b?l.strokeOpacity:b,k=u.visible,S=void 0===k?l.visible:k,A=u.x,M=void 0===A?l.x:A,w=u.y,T=void 0===w?l.y:w,C=Kv(v,y,h),E=Zv(v,x),P=Yv(h),R=Xv(p,_);return!S||(!P&&!R||(!(C||E||o||s)||(e.beginPath(),Nl(("function"==typeof t.pathProxy?t.pathProxy(t.attribute):t.pathProxy).commandList,e,i,n),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),this.beforeRenderStep(t,e,i,n,P,R,C,E,l,r,o,s),R&&(s?s(e,t.attribute,l):E&&(e.setStrokeStyle(t,t.attribute,i-M,n-T,l),e.stroke())),P&&(o?o(e,t.attribute,l):C&&(e.setCommonStyle(t,t.attribute,i-M,n-T,l),e.fill())),this.afterRenderStep(t,e,i,n,P,R,C,E,l,r,o,s),!0)))}},{key:"valid",value:function(t,e,i,n){var r=t.attribute,a=r.fill,o=void 0===a?e.fill:a,s=r.background,l=r.stroke,u=void 0===l?e.stroke:l,c=r.opacity,h=void 0===c?e.opacity:c,d=r.fillOpacity,p=void 0===d?e.fillOpacity:d,f=r.lineWidth,v=void 0===f?e.lineWidth:f,g=r.strokeOpacity,y=void 0===g?e.strokeOpacity:g,m=r.visible,_=void 0===m?e.visible:m,b=Kv(h,p,o),x=Zv(h,y),k=Yv(o,s),S=Xv(u,v);return!(!t.valid||!_)&&!(!k&&!S)&&!!(b||x||i||n||s)&&{fVisible:b,sVisible:x,doFill:k,doStroke:S}}},{key:"transform",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=t.attribute,a=r.x,o=void 0===a?e.x:a,s=r.y,l=void 0===s?e.y:s,u=r.z,c=void 0===u?e.z:u,h=r.scaleX,d=void 0===h?e.scaleX:h,p=r.scaleY,f=void 0===p?e.scaleY:p,v=r.angle,g=void 0===v?e.angle:v,y=r.postMatrix,m=i.modelMatrix,_=i.camera;bm.x=o,bm.y=l,bm.z=c,bm.lastModelMatrix=m;var b=_&&(n||function(t){var e=t.attribute,i=e.alpha,n=e.beta;return i||n}(t)),x=b?t.transMatrix.onlyTranslate()&&!y:1===d&&1===f&&0===g&&!y;if(b){var k=Mg.allocate(),S=Mg.allocate();Eg(S,t,e),bg(k,m||k,S),bm.x=0,bm.y=0,bm.z=0,i.modelMatrix=k,i.setTransform(1,0,0,1,0,0,!0),Mg.free(S)}if(x&&!m){var A=t.getOffsetXY(e);bm.x+=A.x,bm.y+=A.y,bm.z=c,i.setTransformForCurrent()}else if(b)bm.x=0,bm.y=0,bm.z=0,i.setTransform(1,0,0,1,0,0,!0);else if(_&&i.project){var M=t.getOffsetXY(e);bm.x+=M.x,bm.y+=M.y,this.transformWithoutTranslate(i,bm.x,bm.y,bm.z,d,f,g)}else i.transformFromMatrix(t.transMatrix,!0),bm.x=0,bm.y=0,bm.z=0;return bm}},{key:"transformUseContext2d",value:function(t,e,i,n){var r=n.camera;if(this.camera=r,r){var a=t.AABBBounds,o=a.x2-a.x1,s=a.y2-a.y1,l=n.project(0,0,i),u=n.project(o,0,i),c=n.project(o,s,i),h={x:0,y:0},d={x:o,y:0},p={x:o,y:s};n.camera=null;var f=1/(h.x*(p.y-d.y)-d.x*p.y+p.x*d.y+(d.x-p.x)*h.y),v=-(h.y*(c.x-u.x)-d.y*c.x+p.y*u.x+(d.y-p.y)*l.x)*f,g=(d.y*c.y+h.y*(u.y-c.y)-p.y*u.y+(p.y-d.y)*l.y)*f,y=(h.x*(c.x-u.x)-d.x*c.x+p.x*u.x+(d.x-p.x)*l.x)*f,m=-(d.x*c.y+h.x*(u.y-c.y)-p.x*u.y+(p.x-d.x)*l.y)*f,_=(h.x*(p.y*u.x-d.y*c.x)+h.y*(d.x*c.x-p.x*u.x)+(p.x*d.y-d.x*p.y)*l.x)*f,b=(h.x*(p.y*u.y-d.y*c.y)+h.y*(d.x*c.y-p.x*u.y)+(p.x*d.y-d.x*p.y)*l.y)*f;n.setTransform(v,g,y,m,_,b,!0)}}},{key:"restoreTransformUseContext2d",value:function(t,e,i,n){this.camera&&(n.camera=this.camera)}},{key:"transformWithoutTranslate",value:function(t,e,i,n,r,a,o){var s=t.project(e,i,n);t.translate(s.x,s.y,!1),t.scale(r,a,!1),t.rotate(o,!1),t.translate(-s.x,-s.y,!1),t.setTransformForCurrent()}},{key:"_draw",value:function(t,e,i,n,r){var a=n.context;if(a&&!1!==t.attribute.renderable){a.highPerformanceSave();var o=this.transform(t,e,a,i),s=o.x,l=o.y,u=o.z,c=o.lastModelMatrix;this.z=u,this.drawPathProxy(t,a,s,l,n,r)||(this.drawShape(t,a,s,l,n,r),this.z=0,a.modelMatrix!==c&&Mg.free(a.modelMatrix),a.modelMatrix=c),a.highPerformanceRestore()}}}])}(),km=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Sm=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Am=function(t,e){return function(i,n){e(i,n,t)}},Mm=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).arcRenderContribitions=t,i.numberType=iv,i.builtinContributions=[Yy,Ky,Xy],i.init(t),i}return h(e,t),o(e,[{key:"drawArcTailCapPath",value:function(t,e,i,n,r,a,o,s){var l=s-o,u=t.getParsedAngle(),c=u.startAngle,h=u.endAngle,d=(h=s)>c,p=!1;if(r<a){var f=r;r=a,a=f}var v=$v(t,c,h,a,r);v.outerDeltaAngle;var g=v.xors,y=v.yors,m=v.xirs,_=v.yirs,b=v.limitedOcr,x=v.outerCornerRadiusStart,k=v.outerCornerRadiusEnd,S=v.maxOuterCornerRadius,A=v.xore,M=v.yore,w=v.xire,T=v.yire,C=v.limitedIcr,E=v.innerDeltaAngle,P=v.innerStartAngle,R=v.innerCornerRadiusStart,B=v.innerCornerRadiusEnd,I=v.maxInnerCornerRadius;if(b>ne){var L=de(x,b),D=de(k,b),O=Qv(m,_,g,y,r,L,Number(d)),F=Qv(A,M,w,T,r,D,Number(d));if(b<S&&L===D)e.moveTo(i+O.cx+O.x01,n+O.cy+O.y01),e.arc(i+O.cx,n+O.cy,b,ue(O.y01,O.x01),ue(F.y01,F.x01),!d);else{var z=h-l-.03,H=ue(F.y11,F.x11);e.arc(i,n,r,z,H,!d),D>0&&e.arc(i+F.cx,n+F.cy,D,ue(F.y11,F.x11),ue(F.y01,F.x01),!d)}}else e.moveTo(i+g,n+y);if(!(a>ne)||E<.001)e.lineTo(i+w,n+T),p=!0;else if(C>ne){var j=de(R,C),N=de(B,C),V=Qv(w,T,A,M,a,-N,Number(d)),W=Qv(g,y,m,_,a,-j,Number(d));if(e.lineTo(i+V.cx+V.x01,n+V.cy+V.y01),C<I&&j===N){var G=ue(W.y01,W.x01);e.arc(i+V.cx,n+V.cy,C,ue(V.y01,V.x01),G,!d)}else{N>0&&e.arc(i+V.cx,n+V.cy,N,ue(V.y01,V.x01),ue(V.y11,V.x11),!d);var U=ue(V.cy+V.y11,V.cx+V.x11),Y=h-l-.03;e.arc(i,n,a,U,Y,d)}}else e.lineTo(i+a*ce(P),n+a*pe(P));return p}},{key:"drawShape",value:function(t,e,i,n,r,a,o,s){var l=xh(t,null==a?void 0:a.theme).arc,u=t.attribute,c=u.fill,h=void 0===c?l.fill:c,d=u.stroke,p=void 0===d?l.stroke:d,f=u.x,v=void 0===f?l.x:f,g=u.y,y=void 0===g?l.y:g,m=u.fillStrokeOrder,_=void 0===m?l.fillStrokeOrder:m,b=this.valid(t,l,o,s);if(b){var x=b.fVisible,k=b.sVisible,S=b.doFill,A=b.doStroke,M=t.attribute,w=M.outerPadding,T=void 0===w?l.outerPadding:w,C=M.innerPadding,E=void 0===C?l.innerPadding:C,P=M.cap,R=void 0===P?l.cap:P,B=M.forceShowCap,I=void 0===B?l.forceShowCap:B,L=t.attribute,D=L.outerRadius,O=void 0===D?l.outerRadius:D,F=L.innerRadius,H=void 0===F?l.innerRadius:F;O+=T,H-=E;var j=0,N=(z(R)&&R||R[0])&&"conical"===h.gradient;if(N){var V=t.getParsedAngle(),W=V.sc,G=V.startAngle,U=V.endAngle;le(U-G)<se-ne&&(j=W||0,h.startAngle-=j,h.endAngle-=j)}var Y=!1,X=function(t){var e,i=!0;if(z(t,!0)){for(var n=0;n<4;n++)id[n]=t,i&&(i=!(null!==(e=id[n])&&void 0!==e&&!e));i=t}else if(Array.isArray(t))for(var r=0;r<4;r++)id[r]=!!t[r],i&&(i=!!id[r]);else id[0]=!1,id[1]=!1,id[2]=!1,id[3]=!1;return{isFullStroke:i,stroke:id}}(p),K=X.isFullStroke,q=X.stroke;if(S||K){e.beginPath(),tg(t,e,i,n,O,H),Y=!0,e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),this.beforeRenderStep(t,e,i,n,S,A,x,k,l,r,o,s);var Z=function(){S&&(o?o(e,t.attribute,l):x&&(e.setCommonStyle(t,t.attribute,v-i,y-n,l),e.fill()))},J=function(){A&&K&&(s?s(e,t.attribute,l):k&&(e.setStrokeStyle(t,t.attribute,v-i,y-n,l),e.stroke()))};_?(J(),Z()):(Z(),J())}if(!K&&A&&(e.beginPath(),tg(t,e,i,n,O,H,q),Y||this.beforeRenderStep(t,e,i,n,S,A,x,k,l,r,o,s),s?s(e,t.attribute,l):k&&(e.setStrokeStyle(t,t.attribute,i,n,l),e.stroke())),(z(R)&&R||R[1])&&I){var Q=t.getParsedAngle(),$=Q.startAngle,tt=Q.endAngle;if(le(tt-$)>=se-ne){e.beginPath();var et=Math.abs(O-H)/2/O,it=t.attribute,nt=it.endAngle,rt=void 0===nt?l.endAngle:nt,at=it.fill,ot=void 0===at?l.fill:at,st=rt;this.drawArcTailCapPath(t,e,i,n,O,H,st,st+et),Y||this.beforeRenderStep(t,e,i,n,S,A,x,k,l,r,o,s);(function(){if(S){var r=ot;if("conical"===r.gradient){var a=function(t,e,i,n){for(var r=n.stops,a=n.startAngle,o=n.endAngle;i<0;)i+=se;for(;i>se;)i-=se;if(i<a)return r[0].color;if(i>o)return r[0].color;for(var s,l,u=(i-a)/(o-a),c=0;c<r.length;c++)if(r[c].offset>=u){s=r[c-1],l=r[c];break}return u=(u-s.offset)/(l.offset-s.offset),Wd(s.color,l.color,u,!1)}(0,0,rt,r);o||Kv&&(e.setCommonStyle(t,t.attribute,i,n,l),e.fillStyle=a,e.fill())}}})(),A&&(s||k&&(e.setStrokeStyle(t,t.attribute,i,n,l),e.stroke()))}}this.afterRenderStep(t,e,i,n,S,A,x,k,l,r,o,s),N&&(h.startAngle+=j,h.endAngle+=j)}}},{key:"draw",value:function(t,e,i,n){var r=xh(t,null==n?void 0:n.theme).arc;this._draw(t,r,!1,i,n)}}])}(xm);Mm=km([js(),Am(0,zs(nl)),Am(0,Ns(rg)),Sm("design:paramtypes",[Object])],Mm);var wm=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Tm=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Cm=function(t,e){return function(i,n){e(i,n,t)}},Em=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).circleRenderContribitions=t,i.numberType=av,i.builtinContributions=[Zy,Qy,Jy],i.init(t),i}return h(e,t),o(e,[{key:"drawShape",value:function(t,e,i,n,r,a,o,s){var l=xh(t,null==a?void 0:a.theme).circle,u=t.attribute,c=u.radius,h=void 0===c?l.radius:c,d=u.startAngle,p=void 0===d?l.startAngle:d,f=u.endAngle,v=void 0===f?l.endAngle:f,g=u.x,y=void 0===g?l.x:g,m=u.y,_=void 0===m?l.y:m,b=u.fillStrokeOrder,x=void 0===b?l.fillStrokeOrder:b,k=this.valid(t,l,o,s);if(k){var S=k.fVisible,A=k.sVisible,M=k.doFill,w=k.doStroke;e.beginPath(),e.arc(i,n,h,p,v),e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),this.beforeRenderStep(t,e,i,n,M,w,S,A,l,r,o,s);var T=function(){M&&(o?o(e,t.attribute,l):S&&(e.setCommonStyle(t,t.attribute,y-i,_-n,l),e.fill()))},C=function(){w&&(s?s(e,t.attribute,l):A&&(e.setStrokeStyle(t,t.attribute,y-i,_-n,l),e.stroke()))};x?(C(),T()):(T(),C()),this.afterRenderStep(t,e,i,n,M,w,S,A,l,r,o,s)}}},{key:"draw",value:function(t,e,i,n){var r=xh(t,null==n?void 0:n.theme).circle;this._draw(t,r,!1,i,n)}}])}(xm);function Pm(t,e,i,n){if(e.p1){var r=n||{},a=r.offsetX,o=void 0===a?0:a,s=r.offsetY,l=void 0===s?0:s,u=r.offsetZ,c=void 0===u?0:u;if(1===i)e.p2&&e.p3?t.bezierCurveTo(o+e.p1.x,l+e.p1.y,o+e.p2.x,l+e.p2.y,o+e.p3.x,l+e.p3.y,c):t.lineTo(o+e.p1.x,l+e.p1.y,c);else if(e.p2&&e.p3){var h=g(ql(e,i),1)[0];t.bezierCurveTo(o+h.p1.x,l+h.p1.y,o+h.p2.x,l+h.p2.y,o+h.p3.x,l+h.p3.y,c)}else{var d=e.getPointAt(i);t.lineTo(o+d.x,l+d.y,c)}}}function Rm(t,e,i,n,r,a,o){var s,l=e.p0,u=n;if(i&&i.originP1===i.originP2&&(l=i.p0),e.defined)n||(t.lineTo(l.x+r,l.y+a,o),u=!n);else{var c,h=e.originP1,d=e.originP2;if(h&&!1!==h.defined&&!i?c=l:h&&!1!==d.defined&&(c=null!==(s=e.p3)&&void 0!==s?s:e.p1),n){u=!n;var p=c?c.x:e.p0.x,f=c?c.y:e.p0.y;t.moveTo(p+r,f+a,o)}else c&&(u=!n,t.lineTo(c.x+r,c.y+a,o))}return u}function Bm(t,e,i,n,r){var a=r||{},o=a.offsetX,s=void 0===o?0:o,l=a.offsetY,u=void 0===l?0:l,c=a.offsetZ,h=void 0===c?0:c,d=a.mode,p=void 0===d?"none":d,f=a.drawConnect,v=void 0!==f&&f;if((!v||"none"!==p)&&e){var g=!0,y=e.curves;if(i>=1)if(v){var m,_=!0;y.forEach((function(e,i){e.originP1!==e.originP2?(_=Rm(t,e,m,_,s,u,h),m=e):m=e}))}else y.forEach((function(e){e.defined?(g&&t.moveTo(e.p0.x+s,e.p0.y+u,h),Pm(t,e,1,r),g=!1):g=!0}));else if(!(i<=0)){var b;"x"===n?b=Cl.ROW:"y"===n?b=Cl.COLUMN:"auto"===n&&(b=e.direction);for(var x=i*e.tryUpdateLength(b),k=0,S=!0,A=null,M=0,w=y.length;M<w;M++){var T=y[M],C=T.getLength(b),E=(x-k)/C;if(k+=C,E<0)break;if(v){if(T.originP1===T.originP2){A=T;continue}S=Rm(t,T,A,S,s,u,h),A=T}else{if(!T.defined){g=!0;continue}g&&t.moveTo(T.p0.x+s,T.p0.y+u,h),Pm(t,T,de(E,1),r),g=!1}}}}}Em=wm([js(),Cm(0,zs(nl)),Cm(0,Ns(og)),Tm("design:paramtypes",[Object])],Em);var Im=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Lm=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).numberType=uv,t}return h(e,t),o(e,[{key:"draw",value:function(t,e,i,n){var r=xh(t,null==n?void 0:n.theme).line;this._draw(t,r,!1,i,n)}},{key:"drawSegmentItem",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d,p,f){var v;if(e){t.beginPath();var g=null!==(v=this.z)&&void 0!==v?v:0;Bm(t.camera?t:t.nativeContext,e,l,u,{offsetX:c,offsetY:h,offsetZ:g}),d.cache&&!X(d.cache)&&d.cache.curves.every((function(t){return t.defined}))&&d.attribute.curveType&&d.attribute.curveType.includes("Closed")&&t.closePath(),t.setShadowBlendStyle&&t.setShadowBlendStyle(d,o,s);var y=o.x,m=void 0===y?0:y,_=o.x,b=void 0===_?0:_;return!1!==i&&(p?p(t,o,s):r&&(t.setCommonStyle(d,o,m-c,b-h,s),t.fill())),!1!==n&&(f?f(t,o,s):a&&(t.setStrokeStyle(d,o,m-c,b-h,s),t.stroke())),!1}}},{key:"drawLinearLineHighPerformance",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d){var p;e.beginPath();var f=null!==(p=this.z)&&void 0!==p?p:0,v=t.attribute.points,g=v[0];e.moveTo(g.x+o,g.y+s,f);for(var y=1;y<v.length;y++){var m=v[y];e.lineTo(m.x+o,m.y+s,f)}e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l);var _=t.attribute,b=_.x,x=void 0===b?0:b,k=_.x,S=void 0===k?0:k;!1!==i&&(h?h(e,t.attribute,l):r&&(e.setCommonStyle(t,t.attribute,x-o,S-s,l),e.fill())),!1!==n&&(d?d(e,t.attribute,l):a&&(e.setStrokeStyle(t,t.attribute,x-o,S-s,l),e.stroke()))}},{key:"drawShape",value:function(t,e,i,n,r,a,o,s){var l=this,u=xh(t,null==a?void 0:a.theme).line,c=t.attribute,h=c.fill,d=void 0===h?u.fill:h,p=c.stroke,f=void 0===p?u.stroke:p,v=c.fillOpacity,g=void 0===v?u.fillOpacity:v,y=c.strokeOpacity,m=void 0===y?u.strokeOpacity:y,_=c.segments,b=c.points,x=c.closePath,k=c.curveTension,S=void 0===k?u.curveTension:k,A=c.connectedType,M=void 0===A?u.connectedType:A;if(this.valid(t,u,o,s)){var w=t.attribute.curveType,T=void 0===w?u.curveType:w;x&&"linear"===T&&(T="linearClosed");var C=t.attribute,E=C.clipRange,P=void 0===E?u.clipRange:E,R=C.clipRangeByDimension,B=void 0===R?u.clipRangeByDimension:R;if(1===P&&!_&&!b.some((function(t){return!1===t.defined}))&&"linear"===T)return this.drawLinearLineHighPerformance(t,e,!!d,!!f,g,m,i,n,u,r,a,o,s);if(t.shouldUpdateShape()){var I=t.attribute,L=I.points,D=I.segments,O=L;if(D&&D.length){var F,z;if(t.cache=D.map((function(t,e){if(t.points.length<=1&&0===e)return t.points[0]&&(z={endX:t.points[0].x,endY:t.points[0].y,curves:[{defined:!1!==t.points[0].defined}]}),null;1===e?F={x:z.endX,y:z.endY,defined:z.curves[z.curves.length-1].defined}:e>1&&(F.x=z.endX,F.y=z.endY,F.defined=z.curves[z.curves.length-1].defined);var i=Pu(q(t.points,M),T,{startPoint:F,curveTension:S});return z=i,i})).filter((function(t){return!!t})),"linearClosed"===T){for(var H,j=0;j<t.cache.length;j++){for(var N=t.cache[j],V=0;V<N.curves.length;V++)if(N.curves[V].defined){H=N.curves[V].p0;break}if(H)break}t.cache[t.cache.length-1]&&t.cache[t.cache.length-1].lineTo(H.x,H.y,!0)}}else{if(!L||!L.length)return t.cache=null,void t.clearUpdateShapeTag();t.cache=Pu(q(O,M),T,{curveTension:S})}t.clearUpdateShapeTag()}if(Array.isArray(t.cache)){var W=t.attribute.segments.filter((function(t){return t.points.length}));if(1===W[0].points.length&&W.shift(),1===P){var G=!1;t.cache.forEach((function(r,a){G||(G=l.drawSegmentItem(e,r,!!d,!!f,g,m,W[a],[u,t.attribute],P,B,i,n,t,o,s))}))}else{var U=t.cache.reduce((function(t,e){return t+e.getLength()}),0),Y=P*U,X=0,K=!1;t.cache.forEach((function(r,a){if(!K){var c=r.getLength(),h=(Y-X)/c;X+=c,h>0&&(K=l.drawSegmentItem(e,r,!!d,!!f,g,m,W[a],[u,t.attribute],de(h,1),B,i,n,t,o,s))}}))}}else this.drawSegmentItem(e,t.cache,!!d,!!f,g,m,t.attribute,u,P,B,i,n,t,o,s)}function q(t,e){return"none"===e?t:t.filter((function(t){return!1!==t.defined}))}}}])}(xm);function Dm(t,e,i,n){var r=n||{},a=r.offsetX,o=void 0===a?0:a,s=r.offsetY,l=void 0===s?0:s,u=r.offsetZ,c=void 0===u?0:u,h=!0;e.forEach((function(e){e.defined?(h&&t.moveTo(e.p0.x+o,e.p0.y+l,c),Pm(t,e,1,n),h=!1):h=!0})),h=!0;for(var d=i.length-1;d>=0;d--){var p=i[d];p.defined?(h&&t.lineTo(p.p0.x+o,p.p0.y+l,c),Pm(t,p,1,n),h=!1):h=!0}t.closePath()}Lm=Im([js()],Lm);var Om=new _m,Fm=zy,zm=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Hm=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},jm=function(t,e){return function(i,n){e(i,n,t)}},Nm=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).areaRenderContribitions=t,i.numberType=rv,i.builtinContributions=[Om,Fm],i.init(t),i}return h(e,t),o(e,[{key:"drawLinearAreaHighPerformance",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d){var p,f,v,g=t.attribute.points;if(!(g.length<2)){e.beginPath();var y=null!==(p=this.z)&&void 0!==p?p:0,m=g[0];e.moveTo(m.x+o,m.y+s,y);for(var _=1;_<g.length;_++){var b=g[_];e.lineTo(b.x+o,b.y+s,y)}for(var x=g.length-1;x>=0;x--){var k=g[x];e.lineTo((null!==(f=k.x1)&&void 0!==f?f:k.x)+o,(null!==(v=k.y1)&&void 0!==v?v:k.y)+s,y)}e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),this.beforeRenderStep(t,e,o,s,!!r,!1,i,!1,l,u,h,null,{attribute:t.attribute});var S=t.attribute,A=S.x,M=void 0===A?0:A,w=S.x,T=void 0===w?0:w;!1!==i&&(h?h(e,t.attribute,l):r&&(e.setCommonStyle(t,t.attribute,M-o,T-s,l),e.fill())),this.afterRenderStep(t,e,o,s,!!r,!1,i,!1,l,u,h,null,{attribute:t.attribute}),function(){var i,r;if(n){var a=t.attribute.stroke,u=void 0===a?l&&l.stroke:a;if(X(u)&&(u[0]||u[2])&&!1===u[1])if(e.beginPath(),u[0]){e.moveTo(m.x+o,m.y+s,y);for(var c=1;c<g.length;c++){var h=g[c];e.lineTo(h.x+o,h.y+s,y)}}else if(u[2]){var p=g[g.length-1];e.moveTo(p.x+o,p.y+s,y);for(var f=g.length-2;f>=0;f--){var v=g[f];e.lineTo((null!==(i=v.x1)&&void 0!==i?i:v.x)+o,(null!==(r=v.y1)&&void 0!==r?r:v.y)+s,y)}}d?d(e,t.attribute,l):(e.setStrokeStyle(t,t.attribute,M-o,T-s,l),e.stroke())}}()}}},{key:"drawShape",value:function(t,e,i,n,r,a,o,s){var l,u,c,h,d,p,f=this,v=xh(t,null==a?void 0:a.theme).area,g=t.attribute,y=g.fill,m=void 0===y?v.fill:y,_=g.stroke;void 0===_&&v.stroke;var b=g.fillOpacity,x=void 0===b?v.fillOpacity:b,k=g.z,S=void 0===k?v.z:k,A=g.strokeOpacity,M=void 0===A?v.strokeOpacity:A,w=g.curveTension,T=void 0===w?v.curveTension:w,C=g.connectedType,E=void 0===C?v.connectedType:C,P=this.valid(t,v,o,s);if(P){var R=P.doFill,B=P.doStroke&&P.sVisible,I=t.attribute,L=I.clipRange,D=void 0===L?v.clipRange:L,O=I.closePath,F=I.points,z=I.segments,H=t.attribute.curveType,j=void 0===H?v.curveType:H;if(O&&"linear"===j&&(j="linearClosed"),1===D&&!z&&!F.some((function(t){return!1===t.defined}))&&"linear"===j)return this.drawLinearAreaHighPerformance(t,e,!!m,B,x,M,i,n,v,r,a,o,s);if(t.shouldUpdateShape()){if(z&&z.length){for(var N,V,W,G=z.map((function(t,e){if(t.points.length<=1&&0===e)return t.points[0]&&(V={endX:t.points[0].x,endY:t.points[0].y}),null;1===e?N={x:V.endX,y:V.endY}:e>1&&(N.x=V.endX,N.y=V.endY);var i=Pu(ut(t.points,E),j,{startPoint:N,curveTension:T});return V=i,i})).filter((function(t){return!!t})),U=[],Y=z.length-1;Y>=0;Y--){for(var X=z[Y].points,K=[],q=X.length-1;q>=0;q--)K.push({x:null!==(l=X[q].x1)&&void 0!==l?l:X[q].x,y:null!==(u=X[q].y1)&&void 0!==u?u:X[q].y});if(0!==Y){var Z=z[Y-1].points,J=Z[Z.length-1];J&&K.push({x:null!==(c=J.x1)&&void 0!==c?c:J.x,y:null!==(h=J.y1)&&void 0!==h?h:J.y})}K.length>1&&(W=Pu(ut(K,E),"stepBefore"===j?"stepAfter":"stepAfter"===j?"stepBefore":j,{curveTension:T}),U.unshift(W))}t.cacheArea=U.map((function(t,e){return{top:G[e],bottom:t}}))}else{if(!F||!F.length)return t.cacheArea=null,void t.clearUpdateShapeTag();for(var Q=ut(F,E),$=[],tt=Q.length-1;tt>=0;tt--)$.push({x:null!==(d=Q[tt].x1)&&void 0!==d?d:Q[tt].x,y:null!==(p=Q[tt].y1)&&void 0!==p?p:Q[tt].y});var et=Pu(Q,j,{curveTension:T}),it=Pu($,"stepBefore"===j?"stepAfter":"stepAfter"===j?"stepBefore":j,{curveTension:T});t.cacheArea={top:et,bottom:it}}t.clearUpdateShapeTag()}if(Array.isArray(t.cacheArea)){var nt=t.attribute.segments.filter((function(t){return t.points.length}));if(1===nt[0].points.length&&nt.shift(),1===D){var rt=!1;t.cacheArea.forEach((function(a,l){rt||(rt=f.drawSegmentItem(e,a,R,x,B,M,nt[l],[v,t.attribute],D,i,n,S,t,r,o,s))}))}else{var at=t.cacheArea.reduce((function(t,e){return t+e.top.getLength()}),0),ot=D*at,st=0,lt=!1;t.cacheArea.forEach((function(a,l){if(!lt){var u=a.top.getLength(),c=(ot-st)/u;st+=u,c>0&&(lt=f.drawSegmentItem(e,a,R,x,B,M,nt[l],[v,t.attribute],de(c,1),i,n,S,t,r,o,s))}}))}}else this.drawSegmentItem(e,t.cacheArea,R,x,B,M,t.attribute,v,D,i,n,S,t,r,o,s)}function ut(t,e){return"connect"!==e?t:t.filter((function(t){return!1!==t.defined}))}}},{key:"draw",value:function(t,e,i,n){var r=xh(t,null==n?void 0:n.theme).area;this._draw(t,r,!1,i,n)}},{key:"drawSegmentItem",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d,p,f,v){return this._drawSegmentItem(t,e,i,n,r,a,o,s,l,u,c,h,d,p,f,v)}},{key:"_drawSegmentItem",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d,p,f,v){if(e&&e.top&&e.bottom&&e.top.curves&&e.top.curves.length&&e.bottom.curves&&e.bottom.curves.length){t.beginPath();var g,y,m=d.attribute,_=m.points,b=m.segments,x=Cl.ROW;if(b){var k=b[b.length-1];y=b[0].points[0],g=k.points[k.points.length-1]}else y=_[0],g=_[_.length-1];var S=le(g.x-y.x),A=le(g.y-y.y);x=null==g.x1?Cl.ROW:null==g.y1?Cl.COLUMN:Number.isFinite(S+A)?S>A?Cl.ROW:Cl.COLUMN:Cl.ROW,function(t,e,i,n){var r,a=e.top,o=e.bottom;if(a.curves.length===o.curves.length)if(i>=1){for(var s=[],l=[],u=!0,c=0,h=a.curves.length;c<h;c++){var d=a.curves[c];u!==d.defined?(u?(Dm(t,s,l,n),s.length=0,l.length=0):(s.push(d),l.push(o.curves[h-c-1])),u=!u):u&&(s.push(d),l.push(o.curves[h-c-1]))}Dm(t,s,l,n)}else if(!(i<=0)){var p=(n||{}).direction,f=a.curves,v=null!==(r=f[f.length-1].p3)&&void 0!==r?r:f[f.length-1].p1,g=le(v.x-f[0].p0.x),y=le(v.y-f[0].p0.y);p=null!=p?p:g>y?Cl.ROW:Cl.COLUMN,Number.isFinite(g)||(p=Cl.COLUMN),Number.isFinite(y)||(p=Cl.ROW);for(var m=i*(p===Cl.ROW?g:y),_=0,b=!0,x=[],k=[],S=0,A=a.curves.length;S<A;S++){var M=a.curves[S],w=M.getLength(p),T=(m-_)/w;if(T<0)break;_+=w;var C=null,E=null;b!==M.defined?(b?(Dm(t,x,k,n),x.length=0,k.length=0):(C=M,E=o.curves[A-S-1]),b=!b):b&&(C=M,E=o.curves[A-S-1]),C&&E&&(T<1&&(C=C.p2&&C.p3?ql(C,T)[0]:Ql(C,T)[0],E=E.p2&&E.p3?ql(E,1-T)[1]:Ql(E,1-T)[1]),C.defined=b,E.defined=b,x.push(C),k.push(E)),C=null,E=null}Dm(t,x,k,n)}}(t.camera?t:t.nativeContext,e,l,{offsetX:u,offsetY:c,offsetZ:h,direction:x}),this.beforeRenderStep(d,t,u,c,!!n,!1,i,!1,s,p,f,null,{attribute:o}),t.setShadowBlendStyle&&t.setShadowBlendStyle(d,o,s);var M=o.x,w=void 0===M?0:M,T=o.x,C=void 0===T?0:T;return!1!==i&&(f?f(t,o,s):n&&(t.setCommonStyle(d,o,w-u,C-c,s),t.fill())),this.afterRenderStep(d,t,u,c,!!n,!1,i,!1,s,p,f,null,{attribute:o}),function(){if(!1!==r)if(v)v(t,o,s);else{var i=o.stroke,n=void 0===i?s&&s[1]&&s[1].stroke:i;X(n)&&(n[0]||n[2])&&!1===n[1]&&(t.beginPath(),Bm(t.camera?t:t.nativeContext,n[0]?e.top:e.bottom,l,x===Cl.ROW?"x":"y",{offsetX:u,offsetY:c,offsetZ:h})),t.setStrokeStyle(d,o,w-u,C-c,s),t.stroke()}}(),!1}}}])}(xm);Nm=zm([js(),jm(0,zs(nl)),jm(0,Ns(ag)),Hm("design:paramtypes",[Object])],Nm);var Vm=Gy,Wm=zy,Gm=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Um=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Ym=function(t,e){return function(i,n){e(i,n,t)}},Xm=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).pathRenderContribitions=t,i.numberType=cv,i.builtinContributions=[Wm,Vm],i.init(t),i}return h(e,t),o(e,[{key:"drawShape",value:function(t,e,i,n,r,a,o,s){var l,u,c,h=null!==(l=this.tempTheme)&&void 0!==l?l:xh(t,null==a?void 0:a.theme).path,d=t.attribute,p=d.x,f=void 0===p?h.x:p,v=d.y,g=void 0===v?h.y:v,y=d.fillStrokeOrder,m=void 0===y?h.fillStrokeOrder:y,_=null!==(u=this.z)&&void 0!==u?u:0,b=this.valid(t,h,o,s);if(b){var x=b.fVisible,k=b.sVisible,S=b.doFill,A=b.doStroke;if(e.beginPath(),t.pathShape)Nl(t.pathShape.commandList,e,i,n,1,1,_);else Nl((null!==(c=t.attribute.path)&&void 0!==c?c:h.path).commandList,e,i,n,1,1,_);e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,h),this.beforeRenderStep(t,e,i,n,S,A,x,k,h,r,o,s);var M=function(){A&&(s?s(e,t.attribute,h):k&&(e.setStrokeStyle(t,t.attribute,f-i,g-n,h),e.stroke()))},w=function(){S&&(o?o(e,t.attribute,h):x&&(e.setCommonStyle(t,t.attribute,f-i,g-n,h),e.fill()))};m?(M(),w()):(w(),M()),this.afterRenderStep(t,e,i,n,S,A,x,k,h,r,o,s)}}},{key:"draw",value:function(t,e,i,n){var r=xh(t,null==n?void 0:n.theme).path;this.tempTheme=r,this._draw(t,r,!1,i,n),this.tempTheme=null}}])}(xm);Xm=Gm([js(),Ym(0,zs(nl)),Ym(0,Ns(ug)),Um("design:paramtypes",[Object])],Xm);var Km=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},qm=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Zm=function(t,e){return function(i,n){e(i,n,t)}},Jm=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).rectRenderContribitions=t,i.type="rect",i.numberType=pv,i.builtinContributions=[sm,um,lm],i.init(t),i}return h(e,t),o(e,[{key:"drawShape",value:function(t,e,i,n,r,a,o,s){var l,u=null!==(l=this.tempTheme)&&void 0!==l?l:xh(t,null==a?void 0:a.theme).rect,c=t.attribute,h=c.fill,d=void 0===h?u.fill:h,p=c.background,f=c.stroke,v=void 0===f?u.stroke:f,g=c.cornerRadius,y=void 0===g?u.cornerRadius:g,m=c.cornerType,_=void 0===m?u.cornerType:m,b=c.opacity,x=void 0===b?u.opacity:b,k=c.fillOpacity,S=void 0===k?u.fillOpacity:k,A=c.lineWidth,M=void 0===A?u.lineWidth:A,w=c.strokeOpacity,T=void 0===w?u.strokeOpacity:w,C=c.visible,E=void 0===C?u.visible:C,P=c.x1,R=c.y1,B=c.x,I=void 0===B?u.x:B,L=c.y,D=void 0===L?u.y:L,O=c.fillStrokeOrder,F=void 0===O?u.fillStrokeOrder:O,z=t.attribute,H=z.width,j=z.height,N=qv(x,S,H=(null!=H?H:P-I)||0,j=(null!=j?j:R-D)||0,d),V=Jv(x,T,H,j),W=Yv(d,p),G=Xv(v,M);if(t.valid&&E&&(W||G)&&(N||V||o||s||p)){0===y||X(y)&&y.every((function(t){return 0===t}))?(e.beginPath(),e.rect(i,n,H,j)):(e.beginPath(),im(e,i,n,H,j,y,"bevel"!==_));var U={doFill:W,doStroke:G};e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,u),this.beforeRenderStep(t,e,i,n,W,G,N,V,u,r,o,s,U);var Y=function(){U.doFill&&(o?o(e,t.attribute,u):N&&(e.setCommonStyle(t,t.attribute,I-i,D-n,u),e.fill()))},K=function(){U.doStroke&&(s?s(e,t.attribute,u):V&&(e.setStrokeStyle(t,t.attribute,I-i,D-n,u),e.stroke()))};F?(K(),Y()):(Y(),K()),this.afterRenderStep(t,e,i,n,W,G,N,V,u,r,o,s)}}},{key:"draw",value:function(t,e,i,n){var r=xh(t,null==n?void 0:n.theme).rect;this.tempTheme=r,this._draw(t,r,!1,i,n),this.tempTheme=null}}])}(xm);Jm=Km([js(),Zm(0,zs(nl)),Zm(0,Ns(hg)),qm("design:paramtypes",[Object])],Jm);var Qm=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},$m=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},t_=function(t,e){return function(i,n){e(i,n,t)}},e_=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).symbolRenderContribitions=t,i.numberType=gv,i.builtinContributions=[vm,mm,ym,gm],i.init(t),i}return h(e,t),o(e,[{key:"drawShape",value:function(t,e,i,n,r,a,o,s){var l,u=xh(t,null==a?void 0:a.theme).symbol,c=t.attribute,h=c.size,d=void 0===h?u.size:h,p=c.x,f=void 0===p?u.x:p,v=c.y,g=void 0===v?u.y:v,y=c.scaleX,m=void 0===y?u.scaleX:y,_=c.scaleY,b=void 0===_?u.scaleY:_,x=c.fillStrokeOrder,k=void 0===x?u.fillStrokeOrder:x,S=c.clipRange,A=void 0===S?u.clipRange:S,M=this.valid(t,u,o,s);if(M){var w=M.fVisible,T=M.sVisible,C=M.doFill,E=M.doStroke,P=t.getParsedPath();if(P){var R=t.attribute.keepDirIn3d,B=void 0===R?u.keepDirIn3d:R,I=null!==(l=this.z)&&void 0!==l?l:0;e.beginPath();var L=i,D=n,O=I,F=e.camera;if(B&&F&&e.project){var z=e.project(i,n,I);e.camera=null,X(d)&&(d[0],d[1]),L=z.x,D=z.y,O=void 0}!1===P.draw(e,d,L,D,O,(function(r,a){var l,c,h,d;if(t._parsedPath.svgCache){var p=Object.assign({},a);p.fill=null!==(l=a.fill)&&void 0!==l?l:t.attribute.fill,p.opacity=null!==(c=a.opacity)&&void 0!==c?c:t.attribute.opacity,p.fillOpacity=t.attribute.fillOpacity,p.stroke=null!==(h=a.stroke)&&void 0!==h?h:t.attribute.stroke,p.lineWidth=null!==(d=a.lineWidth)&&void 0!==d?d:t.attribute.lineWidth,a=p}var v=function(){a.fill&&(o?o(e,t.attribute,u):(e.setCommonStyle(t,a,f-i,g-n,u),e.fill()))},y=function(){a.stroke&&(s?s(e,t.attribute,u):T&&A>=1&&(e.setStrokeStyle(t,a,(f-i)/m,(g-n)/b,u),e.stroke()))};k?(y(),v()):(v(),y())}))&&e.closePath(),e.camera=F,e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,u),this.beforeRenderStep(t,e,i,n,C,E,w,T,u,r,o,s);var H=function(){C&&!P.isSvg&&(o?o(e,t.attribute,u):w&&(e.setCommonStyle(t,t.attribute,f-i,g-n,u),e.fill()))},j=function(){E&&!P.isSvg&&(s?s(e,t.attribute,u):T&&A>=1&&(e.setStrokeStyle(t,t.attribute,(f-i)/m,(g-n)/b,u),e.stroke()))};k?(j(),H()):(H(),j()),this.afterRenderStep(t,e,i,n,C,E,w,T,u,r,o,s)}}}},{key:"draw",value:function(t,e,i,n){var r=xh(t,null==n?void 0:n.theme).symbol;this._draw(t,r,!1,i,n)}}])}(xm);e_=Qm([js(),t_(0,zs(nl)),t_(0,Ns(dg)),$m("design:paramtypes",[Object])],e_);var i_=function(){return o((function t(){r(this,t),this.pools=[];for(var e=0;e<10;e++)this.pools.push(new pi)}),[{key:"allocate",value:function(t,e,i,n){if(!this.pools.length)return(new pi).setValue(t,e,i,n);var r=this.pools.pop();return r.x1=t,r.y1=e,r.x2=i,r.y2=n,r}},{key:"allocateByObj",value:function(t){if(!this.pools.length)return new pi(t);var e=this.pools.pop();return e.x1=t.x1,e.y1=t.y1,e.x2=t.x2,e.y2=t.y2,e}},{key:"free",value:function(t){this.pools.push(t)}},{key:"length",get:function(){return this.pools.length}},{key:"release",value:function(){this.pools=[]}}])}(),n_=new i_,r_=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).time=Pl.beforeFillStroke,t}return h(e,t),o(e,[{key:"drawShape",value:function(t,e,i,n,r,a,o,s,l,u,c,h){var d,p,f,v,g,y,m,_,b,x,k,S=t.attribute,A=S.backgroundMode,M=void 0===A?l.backgroundMode:A,w=S.backgroundFit,T=void 0===w?l.backgroundFit:w,C=S.backgroundKeepAspectRatio,E=void 0===C?l.backgroundKeepAspectRatio:C,P=t.attribute.background;if(P){var R,B=function(){"richtext"===t.type&&(e.restore(),e.save(),k&&e.setTransformFromMatrix(k,!0,1))};"richtext"===t.type&&(k=e.currentMatrix.clone(),e.restore(),e.save(),e.setTransformForCurrent());var I=V(P)&&P.background,L=t.transMatrix.onlyTranslate();if(I){var D=t.AABBBounds,O=(null!==(d=P.x)&&void 0!==d?d:D.x1)+(null!==(p=P.dx)&&void 0!==p?p:0),F=(null!==(f=P.y)&&void 0!==f?f:D.y1)+(null!==(v=P.dy)&&void 0!==v?v:0),z=null!==(g=P.width)&&void 0!==g?g:D.width(),H=null!==(y=P.height)&&void 0!==y?y:D.height();if(R=n_.allocate(O,F,O+z,F+H),P=P.background,!L){var j=R.width(),N=R.height();R.set((null!==(m=P.x)&&void 0!==m?m:0)+(null!==(_=P.dx)&&void 0!==_?_:0),(null!==(b=P.y)&&void 0!==b?b:0)+(null!==(x=P.dy)&&void 0!==x?x:0),j,N)}}else R=t.AABBBounds,L||(R=Iy(Object.assign(Object.assign({},t.attribute),{angle:0,scaleX:1,scaleY:1,x:0,y:0,dx:0,dy:0})).clone());if(t.backgroundImg&&t.resources){var W=t.resources.get(P);if("success"!==W.state||!W.data)return void B();e.highPerformanceSave(),L&&e.setTransformFromMatrix(t.parent.globalTransMatrix,!0),e.setCommonStyle(t,t.attribute,i,n,l),this.doDrawImage(e,W.data,R,{backgroundMode:M,backgroundFit:T,backgroundKeepAspectRatio:E}),e.highPerformanceRestore(),e.setTransformForCurrent()}else{var G=t.attribute.backgroundCornerRadius;e.highPerformanceSave(),e.setCommonStyle(t,t.attribute,i,n,l),e.fillStyle=P,G?(im(e,R.x1,R.y1,R.width(),R.height(),G,!0),e.fill()):e.fillRect(R.x1,R.y1,R.width(),R.height()),e.highPerformanceRestore()}I&&n_.free(R),B()}}}])}(Fy),a_=new r_,o_=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},s_=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},l_=function(t,e){return function(i,n){e(i,n,t)}},u_=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).textRenderContribitions=t,i.numberType=yv,i.builtinContributions=[a_],i.init(t),i}return h(e,t),o(e,[{key:"drawShape",value:function(t,e,i,n,r,a,o,s){var l,u,c,h=this,d=xh(t,null==a?void 0:a.theme).text,p=t.attribute;p.text;var f=p.underline,v=void 0===f?d.underline:f,g=p.lineThrough,y=void 0===g?d.lineThrough:g,m=p.keepDirIn3d,_=void 0===m?d.keepDirIn3d:m,b=p.direction,x=void 0===b?d.direction:b,k=p.fontSize,S=void 0===k?d.fontSize:k,A=p.verticalMode,M=void 0===A?d.verticalMode:A,w=p.x,T=void 0===w?d.x:w,C=p.y,E=void 0===C?d.y:C,P=null!==(l=vd(t.attribute.lineHeight,S))&&void 0!==l?l:S,R=this.valid(t,d,o,s);if(R){var B=R.fVisible,I=R.sVisible,L=R.doFill,D=R.doStroke,O=!_,F=this.z||0;e.beginPath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,d),this.beforeRenderStep(t,e,i,n,L,D,B,I,d,r,o,s),O&&this.transformUseContext2d(t,d,F,e);var z=function(r,a,l,u){var c=i+a,h=n+l;if(u){e.highPerformanceSave(),c+=S;var p=Ag.allocate(1,0,0,1,0,0);p.rotateByCenter(Math.PI/2,c,h),e.transformFromMatrix(p,!0),Ag.free(p)}D&&(s?s(e,t.attribute,d):I&&(e.setStrokeStyle(t,t.attribute,T-i,E-n,d),e.strokeText(r,c,h,F))),L&&(o?o(e,t.attribute,d):B&&(e.setCommonStyle(t,t.attribute,T-i,E-n,d),e.fillText(r,c,h,F))),u&&(e.highPerformanceRestore(),e.setTransformForCurrent())};if(e.setTextStyleWithoutAlignBaseline(t.attribute,d,F),"horizontal"===x){var H=t.multilineLayout;if(!H)return void e.highPerformanceRestore();var j=H.bbox,N=j.xOffset,V=j.yOffset;D&&(s?s(e,t.attribute,d):I&&(e.setStrokeStyle(t,t.attribute,T-i,E-n,d),H.lines.forEach((function(t){e.strokeText(t.str,(t.leftOffset||0)+N+i,(t.topOffset||0)+V+n,F)})))),L&&(o?o(e,t.attribute,d):B&&(e.setCommonStyle(t,t.attribute,T-i,E-n,d),H.lines.forEach((function(r){e.fillText(r.str,(r.leftOffset||0)+N+i,(r.topOffset||0)+V+n,F),h.drawUnderLine(v,y,t,(r.leftOffset||0)+N+i,(r.topOffset||0)+V+n,r.descent,(r.descent-r.ascent)/2,F,d,e,{width:r.width})}))))}else{var W=t.attribute,G=W.textAlign,U=void 0===G?d.textAlign:G,Y=W.textBaseline,X=void 0===Y?d.textBaseline:Y;if(!M){var K=U;U=null!==(u=t.getBaselineMapAlign()[X])&&void 0!==u?u:"left",X=null!==(c=t.getAlignMapBaseline()[K])&&void 0!==c?c:"top"}t.tryUpdateAABBBounds();var q=t.cache.verticalList;e.textAlign="left",e.textBaseline="top";var Z=P*q.length,J=0;q.forEach((function(t){var e=t.reduce((function(t,e){return t+(e.width||0)}),0);J=he(e,J)}));var Q=0,$=0;"bottom"===X?$=-Z:"middle"===X&&($=-Z/2),"center"===U?Q-=J/2:"right"===U&&(Q-=J),q.forEach((function(t,e){var i=t.reduce((function(t,e){return t+(e.width||0)}),0),n=J-i,r=Q;"center"===U?r+=n/2:"right"===U&&(r+=n),t.forEach((function(t){var i=t.text,n=t.width,a=t.direction;z(i,Z-(e+1)*P+$,r,a),r+=n}))}))}O&&this.restoreTransformUseContext2d(t,d,F,e),this.afterRenderStep(t,e,i,n,L,D,B,I,d,r,o,s)}}},{key:"draw",value:function(t,e,i,n){var r=xh(t,null==n?void 0:n.theme).text,a=t.attribute.keepDirIn3d,o=!(void 0===a?r.keepDirIn3d:a);this._draw(t,r,o,i,n)}},{key:"drawUnderLine",value:function(t,e,i,n,r,a,o,s,l,u,c){if(!(e+t<=0)){var h=i.attribute,d=h.textAlign,p=void 0===d?l.textAlign:d,f=h.fill,v=void 0===f?l.fill:f,g=h.opacity,y=void 0===g?l.opacity:g,m=h.underlineOffset,_=void 0===m?l.underlineOffset:m,b=h.underlineDash,x=void 0===b?l.underlineDash:b,k=h.fillOpacity,S=void 0===k?l.fillOpacity:k,A=!j(c),M=A?c.width:i.clipedWidth,w=A?0:vg(p,M),T={lineWidth:0,stroke:v,opacity:y,strokeOpacity:S};if(t){T.lineWidth=t,u.setStrokeStyle(i,T,n,r,l),x&&u.setLineDash(x),u.beginPath();var C=r+a+_;u.moveTo(n+w,C,s),u.lineTo(n+w+M,C,s),u.stroke()}if(e){T.lineWidth=e,u.setStrokeStyle(i,T,n,r,l),u.beginPath();var E=r+o;u.moveTo(n+w,E,s),u.lineTo(n+w+M,E,s),u.stroke()}}}}])}(xm);function c_(t,e,i,n){t.moveTo(e[0].x+i,e[0].y+n);for(var r=1;r<e.length;r++)t.lineTo(e[r].x+i,e[r].y+n)}function h_(t,e){return Math.sqrt(t*t+e*e)}function d_(t,e,i,n,r){var a=e/i;return{x:t.x-n*a,y:t.y-r*a}}u_=o_([js(),l_(0,zs(nl)),l_(0,Ns(pg)),s_("design:paramtypes",[Object])],u_);var p_=Gy,f_=zy,v_=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},g_=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},y_=function(t,e){return function(i,n){e(i,n,t)}},m_=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).polygonRenderContribitions=t,i.numberType=hv,i.builtinContributions=[f_,p_],i.init(t),i}return h(e,t),o(e,[{key:"drawShape",value:function(t,e,i,n,r,a,o,s){var l=xh(t,null==a?void 0:a.theme).polygon,u=t.attribute,c=u.points,h=void 0===c?l.points:c,d=u.cornerRadius,p=void 0===d?l.cornerRadius:d,f=u.x,v=void 0===f?l.x:f,g=u.y,y=void 0===g?l.y:g,m=u.closePath,_=void 0===m?l.closePath:m,b=u.fillStrokeOrder,x=void 0===b?l.fillStrokeOrder:b,k=this.valid(t,l,o,s);if(k){var S=k.fVisible,A=k.sVisible,M=k.doFill,w=k.doStroke;e.beginPath(),p<=0||X(p)&&p.every((function(t){return 0===t}))?c_(e.camera?e:e.nativeContext,h,i,n):function(t,e,i,n,r){var a,o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if(e.length<3)c_(t,e,i,n);else{var s=0,l=e.length-1;o||(s+=1,l-=1,t.moveTo(e[0].x+i,e[0].y+n));for(var u=s;u<=l;u++){var c=e[0===u?l:(u-1)%e.length],h=e[u%e.length],d=e[(u+1)%e.length],p=h.x-c.x,f=h.y-c.y,v=h.x-d.x,g=h.y-d.y,y=(Math.atan2(f,p)-Math.atan2(g,v))/2,m=Math.abs(Math.tan(y)),_=Array.isArray(r)?null!==(a=r[u%e.length])&&void 0!==a?a:0:r,b=_/m,x=h_(p,f),k=h_(v,g),S=Math.min(x,k);b>S&&(b=S,_=S*m);var A=d_(h,b,x,p,f),M=d_(h,b,k,v,g),w=2*h.x-A.x-M.x,T=2*h.y-A.y-M.y,C=h_(w,T),E=d_(h,h_(b,_),C,w,T),P=Math.atan2(A.y-E.y,A.x-E.x),R=Math.atan2(M.y-E.y,M.x-E.x),B=R-P;B<0&&(P=R,B=-B),B>Math.PI&&(B-=Math.PI),0===u?t.moveTo(A.x+i,A.y+n):t.lineTo(A.x+i,A.y+n),B&&t.arcTo(h.x+i,h.y+n,M.x+i,M.y+n,_),t.lineTo(M.x+i,M.y+n)}o||t.lineTo(e[l+1].x+i,e[l+1].y+n)}}(e.camera?e:e.nativeContext,h,i,n,p,_),_&&e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),this.beforeRenderStep(t,e,i,n,M,w,S,A,l,r,o,s);var T=function(){M&&(o?o(e,t.attribute,l):S&&(e.setCommonStyle(t,t.attribute,v-i,y-n,l),e.fill()))},C=function(){w&&(s?s(e,t.attribute,l):A&&(e.setStrokeStyle(t,t.attribute,v-i,y-n,l),e.stroke()))};x?(C(),T()):(T(),C()),this.afterRenderStep(t,e,i,n,M,w,S,A,l,r,o,s)}}},{key:"draw",value:function(t,e,i,n){var r=xh(t,null==n?void 0:n.theme).polygon;this._draw(t,r,!1,i,n)}}])}(xm);m_=v_([js(),y_(0,zs(nl)),y_(0,Ns(cg)),g_("design:paramtypes",[Object])],m_);var __=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},b_=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},x_=function(t,e){return function(i,n){e(i,n,t)}},k_=function(){return o((function t(e){r(this,t),this.groupRenderContribitions=e,this.numberType=sv}),[{key:"drawShape",value:function(t,e,i,n,r,a,o,s){var l=xh(t,null==a?void 0:a.theme).group,u=t.attribute,c=u.fill,h=void 0===c?l.fill:c,d=u.background,p=u.stroke,f=void 0===p?l.stroke:p,v=u.opacity,g=void 0===v?l.opacity:v,y=u.width,m=void 0===y?l.width:y,_=u.height,b=void 0===_?l.height:_,x=u.clip,k=void 0===x?l.clip:x,S=u.fillOpacity,A=void 0===S?l.fillOpacity:S,M=u.strokeOpacity,w=void 0===M?l.strokeOpacity:M,T=u.cornerRadius,C=void 0===T?l.cornerRadius:T,E=u.path,P=void 0===E?l.path:E,R=u.lineWidth,B=void 0===R?l.lineWidth:R,I=u.visible,L=void 0===I?l.visible:I,D=u.fillStrokeOrder,O=void 0===D?l.fillStrokeOrder:D,F=u.cornerType,z=void 0===F?l.cornerType:F,H=u.x,j=void 0===H?l.x:H,N=u.y,V=void 0===N?l.y:N,W=qv(g,A,m,b,h),G=Jv(g,w,m,b),U=Yv(h,d),Y=Xv(f,B);if(t.valid&&L){if(!k){if(!U&&!Y)return;if(!(W||G||o||s||d))return}if(P&&P.length&&r.drawContribution){var K=e.disableFill,q=e.disableStroke,Z=e.disableBeginPath;e.disableFill=!0,e.disableStroke=!0,e.disableBeginPath=!0,P.forEach((function(t){r.drawContribution.getRenderContribution(t).draw(t,r.renderService,r,a)})),e.disableFill=K,e.disableStroke=q,e.disableBeginPath=Z}else 0===C||X(C)&&C.every((function(t){return 0===t}))?(e.beginPath(),e.rect(i,n,m,b)):(e.beginPath(),im(e,i,n,m,b,C,"bevel"!==z));this._groupRenderContribitions||(this._groupRenderContribitions=this.groupRenderContribitions.getContributions()||[],this._groupRenderContribitions.push(tm));var J={doFill:U,doStroke:Y};e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),this._groupRenderContribitions.forEach((function(a){a.time===Pl.beforeFillStroke&&a.drawShape(t,e,i,n,U,Y,W,G,l,r,o,s,J)})),k&&e.clip();var Q=function(){J.doFill&&(o?o(e,t.attribute,l):W&&(e.setCommonStyle(t,t.attribute,j-i,V-n,l),e.fill()))},$=function(){J.doStroke&&(s?s(e,t.attribute,l):G&&(e.setStrokeStyle(t,t.attribute,j-i,V-n,l),e.stroke()))};O?($(),Q()):(Q(),$()),this._groupRenderContribitions.forEach((function(a){a.time===Pl.afterFillStroke&&a.drawShape(t,e,i,n,U,Y,W,G,l,r,o,s)}))}}},{key:"draw",value:function(t,e,i,n){var r=i.context;if(r){var a=t.attribute,o=a.clip,s=a.baseOpacity,l=void 0===s?1:s,u=a.drawMode,c=a.x,h=a.y,d=a.width,p=a.height,f=r.nativeContext,v=r.canvas.nativeCanvas;if(u>0){var g=r.canvas,y=ex.createCanvas({width:g.width,height:g.height,dpr:1}),m=y.getContext("2d"),_=r.nativeContext.getTransform();m.setTransform(_.a,_.b,_.c,_.d,_.e,_.f),1===u&&(m.save(),m.clearRect(0,0,g.width,g.height),m.beginPath(),m.rect(c,h,d,p),m.clip(),m.drawImage(g.nativeCanvas,0,0,g.width,g.height,0,0,g.displayWidth,g.displayHeight),m.restore()),r.nativeContext=m,g.nativeCanvas=y}o?r.save():r.highPerformanceSave();var b=r.baseGlobalAlpha;r.baseGlobalAlpha*=l;var x=xh(t,null==n?void 0:n.theme).group,k=r.modelMatrix;if(r.camera){var S=Mg.allocate(),A=Mg.allocate();Eg(A,t,x),bg(S,k||S,A),r.modelMatrix=S,Mg.free(A),r.setTransform(1,0,0,1,0,0,!0)}else r.transformFromMatrix(t.transMatrix,!0);r.beginPath(),n.skipDraw?this.drawShape(t,r,0,0,i,n,(function(){return!1}),(function(){return!1})):this.drawShape(t,r,0,0,i);var M,w=t.attribute,T=w.scrollX,C=void 0===T?x.scrollX:T,E=w.scrollY,P=void 0===E?x.scrollY:E;if((C||P)&&r.translate(C,P),n&&n.drawingCb&&(M=n.drawingCb()),r.modelMatrix!==k&&Mg.free(r.modelMatrix),r.modelMatrix=k,r.baseGlobalAlpha=b,u>0){var R=r.nativeContext,B=r.canvas.nativeCanvas;f.save(),f.setTransform(r.dpr,0,0,r.dpr,0,0,!0),1===u&&R.rect(c,h,d,p),f.drawImage(B,0,0,B.width,B.height,0,0,r.canvas.displayWidth,r.canvas.displayHeight);var I=R.getTransform();f.setTransform(I.a,I.b,I.c,I.d,I.e,I.f),r.nativeContext=f,r.canvas.nativeCanvas=v,f.restore()}M&&M.then?M.then((function(){o?r.restore():r.highPerformanceRestore()})):o?r.restore():r.highPerformanceRestore()}}}])}();k_=__([js(),x_(0,zs(nl)),x_(0,Ns(sg)),b_("design:paramtypes",[Object])],k_);var S_=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},A_=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},M_=function(t,e){return function(i,n){e(i,n,t)}},w_=["","repeat-x","repeat-y","repeat"],T_=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).imageRenderContribitions=t,i.numberType=lv,i.builtinContributions=[hm,dm],i.init(t),i}return h(e,t),o(e,[{key:"drawShape",value:function(t,e,i,n,r,a,o,s){var l=xh(t).image,u=t.attribute,c=u.repeatX,h=void 0===c?l.repeatX:c,d=u.repeatY,p=void 0===d?l.repeatY:d,f=u.x,v=void 0===f?l.x:f,g=u.y,y=void 0===g?l.y:g,m=u.cornerRadius,_=void 0===m?l.cornerRadius:m,b=u.fillStrokeOrder,x=void 0===b?l.fillStrokeOrder:b,k=u.cornerType,S=void 0===k?l.cornerType:k,A=u.image,M=this.valid(t,l,o);if(M){var w=M.fVisible,T=M.sVisible,C=M.doFill,E=M.doStroke;if(A&&t.resources){var P=t.resources.get(A);if("success"===P.state){var R=t.width,B=t.height;e.beginPath();var I=!1;0===_||X(_)&&_.every((function(t){return 0===t}))?e.rect(i,n,R,B):(im(e,i,n,R,B,_,"bevel"!==S),I=!0),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l);var L=function(){if(C)if(o)o(e,t.attribute,l);else if(w){e.setCommonStyle(t,t.attribute,i,n,l);var r=0;if("repeat"===h&&(r|=1),"repeat"===p&&(r|=2),r){var a=e.createPattern(P.data,w_[r]);e.fillStyle=a,e.translate(i,n,!0),e.fillRect(0,0,R,B),e.translate(-i,-n,!0)}else e.drawImage(P.data,i,n,R,B)}},D=function(){E&&(s?s(e,t.attribute,l):T&&(e.setStrokeStyle(t,t.attribute,v-i,y-n,l),e.stroke()))};x?(D(),I&&(e.save(),e.clip()),this.beforeRenderStep(t,e,i,n,C,!1,w,!1,l,r,o),L(),I&&e.restore()):(I&&(e.save(),e.clip()),this.beforeRenderStep(t,e,i,n,C,!1,w,!1,l,r,o),L(),I&&e.restore(),D()),this.afterRenderStep(t,e,i,n,C,!1,w,!1,l,r,o)}}}}},{key:"draw",value:function(t,e,i){var n=t.attribute.image;if(n&&t.resources){var r=t.resources.get(n);if("loading"===r.state&&Y(n))lp.improveImageLoading(n);else if("success"===r.state)if(e.drawParams.context){var a=xh(t).image;this._draw(t,a,!1,i)}}}}])}(xm);T_=S_([js(),M_(0,zs(nl)),M_(0,Ns(lg)),A_("design:paramtypes",[Object])],T_);var C_=Symbol.for("IncrementalDrawContribution"),E_=Symbol.for("ArcRender"),P_=Symbol.for("Arc3dRender"),R_=Symbol.for("AreaRender"),B_=Symbol.for("CircleRender"),I_=Symbol.for("GraphicRender"),L_=Symbol.for("GroupRender"),D_=Symbol.for("LineRender"),O_=Symbol.for("PathRender"),F_=Symbol.for("PolygonRender"),z_=Symbol.for("RectRender"),H_=Symbol.for("Rect3DRender"),j_=Symbol.for("SymbolRender"),N_=Symbol.for("TextRender"),V_=Symbol.for("RichTextRender"),W_=Symbol.for("Pyramid3dRender"),G_=Symbol.for("GlyphRender"),U_=Symbol.for("ImageRender"),Y_=Symbol.for("DrawContribution"),X_=function(t,e,i,n){var r,a=!1,o=!1;if(e.forEachChildren((function(t){return!(a=t.numberType===nv)})),e.forEachChildren((function(t){return!(o=!!t.findFace)})),a){var s=e.getChildren(),l=m(s);l.sort((function(t,e){for(var i,n,r,a,o=(null!==(n=null!==(i=t.attribute.startAngle)&&void 0!==i?i:0+t.attribute.endAngle)&&void 0!==n?n:0)/2,s=(null!==(a=null!==(r=e.attribute.startAngle)&&void 0!==r?r:0+e.attribute.endAngle)&&void 0!==a?a:0)/2;o<0;)o+=se;for(;s<0;)s+=se;return s-o})),l.forEach((function(t){t._next=null,t._prev=null})),e.removeAllChild(),e.update(),l.forEach((function(t){e.appendChild(t)})),n.hack_pieFace="outside",(r=i(a,o))&&r.graphic||(n.hack_pieFace="inside",r=i(a,o)),r&&r.graphic||(n.hack_pieFace="top",r=i(a,o)),e.removeAllChild(),s.forEach((function(t){t._next=null,t._prev=null})),s.forEach((function(t){e.appendChild(t)}))}else if(o){var u=e.getChildren(),c=u.map((function(e){return{ave_z:e.findFace().vertices.map((function(i){var n;return t.view(i[0],i[1],null!==(n=i[2]+e.attribute.z)&&void 0!==n?n:0)[2]})).reduce((function(t,e){return t+e}),0),g:e}}));c.sort((function(t,e){return e.ave_z-t.ave_z})),e.removeAllChild(),c.forEach((function(t){t.g._next=null,t.g._prev=null})),e.update(),c.forEach((function(t){e.add(t.g)})),r=i(a,o),e.removeAllChild(),u.forEach((function(t){t._next=null,t._prev=null})),e.update(),u.forEach((function(t){e.add(t)}))}else r=i(a,o);return r},K_=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},q_=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Z_=Symbol.for("DrawItemInterceptor"),J_=new pi,Q_=new pi,$_=function(){return o((function t(){r(this,t),this.order=1}),[{key:"afterDrawItem",value:function(t,e,i,n,r){return null==t.attribute.shadowRootIdx&&t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx<0||(t.attribute.shadowRootIdx>0||!t.attribute.shadowRootIdx||t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx>0)&&this.drawItem(t,e,i,n,r),!1}},{key:"beforeDrawItem",value:function(t,e,i,n,r){return null==t.attribute.shadowRootIdx&&t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx>0||(t.attribute.shadowRootIdx<0||t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx<0)&&this.drawItem(t,e,i,n,r),!1}},{key:"drawItem",value:function(t,e,i,n,r){if(!t.shadowRoot)return!1;var a=i.context;if(a.highPerformanceSave(),a.transformFromMatrix(t.transMatrix,!0),n.dirtyBounds&&n.backupDirtyBounds){J_.copy(n.dirtyBounds),Q_.copy(n.backupDirtyBounds);var o=t.globalTransMatrix.getInverse();n.dirtyBounds.copy(n.backupDirtyBounds).transformWithMatrix(o),n.backupDirtyBounds.copy(n.dirtyBounds)}return n.renderGroup(t.shadowRoot,i,Ag.allocate(1,0,0,1,0,0)),a.highPerformanceRestore(),n.dirtyBounds&&n.backupDirtyBounds&&(n.dirtyBounds.copy(J_),n.backupDirtyBounds.copy(Q_)),!0}}])}(),tb=function(){return o((function t(){r(this,t),this.order=1}),[{key:"afterDrawItem",value:function(t,e,i,n,r){return t.attribute._debug_bounds&&this.drawItem(t,e,i,n,r),!1}},{key:"drawItem",value:function(t,e,i,n,r){if(!t.attribute._debug_bounds)return!1;var a=i.context;a.highPerformanceSave(),t.parent&&a.setTransformFromMatrix(t.parent.globalTransMatrix,!0),t.glyphHost&&t.glyphHost.parent&&a.setTransformFromMatrix(t.glyphHost.parent.globalTransMatrix,!0);var o=t.AABBBounds;return!0!==t.attribute._debug_bounds&&t.attribute._debug_bounds(a,t),a.strokeRect(o.x1,o.y1,o.width(),o.height()),a.highPerformanceRestore(),!0}}])}(),eb=function(){return o((function t(){r(this,t),this.order=1,this.interceptors=[new $_,new nb,new ib,new tb]}),[{key:"afterDrawItem",value:function(t,e,i,n,r){for(var a=0;a<this.interceptors.length;a++)if(this.interceptors[a].afterDrawItem&&this.interceptors[a].afterDrawItem(t,e,i,n,r))return!0;return!1}},{key:"beforeDrawItem",value:function(t,e,i,n,r){if((!t.in3dMode||i.in3dInterceptor)&&!t.shadowRoot&&!(t.baseGraphic||t.attribute.globalZIndex||t.interactiveGraphic))return!1;for(var a=0;a<this.interceptors.length;a++)if(this.interceptors[a].beforeDrawItem&&this.interceptors[a].beforeDrawItem(t,e,i,n,r))return!0;return!1}}])}();eb=K_([js(),q_("design:paramtypes",[])],eb);var ib=function(){return o((function t(){r(this,t),this.order=1}),[{key:"beforeDrawItem",value:function(t,e,i,n,r){return!this.processing&&(t.baseGraphic?this.beforeDrawInteractive(t,e,i,n,r):this.beforeSetInteractive(t,e,i,n,r))}},{key:"beforeSetInteractive",value:function(t,e,i,n,r){var a=t.interactiveGraphic;if(t.attribute.globalZIndex){a||(a=t.clone(),t.interactiveGraphic=a,a.baseGraphic=t),a.setAttributes({globalZIndex:0,zIndex:t.attribute.globalZIndex},!1,{skipUpdateCallback:!0}),i.stage.tryInitInteractiveLayer();var o=i.stage.getLayer("_builtin_interactive");return o&&this.getShadowRoot(o).add(a),!0}if(a){i.stage.tryInitInteractiveLayer();var s=i.stage.getLayer("_builtin_interactive");s&&this.getShadowRoot(s).removeChild(a),t.interactiveGraphic=null,a.baseGraphic=null}return!1}},{key:"beforeDrawInteractive",value:function(t,e,i,n,r){for(var a=t.baseGraphic,o=!!a.stage,s=a.parent;o&&s&&s.stage!==s;)o=!!s.stage,s=s.parent;if(!o){var l=i.stage.getLayer("_builtin_interactive");return l&&this.getShadowRoot(l).removeChild(t),!0}if(a){this.processing=!0;var u=i.context;return u.highPerformanceSave(),u.setTransformFromMatrix(a.parent.globalTransMatrix,!0),a.isContainer?n.renderGroup(a,i,a.parent.globalTransMatrix):n.renderItem(a,i),u.highPerformanceRestore(),this.processing=!1,!0}return!1}},{key:"getShadowRoot",value:function(t){var e,i=t.getElementById("_interactive_group");return i||((i=By.CreateGraphic("group",{})).id="_interactive_group",t.add(i)),null!==(e=i.shadowRoot)&&void 0!==e?e:i.attachShadow()}}])}(),nb=function(){return o((function t(){r(this,t),this.order=1}),[{key:"beforeDrawItem",value:function(t,e,i,n,r){if(!t.in3dMode||i.in3dInterceptor)return!1;i.in3dInterceptor=!0;var a=e.drawParams,o=a.context,s=a.stage;o.canvas,o.save(),this.initCanvasCtx(o),o.camera=s.camera;var l=o.currentMatrix;l.a/=o.dpr,l.b/=o.dpr,l.c/=o.dpr,l.d/=o.dpr,l.e/=o.dpr,l.f/=o.dpr;var u=Mg.allocate();_g(u,l);var c=o.modelMatrix;if(c){if(u){var h=Mg.allocate();o.modelMatrix=bg(h,c,u)}}else o.modelMatrix=u;return o.setTransform(1,0,0,1,0,0,!0),t.isContainer?X_(o,t,(function(e,r){return n.renderGroup(t,i,t.parent.globalTransMatrix,!e&&r)}),i):n.renderItem(t,i),o.camera=null,o.restore(),o.modelMatrix!==c&&Mg.free(o.modelMatrix),o.modelMatrix=c,i.in3dInterceptor=!1,!0}},{key:"initCanvasCtx",value:function(t){t.setTransformForCurrent()}}])}(),rb=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},ab=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},ob=function(t,e){return function(i,n){e(i,n,t)}},sb=Symbol.for("RenderService"),lb=function(){return o((function t(e){r(this,t),this.drawContribution=e}),[{key:"prepare",value:function(t){var e=this;t&&this.renderTreeRoots.forEach((function(i){e._prepare(i,t)}))}},{key:"_prepare",value:function(t,e){var i=this;t.forEachChildren((function(t){i._prepare(t,e)})),t.update({bounds:e,trans:!0})}},{key:"prepareRenderList",value:function(){}},{key:"beforeDraw",value:function(t){}},{key:"draw",value:function(t){this.drawContribution.draw(this,Object.assign({},this.drawParams))}},{key:"afterDraw",value:function(t){this.drawContribution.afterDraw&&this.drawContribution.afterDraw(this,Object.assign({},this.drawParams))}},{key:"render",value:function(t,e){this.renderTreeRoots=t,this.drawParams=e;var i=e.updateBounds;this.prepare(i),this.prepareRenderList(),this.beforeDraw(e),this.draw(e),this.afterDraw(e),this.drawParams=null}}])}();lb=rb([js(),ob(0,zs(Y_)),ab("design:paramtypes",[Object])],lb);var ub=new Ts((function(t){t(sb).to(lb)})),cb=Symbol.for("PickerService"),hb=Symbol.for("GlobalPickerService"),db=Symbol.for("PickItemInterceptor"),pb=Symbol.for("PickServiceInterceptor"),fb=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},vb=function(){return o((function t(){r(this,t),this.order=1}),[{key:"afterPickItem",value:function(t,e,i,n,r){if(t.graphic){for(var a=t.graphic;a.parent;)a=a.parent;a.shadowHost&&(t.params={shadowTarget:t.graphic},t.graphic=a.shadowHost)}return t}}])}();vb=fb([js()],vb);var gb=function(){return o((function t(){r(this,t),this.order=1}),[{key:"afterPickItem",value:function(t,e,i,n,r){return t.attribute.shadowRootIdx>0||!t.attribute.shadowRootIdx?this._pickItem(t,e,i,n,r):null}},{key:"beforePickItem",value:function(t,e,i,n,r){return t.attribute.shadowRootIdx<0?this._pickItem(t,e,i,n,r):null}},{key:"_pickItem",value:function(t,e,i,n,r){var a;if(!t.shadowRoot)return null;var o=(r||{}).parentMatrix;if(!o)return null;var s=e.pickContext;s.highPerformanceSave();var l=null===(a=xh(t))||void 0===a?void 0:a[t.type],u=t.attribute.shadowPickMode,c=void 0===u?null==l?void 0:l.shadowPickMode:u,h=t.shadowRoot,d=Ag.allocateByObj(o),p=new Ae(d.a*i.x+d.c*i.y+d.e,d.b*i.x+d.d*i.y+d.f),f=e.pickGroup(h,p,d,n);return s.highPerformanceRestore(),!f.graphic&&f.group&&"full"===c&&(f.graphic=f.group),f}}])}();gb=fb([js()],gb);var yb=function(){return o((function t(){r(this,t),this.order=1}),[{key:"beforePickItem",value:function(t,e,i,n,r){var a=t.baseGraphic;if(a&&a.parent){var o=new Ae(i.x,i.y),s=e.pickContext;s.highPerformanceSave();var l=a.parent.globalTransMatrix;l.transformPoint(o,o);var u=a.isContainer?e.pickGroup(a,o.clone(),l,n):e.pickItem(a,o.clone(),l,n);return s.highPerformanceRestore(),u}return null}}])}();yb=fb([js()],yb);var mb=function(){return o((function t(){r(this,t),this.order=1}),[{key:"beforePickItem",value:function(t,e,i,n,r){if(!t.in3dMode||n.in3dInterceptor)return null;var a=e.pickContext,o=t.stage;if(!a||!o)return null;if(n.in3dInterceptor=!0,a.save(),this.initCanvasCtx(a),a.camera=o.camera,t.isContainer){var s=X_(a,t,(function(){return e.pickGroup(t,i,r.parentMatrix,n)}),n);return a.camera=null,n.in3dInterceptor=!1,a.restore(),s}return a.restore(),null}},{key:"initCanvasCtx",value:function(t){t.setTransformForCurrent()}}])}();mb=fb([js()],mb);var _b=new Ts((function(t,e,i){i(cb)||(t(hb).toSelf(),t(cb).toService(hb)),t(mb).toSelf().inSingletonScope(),t(db).toService(mb),t(gb).toSelf().inSingletonScope(),t(db).toService(gb),t(yb).toSelf().inSingletonScope(),t(db).toService(yb),al(t,db),t(vb).toSelf().inSingletonScope(),t(pb).toService(vb),al(t,pb)})),bb=new Ts((function(t){t(mv).to(Pg).inSingletonScope(),t(_v).toConstantValue(By)})),xb=Symbol.for("AutoEnablePlugins"),kb=Symbol.for("PluginService"),Sb=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Ab=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Mb=function(t,e){return function(i,n){e(i,n,t)}},wb=function(){return o((function t(e){r(this,t),this.autoEnablePlugins=e,this.onStartupFinishedPlugin=[],this.onRegisterPlugin=[],this.actived=!1}),[{key:"active",value:function(t,e){var i=this;this.stage=t,this.actived=!0;var n=e.pluginList;n&&Ac.isBound(xb)&&this.autoEnablePlugins.getContributions().forEach((function(t){n.includes(t.name)&&i.register(t)}))}},{key:"findPluginsByName",value:function(t){var e=[];return this.onStartupFinishedPlugin.forEach((function(i){i.name===t&&e.push(i)})),this.onRegisterPlugin.forEach((function(i){i.name===t&&e.push(i)})),e}},{key:"register",value:function(t){"onStartupFinished"===t.activeEvent?this.onStartupFinishedPlugin.push(t):"onRegister"===t.activeEvent&&(this.onRegisterPlugin.push(t),t.activate(this))}},{key:"unRegister",value:function(t){"onStartupFinished"===t.activeEvent?this.onStartupFinishedPlugin.splice(this.onStartupFinishedPlugin.indexOf(t),1):"onRegister"===t.activeEvent&&this.onRegisterPlugin.splice(this.onStartupFinishedPlugin.indexOf(t),1),t.deactivate(this)}},{key:"release",value:function(){var t=this;this.onStartupFinishedPlugin.forEach((function(e){e.deactivate(t)})),this.onStartupFinishedPlugin=[],this.onRegisterPlugin.forEach((function(e){e.deactivate(t)})),this.onRegisterPlugin=[]}}])}();wb=Sb([js(),Mb(0,zs(nl)),Mb(0,Ns(xb)),Ab("design:paramtypes",[Object])],wb);var Tb=new Ts((function(t){t(kb).to(wb),function(t,e){t(nl).toDynamicValue((function(t){var i=t.container;return new rl(e,i)})).whenTargetNamed(e)}(t,xb)})),Cb=new Ts((function(t){al(t,ul)})),Eb=new Ts((function(t){t(kc).to(Sc).inSingletonScope(),al(t,kc)})),Pb=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Rb=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Bb=function(){return o((function t(){r(this,t),this.type="static",this.offscreen=!1,this.global=nc.global}),[{key:"setDpr",value:function(t){this.canvas.dpr=t}},{key:"init",value:function(t,e,i){if(this.layer=t,this.window=e,i.main)this.main=!0,this.context=e.getContext(),this.canvas=this.context.getCanvas();else{var n;this.main=!1,i.canvasId&&(n=this.global.getElementById(i.canvasId)),n||(n=this.global.createCanvas({width:e.width,height:e.height})),n.style&&(n.style["pointer-events"]="none");var r=e.getContext().getCanvas().nativeCanvas,a=Tc({nativeCanvas:n,width:e.width,height:e.height,dpr:e.dpr,id:i.canvasId,canvasControled:!0,container:e.getContainer(),x:r.offsetLeft,y:r.offsetTop});a.applyPosition(),this.canvas=a,this.context=a.getContext()}}},{key:"resize",value:function(t,e){this.canvas.resize(t,e)}},{key:"resizeView",value:function(t,e){}},{key:"render",value:function(t,e,i){var n;if(!this.main){var r=this.window.getContext().getCanvas().nativeCanvas;!r||this.canvas.x===r.offsetLeft&&this.canvas.y===r.offsetTop||(this.canvas.x=r.offsetLeft,this.canvas.y=r.offsetTop,this.canvas.applyPosition())}e.renderService.render(t,Object.assign(Object.assign({context:this.context,clear:null!==(n=e.background)&&void 0!==n?n:"#ffffff"},e),i))}},{key:"merge",value:function(t){var e=this;t.forEach((function(t){var i=t.getContext().canvas.nativeCanvas;e.context.drawImage(i,0,0)}))}},{key:"prepare",value:function(t,e){}},{key:"drawTo",value:function(t,e,i){var n,r=t.getContext();i.renderService.render(e,Object.assign(Object.assign({context:r},i),{clear:i.clear?null!==(n=i.background)&&void 0!==n?n:"#fff":void 0}))}},{key:"getContext",value:function(){return this.context}},{key:"release",value:function(){this.canvas.release()}}])}();Bb=Pb([js(),Rb("design:paramtypes",[])],Bb);var Ib=new Ts((function(t){t(Bb).toSelf(),t(Hv).toService(Bb)}));var Lb=function(t,e,i,n){return new(i||(i=Promise))((function(r,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,s)}l((n=n.apply(t,e||[])).next())}))};function Db(t,e,i){var n={},r=[];return t.forEachChildren((function(t){var i=t.attribute.zIndex,a=void 0===i?e:i;n[a]?n[a].push(t):(n[a]=[t],r.push(a))}),i),r.sort((function(t,e){return i?e-t:t-e})),{childMap:n,zIdxArray:r}}function Ob(t,e,i){var n,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=!1;a?o=!0:t.forEachChildren((function(t,i){var r=t.attribute.zIndex,a=void 0===r?e:r;if(0===i)n=a;else if(n!==a)return o=!0,!0;return!1}),r);if(o)for(var s=Db(t,e,r),l=s.childMap,u=s.zIdxArray,c=!1,h=0;h<u.length&&!c;h++){var d=l[u[h]];a&&d.sort((function(t,e){var i,n;return(r?-1:1)*((null!==(i=e.attribute.z)&&void 0!==i?i:0)-(null!==(n=t.attribute.z)&&void 0!==n?n:0))}));for(var p=0;p<d.length;p++)if(i(d[p],p)){c=!0;break}}else t.forEachChildren(i,r)}function Fb(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Lb(this,void 0,void 0,f().mark((function e(){return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.forEachChildrenAsync(i,n);case 2:case"end":return e.stop()}}),e)})))}function zb(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=!1;t.forEachChildren((function(t,e){var n=t.attribute.zIndex;if(0===e);else if(void 0!==(void 0===n?i:n))return r=!0,!0;return!1}),n);var a=null,o=!1;if(r)for(var s=Db(t,i,n),l=s.childMap,u=s.zIdxArray,c=!1,h=0;h<u.length&&!c;h++)for(var d=l[u[h]],p=0;p<d.length;p++){if(o){c=!0,a=d[p];break}d[p]._uid!==e||(o=!0)}else t.forEachChildren((function(t){return o?(a=t,!0):(t._uid===e&&(o=!0),!1)}),n);return a}var Hb=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},jb=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Nb=function(t,e){return function(i,n){e(i,n,t)}},Vb=function(){return o((function t(e,i){r(this,t),this.contributions=e,this.drawItemInterceptorContributions=i,this.currentRenderMap=new Map,this.defaultRenderMap=new Map,this.styleRenderMap=new Map,this.dirtyBounds=new di,this.backupDirtyBounds=new di,this.global=nc.global,this.layerService=nc.layerService,X(this.contributions)||(this.contributions=[this.contributions]),this.init()}),[{key:"init",value:function(){var t=this;this.contributions.forEach((function(e){if(e.style){var i=t.styleRenderMap.get(e.style)||new Map;i.set(e.numberType,e),t.styleRenderMap.set(e.style,i)}else t.defaultRenderMap.set(e.numberType,e)})),this.InterceptorContributions=this.drawItemInterceptorContributions.getContributions().sort((function(t,e){return t.order-e.order}))}},{key:"prepareForDraw",value:function(t,e){e.updateBounds?this.useDirtyBounds=!0:this.useDirtyBounds=!e.stage.params.optimize.disableCheckGraphicWidthOutRange}},{key:"draw",value:function(t,e){var i=this;this.prepareForDraw(t,e),e.drawContribution=this,this.currentRenderMap=this.styleRenderMap.get(e.renderStyle)||this.defaultRenderMap,this.currentRenderService=t;var n=e.context,r=e.stage,a=e.viewBox,o=e.transMatrix;if(n){var s=this.dirtyBounds.setValue(0,0,a.width(),a.height());if(r.dirtyBounds&&!r.dirtyBounds.empty()){var l=He(s,r.dirtyBounds,!1);s.x1=Math.floor(l.x1),s.y1=Math.floor(l.y1),s.x2=Math.ceil(l.x2),s.y2=Math.ceil(l.y2)}var u=n.dpr%1;(u||.5!==u)&&(s.x1=Math.floor(s.x1*n.dpr)/n.dpr,s.y1=Math.floor(s.y1*n.dpr)/n.dpr,s.x2=Math.ceil(s.x2*n.dpr)/n.dpr,s.y2=Math.ceil(s.y2*n.dpr)/n.dpr),this.backupDirtyBounds.copy(s),n.inuse=!0,n.setClearMatrix(o.a,o.b,o.c,o.d,o.e,o.f),n.clearMatrix(),n.setTransformForCurrent(!0),n.translate(a.x1,a.y1,!0),n.beginPath(),n.rect(s.x1,s.y1,s.width(),s.height()),n.clip(),r.camera&&(this.dirtyBounds.setValue(-1/0,-1/0,1/0,1/0),this.backupDirtyBounds.setValue(-1/0,-1/0,1/0,1/0)),this.clearScreen(t,n,e),n.save(),t.renderTreeRoots.sort((function(t,e){var i,n;return(null!==(i=t.attribute.zIndex)&&void 0!==i?i:Nu.zIndex)-(null!==(n=e.attribute.zIndex)&&void 0!==n?n:Nu.zIndex)})).forEach((function(t){t.isContainer?i.renderGroup(t,e,Ag.allocate(1,0,0,1,0,0)):i.renderItem(t,e)})),n.restore(),n.setClearMatrix(1,0,0,1,0,0),n.inuse=!1,n.draw()}}},{key:"doRegister",value:function(){throw new Error("暂不支持")}},{key:"_findNextGraphic",value:function(t){for(var e=t.parent,i=t._uid;e;){var n=zb(e,i,Nu.zIndex);if(n)return n;i=e._uid,e=e.parent}return null}},{key:"renderGroup",value:function(t,e,i,n){var r=this;if(!e.break&&!1!==t.attribute.visibleAll){if(t.incremental&&(null==e.startAtId||e.startAtId===t._uid))return e.break=!0,void this._increaseRender(t,e);if(!this.useDirtyBounds||Ye(t.AABBBounds,this.dirtyBounds,!1)||"empty"===t.attribute.boundsMode){var a,o=i;if(this.useDirtyBounds){a=n_.allocateByObj(this.dirtyBounds);var s=t.transMatrix;o=Ag.allocateByObj(i).multiply(s.a,s.b,s.c,s.d,s.e,s.f),this.dirtyBounds.copy(this.backupDirtyBounds).transformWithMatrix(o.getInverse())}this.renderItem(t,e,{drawingCb:function(){var i;n?t.forEachChildren((function(t){e.break||(t.isContainer?r.renderGroup(t,e,o):r.renderItem(t,e))})):Ob(t,Nu.zIndex,(function(t){e.break||(t.isContainer?r.renderGroup(t,e,o):r.renderItem(t,e))}),!1,!!(null===(i=e.context)||void 0===i?void 0:i.camera))}}),this.useDirtyBounds&&(this.dirtyBounds.copy(a),n_.free(a),Ag.free(o))}}}},{key:"_increaseRender",value:function(t,e){var i=e.layer,n=e.stage,r=i.subLayers,a=r.get(t._uid);a||(a={layer:this.layerService.createLayer(n),zIndex:r.size,group:t},r.set(t._uid,a));var o=a.layer.getNativeHandler().getContext(),s=a.drawContribution||Ac.get(C_);s.dirtyBounds.setValue(-1/0,-1/0,1/0,1/0),s.backupDirtyBounds.setValue(-1/0,-1/0,1/0,1/0),s.draw(this.currentRenderService,Object.assign(Object.assign({},e),{drawContribution:s,clear:"transparent",layer:a.layer,context:o,startAtId:t._uid,break:!1})),a.drawContribution=s;var l=this._findNextGraphic(t);if(l)if(l.isContainer&&l.incremental)this._increaseRender(l,e);else{var u=r.get(l._uid);u||(u={layer:this.layerService.createLayer(n),zIndex:r.size},r.set(l._uid,u));var c=u.layer.getNativeHandler().getContext();this.draw(this.currentRenderService,Object.assign(Object.assign({},e),{drawContribution:s,clear:"transparent",layer:u.layer,context:c,startAtId:l._uid,break:!1}))}}},{key:"getRenderContribution",value:function(t){var e;return e||(e=this.selectRenderByNumberType(t.numberType,t)),e||(e=this.selectRenderByType(t.type)),e}},{key:"renderItem",value:function(t,e,i){if(this.InterceptorContributions.length)for(var n=0;n<this.InterceptorContributions.length;n++){var r=this.InterceptorContributions[n];if(r.beforeDrawItem&&r.beforeDrawItem(t,this.currentRenderService,e,this,i))return}var a=this.getRenderContribution(t);if(a){var o,s=this.scrollMatrix&&(0!==this.scrollMatrix.e||0!==this.scrollMatrix.f);if(t.parent){var l=t.parent.attribute,u=l.scrollX,c=void 0===u?0:u,h=l.scrollY,d=void 0===h?0:h;(c||d)&&(s=!0,this.scrollMatrix||(this.scrollMatrix=Ag.allocate(1,0,0,1,0,0)),this.scrollMatrix.translate(-c,-d))}if(s&&(o=this.dirtyBounds.clone().transformWithMatrix(this.scrollMatrix)),!this.useDirtyBounds||t.isContainer||"empty"===t.attribute.boundsMode||Ye(t.AABBBounds,null!=o?o:this.dirtyBounds,!1)){var p=null!=e.startAtId&&t._uid!==e.startAtId;if(t._uid===e.startAtId&&(e.startAtId=null),i&&(i.skipDraw=p),p?t.isContainer&&a.draw(t,this.currentRenderService,e,i):a.draw(t,this.currentRenderService,e,i),s&&t.parent){var f=t.parent.attribute,v=f.scrollX,g=void 0===v?0:v,y=f.scrollY,m=void 0===y?0:y;this.scrollMatrix&&this.scrollMatrix.translate(g,m)}if(this.InterceptorContributions.length)for(var _=0;_<this.InterceptorContributions.length;_++){var b=this.InterceptorContributions[_];if(b.afterDrawItem&&b.afterDrawItem(t,this.currentRenderService,e,this))return}}else if(s&&t.parent){var x=t.parent.attribute,k=x.scrollX,S=void 0===k?0:k,A=x.scrollY,M=void 0===A?0:A;this.scrollMatrix&&this.scrollMatrix.translate(S,M)}}}},{key:"selectRenderByType",value:function(t){return Lt.getInstance().warn("未知错误，不应该走到这里"),null}},{key:"selectRenderByNumberType",value:function(t,e){var i;if(e.attribute.renderStyle){var n=this.styleRenderMap.get(e.attribute.renderStyle);i=n&&n.get(t)}return i||this.currentRenderMap.get(t)||this.defaultRenderMap.get(t)}},{key:"clearScreen",value:function(t,e,i){var n,r,a=i.clear,o=i.viewBox,s=o.width(),l=o.height();if(a){e.clearRect(0,0,s,l);var u=null===(n=t.drawParams)||void 0===n?void 0:n.stage;if(u&&(e.globalAlpha=null!==(r=u.attribute.opacity)&&void 0!==r?r:1),u&&u.backgroundImg&&u.resources){var c=u.resources.get(a);c&&"success"===c.state&&c.data&&e.drawImage(c.data,0,0,s,l)}else e.fillStyle=sc(e,a,{AABBBounds:{x1:0,y1:0,x2:0+s,y2:0+l}},0,0),e.fillRect(0,0,s,l)}}},{key:"afterDraw",value:function(t,e){}}])}();Vb=Hb([js(),Nb(0,Hs(I_)),Nb(1,zs(nl)),Nb(1,Ns(Z_)),jb("design:paramtypes",[Array,Object])],Vb);var Wb=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Gb=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).numberType=uv,t}return h(e,t),o(e,[{key:"drawShape",value:function(t,i,n,r,a,o,s,l){if(t.incremental&&a.multiGraphicOptions){var u=a.multiGraphicOptions,c=u.startAtIdx,h=u.length,d=t.attribute.segments,p=void 0===d?[]:d;if(c>p.length)return;var f=xh(t).line,v=t.attribute,g=v.fill,m=void 0===g?f.fill:g,_=v.stroke,b=void 0===_?f.stroke:_,x=v.opacity,k=void 0===x?f.opacity:x,S=v.fillOpacity,A=void 0===S?f.fillOpacity:S,M=v.strokeOpacity,w=void 0===M?f.strokeOpacity:M,T=v.lineWidth,C=void 0===T?f.lineWidth:T,E=v.visible,P=void 0===E?f.visible:E,R=Kv(k,A,m),B=Zv(k,w),I=Yv(m),L=Xv(b,C);if(!t.valid||!P)return;if(!I&&!L)return;if(!(R||B||s||l))return;for(var D=a.context,O=c;O<c+h;O++)this.drawIncreaseSegment(t,D,p[O-1],p[O],t.attribute.segments[O],[f,t.attribute],n,r)}else y(e,"drawShape",this,3)([t,i,n,r,a,o,s,l])}},{key:"drawIncreaseSegment",value:function(t,e,i,n,r,a,o,s){n&&(e.beginPath(),function(t,e,i,n){var r=n||{},a=r.offsetX,o=void 0===a?0:a,s=r.offsetY,l=void 0===s?0:s,u=e?e.points[e.points.length-1]:i.points[0];t.moveTo(u.x+o,u.y+l),i.points.forEach((function(e){!1!==e.defined?t.lineTo(e.x+o,e.y+l):t.moveTo(e.x+o,e.y+l)}))}(e.nativeContext,i,n,{offsetX:o,offsetY:s}),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,r,a),e.setStrokeStyle(t,r,o,s,a),e.stroke())}}])}(Lm);Gb=Wb([js()],Gb);var Ub=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Yb=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).numberType=rv,t}return h(e,t),o(e,[{key:"drawShape",value:function(t,i,n,r,a,o,s){if(t.incremental&&a.multiGraphicOptions){var l=a.multiGraphicOptions,u=l.startAtIdx,c=l.length,h=t.attribute.segments,d=void 0===h?[]:h;if(u>d.length)return;var p=xh(t).area,f=t.attribute,v=f.fill,g=void 0===v?p.fill:v,m=f.fillOpacity,_=void 0===m?p.fillOpacity:m,b=f.opacity,x=void 0===b?p.opacity:b,k=f.visible,S=void 0===k?p.visible:k,A=Kv(x,_,g),M=Yv(g);if(!t.valid||!S)return;if(!M)return;if(!A&&!s)return;for(var w=u;w<u+c;w++)this.drawIncreaseSegment(t,i,d[w-1],d[w],t.attribute.segments[w],[p,t.attribute],n,r)}else y(e,"drawShape",this,3)([t,i,n,r,a,o,s])}},{key:"drawIncreaseSegment",value:function(t,e,i,n,r,a,o,s){n&&(e.beginPath(),function(t,e,i,n){for(var r=n||{},a=r.offsetX,o=void 0===a?0:a,s=r.offsetY,l=void 0===s?0:s,u=i.points,c=[],h=0;h<u.length;h++)u[h].defined;c.push(u),c.forEach((function(i,n){var r,a,s,u,c=e&&0===n?e.points[e.points.length-1]:i[0];t.moveTo(c.x+o,c.y+l),i.forEach((function(e){!1!==e.defined?t.lineTo(e.x+o,e.y+l):t.moveTo(e.x+o,e.y+l)}));for(var h=i.length-1;h>=0;h--){var d=i[h];t.lineTo(null!==(r=d.x1)&&void 0!==r?r:d.x,null!==(a=d.y1)&&void 0!==a?a:d.y)}t.lineTo(null!==(s=c.x1)&&void 0!==s?s:c.x,null!==(u=c.y1)&&void 0!==u?u:c.y),t.closePath()}))}(e.camera?e:e.nativeContext,i,n,{offsetX:o,offsetY:s}),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,r,a),e.setCommonStyle(t,r,o,s,a),e.fill())}}])}(Nm);Yb=Ub([js()],Yb);var Xb,Kb=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},qb=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Zb=function(t,e){return function(i,n){e(i,n,t)}},Jb=function(t,e,i,n){return new(i||(i=Promise))((function(r,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,s)}l((n=n.apply(t,e||[])).next())}))};!function(t){t[t.NORMAL=0]="NORMAL",t[t.STOP=1]="STOP"}(Xb||(Xb={}));var Qb=function(t){function e(t,i,a,o){var s;return r(this,e),(s=n(this,e,[t,o])).contributions=t,s.lineRender=i,s.areaRender=a,s.drawItemInterceptorContributions=o,s.rendering=!1,s.currFrameStartAt=0,s.currentIdx=0,s.status=Xb.NORMAL,s.checkingForDrawPromise=null,s.hooks={completeDraw:new ll([])},s.defaultRenderMap.set(s.lineRender.numberType,s.lineRender),s.defaultRenderMap.set(s.areaRender.numberType,s.areaRender),s}return h(e,t),o(e,[{key:"draw",value:function(t,e){return Jb(this,void 0,void 0,f().mark((function i(){var n,r,a,o=this;return f().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!this.checkingForDrawPromise){i.next=2;break}return i.abrupt("return");case 2:return this.lastRenderService=t,this.lastDrawContext=e,this.checkingForDrawPromise=this.checkForDraw(e),i.next=5,this.checkingForDrawPromise;case 5:if(n=i.sent,this.checkingForDrawPromise=null,!n){i.next=8;break}return i.abrupt("return");case 8:this.currentRenderService=t,r=e.context,a=e.viewBox,r&&(r.inuse=!0,r.clearMatrix(),r.setTransformForCurrent(!0),r.save(),e.restartIncremental&&this.clearScreen(this.currentRenderService,r,e),r.translate(a.x1,a.y1,!0),r.save(),t.renderTreeRoots.sort((function(t,e){var i,n;return(null!==(i=t.attribute.zIndex)&&void 0!==i?i:Nu.zIndex)-(null!==(n=e.attribute.zIndex)&&void 0!==n?n:Nu.zIndex)})).forEach((function(t){o.renderGroup(t,e)})),this.hooks.completeDraw.tap("top-draw",(function(){r.restore(),r.restore(),r.draw(),r.inuse=!1,o.rendering=!1})));case 11:case"end":return i.stop()}}),i,this)})))}},{key:"_increaseRender",value:function(t,e){return Jb(this,void 0,void 0,f().mark((function i(){return f().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return this.rendering=!0,i.next=3,this._renderIncrementalGroup(t,e);case 3:case"end":return i.stop()}}),i,this)})))}},{key:"_renderIncrementalGroup",value:function(t,e){return Jb(this,void 0,void 0,f().mark((function i(){var n=this;return f().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return this.count=t.count,i.next=3,new Promise((function(i){n.renderItem(t,e,{drawingCb:function(){return Jb(n,void 0,void 0,f().mark((function n(){var r,a=this;return f().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(2===t.count){n.next=6;break}return n.next=3,Fb(t,Nu.zIndex,(function(i,n){if(a.status===Xb.STOP)return!0;if(i.isContainer)return!1;if(n<a.currentIdx)return!1;var r=a.currFrameStartAt+t.incremental;return n<r&&(a.currentIdx=n+1,a.renderItem(i,e)),n===r-1&&(a.currFrameStartAt=a.currentIdx,a.waitToNextFrame())}));case 3:i(!1),n.next=21;break;case 6:if(!(r=t.getChildAt(0)).incremental||!r.attribute.segments){n.next=19;break}r.incrementalAt||(r.incrementalAt=0);case 9:if(!(r.incrementalAt<r.attribute.segments.length)){n.next=17;break}return e.multiGraphicOptions={startAtIdx:r.incrementalAt,length:r.incremental},this.renderItem(r,e),r.incrementalAt+=r.incremental,n.next=15,this.waitToNextFrame();case 15:n.next=9;break;case 17:n.next=20;break;case 19:this.renderItem(r,e);case 20:i(!1);case 21:case"end":return n.stop()}}),n,this)})))}})}));case 3:this.hooks.completeDraw.call();case 4:case"end":return i.stop()}}),i,this)})))}},{key:"waitToNextFrame",value:function(){return Jb(this,void 0,void 0,f().mark((function t(){var e=this;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){e.global.getRequestAnimationFrame()((function(){t(!1)}))})));case 1:case"end":return t.stop()}}),t)})))}},{key:"checkForDraw",value:function(t){return Jb(this,void 0,void 0,f().mark((function e(){var i;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.rendering,e.t0=t.restartIncremental,!e.t0){e.next=7;break}return i=!1,e.next=6,this.forceStop();case 6:this.resetToInit();case 7:return e.abrupt("return",i);case 8:case"end":return e.stop()}}),e,this)})))}},{key:"forceStop",value:function(){return Jb(this,void 0,void 0,f().mark((function t(){var e=this;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=this.rendering,!t.t0){t.next=5;break}return this.status=Xb.STOP,t.next=5,new Promise((function(t){e.hooks.completeDraw.tap("stopCb",(function(){e.status=Xb.NORMAL,e.hooks.completeDraw.taps=e.hooks.completeDraw.taps.filter((function(t){return"stopCb"!==t.name})),t(!1)}))}));case 5:case"end":return t.stop()}}),t,this)})))}},{key:"resetToInit",value:function(){this.currFrameStartAt=0,this.currentIdx=0}},{key:"renderGroup",value:function(t,e){return Jb(this,void 0,void 0,f().mark((function i(){var n=this;return f().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(e.break||!1===t.attribute.visibleAll){i.next=11;break}if(!t.incremental||e.startAtId!==t._uid){i.next=7;break}return i.next=4,this._increaseRender(t,e);case 4:i.t0=void(e.break=!0),i.next=10;break;case 7:return i.next=9,new Promise((function(i){n.renderItem(t,e,{drawingCb:function(){return Jb(n,void 0,void 0,f().mark((function n(){var r=this;return f().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Fb(t,Nu.zIndex,(function(t){return Jb(r,void 0,void 0,f().mark((function i(){return f().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(i.t0=e.break,i.t0){i.next=6;break}if(i.t1=t.isContainer,!i.t1){i.next=6;break}return i.next=6,this.renderGroup(t,e);case 6:case"end":return i.stop()}}),i,this)})))}));case 2:i(!1);case 3:case"end":return n.stop()}}),n)})))}})}));case 9:i.t0=void i.sent;case 10:return i.abrupt("return",i.t0);case 11:case"end":return i.stop()}}),i,this)})))}}])}(Vb);Qb=Kb([js(),Zb(0,Hs(I_)),Zb(1,zs(Gb)),Zb(2,zs(Yb)),Zb(3,zs(nl)),Zb(3,Ns(Z_)),qb("design:paramtypes",[Array,Object,Object,Object])],Qb);var $b=new Ts((function(t){t(Fy).toSelf().inSingletonScope(),t(Wy).toSelf().inSingletonScope(),t(Y_).to(Vb),t(C_).to(Qb),t(L_).to(k_).inSingletonScope(),t(I_).toService(L_),al(t,sg),t(Hy).toSelf().inSingletonScope(),al(t,fg),al(t,I_),t(eb).toSelf().inSingletonScope(),t(Z_).toService(eb),al(t,Z_)}));function tx(){tx.__loaded||(tx.__loaded=!0,Ac.load(Uv),Ac.load(bb),Ac.load(ub),Ac.load(_b),Ac.load(Tb),function(t){t.load(Cb),t.load(Eb),t.load(Ib)}(Ac),function(t){t.load($b)}(Ac))}tx.__loaded=!1,tx();var ex=Ac.get(cl);nc.global=ex;var ix=Ac.get(Fv);nc.graphicUtil=ix;var nx=Ac.get(Ov);nc.transformUtil=nx;var rx=Ac.get(mv);nc.graphicService=rx;var ax=Ac.get(zv);nc.layerService=ax;var ox,sx=function(){return o((function t(){var e=this;r(this,t),this.name="AutoRenderPlugin",this.activeEvent="onRegister",this._uid=ws.GenAutoIncrementId(),this.key=this.name+this._uid,this.handleChange=function(t){t.glyphHost&&(t=t.glyphHost),t.stage===e.pluginService.stage&&null!=t.stage&&t.stage.renderNextFrame()}}),[{key:"activate",value:function(t){this.pluginService=t,nc.graphicService.hooks.onAttributeUpdate.tap(this.key,this.handleChange),nc.graphicService.hooks.onSetStage.tap(this.key,this.handleChange),nc.graphicService.hooks.onRemove.tap(this.key,this.handleChange)}},{key:"deactivate",value:function(t){var e=this,i=function(t){return t.filter((function(t){return t.name!==e.key}))};nc.graphicService.hooks.onAttributeUpdate.taps=i(nc.graphicService.hooks.onAttributeUpdate.taps),nc.graphicService.hooks.onSetStage.taps=i(nc.graphicService.hooks.onSetStage.taps),nc.graphicService.hooks.onRemove.taps=i(nc.graphicService.hooks.onRemove.taps)}}])}(),lx=function(){return o((function t(){var e=this;r(this,t),this.name="AutoRefreshPlugin",this.activeEvent="onRegister",this._uid=ws.GenAutoIncrementId(),this.key=this.name+this._uid,this.handleChange=function(t){t.glyphHost&&(t=t.glyphHost),t.stage===e.pluginService.stage&&null!=t.stage&&t.stage.renderNextFrame()}}),[{key:"activate",value:function(t){this.pluginService=t,this.dpr=nc.global.devicePixelRatio,this.refresh()}},{key:"refresh",value:function(){this._refreshByMediaQuery()||this._refreshByRaf()}},{key:"_refreshByRaf",value:function(){var t=this,e=nc.global.getRequestAnimationFrame();this.rafId=e((function(){nc.global.devicePixelRatio!==t.dpr&&(t.dpr=nc.global.devicePixelRatio,t.pluginService.stage.setDpr(t.dpr,!0)),t.refresh()}))}},{key:"_refreshByMediaQuery",value:function(){var t=this;try{var e="(resolution: ".concat(window.devicePixelRatio,"dppx)"),i=function(){window.devicePixelRatio!==t.dpr&&(t.dpr=window.devicePixelRatio,t.pluginService.stage.setDpr(t.dpr,!0))},n=matchMedia(e);n&&n.addEventListener("change",i),this.autoRefreshCbs||(this.autoRefreshCbs=[]),this.autoRefreshCbs.push((function(){n&&n.removeEventListener("change",i)}))}catch(t){return!1}return!0}},{key:"deactivate",value:function(t){var e,i=nc.global.getCancelAnimationFrame();i&&this.rafId&&i(this.rafId),null===(e=this.autoRefreshCbs)||void 0===e||e.forEach((function(t){t()})),this.autoRefreshCbs=void 0}}])}(),ux=function(){return o((function t(){r(this,t),this.name="IncrementalAutoRenderPlugin",this.activeEvent="onRegister",this.nextFrameRenderGroupSet=new Set,this.willNextFrameRender=!1,this.nextUserParams={},this._uid=ws.GenAutoIncrementId(),this.key=this.name+this._uid}),[{key:"activate",value:function(t){var e=this;this.pluginService=t,nc.graphicService.hooks.onAddIncremental.tap(this.key,(function(i,n,r){i.glyphHost&&(i=i.glyphHost),i.stage===t.stage&&null!=i.stage&&(e.nextUserParams.startAtId=n._uid,e.renderNextFrame(n))})),nc.graphicService.hooks.onClearIncremental.tap(this.key,(function(i,n){i.stage===t.stage&&null!=i.stage&&(e.nextUserParams.startAtId=i._uid,e.nextUserParams.restartIncremental=!0,e.renderNextFrame(i))}))}},{key:"deactivate",value:function(t){var e=this;nc.graphicService.hooks.onAddIncremental.taps=nc.graphicService.hooks.onAddIncremental.taps.filter((function(t){return t.name!==e.key})),nc.graphicService.hooks.onClearIncremental.taps=nc.graphicService.hooks.onClearIncremental.taps.filter((function(t){return t.name!==e.key}))}},{key:"renderNextFrame",value:function(t){var e=this;this.nextFrameRenderGroupSet.add(t),this.willNextFrameRender||(this.willNextFrameRender=!0,nc.global.getRequestAnimationFrame()((function(){e._doRenderInThisFrame(),e.willNextFrameRender=!1})))}},{key:"_doRenderInThisFrame",value:function(){var t=this,e=this.pluginService.stage;this.nextFrameRenderGroupSet.size&&(this.nextFrameRenderGroupSet.forEach((function(i){var n=i.layer;if(n&&i.layer.subLayers){var r=i.layer.subLayers.get(i._uid);r&&r.drawContribution&&r.drawContribution.draw(e.renderService,Object.assign({stage:e,layer:n,viewBox:e.window.getViewBox(),transMatrix:e.window.getViewBoxTransform(),clear:"transparent",renderService:e.renderService,updateBounds:!1,startAtId:i._uid,context:r.layer.getNativeHandler().getContext()},t.nextUserParams))}})),this.nextUserParams={},this.nextFrameRenderGroupSet.clear())}}])}(),cx=new pi,hx=function(){return o((function t(){r(this,t),this.name="DirtyBoundsPlugin",this.activeEvent="onRegister",this._uid=ws.GenAutoIncrementId(),this.key=this.name+this._uid}),[{key:"activate",value:function(t){var e=this;this.pluginService=t,t.stage.hooks.afterRender.tap(this.key,(function(t){t&&t===e.pluginService.stage&&t.dirtyBounds.clear()})),nc.graphicService.hooks.beforeUpdateAABBBounds.tap(this.key,(function(t,i,n,r){t.glyphHost&&(t=t.glyphHost),i&&i===e.pluginService.stage&&i.renderCount&&(t.isContainer&&!t.shouldSelfChangeUpdateAABBBounds()||n&&(cx.setValue(r.x1,r.y1,r.x2,r.y2),i.dirty(cx,t.parent&&t.parent.globalTransMatrix)))})),nc.graphicService.hooks.afterUpdateAABBBounds.tap(this.key,(function(t,i,n,r,a){i&&i===e.pluginService.stage&&i.renderCount&&(t.isContainer&&!a||i.dirty(r.globalAABBBounds))})),nc.graphicService.hooks.clearAABBBounds.tap(this.key,(function(t,i,n){i&&i===e.pluginService.stage&&i.renderCount&&i&&i.dirty(n)})),nc.graphicService.hooks.onRemove.tap(this.key,(function(t){var i=t.stage;i&&i===e.pluginService.stage&&i.renderCount&&i&&i.dirty(t.globalAABBBounds)}))}},{key:"deactivate",value:function(t){var e=this;nc.graphicService.hooks.beforeUpdateAABBBounds.taps=nc.graphicService.hooks.beforeUpdateAABBBounds.taps.filter((function(t){return t.name!==e.key})),nc.graphicService.hooks.afterUpdateAABBBounds.taps=nc.graphicService.hooks.afterUpdateAABBBounds.taps.filter((function(t){return t.name!==e.key})),nc.graphicService.hooks.clearAABBBounds.taps=nc.graphicService.hooks.clearAABBBounds.taps.filter((function(t){return t.name!==e.key})),t.stage.hooks.afterRender.taps=t.stage.hooks.afterRender.taps.filter((function(t){return t.name!==e.key})),nc.graphicService.hooks.onRemove.taps=nc.graphicService.hooks.onRemove.taps.filter((function(t){return t.name!==e.key}))}}])}(),dx=new zh;function px(){!function(){if(null==ox)try{var t=document.createElement("canvas"),e=t.getContext("2d");(ox=!!(window&&t.getBoundingClientRect&&requestAnimationFrame&&window.devicePixelRatio&&e&&e.isPointInPath&&e.isPointInStroke))&&(ox=!!document.createElement)}catch(t){ox=!1}}();var t=nc.global&&nc.global.env;return t?"browser"===t:ox}dx.addTimeline(Uh),dx.setFPS(60);var fx=function(){function t(){r(this,t)}return o(t,null,[{key:"registerPlugin",value:function(e,i){t._pluginClasses[e]=i}},{key:"getPlugin",value:function(e){return t._pluginClasses[e]}}])}();fx._pluginClasses={};var vx="white",gx=function(t){function e(){var t,a,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r(this,e),(t=n(this,e,[{}])).tickedBeforeRender=!0,t._onVisibleChange=function(e){if(!(t._skipRender<0))if(e){if(t.dirtyBounds){var i=t.window.getViewBox();t.dirtyBounds.setValue(i.x1,i.y1,i.width(),i.height())}t._skipRender>1&&t.renderNextFrame(),t._skipRender=0}else t._skipRender=1},t.beforeRender=function(e){t._beforeRender&&t._beforeRender(e)},t.afterRender=function(e){t.renderCount++,t._afterRender&&t._afterRender(e),t._afterNextRenderCbs&&t._afterNextRenderCbs.forEach((function(t){return t(e)})),t._afterNextRenderCbs=null,t.tickedBeforeRender=!1},t.afterTickCb=function(){var e;t.tickedBeforeRender=!0,"performance"===(null===(e=t.params.optimize)||void 0===e?void 0:e.tickRenderMode)||"rendering"!==t.state&&t.render()},t.params=o,t.theme=new _h,t.hooks={beforeRender:new ll(["stage"]),afterRender:new ll(["stage"])},t.global=nc.global,!t.global.env&&px()&&t.global.setEnv("browser"),t.window=Ac.get(ah),t.renderService=Ac.get(sb),t.pluginService=Ac.get(kb),t.layerService=Ac.get(zv),t.pluginService.active(i(t),o),t.window.create({width:o.width,height:o.height,viewBox:o.viewBox,container:o.container,dpr:o.dpr||t.global.devicePixelRatio,canvasControled:!1!==o.canvasControled,title:o.title||"",canvas:o.canvas}),t.state="normal",t.renderCount=0,t.tryInitEventSystem(),t._background=null!==(a=o.background)&&void 0!==a?a:vx,t.appendChild(t.layerService.createLayer(i(t),{main:!0})),t.nextFrameRenderLayerSet=new Set,t.willNextFrameRender=!1,t.stage=i(t),t.renderStyle=o.renderStyle,o.autoRender&&t.enableAutoRender(),o.autoRefresh&&t.enableAutoRefresh(),!1===o.disableDirtyBounds&&t.enableDirtyBounds(),o.enableHtmlAttribute&&t.enableHtmlAttribute(o.enableHtmlAttribute),o.ReactDOM&&t.enableReactAttribute(o.ReactDOM),o.enableLayout&&t.enableLayout(),t.hooks.beforeRender.tap("constructor",t.beforeRender),t.hooks.afterRender.tap("constructor",t.afterRender),t._beforeRender=o.beforeRender,t._afterRender=o.afterRender,t.ticker=o.ticker||dx,t.supportInteractiveLayer=!1!==o.interactiveLayer,t.timeline=new Gh,t.ticker.addTimeline(t.timeline),t.timeline.pause(),o.optimize||(o.optimize={}),t.optmize(o.optimize),o.background&&Y(t._background)&&t._background.includes("/")&&t.setAttributes({background:t._background}),t.ticker.on("afterTick",t.afterTickCb),t}return h(e,t),o(e,[{key:"viewBox",get:function(){return this.window.getViewBox()},set:function(t){this.window.setViewBox(t)}},{key:"x",get:function(){return this.window.getViewBox().x1},set:function(t){var e=this.window.getViewBox();e.translate(t-e.x1,0),this.window.setViewBox(e)}},{key:"y",get:function(){return this.window.getViewBox().y1},set:function(t){var e=this.window.getViewBox();e.translate(0,t-e.y1),this.window.setViewBox(e)}},{key:"width",get:function(){return this.window.width},set:function(t){this.resize(t,this.height)}},{key:"viewWidth",get:function(){return this.window.getViewBox().width()},set:function(t){this.resizeView(t,this.viewHeight)}},{key:"viewHeight",get:function(){return this.window.getViewBox().height()},set:function(t){this.resizeView(this.viewWidth,t)}},{key:"height",get:function(){return this.window.height},set:function(t){this.resize(this.width,t)}},{key:"dpr",get:function(){return this.window.dpr},set:function(t){this.setDpr(t)}},{key:"background",get:function(){var t;return null!==(t=this._background)&&void 0!==t?t:vx},set:function(t){this._background=t}},{key:"defaultLayer",get:function(){return this.at(0)}},{key:"eventSystem",get:function(){return this._eventSystem}},{key:"pauseRender",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;this._skipRender=t}},{key:"resumeRender",value:function(){this._skipRender=0}},{key:"tryInitEventSystem",value:function(){this.global.supportEvent&&!this._eventSystem&&(this._eventSystem=new Dh(Object.assign({targetElement:this.window,resolution:this.window.dpr||this.global.devicePixelRatio,rootNode:this,global:this.global,supportsPointerEvents:this.params.supportsPointerEvents,supportsTouchEvents:this.params.supportsTouchEvents},this.params.event)))}},{key:"preventRender",value:function(t){t?this._skipRender=-1/0:!1!==this.params.optimize.skipRenderWithOutRange?this._skipRender=this.window.isVisible()?0:1:this._skipRender=0}},{key:"optmize",value:function(t){this.optmizeRender(t.skipRenderWithOutRange),this.params.optimize=t}},{key:"optmizeRender",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&(this._skipRender=this._skipRender<0?this._skipRender:this.window.isVisible()?0:1,this.window.onVisibleChange(this._onVisibleChange))}},{key:"getTimeline",value:function(){return this.timeline}},{key:"get3dOptions",value:function(t){var e=t.center,i=void 0===e?{x:this.width/2,y:this.height/2,z:0,dx:0,dy:0,dz:0}:e,n=t.light,r=void 0===n?{}:n,a=t.alpha,o=void 0===a?0:a,s=t.beta,l=void 0===s?0:s,u=t.camera,c=t.fieldRatio,h=void 0===c?1:c,d=t.fieldDepth;return Object.assign(Object.assign({},t),{center:i,light:r,alpha:o,beta:l,camera:u,fieldRatio:h,fieldDepth:d})}},{key:"set3dOptions",value:function(t){var e,i,n,r,a,o;this.option3d=t;var s=this.get3dOptions(t),l=s.light,u=s.center,c=s.camera,h=s.alpha,d=s.beta,p=s.fieldRatio,f=s.fieldDepth,v=l.dir,g=void 0===v?[1,1,-1]:v,y=l.color,m=void 0===y?"white":y,_=l.ambient,b=(null!==(e=u.x)&&void 0!==e?e:this.width/2)+(null!==(i=u.dx)&&void 0!==i?i:0),x=(null!==(n=u.y)&&void 0!==n?n:this.height/2)+(null!==(r=u.dy)&&void 0!==r?r:0),k=[b,x,(null!==(a=u.z)&&void 0!==a?a:0)+(null!==(o=u.dz)&&void 0!==o?o:0)],S=0,A=0,M=0;c||(S=Math.sin(h)+b,A=Math.sin(d)+x,M=Math.cos(h)*Math.cos(d)*1);var w=fx.getPlugin("DirectionalLight");w&&(this.light=new w(g,m,_));var T={left:0,right:this.width,top:0,bottom:this.height,fieldRatio:p,fieldDepth:f,viewParams:{pos:[S,A,M],center:k,up:[0,1,0]}};if(this.camera)this.camera.params=T;else{var C=fx.getPlugin("OrthoCamera");C&&(this.camera=new C(T))}t.enableView3dTransform&&this.enableView3dTransform()}},{key:"setBeforeRender",value:function(t){this._beforeRender=t}},{key:"setAfterRender",value:function(t){this._afterRender=t}},{key:"afterNextRender",value:function(t){this._afterNextRenderCbs||(this._afterNextRenderCbs=[]),this._afterNextRenderCbs.push(t)}},{key:"enableView3dTransform",value:function(){if(!this.view3dTranform){this.view3dTranform=!0;var t=fx.getPlugin("ViewTransform3dPlugin");t&&this.pluginService.register(new t)}}},{key:"disableView3dTranform",value:function(){var t=this;this.view3dTranform&&(this.view3dTranform=!1,this.pluginService.findPluginsByName("ViewTransform3dPlugin").forEach((function(e){t.pluginService.unRegister(e)})))}},{key:"enableAutoRender",value:function(){this.autoRender||(this.autoRender=!0,this.pluginService.register(new sx))}},{key:"disableAutoRender",value:function(){var t=this;this.autoRender&&(this.autoRender=!1,this.pluginService.findPluginsByName("AutoRenderPlugin").forEach((function(e){t.pluginService.unRegister(e)})))}},{key:"enableAutoRefresh",value:function(){this.autoRefresh||(this.autoRefresh=!0,this.pluginService.register(new lx))}},{key:"disableAutoRefresh",value:function(){var t=this;this.autoRefresh&&(this.autoRefresh=!1,this.pluginService.findPluginsByName("AutoRefreshPlugin").forEach((function(e){t.pluginService.unRegister(e)})))}},{key:"enableIncrementalAutoRender",value:function(){this.increaseAutoRender||(this.increaseAutoRender=!0,this.pluginService.register(new ux))}},{key:"disableIncrementalAutoRender",value:function(){var t=this;this.increaseAutoRender&&(this.increaseAutoRender=!1,this.pluginService.findPluginsByName("IncrementalAutoRenderPlugin").forEach((function(e){t.pluginService.unRegister(e)})))}},{key:"enableDirtyBounds",value:function(){if(!this.dirtyBounds){this.dirtyBounds=new di;var t=this.pluginService.findPluginsByName("DirtyBoundsPlugin")[0];t?t.activate(this.pluginService):(t=new hx,this.pluginService.register(t))}}},{key:"disableDirtyBounds",value:function(){var t=this;this.dirtyBounds&&(this.dirtyBounds=null,this.pluginService.findPluginsByName("DirtyBoundsPlugin").forEach((function(e){t.pluginService.unRegister(e)})))}},{key:"enableLayout",value:function(){if(!this._enableLayout){this._enableLayout=!0;var t=fx.getPlugin("FlexLayoutPlugin");t&&this.pluginService.register(new t)}}},{key:"disableLayout",value:function(){var t=this;this._enableLayout&&(this._enableLayout=!1,this.pluginService.findPluginsByName("FlexLayoutPlugin").forEach((function(e){t.pluginService.unRegister(e)})))}},{key:"enableHtmlAttribute",value:function(t){if(!this.htmlAttribute){var e=fx.getPlugin("HtmlAttributePlugin");e&&(this.htmlAttribute=t,this.pluginService.register(new e))}}},{key:"disableHtmlAttribute",value:function(){var t=this;this.htmlAttribute&&(this.htmlAttribute=!1,this.pluginService.findPluginsByName("HtmlAttributePlugin").forEach((function(e){t.pluginService.unRegister(e)})))}},{key:"enableReactAttribute",value:function(t){if(!this.reactAttribute){var e=fx.getPlugin("ReactAttributePlugin");e&&(this.reactAttribute=t,this.pluginService.register(new e))}}},{key:"disableReactAttribute",value:function(){var t=this;this.reactAttribute&&(this.reactAttribute=!1,this.pluginService.findPluginsByName("ReactAttributePlugin").forEach((function(e){t.pluginService.unRegister(e)})))}},{key:"getPluginsByName",value:function(t){return this.pluginService.findPluginsByName(t)}},{key:"tryUpdateAABBBounds",value:function(){var t=this.window.getViewBox();return this._AABBBounds.setValue(t.x1,t.y1,t.x2,t.y2),this._AABBBounds}},{key:"combineLayer",value:function(t,e){throw new Error("暂不支持")}},{key:"createLayer",value:function(t,e){if("released"!==this.releaseStatus){var i=this.layerService.createLayer(this,{main:!1,layerMode:e,canvasId:t});return this.appendChild(i),i}}},{key:"sortLayer",value:function(t){var e=this,i=this.children;i.sort(t),this.removeAllChild(),i.forEach((function(t){e.appendChild(t)}))}},{key:"removeLayer",value:function(t){return this.removeChild(this.findChildByUid(t))}},{key:"tryInitInteractiveLayer",value:function(){"released"!==this.releaseStatus&&this.supportInteractiveLayer&&!this.interactiveLayer&&(this.interactiveLayer=this.createLayer(),this.interactiveLayer.name="_builtin_interactive",this.interactiveLayer.attribute.pickable=!1,this.nextFrameRenderLayerSet.add(this.interactiveLayer))}},{key:"clearViewBox",value:function(t){this.window.clearViewBox(t)}},{key:"render",value:function(t,e){if("released"!==this.releaseStatus){this.ticker.start(),this.timeline.resume();var i=this.state;this.state="rendering",this.tickedBeforeRender||this.ticker.trySyncTickStatus(),this.layerService.prepareStageLayer(this),this._skipRender||(this.lastRenderparams=e,this.hooks.beforeRender.call(this),this._skipRender||(this.renderLayerList(this.children),this.combineLayersToWindow(),this.nextFrameRenderLayerSet.clear()),this.hooks.afterRender.call(this)),this.state=i,this._skipRender&&this._skipRender++}}},{key:"combineLayersToWindow",value:function(){if("harmony"===this.global.env){var t=this.window.getContext().nativeContext;this.forEachChildren((function(e,i){if(i>0){var n=e.getNativeHandler().getContext().canvas.nativeCanvas.nativeCanvas._c.transferToImageBitmap();t.transferFromImageBitmap(n)}}))}}},{key:"renderNextFrame",value:function(t,e){var i=this;this.nextFrameRenderLayerSet.size!==this.childrenCount&&(t||this).forEach((function(t){i.nextFrameRenderLayerSet.add(t)})),this.willNextFrameRender||(this.willNextFrameRender=!0,this.global.getRequestAnimationFrame()((function(){i._doRenderInThisFrame(),i.willNextFrameRender=!1})))}},{key:"_doRenderInThisFrame",value:function(){if("released"!==this.releaseStatus){this.timeline.resume(),this.ticker.start();var t=this.state;this.state="rendering",this.layerService.prepareStageLayer(this),this.nextFrameRenderLayerSet.size&&!this._skipRender&&(this.hooks.beforeRender.call(this),this._skipRender||(this.renderLayerList(Array.from(this.nextFrameRenderLayerSet.values()),this.lastRenderparams||{}),this.combineLayersToWindow(),this.nextFrameRenderLayerSet.clear()),this.hooks.afterRender.call(this)),this.state=t,this._skipRender&&this._skipRender++}}},{key:"renderLayerList",value:function(t,e){for(var i=this,n=[],r=0;r<t.length;r++){var a=t[r];"virtual"===a.layerMode&&(a=a.getNativeHandler().mainHandler.layer),n.includes(a)||n.push(a)}n.forEach((function(t){t.renderCount>i.renderCount||(t.renderCount=i.renderCount+1,t===i.interactiveLayer&&i.dirtyBounds&&i.dirtyBounds.clear(),t.render({renderService:i.renderService,background:t===i.defaultLayer?i.background:void 0,updateBounds:!(!i.dirtyBounds||i.dirtyBounds.empty()),viewBox:i.window.getViewBox(),transMatrix:i.window.getViewBoxTransform()},Object.assign({renderStyle:i.renderStyle},e)))})),this.interactiveLayer&&!t.includes(this.interactiveLayer)&&(this.dirtyBounds&&this.dirtyBounds.clear(),this.interactiveLayer.render({renderService:this.renderService,updateBounds:!(!this.dirtyBounds||this.dirtyBounds.empty()),viewBox:this.window.getViewBox(),transMatrix:this.window.getViewBoxTransform()},Object.assign({renderStyle:this.renderStyle},e)))}},{key:"resizeWindow",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.window.resize(t,e),i&&this.render()}},{key:"resize",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];"released"!==this.releaseStatus&&(this.window.hasSubView()||this.viewBox.setValue(this.viewBox.x1,this.viewBox.y1,this.viewBox.x1+t,this.viewBox.y1+e),this.window.resize(t,e),this.forEachChildren((function(i){i.resize(t,e)})),this.camera&&this.option3d&&this.set3dOptions(this.option3d),i&&this.render())}},{key:"resizeView",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];"released"!==this.releaseStatus&&(this.viewBox.setValue(this.viewBox.x1,this.viewBox.y1,this.viewBox.x1+t,this.viewBox.y1+e),this.forEachChildren((function(i){i.resizeView(t,e)})),this.camera&&(this.camera.params=Object.assign(Object.assign({},this.camera.params),{right:this.width,bottom:this.height})),i&&this.render())}},{key:"setViewBox",value:function(t,e,i,n,r){var a=this,o=!0;"object"==b(t)?(this.viewBox.setValue(t.x1,t.y1,t.x2,t.y2),!1===e&&(o=!1)):(this.viewBox.setValue(t,e,t+i,e+n),!1===r&&(o=!1)),this.forEachChildren((function(t){t.resizeView(a.viewBox.width(),a.viewBox.height())})),o&&this.render()}},{key:"setDpr",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.forEachChildren((function(e){e.setDpr(t)})),e&&this.render()}},{key:"setOrigin",value:function(t,e){throw new Error("暂不支持")}},{key:"export",value:function(t){throw new Error("暂不支持")}},{key:"pick",value:function(t,e){if("released"!==this.releaseStatus){var i=this.getPickerService().pick(this.children,new Ae(t,e),{bounds:this.AABBBounds});return!(!(null==i?void 0:i.graphic)&&!(null==i?void 0:i.group))&&i}}},{key:"startAnimate",value:function(t){throw new Error("暂不支持")}},{key:"setToFrame",value:function(t){throw new Error("暂不支持")}},{key:"release",value:function(){var t=this;y(e,"release",this,3)([]),this.hooks.beforeRender.unTap("constructor",this.beforeRender),this.hooks.afterRender.unTap("constructor",this.afterRender),this.eventSystem&&this.eventSystem.release(),this.layerService.releaseStage(this),this.pluginService.release(),this.forEach((function(t){t.release()})),this.interactiveLayer&&(this.interactiveLayer.forEachChildren((function(e){e.setStage&&e.setStage(null,null),t.interactiveLayer.removeChild(e)})),this.interactiveLayer.release()),this.window.release(),this.ticker.remTimeline(this.timeline),this.ticker.removeListener("afterTick",this.afterTickCb),this.renderService.renderTreeRoots=[]}},{key:"setStage",value:function(t){}},{key:"dirty",value:function(t,e){"released"!==this.releaseStatus&&(e&&t.transformWithMatrix(e),this.dirtyBounds.empty()&&this.dirtyBounds.setValue(t.x1,t.y1,t.x2,t.y2),this.dirtyBounds.union(t))}},{key:"getLayer",value:function(t){return this.children.filter((function(e){return e.name===t}))[0]}},{key:"renderTo",value:function(t){var e=this;"released"!==this.releaseStatus&&this.forEachChildren((function(i,n){i.drawTo(t,{renderService:e.renderService,viewBox:t.getViewBox(),transMatrix:t.getViewBoxTransform(),background:i===e.defaultLayer?e.background:void 0,clear:0===n,updateBounds:!(!e.dirtyBounds||e.dirtyBounds.empty())})}))}},{key:"renderToNewWindow",value:function(){var t=arguments.length>1?arguments[1]:void 0;if("released"!==this.releaseStatus){var e=Ac.get(ah),i=t?-t.x1:0,n=t?-t.y1:0,r=t?t.x2:this.viewWidth,a=t?t.y2:this.viewHeight,o=t?t.width():this.viewWidth,s=t?t.height():this.viewHeight;return e.create({viewBox:{x1:i,y1:n,x2:r,y2:a},width:o,height:s,dpr:this.window.dpr,canvasControled:!0,offscreen:!0,title:""}),this.renderTo(e),e}}},{key:"toCanvas",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1?arguments[1]:void 0;if("released"!==this.releaseStatus){var i=this.renderToNewWindow(t,e).getNativeHandler();return i.nativeCanvas?i.nativeCanvas:null}}},{key:"setCursor",value:function(t){this._cursor=t,this.eventSystem.setCursor(t,"ignore")}},{key:"getCursor",value:function(){return this._cursor}},{key:"eventPointTransform",value:function(t){var e=this.global.mapToCanvasPoint(t,this.window.getContext().canvas.nativeCanvas);return this.stage.window.pointTransform(e.x,e.y)}},{key:"pauseTriggerEvent",value:function(){this._eventSystem&&this._eventSystem.pauseTriggerEvent()}},{key:"resumeTriggerEvent",value:function(){this._eventSystem&&this._eventSystem.resumeTriggerEvent()}},{key:"getPickerService",value:function(){return this.pickerService||(this.pickerService=Ac.get(cb)),this.pickerService}}])}(Bv);var yx=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},mx=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},_x=new vi(1,0,0,1,0,0),bx={x:0,y:0},xx=function(){return o((function t(e,i){r(this,t),this.matrix=new vi(1,0,0,1,0,0),this.stack=[],this.dpr=i,this.applyedMatrix=new vi(1,0,0,1,0,0),this.path=new Ru,this._clearMatrix=new vi(1,0,0,1,0,0)}),[{key:"nativeContext",get:function(){return this.path}},{key:"getCanvas",value:function(){throw new Error("不支持getCanvas")}},{key:"getContext",value:function(){throw new Error("不支持getContext")}},{key:"setTransformForCurrent",value:function(){!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&this.applyedMatrix.equalToMatrix(this.matrix)||(this.applyedMatrix=this.cloneMatrix(this.matrix))}},{key:"currentMatrix",get:function(){return this.matrix}},{key:"cloneMatrix",value:function(t){return Ag.allocateByObj(t)}},{key:"clear",value:function(){this.save(),this.resetTransform(),this.restore()}},{key:"restore",value:function(){this.stack.length>0&&(Ag.free(this.matrix),this.matrix=this.stack.pop(),this.setTransformForCurrent())}},{key:"highPerformanceRestore",value:function(){this.stack.length>0&&(Ag.free(this.matrix),this.matrix=this.stack.pop())}},{key:"rotate",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.matrix.rotate(t),e&&this.setTransformForCurrent()}},{key:"save",value:function(){var t=this.cloneMatrix(this.matrix);this.stack.push(t)}},{key:"highPerformanceSave",value:function(){var t=this.cloneMatrix(this.matrix);this.stack.push(t)}},{key:"scale",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.matrix.scale(t,e),i&&this.setTransformForCurrent()}},{key:"setScale",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.matrix.setScale(t,e),i&&this.setTransformForCurrent()}},{key:"scalePoint",value:function(t,e,i,n){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];this.translate(i,n,!1),this.scale(t,e,!1),this.translate(-i,-n,!1),r&&this.setTransformForCurrent()}},{key:"setTransform",value:function(t,e,i,n,r,a){var o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:this.dpr;this.matrix.setValue(s*t,s*e,s*i,s*n,s*r,s*a),o&&this.setTransformForCurrent()}},{key:"setTransformFromMatrix",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.dpr;this.matrix.setValue(t.a*i,t.b*i,t.c*i,t.d*i,t.e*i,t.f*i),e&&this.setTransformForCurrent()}},{key:"resetTransform",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.dpr;this.setTransform(e,0,0,e,0,0),t&&this.setTransformForCurrent()}},{key:"transform",value:function(t,e,i,n,r,a){var o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];this.matrix.multiply(t,e,i,n,r,a),o&&this.setTransformForCurrent()}},{key:"transformFromMatrix",value:function(t,e){this.matrix.multiply(t.a,t.b,t.c,t.d,t.e,t.f),e&&this.setTransformForCurrent()}},{key:"translate",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.matrix.translate(t,e),i&&this.setTransformForCurrent()}},{key:"rotateDegrees",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=t*Math.PI/180;this.rotate(i,e)}},{key:"rotateAbout",value:function(t,e,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.translate(e,i,!1),this.rotate(t,!1),this.translate(-e,-i,!1),n&&this.setTransformForCurrent()}},{key:"rotateDegreesAbout",value:function(t,e,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.translate(e,i,!1),this.rotateDegrees(t,!1),this.translate(-e,-i,!1),n&&this.setTransformForCurrent()}},{key:"beginPath",value:function(){this.path.clear()}},{key:"clip",value:function(t,e){}},{key:"arc",value:function(t,e,i,n,r,a){this.path.arc(t,e,i,n,r,a)}},{key:"arcTo",value:function(t,e,i,n,r){this.path.arcTo(t,e,i,n,r)}},{key:"bezierCurveTo",value:function(t,e,i,n,r,a){this.path.bezierCurveTo(t,e,i,n,r,a)}},{key:"closePath",value:function(){this.path.closePath()}},{key:"ellipse",value:function(t,e,i,n,r,a,o,s){}},{key:"lineTo",value:function(t,e){this.path.lineTo(t,e)}},{key:"moveTo",value:function(t,e){this.path.moveTo(t,e)}},{key:"quadraticCurveTo",value:function(t,e,i,n){this.path.quadraticCurveTo(t,e,i,n)}},{key:"rect",value:function(t,e,i,n){this.path.rect(t,e,i,n)}},{key:"createImageData",value:function(t,e){return null}},{key:"createLinearGradient",value:function(t,e,i,n){throw new Error("不支持createLinearGradient")}},{key:"createPattern",value:function(t,e){throw new Error("不支持createPattern")}},{key:"createRadialGradient",value:function(t,e,i,n,r,a){throw new Error("不支持createRadialGradient")}},{key:"createConicGradient",value:function(t,e,i,n){return null}},{key:"fill",value:function(t,e){}},{key:"fillRect",value:function(t,e,i,n){this.path.rect(t,e,i,n)}},{key:"clearRect",value:function(t,e,i,n){}},{key:"fillText",value:function(t,e,i){}},{key:"getImageData",value:function(t,e,i,n){return null}},{key:"getLineDash",value:function(){return[]}},{key:"isPointInPath",value:function(t,e){return this.matrix.transformPoint({x:t,y:e},bx),function(t,e,i){return th(t,0,!1,e,i)}(this.path.commandList,bx.x,bx.y)}},{key:"isPointInStroke",value:function(t,e){if(!this.lineWidth)return!1;this.matrix.transformPoint({x:t,y:e},bx);var i=oc(this,this.lineWidth,this.dpr);return function(t,e,i,n){return th(t,e,!0,i,n)}(this.path.commandList,i,bx.x,bx.y)}},{key:"measureText",value:function(t){throw new Error("不支持measureText")}},{key:"putImageData",value:function(t,e,i){throw new Error("不支持measureText")}},{key:"setLineDash",value:function(t){}},{key:"stroke",value:function(t){}},{key:"strokeRect",value:function(t,e,i,n){this.path.rect(t,e,i,n)}},{key:"strokeText",value:function(t,e,i){}},{key:"drawImage",value:function(){}},{key:"setCommonStyle",value:function(t,e,i,n,r){}},{key:"_setCommonStyle",value:function(t,e,i,n){}},{key:"setStrokeStyle",value:function(t,e,i,n,r){}},{key:"_setStrokeStyle",value:function(t,e,i,n){}},{key:"setTextStyleWithoutAlignBaseline",value:function(t,e){}},{key:"setTextStyle",value:function(t,e){}},{key:"draw",value:function(){}},{key:"clearMatrix",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.dpr;this.setTransformFromMatrix(_x,t,e)}},{key:"setClearMatrix",value:function(t,e,i,n,r,a){this._clearMatrix.setValue(t,e,i,n,r,a)}},{key:"onlyTranslate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.dpr;return this.matrix.a===t&&0===this.matrix.b&&0===this.matrix.c&&this.matrix.d===t}},{key:"release",value:function(){this.stack.forEach((function(t){return Ag.free(t)})),this.stack.length=0}}])}();xx=yx([js(),mx("design:paramtypes",[Object,Number])],xx);var kx=500,Sx=500,Ax=1,Mx=function(){return o((function t(e){var i;r(this,t);var n=e.nativeCanvas,a=e.width,o=void 0===a?kx:a,s=e.height,l=void 0===s?Sx:s,u=e.dpr,c=void 0===u?Ax:u,h=e.x,d=e.y,p=e.id,f=e.canvasControled,v=void 0===f||f;this._x=null!=h?h:0,this._y=null!=d?d:0,this._pixelWidth=o*c,this._pixelHeight=l*c,this._visiable=!1!==e.visiable,this.controled=v,this._displayWidth=o,this._displayHeight=l,this._dpr=c,this._nativeCanvas=n,this._id=null!==(i=n.id)&&void 0!==i?i:p,p&&(n.id=p),this.init(e)}),[{key:"displayWidth",get:function(){return this._pixelWidth/this._dpr}},{key:"displayHeight",get:function(){return this._pixelHeight/this._dpr}},{key:"id",get:function(){return this._id}},{key:"x",get:function(){return this._x},set:function(t){this._x=t}},{key:"y",get:function(){return this._y},set:function(t){this._y=t}},{key:"nativeCanvas",get:function(){return this._nativeCanvas},set:function(t){this._nativeCanvas=t}},{key:"width",get:function(){return this._pixelWidth},set:function(t){this._pixelWidth=t,this._displayWidth=t/(this._dpr||1)}},{key:"height",get:function(){return this._pixelHeight},set:function(t){this._pixelHeight=t,this._displayHeight=t/(this._dpr||1)}},{key:"getContext",value:function(t){return this._context}},{key:"visiable",get:function(){return this._visiable},set:function(t){this._visiable=t,t?this.show():this.hide()}},{key:"dpr",get:function(){return this._dpr},set:function(t){this._dpr=t,this.resize(this._displayWidth,this._displayHeight)}},{key:"getNativeCanvas",value:function(){return this._nativeCanvas}},{key:"hide",value:function(){}},{key:"show",value:function(){}},{key:"applyPosition",value:function(){}},{key:"resetStyle",value:function(t){}},{key:"resize",value:function(t,e){}},{key:"toDataURL",value:function(t,e){return""}},{key:"readPixels",value:function(t,e,i,n){return this._context.getImageData(t,e,i,n)}},{key:"convertToBlob",value:function(t){throw new Error("暂未实现")}},{key:"transferToImageBitmap",value:function(){throw new Error("暂未实现")}},{key:"release",value:function(){this.controled&&this._nativeCanvas.parentElement&&this._nativeCanvas.parentElement.removeChild(this._nativeCanvas)}}])}();Mx.env="browser";var Tx=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Cx=function(t,e,i,n){return new(i||(i=Promise))((function(r,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,s)}l((n=n.apply(t,e||[])).next())}))},Ex=function(){return o((function t(){r(this,t)}),[{key:"configure",value:function(t){t.env===this.type&&t.setActiveEnvContribution(this)}},{key:"getNativeAABBBounds",value:function(t){return new pi}},{key:"removeDom",value:function(t){return!1}},{key:"createDom",value:function(t){return null}},{key:"updateDom",value:function(t,e){return!1}},{key:"getDynamicCanvasCount",value:function(){return 999}},{key:"getStaticCanvasCount",value:function(){return 999}},{key:"getElementById",value:function(t){return document.getElementById(t)}},{key:"getRootElement",value:function(){return document.body}},{key:"loadJson",value:function(t){var e=fetch(t).then((function(t){return t.json()}));return e.then((function(t){return{data:t,state:"success"}})).catch((function(){return{data:null,state:"fail"}})),e}},{key:"loadArrayBuffer",value:function(t){return fetch(t).then((function(t){return t.arrayBuffer()})).then((function(t){return{data:t,loadState:"success"}})).catch((function(){return{data:null,loadState:"fail"}}))}},{key:"loadBlob",value:function(t){return fetch(t).then((function(t){return t.blob()})).then((function(t){return{data:t,loadState:"success"}})).catch((function(){return{data:null,loadState:"fail"}}))}},{key:"getElementTop",value:function(t,e){return 0}},{key:"getElementLeft",value:function(t,e){return 0}},{key:"getElementTopLeft",value:function(t,e){return{top:0,left:0}}},{key:"loadFont",value:function(t,e,i){return Cx(this,void 0,void 0,f().mark((function t(){return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{loadState:"fail"});case 1:case"end":return t.stop()}}),t)})))}},{key:"isMacOS",value:function(){return!1}},{key:"copyToClipBoard",value:function(t){return Promise.resolve(null)}}])}();Ex=Tx([js()],Ex);var Px=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Rx=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Bx=function(){return o((function t(){r(this,t),this._uid=ws.GenAutoIncrementId(),this.viewBox=new pi,this.modelMatrix=new vi(1,0,0,1,0,0)}),[{key:"onChange",value:function(t){this._onChangeCb=t}},{key:"configure",value:function(t,e){e.env===this.type&&t.setWindowHandler(this)}},{key:"release",value:function(){this.releaseWindow()}},{key:"isVisible",value:function(t){return!0}},{key:"onVisibleChange",value:function(t){}},{key:"getTopLeft",value:function(t){return{top:0,left:0}}},{key:"setViewBox",value:function(t){this.viewBox.setValue(t.x1,t.y1,t.x2,t.y2)}},{key:"getViewBox",value:function(){return this.viewBox}},{key:"setViewBoxTransform",value:function(t,e,i,n,r,a){this.modelMatrix.setValue(t,e,i,n,r,a)}},{key:"getViewBoxTransform",value:function(){return this.modelMatrix}}])}();Bx=Px([js(),Rx("design:paramtypes",[])],Bx);var Ix=function(){return o((function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.8;r(this,t),this.dir=e,this.color=i,this.colorRgb=Nd.Get(i,Fd.Color1),this.ambient=n;var a=fe(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);this.formatedDir=[e[0]/a,e[1]/a,e[2]/a]}),[{key:"computeColor",value:function(t,e){var i,n=this.formatedDir,r=de(he((t[0]*n[0]+t[1]*n[1]+t[2]*n[2])*(1-this.ambient/2),0)+this.ambient,1);i=Y(e)?Nd.Get(e,Fd.Color1):e;var a=this.colorRgb;return"rgb(".concat(a[0]*i[0]*r,", ").concat(a[1]*i[1]*r,", ").concat(a[2]*i[2]*r,")")}}])}(),Lx=function(){fx.registerPlugin("DirectionalLight",Ix)},Dx=function(){return o((function t(e){r(this,t),this.params=e}),[{key:"params",get:function(){return Object.assign({},this._params)},set:function(t){this._params=Object.assign({},t),this._projectionMatrixCached=this.forceGetProjectionMatrix(),this._viewMatrixCached=this.forceGetViewMatrix()}},{key:"getViewMatrix",value:function(){return this._viewMatrixCached||(this._viewMatrixCached=Mg.allocate()),this._viewMatrixCached}},{key:"forceGetViewMatrix",value:function(){this._viewMatrixCached||(this._viewMatrixCached=Mg.allocate());var t=this.params.viewParams,e=t.pos,i=t.center,n=t.up;return function(t,e,i,n){var r,a,o,s,l,u,c,h,d,p,f=e[0],v=e[1],g=e[2],y=n[0],m=n[1],_=n[2],b=i[0],x=i[1],k=i[2];Math.abs(f-b)<ne&&Math.abs(v-x)<ne&&Math.abs(g-k)<ne?yg(t):(c=f-b,h=v-x,d=g-k,r=m*(d*=p=1/Math.hypot(c,h,d))-_*(h*=p),a=_*(c*=p)-y*d,o=y*h-m*c,(p=Math.hypot(r,a,o))?(r*=p=1/p,a*=p,o*=p):(r=0,a=0,o=0),s=h*o-d*a,l=d*r-c*o,u=c*a-h*r,(p=Math.hypot(s,l,u))?(s*=p=1/p,l*=p,u*=p):(s=0,l=0,u=0),t[0]=r,t[1]=s,t[2]=c,t[3]=0,t[4]=a,t[5]=l,t[6]=h,t[7]=0,t[8]=o,t[9]=u,t[10]=d,t[11]=0,t[12]=-(r*f+a*v+o*g),t[13]=-(s*f+l*v+u*g),t[14]=-(c*f+h*v+d*g),t[15]=1)}(this._viewMatrixCached,e,i,n),this._vp||(this._vp=Mg.allocate()),this._vp=bg(this._vp,this.getProjectionMatrix(),this.getViewMatrix()),this._viewMatrixCached}},{key:"getProjectionMatrix",value:function(){return this._projectionMatrixCached||(this._projectionMatrixCached=Mg.allocate()),this._projectionMatrixCached}},{key:"forceGetProjectionMatrix",value:function(){this._projectionMatrixCached||(this._projectionMatrixCached=Mg.allocate());var t=this._params,e=t.left,i=t.top,n=t.right,r=t.bottom;return function(t,e,i,n,r,a,o){var s=1/(e-i),l=1/(n-r),u=1/(a-o);t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+i)*s,t[13]=(r+n)*l,t[14]=(o+a)*u,t[15]=1}(this._projectionMatrixCached,e,n,r,i,0,-2e6),this._vp||(this._vp=Mg.allocate()),this._vp=bg(this._vp,this.getProjectionMatrix(),this.getViewMatrix()),this._projectionMatrixCached}},{key:"getField",value:function(){var t=this._params,e=t.fieldRatio,i=void 0===e?.8:e,n=t.fieldDepth,r=t.left,a=t.right;return(null!=n?n:a-r)*i}},{key:"getProjectionScale",value:function(t){var e=this.getField();return e/(e+t)}},{key:"view",value:function(t,e,i){var n=[0,0,0];return xg(n,[t,e,i],this._viewMatrixCached),n}},{key:"vp",value:function(t,e,i){var n=[0,0,0],r=this._params.viewParams.pos;xg(n,[t,e,i],this._viewMatrixCached),t=n[0],e=n[1],i=n[2];var a=this.getProjectionScale(i);return{x:t*a+r[0],y:e*a+r[1]}}}])}(),Ox=function(){fx.registerPlugin("OrthoCamera",Dx)},Fx=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},zx=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Hx=function(t,e){return function(i,n){e(i,n,t)}},jx=function(){return o((function t(e,i){r(this,t),this.pickItemInterceptorContributions=e,this.pickServiceInterceptorContributions=i,this.type="default",this.global=nc.global}),[{key:"_init",value:function(){this.InterceptorContributions=this.pickItemInterceptorContributions.getContributions().sort((function(t,e){return t.order-e.order})),this.pickerServiceInterceptorContributions=this.pickServiceInterceptorContributions.getContributions().sort((function(t,e){return t.order-e.order}))}},{key:"pick",value:function(t,e,i){var n={graphic:null,group:null};i.pickerService=this;var r=i.bounds.width(),a=i.bounds.height();if(!(new pi).setValue(0,0,r,a).containsPoint(e))return n;this.pickContext&&(this.pickContext.inuse=!0),i.pickContext=this.pickContext,this.pickContext&&this.pickContext.clearMatrix(!0,1);for(var o,s=new vi(1,0,0,1,0,0),l=t.length-1;l>=0&&!(n=t[l].isContainer?this.pickGroup(t[l],e,s,i):this.pickItem(t[l],e,s,i)).graphic;l--)o||(o=n.group);if(n.graphic||(n.group=o),this.pickContext&&(this.pickContext.inuse=!1),this.pickerServiceInterceptorContributions.length)for(var u=0;u<this.pickerServiceInterceptorContributions.length;u++){var c=this.pickerServiceInterceptorContributions[u];c.afterPickItem&&(n=c.afterPickItem(n,this,e,i,{parentMatrix:s}))}return n}},{key:"containsPoint",value:function(t,e,i){var n;return!!(null===(n=this.pickItem(t,e,null,null!=i?i:{pickContext:this.pickContext,pickerService:this}))||void 0===n?void 0:n.graphic)}},{key:"pickGroup",value:function(t,e,i,n){var r=this,a={group:null,graphic:null};if(!1===t.attribute.visibleAll)return a;var o=n.pickContext,s=o.modelMatrix;if(o.camera){var l=t.transMatrix,u=Mg.allocate();if(_g(u,l),s){if(u){var c=Mg.allocate();o.modelMatrix=bg(c,s,u),Mg.free(u)}}else _g(u,t.globalTransMatrix),o.modelMatrix=u}if(this.InterceptorContributions.length)for(var h=0;h<this.InterceptorContributions.length;h++){var d=this.InterceptorContributions[h];if(d.beforePickItem){var p=d.beforePickItem(t,this,e,n,{parentMatrix:i});if(p)return o.modelMatrix!==s&&Mg.free(o.modelMatrix),o.modelMatrix=s,p}}var f=t.transMatrix,v=Ag.allocateByObj(i),g=new Ae(e.x,e.y);v.transformPoint(g,g);var y=t.AABBBounds.containsPoint(g);if(!y&&!t.stage.camera)return a;var m=this.pickItem(t,g.clone(),i,n);m&&m.graphic&&(a.graphic=m.graphic,a.params=m.params);var _=!1!==t.attribute.pickable&&y;return v.multiply(f.a,f.b,f.c,f.d,f.e,f.f),!1===t.attribute.childrenPickable||m&&m.graphic||Ob(t,Nu.zIndex,(function(o){if(o.isContainer){var s=new Ae(e.x,e.y),l=xh(t).group,u=t.attribute,c=u.scrollX,h=void 0===c?l.scrollX:c,d=u.scrollY,p=void 0===d?l.scrollY:d;s.x-=h,s.y-=p,a=r.pickGroup(o,s,v,n)}else{var f=new Ae(e.x,e.y);v.transformPoint(f,f);var g=xh(t).group,y=t.attribute,m=y.scrollX,_=void 0===m?g.scrollX:m,b=y.scrollY,x=void 0===b?g.scrollY:b;f.x-=_,f.y-=x;var k=r.pickItem(o,f,i,n);k&&k.graphic&&(a.graphic=k.graphic,a.params=k.params)}return!!a.graphic||!!a.group}),!0,!!o.camera),o.modelMatrix!==s&&Mg.free(o.modelMatrix),o.modelMatrix=s,a.graphic||a.group||!_||t.stage.camera||(a.group=t),Ag.free(v),a}},{key:"selectPicker",value:function(t){return this.pickerMap.get(t.numberType)||null}}])}();jx=Fx([js(),Hx(0,zs(nl)),Hx(0,Ns(db)),Hx(1,zs(nl)),Hx(1,Ns(pb)),zx("design:paramtypes",[Object,Object])],jx);var Nx=!1,Vx=new Ts((function(t){Nx||(Nx=!0,t(Mm).toSelf().inSingletonScope(),t(E_).to(Mm).inSingletonScope(),t(I_).toService(E_),t(rg).toService(Hy),al(t,rg))})),Wx=!1,Gx=new Ts((function(t){Wx||(Wx=!0,t(Jm).toSelf().inSingletonScope(),t(z_).to(Jm).inSingletonScope(),t(I_).toService(z_),t(om).toSelf(),t(am).toSelf(),t(hg).toService(om),t(hg).toService(am),t(hg).toService(Hy),al(t,hg))})),Ux=!1,Yx=new Ts((function(t){Ux||(Ux=!0,t(Lm).toSelf().inSingletonScope(),t(Gb).toSelf().inSingletonScope(),t(D_).to(Lm).inSingletonScope(),t(I_).toService(D_))})),Xx=!1,Kx=new Ts((function(t){Xx||(Xx=!0,t(Nm).toSelf().inSingletonScope(),t(R_).to(Nm).inSingletonScope(),t(I_).toService(R_),t(ag).toService(Hy),al(t,ag),t(Yb).toSelf().inSingletonScope())})),qx=!1,Zx=new Ts((function(t){qx||(qx=!0,t(e_).toSelf().inSingletonScope(),t(j_).to(e_).inSingletonScope(),t(I_).toService(j_),t(dg).toService(Hy),al(t,dg))})),Jx=!1,Qx=new Ts((function(t){Jx||(Jx=!0,t(Em).toSelf().inSingletonScope(),t(B_).to(Em).inSingletonScope(),t(I_).toService(B_),t(og).toService(Hy),al(t,og))})),$x=!1,tk=new Ts((function(t){$x||($x=!0,t(N_).to(u_).inSingletonScope(),t(I_).toService(N_),t(pg).toService(Hy),al(t,pg))})),ek=!1,ik=new Ts((function(t){ek||(ek=!0,t(Xm).toSelf().inSingletonScope(),t(O_).to(Xm).inSingletonScope(),t(I_).toService(O_),t(ug).toService(Hy),al(t,ug))})),nk=!1,rk=new Ts((function(t){nk||(nk=!0,t(F_).to(m_).inSingletonScope(),t(I_).toService(F_),t(cg).toService(Hy),al(t,cg))})),ak=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},ok=function(){return o((function t(){r(this,t),this.numberType=ov}),[{key:"drawShape",value:function(t,e,i,n,r,a,o,s){r.drawContribution&&t.getSubGraphic().forEach((function(t){var l=r.drawContribution.getRenderContribution(t);l&&l.drawShape&&l.drawShape(t,e,i,n,r,a,o,s)}))}},{key:"draw",value:function(t,e,i,n){var r=i.context;if(r&&(r.highPerformanceSave(),i.drawContribution)){var a=xh(t),o=t.getSubGraphic();o.length&&o.forEach((function(t){i.drawContribution.renderItem(t,i,{theme:a})})),r.highPerformanceRestore()}}}])}();ok=ak([js()],ok);var sk=!1,lk=new Ts((function(t){sk||(sk=!0,t(G_).to(ok).inSingletonScope(),t(I_).toService(G_))})),uk=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},ck=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},hk=function(t){function e(){var t;return r(this,e),(t=n(this,e)).numberType=vv,t.builtinContributions=[a_],t.init(),t}return h(e,t),o(e,[{key:"drawShape",value:function(t,e,i,n,r){var a=xh(t).richtext,o=t.attribute,s=o.strokeOpacity,l=void 0===s?a.strokeOpacity:s,u=o.opacity,c=void 0===u?a.opacity:u,h=o.fillOpacity,d=void 0===h?a.fillOpacity:h,p=o.visible,f=void 0===p?a.visible:p;if(t.valid&&f){var v=Kv(c,d,!0),g=Kv(c,l,!0);v&&(e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,a),e.translate(i,n),this.beforeRenderStep(t,e,i,n,v,g,v,g,a,r),t.getFrameCache().draw(e,this.drawIcon),this.afterRenderStep(t,e,i,n,v,g,v,g,a,r))}}},{key:"drawIcon",value:function(t,e,i,n,r){var a,o=xh(t).richtextIcon,s=t.attribute,l=s.width,u=void 0===l?o.width:l,c=s.height,h=void 0===c?o.height:c,d=s.opacity,p=void 0===d?o.opacity:d,f=s.image,v=s.backgroundFill,g=void 0===v?o.backgroundFill:v,y=s.backgroundFillOpacity,m=void 0===y?o.backgroundFillOpacity:y,_=s.backgroundStroke,b=void 0===_?o.backgroundStroke:_,x=s.backgroundStrokeOpacity,k=void 0===x?o.backgroundStrokeOpacity:x,S=s.backgroundRadius,A=void 0===S?o.backgroundRadius:S,M=s.margin,w=t.attribute,T=w.backgroundWidth,C=void 0===T?u:T,E=w.backgroundHeight,P=void 0===E?h:E;if(M&&(i+=t._marginArray[3],n+=t._marginArray[0]),t._hovered){var R=(C-u)/2,B=(P-h)/2;0===A?(e.beginPath(),e.rect(i-R,n-B,C,P)):(e.beginPath(),im(e,i-R,n-B,C,P,A,!0)),g&&(e.globalAlpha=m,e.fillStyle=g,e.fill()),b&&(e.globalAlpha=k,e.strokeStyle=b,e.stroke())}var I=f&&(null===(a=null==t?void 0:t.resources)||void 0===a?void 0:a.get(f));I&&"success"===I.state&&(e.globalAlpha=p,e.drawImage(I.data,i,n,u,h))}},{key:"draw",value:function(t,e,i){var n=xh(t).richtext;this._draw(t,n,!1,i)}}])}(xm);hk=uk([js(),ck("design:paramtypes",[])],hk);var dk=!1,pk=new Ts((function(t){dk||(dk=!0,t(V_).to(hk).inSingletonScope(),t(I_).toService(V_))})),fk=!1,vk=new Ts((function(t){fk||(fk=!0,t(U_).to(T_).inSingletonScope(),t(I_).toService(U_),t(lg).toService(Hy),al(t,lg))})),gk=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"stroke",value:function(t,e,i,n,r){var a=n.vertices;n.edges.forEach((function(n){var o=a[n[0]],s={x:t+o[0],y:e+o[1],z:i+o[2]},l=a[n[1]],u={x:t+l[0],y:e+l[1],z:i+l[2]};r.beginPath(),r.moveTo(s.x,s.y,s.z),r.lineTo(u.x,u.y,u.z),r.stroke()}))}},{key:"fill",value:function(t,e,i,n,r,a,o,s,l,u,c){var h=Nd.Get(a,Fd.Color255),d=n.vertices,p=d.map((function(t){return o.view(t[0],t[1],t[2])[2]})),f=[];n.polygons.forEach((function(t,e){if(!r||r[e]){f.push({faceIdx:e,polygon:t});var i=t.polygon,n=p[i[0]],a=p[i[1]],o=p[i[2]],s=p[i[3]];t.ave_z=n+a+o+s}})),f.sort((function(t,e){return e.polygon.ave_z-t.polygon.ave_z})),f.forEach((function(n){var r=n.polygon,p=r.polygon,f=r.normal,v=d[p[0]],g=d[p[1]],y=d[p[2]],m=d[p[3]],_={x:t+v[0],y:e+v[1],z:i+v[2]},b={x:t+g[0],y:e+g[1],z:i+g[2]},x={x:t+y[0],y:e+y[1],z:i+y[2]},k={x:t+m[0],y:e+m[1],z:i+m[2]};o.beginPath(),o.moveTo(_.x,_.y,_.z),o.lineTo(b.x,b.y,b.z),o.lineTo(x.x,x.y,x.z),o.lineTo(k.x,k.y,k.z),o.closePath(),c?c(o,l&&l.attribute,u):(o.fillStyle=s?s.computeColor(f,h):a,o.fill())}))}}])}(xm),yk=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},mk=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="rect3d",t.numberType=fv,t}return h(e,t),o(e,[{key:"drawShape",value:function(t,e,i,n,r,a,o,s){var l,u=xh(t,null==a?void 0:a.theme).rect,c=t.attribute,h=c.fill,d=void 0===h?u.fill:h,p=c.stroke,f=void 0===p?u.stroke:p,v=c.x1,g=c.y1,y=c.x,m=c.y,_=c.opacity,b=void 0===_?u.opacity:_,x=c.fillOpacity,k=void 0===x?u.fillOpacity:x,S=c.lineWidth,A=void 0===S?u.lineWidth:S,M=c.strokeOpacity,w=void 0===M?u.strokeOpacity:M,T=c.visible,C=void 0===T?u.visible:T,E=t.attribute,P=E.width,R=E.height;P=(null!=P?P:v-y)||0,R=(null!=R?R:g-m)||0;var B=null!==(l=this.z)&&void 0!==l?l:0,I=qv(b,k,P,R,d),L=Jv(b,w,P,R),D=Yv(d),O=Xv(f,A);if(t.valid&&C&&(D||O)&&(I||L||o||s)){var F=(r.stage||{}).light,z=t.findFace();if(!1!==d){e.setCommonStyle(t,t.attribute,i,n,u);var H=d;"string"!=typeof H&&(H="black"),this.fill(i,n,B,z,null,H,e,F,null,null,o)}!1!==f&&(e.setStrokeStyle(t,t.attribute,i,n,u),this.stroke(i,n,B,z,e))}}},{key:"draw",value:function(t,e,i){var n=xh(t).rect;this._draw(t,n,!1,i)}}])}(gk);mk=yk([js()],mk);var _k=!1,bk=new Ts((function(t){_k||(_k=!0,t(H_).to(mk).inSingletonScope(),t(I_).toService(H_))})),xk=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o};var kk=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).numberType=nv,t}return h(e,t),o(e,[{key:"drawShape",value:function(t,e,i,n,r,a,o,s){var l,u=xh(t,null==a?void 0:a.theme).arc,c=t.attribute.fill,h=void 0===c?u.fill:c,d=this.valid(t,u,o,s);if(d){var p=d.fVisible,f=d.sVisible,v=d.doFill,g=d.doStroke,y=null!==(l=this.z)&&void 0!==l?l:0,m=t.attribute,_=m.outerPadding,b=void 0===_?u.outerPadding:_,x=m.innerPadding,k=void 0===x?u.innerPadding:x,S=m.height,A=void 0===S?10:S,M=t.attribute,w=M.outerRadius,T=void 0===w?u.outerRadius:w,C=M.innerRadius,E=void 0===C?u.innerRadius:C;T+=b,E-=k;var P=Nd.Get(h,Fd.Color255),R=(r.stage||{}).light,B=r.hack_pieFace,I={top:y,bottom:y+A},L={top:[0,1,0],bottom:[0,-1,0],outside:[1,0,-1],inside:[1,0,-1]};"bottom"===B||"top"===B?(e.beginPath(),function(t,e,i,n,r,a,o){var s=t.getParsedAngle(),l=s.startAngle,u=s.endAngle,c=le(u-l),h=u>l,d=!1;if(a<o){var p=a;a=o,o=p}if(a<=ne)e.moveTo(i,n,r);else if(c>=se-ne)e.moveTo(i+a*ce(l),n+a*pe(l),r),e.arc(i,n,a,l,u,!h,r),o>ne&&(e.moveTo(i+o*ce(u),n+o*pe(u),r),e.arc(i,n,o,u,l,h,r));else{var f=t.getParsePadAngle(l,u),v=f.outerDeltaAngle,g=f.innerDeltaAngle,y=f.outerStartAngle,m=f.outerEndAngle,_=f.innerEndAngle,b=f.innerStartAngle,x=a*ce(y),k=a*pe(y),S=o*ce(_),A=o*pe(_);v<.001?d=!0:(e.moveTo(i+x,n+k,r),e.arc(i,n,a,y,m,!h,r)),!(o>ne)||g<.001?(e.lineTo(i+S,n+A,r),d=!0):(e.lineTo(i+S,n+A,r),e.arc(i,n,o,_,b,h,r))}e.closePath()}(t,e,i,n,I[B],T,E),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,u),v&&(o?o(e,t.attribute,u):p&&(e.setCommonStyle(t,t.attribute,i,n,u),e.fillStyle=R?R.computeColor(L[B],P):h,e.fill())),g&&(s?s(e,t.attribute,u):f&&(e.setStrokeStyle(t,t.attribute,i,n,u),e.stroke()))):"outside"!==B&&"inside"!==B||("inside"===B&&(e.save(),e.beginPath(),e.arc(i,n,E,0,se,!0,I.top),e.clip()),e.beginPath(),function(t,e,i,n,r,a,o,s){var l=t.getParsedAngle(),u=l.startAngle,c=l.endAngle,h=le(c-u),d=c>u,p=!1;if(o<=ne)e.moveTo(i,n,r);else if(h>=se-ne)e.moveTo(i+o*ce(u),n+o*pe(u),r),e.arc(i,n,o,u,c,!d,r),e.lineTo(i+o*ce(c),n+o*pe(c),a),e.arc(i,n,o,c,u,d,a);else{var f=s(u,c),v=f.innerouterDeltaAngle,g=f.innerouterStartAngle,y=f.innerouterEndAngle,m=o*ce(g),_=o*pe(g),b=o*ce(y),x=o*pe(y);v<.001?p=!0:(e.moveTo(i+m,n+_,r),e.arc(i,n,o,g,y,!d,r),e.lineTo(i+b,n+x,a),e.arc(i,n,o,y,g,d,a))}e.closePath()}(t,e,i,n,I.top,I.bottom,"outside"===B?T:E,(function(e,i){var n=t.getParsePadAngle(e,i),r=n.outerDeltaAngle,a=n.innerDeltaAngle,o=n.outerStartAngle,s=n.outerEndAngle,l=n.innerEndAngle,u=n.innerStartAngle;return"outside"===B?{innerouterDeltaAngle:r,innerouterEndAngle:s,innerouterStartAngle:o}:{innerouterDeltaAngle:a,innerouterEndAngle:l,innerouterStartAngle:u}})),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,u),v&&(o?o(e,t.attribute,u):p&&(e.setCommonStyle(t,t.attribute,i,n,u),e.fillStyle=R?R.computeColor(L[B],P):h,e.fill())),g&&(s?s(e,t.attribute,u):f&&(e.setStrokeStyle(t,t.attribute,i,n,u),e.stroke())),"inside"===B&&e.restore())}}},{key:"draw",value:function(t,e,i,n){var r=xh(t,null==n?void 0:n.theme).arc;this._draw(t,r,!1,i,n)}}])}(xm);kk=xk([js()],kk);var Sk=!1,Ak=new Ts((function(t){Sk||(Sk=!0,t(P_).to(kk).inSingletonScope(),t(I_).toService(P_))})),Mk=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},wk=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="pyramid3d",t.numberType=dv,t}return h(e,t),o(e,[{key:"drawShape",value:function(t,e,i,n,r,a,o,s){var l,u=xh(t,null==a?void 0:a.theme).polygon,c=t.attribute,h=c.fill,d=void 0===h?u.fill:h,p=c.stroke,f=void 0===p?u.stroke:p,v=c.face,g=void 0===v?[!0,!0,!0,!0,!0,!0]:v,y=null!==(l=this.z)&&void 0!==l?l:0;if(this.valid(t,u,o,s)){var m=(r.stage||{}).light,_=t.findFace();if(!1!==d){e.setCommonStyle(t,t.attribute,i,n,u);var b=d;"string"!=typeof b&&(b="black"),this.fill(i,n,y,_,g,b,e,m,t,u,o)}!1!==f&&(e.setStrokeStyle(t,t.attribute,i,n,u),this.stroke(i,n,y,_,e))}}},{key:"draw",value:function(t,e,i){var n=xh(t).polygon;this._draw(t,n,!1,i)}}])}(gk);wk=Mk([js()],wk);var Tk=!1,Ck=new Ts((function(t){Tk||(Tk=!0,t(W_).to(wk).inSingletonScope(),t(I_).toService(W_))}));var Ek=function(){return o((function t(){var e=this;r(this,t),this.name="HtmlAttributePlugin",this.activeEvent="onRegister",this._uid=ws.GenAutoIncrementId(),this.key=this.name+this._uid,this.htmlMap={},this.renderId=0,this.onWheel=function(t){try{var i=new t.constructor(t.type,t);e.pluginService.stage.window.getContext().getCanvas().nativeCanvas.dispatchEvent(i)}catch(t){return}}}),[{key:"activate",value:function(t){var e=this;this.pluginService=t,t.stage.hooks.afterRender.tap(this.key,(function(i){i&&i===e.pluginService.stage&&e.drawHTML(m(t.stage.getChildren()))}))}},{key:"deactivate",value:function(t){var e=this;t.stage.hooks.afterRender.taps=t.stage.hooks.afterRender.taps.filter((function(t){return t.name!==e.key})),nc.graphicService.hooks.onRemove.unTap(this.key),nc.graphicService.hooks.onRelease.unTap(this.key),this.release()}},{key:"getWrapContainer",value:function(t,e,i){var n;return n=e?"string"==typeof e?nc.global.getElementById(e):e:t.window.getContainer(),{wrapContainer:nc.global.createDom(Object.assign({tagName:"div",parent:n},i)),nativeContainer:n}}},{key:"parseDefaultStyleFromGraphic",value:function(t){return function(t){var e={},i=function(t){return/^\d+(\.\d+)?$/.test("".concat(t))?"".concat(t,"px"):"".concat(t)};return["textAlign","fontFamily","fontVariant","fontStyle","fontWeight"].forEach((function(i){t[i]&&(e[Ri(i)]=t[i])})),["fontSize","lineHeight"].forEach((function(n){var r=Ri(n);j(t[n])||(e[r]=i(t[n]))})),N(t.maxLineWidth)&&(e["max-width"]=i(t.maxLineWidth)),t.underline?e["text-decoration"]="underline":t.lineThrough&&(e["text-decoration"]="line-through"),t.fill&&Y(t.fill)&&(e.color=t.fill),e}("text"===t.type&&t.attribute?t.attribute:xh(t).text)}},{key:"getTransformOfText",value:function(t){var e=xh(t).text,i=t.attribute,n=i.textAlign,r=void 0===n?e.textAlign:n,a=i.textBaseline,o=void 0===a?e.textBaseline:a,s=t.globalTransMatrix.toTransformAttrs(),l=s.rotateDeg,u=s.scaleX,c=s.scaleY,h={left:"0",start:"0",end:"-100%",center:"-50%",right:"-100%",top:"0",middle:"-50%",bottom:"-100%",alphabetic:"-79%"},d={left:"0",start:"0",end:"100%",center:"50%",right:"100%",top:"0",middle:"50%",bottom:"100%",alphabetic:"79%"};return{textAlign:r,transform:"translate(".concat(h[r],",").concat(h[o],") rotate(").concat(l,"deg) scaleX(").concat(u,") scaleY(").concat(c,")"),transformOrigin:"".concat(d[r]," ").concat(d[o])}}},{key:"updateStyleOfWrapContainer",value:function(t,e,i,n,r){var a=this,o=r.pointerEvents,s=r.penetrateEventList,l=void 0===s?[]:s,u=this.parseDefaultStyleFromGraphic(t);u.display=!1!==t.attribute.visible?"block":"none",u.pointerEvents=!0===o?"all":o||"none","none"!==u.pointerEvents&&(this.removeWrapContainerEventListener(i),l.forEach((function(t){"wheel"===t&&i.addEventListener("wheel",a.onWheel)}))),i.style.position||(i.style.position="absolute",n.style.position="relative");var c=0,h=0,d=t.globalAABBBounds,p=r.anchorType;if(j(p)&&(p="text"===t.type?"position":"boundsLeftTop"),"boundsLeftTop"===p&&(p="top-left"),"position"===p||d.empty()){var f=t.globalTransMatrix;c=f.e,h=f.f}else{var v=li(d,p);c=v.x,h=v.y}var g=nc.global.getElementTopLeft(n,!1),y=e.window.getTopLeft(!1),m=e.viewBox,_=c+y.left-g.left+m.x1,b=h+y.top-g.top+m.y1;if(u.left="".concat(_,"px"),u.top="".concat(b,"px"),"text"===t.type&&"position"===p&&(u=Object.assign(Object.assign({},u),this.getTransformOfText(t))),H(r.style)){var x=r.style({top:b,left:_,width:d.width(),height:d.height()},t,i);x&&(u=Object.assign(Object.assign({},u),x))}else V(r.style)?u=Object.assign(Object.assign({},u),r.style):Y(r.style)&&r.style&&(u=Object.assign(Object.assign({},u),function(){var t={};return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").split(";").forEach((function(e){if(e){var i=e.split(":");if(2===i.length){var n=i[0].trim(),r=i[1].trim();n&&r&&(t[n]=r)}}})),t}(r.style)));nc.global.updateDom(i,{width:r.width,height:r.height,style:u})}},{key:"clearCacheContainer",value:function(){var t=this;this.htmlMap&&Object.keys(this.htmlMap).forEach((function(e){t.htmlMap[e]&&t.htmlMap[e].renderId!==t.renderId&&t.removeElement(e)})),this.renderId+=1}},{key:"drawHTML",value:function(t){var e=this;"browser"===nc.global.env&&(t.sort((function(t,e){var i,n;return(null!==(i=t.attribute.zIndex)&&void 0!==i?i:Nu.zIndex)-(null!==(n=e.attribute.zIndex)&&void 0!==n?n:Nu.zIndex)})).forEach((function(t){e.renderGroupHTML(t)})),this.clearCacheContainer())}},{key:"renderGroupHTML",value:function(t){var e=this;this.renderGraphicHTML(t),t.forEachChildren((function(t){t.isContainer?e.renderGroupHTML(t):e.renderGraphicHTML(t)}))}},{key:"removeElement",value:function(t){if(this.htmlMap&&this.htmlMap[t]){var e=this.htmlMap[t].wrapContainer;e&&nc.global.removeDom(e),this.htmlMap[t]=null}}},{key:"removeWrapContainerEventListener",value:function(t){t.removeEventListener("wheel",this.onWheel)}},{key:"renderGraphicHTML",value:function(t){var e,i=t.attribute.html;if(i){var n=t.stage;if(n){var r=i.dom,a=i.container;if(r){var o=j(i.id)?"".concat(null!==(e=t.id)&&void 0!==e?e:t._uid,"_react"):i.id;if(this.htmlMap&&this.htmlMap[o]&&a&&a!==this.htmlMap[o].container&&this.removeElement(o),this.htmlMap&&this.htmlMap[o])"string"==typeof r?this.htmlMap[o].wrapContainer.innerHTML=r:r!==this.htmlMap[o].wrapContainer.firstChild&&(this.htmlMap[o].wrapContainer.removeChild(this.htmlMap[o].wrapContainer.firstChild),this.htmlMap[o].wrapContainer.appendChild(r));else{var s=this.getWrapContainer(n,a),l=s.wrapContainer,u=s.nativeContainer;l&&("string"==typeof r?l.innerHTML=r:l.appendChild(r),this.htmlMap||(this.htmlMap={}),this.htmlMap[o]={wrapContainer:l,nativeContainer:u,container:a,renderId:this.renderId})}if(this.htmlMap&&this.htmlMap[o]){var c=this.htmlMap[o],h=c.wrapContainer,d=c.nativeContainer;this.updateStyleOfWrapContainer(t,n,h,d,i),this.htmlMap[o].renderId=this.renderId}}}}}},{key:"release",value:function(){"browser"===nc.global.env&&this.removeAllDom(this.pluginService.stage.defaultLayer)}},{key:"removeAllDom",value:function(t){var e=this;this.htmlMap&&(Object.keys(this.htmlMap).forEach((function(t){e.removeElement(t)})),this.htmlMap=null)}}])}(),Pk=function(){fx.registerPlugin("HtmlAttributePlugin",Ek)},Rk=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).name="ReactAttributePlugin",t.activeEvent="onRegister",t._uid=ws.GenAutoIncrementId(),t.key=t.name+t._uid,t.htmlMap={},t}return h(e,t),o(e,[{key:"removeElement",value:function(t){if(this.htmlMap&&this.htmlMap[t]){var e=this.htmlMap[t],i=e.root,n=e.wrapContainer,r=e.unmount;i?nc.global.getRequestAnimationFrame()((function(){i.unmount()})):r&&r(),n&&nc.global.removeDom(n),this.htmlMap[t]=null}}},{key:"renderGraphicHTML",value:function(t){var e,i=t.attribute.react;if(i){var n=t.stage;if(n){var r=n.params.ReactDOM,a=i.element,o=i.container;if(a&&r&&(r.createRoot||r.render)){var s=j(i.id)?"".concat(null!==(e=t.id)&&void 0!==e?e:t._uid,"_react"):i.id;if(this.htmlMap&&this.htmlMap[s]&&o&&o!==this.htmlMap[s].container&&this.removeElement(s),this.htmlMap&&this.htmlMap[s])r.createRoot?this.htmlMap[s].root.render(a):r.render(a,this.htmlMap[s].wrapContainer);else{var l=this.getWrapContainer(n,o),u=l.wrapContainer,c=l.nativeContainer;if(u)if(this.htmlMap||(this.htmlMap={}),r.createRoot){var h=r.createRoot(u);h.render(a),this.htmlMap[s]={root:h,wrapContainer:u,nativeContainer:c,container:o,renderId:this.renderId}}else r.render(a,u),this.htmlMap[s]={wrapContainer:u,nativeContainer:c,container:o,renderId:this.renderId,unmount:function(){r.unmountComponentAtNode(u)}}}if(this.htmlMap&&this.htmlMap[s]){var d=this.htmlMap[s],p=d.wrapContainer,f=d.nativeContainer;this.updateStyleOfWrapContainer(t,n,p,f,i),this.htmlMap[s].renderId=this.renderId}}}}}}])}(Ek),Bk=function(){fx.registerPlugin("ReactAttributePlugin",Rk)},Ik=function(){return o((function t(){var e=this;r(this,t),this.name="ViewTransform3dPlugin",this.activeEvent="onRegister",this._uid=ws.GenAutoIncrementId(),this.key=this.name+this._uid,this.onMouseDown=function(t){e.option3d||(e.option3d=e.pluginService.stage.option3d),e.option3d&&(e.mousedown=!0,e.pageX=t.page.x,e.pageY=t.page.y)},this.onMouseUp=function(t){e.option3d||(e.option3d=e.pluginService.stage.option3d),e.option3d&&(e.mousedown=!1)},this.onMouseMove=function(t){var i,n,r=e.pluginService.stage;if(e.option3d||(e.option3d=r.option3d),e.option3d&&e.mousedown)if(e.pageX&&e.pageY){var a=t.page.x-e.pageX,o=t.page.y-e.pageY;e.pageX=t.page.x,e.pageY=t.page.y;var s=a/100,l=o/100;e.option3d.alpha=(null!==(i=e.option3d.alpha)&&void 0!==i?i:0)+s,e.option3d.beta=(null!==(n=e.option3d.beta)&&void 0!==n?n:0)+l,r.set3dOptions(e.option3d),r.renderNextFrame()}else e.pageX=t.page.x,e.pageY=t.page.y}}),[{key:"activate",value:function(t){this.pluginService=t;var e=t.stage;this.option3d=e.option3d,e.addEventListener("mousedown",this.onMouseDown),e.addEventListener("mouseup",this.onMouseUp),e.addEventListener("mousemove",this.onMouseMove)}},{key:"deactivate",value:function(t){var e=t.stage;e.removeEventListener("mousedown",this.onMouseDown),e.removeEventListener("mouseup",this.onMouseUp),e.removeEventListener("mousemove",this.onMouseMove)}}])}();function Lk(t){for(var e=[],i=0;i<t.length;i++){var n=t[i];0!==i&&n[0]===e[e.length-1]||e.push(n[0]),e.push(n[1])}return e}var Dk=function(t,e){return H(Fk.warnHandler)&&Fk.warnHandler.call(null,t,e),e?Lt.getInstance().warn("[VChart warn]: ".concat(t),e):Lt.getInstance().warn("[VChart warn]: ".concat(t))},Ok=function(t,e,i){if(!H(Fk.errorHandler))throw new Error(t);Fk.errorHandler.call(null,t,e)},Fk={silent:!1,warnHandler:!1,errorHandler:!1},zk=px(),Hk=zk&&globalThis?globalThis.document:void 0;function jk(t){return("desktop-browser"===t||"mobile-browser"===t)&&zk}function Nk(t){return Vk(t)||"mobile-browser"===t}function Vk(t){return t.includes("miniApp")||"lynx"===t||"wx"===t||"harmony"===t}var Wk=0;function Gk(){return Wk>=9999999&&(Wk=0),Wk++}function Uk(t){return null!=t&&""!==t&&(!!Z(t)||+t==+t)}function Yk(t){return!(!t||0===t.length)&&(!j(t[0])&&!j(t[0].dataId)&&X(t[0].fields))}var Xk=function(t){return function(e){return st(e,t)}},Kk=function(t){return t},qk=function(t){return 0},Zk=function(t){Lt.getInstance().error(t)},Jk=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(H(t))return t;var n=function(t){var e,i,n,r=[],a=t.length,o=null,s=0,l="";t+="";var u=function(){r.push(l+t.substring(e,i)),l="",e=i+1};for(e=0,i=0;i<a;i+=1)if("\\"===(n=t[i]))l+=t.substring(e,i),l+=t.substring(++i,++i),e=i;else if(n===o)u(),o=null,s=-1;else{if(o)continue;e===s&&'"'===n||e===s&&"'"===n?(e=i+1,o=n):"."!==n||s?"["===n?(i>e&&u(),s=e=i+1):"]"===n&&(s||Zk("Access path missing open bracket: "+t),s>0&&u(),s=0,e=i+1):i>e?u():e=i+1}return s&&Zk("Access path missing closing bracket: "+t),o&&Zk("Access path missing closing quote: "+t),i>e&&(i+=1,u()),r}(t),r=1===n.length?n[0]:t;return function(t,e,i){return t.fields=e||[],t.fname=i,t}((i&&i.get||Xk)(n),[r],e||r)},Qk=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(X(t)){var n=t.map((function(t){return Jk(t,e,i)}));return function(t){return n.map((function(e){return e(t)}))}}return Jk(t,e,i)},$k=function(t,e){var i,n,r=H(e)?e:function(t){return t};if(t&&t.length){for(var a=t.length,o=0;o<a;o+=1){var s=r(t[o]);j(s)||!Z(s=+s)||Number.isNaN(s)||(j(i)?(i=s,n=s):(i=Math.min(i,s),n=Math.max(n,s)))}return[i,n]}return[i,n]},tS=function(t,e){return j(t)?e:Y(t)?e*parseFloat(t)/100:t};function eS(t,e,i,n){var r,a,o=-1;t.forEach((function(t){r=e(t),a=i(t),!j(r)&&(r=+r)>=r&&!j(a)&&(a=+a)>=a&&n(r,a,++o)}))}function iS(t,e,i,n,r){var a=0,o=0;return eS(t,e,i,(function(t,e){var i=e-r(t),s=e-n;a+=i*i,o+=s*s})),1-a/o}function nS(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t.x},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t){return t.y},n=0,r=0,a=0,o=0,s=0;eS(t,e,i,(function(t,e){++s,n+=(t-n)/s,r+=(e-r)/s,a+=(t*e-a)/s,o+=(t*t-o)/s}));var l,u,c,h,d,p=(u=r,c=a,h=o-(l=n)*l,d=Math.abs(h)<1e-24?0:(c-l*u)/h,[u-d*l,d]),f=function(t){return p[0]+p[1]*t};return{coef:p,predict:f,rSquared:iS(t,e,i,r,f)}}function rS(t){return"horizontal"===t}function aS(t){return"vertical"===t}var oS={triangleForward:function(){return function(t){var e=t%(2*Math.PI/3);return 1/(Math.cos(e)+Math.sqrt(3)*Math.sin(e))}},triangleUpright:sS,triangle:sS,diamond:function(){return function(t){var e=t%(2*Math.PI/4);return 1/(Math.cos(e)+Math.sin(e))}},square:function(){return function(t){return Math.min(1/Math.abs(Math.cos(t)),1/Math.abs(Math.sin(t)))}},star:function(){return function(t){var e=(t+.955)%(2*Math.PI/10);return(t+.955)%(2*Math.PI/5)-2*Math.PI/10>=0?1/(Math.cos(2*Math.PI/10-e)+3.07768*Math.sin(2*Math.PI/10-e)):1/(Math.cos(e)+3.07768*Math.sin(e))}},cardioid:function(){return function(t){return 1+Math.sin(t)}},circle:function(){return function(){return 1}},pentagon:function(){return function(t){var e=(t+.955)%(2*Math.PI/5);return 1/(Math.cos(e)+.726543*Math.sin(e))}}};function sS(){return function(t){var e=(t+3*Math.PI/2)%(2*Math.PI/3);return 1/(Math.cos(e)+Math.sqrt(3)*Math.sin(e))}}function lS(t,e){var i=e[0],n=e[1],r=1,a=[e[0]>>1,e[1]>>1];switch(t){case"cardioid":a[1]=~~(n/2.7*.4),r=Math.floor(Math.min(i/2.3,n/2.6));break;case"triangleForward":r=n/Math.sqrt(.75)>i?Math.floor(i/2):Math.floor(n/(2*Math.sqrt(.75)));break;case"triangle":case"triangleUpright":a[1]=~~(n/1.5),r=Math.floor(Math.min(n/1.5,i/2));break;case"circle":case"diamond":case"square":case"star":case"pentagon":r=Math.floor(Math.min(i/2,n/2));break;default:r=Math.floor(Math.max(i/2,n/2))}return{maxRadius:r,center:a}}var uS=function(t){return oS[t]?oS[t]():oS.circle()},cS=function(t){if(!t||"#fff"===t)return function(t,e,i){var n=t.width;return 0===t.data[e*n*4+4*i+3]||255===t.data[e*n*4+4*i+0]&&255===t.data[e*n*4+4*i+1]&&255===t.data[e*n*4+4*i+2]};var e=ex.createCanvas({width:1,height:1}).getContext("2d",{willReadFrequently:!0});e.fillStyle=t,e.fillRect(0,0,1,1);var i=e.getImageData(0,0,1,1).data;return function(t,e,n){var r=t.width;return[0,1,2,3].every((function(a){return t.data[4*(e*r+n)+a]===i[a]}))}},hS=function(t,e,i,n){var r=t.backgroundColor,a=void 0===r?"#fff":r,o=n||ex.createCanvas({width:e,height:i,dpr:1}),s=o.getContext("2d",{willReadFrequently:!0});if(n){var l=n.width,u=n.height;s.clearRect(0,0,l,u),n.style.width="".concat(e,"px"),n.style.height="".concat(i,"px"),n.width=e,n.height=i}return s.fillStyle=a,s.fillRect(0,0,o.width,o.height),"text"===t.type?dS(t,o.width,o.height,s):"geometric"===t.type&&vS(t,o.width,o.height,s),o},dS=function(t,e,i,n){var r=t.fontFamily,a=void 0===r?"sans-serif":r,o=t.fontWeight,s=void 0===o?"normal":o,l=t.fontStyle,u=void 0===l?"normal":l,c=t.fontVariant,h=void 0===c?"normal":c,d=t.fill,p=t.text,f=t.hollow,v=12;n.font="".concat(u," ").concat(h," ").concat(s," ").concat(v,"px ").concat(a),n.textAlign="center",n.textBaseline="middle",n.fillStyle=null!=d?d:"black";var g=n.measureText(p),y="normal"!==u?1.1:1,m=N(g.actualBoundingBoxRight)&&N(g.actualBoundingBoxLeft)?Math.ceil(y*(Math.abs(g.actualBoundingBoxRight)+Math.abs(g.actualBoundingBoxLeft))):0,_=Math.max(Math.ceil(g.width),m,v);if(f&&(n.globalCompositeOperation="xor"),_>e){var b=Math.min(e/_,i/v);n.fillText(p,e/2,i/2),n.scale(b,b)}else v=Math.floor(v*e/_),v=Math.min(v,i),n.font="".concat(u," ").concat(h," ").concat(s," ").concat(v,"px ").concat(a),n.fillText(p,Math.floor(e/2),Math.floor(i/2))},pS=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3?arguments[3]:void 0,r=2*Math.PI/n;return new Array(n).fill(0).map((function(n,a){return Pe(t,e,i+a*r)}))},fS=function(t,e){t.beginPath(),e.forEach((function(e,i){0===i?t.moveTo(e.x,e.y):t.lineTo(e.x,e.y)})),t.closePath(),t.fill()},vS=function(t,e,i,n){var r=t.fill,a=t.hollow,o=lS(t.shape,[e,i]),s=o.center,l=o.maxRadius;n.fillStyle=null!=r?r:"black",a&&(n.globalCompositeOperation="xor");var u=s[0],c=s[1];if("cardioid"===t.shape)!function(t,e){var i;t.beginPath(),e.forEach((function(e,n){0===n?t.moveTo(e.x,e.y):t.bezierCurveTo(e.x,e.y,i.x,i.y,e.x,e.y),i=e})),t.closePath(),t.fill()}(n,function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3?arguments[3]:void 0,r=2*Math.PI/n,a=uS("cardioid");return new Array(n).fill(0).map((function(n,o){var s=i+o*r,l=e*a(s);return Pe(t,l,s)}))}({x:u,y:c},l,0,100));else if("circle"===t.shape)n.beginPath(),n.arc(u,c,l,0,2*Math.PI,!0),n.fill();else if("diamond"===t.shape)fS(n,pS({x:u,y:c},l,-Math.PI/2,4));else if("square"===t.shape)fS(n,pS({x:u,y:c},l,-Math.PI/4,4));else if("pentagon"===t.shape)fS(n,pS({x:u,y:c},l,Math.PI/2,5));else if("triangle"===t.shape||"triangleUpright"===t.shape)fS(n,pS({x:u,y:c},l,-Math.PI/2,3));else if("triangleForward"===t.shape)fS(n,pS({x:u,y:c},l,0,3));else if("star"===t.shape){for(var h=pS({x:u,y:c},l,-Math.PI/2,5),d=pS({x:u,y:c},l/(2*Math.cos(Math.PI/5)),-Math.PI/2+Math.PI/5,5),p=[],f=0;f<5;f++)p.push(h[f]),p.push(d[f]);fS(n,p)}else n.fillRect(0,0,e,i)},gS=["x","y","dx","dy","scaleX","scaleY","angle","anchor","postMatrix","visible","clip","pickable","childrenPickable","zIndex","cursor"],yS=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[t]))._skipRenderAttributes=gS,(null==i?void 0:i.mode)&&(a.mode=i.mode,a.setMode(i.mode)),(null==i?void 0:i.skipDefault)&&(a.skipDefault=!0),a.setTheme({common:{strokeBoundsBuffer:0}}),a.attribute=t,a.onSetStage((function(){a.render(),a.bindEvents()})),a}return h(e,t),o(e,[{key:"setAttribute",value:function(t,e,i,n){var r=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(l({},t,e),this.attribute,t,n);if(r)return this._setAttributes(r,i);G(this.attribute[t])&&G(e)&&!H(this.attribute[t])&&!H(e)?ft(this.attribute[t],e):this.attribute[t]=e,this._skipRenderAttributes.includes(t)||this.render(),this.valid=this.isValid(),this.updateShapeAndBoundsTagSetted()||!i&&!this.needUpdateTag(t)?this.addUpdateBoundTag():this.addUpdateShapeAndBoundsTag(),this.addUpdatePositionTag(),this.onAttributeUpdate()}},{key:"setAttributes",value:function(t,e,i){return t=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,null,i)||t,this._setAttributes(t,e)}},{key:"_setAttributes",value:function(t,e){var i=this,n=Object.keys(t);this._mergeAttributes(t,n),n.every((function(t){return i._skipRenderAttributes.includes(t)}))||this.render(),this.valid=this.isValid(),this.updateShapeAndBoundsTagSetted()||!e&&!this.needUpdateTags(n)?this.addUpdateBoundTag():this.addUpdateShapeAndBoundsTag(),this.addUpdatePositionTag(),this.onAttributeUpdate()}},{key:"_mergeAttributes",value:function(t,e){j(e)&&(e=Object.keys(t));for(var i=0;i<e.length;i++){var n=e[i];!G(this.attribute[n])||H(this.attribute[n])||H(t[n])?this.attribute[n]=t[n]:ft(this.attribute[n],t[n])}}},{key:"bindEvents",value:function(){}},{key:"_getNodeId",value:function(t){var e;return"".concat(null!==(e=this.id)&&void 0!==e?e:this._uid,"-").concat(this.name,"-").concat(t)}},{key:"_dispatchEvent",value:function(t,e){var i,n=new Ch(t,e);n.manager=null===(i=this.stage)||void 0===i?void 0:i.eventSystem.manager,this.dispatchEvent(n)}}])}(Bv),mS=Symbol.for("MathPickerContribution"),_S=Symbol.for("MathArcPicker"),bS=Symbol.for("MathAreaPicker"),xS=Symbol.for("MathCirclePicker"),kS=Symbol.for("MathImagePicker"),SS=Symbol.for("MathLinePicker"),AS=Symbol.for("MathPathPicker"),MS=Symbol.for("MathRectPicker"),wS=Symbol.for("MathSymbolPicker"),TS=Symbol.for("MathTextPicker"),CS=Symbol.for("MathPolygonPicker"),ES=Symbol.for("MathGlyphPicker"),PS=Symbol.for("CanvasArcPicker"),RS=Symbol.for("CanvasArc3dPicker"),BS=Symbol.for("CanvasAreaPicker"),IS=Symbol.for("CanvasCirclePicker"),LS=Symbol.for("CanvasImagePicker"),DS=Symbol.for("CanvasLinePicker"),OS=Symbol.for("CanvasPathPicker"),FS=Symbol.for("CanvasRectPicker"),zS=Symbol.for("CanvasRect3dPicker"),HS=Symbol.for("CanvasSymbolPicker"),jS=Symbol.for("CanvasTextPicker"),NS=Symbol.for("CanvasPolygonPicker"),VS=Symbol.for("CanvasPyramid3dPicker"),WS=Symbol.for("CanvasRichTextPicker"),GS=Symbol.for("CanvasGlyphPicker"),US=Symbol.for("CanvasGroupPicker"),YS=Symbol.for("CanvasPickerContribution"),XS=function(){return o((function t(e){var i=this;r(this,t),this.onPointerDown=function(t){var e=t.target,n=i.rootNode,r=e===n;if(e&&!r){var a,o=!1;function l(t){if(o||(t.type="dragstart",null==e||e.dispatchEvent(t),o=!0),t.type="drag",null==e||e.dispatchEvent(t),!r){e.attribute.pickable=!1;var i=(null==n?void 0:n.pick(t.global.x,t.global.y)).graphic;e.attribute.pickable=!0,a!==i&&(a&&(t.type="dragleave",t.target=a,a.dispatchEvent(t)),i&&(t.type="dragenter",t.target=i,i.dispatchEvent(t)),(a=i)&&(t.type="dragover",t.target=a,a.dispatchEvent(t)))}}null==n||n.addEventListener("pointermove",l);var s=function(){o&&(a&&(t.type="drop",t.target=a,a.dispatchEvent(t)),t.type="dragend",e.dispatchEvent(t),o=!1),null==n||n.removeEventListener("pointermove",l)};e.addEventListener("pointerup",s,{once:!0}),e.addEventListener("pointerupoutside",s,{once:!0})}},this.rootNode=e,this.initEvents()}),[{key:"initEvents",value:function(){var t;null===(t=this.rootNode)||void 0===t||t.addEventListener("pointerdown",this.onPointerDown)}},{key:"removeEvents",value:function(){var t;null===(t=this.rootNode)||void 0===t||t.removeEventListener("pointerdown",this.onPointerDown)}},{key:"release",value:function(){this.removeEvents(),this.rootNode=null}}])}(),KS=function(t,e){var i=e.x-t.x,n=e.y-t.y;return Math.abs(i)>Math.abs(n)?i>0?"right":"left":n>0?"down":"up"},qS=function(t,e){var i=Math.abs(e.x-t.x),n=Math.abs(e.y-t.y);return Math.sqrt(i*i+n*n)},ZS=function(t){function e(t){var a,o,s,l,u,c,h,d,p,f,v,g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(this,e),(a=n(this,e)).cachedEvents=[],a.startPoints=[],a.processEvent={},a.throttleTimer=0,a.emitThrottles=[],a.lastTapTarget=null,a.onStart=function(t){a.startTime=Eh.now();var e=i(a),n=e.cachedEvents,r=e.startPoints;t&&n.push(t.clone()),r.length=n.length;for(var o=0;o<n.length;o++){var s=n[o],l={x:s.x,y:s.y};r[o]=l}if(1!==r.length)a.startDistance=qS(r[0],r[1]),a.center=function(t){var e=t.length;if(1===e)return{x:Math.round(t[0].x),y:Math.round(t[0].y)};for(var i=0,n=0,r=0;r<e;)i+=t[r].x,n+=t[r].y,r++;return{x:Math.round(i/e),y:Math.round(n/e)}}([r[0],r[1]]);else{var u=n[0];a.pressTimeout=setTimeout((function(){u.direction="none",u.deltaX=0,u.deltaY=0,u.points=r,a.triggerStartEvent("press",u),a.triggerEvent("press",u),a.eventType="press",a.direction="none",a.pressTimeout=null}),a.config.press.time)}},a.onMove=function(t){a.clearPressTimeout();var e=i(a),n=e.startPoints,r=e.cachedEvents;if(n.length){for(var o=t.clone(),s=o.x,l=o.y,u=o.pointerId,c=0,h=r.length;c<h;c++)if(u===r[c].pointerId){r[c]=o;break}var d={x:s,y:l},p=r.map((function(t){return{x:t.x,y:t.y}})),f=Eh.now();if(a.prevMoveTime=a.lastMoveTime,a.prevMovePoint=a.lastMovePoint,a.lastMoveTime=f,a.lastMovePoint=d,1===n.length){var v=n[0],g=s-v.x,y=l-v.y,m=a.direction||KS(v,d);a.direction=m;var _=a.getEventType(d);return o.direction=m,o.deltaX=g,o.deltaY=y,o.points=p,a.triggerStartEvent(_,o),void a.triggerEvent(_,o)}var b=i(a).startDistance,x=qS(p[0],p[1]);o.scale=x/b,o.center=a.center,o.points=p,a.triggerStartEvent("pinch",o),a.triggerEvent("pinch",o)}},a.onEnd=function(t){var e=t.clone(),n=i(a),r=n.cachedEvents,o=n.startPoints,s=r.map((function(t){return{x:t.x,y:t.y}}));if(e.points=s,a.triggerEndEvent(e),1===r.length){var l=Eh.now(),u=a.lastMoveTime;if(l-u<100){var c=u-(a.prevMoveTime||a.startTime);if(c>0){var h=a.prevMovePoint||o[0],d=a.lastMovePoint||o[0],p=qS(h,d),f=p/c;if(f>a.config.swipe.velocity&&p>a.config.swipe.threshold)return e.velocity=f,e.direction=KS(h,d),a.triggerEvent("swipe",e),a.cachedEvents=[],a.startPoints=[],void a.reset()}}l-a.startTime<a.config.press.time&&(l-a.lastTapTime<a.config.tap.interval&&t.target===a.lastTapTarget?a.tapCount++:a.tapCount=1,a.lastTapTime=l,a.lastTapTarget=t.target,1===a.tapCount?a.triggerEvent("tap",e):2===a.tapCount&&(a.triggerEvent("doubletap",e),a.tapCount=0))}for(var v=0,g=r.length;v<g;v++)if(r[v].pointerId===e.pointerId){r.splice(v,1),o.splice(v,1);break}a.reset(),r.length>0&&a.onStart()},a.element=t,a.tapCount=0,a.lastTapTime=0,a.config={press:{time:null!==(s=null===(o=null==g?void 0:g.press)||void 0===o?void 0:o.time)&&void 0!==s?s:251,threshold:null!==(u=null===(l=null==g?void 0:g.press)||void 0===l?void 0:l.threshold)&&void 0!==u?u:9},swipe:{threshold:null!==(h=null===(c=null==g?void 0:g.swipe)||void 0===c?void 0:c.threshold)&&void 0!==h?h:10,velocity:null!==(p=null===(d=null==g?void 0:g.swipe)||void 0===d?void 0:d.velocity)&&void 0!==p?p:.3},tap:{interval:null!==(v=null===(f=null==g?void 0:g.tap)||void 0===f?void 0:f.interval)&&void 0!==v?v:300}},a.initEvents(),a}return h(e,t),o(e,[{key:"initEvents",value:function(){var t=this.element;t&&(t.addEventListener("pointerdown",this.onStart),t.addEventListener("pointermove",this.onMove),t.addEventListener("pointerup",this.onEnd),t.addEventListener("pointerleave",this.onEnd),t.addEventListener("pointerupoutside",this.onEnd))}},{key:"removeEvents",value:function(){var t=this.element;t&&(t.removeEventListener("pointerdown",this.onStart),t.removeEventListener("pointermove",this.onMove),t.removeEventListener("pointerup",this.onEnd),t.removeEventListener("pointerleave",this.onEnd),t.removeEventListener("pointerupoutside",this.onEnd))}},{key:"release",value:function(){this.removeEvents(),this.element=null}},{key:"getEventType",value:function(t){var e,i=this.eventType,n=this.startTime,r=this.startPoints;return"press"===i?i:(e=Eh.now()-n>this.config.press.time&&qS(r[0],t)<this.config.press.threshold?"press":"pan",this.eventType=e,e)}},{key:"enable",value:function(t){this.processEvent[t]=!0}},{key:"isProcess",value:function(t){return this.processEvent[t]}},{key:"pushEvent",value:function(t,e){for(var i=this.emitThrottles,n={type:t,ev:e},r=0,a=i.length;r<a;r++)if(i[r].type===t)return void i.splice(r,1,n);i.push(n)}},{key:"clearPressTimeout",value:function(){this.pressTimeout&&(clearTimeout(this.pressTimeout),this.pressTimeout=null)}},{key:"reset",value:function(){this.clearPressTimeout(),this.startTime=0,this.startDistance=0,this.direction=null,this.eventType=null,this.prevMoveTime=0,this.prevMovePoint=null,this.lastMoveTime=0,this.lastMovePoint=null}},{key:"triggerEvent",value:function(t,e){var i=this;this.pushEvent(t,e);var n=this.throttleTimer,r=this.emitThrottles;n||(this.throttleTimer=nc.global.getRequestAnimationFrame()((function(){nc.global.getCancelAnimationFrame()(i.throttleTimer),i.throttleTimer=null;for(var t=0,e=r.length;t<e;t++){var n=r[t],a=n.type,o=n.ev;i.emitEvent(a,o)}i.emitThrottles.length=0})))}},{key:"triggerStartEvent",value:function(t,e){this.isProcess(t)||(this.enable(t),this.triggerEvent("".concat(t,"start"),e))}},{key:"triggerEndEvent",value:function(t){var e=this,i=this.processEvent;Object.keys(i).forEach((function(n){e.triggerEvent("".concat(n,"end"),t),"press"===n&&e.triggerEvent("".concat(n,"up"),t),delete i[n]}))}},{key:"emitEvent",value:function(t,e){if(this.element){var i=this.element._events["*"];if(i)if("fn"in i)i.fn.call(i.context,e,t);else for(var n=0,r=i.length;n<r&&!e.propagationImmediatelyStopped;n++)i[n].fn.call(i[n].context,e,t);this.emit(t,e)}}}])}(O),JS=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},QS=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},$S=[0,0,0],tA=function(){return o((function t(e,i){r(this,t),this.fillAttributes=Object.assign(Object.assign({},Du),{opacity:1}),this.strokeAttributes=Object.assign(Object.assign({},Fu),{opacity:1}),this.textAttributes=Object.assign(Object.assign({},zu),{opacity:1}),this._clearShadowStyle=!1,this._clearFilterStyle=!1,this._clearGlobalCompositeOperationStyle=!1;var n=e.nativeCanvas.getContext("2d");if(!n)throw new Error("发生错误，获取2d上下文失败");this.nativeContext=n,this.canvas=e,this.matrix=new vi(1,0,0,1,0,0),this.stack=[],this.dpr=i,this.applyedMatrix=new vi(1,0,0,1,0,0),this._clearMatrix=new vi(1,0,0,1,0,0),this.baseGlobalAlpha=1}),[{key:"fillStyle",get:function(){return this.nativeContext.fillStyle},set:function(t){this.nativeContext.fillStyle=t}},{key:"font",get:function(){return this.nativeContext.font},set:function(t){this.nativeContext.font=t}},{key:"globalAlpha",get:function(){return this.nativeContext.globalAlpha},set:function(t){this.nativeContext.globalAlpha=t*this.baseGlobalAlpha}},{key:"lineCap",get:function(){return this.nativeContext.lineCap},set:function(t){this.nativeContext.lineCap=t}},{key:"lineDashOffset",get:function(){return this.nativeContext.lineDashOffset},set:function(t){this.nativeContext.lineDashOffset=t}},{key:"lineJoin",get:function(){return this.nativeContext.lineJoin},set:function(t){this.nativeContext.lineJoin=t}},{key:"lineWidth",get:function(){return this.nativeContext.lineWidth},set:function(t){this.nativeContext.lineWidth=t}},{key:"miterLimit",get:function(){return this.nativeContext.miterLimit},set:function(t){this.nativeContext.miterLimit=t}},{key:"shadowBlur",get:function(){return this.nativeContext.shadowBlur},set:function(t){this.nativeContext.shadowBlur=t}},{key:"shadowColor",get:function(){return this.nativeContext.shadowColor},set:function(t){this.nativeContext.shadowColor=t}},{key:"shadowOffsetX",get:function(){return this.nativeContext.shadowOffsetX},set:function(t){this.nativeContext.shadowOffsetX=t}},{key:"shadowOffsetY",get:function(){return this.nativeContext.shadowOffsetY},set:function(t){this.nativeContext.shadowOffsetY=t}},{key:"strokeStyle",get:function(){return this.nativeContext.strokeStyle},set:function(t){this.nativeContext.strokeStyle=t}},{key:"textAlign",get:function(){return this.nativeContext.textAlign},set:function(t){this.nativeContext.textAlign=t}},{key:"textBaseline",get:function(){return this.nativeContext.textBaseline},set:function(t){this.nativeContext.textBaseline=t}},{key:"inuse",get:function(){return!!this._inuse},set:function(t){t!==!!this._inuse&&(this._inuse=t,t?(this.nativeContext.save(),this.reset()):this.nativeContext.restore())}},{key:"reset",value:function(){this.stack.length&&Lt.getInstance().warn("可能存在bug，matrix没有清空"),this.matrix.setValue(1,0,0,1,0,0),this.applyedMatrix=new vi(1,0,0,1,0,0),this.stack.length=0,this.nativeContext.setTransform(1,0,0,1,0,0)}},{key:"getCanvas",value:function(){return this.canvas}},{key:"getContext",value:function(){return this.nativeContext}},{key:"setTransformForCurrent",value:function(){!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&this.applyedMatrix.equalToMatrix(this.matrix)||(this.applyedMatrix.setValue(this.matrix.a,this.matrix.b,this.matrix.c,this.matrix.d,this.matrix.e,this.matrix.f),this.nativeContext.setTransform(this.matrix.a,this.matrix.b,this.matrix.c,this.matrix.d,this.matrix.e,this.matrix.f))}},{key:"currentMatrix",get:function(){return this.matrix}},{key:"cloneMatrix",value:function(t){return Ag.allocateByObj(t)}},{key:"clear",value:function(){this.save(),this.resetTransform(),this.nativeContext.clearRect(0,0,this.canvas.width,this.canvas.height),this.restore()}},{key:"restore",value:function(){this.nativeContext.restore(),this.stack.length>0&&(Ag.free(this.matrix),this.matrix=this.stack.pop(),this.setTransformForCurrent(!0))}},{key:"highPerformanceRestore",value:function(){this.stack.length>0&&(Ag.free(this.matrix),this.matrix=this.stack.pop())}},{key:"rotate",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.matrix.rotate(t),e&&this.setTransformForCurrent()}},{key:"save",value:function(){var t=this.cloneMatrix(this.matrix);this.stack.push(t),this.nativeContext.save()}},{key:"highPerformanceSave",value:function(){var t=this.cloneMatrix(this.matrix);this.stack.push(t)}},{key:"scale",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.matrix.scale(t,e),i&&this.setTransformForCurrent()}},{key:"setScale",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.matrix.setScale(t,e),i&&this.setTransformForCurrent()}},{key:"scalePoint",value:function(t,e,i,n){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];this.translate(i,n,!1),this.scale(t,e,!1),this.translate(-i,-n,!1),r&&this.setTransformForCurrent()}},{key:"setTransform",value:function(t,e,i,n,r,a){var o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:this.dpr;this.matrix.setValue(s*t,s*e,s*i,s*n,s*r,s*a),o&&this.setTransformForCurrent()}},{key:"setTransformFromMatrix",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.dpr;this.matrix.setValue(t.a*i,t.b*i,t.c*i,t.d*i,t.e*i,t.f*i),e&&this.setTransformForCurrent()}},{key:"resetTransform",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.dpr;this.setTransform(e,0,0,e,0,0),t&&this.setTransformForCurrent()}},{key:"transform",value:function(t,e,i,n,r,a){var o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];this.matrix.multiply(t,e,i,n,r,a),o&&this.setTransformForCurrent()}},{key:"transformFromMatrix",value:function(t,e){this.matrix.multiply(t.a,t.b,t.c,t.d,t.e,t.f),e&&this.setTransformForCurrent()}},{key:"translate",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.matrix.translate(t,e),i&&this.setTransformForCurrent()}},{key:"rotateDegrees",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=t*Math.PI/180;this.rotate(i,e)}},{key:"rotateAbout",value:function(t,e,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.translate(e,i,!1),this.rotate(t,!1),this.translate(-e,-i,!1),n&&this.setTransformForCurrent()}},{key:"rotateDegreesAbout",value:function(t,e,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.translate(e,i,!1),this.rotateDegrees(t,!1),this.translate(-e,-i,!1),n&&this.setTransformForCurrent()}},{key:"beginPath",value:function(){this.disableBeginPath||this.nativeContext.beginPath()}},{key:"clip",value:function(t,e){t?"string"==typeof t?this.nativeContext.clip(t):this.nativeContext.clip(t,e):this.nativeContext.clip()}},{key:"arc",value:function(t,e,i,n,r,a,o){if(o=o||0,this.camera){var s=[];!function(t,e,i,n,r,a,o,s){if(s)for(;i>e;)i-=se;else for(;i<e;)i+=se;for(var l=re/3*(i>e?1:-1),u=e,c=u;c!==i;){c=l>0?Math.min(c+l,i):Math.max(c+l,i);var h=Math.abs(c-u),d=4*Math.tan(h/4)/3,p=c<u?-1:1,f=Math.cos(u),v=Math.sin(u),g=Math.cos(c),y=Math.sin(c),m=f*a+n,_=v*o+r,b=g*a+n,x=y*o+r,k=a*d*p,S=o*d*p;t.push([m-k*v,_+S*f,b+k*y,x-S*g,b,x]),u=c}}(s,n,r,t,e,i,i,a);for(var l=0;l<s.length;++l){var u=s[l];this.bezierCurveTo(u[0],u[1],u[2],u[3],u[4],u[5],o)}}else this.nativeContext.arc(t,e,Math.max(0,i),n,r,a)}},{key:"arcTo",value:function(t,e,i,n,r){this.nativeContext.arcTo(t,e,i,n,r)}},{key:"bezierCurveTo",value:function(t,e,i,n,r,a,o){if(o=o||0,this.camera){var s=o,l=o;this.modelMatrix&&(xg($S,[t,e,o],this.modelMatrix),t=$S[0],e=$S[1],s=$S[2],xg($S,[i,n,o],this.modelMatrix),i=$S[0],n=$S[1],l=$S[2],xg($S,[r,a,o],this.modelMatrix),r=$S[0],a=$S[1],o=$S[2]);var u=this.camera.vp(r,a,o);r=u.x,a=u.y,t=(u=this.camera.vp(t,e,s)).x,e=u.y,i=(u=this.camera.vp(i,n,l)).x,n=u.y}this.nativeContext.bezierCurveTo(t,e,i,n,r,a)}},{key:"closePath",value:function(){this.nativeContext.closePath()}},{key:"ellipse",value:function(t,e,i,n,r,a,o,s){null==s?this.nativeContext.ellipse(t,e,i,n,r,a,o):this.nativeContext.ellipse(t,e,i,n,r,a,o,s)}},{key:"lineTo",value:function(t,e,i){if(i=i||0,this.camera){this.modelMatrix&&(xg($S,[t,e,i],this.modelMatrix),t=$S[0],e=$S[1],i=$S[2]);var n=this.camera.vp(t,e,i);t=n.x,e=n.y}this.nativeContext.lineTo(t,e)}},{key:"moveTo",value:function(t,e,i){if(i=i||0,this.camera){this.modelMatrix&&(xg($S,[t,e,i],this.modelMatrix),t=$S[0],e=$S[1],i=$S[2]);var n=this.camera.vp(t,e,i);t=n.x,e=n.y}this.nativeContext.moveTo(t,e)}},{key:"quadraticCurveTo",value:function(t,e,i,n,r){if(r=r||0,this.camera){var a=r;this.modelMatrix&&(xg($S,[t,e,r],this.modelMatrix),t=$S[0],e=$S[1],a=$S[2],xg($S,[i,n,r],this.modelMatrix),i=$S[0],n=$S[1],r=$S[2]);var o=this.camera.vp(i,n,r);i=o.x,n=o.y,t=(o=this.camera.vp(t,e,a)).x,e=o.y}this.nativeContext.quadraticCurveTo(t,e,i,n)}},{key:"rect",value:function(t,e,i,n,r){r=r||0,this.camera?(this.moveTo(t,e,r),this.lineTo(t+i,e,r),this.lineTo(t+i,e+n,r),this.lineTo(t,e+n,r),this.closePath()):this.nativeContext.rect(t,e,i,n)}},{key:"createImageData",value:function(){var t=arguments;return 2===t.length?this.nativeContext.createImageData(t[0],t[1]):1===t.length?this.nativeContext.createImageData(t[0]):null}},{key:"createLinearGradient",value:function(t,e,i,n){return isFinite(t+e+i+n)||(t=0,e=0,i=0,n=0),this.nativeContext.createLinearGradient(t,e,i,n)}},{key:"createPattern",value:function(t,e){return 0===t.width||0===t.height?null:this.nativeContext.createPattern(t,e)}},{key:"createRadialGradient",value:function(t,e,i,n,r,a){return this.nativeContext.createRadialGradient(t,e,i,n,r,a)}},{key:"createConicGradient",value:function(t,e,i,n){if(this.nativeContext.createConicGradient&&Math.abs(n-i-2*Math.PI)<.001)return this.nativeContext.createConicGradient(i,t,e);var r,a=!1,o=this;return{stops:[],addColorStop:function(t,e){this.stops.push([t,e]),a=!0},GetPattern:function(s,l,u){return a&&(u||(u=n-i),r=function(t,e,i,n,r,a,o,s,l){var u=Math.floor(180*r/Math.PI),c=eg.GetCanvas(),h=eg.GetCtx();if(!h)return null;var d=ng.GetSize(s),p=ng.GetSize(l),f=ng.Get(e,i,n,a,o,d,p);if(f)return f;var v=Math.sqrt(Math.max(Math.max(Math.pow(i,2)+Math.pow(n,2),Math.pow(d-i,2)+Math.pow(n,2)),Math.max(Math.pow(d-i,2)+Math.pow(p-n,2),Math.pow(i,2)+Math.pow(p-n,2)))),g=u+1,y=r/Math.max(1,g-1),m=ig.getInstance().GetOrCreate(i,n,d,p,e,g),_=2*Math.PI*v/360;c.width=d,c.height=p,h.setTransform(1,0,0,1,0,0),h.clearRect(0,0,d,p),h.translate(i,n),h.rotate(a);for(var b=0,x=g-1;b<x&&!(a+b*y>o);b++){var k=m.getColor(b);h.beginPath(),h.rotate(y),h.moveTo(0,0),h.lineTo(v,-2*_),h.lineTo(v,0),h.fillStyle=k,h.closePath(),h.fill()}var S=h.getImageData(0,0,d,p);return c.width=S.width,c.height=S.height,h.putImageData(S,0,0),(f=t.createPattern(c,"no-repeat"))&&ng.Set(e,i,n,a,o,f,d,p),f}(o,this.stops,t,e,u,i,n,s,l),a=!1),r}}}},{key:"fill",value:function(t,e){this.disableFill||(t?this.nativeContext.fill(t):this.nativeContext.fill())}},{key:"fillRect",value:function(t,e,i,n){this.nativeContext.fillRect(t,e,i,n)}},{key:"clearRect",value:function(t,e,i,n){this.nativeContext.clearRect(t,e,i,n)}},{key:"project",value:function(t,e,i){if(i=i||0,this.camera){this.modelMatrix&&(xg($S,[t,e,i],this.modelMatrix),t=$S[0],e=$S[1],i=$S[2]);var n=this.camera.vp(t,e,i);t=n.x,e=n.y}return{x:t,y:e}}},{key:"view",value:function(t,e,i){return i=i||0,this.camera?(this.modelMatrix&&(xg($S,[t,e,i],this.modelMatrix),t=$S[0],e=$S[1],i=$S[2]),this.camera.view(t,e,i)):[t,e,i]}},{key:"fillText",value:function(t,e,i,n){if(n=n||0,this.camera){this.modelMatrix&&(xg($S,[e,i,n],this.modelMatrix),e=$S[0],i=$S[1],n=$S[2]);var r=this.camera.vp(e,i,n);e=r.x,i=r.y}this.nativeContext.fillText(t,e,i)}},{key:"getImageData",value:function(t,e,i,n){return this.nativeContext.getImageData(t,e,i,n)}},{key:"getLineDash",value:function(){return this.nativeContext.getLineDash()}},{key:"isPointInPath",value:function(t,e){return this.nativeContext.isPointInPath(t,e)}},{key:"isPointInStroke",value:function(t,e){return this.nativeContext.isPointInStroke(t,e)}},{key:"measureText",value:function(t){var e,i,n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:nc.global.measureTextMethod;if(!r||"native"===r)return this.nativeContext.measureText(t);this.mathTextMeasure||(this.mathTextMeasure=nc.graphicUtil.createTextMeasureInstance({},{},(function(){return n.canvas.nativeCanvas})));var a=null!==(e=this.fontFamily)&&void 0!==e?e:zu.fontFamily,o=null!==(i=this.fontSize)&&void 0!==i?i:zu.fontSize;return this.mathTextMeasure.textSpec.fontFamily===a&&this.mathTextMeasure.textSpec.fontSize===o||(this.mathTextMeasure.textSpec.fontFamily=a,this.mathTextMeasure.textSpec.fontSize=o,this.mathTextMeasure._numberCharSize=null,this.mathTextMeasure._fullCharSize=null,this.mathTextMeasure._letterCharSize=null,this.mathTextMeasure._specialCharSizeMap={}),this.mathTextMeasure.measure(t,r)}},{key:"putImageData",value:function(t,e,i){this.nativeContext.putImageData(t,e,i)}},{key:"setLineDash",value:function(t){var e=arguments,i=this.nativeContext;this.nativeContext.setLineDash?e[0]&&i.setLineDash(e[0]):"mozDash"in i?i.mozDash=e[0]:"webkitLineDash"in i&&(i.webkitLineDash=e[0])}},{key:"stroke",value:function(t){this.disableStroke||(t?this.nativeContext.stroke(t):this.nativeContext.stroke())}},{key:"strokeRect",value:function(t,e,i,n){this.nativeContext.strokeRect(t,e,i,n)}},{key:"strokeText",value:function(t,e,i,n){if(n=n||0,this.camera){this.modelMatrix&&(xg($S,[e,i,n],this.modelMatrix),e=$S[0],i=$S[1],n=$S[2]);var r=this.camera.vp(e,i,n);e=r.x,i=r.y}this.nativeContext.strokeText(t,e,i)}},{key:"drawImage",value:function(){var t=this.nativeContext,e=arguments;3===e.length?t.drawImage(e[0],e[1],e[2]):5===e.length?t.drawImage(e[0],e[1],e[2],e[3],e[4]):9===e.length&&t.drawImage(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}},{key:"setCommonStyle",value:function(t,e,i,n,r){if(Array.isArray(r)){if(r.length<=1)return this._setCommonStyle(t,e,i,n,r[0]);var a=Object.create(r[0]);return r.forEach((function(t,e){0!==e&&Object.assign(a,t)})),this._setCommonStyle(t,e,i,n,a)}return this._setCommonStyle(t,e,i,n,r)}},{key:"_setCommonStyle",value:function(t,e,i,n,r){var a=this.nativeContext;r||(r=this.fillAttributes);var o=e.fillOpacity,s=void 0===o?r.fillOpacity:o,l=e.opacity,u=void 0===l?r.opacity:l,c=e.fill,h=void 0===c?r.fill:c;a.globalAlpha=s*u*this.baseGlobalAlpha,s>1e-12&&u>1e-12&&(a.fillStyle=sc(this,h,t,i,n))}},{key:"setShadowBlendStyle",value:function(t,e,i){if(Array.isArray(i)){if(i.length<=1)return this._setShadowBlendStyle(t,i[0]);var n=Object.create(i[0]);return i.forEach((function(t,e){0!==e&&Object.assign(n,t)})),this._setShadowBlendStyle(t,e,n)}return this._setShadowBlendStyle(t,e,i)}},{key:"_setShadowBlendStyle",value:function(t,e,i){var n=this.nativeContext;i||(i=this.fillAttributes);var r=e.opacity,a=void 0===r?i.opacity:r,o=e.shadowBlur,s=void 0===o?i.shadowBlur:o,l=e.shadowColor,u=void 0===l?i.shadowColor:l,c=e.shadowOffsetX,h=void 0===c?i.shadowOffsetX:c,d=e.shadowOffsetY,p=void 0===d?i.shadowOffsetY:d,f=e.blur,v=void 0===f?i.blur:f,g=e.filter,y=void 0===g?i.filter:g,m=e.globalCompositeOperation,_=void 0===m?i.globalCompositeOperation:m;a<=1e-12||(s||h||p?(n.shadowBlur=s*this.dpr,n.shadowColor=u,n.shadowOffsetX=h*this.dpr,n.shadowOffsetY=p*this.dpr,this._clearShadowStyle=!0):this._clearShadowStyle&&(n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0),v?(n.filter="blur(".concat(v,"px)"),this._clearFilterStyle=!0):y?(n.filter=y,this._clearFilterStyle=!0):this._clearFilterStyle&&(n.filter="blur(0px)",this._clearFilterStyle=!1),_?(n.globalCompositeOperation=_,this._clearGlobalCompositeOperationStyle=!0):this._clearGlobalCompositeOperationStyle&&(n.globalCompositeOperation="source-over",this._clearGlobalCompositeOperationStyle=!1))}},{key:"setStrokeStyle",value:function(t,e,i,n,r){if(Array.isArray(r)){if(r.length<=1)return this._setStrokeStyle(t,e,i,n,r[0]);var a=Object.create(r[0]);return r.forEach((function(t,e){0!==e&&Object.assign(a,t)})),this._setStrokeStyle(t,e,i,n,a)}return this._setStrokeStyle(t,e,i,n,r)}},{key:"_setStrokeStyle",value:function(t,e,i,n,r){var a=this.nativeContext;r||(r=this.strokeAttributes);var o=e.strokeOpacity,s=void 0===o?r.strokeOpacity:o,l=e.opacity,u=void 0===l?r.opacity:l;if(a.globalAlpha=s*u*this.baseGlobalAlpha,s>1e-12&&u>1e-12){var c=e.lineWidth,h=void 0===c?r.lineWidth:c,d=e.stroke,p=void 0===d?r.stroke:d,f=e.lineJoin,v=void 0===f?r.lineJoin:f,g=e.lineDash,y=void 0===g?r.lineDash:g,m=e.lineDashOffset,_=void 0===m?r.lineDashOffset:m,b=e.lineCap,x=void 0===b?r.lineCap:b,k=e.miterLimit,S=void 0===k?r.miterLimit:k,A=e.keepStrokeScale,M=void 0===A?r.keepStrokeScale:A;a.lineWidth=M?h:oc(this,h,this.dpr),a.strokeStyle=sc(this,p,t,i,n),a.lineJoin=v,y&&(a.setLineDash(y),a.lineDashOffset=_),a.lineCap=x,a.miterLimit=S}}},{key:"setTextStyleWithoutAlignBaseline",value:function(t,e,i){var n=this.nativeContext;e||(e=this.textAttributes);var r=t.scaleIn3d,a=void 0===r?e.scaleIn3d:r;t.font?n.font=t.font:n.font=oi(t,e,a&&this.camera&&this.camera.getProjectionScale(i));var o=t.fontFamily,s=void 0===o?e.fontFamily:o,l=t.fontSize,u=void 0===l?e.fontSize:l;this.fontFamily=s,this.fontSize=u,n.textAlign="left",n.textBaseline="alphabetic"}},{key:"setTextStyle",value:function(t,e,i){var n,r,a=this.nativeContext;e||(e=this.textAttributes),t.font?a.font=t.font:a.font=oi(t,e,this.camera&&this.camera.getProjectionScale(i));var o=t.fontFamily,s=void 0===o?e.fontFamily:o,l=t.fontSize,u=void 0===l?e.fontSize:l;this.fontFamily=s,this.fontSize=u,a.textAlign=null!==(n=t.textAlign)&&void 0!==n?n:e.textAlign,a.textBaseline=null!==(r=t.textBaseline)&&void 0!==r?r:e.textBaseline}},{key:"draw",value:function(){}},{key:"clearMatrix",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.dpr;this.setTransformFromMatrix(this._clearMatrix,t,e)}},{key:"setClearMatrix",value:function(t,e,i,n,r,a){this._clearMatrix.setValue(t,e,i,n,r,a)}},{key:"onlyTranslate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.dpr;return this.matrix.a===t&&0===this.matrix.b&&0===this.matrix.c&&this.matrix.d===t}},{key:"release",value:function(){this.stack.forEach((function(t){return Ag.free(t)})),this.stack.length=0}}])}();tA.env="browser",tA=JS([js(),QS("design:paramtypes",[Object,Number])],tA);var eA=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},iA=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},nA=function(t){function e(t){return r(this,e),n(this,e,[t])}return h(e,t),o(e,[{key:"init",value:function(t){var e=t.container;if("string"==typeof e){var i=nc.global.getElementById(e);i&&(this._container=i)}else this._container=e;this._context=new tA(this,this._dpr),this.initStyle()}},{key:"initStyle",value:function(){if(this.controled){var t=this.nativeCanvas;t.width=this._pixelWidth,t.height=this._pixelHeight,!t.style||this.setCanvasStyle(t,this._x,this._y,this._displayWidth,this._displayHeight),this._container&&this._container.appendChild(t),this.visiable||this.hide()}}},{key:"hide",value:function(){this._nativeCanvas&&(this._nativeCanvas.style.display="none")}},{key:"show",value:function(){this._nativeCanvas&&(this._nativeCanvas.style.display="block")}},{key:"applyPosition",value:function(){var t=this._nativeCanvas;t.style.position="absolute",t.style.top="".concat(this._y,"px"),t.style.left="".concat(this._x,"px")}},{key:"resetStyle",value:function(t){if(this.controled){var e=t.width,i=void 0===e?this._displayWidth:e,n=t.height,r=void 0===n?this._displayHeight:n,a=t.dpr,o=void 0===a?this._dpr:a,s=t.x,l=void 0===s?this._x:s,u=t.y,c=void 0===u?this._y:u,h=this.nativeCanvas;h.width=i*o,h.height=r*o,!h.style||this.setCanvasStyle(h,l,c,i,r),t.id&&(h.id=t.id),this.visiable||this.hide()}}},{key:"setCanvasStyle",value:function(t,e,i,n,r){this.controled&&(t.style.width="".concat(n,"px"),t.style.height="".concat(r,"px"))}},{key:"toDataURL",value:function(t,e){return"image/jpeg"===t?this._nativeCanvas.toDataURL(t,e):"image/png"===t?this._nativeCanvas.toDataURL(t):this._nativeCanvas.toDataURL(t,e)}},{key:"resize",value:function(t,e){this.controled&&(this._pixelWidth=t*this._dpr,this._pixelHeight=e*this._dpr,this._displayWidth=t,this._displayHeight=e,this._nativeCanvas.style&&(this._nativeCanvas.style.width="".concat(t,"px"),this._nativeCanvas.style.height="".concat(e,"px")),this._nativeCanvas.width=this._pixelWidth,this._nativeCanvas.height=this._pixelHeight,this._context.dpr=this._dpr)}}])}(Mx);function rA(t,e){return new Ts((function(i){i(Mc).toDynamicValue((function(){return function(e){return new t(e)}})).whenTargetNamed(t.env),i(wc).toDynamicValue((function(){return function(t,i){return new e(t,i)}})).whenTargetNamed(e.env)}))}nA.env="browser";var aA=rA(nA=eA([js(),iA("design:paramtypes",[Object])],nA),tA),oA=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},sA=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},lA=function(t,e){return function(i,n){e(i,n,t)}},uA=function(t){function e(t,i,a,o){var s;return r(this,e),(s=n(this,e,[a,o])).contributions=t,s.drawContribution=i,s.pickItemInterceptorContributions=a,s.pickServiceInterceptorContributions=o,s.global.hooks.onSetEnv.tap("canvas-picker-service",(function(t,e,i){s.configure(i,e)})),s.configure(s.global,s.global.env),s.pickerMap=new Map,s.init(),s}return h(e,t),o(e,[{key:"init",value:function(){var t=this;this.contributions.getContributions().forEach((function(e){t.pickerMap.set(e.numberType,e)})),y(e,"_init",this,3)([])}},{key:"configure",value:function(t,e){this.pickCanvas=ih.shareCanvas(),this.pickContext=this.pickCanvas.getContext("2d")}},{key:"pickItem",value:function(t,e,i,n){if(!1===t.attribute.pickable)return null;if(this.InterceptorContributions.length)for(var r=0;r<this.InterceptorContributions.length;r++){var a=this.InterceptorContributions[r];if(a.beforePickItem){var o=a.beforePickItem(t,this,e,n,{parentMatrix:i});if(o)return o}}var s=this.pickerMap.get(t.numberType);if(!s)return null;var l=s.contains(t,e,n),u=l?t:null,c={graphic:u,params:l};if(u)return c;if(this.InterceptorContributions.length)for(var h=0;h<this.InterceptorContributions.length;h++){var d=this.InterceptorContributions[h];if(d.afterPickItem){var p=d.afterPickItem(t,this,e,n,{parentMatrix:i});if(p)return p}}return c}}])}(jx);uA=oA([js(),lA(0,zs(nl)),lA(0,Ns(YS)),lA(1,zs(Y_)),lA(2,zs(nl)),lA(2,Ns(db)),lA(3,zs(nl)),lA(3,Ns(pb)),sA("design:paramtypes",[Object,Object,Object,Object])],uA);var cA=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},hA=function(){return o((function t(){r(this,t),this.type="group",this.numberType=sv}),[{key:"contains",value:function(t,e,i){return!1}}])}();hA=cA([js()],hA);var dA=new Ts((function(t,e,i,n){dA.__vloaded||(dA.__vloaded=!0,t(US).to(hA).inSingletonScope(),t(YS).toService(US),al(t,YS))}));dA.__vloaded=!1;var pA=dA,fA=new Ts((function(t,e,i,n){i(uA)||t(uA).toSelf().inSingletonScope(),i(cb)?n(cb).toService(uA):t(cb).toService(uA)}));function vA(t){t.load(pA),t.load(fA)}var gA,yA=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},mA=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},_A=gA=function(t){function e(){var t;return r(this,e),(t=n(this,e)).type="browser",t._canvasIsIntersecting=!0,t.global=nc.global,t.viewBox=new pi,t.modelMatrix=new vi(1,0,0,1,0,0),t}return h(e,t),o(e,[{key:"container",get:function(){return this.canvas.nativeCanvas.parentElement}},{key:"getTitle",value:function(){return this.canvas.id&&this.canvas.id.toString()}},{key:"getWH",value:function(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}},{key:"getXY",value:function(){return this.canvas.nativeCanvas.getBoundingClientRect()}},{key:"createWindow",value:function(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t),this.postInit()}},{key:"postInit",value:function(){if(this.global.optimizeVisible)try{this.observerCanvas()}catch(t){console.error("发生错误，该环境不存在IntersectionObserver")}}},{key:"isElementVisible",value:function(t){var e=t.getBoundingClientRect(),i=window.innerWidth||document.documentElement.clientWidth,n=window.innerHeight||document.documentElement.clientHeight;return!(e.right<0||e.bottom<0||e.left>i||e.top>n)}},{key:"observerCanvas",value:function(){var t=this;this._canvasIsIntersecting=this.isElementVisible(this.canvas.nativeCanvas);var e=new IntersectionObserver((function(e,i){e.forEach((function(e){t._canvasIsIntersecting!==e.isIntersecting?(t._canvasIsIntersecting=e.isIntersecting,t._onVisibleChangeCb&&t._onVisibleChangeCb(e.isIntersecting)):t._canvasIsIntersecting=e.isIntersecting}))}));e&&e.observe(this.canvas.nativeCanvas)}},{key:"createWindowByConfig",value:function(t){var e,i=this.global.createCanvas({width:t.width,height:t.height});if(!(e="string"==typeof t.container?this.global.getElementById(t.container):t.container?t.container:this.global.getRootElement()))throw new Error("发生错误，containerId可能传入有误");t.offscreen?e=null:e.appendChild(i);var n={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:i,container:e,id:gA.GenerateCanvasId(),canvasControled:!0};this.canvas=new nA(n)}},{key:"createWindowByCanvas",value:function(t){var e,i;if("string"==typeof t.canvas){if(!(i=this.global.getElementById(t.canvas)))throw new Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else i=t.canvas;if(!i)throw new Error("发生错误，传入的canvas不正确");var n=t.width,r=t.height;if(null==n||null==r||!t.canvasControled){var a=i.getBoundingClientRect();n=a.width,r=a.height}var o=t.dpr;null==o&&(o=null!==(e=i.getContext("2d").pixelRatio)&&void 0!==e?e:i.width/n),this.canvas=new nA({width:n,height:r,dpr:o,nativeCanvas:i,canvasControled:t.canvasControled})}},{key:"releaseWindow",value:function(){this.canvas.release()}},{key:"resizeWindow",value:function(t,e){this.canvas.resize(t,e)}},{key:"setDpr",value:function(t){this.canvas.dpr=t}},{key:"getContext",value:function(){return this.canvas.getContext()}},{key:"getNativeHandler",value:function(){return this.canvas}},{key:"getDpr",value:function(){return this.canvas.dpr}},{key:"addEventListener",value:function(t,e,i){return this.canvas.nativeCanvas.addEventListener(t,e,i)}},{key:"removeEventListener",value:function(t,e,i){return this.canvas.nativeCanvas.removeEventListener(t,e,i)}},{key:"dispatchEvent",value:function(t){return this.canvas.nativeCanvas.dispatchEvent(t)}},{key:"getStyle",value:function(){var t;return null!==(t=this.canvas.nativeCanvas.style)&&void 0!==t?t:{}}},{key:"setStyle",value:function(t){this.canvas.nativeCanvas.style=t}},{key:"getBoundingClientRect",value:function(){var t=this.canvas.nativeCanvas,e=this.getWH();return t.parentElement?this.canvas.nativeCanvas.getBoundingClientRect():{x:0,y:0,width:e.width,height:e.height,left:0,top:0,right:0,bottom:0}}},{key:"clearViewBox",value:function(t){var e=this.viewBox,i=this.getContext(),n=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(n,0,0,n,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}},{key:"isVisible",value:function(t){return this._canvasIsIntersecting}},{key:"onVisibleChange",value:function(t){this._onVisibleChangeCb=t}},{key:"getTopLeft",value:function(t){return this.global.getElementTopLeft(this.canvas.nativeCanvas,t)}}],[{key:"GenerateCanvasId",value:function(){return"".concat(gA.idprefix,"_").concat(gA.prefix_count++)}}])}(Bx);_A.env="browser",_A.idprefix="visactor_window",_A.prefix_count=0,_A=gA=yA([js(),mA("design:paramtypes",[])],_A);var bA=new Ts((function(t){t(_A).toSelf(),t(oh).toDynamicValue((function(t){return t.container.get(_A)})).whenTargetNamed(_A.env)})),xA=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},kA=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},SA=function(t,e,i,n){return new(i||(i=Promise))((function(r,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,s)}l((n=n.apply(t,e||[])).next())}))},AA=function(){return o((function t(e){r(this,t),this.dom=e}),[{key:"x1",get:function(){return this.dom.getBoundingClientRect().left}},{key:"x2",get:function(){return this.dom.getBoundingClientRect().right}},{key:"y1",get:function(){return this.dom.getBoundingClientRect().top}},{key:"y2",get:function(){return this.dom.getBoundingClientRect().bottom}},{key:"width",get:function(){return this.dom.getBoundingClientRect().width}},{key:"height",get:function(){return this.dom.getBoundingClientRect().height}}])}();function MA(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=document.createElement("img");if(nc.global.isImageAnonymous&&(i.crossOrigin="anonymous"),e){var n=new Blob([t],{type:"image/svg+xml"});t=window.URL.createObjectURL(n)}return i.src=t,i.complete?Promise.resolve(i):new Promise((function(t,e){i.onload=function(){t(i)},i.onerror=function(){e(new Error("加载失败"))}}))}var wA=function(t){function e(){var t;r(this,e),(t=n(this,e)).type="browser",t.supportEvent=!0;try{t.supportsTouchEvents="ontouchstart"in globalThis,t.supportsPointerEvents=!!globalThis.PointerEvent,t.supportsMouseEvents=!!globalThis.MouseEvent}catch(e){t.supportsTouchEvents=!1,t.supportsPointerEvents=!1,t.supportsPointerEvents=!1}return t.applyStyles=!0,t}return h(e,t),o(e,[{key:"mapToCanvasPoint",value:function(t,e){var i,n,r=0,a=0,o=0,s=0;if(t.changedTouches){var l=null!==(i=t.changedTouches[0])&&void 0!==i?i:{};o=r=l.clientX||0,s=a=l.clientY||0}else r=t.clientX||0,a=t.clientY||0,o=t.offsetX||0,s=t.offsetY||0;if(e){var u,c,h=r,d=a,p=e.getBoundingClientRect(),f=null===(n=e.getNativeHandler)||void 0===n?void 0:n.call(e).nativeCanvas;return f&&(u=p.width/f.offsetWidth,c=p.height/f.offsetHeight),{x:(h-p.left)/(Q(u)?u:1),y:(d-p.top)/(Q(c)?c:1)}}return{x:o,y:s}}},{key:"getNativeAABBBounds",value:function(t){var e=t;if("string"==typeof t&&((e=(new DOMParser).parseFromString(t,"text/html").firstChild).lastChild&&(e=e.lastChild.firstChild)),e.getBoundingClientRect){var i=e.getBoundingClientRect();return new AA(i)}return new pi}},{key:"removeDom",value:function(t){return t.parentElement.removeChild(t),!0}},{key:"updateDom",value:function(t,e){var i=e.width,n=e.height,r=e.style;return r&&(Y(r)?t.setAttribute("style",r):Object.keys(r).forEach((function(e){t.style[e]=r[e]}))),null!=i&&(t.style.width="".concat(i,"px")),null!=n&&(t.style.height="".concat(n,"px")),!0}},{key:"createDom",value:function(t){var e=t.tagName,i=void 0===e?"div":e,n=t.parent,r=document.createElement(i);if(this.updateDom(r,t),n){var a=Y(n)?this.getElementById(n):n;a&&a.appendChild&&a.appendChild(r)}return r}},{key:"loadImage",value:function(t){return MA(t,!1).then((function(t){return{data:t,loadState:"success"}})).catch((function(){return{data:null,loadState:"fail"}}))}},{key:"loadSvg",value:function(t){return MA(t,!0).then((function(t){return{data:t,loadState:"success"}})).catch((function(){return{data:null,loadState:"fail"}}))}},{key:"createCanvas",value:function(t){var e,i,n=document.createElement("canvas");t.id&&(n.id=null!==(e=t.id)&&void 0!==e?e:ws.GenAutoIncrementId().toString());var r=null!==(i=t.dpr)&&void 0!==i?i:window.devicePixelRatio;return t.width&&t.height&&(n.style.width="".concat(t.width,"px"),n.style.height="".concat(t.height,"px"),n.width=t.width*r,n.height=t.height*r),n}},{key:"createOffscreenCanvas",value:function(t){var e,i=null!==(e=t.dpr)&&void 0!==e?e:window.devicePixelRatio;return new OffscreenCanvas(t.width*i,t.height*i)}},{key:"releaseCanvas",value:function(t){var e;(e="string"==typeof t?document.getElementById(t):t)&&e.parentElement&&e.parentElement.removeChild(e)}},{key:"getDevicePixelRatio",value:function(){return window.devicePixelRatio}},{key:"getRequestAnimationFrame",value:function(){return window.requestAnimationFrame}},{key:"getCancelAnimationFrame",value:function(){return window.cancelAnimationFrame}},{key:"addEventListener",value:function(t,e,i){return document.addEventListener(t,e,i)}},{key:"removeEventListener",value:function(t,e,i){return document.removeEventListener(t,e,i)}},{key:"dispatchEvent",value:function(t){return document.dispatchEvent(t)}},{key:"getElementById",value:function(t){return document.getElementById(t)}},{key:"getRootElement",value:function(){return document.body}},{key:"getDocument",value:function(){return document}},{key:"release",value:function(){}},{key:"getElementTop",value:function(t,e){for(var i=t.offsetTop,n=t.offsetParent;null!==n;)i+=n.offsetTop,n=n.offsetParent;return i}},{key:"getElementLeft",value:function(t,e){for(var i=t.offsetLeft,n=t.offsetParent;null!==n;)i+=n.offsetLeft,n=n.offsetParent;return i}},{key:"getElementTopLeft",value:function(t,e){for(var i=t.offsetTop,n=t.offsetLeft,r=t.offsetParent;null!==r;)i+=r.offsetTop,n+=r.offsetLeft,r=r.offsetParent;return{top:i,left:n}}},{key:"loadFont",value:function(t,e,i){return SA(this,void 0,void 0,f().mark((function n(){return f().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new FontFace(t,Y(e)?"url(".concat(e,")"):e,i).load().then((function(t){return document.fonts.add(t),{loadState:"success"}})).catch((function(t){return console.error("Failed to load font:",t),{loadState:"fail"}})));case 1:case"end":return n.stop()}}),n)})))}},{key:"isMacOS",value:function(){if(void 0===this._isMacOS)try{this._isMacOS=navigator.platform.toUpperCase().indexOf("MAC")>=0}catch(t){this._isMacOS=!1}return this._isMacOS}},{key:"copyToClipBoard",value:function(t){return navigator.clipboard.writeText(t).then((function(){})).catch((function(t){}))}}])}(Ex);wA=xA([js(),kA("design:paramtypes",[])],wA);var TA=new Ts((function(t){TA.isBrowserBound||(TA.isBrowserBound=!0,t(wA).toSelf().inSingletonScope(),t(ul).toService(wA))}));function CA(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];CA.__loaded||(CA.__loaded=!0,t.load(TA),t.load(aA),t.load(bA),e&&vA(t))}TA.isBrowserBound=!1,CA.__loaded=!1;var EA=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},PA=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"globalAlpha",get:function(){return this._globalAlpha},set:function(t){this.nativeContext.globalAlpha=t*this.baseGlobalAlpha,this._globalAlpha=t*this.baseGlobalAlpha}},{key:"getImageData",value:function(t,e,i,n){var r=this;return new Promise((function(a,o){var s;try{tt.canvasGetImageData({canvasId:null!==(s=r.canvas.nativeCanvas.id)&&void 0!==s?s:r.canvas.id,x:t,y:e,width:i,height:n,success:function(t){a(t)}})}catch(t){o(t)}}))}},{key:"draw",value:function(){var t=this,e=this.nativeContext;e.draw&&(this.drawPromise=new Promise((function(i){e.draw(!0,(function(){t.drawPromise=null,i(null)}))})))}},{key:"createPattern",value:function(t,e){return null}}])}(tA);PA.env="feishu",PA=EA([js()],PA);var RA=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},BA=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},IA=function(t){function e(t){return r(this,e),n(this,e,[t])}return h(e,t),o(e,[{key:"init",value:function(){this._context=new PA(this,this._dpr)}},{key:"release",value:function(){}}])}(Mx);IA.env="feishu";var LA=rA(IA=RA([js(),BA("design:paramtypes",[Object])],IA),PA),DA=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},OA=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},FA=function(t,e){return function(i,n){e(i,n,t)}},zA=function(){return o((function t(){r(this,t),this.cache={}}),[{key:"addEventListener",value:function(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}},{key:"removeEventListener",value:function(t,e){if(t&&e&&this.cache[t]){var i=this.cache[t].listener.findIndex((function(t){return t===e}));i>=0&&this.cache[t].listener.splice(i,1)}}},{key:"cleanEvent",value:function(){this.cache={}}}])}(),HA=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).global=t,i.type="feishu",i.eventManager=new zA,i}return h(e,t),o(e,[{key:"container",get:function(){return null}},{key:"getTitle",value:function(){return this.canvas.id.toString()}},{key:"getWH",value:function(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}},{key:"getXY",value:function(){return{x:0,y:0}}},{key:"createWindow",value:function(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}},{key:"createWindowByConfig",value:function(t){var e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:ws.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new IA(i)}},{key:"createWindowByCanvas",value:function(t){var e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw new Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;var i=t.width,n=t.height;if(null==i||null==n||!t.canvasControled){var r=e.getBoundingClientRect();i=r.width,n=r.height}var a=t.dpr;null==a&&(a=e.width/i),this.canvas=new IA({width:i,height:n,dpr:a,nativeCanvas:e,canvasControled:t.canvasControled})}},{key:"releaseWindow",value:function(){}},{key:"resizeWindow",value:function(t,e){}},{key:"setDpr",value:function(t){this.canvas.dpr=t}},{key:"getContext",value:function(){return this.canvas.getContext()}},{key:"getNativeHandler",value:function(){return this.canvas}},{key:"getDpr",value:function(){return this.canvas.dpr}},{key:"addEventListener",value:function(t,e){this.eventManager.addEventListener(t,e)}},{key:"removeEventListener",value:function(t,e){this.eventManager.removeEventListener(t,e)}},{key:"dispatchEvent",value:function(t){var e=t.type;return!!this.eventManager.cache[e]&&(t.changedTouches&&t.changedTouches[0]&&(t.offsetX=t.changedTouches[0].x,t.changedTouches[0].offsetX=t.changedTouches[0].x,t.changedTouches[0].clientX=t.changedTouches[0].x,t.offsetY=t.changedTouches[0].y,t.changedTouches[0].offsetY=t.changedTouches[0].y,t.changedTouches[0].clientY=t.changedTouches[0].y),t.preventDefault=function(){},t.stopPropagation=function(){},this.eventManager.cache[e].listener&&this.eventManager.cache[e].listener.forEach((function(e){e(t)})),!0)}},{key:"getStyle",value:function(){return{}}},{key:"setStyle",value:function(t){}},{key:"getBoundingClientRect",value:function(){var t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}},{key:"clearViewBox",value:function(t){var e=this.viewBox,i=this.getContext(),n=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(n,0,0,n,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}}])}(Bx);HA.env="feishu",HA=DA([js(),FA(0,zs(cl)),OA("design:paramtypes",[Object])],HA);var jA=new Ts((function(t){t(HA).toSelf(),t(oh).toDynamicValue((function(t){return t.container.get(HA)})).whenTargetNamed(HA.env)})),NA=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},VA=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},WA=function(t,e){return function(i,n){e(i,n,t)}},GA=function(t){function e(t,i,a){var o;return r(this,e),(o=n(this,e,[i,a])).contributions=t,o.pickItemInterceptorContributions=i,o.pickServiceInterceptorContributions=a,o.global.hooks.onSetEnv.tap("math-picker-service",(function(t,e,i){o.configure(i,e)})),o.configure(o.global,o.global.env),o.pickerMap=new Map,o.init(),o}return h(e,t),o(e,[{key:"init",value:function(){var t=this;this.contributions.getContributions().forEach((function(e){t.pickerMap.set(e.numberType,e)})),y(e,"_init",this,3)([])}},{key:"configure",value:function(t,e){this.pickContext=new xx(null,1)}},{key:"pickItem",value:function(t,e,i,n){if(!1===t.attribute.pickable)return null;var r=this.pickerMap.get(t.numberType);if(!r)return null;var a=r.contains(t,e,n),o=a?t:null;return o?{graphic:o,params:a}:null}}])}(jx);GA=NA([js(),WA(0,zs(nl)),WA(0,Ns(mS)),WA(1,zs(nl)),WA(1,Ns(db)),WA(2,zs(nl)),WA(2,Ns(pb)),VA("design:paramtypes",[Object,Object,Object])],GA);var UA=new Ts((function(t){UA.__vloaded||(UA.__vloaded=!0,al(t,mS))}));UA.__vloaded=!1;var YA=UA,XA=function(){return o((function t(){r(this,t)}),[{key:"contains",value:function(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;if(!this.canvasRenderer)return!0;var n=(null!=i?i:{}).pickContext;if(!n)return!1;var r=t.getGraphicTheme();n.highPerformanceSave();var a=t.attribute,o=a.x,s=void 0===o?r.x:o,l=a.y,u=void 0===l?r.y:l;if(t.transMatrix.onlyTranslate()){var c=t.getOffsetXY(r);s+=c.x,u+=c.y,n.setTransformForCurrent()}else s=0,u=0,n.transformFromMatrix(t.transMatrix,!0);var h=!1,d=!1;return this.canvasRenderer.drawShape(t,n,s,u,{},null,(function(t,i,n,r){return!(!h&&!d)||(h=t.isPointInPath(e.x,e.y),d=r||d,h)}),(function(t,i,r,a){if(h||d)return!0;var o=i.lineWidth||r.lineWidth,s=i.pickStrokeBuffer||r.pickStrokeBuffer,l=i.keepStrokeScale||r.keepStrokeScale;return n.lineWidth=l?o+s:oc(n,o+s,n.dpr),h=t.isPointInStroke(e.x,e.y),d=a||d,h})),n.highPerformanceRestore(),h}}])}(),KA=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},qA=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},ZA=function(t,e){return function(i,n){e(i,n,t)}},JA=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="arc",i.numberType=iv,i}return h(e,t),o(e)}(XA);JA=KA([js(),ZA(0,zs(E_)),qA("design:paramtypes",[Object])],JA);var QA=!1,$A=new Ts((function(t,e,i,n){QA||(QA=!0,t(_S).to(JA).inSingletonScope(),t(mS).toService(_S))})),tM=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},eM=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},iM=function(t,e){return function(i,n){e(i,n,t)}},nM=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="area",i.numberType=rv,i}return h(e,t),o(e)}(XA);nM=tM([js(),iM(0,zs(R_)),eM("design:paramtypes",[Object])],nM);var rM=!1,aM=new Ts((function(t,e,i,n){rM||(rM=!0,t(bS).to(nM).inSingletonScope(),t(mS).toService(bS))})),oM=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},sM=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},lM=function(t,e){return function(i,n){e(i,n,t)}},uM=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="circle",i.numberType=av,i}return h(e,t),o(e)}(XA);uM=oM([js(),lM(0,zs(B_)),sM("design:paramtypes",[Object])],uM);var cM=!1,hM=new Ts((function(t,e,i,n){cM||(cM=!0,t(xS).to(uM).inSingletonScope(),t(mS).toService(xS))})),dM=function(){return o((function t(){r(this,t),this.type="glyph",this.numberType=ov}),[{key:"contains",value:function(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;if(!(null!=i?i:{}).pickContext)return!1;var n=null==i?void 0:i.pickerService;if(n){var r=!1;return t.getSubGraphic().forEach((function(t){if(!r){var a=n.pickItem(t,e,null,i);r=!(!a||!a.graphic)}})),r}return!1}}])}(),pM=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},fM=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},vM=function(t,e){return function(i,n){e(i,n,t)}},gM=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i}return h(e,t),o(e)}(dM);gM=pM([js(),vM(0,zs(G_)),fM("design:paramtypes",[Object])],gM);var yM=!1,mM=new Ts((function(t,e,i,n){yM||(yM=!0,t(ES).to(gM).inSingletonScope(),t(gM).toService(ES))})),_M=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},bM=function(){return o((function t(){r(this,t),this.type="image",this.numberType=lv}),[{key:"contains",value:function(t,e,i){return!!(null!=i?i:{}).pickContext&&!!t.AABBBounds.containsPoint(e)}}])}();bM=_M([js()],bM);var xM=!1,kM=new Ts((function(t,e,i,n){xM||(xM=!0,t(kS).to(bM).inSingletonScope(),t(bM).toService(kS))})),SM=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},AM=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},MM=function(t,e){return function(i,n){e(i,n,t)}},wM=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="line",i.numberType=uv,i}return h(e,t),o(e)}(XA);wM=SM([js(),MM(0,zs(D_)),AM("design:paramtypes",[Object])],wM);var TM=!1,CM=new Ts((function(t,e,i,n){TM||(TM=!0,t(SS).to(wM).inSingletonScope(),t(mS).toService(SS))})),EM=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},PM=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},RM=function(t,e){return function(i,n){e(i,n,t)}},BM=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="polygon",i.numberType=hv,i}return h(e,t),o(e)}(XA);BM=EM([js(),RM(0,zs(F_)),PM("design:paramtypes",[Object])],BM);var IM=!1,LM=new Ts((function(t,e,i,n){IM||(IM=!0,t(CS).to(BM).inSingletonScope(),t(mS).toService(CS))})),DM=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},OM=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},FM=function(t,e){return function(i,n){e(i,n,t)}},zM=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="path",i.numberType=cv,i}return h(e,t),o(e)}(XA);zM=DM([js(),FM(0,zs(O_)),OM("design:paramtypes",[Object])],zM);var HM=!1,jM=new Ts((function(t,e,i,n){HM||(HM=!0,t(AS).to(zM).inSingletonScope(),t(mS).toService(AS))})),NM=new pi,VM=function(){return o((function t(){r(this,t),this.type="rect",this.numberType=pv}),[{key:"contains",value:function(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;var n=(null!=i?i:{}).pickContext;if(!n)return!1;var r=t.getGraphicTheme(),a=t.attribute.cornerRadius,o=void 0===a?r.cornerRadius:a,s=t.attribute,l=s.x,u=void 0===l?r.x:l,c=s.y,h=void 0===c?r.y:c;n.highPerformanceSave();var d=!0;if(t.transMatrix.onlyTranslate()){var p=t.getOffsetXY(r);u+=p.x,h+=p.y,n.setTransformForCurrent()}else u=0,h=0,d=!1,n.transformFromMatrix(t.transMatrix,!0);var f=!0;if(!d||t.shadowRoot||Z(o,!0)&&0!==o||X(o)&&o.some((function(t){return 0!==t})))f=!1,this.canvasRenderer.drawShape(t,n,u,h,{},null,(function(t,i,n){return!!f||(f=t.isPointInPath(e.x,e.y))}),(function(t,i,r){if(f)return!0;var a=i.lineWidth||r.lineWidth,o=i.pickStrokeBuffer||r.pickStrokeBuffer,s=i.keepStrokeScale||r.keepStrokeScale;return n.lineWidth=s?a+o:oc(n,a+o,n.dpr),f=t.isPointInStroke(e.x,e.y)}));else{var v=t.attribute,g=v.fill,y=void 0===g?r.fill:g,m=v.stroke,_=void 0===m?r.stroke:m,b=v.lineWidth,x=void 0===b?r.lineWidth:b;if(y)f=!0;else if(_){var k=t.AABBBounds;NM.setValue(k.x1,k.y1,k.x2,k.y2),NM.expand(-x/2),f=!NM.containsPoint(e)}}return n.highPerformanceRestore(),f}}])}(),WM=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},GM=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},UM=function(t,e){return function(i,n){e(i,n,t)}},YM=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i}return h(e,t),o(e)}(VM);YM=WM([js(),UM(0,zs(z_)),GM("design:paramtypes",[Object])],YM);var XM=!1,KM=new Ts((function(t,e,i,n){XM||(XM=!0,t(MS).to(YM).inSingletonScope(),t(mS).toService(MS))})),qM=!1,ZM=new Ts((function(t,e,i,n){qM||(qM=!0,t(kS).to(bM).inSingletonScope(),t(bM).toService(kS))})),JM=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},QM=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},$M=function(t,e){return function(i,n){e(i,n,t)}},tw=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="symbol",i.numberType=gv,i}return h(e,t),o(e)}(XA);tw=JM([js(),$M(0,zs(j_)),QM("design:paramtypes",[Object])],tw);var ew=!1,iw=new Ts((function(t,e,i,n){ew||(ew=!0,t(wS).to(tw).inSingletonScope(),t(mS).toService(wS))})),nw=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},rw=function(){return o((function t(){r(this,t),this.type="text",this.numberType=yv}),[{key:"contains",value:function(t,e,i){return!!t.AABBBounds.containsPoint(e)}}])}();rw=nw([js()],rw);var aw=!1,ow=new Ts((function(t,e,i,n){aw||(aw=!0,t(TS).to(rw).inSingletonScope(),t(mS).toService(TS))})),sw=new Ts((function(t,e,i,n){i(GA)||t(GA).toSelf().inSingletonScope(),i(cb)?n(cb).toService(GA):t(cb).toService(GA)}));function lw(t){t.load(YA),t.load(sw),t.load($A),t.load(aM),t.load(hM),t.load(mM),t.load(kM),t.load(CM),t.load(LM),t.load(jM),t.load(KM),t.load(ZM),t.load(iw),t.load(ow)}var uw=function(){return o((function t(e,i,n,a,o,s){r(this,t),this.nativeCanvas=e,this.ctx=i,this._w=a,this._h=o,this.id=s,e.id=s,this.dpr=n}),[{key:"width",get:function(){return this._w*this.dpr},set:function(t){}},{key:"height",get:function(){return this._h*this.dpr},set:function(t){}},{key:"offsetWidth",get:function(){return this._w},set:function(t){}},{key:"offsetHeight",get:function(){return this._h},set:function(t){}},{key:"getContext",value:function(){return this.ctx}},{key:"getBoundingClientRect",value:function(){return{width:this._w,height:this._h}}}])}(),cw=function(){return o((function t(e,i,n,a,o,s){r(this,t),this.nativeCanvas=e,this.ctx=i,this._w=a,this._h=o,this.id=s,e.id=s,this.dpr=n}),[{key:"width",get:function(){return this._w*this.dpr},set:function(t){this._w=t/this.dpr,this.nativeCanvas.width=t}},{key:"height",get:function(){return this._h*this.dpr},set:function(t){this._h=t/this.dpr,this.nativeCanvas.height=t}},{key:"offsetWidth",get:function(){return this._w},set:function(t){this._w=t,this.nativeCanvas.width=t*this.dpr}},{key:"offsetHeight",get:function(){return this._h},set:function(t){this._h=t,this.nativeCanvas.height=t*this.dpr}},{key:"getContext",value:function(){return this.ctx}},{key:"getBoundingClientRect",value:function(){return{width:this._w,height:this._h}}}])}(),hw=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},dw=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};var pw=function(t){function e(){var t;r(this,e),(t=n(this,e)).type="feishu",t.supportEvent=!0,t.canvasMap=new Map,t.freeCanvasList=[],t.canvasIdx=0,t.supportsTouchEvents=!0;try{t.supportsPointerEvents=!!globalThis.PointerEvent,t.supportsMouseEvents=!!globalThis.MouseEvent}catch(e){t.supportsPointerEvents=!1,t.supportsMouseEvents=!1}return t.applyStyles=!0,t}return h(e,t),o(e,[{key:"getDynamicCanvasCount",value:function(){return this.freeCanvasList.length}},{key:"getStaticCanvasCount",value:function(){return 9999}},{key:"configure",value:function(t,e){var i,n,r,a,o,s,l;t.env===this.type&&(t.setActiveEnvContribution(this),i=e.domref,n=e.canvasIdLists,r=this.canvasMap,a=e.freeCanvasIdx,o=this.freeCanvasList,s=e.pixelRatio,l=null!=s?s:tt.getSystemInfoSync().pixelRatio,n.forEach((function(t,e){var n=tt.createCanvasContext(t),s=new uw(n.canvas||{},n,l,i.width,i.height,t);n.canvas=s,r.set(t,s),e>=a&&o.push(s)})))}},{key:"loadImage",value:function(t){return Promise.resolve({data:t,loadState:"success"})}},{key:"loadSvg",value:function(t){return Promise.reject()}},{key:"createCanvas",value:function(t){var e=this.freeCanvasList[this.canvasIdx]||this.freeCanvasList[this.freeCanvasList.length-1];return this.canvasIdx++,e}},{key:"createOffscreenCanvas",value:function(t){}},{key:"releaseCanvas",value:function(t){}},{key:"getDevicePixelRatio",value:function(){return tt.getSystemInfoSync().pixelRatio}},{key:"getRequestAnimationFrame",value:function(){return function(t){return fd.call(t)}}},{key:"getCancelAnimationFrame",value:function(){return function(t){fd.clear(t)}}},{key:"addEventListener",value:function(t,e,i){return null}},{key:"removeEventListener",value:function(t,e,i){return null}},{key:"dispatchEvent",value:function(t){return null}},{key:"getElementById",value:function(t){return this.canvasMap.get(t)}},{key:"getRootElement",value:function(){return null}},{key:"getDocument",value:function(){return null}},{key:"release",value:function(){}},{key:"mapToCanvasPoint",value:function(t){var e;return null===(e=null==t?void 0:t.type)||void 0===e||e.startsWith("mouse"),t}}])}(Ex);pw=hw([js(),dw("design:paramtypes",[])],pw);var fw=new Ts((function(t){fw.isFeishuBound||(fw.isFeishuBound=!0,t(pw).toSelf().inSingletonScope(),t(ul).toService(pw))}));function vw(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];vw.__loaded||(vw.__loaded=!0,t.load(fw),t.load(LA),t.load(jA),e&&lw(t))}fw.isFeishuBound=!1,vw.__loaded=!1;var gw=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},yw=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"globalAlpha",get:function(){return this._globalAlpha},set:function(t){this.nativeContext.globalAlpha=t*this.baseGlobalAlpha,this._globalAlpha=t*this.baseGlobalAlpha}},{key:"setLineDash",value:function(t){var e=arguments,i=this.nativeContext;if(this.nativeContext.setLineDash){var n=e[0];if(0===n[0]&&0===n[1])return;n&&i.setLineDash(n)}}},{key:"_setStrokeStyle",value:function(t,e,i,n,r){var a=this.nativeContext;r||(r=this.strokeAttributes);var o=e.strokeOpacity,s=void 0===o?r.strokeOpacity:o,l=e.opacity,u=void 0===l?r.opacity:l;if(s>1e-12&&u>1e-12){var c=e.lineWidth,h=void 0===c?r.lineWidth:c,d=e.stroke,p=void 0===d?r.stroke:d,f=e.lineJoin,v=void 0===f?r.lineJoin:f,g=e.lineDash,y=void 0===g?r.lineDash:g,m=e.lineCap,_=void 0===m?r.lineCap:m,b=e.miterLimit,x=void 0===b?r.miterLimit:b,k=e.keepStrokeScale,S=void 0===k?r.keepStrokeScale:k,A=e.lineDashOffset,M=void 0===A?r.lineDashOffset:A;a.globalAlpha=s*u*this.baseGlobalAlpha,a.lineWidth=S?h:oc(this,h,this.dpr),a.strokeStyle=sc(this,p,t,i,n),a.lineJoin=v,0===y[0]&&0===y[1]||!y||(a.setLineDash(y),a.lineDashOffset=M),a.lineCap=_,a.miterLimit=x}}},{key:"measureText",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:nc.global.measureTextMethod;return this.setTransform(1,0,0,1,0,0,!0,nc.global.devicePixelRatio),{width:y(e,"measureText",this,3)([t,i]).width,fontBoundingBoxDescent:void 0,fontBoundingBoxAscent:void 0,actualBoundingBoxAscent:void 0,actualBoundingBoxDescent:void 0}}},{key:"createPattern",value:function(t,e){return null}},{key:"draw",value:function(){var t=this,e=this.nativeContext;e.draw&&(this.drawPromise=new Promise((function(i){e.draw(!0,(function(){t.drawPromise=null,i(null)}))})))}}])}(tA);yw.env="lynx",yw=gw([js()],yw);var mw=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},_w=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},bw=function(t){function e(t){return r(this,e),n(this,e,[t])}return h(e,t),o(e,[{key:"init",value:function(){this._context=new yw(this,this._dpr)}},{key:"resize",value:function(t,e){this._pixelWidth=t*this._dpr,this._pixelHeight=e*this._dpr,this._displayWidth=t,this._displayHeight=e,this._nativeCanvas.width=this._pixelWidth,this._nativeCanvas.height=this._pixelHeight,this._nativeCanvas.nativeCanvas&&(this._nativeCanvas.nativeCanvas.width=this._pixelWidth,this._nativeCanvas.nativeCanvas.height=this._pixelHeight),this._context.dpr=this._dpr}},{key:"release",value:function(){}}])}(Mx);bw.env="lynx",bw=mw([js(),_w("design:paramtypes",[Object])],bw);var xw=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},kw=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Sw=function(t,e){return function(i,n){e(i,n,t)}},Aw=function(){return o((function t(){r(this,t),this.cache={}}),[{key:"addEventListener",value:function(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}},{key:"removeEventListener",value:function(t,e){if(t&&e&&this.cache[t]){var i=this.cache[t].listener.findIndex((function(t){return t===e}));i>=0&&this.cache[t].listener.splice(i,1)}}},{key:"cleanEvent",value:function(){this.cache={}}}])}(),Mw=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).global=t,i.type="lynx",i.eventManager=new Aw,i}return h(e,t),o(e,[{key:"container",get:function(){return null}},{key:"getTitle",value:function(){return this.canvas.id&&this.canvas.id.toString()}},{key:"getWH",value:function(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}},{key:"getXY",value:function(){return{x:0,y:0}}},{key:"createWindow",value:function(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}},{key:"createWindowByConfig",value:function(t){var e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:ws.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new bw(i)}},{key:"createWindowByCanvas",value:function(t){var e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw new Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;var i=t.width,n=t.height;if(null==i||null==n||!t.canvasControled){var r=e.getBoundingClientRect();i=r.width,n=r.height}var a=t.dpr;null==a&&(a=e.width/i),this.canvas=new bw({width:i,height:n,dpr:a,nativeCanvas:e,canvasControled:t.canvasControled})}},{key:"releaseWindow",value:function(){}},{key:"resizeWindow",value:function(t,e){this.canvas.resize(t,e)}},{key:"setDpr",value:function(t){this.canvas.dpr=t}},{key:"getContext",value:function(){return this.canvas.getContext()}},{key:"getNativeHandler",value:function(){return this.canvas}},{key:"getDpr",value:function(){return this.canvas.dpr}},{key:"addEventListener",value:function(t,e){this.eventManager.addEventListener(t,e)}},{key:"removeEventListener",value:function(t,e){this.eventManager.removeEventListener(t,e)}},{key:"dispatchEvent",value:function(t){var e=t.type;return!!this.eventManager.cache[e]&&(t.changedTouches&&t.changedTouches[0]&&(t.offsetX=t.changedTouches[0].x,t.changedTouches[0].offsetX=t.changedTouches[0].x,t.changedTouches[0].clientX=t.changedTouches[0].x,t.offsetY=t.changedTouches[0].y,t.changedTouches[0].offsetY=t.changedTouches[0].y,t.changedTouches[0].clientY=t.changedTouches[0].y),t.preventDefault=function(){},t.stopPropagation=function(){},this.eventManager.cache[e].listener&&this.eventManager.cache[e].listener.forEach((function(e){e(t)})),!0)}},{key:"getStyle",value:function(){return{}}},{key:"setStyle",value:function(t){}},{key:"getBoundingClientRect",value:function(){var t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}},{key:"clearViewBox",value:function(t){var e=this.viewBox,i=this.getContext(),n=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(n,0,0,n,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}}])}(Bx);Mw.env="lynx",Mw=xw([js(),Sw(0,zs(cl)),kw("design:paramtypes",[Object])],Mw);var ww=new Ts((function(t){t(Mw).toSelf(),t(oh).toDynamicValue((function(t){return t.container.get(Mw)})).whenTargetNamed(Mw.env)})),Tw=rA(bw,yw),Cw=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Ew=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Pw=!1;try{Pw=!!lynx.createCanvasNG}catch(t){}var Rw=function(t){function e(){var t;r(this,e),(t=n(this,e)).type="lynx",t.supportEvent=!0,t.canvasMap=new Map,t.freeCanvasList=[],t.canvasIdx=0,t.supportsTouchEvents=!0;try{t.supportsPointerEvents=!!globalThis.PointerEvent,t.supportsMouseEvents=!!globalThis.MouseEvent}catch(e){t.supportsPointerEvents=!1,t.supportsMouseEvents=!1}return t.applyStyles=!0,t}return h(e,t),o(e,[{key:"configure",value:function(t,e){t.env===this.type&&(t.setActiveEnvContribution(this),function(t,e,i,n,r,a,o){var s=null!=o?o:SystemInfo.pixelRatio;if(e.forEach((function(e,o){var l;a?l=lynx.createOffscreenCanvas():(l=Pw?lynx.createCanvasNG(e):lynx.createCanvas(e),Pw&&l.attachToCanvasView(e)),l.width=t.width*s,l.height=t.height*s;var u=l.getContext("2d"),c=new cw(l,u,s,t.width,t.height,e);i.set(e,c),o>n&&r.push(c)})),!r.length&&lynx.createOffscreenCanvas){var l=lynx.createOffscreenCanvas();l.width=t.width*s,l.height=t.height*s;var u=l.getContext("2d"),c=Math.random().toString(),h=new cw(l,u,s,t.width,t.height,c);i.set(c,h),r.push(h)}}(e.domref,e.canvasIdLists,this.canvasMap,e.freeCanvasIdx,this.freeCanvasList,!!e.offscreen,e.pixelRatio))}},{key:"getDynamicCanvasCount",value:function(){return this.freeCanvasList.length}},{key:"getStaticCanvasCount",value:function(){return 9999}},{key:"loadImage",value:function(t){return function(t){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1])return Promise.reject();var e=lynx.createImage(t);return new Promise((function(t,i){e.onload=function(){t(e)},e.onerror=function(){i(new Error("加载失败"))}}))}(t,!1).then((function(t){return{data:t,loadState:"success"}})).catch((function(){return{data:null,loadState:"fail"}}))}},{key:"loadSvg",value:function(t){return Promise.reject()}},{key:"createCanvas",value:function(t){var e=this.freeCanvasList[this.canvasIdx]||this.freeCanvasList[this.freeCanvasList.length-1];return this.canvasIdx++,e}},{key:"createOffscreenCanvas",value:function(t){}},{key:"releaseCanvas",value:function(t){}},{key:"getDevicePixelRatio",value:function(){return SystemInfo.pixelRatio}},{key:"getRequestAnimationFrame",value:function(){return function(t){return fd.call(t)}}},{key:"getCancelAnimationFrame",value:function(){return function(t){fd.clear(t)}}},{key:"mapToCanvasPoint",value:function(t){var e;return null===(e=null==t?void 0:t.type)||void 0===e||e.startsWith("mouse"),t}},{key:"addEventListener",value:function(t,e,i){return null}},{key:"removeEventListener",value:function(t,e,i){return null}},{key:"dispatchEvent",value:function(t){return null}},{key:"getElementById",value:function(t){return this.canvasMap.get(t)}},{key:"getRootElement",value:function(){return null}},{key:"getDocument",value:function(){return null}},{key:"release",value:function(){}}])}(Ex);Rw=Cw([js(),Ew("design:paramtypes",[])],Rw);var Bw=new Ts((function(t){Bw.isLynxBound||(Bw.isLynxBound=!0,t(Rw).toSelf().inSingletonScope(),t(ul).toService(Rw))}));function Iw(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Iw.__loaded||(Iw.__loaded=!0,t.load(Bw),t.load(Tw),t.load(ww),e&&lw(t))}Bw.isLynxBound=!1,Iw.__loaded=!1;var Lw=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Dw=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Ow=function(t){function e(t,i){var a;r(this,e),a=n(this,e,[t,i]);var o=t.nativeCanvas.getContext("2d");if(!o)throw new Error("发生错误，获取2d上下文失败");return a.nativeContext=o,a.canvas=t,a.matrix=new vi(1,0,0,1,0,0),a.stack=[],a.dpr=null!=i?i:1,a}return h(e,t),o(e,[{key:"release",value:function(){}}])}(tA);Ow.env="node",Ow=Lw([js(),Dw("design:paramtypes",[Object,Number])],Ow);var Fw=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},zw=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Hw=function(t){function e(t){return r(this,e),n(this,e,[t])}return h(e,t),o(e,[{key:"init",value:function(){this._context=new Ow(this,this._dpr),this.nativeCanvas.width=this._pixelWidth,this.nativeCanvas.height=this._pixelHeight}},{key:"release",value:function(){this._nativeCanvas.release&&H(this._nativeCanvas.release)&&this._nativeCanvas.release()}}])}(Mx);Hw.env="node";var jw=rA(Hw=Fw([js(),zw("design:paramtypes",[Object])],Hw),Ow),Nw=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Vw=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Ww=function(t,e){return function(i,n){e(i,n,t)}},Gw=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).global=t,i.type="node",i}return h(e,t),o(e,[{key:"container",get:function(){return null}},{key:"getTitle",value:function(){return""}},{key:"getWH",value:function(){return{width:this.canvas.displayWidth,height:this.canvas.displayHeight}}},{key:"getXY",value:function(){return{x:0,y:0}}},{key:"createWindow",value:function(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}},{key:"createWindowByConfig",value:function(t){var e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:ws.GenAutoIncrementId().toString(),canvasControled:!0};this.canvas=new Hw(i)}},{key:"createWindowByCanvas",value:function(t){var e,i=t.canvas,n=null!==(e=t.dpr)&&void 0!==e?e:1,r=t.width,a=t.height;null!=r&&null!=a&&t.canvasControled||(r=i.width/n,a=i.height/n),this.canvas=new Hw({width:r,height:a,dpr:n,nativeCanvas:i,canvasControled:t.canvasControled})}},{key:"releaseWindow",value:function(){this.canvas.release()}},{key:"resizeWindow",value:function(t,e){this.canvas.resize(t,e)}},{key:"setDpr",value:function(t){this.canvas.dpr=t}},{key:"getContext",value:function(){return this.canvas.getContext()}},{key:"getNativeHandler",value:function(){return this.canvas}},{key:"getDpr",value:function(){return this.canvas.dpr}},{key:"getImageBuffer",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"image/png";return this.canvas.nativeCanvas.toBuffer(t)}},{key:"addEventListener",value:function(t,e,i){}},{key:"dispatchEvent",value:function(t){return!0}},{key:"removeEventListener",value:function(t,e,i){}},{key:"getStyle",value:function(){}},{key:"setStyle",value:function(t){}},{key:"getBoundingClientRect",value:function(){return null}},{key:"clearViewBox",value:function(t){}}])}(Bx);Gw.env="node",Gw=Nw([js(),Ww(0,zs(cl)),Vw("design:paramtypes",[Object])],Gw);var Uw=new Ts((function(t){t(Gw).toSelf(),t(oh).toDynamicValue((function(t){return t.container.get(Gw)})).whenTargetNamed(Gw.env)})),Yw=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Xw=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type="node",t._lastTime=0,t.supportEvent=!1,t}return h(e,t),o(e,[{key:"configure",value:function(t,e){t.env===this.type&&(t.setActiveEnvContribution(this),this.pkg=e)}},{key:"getDynamicCanvasCount",value:function(){return 0}},{key:"getStaticCanvasCount",value:function(){return 999}},{key:"loadJson",value:function(t){var e=fetch(t).then((function(t){return t.json()}));return e.then((function(t){return{data:t,state:"success"}})).catch((function(){return{data:null,state:"fail"}})),e}},{key:"loadArrayBuffer",value:function(t){return fetch(t).then((function(t){return t.arrayBuffer()})).then((function(t){return{data:t,loadState:"success"}})).catch((function(){return{data:null,loadState:"fail"}}))}},{key:"loadImage",value:function(t){var e=this.pkg.loadImage;return e?e(t).then((function(t){return{loadState:t?"success":"fail",data:t}})).catch((function(){return{loadState:"fail",data:null}})):Promise.reject(new Error("node-canvas loadImage could not be found!"))}},{key:"loadSvg",value:function(t){var e=this.pkg.Resvg;if(!e)return Promise.reject(new Error("@resvg/resvg-js svgParser could not be found!"));var i=new e(t).render().asPng();return this.loadImage(i)}},{key:"createCanvas",value:function(t){return this.pkg.createCanvas(t.width,t.height)}},{key:"releaseCanvas",value:function(t){}},{key:"getDevicePixelRatio",value:function(){return 1}},{key:"getRequestAnimationFrame",value:function(){return function(t){return fd.call(t)}}},{key:"getCancelAnimationFrame",value:function(){return function(t){fd.clear(t)}}},{key:"addEventListener",value:function(t,e,i){}},{key:"removeEventListener",value:function(t,e,i){}},{key:"getElementById",value:function(t){return null}},{key:"getRootElement",value:function(){return null}},{key:"dispatchEvent",value:function(t){}},{key:"release",value:function(){}},{key:"createOffscreenCanvas",value:function(t){}}])}(Ex);Xw=Yw([js()],Xw);var Kw=new Ts((function(t){Kw.isNodeBound||(Kw.isNodeBound=!0,t(Xw).toSelf().inSingletonScope(),t(ul).toService(Xw))}));function qw(t){qw.__loaded||(qw.__loaded=!0,t.load(Kw),t.load(jw),t.load(Uw))}Kw.isNodeBound=!1,qw.__loaded=!1;var Zw=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},Jw=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"globalAlpha",get:function(){return this._globalAlpha},set:function(t){this.nativeContext.setGlobalAlpha(t),this._globalAlpha=t}},{key:"draw",value:function(){this.nativeContext.draw()}},{key:"strokeText",value:function(t,e,i){}},{key:"_setCommonStyle",value:function(t,e,i,n,r){var a=this.nativeContext;r||(r=this.fillAttributes);var o=e.fillOpacity,s=void 0===o?r.fillOpacity:o,l=e.opacity,u=void 0===l?r.opacity:l,c=e.fill,h=void 0===c?r.fill:c;s>1e-12&&u>1e-12&&(a.setGlobalAlpha(s*u),a.setFillStyle(sc(this,h,t,i,n)))}},{key:"_setStrokeStyle",value:function(t,e,i,n,r){var a=this.nativeContext;r||(r=this.strokeAttributes);var o=e.strokeOpacity,s=void 0===o?r.strokeOpacity:o,l=e.opacity,u=void 0===l?r.opacity:l;if(s>1e-12&&u>1e-12){var c=e.lineWidth,h=void 0===c?r.lineWidth:c,d=e.stroke,p=void 0===d?r.stroke:d,f=e.lineJoin,v=void 0===f?r.lineJoin:f,g=e.lineDash,y=void 0===g?r.lineDash:g,m=e.lineDashOffset,_=void 0===m?r.lineDashOffset:m,b=e.lineCap,x=void 0===b?r.lineCap:b,k=e.miterLimit,S=void 0===k?r.miterLimit:k,A=e.keepStrokeScale,M=void 0===A?r.keepStrokeScale:A;a.setGlobalAlpha(s*u),a.setLineWidth(M?h:oc(this,h,this.dpr)),a.setStrokeStyle(sc(this,p,t,i,n)),a.setLineJoin(v),y&&(a.setLineDash(y),a.lineDashOffset=_),a.setLineCap(x),a.setMiterLimit(S)}}},{key:"setTextStyleWithoutAlignBaseline",value:function(t,e){var i,n=this.nativeContext;e||(e=this.textAttributes),t.font?n.font=t.font:n.font=oi(t,e),n.setFontSize(null!==(i=t.fontSize)&&void 0!==i?i:e.fontSize)}},{key:"setTextStyle",value:function(t,e){var i,n,r=this.nativeContext;e||(e=this.textAttributes),t.font?r.font=t.font:r.font=oi(t,e),r.setTextAlign(null!==(i=t.textAlign)&&void 0!==i?i:e.textAlign),r.setTextBaseline(null!==(n=t.textBaseline)&&void 0!==n?n:e.textBaseline)}},{key:"createConicGradient",value:function(t,e,i,n){return null}},{key:"createPattern",value:function(t,e){return null}},{key:"getImageData",value:function(t,e,i,n){var r=this,a=this.nativeContext,o=a.taro;if(a&&o)return!a.getImageData&&o.canvasGetImageData?new Promise((function(a,s){try{o.canvasGetImageData({canvasId:r.canvas.nativeCanvas.id,sx:t,sy:e,sw:i,sh:n,success:function(t){a(t)}})}catch(t){s(t)}})):void 0}},{key:"createRadialGradient",value:function(t,e,i,n,r,a){return this.nativeContext.createCircularGradient&&this.nativeContext.createCircularGradient(t,e,i,n,r,a)}}])}(tA);Jw.env="taro",Jw=Zw([js()],Jw);var Qw=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},$w=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},tT=function(t){function e(t){return r(this,e),n(this,e,[t])}return h(e,t),o(e,[{key:"init",value:function(){this._context=new Jw(this,this._dpr)}},{key:"release",value:function(){}}])}(Mx);tT.env="taro";var eT=rA(tT=Qw([js(),$w("design:paramtypes",[Object])],tT),Jw),iT=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},nT=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},rT=function(t,e){return function(i,n){e(i,n,t)}},aT=function(){return o((function t(){r(this,t),this.cache={}}),[{key:"addEventListener",value:function(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}},{key:"removeEventListener",value:function(t,e){if(t&&e&&this.cache[t]){var i=this.cache[t].listener.findIndex((function(t){return t===e}));i>=0&&this.cache[t].listener.splice(i,1)}}},{key:"cleanEvent",value:function(){this.cache={}}}])}(),oT=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).global=t,i.type="taro",i.eventManager=new aT,i}return h(e,t),o(e,[{key:"container",get:function(){return null}},{key:"getTitle",value:function(){return this.canvas.id.toString()}},{key:"getWH",value:function(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}},{key:"getXY",value:function(){return{x:0,y:0}}},{key:"createWindow",value:function(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}},{key:"createWindowByConfig",value:function(t){var e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:ws.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new tT(i)}},{key:"createWindowByCanvas",value:function(t){var e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw new Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;var i=t.width,n=t.height;if(null==i||null==n||!t.canvasControled){var r=e.getBoundingClientRect();i=r.width,n=r.height}var a=t.dpr;null==a&&(a=e.width/i),this.canvas=new tT({width:i,height:n,dpr:a,nativeCanvas:e,canvasControled:t.canvasControled})}},{key:"releaseWindow",value:function(){}},{key:"resizeWindow",value:function(t,e){}},{key:"setDpr",value:function(t){this.canvas.dpr=t}},{key:"getContext",value:function(){return this.canvas.getContext()}},{key:"getNativeHandler",value:function(){return this.canvas}},{key:"getDpr",value:function(){return this.canvas.dpr}},{key:"addEventListener",value:function(t,e){this.eventManager.addEventListener(t,e)}},{key:"removeEventListener",value:function(t,e){this.eventManager.removeEventListener(t,e)}},{key:"dispatchEvent",value:function(t){var e=t.type;return!!this.eventManager.cache[e]&&(t.changedTouches.length>0&&(t.changedTouches.forEach((function(e,i){t.changedTouches[i]=Object.assign(Object.assign({},t.changedTouches[i]),{offsetX:e.x,offsetY:e.y})})),t.offsetX=t.changedTouches[0].offsetX,t.offsetY=t.changedTouches[0].offsetY),t.touches.length>0&&t.touches.forEach((function(e,i){t.touches[i]=Object.assign(Object.assign({},t.touches[i]),{offsetX:e.x,offsetY:e.y})})),t.preventDefault=function(){},t.stopPropagation=function(){},this.eventManager.cache[e].listener&&this.eventManager.cache[e].listener.forEach((function(e){e(t)})),!0)}},{key:"getStyle",value:function(){return{}}},{key:"setStyle",value:function(t){}},{key:"getBoundingClientRect",value:function(){var t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}},{key:"clearViewBox",value:function(t){var e=this.viewBox,i=this.getContext(),n=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(n,0,0,n,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}}])}(Bx);oT.env="taro",oT=iT([js(),rT(0,zs(cl)),nT("design:paramtypes",[Object])],oT);var sT=new Ts((function(t){t(oT).toSelf(),t(oh).toDynamicValue((function(t){return t.container.get(oT)})).whenTargetNamed(oT.env)})),lT=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},uT=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};var cT=function(t){function e(){var t;r(this,e),(t=n(this,e)).type="taro",t.supportEvent=!0,t.canvasMap=new Map,t.freeCanvasList=[],t.canvasIdx=0,t.supportsTouchEvents=!0;try{t.supportsPointerEvents=!!globalThis.PointerEvent,t.supportsMouseEvents=!!globalThis.MouseEvent}catch(e){t.supportsPointerEvents=!1,t.supportsMouseEvents=!1}return t.applyStyles=!0,t}return h(e,t),o(e,[{key:"getDynamicCanvasCount",value:function(){return this.freeCanvasList.length}},{key:"getStaticCanvasCount",value:function(){return 9999}},{key:"mapToCanvasPoint",value:function(t){var e;return null===(e=null==t?void 0:t.type)||void 0===e||e.startsWith("mouse"),t}},{key:"configure",value:function(t,e){var i,n,r,a,o,s,l;t.env===this.type&&(t.setActiveEnvContribution(this),i=e.domref,n=e.canvasIdLists,r=this.canvasMap,a=e.freeCanvasIdx,o=this.freeCanvasList,s=e.taro,l=e.pixelRatio,n.forEach((function(t,e){var n=s.createCanvasContext(t),u=new uw(n.canvas||{},n,l,i.width,i.height,t);return n.canvas=u,r.set(t,u),e>=a&&o.push(u),u})),this.taro=e.taro,this.pixelRatio=e.pixelRatio)}},{key:"loadImage",value:function(t){return Promise.resolve({data:t,loadState:"success"})}},{key:"loadSvg",value:function(t){var e=window||globalThis;if(e.DOMParser){var i=(new e.DOMParser).parseFromString(t,"image/svg+xml").children[0],n=(new XMLSerializer).serializeToString(i),r="data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent(n));return Promise.resolve({data:r,loadState:"success"})}if(e.Blob){var a=new e.Blob([t],{type:"image/svg+xml"}),o=e.URL.createObjectURL(a);return Promise.resolve({data:o,loadState:"success"})}return Promise.reject()}},{key:"createCanvas",value:function(t){var e=this.freeCanvasList[this.canvasIdx]||this.freeCanvasList[this.freeCanvasList.length-1];return this.canvasIdx++,e}},{key:"createOffscreenCanvas",value:function(t){}},{key:"releaseCanvas",value:function(t){}},{key:"getDevicePixelRatio",value:function(){return this.pixelRatio}},{key:"getRequestAnimationFrame",value:function(){return requestAnimationFrame}},{key:"getCancelAnimationFrame",value:function(){return cancelAnimationFrame}},{key:"addEventListener",value:function(t,e,i){return null}},{key:"removeEventListener",value:function(t,e,i){return null}},{key:"dispatchEvent",value:function(t){return null}},{key:"getElementById",value:function(t){return this.canvasMap.get(t)}},{key:"getRootElement",value:function(){return null}},{key:"getDocument",value:function(){return null}},{key:"release",value:function(){}}])}(Ex);cT=lT([js(),uT("design:paramtypes",[])],cT);var hT=new Ts((function(t){hT.isTaroBound||(hT.isTaroBound=!0,t(cT).toSelf().inSingletonScope(),t(ul).toService(cT))}));function dT(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];dT.__loaded||(dT.__loaded=!0,t.load(hT),t.load(eT),t.load(sT),e&&lw(t))}hT.isTaroBound=!1,dT.__loaded=!1;var pT=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},fT=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"draw",value:function(){}},{key:"createPattern",value:function(t,e){return null}}])}(tA);fT.env="wx",fT=pT([js()],fT);var vT=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},gT=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},yT=function(t){function e(t){return r(this,e),n(this,e,[t])}return h(e,t),o(e,[{key:"init",value:function(){this._context=new fT(this,this._dpr)}},{key:"release",value:function(){}}])}(Mx);yT.env="wx";var mT=rA(yT=vT([js(),gT("design:paramtypes",[Object])],yT),fT),_T=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},bT=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},xT=function(t,e){return function(i,n){e(i,n,t)}},kT=function(){return o((function t(){r(this,t),this.cache={}}),[{key:"addEventListener",value:function(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}},{key:"removeEventListener",value:function(t,e){if(t&&e&&this.cache[t]){var i=this.cache[t].listener.findIndex((function(t){return t===e}));i>=0&&this.cache[t].listener.splice(i,1)}}},{key:"cleanEvent",value:function(){this.cache={}}}])}(),ST=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).global=t,i.type="wx",i.eventManager=new kT,i}return h(e,t),o(e,[{key:"container",get:function(){return null}},{key:"getTitle",value:function(){return this.canvas.id.toString()}},{key:"getWH",value:function(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}},{key:"getXY",value:function(){return{x:0,y:0}}},{key:"createWindow",value:function(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}},{key:"createWindowByConfig",value:function(t){var e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:ws.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new yT(i)}},{key:"createWindowByCanvas",value:function(t){var e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw new Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;var i=t.width,n=t.height;if(null==i||null==n||!t.canvasControled){var r=e.getBoundingClientRect();i=r.width,n=r.height}var a=t.dpr;null==a&&(a=e.width/i),this.canvas=new yT({width:i,height:n,dpr:a,nativeCanvas:e,canvasControled:t.canvasControled})}},{key:"releaseWindow",value:function(){}},{key:"resizeWindow",value:function(t,e){}},{key:"setDpr",value:function(t){this.canvas.dpr=t}},{key:"getContext",value:function(){return this.canvas.getContext()}},{key:"getNativeHandler",value:function(){return this.canvas}},{key:"getDpr",value:function(){return this.canvas.dpr}},{key:"addEventListener",value:function(t,e){this.eventManager.addEventListener(t,e)}},{key:"removeEventListener",value:function(t,e){this.eventManager.removeEventListener(t,e)}},{key:"dispatchEvent",value:function(t){var e,i,n,r,a=t.type;return!!this.eventManager.cache[a]&&(t.changedTouches&&t.changedTouches[0]&&(t.offsetX=t.changedTouches[0].x,t.changedTouches[0].offsetX=null!==(e=t.changedTouches[0].x)&&void 0!==e?e:t.changedTouches[0].pageX,t.changedTouches[0].clientX=null!==(i=t.changedTouches[0].x)&&void 0!==i?i:t.changedTouches[0].pageX,t.offsetY=t.changedTouches[0].y,t.changedTouches[0].offsetY=null!==(n=t.changedTouches[0].y)&&void 0!==n?n:t.changedTouches[0].pageY,t.changedTouches[0].clientY=null!==(r=t.changedTouches[0].y)&&void 0!==r?r:t.changedTouches[0].pageY),t.preventDefault=function(){},t.stopPropagation=function(){},this.eventManager.cache[a].listener&&this.eventManager.cache[a].listener.forEach((function(e){e(t)})),!0)}},{key:"getStyle",value:function(){return{}}},{key:"setStyle",value:function(t){}},{key:"getBoundingClientRect",value:function(){var t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}},{key:"clearViewBox",value:function(t){var e=this.viewBox,i=this.getContext(),n=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(n,0,0,n,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}}])}(Bx);ST.env="wx",ST=_T([js(),xT(0,zs(cl)),bT("design:paramtypes",[Object])],ST);var AT=new Ts((function(t){t(ST).toSelf(),t(oh).toDynamicValue((function(t){return t.container.get(ST)})).whenTargetNamed(ST.env)})),MT=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},wT=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},TT=function(t,e,i,n){return new(i||(i=Promise))((function(r,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,s)}l((n=n.apply(t,e||[])).next())}))};var CT=function(t){function e(){var t;r(this,e),(t=n(this,e)).type="wx",t.supportEvent=!0,t.canvasMap=new Map,t.freeCanvasList=[],t.canvasIdx=0,t.supportsTouchEvents=!0;try{t.supportsPointerEvents=!!globalThis.PointerEvent,t.supportsMouseEvents=!!globalThis.MouseEvent}catch(e){t.supportsPointerEvents=!1,t.supportsMouseEvents=!1}return t.applyStyles=!0,t}return h(e,t),o(e,[{key:"configure",value:function(t,e){if(t.env===this.type)return t.setActiveEnvContribution(this),function(t,e,i,n,r,a,o){return TT(this,void 0,void 0,f().mark((function t(){var s,l,u;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s=wx.getSystemInfoSync().pixelRatio,l=f().mark((function t(l){var u;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(u=e[l],t.t0=!o&&i.has(u),t.t0){t.next=5;break}return t.next=5,new Promise((function(t){var e=wx.createSelectorQuery();a&&(e=e.in(a)),e.select("#".concat(u)).fields({node:!0,size:!0}).exec((function(e){if(e[0]){var a=e[0].node,o=e[0].width,c=e[0].height;a.width=o*s,a.height=c*s,i.set(u,a),l>=n&&r.push(a),t(null)}}))}));case 5:case"end":return t.stop()}}),t)})),u=0;case 3:if(!(u<e.length)){t.next=8;break}return t.delegateYield(l(u),"t0",5);case 5:u++,t.next=3;break;case 8:case"end":return t.stop()}}),t)})))}(e.domref,e.canvasIdLists,this.canvasMap,e.freeCanvasIdx,this.freeCanvasList,e.component,e.forceUpdate).then((function(){}))}},{key:"loadImage",value:function(t){return Promise.resolve({data:t,loadState:"success"})}},{key:"loadSvg",value:function(t){return Promise.reject()}},{key:"createCanvas",value:function(t){var e=this.freeCanvasList[this.canvasIdx]||this.freeCanvasList[this.freeCanvasList.length-1];return this.canvasIdx++,e}},{key:"createOffscreenCanvas",value:function(t){}},{key:"releaseCanvas",value:function(t){}},{key:"getDevicePixelRatio",value:function(){return wx.getSystemInfoSync().pixelRatio}},{key:"getRequestAnimationFrame",value:function(){return function(t){return fd.call(t)}}},{key:"getCancelAnimationFrame",value:function(){return function(t){fd.clear(t)}}},{key:"addEventListener",value:function(t,e,i){return null}},{key:"removeEventListener",value:function(t,e,i){return null}},{key:"dispatchEvent",value:function(t){return null}},{key:"getElementById",value:function(t){return this.canvasMap.get(t)}},{key:"getRootElement",value:function(){return null}},{key:"getDocument",value:function(){return null}},{key:"release",value:function(){}},{key:"mapToCanvasPoint",value:function(t){var e;return null===(e=null==t?void 0:t.type)||void 0===e||e.startsWith("mouse"),t}}])}(Ex);CT=MT([js(),wT("design:paramtypes",[])],CT);var ET=new Ts((function(t){ET._isWxBound||(ET._isWxBound=!0,t(CT).toSelf().inSingletonScope(),t(ul).toService(CT))}));function PT(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];PT.__loaded||(PT.__loaded=!0,t.load(ET),t.load(mT),t.load(AT),e&&lw(t))}function RT(t){RT.__loaded||(RT.__loaded=!0,CA(t,!1),vw(t,!1),Iw(t,!1),qw(t),dT(t,!1),PT(t,!1),vA(t),ex.hooks.onSetEnv.tap("loadMathPicker",(function(e,i){"browser"!==i&&lw(t)})))}function BT(){!function(t){RT(t)}(Ac)}ET._isWxBound=!1,PT.__loaded=!1,RT.__loaded=!1;var IT=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},LT=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e)}(PA);LT.env="tt",LT=IT([js()],LT);var DT=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},OT=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},FT=function(t){function e(t){return r(this,e),n(this,e,[t])}return h(e,t),o(e,[{key:"init",value:function(){this._context=new LT(this,this._dpr)}},{key:"release",value:function(){}}])}(Mx);FT.env="tt";var zT=rA(FT=DT([js(),OT("design:paramtypes",[Object])],FT),LT),HT=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},jT=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},NT=function(t,e){return function(i,n){e(i,n,t)}},VT=function(){return o((function t(){r(this,t),this.cache={}}),[{key:"addEventListener",value:function(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}},{key:"removeEventListener",value:function(t,e){if(t&&e&&this.cache[t]){var i=this.cache[t].listener.findIndex((function(t){return t===e}));i>=0&&this.cache[t].listener.splice(i,1)}}},{key:"cleanEvent",value:function(){this.cache={}}}])}(),WT=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).global=t,i.type="tt",i.eventManager=new VT,i}return h(e,t),o(e,[{key:"container",get:function(){return null}},{key:"getTitle",value:function(){return this.canvas.id.toString()}},{key:"getWH",value:function(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}},{key:"getXY",value:function(){return{x:0,y:0}}},{key:"createWindow",value:function(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}},{key:"createWindowByConfig",value:function(t){var e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:ws.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new FT(i)}},{key:"createWindowByCanvas",value:function(t){var e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw new Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;var i=t.width,n=t.height;if(null==i||null==n||!t.canvasControled){var r=e.getBoundingClientRect();i=r.width,n=r.height}var a=t.dpr;null==a&&(a=e.width/i),this.canvas=new FT({width:i,height:n,dpr:a,nativeCanvas:e,canvasControled:t.canvasControled})}},{key:"releaseWindow",value:function(){}},{key:"resizeWindow",value:function(t,e){}},{key:"setDpr",value:function(t){this.canvas.dpr=t}},{key:"getContext",value:function(){return this.canvas.getContext()}},{key:"getNativeHandler",value:function(){return this.canvas}},{key:"getDpr",value:function(){return this.canvas.dpr}},{key:"addEventListener",value:function(t,e){this.eventManager.addEventListener(t,e)}},{key:"removeEventListener",value:function(t,e){this.eventManager.removeEventListener(t,e)}},{key:"dispatchEvent",value:function(t){var e=t.type;return!!this.eventManager.cache[e]&&(t.changedTouches&&t.changedTouches[0]&&(t.offsetX=t.changedTouches[0].x,t.changedTouches[0].offsetX=t.changedTouches[0].x,t.changedTouches[0].clientX=t.changedTouches[0].x,t.offsetY=t.changedTouches[0].y,t.changedTouches[0].offsetY=t.changedTouches[0].y,t.changedTouches[0].clientY=t.changedTouches[0].y),t.preventDefault=function(){},t.stopPropagation=function(){},this.eventManager.cache[e].listener&&this.eventManager.cache[e].listener.forEach((function(e){e(t)})),!0)}},{key:"getStyle",value:function(){return{}}},{key:"setStyle",value:function(t){}},{key:"getBoundingClientRect",value:function(){var t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}},{key:"clearViewBox",value:function(t){var e=this.viewBox,i=this.getContext(),n=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(n,0,0,n,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}}])}(Bx);WT.env="tt",WT=HT([js(),NT(0,zs(cl)),jT("design:paramtypes",[Object])],WT);var GT=new Ts((function(t){t(WT).toSelf(),t(oh).toDynamicValue((function(t){return t.container.get(WT)})).whenTargetNamed(WT.env)})),UT=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},YT=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},XT=function(t,e,i,n){return new(i||(i=Promise))((function(r,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,s)}l((n=n.apply(t,e||[])).next())}))};var KT=function(t){function e(){var t;r(this,e),(t=n(this,e)).type="tt",t.supportEvent=!0,t.canvasMap=new Map,t.freeCanvasList=[],t.canvasIdx=0,t.supportsTouchEvents=!0;try{t.supportsPointerEvents=!!globalThis.PointerEvent,t.supportsMouseEvents=!!globalThis.MouseEvent}catch(e){t.supportsPointerEvents=!1,t.supportsMouseEvents=!1}return t.applyStyles=!0,t}return h(e,t),o(e,[{key:"configure",value:function(t,e){if(t.env===this.type)return t.setActiveEnvContribution(this),function(t,e,i,n,r,a){return XT(this,void 0,void 0,f().mark((function t(){var o,s,l;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=tt.getSystemInfoSync().pixelRatio,s=f().mark((function t(s){var l;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l=e[s],t.next=3,new Promise((function(t){var e=tt.createSelectorQuery();a&&(e=e.in(a)),e.select("#".concat(l)).node().exec((function(e){var a=e[0].node,u=a.width,c=a.height;a.width=u*o,a.height=c*o,i.set(l,a),s>=n&&r.push(a),t(null)}))}));case 3:case"end":return t.stop()}}),t)})),l=0;case 3:if(!(l<e.length)){t.next=8;break}return t.delegateYield(s(l),"t0",5);case 5:l++,t.next=3;break;case 8:case"end":return t.stop()}}),t)})))}(e.domref,e.canvasIdLists,this.canvasMap,e.freeCanvasIdx,this.freeCanvasList,e.component).then((function(){}))}},{key:"loadImage",value:function(t){return Promise.resolve({data:t,loadState:"success"})}},{key:"loadSvg",value:function(t){return Promise.reject()}},{key:"createCanvas",value:function(t){var e=this.freeCanvasList[this.canvasIdx]||this.freeCanvasList[this.freeCanvasList.length-1];return this.canvasIdx++,e}},{key:"createOffscreenCanvas",value:function(t){}},{key:"releaseCanvas",value:function(t){}},{key:"getDevicePixelRatio",value:function(){return tt.getSystemInfoSync().pixelRatio}},{key:"getRequestAnimationFrame",value:function(){return function(t){return fd.call(t)}}},{key:"getCancelAnimationFrame",value:function(){return function(t){fd.clear(t)}}},{key:"addEventListener",value:function(t,e,i){return null}},{key:"removeEventListener",value:function(t,e,i){return null}},{key:"dispatchEvent",value:function(t){return null}},{key:"getElementById",value:function(t){return this.canvasMap.get(t)}},{key:"getRootElement",value:function(){return null}},{key:"getDocument",value:function(){return null}},{key:"release",value:function(){}},{key:"mapToCanvasPoint",value:function(t){var e;return null===(e=null==t?void 0:t.type)||void 0===e||e.startsWith("mouse"),t}}])}(Ex);KT=UT([js(),YT("design:paramtypes",[])],KT);var qT=new Ts((function(t){qT.isTTBound||(qT.isTTBound=!0,t(KT).toSelf().inSingletonScope(),t(ul).toService(KT))}));function ZT(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];ZT.__loaded||(ZT.__loaded=!0,t.load(qT),t.load(zT),t.load(GT),e&&lw(t))}qT.isTTBound=!1,ZT.__loaded=!1;var JT=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},QT=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"globalAlpha",get:function(){return this._globalAlpha},set:function(t){this.nativeContext.globalAlpha=t*this.baseGlobalAlpha,this._globalAlpha=t*this.baseGlobalAlpha}},{key:"setLineDash",value:function(t){var e=arguments,i=this.nativeContext;if(this.nativeContext.setLineDash){var n=e[0];if(0===n[0]&&0===n[1])return;n&&i.setLineDash(n)}}},{key:"_setStrokeStyle",value:function(t,e,i,n,r){var a=this.nativeContext;r||(r=this.strokeAttributes);var o=e.strokeOpacity,s=void 0===o?r.strokeOpacity:o,l=e.opacity,u=void 0===l?r.opacity:l;if(s>1e-12&&u>1e-12){var c=e.lineWidth,h=void 0===c?r.lineWidth:c,d=e.stroke,p=void 0===d?r.stroke:d,f=e.lineJoin,v=void 0===f?r.lineJoin:f,g=e.lineDash,y=void 0===g?r.lineDash:g,m=e.lineCap,_=void 0===m?r.lineCap:m,b=e.miterLimit,x=void 0===b?r.miterLimit:b,k=e.keepStrokeScale,S=void 0===k?r.keepStrokeScale:k,A=e.lineDashOffset,M=void 0===A?r.lineDashOffset:A;a.globalAlpha=s*u*this.baseGlobalAlpha,a.lineWidth=S?h:oc(this,h,this.dpr),a.strokeStyle=sc(this,p,t,i,n),a.lineJoin=v,0===y[0]&&0===y[1]||(y&&a.setLineDash(y),a.lineDashOffset=M),a.lineCap=_,a.miterLimit=x}}},{key:"measureText",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:nc.global.measureTextMethod;return this.setTransform(1,0,0,1,0,0,!0,nc.global.devicePixelRatio),y(e,"measureText",this,3)([t,i])}},{key:"setTextStyleWithoutAlignBaseline",value:function(t,e,i){var n=this.nativeContext;e||(e=this.textAttributes);var r,a=t.scaleIn3d,o=void 0===a?e.scaleIn3d:a;r=t.font?t.font:oi(t,e,o&&this.camera&&this.camera.getProjectionScale(i)),n.font=(r||"").replace("px","vp");var s=t.fontFamily,l=void 0===s?e.fontFamily:s,u=t.fontSize,c=void 0===u?e.fontSize:u;this.fontFamily=l,this.fontSize=c,n.textAlign="left",n.textBaseline="alphabetic"}},{key:"setTextStyle",value:function(t,e,i){var n,r,a=this.nativeContext;e||(e=this.textAttributes);var o;o=t.font?t.font:oi(t,e,this.camera&&this.camera.getProjectionScale(i)),a.font=(o||"").replace("px","vp");var s=t.fontFamily,l=void 0===s?e.fontFamily:s,u=t.fontSize,c=void 0===u?e.fontSize:u;this.fontFamily=l,this.fontSize=c,a.textAlign=null!==(n=t.textAlign)&&void 0!==n?n:e.textAlign,a.textBaseline=null!==(r=t.textBaseline)&&void 0!==r?r:e.textBaseline}},{key:"createPattern",value:function(t,e){return null}},{key:"drawImage",value:function(){var t=this.nativeContext,e=arguments;e[0].drawImage&&(e[0]=e[0].transferToImageBitmap()),3===e.length?t.drawImage(e[0],e[1],e[2]):5===e.length?t.drawImage(e[0],e[1],e[2],e[3],e[4]):9===e.length&&t.drawImage(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}},{key:"draw",value:function(){}}])}(tA);QT.env="harmony",QT=JT([js()],QT);var $T=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},tC=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},eC=function(t){function e(t){return r(this,e),n(this,e,[t])}return h(e,t),o(e,[{key:"init",value:function(){this._context=new QT(this,this._dpr)}},{key:"resize",value:function(t,e){}},{key:"release",value:function(){}}])}(Mx);eC.env="harmony",eC=$T([js(),tC("design:paramtypes",[Object])],eC);var iC=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},nC=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},rC=function(t,e){return function(i,n){e(i,n,t)}},aC=function(){return o((function t(){r(this,t),this.cache={}}),[{key:"addEventListener",value:function(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}},{key:"removeEventListener",value:function(t,e){if(t&&e&&this.cache[t]){var i=this.cache[t].listener.findIndex((function(t){return t===e}));i>=0&&this.cache[t].listener.splice(i,1)}}},{key:"cleanEvent",value:function(){this.cache={}}}])}(),oC=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).global=t,i.type="harmony",i.eventManager=new aC,i}return h(e,t),o(e,[{key:"container",get:function(){return null}},{key:"getTitle",value:function(){return this.canvas.id&&this.canvas.id.toString()}},{key:"getWH",value:function(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}},{key:"getXY",value:function(){return{x:0,y:0}}},{key:"createWindow",value:function(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}},{key:"createWindowByConfig",value:function(t){var e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:ws.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new eC(i)}},{key:"createWindowByCanvas",value:function(t){var e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw new Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;var i=t.width,n=t.height;if(null==i||null==n||!t.canvasControled){var r=e.getBoundingClientRect();i=r.width,n=r.height}this.canvas=new eC({width:i,height:n,dpr:1,nativeCanvas:e,canvasControled:t.canvasControled})}},{key:"releaseWindow",value:function(){}},{key:"resizeWindow",value:function(t,e){this.canvas.resize(t,e)}},{key:"setDpr",value:function(t){this.canvas.dpr=t}},{key:"getContext",value:function(){return this.canvas.getContext()}},{key:"getNativeHandler",value:function(){return this.canvas}},{key:"getDpr",value:function(){return this.canvas.dpr}},{key:"addEventListener",value:function(t,e){this.eventManager.addEventListener(t,e)}},{key:"removeEventListener",value:function(t,e){this.eventManager.removeEventListener(t,e)}},{key:"dispatchEvent",value:function(t){var e=t.type;return!!this.eventManager.cache[e]&&(t.changedTouches&&t.changedTouches[0]&&(t.offsetX=t.changedTouches[0].x,t.changedTouches[0].offsetX=t.changedTouches[0].x,t.changedTouches[0].clientX=t.changedTouches[0].x,t.offsetY=t.changedTouches[0].y,t.changedTouches[0].offsetY=t.changedTouches[0].y,t.changedTouches[0].clientY=t.changedTouches[0].y),t.preventDefault=function(){},t.stopPropagation=function(){},this.eventManager.cache[e].listener&&this.eventManager.cache[e].listener.forEach((function(e){e(t)})),!0)}},{key:"getStyle",value:function(){return{}}},{key:"setStyle",value:function(t){}},{key:"getBoundingClientRect",value:function(){var t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}},{key:"clearViewBox",value:function(t){var e=this.viewBox,i=this.getContext(),n=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(n,0,0,n,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}}])}(Bx);oC.env="harmony",oC=iC([js(),rC(0,zs(cl)),nC("design:paramtypes",[Object])],oC);var sC=new Ts((function(t){t(oC).toSelf(),t(oh).toDynamicValue((function(t){return t.container.get(oC)})).whenTargetNamed(oC.env)})),lC=rA(eC,QT),uC=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},cC=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};var hC=function(t){function e(){var t;r(this,e),(t=n(this,e)).type="harmony",t.supportEvent=!0,t.supportsTouchEvents=!0;try{t.supportsPointerEvents=!!globalThis.PointerEvent,t.supportsMouseEvents=!!globalThis.MouseEvent}catch(e){t.supportsPointerEvents=!1,t.supportsMouseEvents=!1}return t.applyStyles=!0,t.rafSTO=new dd(0),t}return h(e,t),o(e,[{key:"configure",value:function(t,e){t.env===this.type&&t.setActiveEnvContribution(this)}},{key:"getDynamicCanvasCount",value:function(){return 9999}},{key:"getStaticCanvasCount",value:function(){return 9999}},{key:"loadImage",value:function(t){}},{key:"loadSvg",value:function(t){return Promise.reject()}},{key:"createCanvas",value:function(t){return e=t.width,i=t.height,n=t.id,r=new OffscreenCanvas(e,i),a=r.getContext("2d"),new uw({width:e,height:i,context:a,_c:r,getBoundingClientRect:function(){return{width:e,height:i}},getContext:function(){return a}},a,1,e,i,n);var e,i,n,r,a}},{key:"createOffscreenCanvas",value:function(t){}},{key:"releaseCanvas",value:function(t){}},{key:"getDevicePixelRatio",value:function(){return 1}},{key:"getRequestAnimationFrame",value:function(){var t=this;return function(e){return t.rafSTO.call(e)}}},{key:"getCancelAnimationFrame",value:function(){var t=this;return function(e){t.rafSTO.clear(e)}}},{key:"mapToCanvasPoint",value:function(t){var e;return null===(e=null==t?void 0:t.type)||void 0===e||e.startsWith("mouse"),t}},{key:"addEventListener",value:function(t,e,i){return null}},{key:"removeEventListener",value:function(t,e,i){return null}},{key:"dispatchEvent",value:function(t){return null}},{key:"getElementById",value:function(t){return null}},{key:"getRootElement",value:function(){return null}},{key:"getDocument",value:function(){return null}},{key:"release",value:function(){}}])}(Ex);hC=uC([js(),cC("design:paramtypes",[])],hC);var dC=new Ts((function(t){dC.isHarmonyBound||(dC.isHarmonyBound=!0,t(hC).toSelf().inSingletonScope(),t(ul).toService(hC))}));function pC(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];pC.__loaded||(pC.__loaded=!0,t.load(dC),t.load(lC),t.load(sC),e&&lw(t))}dC.isHarmonyBound=!1,pC.__loaded=!1;var fC=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},vC=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},gC=function(t,e){return function(i,n){e(i,n,t)}},yC=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="arc",i.numberType=iv,i}return h(e,t),o(e)}(XA);yC=fC([js(),gC(0,zs(E_)),vC("design:paramtypes",[Object])],yC);var mC=!1,_C=new Ts((function(t,e,i,n){mC||(mC=!0,t(PS).to(yC).inSingletonScope(),t(YS).toService(PS))})),bC=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},xC=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},kC=function(t,e){return function(i,n){e(i,n,t)}},SC=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i}return h(e,t),o(e)}(VM);SC=bC([js(),kC(0,zs(z_)),xC("design:paramtypes",[Object])],SC);var AC=!1,MC=new Ts((function(t,e,i,n){AC||(AC=!0,t(FS).to(SC).inSingletonScope(),t(YS).toService(FS))})),wC=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"contains",value:function(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;var n=(null!=i?i:{}).pickContext;if(!n)return!1;n.highPerformanceSave();var r=t.getGraphicTheme(),a=this.transform(t,r,n),o=a.x,s=a.y,l=a.z,u=a.lastModelMatrix,c=e;if(n.camera){c=e.clone();var h=t.parent.globalTransMatrix;c.x=h.a*e.x+h.c*e.y+h.e,c.y=h.b*e.x+h.d*e.y+h.f}this.canvasRenderer.z=l;var d=!1;return this.canvasRenderer.drawShape(t,n,o,s,{},null,(function(t){return!!d||(d=t.isPointInPath(c.x,c.y))}),(function(t,e,i){if(d)return!0;var r=e.lineWidth||i.lineWidth,a=e.pickStrokeBuffer||i.pickStrokeBuffer,o=e.keepStrokeScale||i.keepStrokeScale;return n.lineWidth=o?r+a:oc(n,r+a,n.dpr),d=t.isPointInStroke(c.x,c.y)})),this.canvasRenderer.z=0,n.modelMatrix!==u&&Mg.free(n.modelMatrix),n.modelMatrix=u,n.highPerformanceRestore(),d}}])}(xm),TC=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},CC=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},EC=function(t,e){return function(i,n){e(i,n,t)}},PC=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="line",i.numberType=uv,i}return h(e,t),o(e)}(wC);PC=TC([js(),EC(0,zs(D_)),CC("design:paramtypes",[Object])],PC);var RC=!1,BC=new Ts((function(t,e,i,n){RC||(RC=!0,t(DS).to(PC).inSingletonScope(),t(YS).toService(DS))})),IC=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},LC=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},DC=function(t,e){return function(i,n){e(i,n,t)}},OC=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="area",i.numberType=rv,i}return h(e,t),o(e)}(XA);OC=IC([js(),DC(0,zs(R_)),LC("design:paramtypes",[Object])],OC);var FC=!1,zC=new Ts((function(t,e,i,n){FC||(FC=!0,t(BS).to(OC).inSingletonScope(),t(YS).toService(BS))})),HC=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"contains",value:function(t,e,i){var n=(null!=i?i:{}).pickContext;if(!n)return!1;var r=t.getGraphicTheme();n.highPerformanceSave();var a=this.transform(t,r,n),o=a.x,s=a.y,l=a.z,u=a.lastModelMatrix,c=e;if(n.camera){c=e.clone();var h=t.parent.globalTransMatrix;c.x=h.a*e.x+h.c*e.y+h.e,c.y=h.b*e.x+h.d*e.y+h.f}this.canvasRenderer.z=l;var d=!1;return this.canvasRenderer.drawShape(t,n,o,s,i,null,(function(t,e,i){return!!d||(d=t.isPointInPath(c.x,c.y))})),this.canvasRenderer.z=0,n.modelMatrix!==u&&Mg.free(n.modelMatrix),n.modelMatrix=u,n.highPerformanceRestore(),d}}])}(xm),jC=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},NC=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},VC=function(t,e){return function(i,n){e(i,n,t)}},WC=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="symbol",i.numberType=gv,i}return h(e,t),o(e,[{key:"contains",value:function(t,e,i){var n=(null!=i?i:{}).pickContext;if(!n)return!1;var r=t.getParsedPath();if(!n.camera){if(!t.AABBBounds.containsPoint(e))return!1;if(r.isSvg||"imprecise"===t.attribute.pickMode)return!0}n.highPerformanceSave();var a=t.getGraphicTheme(),o=this.transform(t,a,n),s=o.x,l=o.y,u=o.z,c=o.lastModelMatrix,h=e;if(n.camera){h=e.clone();var d=t.parent.globalTransMatrix;h.x=d.a*e.x+d.c*e.y+d.e,h.y=d.b*e.x+d.d*e.y+d.f}this.canvasRenderer.z=u;var p=!1;return this.canvasRenderer.drawShape(t,n,s,l,{},null,(function(t,e,i){return!!p||(p=t.isPointInPath(h.x,h.y))}),(function(t,e,i){if(p)return!0;var r=e.lineWidth||i.lineWidth,a=e.pickStrokeBuffer||i.pickStrokeBuffer,o=e.keepStrokeScale||i.keepStrokeScale;return n.lineWidth=o?r+a:oc(n,r+a,n.dpr),p=t.isPointInStroke(h.x,h.y)})),this.canvasRenderer.z=0,n.modelMatrix!==c&&Mg.free(n.modelMatrix),n.modelMatrix=c,n.highPerformanceRestore(),p}}])}(HC);WC=jC([js(),VC(0,zs(j_)),NC("design:paramtypes",[Object])],WC);var GC=!1,UC=new Ts((function(t,e,i,n){GC||(GC=!0,t(HS).to(WC).inSingletonScope(),t(YS).toService(HS))})),YC=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},XC=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},KC=function(t,e){return function(i,n){e(i,n,t)}},qC=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="circle",i.numberType=av,i}return h(e,t),o(e)}(XA);qC=YC([js(),KC(0,zs(B_)),XC("design:paramtypes",[Object])],qC);var ZC=!1,JC=new Ts((function(t,e,i,n){ZC||(ZC=!0,t(IS).to(qC).inSingletonScope(),t(YS).toService(IS))})),QC=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},$C=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},tE=function(t,e){return function(i,n){e(i,n,t)}},eE=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="text",i.numberType=yv,i}return h(e,t),o(e,[{key:"contains",value:function(t,e,i){var n=(null!=i?i:{}).pickContext;if(!n)return!1;var r=t.AABBBounds;if(!n.camera)return!!r.containsPoint(e);n.highPerformanceSave();var a=t.getGraphicTheme(),o=t.attribute.keepDirIn3d,s=!(void 0===o?a.keepDirIn3d:o),l=this.transform(t,a,n,s),u=l.x,c=l.y,h=l.z,d=l.lastModelMatrix;this.canvasRenderer.z=h;var p=e;if(n.camera){p=e.clone();var f=t.parent.globalTransMatrix;p.x=f.a*e.x+f.c*e.y+f.e,p.y=f.b*e.x+f.d*e.y+f.f}var v=!1;return this.canvasRenderer.drawShape(t,n,u,c,{},null,(function(e,i,n){if(v)return!0;var r=t.attribute,o=r.fontSize,s=void 0===o?a.fontSize:o,l=r.textBaseline,d=void 0===l?a.textBaseline:l,f=r.textAlign,g=void 0===f?a.textAlign:f,y=t.AABBBounds,m=y.height(),_=y.width(),b=gg(d,m,s),x=vg(g,_);return e.rect(x+u,b+c,_,m,h),v=e.isPointInPath(p.x,p.y)}),(function(t,e,i){return v})),this.canvasRenderer.z=0,n.modelMatrix!==d&&Mg.free(n.modelMatrix),n.modelMatrix=d,n.highPerformanceRestore(),v}}])}(HC);eE=QC([js(),tE(0,zs(N_)),$C("design:paramtypes",[Object])],eE);var iE=!1,nE=new Ts((function(t,e,i,n){iE||(iE=!0,t(jS).to(eE).inSingletonScope(),t(YS).toService(jS))})),rE=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},aE=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},oE=function(t,e){return function(i,n){e(i,n,t)}},sE=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="path",i.numberType=cv,i}return h(e,t),o(e)}(wC);sE=rE([js(),oE(0,zs(O_)),aE("design:paramtypes",[Object])],sE);var lE=!1,uE=new Ts((function(t,e,i,n){lE||(lE=!0,t(OS).to(sE).inSingletonScope(),t(YS).toService(OS))})),cE=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},hE=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},dE=function(t,e){return function(i,n){e(i,n,t)}},pE=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="polygon",i.numberType=hv,i}return h(e,t),o(e)}(XA);pE=cE([js(),dE(0,zs(F_)),hE("design:paramtypes",[Object])],pE);var fE=!1,vE=new Ts((function(t,e,i,n){fE||(fE=!0,t(NS).to(pE).inSingletonScope(),t(YS).toService(NS))})),gE=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},yE=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},mE=function(t,e){return function(i,n){e(i,n,t)}},_E=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i}return h(e,t),o(e)}(dM);_E=gE([js(),mE(0,zs(G_)),yE("design:paramtypes",[Object])],_E);var bE=!1,xE=new Ts((function(t,e,i,n){bE||(bE=!0,t(GS).to(_E).inSingletonScope(),t(YS).toService(GS))})),kE=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},SE=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},AE=function(t,e){return function(i,n){e(i,n,t)}},ME=function(){return o((function t(e){r(this,t),this.canvasRenderer=e,this.type="richtext",this.numberType=vv}),[{key:"contains",value:function(t,e,i){return!!t.AABBBounds.containsPoint(e)}}])}();ME=kE([js(),AE(0,zs(V_)),SE("design:paramtypes",[Object])],ME);var wE=!1,TE=new Ts((function(t,e,i,n){wE||(wE=!0,t(WS).to(ME).inSingletonScope(),t(YS).toService(WS))})),CE=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},EE=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},PE=function(t,e){return function(i,n){e(i,n,t)}},RE=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="image",i.numberType=lv,i}return h(e,t),o(e)}(XA);RE=CE([js(),PE(0,zs(U_)),EE("design:paramtypes",[Object])],RE);var BE=!1,IE=new Ts((function(t,e,i,n){BE||(BE=!0,t(LS).to(RE).inSingletonScope(),t(YS).toService(LS))})),LE=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},DE=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},OE=function(t,e){return function(i,n){e(i,n,t)}},FE=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="rect3d",i.numberType=fv,i.themeType="rect",i}return h(e,t),o(e)}(HC);FE=LE([js(),OE(0,zs(H_)),DE("design:paramtypes",[Object])],FE);var zE=!1,HE=new Ts((function(t,e,i,n){zE||(zE=!0,t(zS).to(FE).inSingletonScope(),t(YS).toService(zS))})),jE=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},NE=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},VE=function(t,e){return function(i,n){e(i,n,t)}},WE=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="arc3d",i.numberType=nv,i.themeType="arc",i}return h(e,t),o(e)}(HC);WE=jE([js(),VE(0,zs(P_)),NE("design:paramtypes",[Object])],WE);var GE=!1,UE=new Ts((function(t,e,i,n){GE||(GE=!0,t(RS).to(WE).inSingletonScope(),t(YS).toService(RS))})),YE=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},XE=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},KE=function(t,e){return function(i,n){e(i,n,t)}},qE=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).canvasRenderer=t,i.type="pyramid3d",i.numberType=dv,i.themeType="polygon",i}return h(e,t),o(e)}(HC);qE=YE([js(),KE(0,zs(W_)),XE("design:paramtypes",[Object])],qE);var ZE=!1,JE=new Ts((function(t,e,i,n){ZE||(ZE=!0,t(VS).to(qE).inSingletonScope(),t(YS).toService(VS))})),QE=px();function $E(){$E.__loaded||($E.__loaded=!0,By.RegisterGraphicCreator("arc",by),Ac.load(Vx),Ac.load(QE?_C:$A))}$E.__loaded=!1;var tP=$E;function eP(){eP.__loaded||(eP.__loaded=!0,By.RegisterGraphicCreator("arc3d",ky),Lx(),Ox(),Ac.load(Ak),Ac.load(UE))}eP.__loaded=!1;var iP=eP;function nP(){nP.__loaded||(nP.__loaded=!0,By.RegisterGraphicCreator("area",yy),Ac.load(Kx),Ac.load(QE?zC:aM))}nP.__loaded=!1;var rP=nP;function aP(){aP.__loaded||(aP.__loaded=!0,By.RegisterGraphicCreator("circle",Lg),Ac.load(Qx),Ac.load(QE?JC:hM))}aP.__loaded=!1;var oP=aP;function sP(){sP.__loaded||(sP.__loaded=!0,By.RegisterGraphicCreator("glyph",Qg),Ac.load(lk),Ac.load(QE?xE:mM))}sP.__loaded=!1;var lP=sP;function uP(){uP.__loaded||(uP.__loaded=!0,By.RegisterGraphicCreator("group",Iv))}uP.__loaded=!1;var cP=uP;function hP(){hP.__loaded||(hP.__loaded=!0,By.RegisterGraphicCreator("image",ry),Ac.load(vk),Ac.load(QE?IE:kM))}hP.__loaded=!1;var dP=hP;function pP(){pP.__loaded||(pP.__loaded=!0,By.RegisterGraphicCreator("line",Gg),Ac.load(Yx),Ac.load(QE?BC:CM))}pP.__loaded=!1;var fP=pP;function vP(){vP.__loaded||(vP.__loaded=!0,By.RegisterGraphicCreator("path",fy),Ac.load(ik),Ac.load(QE?uE:jM))}vP.__loaded=!1;var gP=vP;function yP(){yP.__loaded||(yP.__loaded=!0,By.RegisterGraphicCreator("polygon",My),Ac.load(rk),Ac.load(QE?vE:LM))}yP.__loaded=!1;var mP=yP;function _P(){_P.__loaded||(_P.__loaded=!0,By.RegisterGraphicCreator("pyramid3d",Ty),Lx(),Ox(),Ac.load(Ck),Ac.load(JE))}_P.__loaded=!1;var bP=_P;function xP(){xP.__loaded||(xP.__loaded=!0,By.RegisterGraphicCreator("rect",Xg),Ac.load(Gx),Ac.load(QE?MC:KM))}xP.__loaded=!1;var kP=xP;function SP(){SP.__loaded||(SP.__loaded=!0,By.RegisterGraphicCreator("rect3d",Zg),Ac.load(bk),Ac.load(HE))}SP.__loaded=!1;var AP=SP;function MP(){MP.__loaded||(MP.__loaded=!0,By.RegisterGraphicCreator("richtext",hy),Ac.load(pk),Ac.load(QE?TE:ZM))}MP.__loaded=!1;var wP=MP;function TP(){TP.__loaded||(TP.__loaded=!0,By.RegisterGraphicCreator("shadowRoot",Ey))}TP.__loaded=!1;var CP=TP;function EP(){EP.__loaded||(EP.__loaded=!0,By.RegisterGraphicCreator("symbol",Ng),Ac.load(Zx),Ac.load(QE?UC:iw))}EP.__loaded=!1;var PP=EP;function RP(){RP.__loaded||(RP.__loaded=!0,By.RegisterGraphicCreator("text",zg),Ac.load(tk),Ac.load(QE?nE:ow))}RP.__loaded=!1;var BP=RP;function IP(t){var e=3735928559^(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0);return e=(e=3432918353*((e=(2654435769^e)+(e<<6)+(e>>2))^t))<<15|e>>>17,e^=e<<25,e+=e<<9,e^=e>>4,e^=e<<18,((e|=1)>>>0)%2147483647/2147483647}function LP(){cP(),kP()}var DP,OP=-.5*Math.PI,FP=1.5*Math.PI,zP="PingFang SC,Helvetica Neue,Microsoft Yahei,system-ui,-apple-system,segoe ui,Roboto,Helvetica,Arial,sans-serif,apple color emoji,segoe ui emoji,segoe ui symbol";!function(t){t.selected="selected",t.selectedReverse="selected_reverse",t.hover="hover",t.hoverReverse="hover_reverse"}(DP||(DP={}));var HP=l(l(l(l({},DP.selectedReverse,{}),DP.selected,{}),DP.hover,{}),DP.hoverReverse,{}),jP={container:"",width:30,height:30,style:{}},NP="scrollDrag";function VP(){return"browser"===ex.env?["pointerup","pointerleave","pointercancel"]:["pointerup","pointerleave","pointerupoutside"]}var WP={debounce:qt,throttle:Zt};LP();var GP=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:ft({},e.defaultAttributes,t)])).name="scrollbar",a._handleTouchMove=function(t){N(a._prePos)&&t.preventDefault()},a._onRailPointerDown=function(t){var e,i=t.viewX,n=t.viewY,r=a.attribute,o=r.direction,s=r.width,l=r.height,u=r.range,c=a._sliderSize,h=g(a._getScrollRange(),2),d=h[0],p=h[1];if("vertical"===o){var f=n-a._viewPosition.y,v=Ut(f-c/2,d,p);e=f/l,a._slider.setAttribute("y",v,!0)}else{var y=i-a._viewPosition.x,m=Ut(y-c/2,d,p);e=y/s,a._slider.setAttribute("x",m,!0)}a.setScrollRange([e-(u[1]-u[0])/2,e+(u[1]-u[0])/2],!1),a.stage&&!a.stage.autoRender&&a.stage.renderNextFrame()},a._onSliderPointerDown=function(t){a._clearDragEvents();var e=a.attribute.stopSliderDownPropagation;(void 0===e||e)&&t.stopPropagation();var i=a.attribute.direction,n=a.stage.eventPointTransform(t),r=n.x,o=n.y;a._prePos="horizontal"===i?r:o,a._dispatchEvent("scrollDown",{pos:a._prePos,event:t});var s=VP(),l="browser"===ex.env?ex:a.stage;l.addEventListener("pointermove",a._onSliderPointerMoveWithDelay,{capture:!0}),s.forEach((function(t){l.addEventListener(t,a._onSliderPointerUp)}))},a._computeScrollValue=function(t){var e,i,n=a.attribute.direction,r=a.stage.eventPointTransform(t),o=r.x,s=r.y,l=a.getSliderRenderBounds(),u=l.width,c=l.height;return"vertical"===n?e=((i=s)-a._prePos)/c:e=((i=o)-a._prePos)/u,[i,e]},a._onSliderPointerMove=function(t){var e=a.attribute.stopSliderMovePropagation;(void 0===e||e)&&t.stopPropagation();var i=a.getScrollRange(),n=g(a._computeScrollValue(t),2),r=n[0],o=n[1];a.setScrollRange([i[0]+o,i[1]+o],!0),a._prePos=r},a._onSliderPointerMoveWithDelay=0===a.attribute.delayTime?a._onSliderPointerMove:WP[a.attribute.delayType](a._onSliderPointerMove,a.attribute.delayTime),a._onSliderPointerUp=function(t){var e=a.attribute,i=e.range,n=e.limitRange,r=void 0===n?[0,1]:n,o=a.getScrollRange(),s=g(a._computeScrollValue(t),2);s[0];var l=s[1],u=[o[0]+l,o[1]+l];a._prePos=null,a._dispatchEvent("scrollUp",{pre:i,value:Yt(u,r[0],r[1])}),a._clearDragEvents()},a}return h(e,t),o(e,[{key:"setScrollRange",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.attribute,n=i.direction,r=void 0===n?"horizontal":n,a=i.limitRange,o=void 0===a?[0,1]:a,s=i.range,l=i.realTime,u=void 0===l||l,c=Yt(t,o[0],o[1]);if(e){var h=this._getSliderPos(c);if(this._slider){var d=h[1]-h[0];this._sliderSize=d,"horizontal"===r?this._slider.setAttributes({x:h[0],width:d},!0):this._slider.setAttributes({y:h[0],height:d},!0),this.stage&&!this.stage.autoRender&&this.stage.renderNextFrame()}}this.attribute.range=c,u&&this._dispatchEvent(NP,{pre:s,value:c})}},{key:"getScrollRange",value:function(){return this.attribute.range}},{key:"bindEvents",value:function(){if(!this.attribute.disableTriggerEvent){var t=this.attribute,e=t.delayType,i=void 0===e?"throttle":e,n=t.delayTime,r=void 0===n?0:n;this._rail&&this._rail.addEventListener("pointerdown",WP[i](this._onRailPointerDown,r)),this._slider&&this._slider.addEventListener("pointerdown",this._onSliderPointerDown),("browser"===ex.env?ex:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1})}}},{key:"render",value:function(){this._reset();var t=this.attribute,e=t.direction,i=void 0===e?"horizontal":e,n=t.width,r=t.height,a=t.range,o=t.limitRange,s=void 0===o?[0,1]:o,l=t.railStyle,u=t.sliderStyle,c=t.padding,h=void 0===c?2:c,d=this.createOrUpdateChild("scrollbar-container",{},"group"),p=d.createOrUpdateChild("scrollbar-rail",Object.assign({x:0,y:0,width:n,height:r},l),"rect");this._rail=p;var f,v=this.getSliderRenderBounds(),g=this._getSliderPos(Yt(a,s[0],s[1])),y=g[1]-g[0];this._sliderSize=y,f="horizontal"===i?{x:g[0],y:v.y1,width:y,height:v.height}:{x:v.x1,y:g[0],width:v.width,height:y};var m=d.createOrUpdateChild("slider",Object.assign(Object.assign(Object.assign(Object.assign({},f),{cornerRadius:this._getDefaultSliderCornerRadius()}),u),{boundsPadding:Ei(h),pickMode:"imprecise"}),"rect");this._slider=m,this._container=d;var _=this._container.AABBBounds;this._viewPosition={x:_.x1,y:_.y1}}},{key:"getSliderRenderBounds",value:function(){if(this._sliderRenderBounds)return this._sliderRenderBounds;var t=this.attribute,e=t.width,i=t.height,n=t.padding,r=g(Ei(void 0===n?2:n),4),a=r[0],o=r[1],s=r[2],l=r[3],u={x1:l,y1:a,x2:e-o,y2:i-s,width:Math.max(0,e-(l+o)),height:Math.max(0,i-(a+s))};return this._sliderRenderBounds=u,u}},{key:"_getDefaultSliderCornerRadius",value:function(){var t=this.attribute,e=t.direction;if(t.round){var i=this.getSliderRenderBounds(),n=i.width,r=i.height;return"horizontal"===e?r:n}return 0}},{key:"_getSliderPos",value:function(t){var e=this.attribute.direction,i=this.getSliderRenderBounds(),n=i.width,r=i.height,a=i.x1,o=i.y1;return"horizontal"===e?[n*t[0]+a,n*t[1]+a]:[r*t[0]+o,r*t[1]+o]}},{key:"_getScrollRange",value:function(){if(this._sliderLimitRange)return this._sliderLimitRange;var t=this.attribute,e=t.limitRange,i=void 0===e?[0,1]:e,n=t.direction,r=g(Yt(i,0,1),2),a=r[0],o=r[1],s=this.getSliderRenderBounds(),l=s.width,u=s.height,c=s.x1,h=s.y1,d=this._sliderSize;return"horizontal"===n?Yt([c+a*l,c+o*l],c,l-d):Yt([h+a*u,h+o*u],h,u-d)}},{key:"_clearDragEvents",value:function(){var t=this,e=VP(),i="browser"===ex.env?ex:this.stage;i.removeEventListener("pointermove",this._onSliderPointerMoveWithDelay,{capture:!0}),e.forEach((function(e){i.removeEventListener(e,t._onSliderPointerUp)}))}},{key:"_reset",value:function(){this._sliderRenderBounds=null,this._sliderLimitRange=null}},{key:"release",value:function(t){y(e,"release",this,3)([t]),("browser"===ex.env?ex:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1}),this._clearDragEvents()}}])}(yS);GP.defaultAttributes={direction:"horizontal",round:!0,sliderSize:20,sliderStyle:{fill:"rgba(0, 0, 0, .5)"},railStyle:{fill:"rgba(0, 0, 0, .0)"},padding:2,scrollRange:[0,1],delayType:"throttle",delayTime:0,realTime:!0};var UP,YP=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},XP=UP=function(){return o((function t(){var e=this;r(this,t),this.name="scrollbar",this.activeEvent="onRegister",this._uid=ws.GenAutoIncrementId(),this.key=this.name+this._uid,this.scroll=function(t){var i,n,r=t.target,a=e.getScrollContainer(r);if(a||e.scrollContainer){if(!a&&e.scrollContainer){if(!e.scrollContainer.g.stage||e.scrollContainer.g.stage!==r.stage)return;var o=e.formatScrollContainer(e.scrollContainer.g);if(!o)return void e.clearScrollbar(e.scrollContainer.g,"all");e.scrollContainer.showH&&!o.showH&&e.clearScrollbar(e.scrollContainer.g,"horizontal"),e.scrollContainer.showV&&!o.showV&&e.clearScrollbar(e.scrollContainer.g,"vertical"),e.scrollContainer=o}else a&&e.scrollContainer&&a.g!==e.scrollContainer.g&&e.clearScrollbar(e.scrollContainer.g,"all");if(e.scrollContainer=null!=a?a:e.scrollContainer,a){var s=a.g;if(s){var l=s.attribute,u=l.width,c=l.height,h=l.scrollX,d=void 0===h?0:h,p=l.scrollY,f=void 0===p?0:p,v=d,g=f,y=a.showH,m=a.showV;e.scrollContainerBounds=(new di).set(0,0,s.attribute.width,s.attribute.height),y&&y&&(le(t.deltaX)>le(t.deltaY)?(y=y&&!0,m=m&&!1):(y=y&&!1,m=m&&!0));var _=e.childrenBounds.width(),b=e.childrenBounds.height();y&&((v=d-(null!==(i=t.deltaX)&&void 0!==i?i:0))>0?v=0:v<u-_&&(v=u-_)),m&&((g=f-(null!==(n=t.deltaY)&&void 0!==n?n:0))>0?g=0:g<c-b&&(g=c-b)),s.setAttributes({scrollX:v,scrollY:g}),e.addOrUpdateScroll(y,m,s.parent,s)}}}},this.handleScrollBarChange=function(t){if(e.scrollContainer&&e.scrollContainerBounds&&e.childrenBounds&&t&&t.target&&t.detail&&t.detail.value){var i=t.target,n=t.detail.value;if("horizontal"===i.attribute.direction){var r=e.childrenBounds.width();e.scrollContainer.g.setAttributes({scrollX:-n[0]*r})}else{var a=e.childrenBounds.height();e.scrollContainer.g.setAttributes({scrollY:-n[0]*a})}}}}),[{key:"activate",value:function(t){this.pluginService=t;var e=this.pluginService.stage;this.childrenBounds=new pi,e.addEventListener("wheel",this.scroll),this.params=UP.defaultParams}},{key:"initEventOfScrollbar",value:function(t,e,i){t.addEventListener("pointerover",(function(){e.setAttribute("visibleAll",!0)})),t.addEventListener("pointermove",(function(){e.setAttribute("visibleAll",!0)})),t.addEventListener("pointerout",(function(){e.setAttribute("visibleAll",!1)})),e.addEventListener("pointerover",(function(){e.setAttribute("visibleAll",!0)})),e.addEventListener("pointerout",(function(){e.setAttribute("visibleAll",!0)})),e.addEventListener("scrollUp",this.handleScrollBarChange),e.addEventListener(NP,this.handleScrollBarChange)}},{key:"addOrUpdateScroll",value:function(t,e,i,n){if(t){var r=this.addOrUpdateHScroll(n,i,!0),a=r.scrollBar;r.isUpdate||this.initEventOfScrollbar(n,a,!0)}else this.clearScrollbar(n,"horizontal");if(e){var o=this.addOrUpdateHScroll(n,i,!1),s=o.scrollBar;o.isUpdate||this.initEventOfScrollbar(n,s,!1)}else this.clearScrollbar(n,"vertical")}},{key:"getDirection",value:function(t){return t?"horizontal":"vertical"}},{key:"addOrUpdateHScroll",value:function(t,e,i){var n,r,a=this.getDirection(i),o="".concat(null!==(n=t.name)&&void 0!==n?n:t._uid,"_").concat(this.getDirection(i),"_").concat(this.name),s=e.children.filter((function(t){return t.name===o})),l=!0,u=s[0],c=this.scrollContainer.g.attribute,h=c.y,d=void 0===h?0:h,p=c.dy,f=void 0===p?0:p,v=c.x,g=void 0===v?0:v,y=c.dx,m=void 0===y?0:y,_=c.height,b=c.width,x=c.zIndex,k={x:0,y:0,direction:a,zIndex:(void 0===x?0:x)+1,visibleAll:!0,padding:[2,0],railStyle:{fill:"rgba(0, 0, 0, .1)"},range:[0,.05]};i?(k.width=this.scrollContainerBounds.width(),k.height=12):(k.height=this.scrollContainerBounds.height(),k.width=12),u?s.length>1&&s.forEach((function(t,e){var i;e&&(null===(i=t.parent)||void 0===i||i.removeChild(t))})):(l=!1,(u=new GP(k)).name=o,e.add(u),u.isScrollBar=!0);var S=this.childrenBounds,A=t.attribute,M=A.scrollX,w=A.scrollY;if(i){var T=Math.min(this.scrollContainerBounds.width()/S.width(),1),C=Math.max(Math.min(M/this.childrenBounds.width(),0),T-1);k.x=g+m,k.y=d+f+_-(null!==(r=k.height)&&void 0!==r?r:0),k.range=[-C,-C+T]}else{var E=Math.min(this.scrollContainerBounds.height()/S.height(),1),P=Math.max(Math.min(w/this.childrenBounds.height(),0),E-1);k.x=g+m+b-this.scrollContainerBounds.width(),k.y=d+f,k.range=[-P,-P+E]}return u.setAttributes(k),{scrollBar:u,isUpdate:l}}},{key:"clearScrollbar",value:function(t,e){t.parent&&t.parent.children.filter((function(t){return t.isScrollBar&&("all"===e||t.attribute.direction===e)})).forEach((function(t){t.parent.removeChild(t)}))}},{key:"formatScrollContainer",value:function(t){if(!t||"group"!==t.type||!t.attribute)return null;var e=t.attribute,i=e.overflow,n=e.width,r=e.height;if(!i||"hidden"===i)return null;var a=!1,o=!1;"scroll"===i?(a=!0,o=!0):o=!(a="scroll-x"===i);var s=this.childrenBounds;return s.clear(),t.forEachChildren((function(t){s.union(t.AABBBounds)})),t.AABBBounds.empty()||(a&&(a=n<s.width()),o&&(o=r<s.height())),a||o?{g:t,showH:a,showV:o}:null}},{key:"getScrollContainer",value:function(t){for(var e=t;e;){var i=this.formatScrollContainer(e);if(i)return i;e=e.parent}return null}},{key:"deactivate",value:function(t){this.pluginService.stage.removeEventListener("wheel",this.scroll)}}])}();XP.defaultParams={timeout:500},XP=UP=YP([js()],XP);var KP=new Ts((function(t,e,i,n){i(XP)||(t(XP).toSelf(),t(xb).toService(XP))}));function qP(t,e){t.forEachChildren((function(t){var i=e(t);t.isContainer&&!i&&qP(t,e)}))}var ZP=function(t){return!j(t)&&!1!==t.visible};function JP(t){return t>=0&&t<Math.PI/2||t>3*Math.PI/2&&t<=2*Math.PI}function QP(t,e,i){return Math.abs(t-e)<i}function $P(t,e,i){return t?{textAlign:"right",textBaseline:"middle"}:{textAlign:e<Math.PI&&i.toLocaleLowerCase().includes("top")||e>Math.PI&&i.toLocaleLowerCase().includes("bottom")?"left":e<Math.PI&&i.toLocaleLowerCase().includes("bottom")||e>Math.PI&&i.toLocaleLowerCase().includes("top")?"right":"center",textBaseline:e<Math.PI&&i.includes("inside")||e>Math.PI&&!i.includes("inside")?"bottom":"top"}}var tR=["#ffffff","#000000"];function eR(t,e,i,n,r,a){if("string"!=typeof t||"string"!=typeof e)return t;var o=new Ti(t).toHex(),s=new Ti(e).toHex();return iR(o,s,i,n,a)?o:function(t,e,i,n,r,a){var o=[];r&&(r instanceof Array?o.push.apply(o,m(r)):o.push(r)),o.push.apply(o,tR);for(var s=0,l=o;s<l.length;s++){var u=l[s];if(t!==u&&iR(u,e,i,n,a))return u}}(o,s,i,n,r,a)}function iR(t,e,i,n,r){if("lightness"===r){var a=Ti.getColorBrightness(new Ti(e));return Ti.getColorBrightness(new Ti(t))<.5?a>=.5:a<.5}return n?nR(t,e)>n:"largeText"===i?nR(t,e)>3:nR(t,e)>4.5}function nR(t,e){var i=rR(t),n=rR(e);return((i>n?i:n)+.05)/((i>n?n:i)+.05)}function rR(t){var e=function(t){for(var e="",i="",n="",r="#"===t[0]?1:0,a=r;a<t.length;a++)"#"!==t[a]&&(a<r+2?e+=t[a]:a<r+4?i+=t[a]:a<r+6&&(n+=t[a]));return[parseInt(e,16),parseInt(i,16),parseInt(n,16)]}(t),i=e[0]/255,n=e[1]/255,r=e[2]/255;return.2126*(i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4))+.7152*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))+.0722*(r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))}function aR(t,e,i,n){var r;switch(t){case"base":r=e;break;case"invertBase":r=i;break;case"similarBase":r=n}return r}function oR(t,e){return[t[0]*e,t[1]*e]}function sR(t){var e=g(t,2),i=e[0],n=e[1];return Math.sqrt(i*i+n*n)}function lR(t,e,i){var n=function(t,e){var i=g(t,2),n=i[0],r=i[1],a=g(e,2),o=a[0],s=a[1],l=Math.sqrt((n*n+r*r)*(o*o+s*s)),u=l&&(n*o+r*s)/l;return Math.acos(Math.min(Math.max(u,-1),1))}(t,e),r=me(t,e)>=0;return i?r?2*Math.PI-n:n:r?n:2*Math.PI-n}var uR=function(t,e,i,n){return new si(Object.assign({defaultFontParams:Object.assign({fontFamily:zP,fontSize:14},n),getTextBounds:i?void 0:Iy,specialCharSet:"-/: .,@%'\"~"+si.ALPHABET_CHAR_SET+si.ALPHABET_CHAR_SET.toUpperCase()},null!=e?e:{}),t)};function cR(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t)return{width:0,height:0};var n=Iy({text:t,fontFamily:e.fontFamily||i.fontFamily||zP,fontSize:e.fontSize||i.fontSize||12,fontWeight:e.fontWeight||i.fontWeight,textAlign:e.textAlign||"center",textBaseline:e.textBaseline,ellipsis:!!e.ellipsis,maxLineWidth:e.maxLineWidth||1/0,lineHeight:e.fontSize||i.fontSize||12});return{width:n.width(),height:n.height()}}function hR(t){var e,i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"type";return V(t.text)&&"type"in t.text?null!==(e=t.text.type)&&void 0!==e?e:"text":n in t&&null!==(i=t[n])&&void 0!==i?i:"text"}function dR(t){var e,i;return N(t.maxLineWidth)&&(t.maxWidth=t.maxLineWidth,delete t.maxLineWidth),t.width=null!==(e=t.width)&&void 0!==e?e:0,t.height=null!==(i=t.height)&&void 0!==i?i:0,t.textConfig=t.text.text||t.text,t}function pR(t){var e=hR(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"type");return"rich"===e?By.richtext(dR(t)):("html"===e?t=function(t){var e=t.text,i=t._originText,n=e.text;return t.html=n,t.text=i,t.renderable=!1,t}(t):"react"===e&&(t=function(t){var e=t.text,i=t._originText,n=e.text;return t.react=n,t.text=i,t.renderable=!1,t}(t)),By.text(t))}function fR(t,e,i,n,r){"right"===t?"center"===i?e.setAttribute("x",n-r/2):"right"===i||"end"===i?e.setAttribute("x",n):e.setAttribute("x",n-r):"center"===i?e.setAttribute("x",n+r/2):"right"===i||"end"===i?e.setAttribute("x",n+r):e.setAttribute("x",n)}var vR=function(t,e){var i=Math.atan2(t,e);return i<0?i+2*Math.PI:i};function gR(t,e){var i=e.x1,n=e.y1,r=e.x2,a=e.y2,o=t.AABBBounds,s=o.x1,l=o.y1,u=o.x2,c=o.y2,h=0,d=0;return s<i&&(h=i-s),l<n&&(d=n-l),u>r&&(h=r-u),c>a&&(d=a-c),{dx:h,dy:d}}function yR(t,e){var i=gR(t,e),n=i.dx,r=i.dy,a=t.attribute,o=a.dx,s=void 0===o?0:o,l=a.dy,u=void 0===l?0:l;n&&t.setAttribute("dx",n+s),r&&t.setAttribute("dy",r+u)}function mR(){cP(),kP(),PP(),wP(),BP()}var _R=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i};mR();var bR=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:ft({},e.defaultAttributes,t)])).name="tag",a._tagStates=[],a._rectStates=[],a._symbolStates=[],a._textStates=[],a}return h(e,t),o(e,[{key:"getBgRect",value:function(){return this._bgRect}},{key:"getTextShape",value:function(){return this._textShape}},{key:"render",value:function(){var t,e,i,n=this;this.cacheStates();var r,a,o,s,l=this.attribute,u=l.text,c=void 0===u?"":u,h=l.textStyle,d=void 0===h?{}:h,p=l.shape,f=void 0===p?{}:p,v=l.panel,g=void 0===v?{}:v,y=l.space,m=void 0===y?4:y,_=l.minWidth,b=l.maxWidth,x=l.padding,k=void 0===x?4:x,S=l.visible,A=l.state,M=l.type,w=l.textAlwaysCenter,T=l.containerTextAlign,C=Ei(k),E=this.createOrUpdateChild("tag-content",{x:0,y:0,zIndex:1},"group"),P=-C[3],R=-C[0],B=C[1]+C[3],I=C[0]+C[2],L=0,D=0,O=f.visible,F=_R(f,["visible"]);if(z(O)){var H=(null==F?void 0:F.size)||10,W=Z(H)?H:Math.max(H[0],H[1]);r=E.createOrUpdateChild("tag-shape",Object.assign(Object.assign({symbolType:"circle",size:H,strokeBoundsBuffer:0},F),{visible:O,x:W/2,y:W/2}),"symbol"),ot(null==A?void 0:A.shape)||(r.states=A.shape),O&&(D=W+m)}if(B+=D,L+=D,function(t){return"rich"===hR(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"type")}({text:c})||"rich"===M){var G=Object.assign(Object.assign(Object.assign({},dR(Object.assign({type:M,text:c},d))),d),{visible:N(c)&&!1!==S,x:L,y:0});j(G.lineHeight)&&(G.lineHeight=d.fontSize),o=(a=E.createOrUpdateChild("tag-text",G,"richtext")).AABBBounds.width(),s=a.AABBBounds.height()}else{var U=Object.assign(Object.assign({text:V(c)&&"type"in c&&"text"===c.type?c.text:c,visible:N(c)&&!1!==S,lineHeight:null==d?void 0:d.fontSize},d),{x:L,y:0});j(U.lineHeight)&&(U.lineHeight=d.fontSize),a=E.createOrUpdateChild("tag-text",U,"text");var Y=cR(U.text,d,null===(e=null===(t=this.stage)||void 0===t?void 0:t.getTheme())||void 0===e?void 0:e.text);o=Y.width,s=Y.height}B+=o;var X=null!==(i=f.size)&&void 0!==i?i:10,K=Z(X)?X:Math.max(X[0],X[1]);I+=Math.max(s,f.visible?K:0);var q=d.textAlign,J=d.textBaseline;(N(_)||N(b))&&(N(_)&&B<_&&(B=_),N(b)&&B>b&&(B=b,a.setAttribute("maxLineWidth",b-C[1]-C[2]))),P=0,R=0;var Q=0;"left"===q||"start"===q?Q=1:"right"===q||"end"===q?Q=-1:"center"===q&&(Q=0),Q?Q<0?(P-=B,r&&r.setAttribute("x",(r.attribute.x||0)-o),E.setAttribute("x",-C[1]-D)):Q>0&&E.setAttribute("x",C[3]):(P-=B/2,r&&r.setAttribute("x",(r.attribute.x||0)-o/2),E.setAttribute("x",-D/2));var $="right"===T||"end"===T,tt="left"===T||"start"===T,et=function(t,e){"richtext"===a.type?a.setAttributes({x:t,textAlign:e,textConfig:xt(a.attribute.textConfig).map((function(t){return Object.assign(Object.assign({},t),{textAlign:e})}))}):a.setAttributes({x:t,textAlign:e})};if((T?"center"===T:w)&&Q){var it=B-C[1]-C[3],nt=o+D,rt=1===Q?(it-nt)/2+D+o/2:C[0]+D-(B/2+nt/2-D)+o/2;if(et(rt,"center"),r){var at=rt-o/2-D+K/2;r.setAttributes({x:at})}}if(tt&&1!==Q){var st=B-C[1]-C[3],lt=0===Q?-st/2+D/2:-B+C[3]+C[1]+D;if(et(lt+D,"left"),r){var ut=lt+K/2;r.setAttributes({x:ut})}}if($&&-1!==Q){var ct=B-C[1]-C[3],ht=0===Q?ct/2+D/2:ct;if(et(ht,"right"),r){var dt=ht-o-D+K/2;r.setAttributes({x:dt})}}"middle"===J?(R-=I/2,r&&r.setAttribute("y",0)):"bottom"===J?(R-=I,r&&r.setAttribute("y",-s/2),E.setAttribute("y",-C[2])):"top"===J&&(E.setAttribute("y",C[0]),r&&r.setAttribute("y",s/2)),ot(null==A?void 0:A.text)||(a.states=A.text);var pt=g.visible,ft=_R(g,["visible"]);if(S&&z(pt)){var vt=this.createOrUpdateChild("tag-panel",Object.assign(Object.assign({},ft),{visible:pt&&!!c,width:B,height:I,x:P,y:R}),"rect");if(ot(null==A?void 0:A.panel)||(vt.states=A.panel),ft.customShape){var gt=ft.customShape;vt.pathProxy=function(t){return gt(n,t,new Ru)}}this._bgRect=vt}this._textShape=a,this._symbol=r,this.resetStates()}},{key:"initAttributes",value:function(t,i){t=(null==i?void 0:i.skipDefault)?t:ft({},e.defaultAttributes,t),y(e,"initAttributes",this,3)([t]),this.render()}},{key:"addState",value:function(t,i,n){y(e,"addState",this,3)([t,i,n]),this._textShape&&this._textShape.addState(t,i,n),this._bgRect&&this._bgRect.addState(t,i,n),this._symbol&&this._symbol.addState(t,i,n)}},{key:"removeState",value:function(t,i){y(e,"removeState",this,3)([t,i]),this._textShape&&this._textShape.removeState(t,i),this._bgRect&&this._bgRect.removeState(t,i),this._symbol&&this._symbol.removeState(t,i)}},{key:"cacheStates",value:function(){var t,e,i,n,r,a,o,s,l,u,c,h,d,p;this._tagStates=null!==(e=null===(t=this.currentStates)||void 0===t?void 0:t.slice())&&void 0!==e?e:[],this._rectStates=null!==(r=null===(n=null===(i=this._bgRect)||void 0===i?void 0:i.currentStates)||void 0===n?void 0:n.slice())&&void 0!==r?r:[],this._symbolStates=null!==(s=null===(o=null===(a=this._symbol)||void 0===a?void 0:a.currentStates)||void 0===o?void 0:o.slice())&&void 0!==s?s:[],this._textStates=null!==(c=null===(u=null===(l=this._textShape)||void 0===l?void 0:l.currentStates)||void 0===u?void 0:u.slice())&&void 0!==c?c:[],this.clearStates(),null===(h=this._bgRect)||void 0===h||h.clearStates(),null===(d=this._symbol)||void 0===d||d.clearStates(),null===(p=this._textShape)||void 0===p||p.clearStates()}},{key:"resetStates",value:function(){var t,e,i;this._tagStates.length&&this.useStates(this._tagStates),this._rectStates.length&&(null===(t=this._bgRect)||void 0===t||t.useStates(this._rectStates)),this._symbolStates.length&&(null===(e=this._symbol)||void 0===e||e.useStates(this._symbolStates)),this._textStates.length&&(null===(i=this._textShape)||void 0===i||i.useStates(this._textStates))}}])}(yS);bR.defaultAttributes={visible:!0,textStyle:{fontSize:12,fill:"#000",textAlign:"left",textBaseline:"top"},space:4,padding:4,shape:{fill:"#000"}};var xR={visible:!0,position:"auto",titleStyle:{fontSize:16,fill:"#08979c"},contentStyle:{fontSize:12,fill:"green"},panel:{visible:!0,fill:"#e6fffb",size:12,space:0,stroke:"#87e8de",lineWidth:1,cornerRadius:4}},kR={poptip:ft({},xR)};var SR=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i},AR=new pi;cP(),BP(),PP(),kP();var MR="M -0.5 -0.5, L -0.5 0.5, L 0.5 -0.5, Z",wR="M -0.5 -0.5, L -0.5 0.5, L 0.5 0.5, Z",TR="M -0.5 -0.5, L 0.5 -0.5, L 0.5 0.5, Z",CR="M 0.5 -0.5, L 0.5 0.5, L -0.5 0.5, Z",ER={tl:MR,tr:TR,bl:wR,br:CR,lt:MR,lb:wR,rt:TR,rb:CR},PR=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:ft({},e.defaultAttributes,t)])).name="poptip",a.positionList=["top","tl","tr","bottom","bl","br","left","lt","lb","right","rt","rb"],a}return h(e,t),o(e,[{key:"render",value:function(){var t,e,i,n,r,a,o,s,l,u=this.attribute,c=u.titleStyle,h=void 0===c?{}:c,d=u.position,p=u.contentStyle,f=void 0===p?{}:p,v=u.panel,g=u.logoSymbol,y=u.poptipAnchor,m=void 0===y?"position":y,_=u.logoText,b=u.logoTextStyle,x=void 0===b?{}:b,k=u.triangleMode,S=void 0===k?"default":k,A=u.space,M=void 0===A?4:A,w=u.minWidth,T=void 0===w?0:w,C=u.maxWidth,E=void 0===C?1/0:C,P=u.padding,R=void 0===P?4:P,B=u.maxWidthPercent,I=u.visible,L=u.state,D=u.dx,O=void 0===D?0:D,F=u.dy,H=void 0===F?0:F,j=u.positionBounds,V=this.attribute,W=V.title,G=void 0===W?"":W,U=V.content,Y=void 0===U?"":U;G=this.attribute.titleFormatMethod?this.attribute.titleFormatMethod(G):G,Y=this.attribute.contentFormatMethod?this.attribute.contentFormatMethod(Y):Y;var K=Ei(R),q=this.createOrUpdateChild("poptip-content",{x:0,y:0,zIndex:1},"group");this.group=q;var Z=E-K[1]-K[3],J=N(G)&&!1!==I,Q=Object.assign(Object.assign({text:X(G)?G:[G],visible:J,wrap:!0},h),{x:K[3],y:K[0],maxLineWidth:Z,textAlign:"left",textBaseline:"top"}),$=q.createOrUpdateChild("poptip-title",Q,"text");ot(null==L?void 0:L.title)||($.states=L.title);var tt=$.AABBBounds,et=tt.height(),it=tt.width(),nt=et+M;J||(nt=0);var rt=N(Y)&&!1!==I,at=Object.assign(Object.assign({text:X(Y)?Y:[Y],visible:rt,wrap:!0},f),{x:K[3],y:K[0]+nt,maxLineWidth:Z,textAlign:"left",textBaseline:"top"}),st=q.createOrUpdateChild("poptip-content",at,"text");ot(null==L?void 0:L.content)||(st.states=L.content);var lt=st.AABBBounds,ut=lt.height(),ct=lt.width();rt&&(nt+=ut),this.titleShape=$,this.contentShape=st;var ht=he(it+K[1]+K[3],ct+K[1]+K[3]);ht>E?ht=E:ht<T&&(ht=T);var dt=K[0]+K[2]+nt,pt=v.visible,ft=v.square,vt=SR(v,["visible","square"]);if(ft){var gt=he(ht,dt);ht=gt;var yt=gt-dt;dt=gt,$.setAttributes({dy:yt/2}),st.setAttributes({dy:yt/2})}var mt=null!==(t=vt.size)&&void 0!==t?t:12,_t=X(mt)?[mt[0]+(null!==(e=vt.space)&&void 0!==e?e:0),mt[1]+(null!==(i=vt.space)&&void 0!==i?i:0)]:mt+(null!==(n=vt.space)&&void 0!==n?n:0),bt=null!==(r=vt.lineWidth)&&void 0!==r?r:1,xt=this.stage?[null!==(a=this.stage.viewWidth)&&void 0!==a?a:this.stage.width,null!==(o=this.stage.viewHeight)&&void 0!==o?o:this.stage.height]:void 0;if(xt){var kt=this.AABBBounds,St=null!==(s=this.attribute.x)&&void 0!==s?s:kt.x1,At=xt[0]-kt.x1,Mt=Math.max(St,At),wt=(X(mt)?mt[0]:12)+3;if((Mt=Math.min(Mt-wt,Mt*B))<ht){ht=Mt;var Tt=K[1]+K[3];$.setAttribute("maxLineWidth",Mt-Tt),st.setAttribute("maxLineWidth",Mt-Tt),dt=K[0]+K[2],J&&(dt+=$.AABBBounds.height()+M),dt+=st.AABBBounds.height()}}for(var Ct,Et="auto"===d||X(d),Pt=X(d)?d:this.positionList,Rt=-1/0,Bt=0;Bt<Pt.length+1;Bt++){var It=Et?Pt[Bt===Pt.length?Ct:Bt]:d,Lt="arrow2Left",Dt=(X(mt)?mt[0]:mt)/4,Ot=0;"top"===It||"bottom"===It||"left"===It||"right"===It?Lt="arrow2Left":"concise"===S&&(Lt=ER[It],Dt=["tl","bl","rt","rb"].includes(It)?(X(mt)?mt[0]:mt)/2:-(X(mt)?mt[0]:mt)/2,Ot=["tl","tr","lb","rb"].includes(It)?-(X(mt)?mt[1]:mt)/2:(X(mt)?mt[1]:mt)/2);var Ft=this.getAngleAndOffset(It,ht,dt,X(_t)?_t:[_t,_t-bt],Lt),zt=Ft.angle,Ht=Ft.offset,jt=void 0,Nt={x:0,y:0};if("bounds"===m&&j&&(Nt=this.calculateAnchorPoint(It,j)),z(pt)){var Vt=void 0;jt=q.createOrUpdateChild("poptip-symbol-panel",Object.assign(Object.assign({},vt),{visible:pt&&(rt||J),x:Dt,y:Ot,strokeBoundsBuffer:-1,boundsPadding:-2,anchor:[0,0],symbolType:Lt,angle:zt,dx:Ht[0],dy:Ht[1]-(null!==(l=vt.space)&&void 0!==l?l:0),size:mt,zIndex:9}),"symbol"),ot(null==L?void 0:L.panel)||(jt.states=L.panel),Vt=v.panelSymbolType?q.createOrUpdateChild("poptip-rect-panel",Object.assign(Object.assign({},vt),{visible:pt&&(rt||J),x:0,y:0,symbolType:"rect",size:[ht,dt],zIndex:-8}),"symbol"):q.createOrUpdateChild("poptip-rect-panel",Object.assign(Object.assign({},vt),{visible:pt&&(rt||J),x:0,y:0,width:ht,height:dt,zIndex:-8}),"rect"),ot(null==L?void 0:L.panel)||(Vt.states=L.panel)}if(q.setAttributes({x:-Ht[0]+O+Nt.x,y:-Ht[1]+H+Nt.y,anchor:[Dt,Ot]}),g){var Wt=g.size,Gt=void 0===Wt?12:Wt,Ut=X(Gt)?Gt:[Gt,Gt];"auto"===Ut[1]&&(Ut[1]=dt),"auto"===Ut[0]&&(Ut[0]=dt);var Yt=Ut[0];q.createOrUpdateChild("poptip-logo",Object.assign(Object.assign({},g),{x:0,y:dt/2,visible:pt&&(rt||J),zIndex:10,size:Ut}),"symbol"),q.setAttributes({x:-Ht[0]+O+Yt/2,y:-Ht[1]+H}),_&&q.createOrUpdateChild("poptip-logo-text",Object.assign(Object.assign({},x),{x:0,y:dt/2,visible:pt&&(rt||J),text:_,textAlign:"center",textBaseline:"middle",zIndex:10}),"text")}if(!xt)break;AR.setValue(0,0,ht,dt).transformWithMatrix(q.globalTransMatrix);var Xt=AR,Kt=(new di).setValue(0,0,xt[0],xt[1]);if(Et){if(Ue(Xt,Kt,!1))break;var qt=He(Xt,Kt,!1),Zt=(qt.x2-qt.x1)*(qt.y2-qt.y1);Zt>Rt&&(Rt=Zt,Ct=Bt)}if(["top","bottom","left","right"].includes(It)){var Jt="top"===It||"bottom"===It,Qt="left"===It||"right"===It,$t=!1;if(Jt?$t="top"===It&&Xt.y1<0||"bottom"===It&&Xt.y2>Kt.y2:Qt&&($t="left"===It&&Xt.x1<0||"right"===It&&Xt.x2>Kt.x2),!$t){var te=0,ee=(X(mt)?mt[1]:mt)/2;Jt?(Xt.x1<0?te=-Xt.x1:Xt.x2>Kt.x2&&(te=Kt.x2-Xt.x2),q.setAttribute("x",q.attribute.x+te),jt.setAttribute("dx",de(he(jt.attribute.dx-te,ee),Xt.width()-ee))):Qt&&(Xt.y1<0?te=-Xt.y1:Xt.y2>Kt.y2&&(te=Kt.y2-Xt.y2),q.setAttribute("y",q.attribute.y+te),jt.setAttribute("dy",de(he(jt.attribute.dy-te,ee),Xt.height()-ee)));break}}if(!Et)break}}},{key:"calculateAnchorPoint",value:function(t,e){if(!e)return{x:0,y:0};var i=this.attribute,n=i.x,r=i.y,a=e.x1,o=e.y1,s=e.x2,l=e.y2,u=s-a,c=l-o;switch(t){case"top":case"tl":case"tr":return{x:a+u/2-n,y:o-r};case"bottom":case"bl":case"br":return{x:a+u/2-n,y:l-r};case"left":case"lt":case"lb":return{x:a-n,y:o+c/2-r};case"right":case"rt":case"rb":return{x:s-n,y:o+c/2-r};default:return{x:0,y:0}}}},{key:"getAngleAndOffset",value:function(t,e,i,n,r){var a="arrow2Left"===r?n[1]/2:n[1];switch(t){case"tl":return{angle:"arrow2Left"===r?re/2*3:0,offset:"arrow2Left"===r?[e/4,i+a]:[0,i+a]};case"top":return{angle:re/2*3,offset:[e/2,i+a]};case"tr":return{angle:"arrow2Left"===r?re/2*3:0,offset:"arrow2Left"===r?[e/4*3,i+a]:[e,i+a]};case"rt":return{angle:0,offset:"arrow2Left"===r?[-a,i/5]:[-a,0]};case"right":return{angle:0,offset:[-a,i/2]};case"rb":return{angle:0,offset:"arrow2Left"===r?[-a,i/5*4]:[-a,i]};case"bl":return{angle:"arrow2Left"===r?re/2:0,offset:"arrow2Left"===r?[e/4,-a]:[0,-a]};case"bottom":return{angle:re/2,offset:[e/2,-a]};case"br":return{angle:"arrow2Left"===r?re/2:0,offset:"arrow2Left"===r?[e/4*3,-a]:[e,-a]};case"lt":return{angle:"arrow2Left"===r?re:0,offset:"arrow2Left"===r?[e+a,i/5]:[e+a,0]};case"left":return{angle:re,offset:[e+a,i/2]};case"lb":return{angle:"arrow2Left"===r?re:0,offset:"arrow2Left"===r?[e+a,i/5*4]:[e+a,i]}}}},{key:"appearAnimate",value:function(t){var e=t.duration,i=void 0===e?1e3:e,n=t.easing,r=void 0===n?"quadOut":n;if(this.setAttributes({scaleX:0,scaleY:0}),this.animate().to({scaleX:1,scaleY:1},i/3*2,r),this.titleShape&&this.titleShape.animate().play(new yd({text:""},{text:this.titleShape.attribute.text},i,r)),this.contentShape&&this.contentShape.animate().play(new yd({text:""},{text:this.contentShape.attribute.text},i,r)),t.wave){var a=i/6;this.group.animate().to({angle:t.wave},a,r).to({angle:-t.wave},2*a,r).to({angle:t.wave},2*a,r).to({angle:0},a,r)}}},{key:"disappearAnimate",value:function(t){var e=t.duration,i=void 0===e?1e3:e,n=t.easing,r=void 0===n?"quadOut":n;this.animate().to({scaleX:0,scaleY:0},i,r)}}])}(yS);PR.defaultAttributes={position:"rt",visible:!0,title:null,content:null,titleStyle:{fontSize:12,fill:"#000",textAlign:"left",textBaseline:"top"},contentStyle:{fontSize:12,fill:"#000",textAlign:"left",textBaseline:"top"},panel:{},maxWidthPercent:.8,space:8,padding:10};var RR=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o};var BR=function(){return o((function t(){r(this,t)}),[{key:"render",value:function(t,e,i,n,r,a,o,s,l,u,c,h,d){var p,f;if(1===t._showPoptip){var v=t.attribute.poptip||{},g=v.visible,y=v.visibleCb;if(!1===g||y&&!1===y(t))return;var m={};ft(m,PR.defaultAttributes,t.attribute.poptip?t.attribute.poptip:{}),this.poptipComponent?this.poptipComponent.initAttributes(m):this.poptipComponent=new PR(m);var _=t.attribute.poptip||{};if("text"===t.type&&null==_.title&&null==_.content){var b={};ft(b,kR.poptip,_),(_=b).content=null!==(p=_.content)&&void 0!==p?p:t.attribute.text}var x=t.globalTransMatrix;this.poptipComponent.setAttributes(Object.assign(Object.assign({visibleAll:!0,pickable:!1,childrenPickable:!1,poptipAnchor:"bounds"},_),{x:x.e,y:x.f,positionBounds:t.globalAABBBounds})),u.stage.tryInitInteractiveLayer();var k=u.stage.getLayer("_builtin_interactive");k&&k.add(this.poptipComponent)}else 2===t._showPoptip&&(t._showPoptip=0,this.poptipComponent&&(this.poptipComponent.setAttributes({visibleAll:!1}),null===(f=this.poptipComponent.parent)||void 0===f||f.removeChild(this.poptipComponent),this.poptipComponent=null))}}])}();BR=RR([js()],BR);var IR=function(t,e,i,n){var r,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,i,o):r(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},LR=function(){return o((function t(){var e=this;r(this,t),this.activeEvent="onRegister",this._uid=ws.GenAutoIncrementId(),this.poptip=function(t){var i=t.target;e.needHide(i)?e.unpoptip(t):i!==e.activeGraphic&&(e.needShow(i)&&(i.setAttributes({}),i._showPoptip=1),e.activeGraphic&&(e.activeGraphic.setAttributes({}),e.activeGraphic._showPoptip=2),e.setActiveGraphic(i,!0))},this.unpoptip=function(t){e.activeGraphic&&(e.activeGraphic.setAttributes({}),e.activeGraphic._showPoptip=2,e.setActiveGraphic(null,!0))}}),[{key:"activate",value:function(t){this.pluginService=t,this.pluginService.stage.addEventListener("pointerover",this.poptip)}},{key:"needHide",value:function(t){return t.isContainer||!t.attribute}},{key:"needShow",value:function(t){return!!t.attribute.poptip}},{key:"setActiveGraphic",value:function(t,e){this.activeGraphic=t,this.pluginService.stage.renderNextFrame()}},{key:"deactivate",value:function(t){this.pluginService.stage.removeEventListener("pointerover",this.poptip)}}])}(),DR=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).name="poptip",t.key=t.name+t._uid,t}return h(e,t),o(e)}(LR);DR=IR([js()],DR);var OR=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).name="poptipForText",t.key=t.name+t._uid,t.pointerlave=function(e){var i=t.pluginService.stage;e.target===i&&t.unpoptip(e)},t}return h(e,t),o(e,[{key:"activate",value:function(t){y(e,"activate",this,3)([t]),this.pluginService.stage.addEventListener("pointerleave",this.pointerlave)}},{key:"needHide",value:function(t){return"text"!==t.type||!t.cliped||t.isContainer||!t.attribute||t.attribute.disableAutoClipedPoptip}},{key:"needShow",value:function(t){return!0}},{key:"deactivate",value:function(t){var i=this.pluginService.stage;y(e,"deactivate",this,3)([t]),i.removeEventListener("pointerleave",this.pointerlave)}}])}(LR);OR=IR([js()],OR);var FR=new Ts((function(t,e,i,n){i(BR)||(t(BR).toSelf().inSingletonScope(),t(fg).toService(BR)),i(DR)||(t(DR).toSelf(),t(xb).toService(DR)),i(OR)||(t(OR).toSelf(),t(xb).toService(OR))}));var zR=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).name="crosshair",t}return h(e,t),o(e,[{key:"render",value:function(){this.renderCrosshair(this)}}])}(yS);cP(),fP();var HR=function(t){function e(t,i){return r(this,e),n(this,e,[(null==i?void 0:i.skipDefault)?t:ft({},e.defaultAttributes,t)])}return h(e,t),o(e,[{key:"renderCrosshair",value:function(t){var e=this.attribute,i=e.start,n=e.end,r=e.lineStyle;return t.createOrUpdateChild("crosshair-line",Object.assign({points:[i,n]},r),"line")}},{key:"setLocation",value:function(t){var e=t.start,i=t.end;this.setAttributes({start:e,end:i})}}])}(zR);HR.defaultAttributes={lineStyle:{stroke:"#b2bacf",lineWidth:1,lineDash:[2]}},cP(),kP();var jR=function(t){function e(t,i){return r(this,e),n(this,e,[(null==i?void 0:i.skipDefault)?t:ft({},e.defaultAttributes,t)])}return h(e,t),o(e,[{key:"renderCrosshair",value:function(t){var e=this.attribute,i=e.start,n=e.end,r=e.rectStyle;return t.createOrUpdateChild("crosshair-rect",Object.assign({x:i.x,y:i.y,width:n.x-i.x,height:n.y-i.y},r),"rect")}},{key:"setLocation",value:function(t){var e=t.start,i=t.end;this.setAttributes({start:e,end:i})}}])}(zR);jR.defaultAttributes={rectStyle:{fill:"#b2bacf",opacity:.2}},cP(),tP();var NR=function(t){function e(t,i){return r(this,e),n(this,e,[(null==i?void 0:i.skipDefault)?t:ft({},e.defaultAttributes,t)])}return h(e,t),o(e,[{key:"renderCrosshair",value:function(t){var e=this.attribute,i=e.center,n=e.radius,r=e.lineStyle;return t.createOrUpdateChild("crosshair-circle",Object.assign(Object.assign(Object.assign(Object.assign({},i),{outerRadius:n}),this.attribute),r),"arc")}},{key:"setLocation",value:function(t){var e=this.attribute.center,i=Me.distancePP(t,e);this.setAttribute("radius",i)}}])}(zR);NR.defaultAttributes={lineStyle:{stroke:["#b2bacf",!1,!1,!1],lineWidth:1,lineDash:[2]}},cP(),tP();var VR=function(t){function e(t,i){return r(this,e),n(this,e,[(null==i?void 0:i.skipDefault)?t:ft({},e.defaultAttributes,t)])}return h(e,t),o(e,[{key:"renderCrosshair",value:function(t){var e=this.attribute,i=e.center,n=e.radius,r=e.innerRadius,a=void 0===r?0:r,o=e.sectorStyle,s=this.attribute,l=s.startAngle,u=s.endAngle;return t.createOrUpdateChild("crosshair-sector",Object.assign(Object.assign(Object.assign({},i),{outerRadius:n,innerRadius:a,startAngle:l,endAngle:u}),o),"arc")}},{key:"setLocation",value:function(t){var e=this.attribute,i=e.center,n=e.startAngle,r=void 0===n?OP:n,a=e.endAngle,o=(void 0===a?FP:a)-r,s=Te(Be(i,t));this.setAttributes({startAngle:s-o/2,endAngle:s+o/2})}}])}(zR);VR.defaultAttributes={sectorStyle:{fill:"#b2bacf",opacity:.2}},cP(),gP();var WR=function(t){function e(t,i){return r(this,e),n(this,e,[(null==i?void 0:i.skipDefault)?t:ft({},e.defaultAttributes,t)])}return h(e,t),o(e,[{key:"renderCrosshair",value:function(t){for(var e,i=this.attribute,n=i.center,r=i.radius,a=i.sides,o=void 0===a?6:a,s=i.lineStyle,l=this.attribute,u=l.startAngle,c=l.endAngle,h=(c-u)%(2*Math.PI)==0,d=(c-u)/o,p=0;p<=o;p++){var f=Pe(n,r,u+d*p);0===p?e="M".concat(f.x,",").concat(f.y):e+="L".concat(f.x,",").concat(f.y),p===o&&h&&(e+="Z")}return t.createOrUpdateChild("crosshair-polygon",Object.assign({path:e},s),"path")}},{key:"setLocation",value:function(t){var e=this.attribute.center,i=Me.distancePP(t,e);this.setAttribute("radius",i)}}])}(zR);function GR(){cP(),fP(),mP(),PP()}function UR(){cP(),fP(),tP(),PP()}WR.defaultAttributes={lineStyle:{stroke:"#b2bacf",lineWidth:1,lineDash:[2]}},GR();var YR=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:ft({},e.defaultAttributes,t)])).name="segment",a.key="segment",a.lines=[],a}return h(e,t),o(e,[{key:"getStartAngle",value:function(){return Ie(this._startAngle)}},{key:"getEndAngle",value:function(){return Ie(this._endAngle)}},{key:"getMainSegmentPoints",value:function(){return this._mainSegmentPoints}},{key:"render",value:function(){var t=this;this.removeAllChild(!0),this._reset();var e=this.attribute,i=e.startSymbol,n=e.endSymbol,r=e.lineStyle,a=e.state,o=e.visible,s=void 0===o||o,l=e.multiSegment,u=e.mainSegmentIndex;if(s){this._computeLineAngle();var c=this._getMainSegmentPoints(),h=this._renderSymbol(i,c,"start"),d=this._renderSymbol(n,c,"end");if(this.startSymbol=h,this.endSymbol=d,l){var p=m(this.attribute.points);if(Q(u))p[u]=this._clipPoints(p[u]);else{var f=this._clipPoints(Tt(p));p[0][0]=f[0],p[p.length-1][p[p.length-1].length-1]=f[f.length-1]}p.forEach((function(e,i){var n,o,s=By.line(Object.assign(Object.assign({points:e},X(r)?null!==(n=r[i])&&void 0!==n?n:r[r.length-1]:r),{fill:!1}));s.name="".concat(t.name,"-line"),s.id=t._getNodeId("line"+i),ot(null==a?void 0:a.line)||(s.states=X(a.line)?null!==(o=a.line[i])&&void 0!==o?o:a.line[a.line.length-1]:a.line),t.add(s),t.lines.push(s)}))}else{var v=By.line;xt(r)[0].cornerRadius&&(v=By.polygon);var g=v(Object.assign(Object.assign({points:this._clipPoints(this.attribute.points)},xt(r)[0]),{fill:!1,closePath:!1}));g.name="".concat(this.name,"-line"),g.id=this._getNodeId("line"),ot(null==a?void 0:a.line)||(g.states=[].concat(a.line)[0]),this.add(g),this.lines.push(g)}}}},{key:"_computeStartRotate",value:function(t){return t+Math.PI/2}},{key:"_computeEndRotate",value:function(t){return t+Math.PI/2}},{key:"_renderSymbol",value:function(t,e,i){if(e.length){var n,r=t.autoRotate,a=void 0===r||r;if(t&&t.visible){var o,s,l=this.getStartAngle(),u=this.getEndAngle(),c=this.attribute.state,h=e[0],d=e[e.length-1],p=t.refX,f=void 0===p?0:p,v=t.refY,g=void 0===v?0:v,y=t.refAngle,m=void 0===y?0:y,_=t.style,b=t.symbolType,x=t.size,k=void 0===x?12:x;"start"===i?(o={x:h.x+(Q(l)?f*Math.cos(l)+g*Math.cos(l-Math.PI/2):0),y:h.y+(Q(l)?f*Math.sin(l)+g*Math.sin(l-Math.PI/2):0)},s=this._computeStartRotate(this._startAngle)):(o={x:d.x+(Q(u)?f*Math.cos(u)+g*Math.cos(u-Math.PI/2):0),y:d.y+(Q(u)?f*Math.sin(u)+g*Math.sin(u-Math.PI/2):0)},s=this._computeEndRotate(this._endAngle)),(n=By.symbol(Object.assign(Object.assign(Object.assign({},o),{symbolType:b,size:k,angle:a?s+m:0,strokeBoundsBuffer:0}),_))).name="".concat(this.name,"-").concat(i,"-symbol"),n.id=this._getNodeId("".concat(i,"-symbol")),ot(null==c?void 0:c.symbol)||(n.states=c.symbol),"start"===i?ot(null==c?void 0:c.startSymbol)||(n.states=c.startSymbol):ot(null==c?void 0:c.endSymbol)||(n.states=c.endSymbol),this.add(n)}return n}}},{key:"_getMainSegmentPoints",value:function(){if(this._mainSegmentPoints)return this._mainSegmentPoints;var t,e=this.attribute,i=e.points,n=e.multiSegment,r=e.mainSegmentIndex;return t=n?Q(r)?i[r]:Tt(i):i,this._mainSegmentPoints=t,t}},{key:"_clipPoints",value:function(t){var e=this.attribute,i=e.startSymbol,n=void 0===i?{}:i,r=e.endSymbol,a=void 0===r?{}:r,o=t;if(n.visible){var s=n.clip?n.size||10:0;o=[{x:t[0].x-s/2*(Math.cos(this._startAngle)||0),y:t[0].y-s/2*(Math.sin(this._startAngle)||0)}].concat(m(o.slice(1)))}if(a.visible){var l=a.clip?a.size||10:0,u={x:t[t.length-1].x-l/2*(Math.cos(this._endAngle)||0),y:t[t.length-1].y-l/2*(Math.sin(this._endAngle)||0)};o=[].concat(m(o.slice(0,o.length-1)),[u])}return o}},{key:"_computeLineAngle",value:function(){var t=this._getMainSegmentPoints();if(!(t.length<=1)){var e=t[0],i=t[1],n=t[t.length-2],r=t[t.length-1],a=[e.x-i.x,e.y-i.y],o=Math.atan2(a[1],a[0]),s=[r.x-n.x,r.y-n.y],l=Math.atan2(s[1],s[0]);this._startAngle=o,this._endAngle=l}}},{key:"_reset",value:function(){this.startSymbol=null,this.endSymbol=null,this._startAngle=null,this._endAngle=null,this._mainSegmentPoints=null}}])}(yS);YR.defaultAttributes={visible:!0,lineStyle:{lineWidth:1,stroke:"#000"},startSymbol:{visible:!1,autoRotate:!0,symbolType:"triangle",size:12,refX:0,refY:0,refAngle:0,style:{fill:"#000",zIndex:1}},endSymbol:{visible:!1,autoRotate:!0,symbolType:"triangle",size:12,refX:0,refY:0,refAngle:0,style:{fill:"#000",zIndex:1}}},UR();var XR,KR,qR=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:ft({},YR.defaultAttributes,t)])).name="arc-segment",a.key="arc-segment",a.isReverseArc=!1,a}return h(e,t),o(e,[{key:"getStartAngle",value:function(){var t=this.isReverseArc?this._startAngle+Math.PI/2:this._startAngle-Math.PI/2;return t<0?t+2*Math.PI:t>2*Math.PI?t-2*Math.PI:t}},{key:"getEndAngle",value:function(){var t=this.isReverseArc?this._endAngle-Math.PI/2:this._endAngle+Math.PI/2;return t<0?t+2*Math.PI:t>2*Math.PI?t-2*Math.PI:t}},{key:"getMainSegmentPoints",value:function(){return this._mainSegmentPoints}},{key:"_computeStartRotate",value:function(t){return this.isReverseArc?t+Math.PI:t}},{key:"_computeEndRotate",value:function(t){return this.isReverseArc?t:t+Math.PI}},{key:"render",value:function(){this.removeAllChild(!0),this._reset();var t=this.attribute,e=t.startSymbol,i=t.endSymbol,n=t.lineStyle,r=t.state,a=t.visible,o=void 0===a||a,s=t.radius,l=t.startAngle,u=t.endAngle,c=t.center;if(o){this._startAngle=l,this._endAngle=u,this.isReverseArc=l>u;var h={x:c.x+s*Math.cos(this._startAngle),y:c.y+s*Math.sin(this._startAngle)},d={x:c.x+s*Math.cos(this._endAngle),y:c.y+s*Math.sin(this._endAngle)};this._mainSegmentPoints=[h,d];var p=this._renderSymbol(e,this._mainSegmentPoints,"start"),f=this._renderSymbol(i,this._mainSegmentPoints,"end");this.startSymbol=p,this.endSymbol=f;var v=By.arc(Object.assign({x:c.x,y:c.y,startAngle:l,endAngle:u,innerRadius:s,outerRadius:s},n));v.name="".concat(this.name,"-line"),v.id=this._getNodeId("arc"),ot(null==r?void 0:r.line)||(v.states=[].concat(r.line)[0]),this.add(v),this.line=v}}}])}(YR);!function(t){t.innerView="inner-view",t.axisContainer="axis-container",t.labelContainer="axis-label-container",t.tickContainer="axis-tick-container",t.tick="axis-tick",t.subTick="axis-sub-tick",t.label="axis-label",t.title="axis-title",t.gridContainer="axis-grid-container",t.grid="axis-grid",t.gridRegion="axis-grid-region",t.line="axis-line",t.background="axis-background",t.axisLabelBackground="axis-label-background",t.axisBreak="axis-break",t.axisBreakSymbol="axis-break-symbol"}(XR||(XR={})),function(t){t.selected="selected",t.selectedReverse="selected_reverse",t.hover="hover",t.hoverReverse="hover_reverse"}(KR||(KR={}));var ZR=l(l(l(l({},KR.selectedReverse,{}),KR.selected,{}),KR.hover,{}),KR.hoverReverse,{}),JR={title:{space:4,padding:0,textStyle:{fontSize:12,fill:"#333333",fontWeight:"normal",fillOpacity:1}},label:{visible:!0,inside:!1,space:4,padding:0,style:{fontSize:12,fill:"#333",fontWeight:"normal",fillOpacity:1}},tick:{visible:!0,inside:!1,alignWithLabel:!0,length:4,style:{lineWidth:1,stroke:"#000",strokeOpacity:1}},subTick:{visible:!1,inside:!1,count:4,length:2,style:{lineWidth:1,stroke:"#999",strokeOpacity:1}},line:{visible:!0,style:{lineWidth:1,stroke:"#000",strokeOpacity:1}}},QR={size:8,stroke:"#000",lineWidth:1,zIndex:1};function $R(t,e){var i,n;return(null===(i=t.OBBBounds)||void 0===i?void 0:i.empty())||(null===(n=e.OBBBounds)||void 0===n?void 0:n.empty())?Ye(t.AABBBounds,e.AABBBounds,!1)&&(!t.rotatedBounds||!e.rotatedBounds||Qe(t.rotatedBounds,e.rotatedBounds,!0)):t.OBBBounds.intersects(e.OBBBounds)}var tB=Math.sin(Math.PI/10);function eB(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tB,i=!j(t)&&0!==t,n=i?Math.cos(t):1;return i&&Math.abs(n)<=e}function iB(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tB,i=!j(t)&&0!==t,n=i?Math.sin(t):0;return!i||Math.abs(n)<=e}function nB(t){var e={};return qP(t,(function(t){"group"!==t.type&&t.id&&(e[t.id]=t)})),e}function rB(t,e){return{x:t.x+e[0],y:t.y+e[1]}}function aB(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=[e.x-i.x,e.y-i.y];return oR(a,(n?-1:1)*(r?-1:1)*t/sR(a))}function oB(t,e,i,n,r){for(var a=[],o=r-n,s=0;s<e;s++){var l=n+s*o/e;a.push(Pe(t,i,l))}return a}function sB(t,e){var i="";return 0===t.length||(t.forEach((function(t,e){0===e?i="M".concat(t.x,",").concat(t.y):i+="L".concat(t.x,",").concat(t.y)})),e&&(i+="Z")),i}function lB(t,e,i){var n;if(iB(null===(n=t.attribute)||void 0===n?void 0:n.angle,Number.EPSILON))return i>ui(t.AABBBounds,e.AABBBounds);var r=t.OBBBounds,a=e.OBBBounds;return!r||!a||r.empty()||a.empty()?i>ui(t.AABBBounds,e.AABBBounds):r.intersects(a)||i>ci(r,a)}function uB(t,e){for(var i,n=1,r=t.length,a=t[0];n<r;a=i,++n)if(lB(a,i=t[n],e))return!0;return!1}var cB=function(t,e,i){var n=t.target;return n!==i&&n.name&&!ot(n.states)?(n.addState(DP.hover,!0),qP(e,(function(t){t!==n&&t.name&&!ot(t.states)&&t.addState(DP.hoverReverse,!0)})),n):i},hB=function(t,e,i){return i?(qP(e,(function(t){t.name&&!ot(t.states)&&(t.removeState(DP.hoverReverse),t.removeState(DP.hover))})),null):i},dB=function(t,e,i){var n=t.target;return i===n&&n.hasState(DP.selected)?(qP(e,(function(t){t.name&&!ot(t.states)&&(t.removeState(DP.selectedReverse),t.removeState(DP.selected))})),null):n.name&&!ot(n.states)?(n.addState(DP.selected,!0),qP(e,(function(t){t!==n&&t.name&&!ot(t.states)&&t.addState(DP.selectedReverse,!0)})),n):i},pB=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).name="axis",t.data=[],t.tickLineItems=[],t.subTickLineItems=[],t.axisLabelLayerSize={},t.axisLabelsContainer=null,t._onHover=function(e){t._lastHover=cB(e,t.axisContainer,t._lastHover)},t._onUnHover=function(e){t._lastHover=hB(0,t.axisContainer,t._lastHover)},t._onClick=function(e){t._lastSelect=dB(e,t.axisContainer,t._lastSelect)},t}return h(e,t),o(e,[{key:"getInnerView",value:function(){return this._innerView}},{key:"getPrevInnerView",value:function(){return this._prevInnerView}},{key:"getBoundsWithoutRender",value:function(t){var e=ct(this.attribute);ft(this.attribute,t);var i=By.group({x:this.attribute.x,y:this.attribute.y});return this.add(i),this._renderInner(i),this.removeChild(i),this.attribute=e,i.AABBBounds}},{key:"render",value:function(){this._prevInnerView=this._innerView&&nB(this._innerView),this.removeAllChild(!0),this._innerView=By.group({x:0,y:0,pickable:!1}),this.add(this._innerView),this._renderInner(this._innerView),this._bindEvent()}},{key:"_bindEvent",value:function(){if(!this.attribute.disableTriggerEvent){var t=this.attribute,e=t.hover,i=t.select;e&&(this._innerView.addEventListener("pointermove",this._onHover),this._innerView.addEventListener("pointerout",this._onUnHover)),i&&this._innerView.addEventListener("pointerdown",this._onClick)}}},{key:"_renderInner",value:function(t){var e=this,i=this.attribute,n=i.title,r=i.label,a=i.tick,o=i.line,s=i.items,l=By.group({x:0,y:0,zIndex:1,pickable:!1});if(l.name=XR.axisContainer,l.id=this._getNodeId("container"),l.setMode(this.mode),this.axisContainer=l,t.add(l),o&&o.visible&&this.renderLine(l),s&&s.length&&(this.data=this._transformItems(s[0]),a&&a.visible&&this.renderTicks(l),r&&r.visible)){var u=By.group({x:0,y:0,pickable:!1});u.name=XR.labelContainer,u.id=this._getNodeId("label-container"),this.axisLabelsContainer=u,l.add(u),s.forEach((function(t,i){var n=e.renderLabels(u,t,i),r=n.getChildren();e.beforeLabelsOverlap(r,t,n,i,s.length),e.handleLabelsOverlap(r,t,n,i,s.length),e.afterLabelsOverlap(r,t,n,i,s.length);var a=0,o=0,l="center",c="middle",h=0;r.forEach((function(t,e){var i,n=t.attribute,r=null!==(i=n.angle)&&void 0!==i?i:0,s=t.AABBBounds,u=s.width(),d=s.height();r&&(u=Math.abs(u*Math.cos(r)),d=Math.abs(d*Math.sin(r))),a=Math.max(a,u),o=Math.max(o,d),l=n.textAlign,c=n.textBaseline,0===e&&(h=n.x)})),e.axisLabelLayerSize[i]={width:a,height:o,labelPos:h,textAlign:l,textBaseline:c}}))}n&&n.visible&&this.renderTitle(l)}},{key:"renderTicks",value:function(t){var e=this,i=this.getTickLineItems(),n=By.group({x:0,y:0,pickable:!1});n.name=XR.tickContainer,n.id=this._getNodeId("tick-container"),t.add(n),i.forEach((function(t,r){var a,o=By.line(Object.assign({},e._getTickLineAttribute("tick",t,r,i)));if(o.name=XR.tick,o.id=e._getNodeId(t.id),ot(null===(a=e.attribute.tick)||void 0===a?void 0:a.state))o.states=HP;else{var s=e.data[r],l=ft({},HP,e.attribute.tick.state);Object.keys(l).forEach((function(t){H(l[t])&&(l[t]=l[t](s.rawValue,r,s,e.data))})),o.states=l}n.add(o)})),this.tickLineItems=i;var r=this.attribute.subTick;if(r&&r.visible){var a=this.getSubTickLineItems();a.length&&a.forEach((function(t,a){var o=By.line(Object.assign({},e._getTickLineAttribute("subTick",t,a,i)));if(o.name=XR.subTick,o.id=e._getNodeId("".concat(a)),ot(r.state))o.states=HP;else{var s=ft({},HP,r.state);Object.keys(s).forEach((function(e){H(s[e])&&(s[e]=s[e](t.value,a,t,i))})),o.states=s}n.add(o)})),this.subTickLineItems=a}}},{key:"renderLabels",value:function(t,e,i){var n=this,r=this.attribute.label.dataFilter;r&&H(r)&&(e=r(e,i));var a=this._transformItems(e),o=By.group({x:0,y:0,pickable:!1});return o.name="".concat(XR.labelContainer,"-layer-").concat(i),o.id=this._getNodeId("label-container-layer-".concat(i)),t.add(o),a.forEach((function(t,e){var r,s=pR(n._getLabelAttribute(t,e,a,i));if(s.name=XR.label,s.id=n._getNodeId("layer".concat(i,"-label-").concat(t.id)),ot(null===(r=n.attribute.label)||void 0===r?void 0:r.state))s.states=HP;else{var l=ft({},HP,n.attribute.label.state);Object.keys(l).forEach((function(n){H(l[n])&&(l[n]=l[n](t,e,a,i))})),s.states=l}s.data=Object.assign(Object.assign({},t),{index:e,layer:i}),o.add(s)})),o}},{key:"renderTitle",value:function(t){var e=this.getTitleAttribute(),i=new bR(Object.assign({},e));i.name=XR.title,i.id=this._getNodeId("title"),t.add(i)}},{key:"getVerticalCoord",value:function(t,e,i){return rB(t,this.getVerticalVector(e,i,t))}},{key:"getTickLineItems",value:function(){var t=this,e=this.attribute.tick,i=this.data,n=[],r=e.alignWithLabel,a=e.inside,o=void 0!==a&&a,s=e.length,l=e.dataFilter,u=1;return i.length>=2&&(u=i[1].value-i[0].value),(l&&H(l)?l(i):i).forEach((function(e){var i=e.point,a=e.value;if(!r){var l=e.value-u/2;if(t.isInValidValue(l))return;i=t.getTickCoord(l),a=l}var c=t.getVerticalCoord(i,s,o);if("3d"===t.mode){var h=t.getVerticalVector(s,o,i),d=0,p=0;le(h[0])>le(h[1])?d=re/2*(c.x>i.x?1:-1):p=re/2*(c.y>i.y?-1:1),n.push({start:i,end:c,value:a,id:"tick-".concat(e.id),anchor:[i.x,i.y],alpha:d,beta:p})}else n.push({start:i,end:c,value:a,id:"tick-".concat(e.id)})})),n}},{key:"getSubTickLineItems",value:function(){var t=this.attribute.subTick,e=[],i=t.count,n=void 0===i?4:i,r=t.inside,a=void 0!==r&&r,o=t.length,s=void 0===o?2:o,l=this.tickLineItems,u=l.length;if(u>=2)for(var c=0;c<u-1;c++)for(var h=l[c],d=l[c+1],p=0;p<n;p++){var f=(p+1)/(n+1),v=(1-f)*h.value+f*d.value,g=this.getTickCoord(v),y=this.getVerticalCoord(g,s,a);e.push({start:g,end:y,value:v,id:"sub-tick-".concat(v)})}return e}},{key:"_getTickLineAttribute",value:function(t,e,i,n){var r=st(this.attribute,"".concat(t,".style")),a=this.data[i];r=H(r)?ft({},st(JR,"".concat(t,".style")),"tick"===t?r(a.rawValue,i,a,this.data):r(e.value,i,e,n)):r;var o=e.start,s=e.end,l=e.anchor,u=e.alpha,c=e.beta;return Object.assign({points:[o,s],anchor:l,alpha:u,beta:c},r)}},{key:"_getLabelAttribute",value:function(t,e,i,n){var r,a,o=this.attribute.label,s=o.space,l=void 0===s?4:s,u=o.inside,c=void 0!==u&&u,h=o.formatMethod,d=o.type,p=void 0===d?"text":d,f=o.text,v=l,g=0;(null===(r=this.attribute.tick)||void 0===r?void 0:r.visible)&&this.attribute.tick.inside===c&&(g=this.attribute.tick.length||4),(null===(a=this.attribute.subTick)||void 0===a?void 0:a.visible)&&this.attribute.subTick.inside===c&&(g=Math.max(g,this.attribute.subTick.length||2)),v+=g;var y=this.getRelativeVector(t.point);n>0&&(0===y[1]?v+=(this.axisLabelLayerSize[n-1].height+st(this.attribute,"label.space",4))*n:v+=(this.axisLabelLayerSize[n-1].width+st(this.attribute,"label.space",4))*n);var m=this.getVerticalCoord(t.point,v,c),_=this.getVerticalVector(v||1,c,m),b=h?h("".concat(t.label),t,e,i,n):t.label,x=this.attribute.label.style;return x=H(x)?ft({},JR.label.style,x(t,e,i,n)):x,x=ft(this.getLabelAlign(_,c,x.angle),x),H(x.text)&&(x.text=x.text({label:t.label,value:t.rawValue,index:t.index,layer:n})),Object.assign(Object.assign(Object.assign({},this.getLabelPosition(m,_,b,x)),{text:null!=f?f:b,_originText:t.label,lineHeight:null==x?void 0:x.fontSize,type:p}),x)}},{key:"getLabelPosition",value:function(t,e,i,n){return t}},{key:"_transformItems",value:function(t){var e=this,i=[];return t.forEach((function(t){var n;i.push(Object.assign(Object.assign({},t),{point:e.getTickCoord(t.value),id:null!==(n=t.id)&&void 0!==n?n:t.label}))})),i}},{key:"release",value:function(){y(e,"release",this,3)([]),this._prevInnerView=null,this._innerView=null}}])}(yS),fB={parity:function(t){return t.filter((function(t,e){return e%2?t.setAttribute("opacity",0):1}))},greedy:function(t,e){var i;return t.filter((function(t,n){return n&&lB(i,t,e)?t.setAttribute("opacity",0):(i=t,1)}))}};function vB(t){var e;return(e=t.OBBBounds.empty()?t.AABBBounds:t.OBBBounds).width()>1&&e.height()>1}function gB(t,e,i,n){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(i&&!t.attribute.opacity){var a=e.length;if(a>1){t.setAttribute("opacity",1);for(var o=0;o<a;o++){var s=r?e[a-1-o]:e[o];if(!n(s))break;s.setAttribute("opacity",0)}}}}function yB(t,e){if(!ot(t)){var i=t.filter(vB);if(!ot(i)){var n;n=function(t){return t.forEach((function(t){return t.setAttribute("opacity",1)})),t}(i);var r=e.method,a=void 0===r?"parity":r,o=e.separation,s=void 0===o?0:o,l=H(a)?a:fB[a]||fB.parity;if(n.length>=3&&uB(n,s)){do{n=l(n,s)}while(n.length>=3&&uB(n,s));var u=function(t,e){return(!(arguments.length>2&&void 0!==arguments[2])||arguments[2])&&t<3||e},c=u(n.length,e.firstVisible,!1),h=u(n.length,e.lastVisible),d=i[0],p=kt(i);lB(d,p,s)&&c&&h&&(p.setAttribute("opacity",0),h=!1),gB(d,n,c,(function(t){return lB(t,d,s)})),gB(p,n,h,(function(t){return lB(t,p,s)||!(!c||t===d)&&lB(t,d,s)}),!0)}i.forEach((function(t){t.setAttribute("visible",!!t.attribute.opacity)}))}}}function mB(t,e){if(!ot(t)){var i=e.orient,n=e.labelRotateAngle,r=void 0===n?[0,45,90]:n;if(0!==r.length&&!t.some((function(t){return!!t.attribute.angle}))){var a=0,o=0,s=function(){var e=r[a++];if(t.forEach((function(t){t.attribute.angle=we(e)})),function(t,e){"bottom"!==t&&"top"!==t||function(t,e){e.forEach((function(e){e.attribute.angle&&e.setAttributes(Object.assign(Object.assign({},bB(t,e.attribute.angle)),{angle:_B(e.attribute.angle)}))}))}(t,e),"left"!==t&&"right"!==t||function(t,e){e.forEach((function(e,i){e.attribute.angle&&e.setAttributes(Object.assign(Object.assign({},xB(t,e.attribute.angle)),{angle:_B(e.attribute.angle)}))}))}(t,e),function(t){t.forEach((function(t){if(!t.rotatedBounds&&t.attribute.angle){var e=function(t){var e=t.AABBBounds;return{x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2,centerX:t.attribute.x,centerY:t.attribute.y,angle:t.attribute.angle}}(t),i=qe({x:t.attribute.x,y:t.attribute.y},e.angle,{x:e.centerX,y:e.centerY}),n=i.x-e.centerX,r=i.y-e.centerY;e.x1+=n,e.x2+=n,e.y1+=r,e.y2+=r,e.centerX+=n,e.centerY+=r,t.rotatedBounds=e}}))}(e)}(i,t),!function(t){for(var e=1;e<t.length;e++)if($R(t[e-1],t[e]))return!0;return!1}(t))return 1};for(r&&r.length>0&&(o=r.length);a<o&&!s(););}}}function _B(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(t<0)for(;t<0;)t+=2*Math.PI;if(t>0)for(;t>=2*Math.PI;)t-=2*Math.PI;return t}function bB(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=["center","left","left","left","center","right","right","right","left"],n=["top","top","middle","bottom","bottom","bottom","middle","top","top"];"top"===t&&(i=["center","right","right","right","center","left","left","left","right"],n=["bottom","bottom","middle","top","top","top","middle","bottom","bottom"]);var r,a=(e=_B(e))/(.5*Math.PI);return{textAlign:i[r=a===Math.floor(a)?2*Math.floor(a):2*Math.floor(a)+1],textBaseline:n[r]}}function xB(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=["right","right","center","left","left","left","center","right","right"],n=["middle","middle","top","top","middle","middle","bottom","bottom","middle"];"right"===t&&(i=["left","left","center","right","right","right","center","left","left"],n=["middle","middle","bottom","bottom","middle","middle","top","middle","middle"]);var r,a=(e=_B(e))/(.5*Math.PI);return{textAlign:i[r=a===Math.floor(a)?2*Math.floor(a):2*Math.floor(a)+1],textBaseline:n[r]}}function kB(t,e){var i=e.limitLength,n=e.verticalLimitLength,r=e.ellipsis,a=void 0===r?"...":r,o=e.orient,s=e.axisLength;if(!ot(t)&&Q(i)){var l=function(t){return Q(t)?{left:t,right:t}:V(t)?{left:t.left||0,right:t.right||0}:{left:0,right:0}}(e.overflowLimitLength),u=t[0],c=u.attribute.angle,h=!j(c),d=h?Math.cos(c):1,p=h?Math.sin(c):0,f=iB(c),v=eB(c),g="top"===o||"bottom"===o,y=u.attribute.direction,m=!f&&!v&&g&&(t.length<2||t.some((function(t){return Math.abs(t.AABBBounds.width()-u.AABBBounds.width())>=2})))&&u.AABBBounds.width()>Math.abs(i/p);t.forEach((function(t){var e;if(g){if(v&&Math.floor(t.AABBBounds.height())<=i)return;if(f&&Math.floor(t.AABBBounds.width())<=n)return}if(!g){if("vertical"===y&&Math.floor(t.AABBBounds.height())<=n)return;if("vertical"!==y){if(f&&Math.floor(t.AABBBounds.width())<=i)return;if(v&&Math.floor(t.AABBBounds.height())<=n)return}}var r=null;if(f||v)r=g?f?n:i:"vertical"===y||v?n:i;else if(g){var o=t.AABBBounds,u=o.x1,c=o.x2,h=p/d,_=Math.abs(i/p);if(m&&h>0&&u<=s+l.right&&i/h+u>s+l.right){var b=(s-u+l.right)/Math.abs(d);r=Math.min(b,_)}else if(m&&h<0&&c>=-l.left&&i/h+c<-l.left){var x=(c+l.left)/Math.abs(d);r=Math.min(x,_)}else r=_}else r=Math.abs(i/d);Q(t.attribute.maxLineWidth)&&(r=Q(r)?Math.min(t.attribute.maxLineWidth,r):t.attribute.maxLineWidth),t.setAttributes({maxLineWidth:r,ellipsis:null!==(e=t.attribute.ellipsis)&&void 0!==e?e:a})}))}}function SB(t,e,i){var n;return Q(e)&&(n=Math.abs(e-t)),Q(i)&&(n=Q(n)?Math.min(Math.abs(t-i),n):Math.abs(t-i)),n}var AB=function(){return o((function t(){r(this,t)}),[{key:"isInValidValue",value:function(t){return t<0||t>1}},{key:"getTickCoord",value:function(t){var e=this.attribute.start,i=this.getRelativeVector();return{x:e.x+i[0]*t,y:e.y+i[1]*t}}},{key:"getRelativeVector",value:function(t){var e=this.attribute,i=e.start,n=e.end;return[n.x-i.x,n.y-i.y]}},{key:"getVerticalVector",value:function(t){var e,i,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.attribute.verticalFactor,a=void 0===r?1:r,o=this.getRelativeVector(),s=((i=sR(e=o))>0&&(i=1/i),[e[0]*i,e[1]*i]);return oR([s[1],-1*s[0]],t*(n?1:-1)*a)}}])}();function MB(){cP(),fP(),wP(),BP()}var wB=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i};MB(),kP();var TB=function(t){function e(t,i){return r(this,e),n(this,e,[(null==i?void 0:i.skipDefault)?t:ft({},e.defaultAttributes,t),i])}return h(e,t),o(e,[{key:"_renderInner",value:function(t){var i,n=this;if(this._breaks=null,this.attribute.breaks&&this.attribute.breaks.length){for(var r=[],a=0;a<this.attribute.breaks.length;a++){var o=this.attribute.breaks[a],s=o.range,l=o.breakSymbol,u=o.rawRange;r.push({startPoint:this.getTickCoord(s[0]),endPoint:this.getTickCoord(s[1]),range:s,breakSymbol:l,rawRange:u})}this._breaks=r}y(e,"_renderInner",this,3)([t]),this._breaks&&this._breaks.length&&this._breaks.forEach((function(e,i){var r=e.startPoint,a=e.endPoint,o=e.breakSymbol,s=e.rawRange;if(!1!==(null==o?void 0:o.visible)){var l=By.group({zIndex:999});l.name=XR.axisBreak,l.id=n._getNodeId("".concat(XR.axisBreak,"-").concat(i)),l.data=s;var u=function(){var t,e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=i.style,r=void 0===n?{}:n,a=i.angle,o=void 0===a?.5*Math.PI:a,s=ft({},QR,r),l=null!==(t=s.size)&&void 0!==t?t:QR.size;return Object.assign(Object.assign({},s),{symbolType:null!==(e=s.symbolType)&&void 0!==e?e:"M ".concat(-l/2," ").concat(l*Math.sin(o)," L ").concat(l/2," ").concat(-l*Math.sin(o)),symbolSize:l})}(o),c=By.symbol(Object.assign({x:r.x,y:r.y},u));c.name=XR.axisBreakSymbol;var h=By.symbol(Object.assign({x:a.x,y:a.y},u));h.name=XR.axisBreakSymbol,l.add(c),l.add(h),t.add(l)}}));var c=this.attribute.panel;if(c&&c.visible){var h=this.axisContainer,d=h.AABBBounds,p=By.rect(Object.assign({x:d.x1,y:d.y1,width:d.width(),height:d.height()},c.style));p.name=XR.background,p.id=this._getNodeId("background"),p.states=ft({},ZR,null!==(i=c.state)&&void 0!==i?i:{}),h.insertBefore(p,h.firstChild)}}},{key:"renderLine",value:function(t){var e=this.attribute,i=e.start,n=e.end,r=e.line,a=r.startSymbol,o=r.endSymbol,s=r.style,l=r.state,u=wB(r,["startSymbol","endSymbol","style","state"]),c=Object.assign({startSymbol:a,endSymbol:o,lineStyle:s},u);if(this._breaks&&this._breaks.length){var h=[],d=i;this._breaks.forEach((function(t){var e=t.startPoint,i=t.endPoint;h.push([d,e]),d=i})),h.push([d,n]),c.points=h,c.multiSegment=!0}else c.points=[i,n];ot(l)||(c.state={line:ft({},ZR,l),symbol:ft({},ZR,l)});var p=new YR(c);p.name=XR.line,p.id=this._getNodeId("line"),t.add(p)}},{key:"getTextAlign",value:function(t){var e="center";return Nt(t[0],0)?Nt(t[1],0)?Object.is(t[1],-0)?e="start":Object.is(t[0],-0)&&(e="end"):e="center":t[0]>0?e="start":t[0]<0&&(e="end"),e}},{key:"getTitleAttribute",value:function(){var t,e,i,n=this,r=this.attribute.title,a=r.position,o=void 0===a?"middle":a,s=r.space,l=void 0===s?4:s,u=r.textStyle,c=void 0===u?{}:u,h=r.autoRotate,d=void 0===h||h,p=r.shape,f=r.background,v=r.state,g=void 0===v?{}:v,y=r.maxWidth,m=wB(r,["position","space","textStyle","autoRotate","shape","background","state","maxWidth"]),_=.5;"start"===o?_=0:"end"===o&&(_=1);var b=this.attribute.verticalFactor,x=-1*(void 0===b?1:b),k=this.getTickCoord(_),S=this.getRelativeVector(),A=0;if((null===(t=this.attribute.label)||void 0===t?void 0:t.visible)&&!1===this.attribute.label.inside){var M=+st(this.attribute,"label.space",4);A+=M;var w=Object.keys(this.axisLabelLayerSize).length;if(0===S[1]){var T=this.axisLabelsContainer?this.axisLabelsContainer.AABBBounds.height():0;isFinite(T)?A+=T+(w-1)*M:A=0}else if(0===S[0])if(this.axisLabelsContainer&&this.axisLabelsContainer.AABBBounds&&!this.axisLabelsContainer.AABBBounds.empty()){var C=this.axisLabelLayerSize[0].labelPos,E=this.axisLabelsContainer.AABBBounds;A+=(1===x?E.x2>C?Math.min(E.x2-C,E.width()):0:E.x1<C?Math.min(C-E.x1,E.width()):0)+(w-1)*M}else A=0;else Object.keys(this.axisLabelLayerSize).forEach((function(t,e){A+=n.axisLabelLayerSize[t].width+(e>0?M:0)}))}var P=0;(null===(e=this.attribute.tick)||void 0===e?void 0:e.visible)&&!1===this.attribute.tick.inside&&(P=this.attribute.tick.length||4),(null===(i=this.attribute.subTick)||void 0===i?void 0:i.visible)&&!1===this.attribute.subTick.inside&&(P=Math.max(P,this.attribute.subTick.length||2));var R,B,I=P+A+l,L=this.getVerticalCoord(k,I,!1),D=this.getVerticalVector(I,!1,{x:0,y:0}),O=m.angle;if(R="start"===o?"start":"end"===o?"end":"center",j(O)&&d){O=lR(S,[1,0],!0);var F=this.attribute.verticalFactor;B=1==-1*(void 0===F?1:F)?"bottom":"top"}else R=this.getTextAlign(D),B=this.getTextBaseline(D,!1);var z=y;if(j(z)){var H=this.attribute,N=H.verticalLimitSize,V=H.verticalMinSize,W=H.orient,G=Math.min(N||1/0,V||1/0);if(Q(G))if("bottom"===W||"top"===W)if(O!==Math.PI/2){var U=Math.abs(Math.cos(null!=O?O:0));z=U<1e-6?1/0:this.attribute.end.x/U}else z=G-I;else if(O&&0!==O){var Y=Math.abs(Math.sin(O));z=Y<1e-6?1/0:this.attribute.end.y/Y}else z=G-I}var X=Object.assign(Object.assign(Object.assign({},L),m),{maxWidth:z,textStyle:Object.assign({textAlign:R,textBaseline:B},c),state:{text:ft({},ZR,g.text),shape:ft({},ZR,g.shape),panel:ft({},ZR,g.background)}});return X.angle=O,p&&p.visible&&(X.shape=Object.assign({visible:!0},p.style),p.space&&(X.space=p.space)),f&&f.visible&&(X.panel=Object.assign({visible:!0},f.style)),X}},{key:"getTextBaseline",value:function(t,e){var i="middle",n=this.attribute.verticalFactor,r=(e?1:-1)*(void 0===n?1:n);return Nt(t[1],0)?i=!Nt(t[0],0)||Object.is(t[0],-0)||Object.is(t[1],-0)?"middle":1===r?"bottom":"top":t[1]>0?i="top":t[1]<0&&(i="bottom"),i}},{key:"getLabelAlign",value:function(t,e,i){var n=this.attribute.orient;if(["top","bottom","right","left"].includes(n)||0===t[0]&&0===t[1]){if("top"===n||"bottom"===n)return bB(e?"bottom"===n?"top":"bottom":n,i);if("left"===n||"right"===n)return xB(e?"left"===n?"right":"left":n,i)}return{textAlign:this.getTextAlign(t),textBaseline:this.getTextBaseline(t,e)}}},{key:"beforeLabelsOverlap",value:function(t,e,i,n,r){var a,o,s,l,u=(this.attribute.label||{}).flush;if(void 0!==u&&u&&t.length){var c=this.attribute,h=c.orient,d=c.start,p=c.end,f="bottom"===h||"top"===h,v=t[0],g=kt(t),y=f?v.attribute.x>g.attribute.x:v.attribute.y<g.attribute.y;if(f){var m=y?g:v,_=y?v:g,b=d.x,x=p.x,k=m.AABBBounds.x1,S=_.AABBBounds.x2;k<b&&(m.attribute.angle?m.setAttributes({dx:(null!==(a=m.attribute.dx)&&void 0!==a?a:0)+b-k}):m.setAttributes({x:b,textAlign:"left"})),S>x&&(_.attribute.angle?_.setAttributes({dx:(null!==(o=_.attribute.dx)&&void 0!==o?o:0)+x-S}):_.setAttributes({x:x,textAlign:"right"}))}else{var A=y?g:v,M=y?v:g,w=A.AABBBounds.y2,T=M.AABBBounds.y1,C=d.y,E=p.y;T<C&&(M.attribute.angle?M.setAttributes({dy:(null!==(s=M.attribute.dy)&&void 0!==s?s:0)+C-T}):M.setAttributes({y:C,textBaseline:"top"})),w>E&&(A.attribute.angle?A.setAttributes({dy:(null!==(l=A.attribute.dy)&&void 0!==l?l:0)+E-w}):A.setAttributes({y:E,textBaseline:"bottom"}))}}}},{key:"handleLabelsOverlap",value:function(t,e,i,n,r){if(!ot(t)){var a=this.attribute,o=a.verticalLimitSize,s=a.label,l=a.orient,u=this._getAxisLabelLimitLength(o,r),c=s.layoutFunc,h=s.autoRotate,d=s.autoRotateAngle,p=s.autoLimit,f=s.limitEllipsis,v=s.autoHide,g=s.autoHideMethod,y=s.autoHideSeparation,m=s.lastVisible,_=s.firstVisible,b=s.autoWrap,x=s.overflowLimitLength;if(H(c))c(t,e,n,this);else{if(h)mB(t,{labelRotateAngle:d,orient:l});else if(b){!function(t,e){var i=e.limitLength,n=e.axisLength,r=e.ellipsis,a=void 0===r?"...":r,o=e.orient;if(!ot(t)&&Q(i)){var s=t[0].attribute.angle,l=iB(s),u=eB(s),c="top"===o||"bottom"===o,h=n/t.length;t.forEach((function(e,n){var r,o,s,d,p;if(c){if(u&&Math.floor(e.AABBBounds.height())<=i)return;if(l){var f=SB(e.attribute.x,null===(r=t[n+1])||void 0===r?void 0:r.attribute.x,null===(o=t[n-1])||void 0===o?void 0:o.attribute.x);Q(f)&&(h=de(h,f))}}else{if(u){var v=SB(e.attribute.y,null===(s=t[n+1])||void 0===s?void 0:s.attribute.y,null===(d=t[n-1])||void 0===d?void 0:d.attribute.y);Q(v)&&(h=de(h,v))}if(l&&Math.floor(e.AABBBounds.width())<=i)return}var g=null,y=null;c?u?(g=i,y=h):(g=h,y=i):u?(g=h,y=i):(g=i,y=h),e.setAttributes({maxLineWidth:g,ellipsis:null!==(p=e.attribute.ellipsis)&&void 0!==p?p:a,whiteSpace:"normal",heightLimit:y})}))}}(t,{orient:l,limitLength:u,axisLength:"left"===l||"right"===l?Math.abs(this.attribute.start.y-this.attribute.end.y):Math.abs(this.attribute.start.x-this.attribute.end.x),ellipsis:f})}if(!b&&p&&Q(u)&&u>0){var k="left"===l||"right"===l,S=k?Math.abs(this.attribute.start.y-this.attribute.end.y):Math.abs(this.attribute.start.x-this.attribute.end.x);kB(t,{limitLength:u,verticalLimitLength:k?S/t.length:v||h?1/0:S/t.length,ellipsis:f,orient:l,axisLength:S,overflowLimitLength:x})}v&&yB(t,{orient:l,method:g,separation:y,lastVisible:m,firstVisible:_})}}}},{key:"afterLabelsOverlap",value:function(t,e,i,n,r){var a,o=this.attribute,s=o.verticalLimitSize,l=o.orient,u="bottom"===l||"top"===l,c=i.AABBBounds,h=u?c.height():c.width(),d=this.attribute.verticalMinSize;if(Q(d)&&(!Q(s)||d<=s)){var p,f,v=this._getAxisLabelLimitLength(d,r);h=Math.max(h,v),"left"===l?(p=c.x2-h,f=c.y1):"right"===l?(p=c.x1,f=c.y1):"top"===l?(p=c.x1,f=c.y2-h):"bottom"===l&&(p=c.x1,f=c.y1);var g=By.rect({x:p,y:f,width:u?c.width():h,height:u?h:c.height(),pickable:!1});g.name=XR.axisLabelBackground,g.id=this._getNodeId("axis-label-background"),i.insertBefore(g,i.firstChild)}N(this.attribute.label.containerAlign)&&("left"===l?a=c.x2-h:"right"===l?a=c.x1:"top"===l?a=c.y2-h:"bottom"===l&&(a=c.y1),function(t,e,i,n,r){"left"===n||"right"===n?"left"===r?t.forEach((function(t){var i;t.setAttributes({dx:(null!==(i=t.attribute.dx)&&void 0!==i?i:0)+e-t.AABBBounds.x1})})):"right"===r?t.forEach((function(t){var n;t.setAttributes({dx:(null!==(n=t.attribute.dx)&&void 0!==n?n:0)+e+i-t.AABBBounds.x2})})):"center"===r&&t.forEach((function(t){var n;t.setAttributes({dx:(null!==(n=t.attribute.dx)&&void 0!==n?n:0)+e+i/2-(t.AABBBounds.x1+t.AABBBounds.x2)/2})})):"bottom"!==n&&"top"!==n||("top"===r?t.forEach((function(t){var i;t.setAttributes({dy:(null!==(i=t.attribute.dy)&&void 0!==i?i:0)+e-t.AABBBounds.y1})})):"bottom"===r?t.forEach((function(t){var n;t.setAttributes({dy:(null!==(n=t.attribute.dy)&&void 0!==n?n:0)+e+i-t.AABBBounds.y2})})):"middle"===r&&t.forEach((function(t){var n;t.setAttributes({dy:(null!==(n=t.attribute.dy)&&void 0!==n?n:0)+e+i/2-(t.AABBBounds.y1+t.AABBBounds.y2)/2})})))}(t,a,h,l,this.attribute.label.containerAlign))}},{key:"_getAxisLabelLimitLength",value:function(t,e){var i,n,r,a,o,s=this.attribute,l=s.label,u=s.title,c=s.line,h=s.tick,d=null!==(i=l.space)&&void 0!==i?i:4,p=t,f=0,v=0,g=c&&c.visible?null!==(n=c.style.lineWidth)&&void 0!==n?n:1:0,y=h&&h.visible?null!==(r=h.length)&&void 0!==r?r:4:0;if(u&&u.visible&&"string"==typeof u.text){f=cR(u.text,u.textStyle,null===(o=null===(a=this.stage)||void 0===a?void 0:a.getTheme())||void 0===o?void 0:o.text).height;var m=Ei(u.padding);v=u.space+m[0]+m[2]}return p&&(p=(p-d-v-f-g-y)/e),p}},{key:"release",value:function(){y(e,"release",this,3)([]),this._breaks=null}}])}(pB);TB.defaultAttributes=JR,bt(TB,AB);var CB=function(){return o((function t(){r(this,t)}),[{key:"isInValidValue",value:function(t){var e=this.attribute,i=e.startAngle,n=void 0===i?OP:i,r=e.endAngle,a=void 0===r?FP:r;return Math.abs(a-n)%(2*Math.PI)==0?t>1:t<0||t>1}},{key:"getTickCoord",value:function(t){var e=this.attribute,i=e.startAngle,n=void 0===i?OP:i,r=e.endAngle,a=void 0===r?FP:r,o=e.center,s=e.radius,l=e.inside,u=void 0!==l&&l,c=e.innerRadius,h=void 0===c?0:c;return Pe(o,u&&h>0?h:s,n+(a-n)*t)}},{key:"getVerticalVector",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return aB(t,arguments.length>2?arguments[2]:void 0,this.attribute.center,e,this.attribute.inside)}},{key:"getRelativeVector",value:function(t){var e=this.attribute.center;return[t.y-e.y,-1*(t.x-e.x)]}}])}();function EB(t,e){var i=t.length;return{prevLabel:e>=1?t[e-1]:t[i-1],nextLabel:e<i-1?t[e+1]:t[0]}}function PB(t,e,i){var n;t.setAttributes({maxLineWidth:e,ellipsis:null!==(n=t.attribute.ellipsis)&&void 0!==n?n:i})}function RB(t,e,i){var n=[];if(t.length>=3){var r=EB(t,e),a=r.prevLabel,o=r.nextLabel;n.push(a,o)}else 2===t.length&&n.push(t[0===e?1:0]);var s=t[e],l=Math.min(Math.abs(s.attribute.y-i.y1),Math.abs(s.attribute.y-i.y2));n.forEach((function(t){l=Math.min(l,Math.abs(t.attribute.y-s.attribute.y))})),l>0&&s.setAttributes({whiteSpace:"normal",heightLimit:l})}var BB=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i};MB(),oP();var IB=function(t){function e(t,i){return r(this,e),n(this,e,[(null==i?void 0:i.skipDefault)?t:ft({},e.defaultAttributes,t)])}return h(e,t),o(e,[{key:"renderLine",value:function(t){var e,i=this.attribute,n=i.startAngle,r=void 0===n?OP:n,a=i.endAngle,o=void 0===a?FP:a,s=i.radius,l=i.center,u=i.innerRadius,c=void 0===u?0:u,h=i.line,d=void 0===h?{}:h,p=i.inside,f=void 0!==p&&p,v=i.sides,g=s,y=c;if(f&&c>0&&(g=c,y=0),Q(v)&&v>=3){var m=oB(l,v,g,r,o);e=By.path(Object.assign(Object.assign({},d.style),{path:sB(m,!0)}))}else{var _=Object.assign(Object.assign(Object.assign({},l),{startAngle:r,endAngle:o,radius:g,innerRadius:y}),d.style);e=By.circle(_)}e.name=XR.line,e.id=this._getNodeId("line"),ot(d.state)||(e.states=ft({},ZR,d.state)),t.add(e)}},{key:"getTitleAttribute",value:function(){var t,e,i,n=this.attribute,r=n.center,a=n.radius,o=n.innerRadius,s=void 0===o?0:o,l=this.attribute.title,u=l.space,c=void 0===u?4:u,h=l.textStyle,d=void 0===h?{}:h,p=l.shape,f=l.background,v=l.state,g=void 0===v?{}:v,y=BB(l,["space","textStyle","shape","background","state"]),m=r,_=0;(null===(t=this.attribute.label)||void 0===t?void 0:t.visible)&&!1===this.attribute.label.inside&&(_=st(this.attribute.label,"style.fontSize",12)+st(this.attribute.label,"space",4));var b=0;(null===(e=this.attribute.tick)||void 0===e?void 0:e.visible)&&!1===this.attribute.tick.inside&&(b=this.attribute.tick.length||4),(null===(i=this.attribute.subTick)||void 0===i?void 0:i.visible)&&!1===this.attribute.subTick.inside&&(b=Math.max(b,this.attribute.subTick.length||2));var x=a+b+_+c,k="middle",S=this.attribute.title.position;j(S)&&(S=0===s?"end":"middle"),"start"===S?(k="bottom",m={x:r.x,y:r.y-x}):"end"===S&&(k="top",m={x:r.x,y:r.y+x});var A=Object.assign(Object.assign(Object.assign({},m),y),{textStyle:Object.assign({textBaseline:k,textAlign:"center"},d),state:{text:ft({},ZR,g.text),shape:ft({},ZR,g.shape),panel:ft({},ZR,g.background)}}),M=y.angle;return A.angle=M,p&&p.visible&&(A.shape=Object.assign({visible:!0},p.style),p.space&&(A.space=p.space)),f&&f.visible&&(A.panel=Object.assign({visible:!0},f.style)),A}},{key:"getSubTickLineItems",value:function(){var t,e,i=this.attribute.subTick,n=[],r=i.count,a=void 0===r?4:r,o=i.inside,s=void 0!==o&&o,l=i.length,u=void 0===l?2:l,c=this.tickLineItems,h=c.length;if(h>=2)for(var d=this.data[1].value-this.data[0].value,p=null===(e=null===(t=this.attribute)||void 0===t?void 0:t.tick)||void 0===e?void 0:e.alignWithLabel,f=0;f<h;f++)for(var v=c[f],g=c[f+1],y=0;y<a;y++){var m=(y+1)/(a+1),_=(1-m)*v.value+m*(g?g.value:p?1:v.value+d),b=this.getTickCoord(_),x=this.getVerticalCoord(b,u,s);n.push({start:b,end:x,value:_})}return n}},{key:"beforeLabelsOverlap",value:function(t,e,i,n,r){}},{key:"handleLabelsOverlap",value:function(t,e,i,n,r){if(!ot(t)){var a=this.attribute,o=a.inside,s=a.radius,l=a.center,u=a.size,c=a.label,h=a.orient,d=u?{x1:0,y1:0,x2:u.width,y2:u.height}:{x1:l.x-s,y1:l.y-s,x2:l.x+s,y2:l.y+s},p=c.layoutFunc,f=c.autoLimit,v=c.limitEllipsis,g=c.autoHide,y=c.autoHideMethod,m=c.autoHideSeparation,_=c.autoWrap;H(p)?p(t,e,n,this):((f||_)&&function(t,e){var i=e.ellipsis,n=e.inside,r=e.bounds,a=e.autoWrap,o=e.center;n||t.forEach((function(e,n){var s=e.attribute,l=s.x,u=s.y,c=e.AABBBounds;if(Nt(l,o.x)){if(u>r.y2||u<r.y1)return void PB(e,0,i);var h=r.x2-r.x1;if(t.length>=3){var d=EB(t,n),p=d.prevLabel,f=d.nextLabel,v=p.attribute.x,g=f.attribute.x;v>g&&(v=f.attribute.x,g=p.attribute.x);var y=v===g?h:l>=v&&l<=g?g-v:Math.min(Math.abs(v-l),Math.abs(g-l));e.AABBBounds.width()>y&&PB(e,y,i)}else e.AABBBounds.width()>h&&PB(e,h,i)}else l>o.x&&c.x2>r.x2?(PB(e,r.x2-l,i),a&&RB(t,n,r)):l<o.x&&c.x1<r.x1&&(PB(e,l-r.x1,i),a&&RB(t,n,r))}))}(t,{inside:o,autoWrap:_,bounds:d,ellipsis:v,center:l}),g&&yB(t,{orient:h,method:y,separation:m}))}}},{key:"afterLabelsOverlap",value:function(t,e,i,n,r){}},{key:"getTextBaseline",value:function(t){return Math.abs(t[1]/t[0])<.3?"middle":t[1]<0?"bottom":t[1]>0?"top":"middle"}},{key:"getLabelAlign",value:function(t,e,i){return Nt(t[0],0)?{textAlign:"center",textBaseline:t[1]>0?"top":"bottom"}:t[0]<0?{textAlign:"right",textBaseline:this.getTextBaseline(t)}:t[0]>0?{textAlign:"left",textBaseline:this.getTextBaseline(t)}:{textAlign:"center",textBaseline:"middle"}}},{key:"getLabelPosition",value:function(t,e,i,n){return t}}])}(pB);IB.defaultAttributes=JR,bt(IB,CB);var LB,DB=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).mode=wl.NORMAL,t}return h(e,t),o(e,[{key:"onBind",value:function(){var t=this,e=this.target.getInnerView(),i=this.target.getPrevInnerView();i&&(this._newElementAttrMap={},qP(e,(function(e){var n,r,a,o,s,l;if("group"!==e.type&&e.id){var u=i[e.id];if(u){if(!mt(e.attribute,u.attribute)){var c=ct(e.attribute);t._newElementAttrMap[e.id]={state:"update",node:e,attrs:Object.assign(Object.assign({},c),{opacity:null!==(n=c.opacity)&&void 0!==n?n:1,fillOpacity:null!==(r=c.fillOpacity)&&void 0!==r?r:1,strokeOpacity:null!==(a=c.strokeOpacity)&&void 0!==a?a:1})},e.setAttributes(u.attribute)}}else{var h={opacity:null!==(o=e.attribute.opacity)&&void 0!==o?o:1,fillOpacity:null!==(s=e.attribute.fillOpacity)&&void 0!==s?s:1,strokeOpacity:null!==(l=e.attribute.strokeOpacity)&&void 0!==l?l:1};t._newElementAttrMap[e.id]={state:"enter",node:e,attrs:h},e.setAttributes({opacity:0,fillOpacity:0,strokeOpacity:0})}}})))}},{key:"onStart",value:function(){var t=this,e=this.duration,i=this.easing;this._newElementAttrMap&&Object.keys(this._newElementAttrMap).forEach((function(n){var r,a=t._newElementAttrMap[n],o=a.node,s=a.attrs;if("enter"===a.state){var l=(null!==(r=t.params)&&void 0!==r?r:{}).enter,u=void 0===l?{}:l;e=Q(u.duration)?u.duration:e,i=u.easing?u.easing:i}"path"===o.type?o.animate({interpolate:function(t,e,i,n,r){return"path"===t&&(r.path=function(t,e){var i,n,r,a=$t.lastIndex=te.lastIndex=0,o=-1,s=[],l=[];for(t+="",e+="";(i=$t.exec(t))&&(n=te.exec(e));)(r=n.index)>a&&(r=e.slice(a,r),s[o]?s[o]+=r:s[++o]=r),(i=i[0])===(n=n[0])?s[o]?s[o]+=n:s[++o]=n:(s[++o]=null,l.push({i:o,x:Jt(i,n)})),a=te.lastIndex;return a<e.length&&(r=e.slice(a),s[o]?s[o]+=r:s[++o]=r),s.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var i,n=0;n<e;++n)s[(i=l[n]).i]=i.x(t);return s.join("")})}(i,n)(e),!0)}}).to(s,e,i):o.animate().to(s,e,i)}))}},{key:"onUpdate",value:function(t,e,i){}}])}(Yh),OB=function(t){return t.map((function(t,e){return{index:e,value:t}}))},FB=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=new pi(t).expand(i/2),r=new pi(e).expand(i/2);return n.intersects(r)},zB=function(t,e,i,n){return i<t?Math.max(t-e/2,i):i>t?Math.min(t-e/2,i-e):i<n?i:i-e},HB=function(t,e,i){var n,r=i.labelStyle,a=i.axisOrientType,o=i.labelFlush,s=i.labelFormatter,l=i.startAngle,u=void 0===l?0:l,c=null!==(n=r.angle)&&void 0!==n?n:0;"vertical"===r.direction&&(c+=we(90));var h=["bottom","top"].includes(a),d=["left","right"].includes(a),p=1,f=0;h||(d?(p=0,f=1):u&&(p=Math.cos(u),f=-Math.sin(u)));var v=uR(r),g=t.range(),y=e.map((function(i,n){var a,l,u,y,m=s?s(i):"".concat(i),_=v.quickMeasure(m),b=_.width,x=_.height,k=Math.max(b,12),S=Math.max(x,12),A=t.scale(i),M=p*A,w=f*A,T=M,C=w;o&&h&&0===n?T=zB(M,k,g[0],g[g.length-1]):o&&h&&n===e.length-1?T=zB(M,k,g[g.length-1],g[0]):u=null!==(a=r.textAlign)&&void 0!==a?a:"center","right"===u?T-=k:"center"===u&&(T-=k/2),o&&d&&0===n?C=zB(w,S,g[0],g[g.length-1]):o&&d&&n===e.length-1?C=zB(w,S,g[g.length-1],g[0]):y=null!==(l=r.textBaseline)&&void 0!==l?l:"middle","bottom"===y?C-=S:"middle"===y&&(C-=S/2);var E=(new pi).set(T,C,T+k,C+S);return c&&E.rotate(c,M,w),E}));return y};!function(t){t.Identity="identity",t.Linear="linear",t.Log="log",t.Pow="pow",t.Sqrt="sqrt",t.Symlog="symlog",t.Time="time",t.Quantile="quantile",t.Quantize="quantize",t.Threshold="threshold",t.Ordinal="ordinal",t.Point="point",t.Band="band"}(LB||(LB={}));var jB={};function NB(t){switch(t){case LB.Linear:case LB.Log:case LB.Pow:case LB.Sqrt:case LB.Symlog:case LB.Time:return!0;default:return!1}}function VB(t){return!!jB[t]}function WB(t){switch(t){case LB.Ordinal:case LB.Point:case LB.Band:return!0;default:return!1}}function GB(t){return t}Object.values(LB).forEach((function(t){jB[t]=!0}));var UB=function(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)},YB=function(t){return t<0?-t*t:t*t},XB=function(t){return-Math.log(-t)},KB=function(t){return-Math.exp(-t)},qB=function(t){return isFinite(t)?Math.pow(10,t):t<0?0:t},ZB=function(t){return 10===t?qB:t===Math.E?Math.exp:function(e){return Math.pow(t,e)}},JB=function(t){return t===Math.E?Math.log:10===t?Math.log10:2===t?Math.log2:(t=Math.log(t),function(e){return Math.log(e)/t})},QB=function(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}},$B=function(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}};function tI(t,e){if(t=Number(t),e=Number(e),e-=t)return function(i){return(i-t)/e};var i=Number.isNaN(e)?NaN:.5;return function(){return i}}function eI(t,e,i){var n,r,a=t[0],o=t[1],s=e[0],l=e[1];return o<a?(n=tI(o,a),r=i(l,s)):(n=tI(a,o),r=i(s,l)),function(t){return r(n(t))}}function iI(t,e,i){var n;return n=1===t?t+2*i:t-e+2*i,t?n>0?n:1:0}function nI(t,e,i,n){return 1===i&&(i=0),iI(t,i,n)*(e/(1-i))}function rI(t,e){var i=(t[1]-t[0])/(e[1]-e[0]),n=t[0]-i*e[0];return[n,i+n]}function aI(t,e,i){var n=Math.min(t.length,e.length)-1,r=new Array(n),a=new Array(n),o=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<n;)r[o]=tI(t[o],t[o+1]),a[o]=i(e[o],e[o+1]);return function(e){var i=Dt(t,e,1,n)-1;return a[i](r[i](e))}}var oI=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=Math.floor(Math.log10(t)),n=t/Math.pow(10,i);return(e?n<1.5?1:n<3?2:n<7?5:10:n<=1?1:n<=2?2:n<=5?5:10)*Math.pow(10,i)},sI=function(){return o((function t(){r(this,t),this._rangeFactorStart=null,this._rangeFactorEnd=null}),[{key:"_calculateWholeRange",value:function(t){return this._wholeRange?this._wholeRange:N(this._rangeFactorStart)&&N(this._rangeFactorEnd)&&2===t.length?(this._wholeRange=rI(t,[this._rangeFactorStart,this._rangeFactorEnd]),this._wholeRange):t}},{key:"rangeFactor",value:function(t,e,i){return t?(2===t.length&&t.every((function(t){return t>=0&&t<=1}))&&(this._wholeRange=null,0===t[0]&&1===t[1]?(this._rangeFactorStart=null,this._rangeFactorEnd=null):(this._rangeFactorStart=t[0],this._rangeFactorEnd=t[1])),this):i?(this._wholeRange=null,this._rangeFactorStart=null,this._rangeFactorEnd=null,this):N(this._rangeFactorStart)&&N(this._rangeFactorEnd)?[this._rangeFactorStart,this._rangeFactorEnd]:null}},{key:"rangeFactorStart",value:function(t,e){var i;return j(t)?this._rangeFactorStart:(t>=0&&t<=1&&(this._wholeRange=null,0!==t||!j(this._rangeFactorEnd)&&1!==this._rangeFactorEnd?(this._rangeFactorStart=t,this._rangeFactorEnd=null!==(i=this._rangeFactorEnd)&&void 0!==i?i:1):(this._rangeFactorStart=null,this._rangeFactorEnd=null)),this)}},{key:"rangeFactorEnd",value:function(t,e){var i;return j(t)?this._rangeFactorEnd:(t>=0&&t<=1&&(this._wholeRange=null,0!==t||!j(this._rangeFactorStart)&&0!==this._rangeFactorStart?(this._rangeFactorEnd=t,this._rangeFactorStart=null!==(i=this._rangeFactorStart)&&void 0!==i?i:0):(this._rangeFactorStart=null,this._rangeFactorEnd=null)),this)}},{key:"generateFishEyeTransform",value:function(){var t;if(this._fishEyeOptions){var e=this._fishEyeOptions,i=e.distortion,n=void 0===i?2:i,r=e.radiusRatio,a=void 0===r?.1:r,o=e.radius,s=this.range(),l=s[0],u=s[s.length-1],c=Math.min(l,u),h=Math.max(l,u),d=Ut(null!==(t=this._fishEyeOptions.focus)&&void 0!==t?t:0,c,h),p=j(o)?(h-c)*a:o,f=Math.exp(n);f=f/(f-1)*p;var v=n/p;this._fishEyeTransform=function(t){var e=Math.abs(t-d);if(e>=p)return t;if(e<=1e-6)return d;var i=f*(1-Math.exp(-e*v))/e*.75+.25;return d+(t-d)*i}}else this._fishEyeTransform=null}},{key:"unknown",value:function(t){return arguments.length?(this._unknown=t,this):this._unknown}},{key:"get",value:function(t,e){var i;return null!==(i=null==this?void 0:this[t])&&void 0!==i?i:e}}])}(),lI=Symbol("implicit"),uI=function(t){function e(){var t;return r(this,e),(t=n(this,e)).type=LB.Ordinal,t._index=new Map,t._domain=[],t._ordinalRange=[],t._unknown=lI,t}return h(e,t),o(e,[{key:"specified",value:function(t){var e;return t?(this._specified=Object.assign(null!==(e=this._specified)&&void 0!==e?e:{},t),this):Object.assign({},this._specified)}},{key:"_getSpecifiedValue",value:function(t){if(this._specified)return this._specified[t]}},{key:"clone",value:function(){var t=(new e).domain(this._domain).range(this._ordinalRange).unknown(this._unknown);return this._specified&&t.specified(this._specified),t}},{key:"calculateVisibleDomain",value:function(t){return N(this._rangeFactorStart)&&N(this._rangeFactorEnd)&&2===t.length?[this.invert(t[0]),this.invert(t[1])]:this._domain}},{key:"scale",value:function(t){var e="".concat(t),i=this._getSpecifiedValue(e);if(void 0!==i)return i;var n=this._index.get(e);if(!n){if(this._unknown!==lI)return this._unknown;n=this._domain.push(t),this._index.set(e,n)}var r=this._ordinalRange[(n-1)%this._ordinalRange.length];return this._fishEyeTransform?this._fishEyeTransform(r):r}},{key:"invert",value:function(t){for(var e=0;e<this._ordinalRange.length&&this._ordinalRange[e]!==t;)e++;return this._domain[(e-1)%this._domain.length]}},{key:"domain",value:function(t){if(!t)return this._domain.slice();this._domain=[],this._index=new Map;var e,i=s(t);try{for(i.s();!(e=i.n()).done;){var n=e.value,r="".concat(n);this._index.has(r)||this._index.set(r,this._domain.push(n))}}catch(t){i.e(t)}finally{i.f()}return this}},{key:"range",value:function(t){if(!t)return this._ordinalRange.slice();var e=Array.from(t);return this._ordinalRange=e,this}},{key:"index",value:function(t){var e;return this._index&&null!==(e=this._index.get("".concat(t)))&&void 0!==e?e:-1}}])}(sI);function cI(t,e,i,n){for(var r=[],a=t;a<=e;)r.push(a),a+=i;return n&&r.reverse(),r}function hI(t,e,i,n){var r,a;if(e=Math.floor(+e),t=Math.floor(+t),!(i=Math.floor(+i)))return[];if(t===e)return[t];if(r=e<t){var o=t;t=e,e=o}var s=Xt(1,e-t+1)(i);if(a=Math.floor((e-t+1)/s),!n)for(;Math.ceil((e-t+1)/a)>i&&s>1;)s-=1,a=Math.floor((e-t)/s);return cI(t,e,a,r)}var dI=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).type=LB.Band,i._range=[0,1],i._step=void 0,i._bandwidth=void 0,i._isFixed=!1,i._round=!1,i._paddingInner=0,i._paddingOuter=0,i._align=.5,i._unknown=void 0,delete i.unknown,i.rescale(t),i}return h(e,t),o(e,[{key:"rescale",value:function(t,i){if(t)return this;this._wholeRange=null;var n=this._calculateWholeRange(this._range,i),r=y(e,"domain",this,3)([]).length,a=n[1]<n[0],o=n[Number(a)-0],s=n[1-Number(a)],l=iI(r,this._paddingInner,this._paddingOuter);return this._step=(s-o)/Math.max(1,l||1),this._round&&(this._step=Math.floor(this._step)),o+=(s-o-this._step*(r-this._paddingInner))*this._align,this.isBandwidthFixed()||(this._bandwidth=this._step*(1-this._paddingInner)),this._round&&(o=Math.round(o),this.isBandwidthFixed()||(this._bandwidth=Math.round(this._bandwidth))),this._bandRangeState={reverse:a,start:a?o+this._step*(r-1):o,count:r},this.generateFishEyeTransform(),this}},{key:"scale",value:function(t){if(this._bandRangeState){var e="".concat(t),i=this._getSpecifiedValue(e);if(void 0!==i)return i;var n=this._index.get(e);if(!n){if(this._unknown!==lI)return this._unknown;n=this._domain.push(t),this._index.set(e,n)}var r=this._bandRangeState,a=r.count,o=r.start+(n-1)%a*(r.reverse?-1:1)*this._step;return this._fishEyeTransform?this._fishEyeTransform(o):o}}},{key:"_calculateWholeRange",value:function(t,i){if(this._wholeRange)return this._wholeRange;if((this._minBandwidth||this._maxBandwidth)&&!this._isBandwidthFixedByUser()){var n;if(N(this._rangeFactorStart)&&N(this._rangeFactorEnd)&&2===t.length){var r=rI(t,[this._rangeFactorStart,this._rangeFactorEnd]);n=Math.abs(r[1]-r[0])}else n=Math.abs(t[1]-t[0]);var a=function(t,e,i,n,r){var a=iI(t,i,n),o=e/Math.max(1,a||1);r&&(o=Math.floor(o));var s=o*(1-i);return r&&(s=Math.round(s)),s}(y(e,"domain",this,3)([]).length,n,this._paddingInner,this._paddingOuter,this._round);a<this._minBandwidth?(this._bandwidth=this._minBandwidth,this._isFixed=!0):a>this._maxBandwidth?(this._bandwidth=this._maxBandwidth,this._isFixed=!0):(this._bandwidth=a,this._isFixed=!1)}if(this.isBandwidthFixed()){var o=nI(y(e,"domain",this,3)([]).length,this._bandwidth,this._paddingInner,this._paddingOuter)*Math.sign(t[1]-t[0]),s=Math.min((t[1]-t[0])/o,1);if(N(this._rangeFactorStart)&&N(this._rangeFactorEnd)){var l=this._rangeFactorStart+s<=1,u=this._rangeFactorEnd-s>=0;if("rangeFactorStart"===i&&l?this._rangeFactorEnd=this._rangeFactorStart+s:"rangeFactorEnd"===i&&u?this._rangeFactorStart=this._rangeFactorEnd-s:t[0]<=t[1]?l?this._rangeFactorEnd=this._rangeFactorStart+s:u?this._rangeFactorStart=this._rangeFactorEnd-s:(this._rangeFactorStart=0,this._rangeFactorEnd=s):u?this._rangeFactorStart=this._rangeFactorEnd-s:l?this._rangeFactorEnd=this._rangeFactorStart+s:(this._rangeFactorStart=1-s,this._rangeFactorEnd=1),o>0){var c=t[0]-o*this._rangeFactorStart,h=c+o;this._wholeRange=[c,h]}else{var d=t[1]+o*(1-this._rangeFactorEnd),p=d-o;this._wholeRange=[p,d]}}else this._rangeFactorStart=0,this._rangeFactorEnd=s,this._wholeRange=[t[0],t[0]+o];return this._wholeRange}return y(e,"_calculateWholeRange",this,3)([t])}},{key:"calculateWholeRangeSize",value:function(){var t=this._calculateWholeRange(this._range);return Math.abs(t[1]-t[0])}},{key:"calculateVisibleDomain",value:function(t){var e=this._domain;if(N(this._rangeFactorStart)&&N(this._rangeFactorEnd)&&e.length){var i=this._getInvertIndex(t[0]),n=this._getInvertIndex(t[1]);return e.slice(Math.min(i,n),Math.max(i,n)+1)}return e}},{key:"domain",value:function(t,i){return t?(y(e,"domain",this,3)([t]),this.rescale(i)):y(e,"domain",this,3)([])}},{key:"range",value:function(t,e){return t?(this._range=[Pt(t[0]),Pt(t[1])],this.rescale(e)):this._range}},{key:"rangeRound",value:function(t,e){return this._range=[Pt(t[0]),Pt(t[1])],this._round=!0,this.rescale(e)}},{key:"ticks",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=this.calculateVisibleDomain(this._range);return-1===t?e:hI(0,e.length-1,t,!1).map((function(t){return e[t]}))}},{key:"tickData",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this.ticks(e).map((function(e,i){return{index:i,tick:e,value:(t.scale(e)-t._range[0]+t._bandwidth/2)/(t._range[1]-t._range[0])}}))}},{key:"forceTicks",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=this.calculateVisibleDomain(this._range);return hI(0,e.length-1,t,!0).filter((function(t){return t<e.length})).map((function(t){return e[t]}))}},{key:"stepTicks",value:function(t){var e=this.calculateVisibleDomain(this._range);return function(t,e,i){var n;if(i=Xt(1,(e=Math.floor(+e))-(t=Math.floor(+t))+1)(Math.floor(+i)),n=e<t){var r=t;t=e,e=r}return cI(t,e,i,n)}(0,e.length-1,t).map((function(t){return e[t]}))}},{key:"_getInvertIndex",value:function(t){var e=0,i=this.step()/2,n=this.bandwidth()/2,r=this._domain.length,a=this.range(),o=a[0]>a[a.length-1];for(e=0;e<r;e++){var s=this.scale(this._domain[e])+n;if(0===e&&(!o&&!Vt(t,s+i)||o&&!Wt(t,s-i)))break;if(e===r-1)break;if(!Wt(t,s-i)&&!Vt(t,s+i))break}return e>=0&&e<=r-1?e:r-1}},{key:"invert",value:function(t){return this._domain[this._getInvertIndex(t)]}},{key:"padding",value:function(t,e){return void 0!==t?(this._paddingOuter=Math.max(0,Math.min(Array.isArray(t)?Math.min.apply(null,t):t)),this._paddingInner=this._paddingOuter,this.rescale(e)):this._paddingInner}},{key:"paddingInner",value:function(t,e){return void 0!==t?(this._paddingInner=Math.max(0,Math.min(1,t)),this.rescale(e)):this._paddingInner}},{key:"paddingOuter",value:function(t,e){return void 0!==t?(this._paddingOuter=Math.max(0,Math.min(1,t)),this.rescale(e)):this._paddingOuter}},{key:"step",value:function(){return this._step}},{key:"round",value:function(t,e){return void 0!==t?(this._round=t,this.rescale(e)):this._round}},{key:"align",value:function(t,e){return void 0!==t?(this._align=Math.max(0,Math.min(1,t)),this.rescale(e)):this._align}},{key:"rangeFactor",value:function(t,i){return t?(y(e,"rangeFactor",this,3)([t]),this.rescale(i)):y(e,"rangeFactor",this,3)([])}},{key:"rangeFactorStart",value:function(t,i){return j(t)?y(e,"rangeFactorStart",this,3)([]):(y(e,"rangeFactorStart",this,3)([t]),this.rescale(i,"rangeFactorStart"))}},{key:"rangeFactorEnd",value:function(t,i){return j(t)?y(e,"rangeFactorEnd",this,3)([]):(y(e,"rangeFactorEnd",this,3)([t]),this.rescale(i,"rangeFactorEnd"))}},{key:"bandwidth",value:function(t,e){return t?("auto"===t?(this._bandwidth=void 0,this._isFixed=!1):(this._bandwidth=t,this._isFixed=!0),this._userBandwidth=t,this.rescale(e)):this._bandwidth}},{key:"maxBandwidth",value:function(t,e){return t?(this._maxBandwidth="auto"===t?void 0:t,this.rescale(e)):this._maxBandwidth}},{key:"minBandwidth",value:function(t,e){return t?(this._minBandwidth="auto"===t?void 0:t,this.rescale(e)):this._minBandwidth}},{key:"fishEye",value:function(t,e,i){return t||i?(this._fishEyeOptions=t,this._fishEyeTransform=null,this.rescale(e)):this._fishEyeOptions}},{key:"isBandwidthFixed",value:function(){return this._isFixed&&!!this._bandwidth}},{key:"_isBandwidthFixedByUser",value:function(){return this._isFixed&&this._userBandwidth&&Z(this._userBandwidth)}},{key:"clone",value:function(){var t,i,n;return new e(!0).domain(this._domain,!0).range(this._range,!0).round(this._round,!0).paddingInner(this._paddingInner,!0).paddingOuter(this._paddingOuter,!0).align(this._align,!0).bandwidth(null!==(t=this._userBandwidth)&&void 0!==t?t:"auto",!0).maxBandwidth(null!==(i=this._maxBandwidth)&&void 0!==i?i:"auto",!0).minBandwidth(null!==(n=this._maxBandwidth)&&void 0!==n?n:"auto")}}])}(uI),pI=function(t,e){var i=t.r,n=e.r,r=t.g,a=e.g,o=t.b,s=e.b,l=t.opacity,u=e.opacity;return function(t){var e=Math.round(i*(1-t)+n*t),c=Math.round(r*(1-t)+a*t),h=Math.round(o*(1-t)+s*t);return new Ci(e,c,h,l*(1-t)+u*t)}};function fI(t,e){var i,n=b(e);if(j(e)||"boolean"===n)return function(){return e};if("number"===n)return Jt(t,e);if("string"===n){if(i=Ti.parseColorString(e)){var r=pI(Ti.parseColorString(t),i);return function(t){return r(t).formatRgb()}}return Jt(Number(t),Number(e))}return e instanceof Ci?pI(t,e):e instanceof Ti?pI(t.color,e.color):e instanceof Date?function(t,e){var i=t.valueOf(),n=e.valueOf(),r=new Date;return function(t){return r.setTime(i*(1-t)+n*t),r}}(t,e):Jt(Number(t),Number(e))}var vI=function(t){function e(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:GB,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:GB;return r(this,e),(t=n(this,e))._unknown=void 0,t.transformer=i,t.untransformer=a,t._forceAlign=!0,t._domain=[0,1],t._range=[0,1],t._clamp=GB,t._piecewise=eI,t._interpolate=fI,t}return h(e,t),o(e,[{key:"calculateVisibleDomain",value:function(t){var e;return N(this._rangeFactorStart)&&N(this._rangeFactorEnd)&&2===t.length?[this.invert(t[0]),this.invert(t[1])]:null!==(e=this._niceDomain)&&void 0!==e?e:this._domain}},{key:"fishEye",value:function(t,e,i){return t||i?(this._fishEyeOptions=t,this._fishEyeTransform=null,this.rescale(e)):this._fishEyeOptions}},{key:"scale",value:function(t){var e;if(t=Number(t),Number.isNaN(t)||this._domainValidator&&!this._domainValidator(t))return this._unknown;this._output||(this._output=this._piecewise((null!==(e=this._niceDomain)&&void 0!==e?e:this._domain).map(this.transformer),this._calculateWholeRange(this._range),this._interpolate));var i=this._output(this.transformer(this._clamp(t)));return this._fishEyeTransform?this._fishEyeTransform(i):i}},{key:"invert",value:function(t){var e;return this._input||(this._input=this._piecewise(this._calculateWholeRange(this._range),(null!==(e=this._niceDomain)&&void 0!==e?e:this._domain).map(this.transformer),Jt)),this._clamp(this.untransformer(this._input(t)))}},{key:"domain",value:function(t,e){var i;if(!t)return(null!==(i=this._niceDomain)&&void 0!==i?i:this._domain).slice();this._domainValidator=null,this._niceType=null,this._niceDomain=null;var n=Array.from(t,Pt);return this._domain=n,this.rescale(e)}},{key:"range",value:function(t,e){if(!t)return this._range.slice();var i=Array.from(t);return this._range=i,this.rescale(e)}},{key:"rangeRound",value:function(t,e){var i=Array.from(t);return this._range=i,this._interpolate=Qt,this.rescale(e)}},{key:"rescale",value:function(t){var e;if(t)return this;var i=null!==(e=this._niceDomain)&&void 0!==e?e:this._domain,n=i.length,r=this._range.length,a=Math.min(n,r);if(n&&n<r&&this._forceAlign){for(var o=r-n+1,s=i[n-1],l=n>=2?(s-i[n-2])/o:0,u=1;u<=o;u++)i[n-2+u]=s-l*(o-u);a=r}return this._autoClamp&&(this._clamp=Xt(i[0],i[a-1])),this._piecewise=a>2?aI:eI,this._output=this._input=null,this._wholeRange=null,this.generateFishEyeTransform(),this}},{key:"clamp",value:function(t,e,i){return arguments.length?(e?(this._autoClamp=!1,this._clamp=e):(this._autoClamp=!!t,this._clamp=t?void 0:GB),this.rescale(i)):this._clamp!==GB}},{key:"interpolate",value:function(t,e){return arguments.length?(this._interpolate=t,this.rescale(e)):this._interpolate}},{key:"ticks",value:function(){return[]}},{key:"tickData",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,i=this.ticks(e);return(null!=i?i:[]).map((function(e,i){return{index:i,tick:e,value:(t.scale(e)-t._range[0])/(t._range[1]-t._range[0])}}))}},{key:"rangeFactor",value:function(t,i){return t?(y(e,"rangeFactor",this,3)([t]),this._output=this._input=null,this):y(e,"rangeFactor",this,3)([])}},{key:"rangeFactorStart",value:function(t,i){return j(t)?y(e,"rangeFactorStart",this,3)([]):(y(e,"rangeFactorStart",this,3)([t]),this._output=this._input=null,this)}},{key:"rangeFactorEnd",value:function(t,i){return j(t)?y(e,"rangeFactorEnd",this,3)([]):(y(e,"rangeFactorEnd",this,3)([t]),this._output=this._input=null,this)}},{key:"forceAlignDomainRange",value:function(t){return arguments.length?(this._forceAlign=t,this):this._forceAlign}}])}(sI),gI=Math.sqrt(50),yI=Math.sqrt(10),mI=Math.sqrt(2),_I=[1,2,5,10],bI=function(t,e,i){var n=1,r=t,a=Math.floor((e-1)/2),o=Math.abs(t);return t>=0&&t<=Number.MIN_VALUE?r=0:t<0&&t>=-Number.MIN_VALUE?r=-(e-1):!i&&o<1?n=AI(o).step:(i||o>1)&&(r=Math.floor(t)-a*n),n>0?(t>0?r=Math.max(r,0):t<0&&(r=Math.min(r,-(e-1)*n)),Ct(0,e).map((function(t){return r+t*n}))):t>0?kI(0,-(e-1)/n,n):kI((e-1)/n,0,n)},xI=Gt((function(t,e,i,n){var r,a,o,s,l=-1;if(i=+i,(t=+t)==(e=+e))return[t];if(Math.abs(t-e)<=Number.MIN_VALUE&&i>0)return[t];if((r=e<t)&&(a=t,t=e,e=a),s=MI(t,e,i).step,!isFinite(s))return[];if(s>0){var u=Math.round(t/s),c=Math.round(e/s);for(u*s<t&&++u,c*s>e&&--c,o=new Array(a=c-u+1);++l<a;)o[l]=(u+l)*s}else if(s<0&&(null==n?void 0:n.noDecimals)){s=1;var h=Math.ceil(t),d=Math.floor(e);if(!(h<=d))return[];for(o=new Array(a=d-h+1);++l<a;)o[l]=h+l}else{s=-s;var p=Math.round(t*s),f=Math.round(e*s);for(p/s<t&&++p,f/s>e&&--f,o=new Array(a=f-p+1);++l<a;)o[l]=(p+l)/s}return r&&o.reverse(),o})),kI=function(t,e,i){var n,r,a=-1;if(i>0){var o=Math.floor(t/i),s=Math.ceil(e/i);for((o+1)*i<t&&++o,(s-1)*i>e&&--s,r=new Array(n=s-o+1);++a<n;)r[a]=(o+a)*i}else{i=-i;var l=Math.floor(t*i),u=Math.ceil(e*i);for((l+1)/i<t&&++l,(u-1)/i>e&&--u,r=new Array(n=u-l+1);++a<n;)r[a]=(l+a)/i}return r},SI=Gt((function(t,e,i,n){var r,a,o;if(i=+i,(t=+t)==(e=+e))return bI(t,i,null==n?void 0:n.noDecimals);if(Math.abs(t-e)<=Number.MIN_VALUE&&i>0)return bI(t,i,null==n?void 0:n.noDecimals);(r=e<t)&&(o=t,t=e,e=o);var s=MI(t,e,i),l=s.step;if(!isFinite(l))return[];if(l>0){for(var u=1,c=s.power,h=10===s.gap?2*Math.pow(10,c):1*Math.pow(10,c);u<=5&&(a=kI(t,e,l)).length>i+1&&i>2;)l+=h,u+=1;i>2&&a.length<i-1&&(a=function(t,e,i){var n,r=t[0],a=t[t.length-1],o=e-t.length;if(a<=0){var s=[];for(n=o;n>=1;n--)s.push(r-n*i);return s.concat(t)}if(r>=0){for(n=1;n<=o;n++)t.push(a+n*i);return t}var l=[],u=[];for(n=1;n<=o;n++)n%2==0?l=[r-Math.floor(n/2)*i].concat(l):u.push(a+Math.ceil(n/2)*i);return l.concat(t).concat(u)}(a,i,l))}else(null==n?void 0:n.noDecimals)&&l<0&&(l=1),a=kI(t,e,l);return r&&a.reverse(),a})),AI=function(t){var e=Math.floor(Math.log(t)/Math.LN10),i=t/Math.pow(10,e),n=_I[0];return i>=gI?n=_I[3]:i>=yI?n=_I[2]:i>=mI&&(n=_I[1]),e>=0?{step:n*Math.pow(10,e),gap:n,power:e}:{step:-Math.pow(10,-e)/n,gap:n,power:e}};function MI(t,e,i){var n=(e-t)/Math.max(0,i);return AI(n)}function wI(t,e,i){var n;if(i=+i,(t=+t)==(e=+e)&&i>0)return[t];if(i<=0||0===(n=function(t,e,i){return(e-t)/Math.max(1,i-1)}(t,e,i))||!isFinite(n))return[];for(var r=new Array(i),a=0;a<i;a++)r[a]=t+a*n;return r}function TI(t){var e,i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,r=0,a=t.length-1,o=t[r],s=t[a],l=10;for(s<o&&(i=o,o=s,s=i,i=r,r=a,a=i);l-- >0;){if((i=MI(o,s,n).step)===e)return t[r]=o,t[a]=s,t;if(i>0)o=Math.floor(o/i)*i,s=Math.ceil(s/i)*i;else{if(!(i<0))break;o=Math.ceil(o*i)/i,s=Math.floor(s*i)/i}e=i}}function CI(t,e){var i=Z(e.forceMin),n=Z(e.forceMax),r=null,a=[],o=null,s=i&&n?function(t){return t>=e.forceMin&&t<=e.forceMax}:i?function(t){return t>=e.forceMin}:n?function(t){return t<=e.forceMax}:null;return i?a[0]=e.forceMin:Z(e.min)&&e.min<=Math.min(t[0],t[t.length-1])&&(a[0]=e.min),n?a[1]=e.forceMax:Z(e.max)&&e.max>=Math.max(t[0],t[t.length-1])&&(a[1]=e.max),Z(a[0])&&Z(a[1])?((o=t.slice())[0]=a[0],o[o.length-1]=a[1]):r=Z(a[0])||Z(a[1])?Z(a[0])?"max":"min":"all",{niceType:r,niceDomain:o,niceMinMax:a,domainValidator:s}}var EI=function(t,e,i){return Math.abs(e-t)<1?+i.toFixed(1):Math.round(+i)},PI=Gt((function(t,e,i,n,r,a,o){var s,l=t,u=e,c=u<l;c&&(l=(s=[u,l])[0],u=s[1]);var h,d,p=r(l),f=r(u),v=[];if(!(n%1)&&f-p<i){if(p=Math.floor(p),f=Math.ceil(f),l>0){for(;p<=f;++p)for(h=1;h<n;++h)if(!((d=p<0?h/a(-p):h*a(p))<l)){if(d>u)break;v.push(d)}}else for(;p<=f;++p)for(h=n-1;h>=1;--h)if(!((d=p>0?h/a(-p):h*a(p))<l)){if(d>u)break;v.push(d)}2*v.length<i&&(v=SI(l,u,i))}else v=SI(p,f,Math.min(f-p,i)).map(a);return v=v.filter((function(t){return 0!==t})),(null==o?void 0:o.noDecimals)&&(v=Array.from(new Set(v.map((function(t){return Math.floor(t)}))))),c?v.reverse():v})),RI=Gt((function(t,e,i,n,r,a){var o=[],s={},l=r(t),u=r(e),c=[];if(Number.isInteger(n))c=SI(l,u,i);else for(var h=(u-l)/(i-1),d=0;d<i;d++)c.push(l+d*h);return c.forEach((function(i){var r=a(i),l=Number.isInteger(n)?EI(t,e,r):EI(t,e,oI(r)),u=EI(t,e,function(t,e){var i,n;return e[0]<e[1]?(i=e[0],n=e[1]):(i=e[1],n=e[0]),Math.min(Math.max(t,i),n)}(l,[t,e]));!s[u]&&!isNaN(u)&&c.length>1&&(s[u]=1,o.push(u))})),o})),BI=Gt((function(t,e,i,n,r){return wI(n(t),n(e),i).map((function(t){return oI(r(t))}))})),II=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type=LB.Linear,t}return h(e,t),o(e,[{key:"clone",value:function(){var t,i=new e;return i.domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate),this._niceType&&(i._niceType=this._niceType,i._domainValidator=this._domainValidator,i._niceDomain=null===(t=this._niceDomain)||void 0===t?void 0:t.slice()),i}},{key:"tickFormat",value:function(){return function(){}}},{key:"d3Ticks",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=arguments.length>1?arguments[1]:void 0,i=this.calculateVisibleDomain(this._range);return xI(i[0],i[i.length-1],t,e)}},{key:"ticks",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,i=arguments.length>1?arguments[1]:void 0;if(H(null==i?void 0:i.customTicks))return i.customTicks(this,e);if(N(this._rangeFactorStart)&&N(this._rangeFactorEnd)&&(this._rangeFactorStart>0||this._rangeFactorEnd<1)&&2===this._range.length||!this._niceType)return this.d3Ticks(e,i);var n=null!==(t=this._niceDomain)&&void 0!==t?t:this._domain,r=this._domain,a=n[0],o=n[n.length-1],s=SI(r[0],r[r.length-1],e,i);if(!s.length)return s;if(this._domainValidator)s=s.filter(this._domainValidator);else if((s[0]!==a||s[s.length-1]!==o)&&this._niceType){var l=n.slice();if("all"===this._niceType?(l[0]=s[0],l[l.length-1]=s[s.length-1],this._niceDomain=l,this.rescale()):"min"===this._niceType&&s[0]!==a?(l[0]=s[0],this._niceDomain=l,this.rescale()):"max"===this._niceType&&s[s.length-1]!==o&&(l[l.length-1]=s[s.length-1],this._niceDomain=l,this.rescale()),"all"!==this._niceType){var u=Math.min(l[0],l[l.length-1]),c=Math.max(l[0],l[l.length-1]);s=s.filter((function(t){return t>=u&&t<=c}))}}return s}},{key:"forceTicks",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=this.calculateVisibleDomain(this._range);return wI(e[0],e[e.length-1],t)}},{key:"stepTicks",value:function(t){var e=this.calculateVisibleDomain(this._range);return function(t,e,i){var n,r,a=-1;if(i=+i,(r=(e=+e)<(t=+t))&&(n=t,t=e,e=n),!isFinite(i)||e-t<=i)return[t];for(var o=Math.floor((e-t)/i+1),s=new Array(o);++a<o;)s[a]=t+a*i;return r&&s.reverse(),s}(e[0],e[e.length-1],t)}},{key:"nice",value:function(){var t,e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,n=arguments.length>1?arguments[1]:void 0,r=this._domain,a=[];if(n){var o=CI(r,n);if(a=o.niceMinMax,this._domainValidator=o.domainValidator,this._niceType=o.niceType,o.niceDomain)return this._niceDomain=o.niceDomain,this.rescale(),this}else this._niceType="all";if(this._niceType){var s=TI(r.slice(),i);"min"===this._niceType?s[s.length-1]=null!==(t=a[1])&&void 0!==t?t:s[s.length-1]:"max"===this._niceType&&(s[0]=null!==(e=a[0])&&void 0!==e?e:s[0]),this._niceDomain=s,this.rescale()}return this}},{key:"niceMin",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;this._niceType="min";var e=this._domain[this._domain.length-1],i=TI(this.domain(),t);return i&&(i[i.length-1]=e,this._niceDomain=i,this.rescale()),this}},{key:"niceMax",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;this._niceType="max";var e=this._domain[0],i=TI(this._domain.slice(),t);return i&&(i[0]=e,this._niceDomain=i,this.rescale()),this}}])}(vI),LI=function(){return o((function t(){r(this,t)}),[{key:"nice",value:function(){var t,e,i,n,r=arguments.length>1?arguments[1]:void 0,a=this._domain,o=[],s=null;if(r){var l=CI(a,r);if(o=l.niceMinMax,this._domainValidator=l.domainValidator,s=l.niceType,l.niceDomain)return this._niceDomain=l.niceDomain,this.rescale(),this}else s="all";if(s){var u=function(t,e){var i,n,r=t.slice(),a=0,o=r.length-1,s=r[a],l=r[o];return l<s&&(a=(i=[o,a])[0],o=i[1],s=(n=[l,s])[0],l=n[1]),r[a]=e.floor(s),r[o]=e.ceil(l),r}(a.slice(),null!==(e=null===(t=this.getNiceConfig)||void 0===t?void 0:t.call(this))&&void 0!==e?e:{floor:function(t){return Math.floor(t)},ceil:function(t){return Math.ceil(t)}});return"min"===s?u[u.length-1]=null!==(i=o[1])&&void 0!==i?i:u[u.length-1]:"max"===s&&(u[0]=null!==(n=o[0])&&void 0!==n?n:u[0]),this._niceDomain=u,this.rescale(),this}return this}},{key:"niceMin",value:function(){var t=this._domain[this._domain.length-1];this.nice();var e=this._domain.slice();return this._domain&&(e[e.length-1]=t,this._niceDomain=e,this.rescale()),this}},{key:"niceMax",value:function(){var t=this._domain[0];this.nice();var e=this._domain.slice();return this._domain&&(e[0]=t,this._niceDomain=e,this.rescale()),this}}])}();function DI(t){return function(e){return-t(-e)}}function OI(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.EPSILON;return function(e){return Math.max(e,t)}}var FI=function(t){function e(){var t;return r(this,e),(t=n(this,e,[JB(10),ZB(10)])).type=LB.Log,t._limit=OI(),t._logs=t.transformer,t._pows=t.untransformer,t._domain=[1,10],t._base=10,t}return h(e,t),o(e,[{key:"clone",value:function(){return(new e).domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate,!0).base(this._base)}},{key:"rescale",value:function(t){var i;if(t)return this;y(e,"rescale",this,3)([]);var n=JB(this._base),r=ZB(this._base);return(null!==(i=this._niceDomain)&&void 0!==i?i:this._domain)[0]<0?(this._logs=DI(n),this._pows=DI(r),this._limit=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.EPSILON;return function(e){return Math.min(e,-t)}}(),this.transformer=XB,this.untransformer=KB):(this._logs=n,this._pows=r,this._limit=OI(),this.transformer=this._logs,this.untransformer=r),this}},{key:"scale",value:function(t){var e;if(t=Number(t),Number.isNaN(t)||this._domainValidator&&!this._domainValidator(t))return this._unknown;this._output||(this._output=this._piecewise((null!==(e=this._niceDomain)&&void 0!==e?e:this._domain).map(this._limit).map(this.transformer),this._calculateWholeRange(this._range),this._interpolate));var i=this._output(this.transformer(this._limit(this._clamp(t))));return this._fishEyeTransform?this._fishEyeTransform(i):i}},{key:"base",value:function(t,e){return arguments.length?(this._base=t,this.rescale(e)):this._base}},{key:"tickFormat",value:function(){return GB}},{key:"d3Ticks",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=arguments.length>1?arguments[1]:void 0,i=this.domain(),n=this._limit(i[0]),r=this._limit(i[i.length-1]);return PI(n,r,t,this._base,this.transformer,this.untransformer,e)}},{key:"ticks",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=this.calculateVisibleDomain(this._range);return RI(this._limit(e[0]),this._limit(e[e.length-1]),t,this._base,this.transformer,this.untransformer)}},{key:"forceTicks",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=this.calculateVisibleDomain(this._range);return BI(e[0],e[e.length-1],t,this.transformer,this.untransformer)}},{key:"stepTicks",value:function(t){var e=this.calculateVisibleDomain(this._range);return BI(this._limit(e[0]),this._limit(e[e.length-1]),t,this.transformer,this.untransformer)}},{key:"getNiceConfig",value:function(){var t=this;return{floor:function(e){return t._pows(Math.floor(t._logs(t._limit(e))))},ceil:function(e){return Math.abs(e)>=1?Math.ceil(e):t._pows(Math.ceil(t._logs(t._limit(e))))}}}}])}(vI);bt(FI,LI);var zI=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[!1])).type=LB.Point,i._padding=0,i.paddingInner(1,t),i.padding=i.paddingOuter,i.paddingInner=void 0,i.paddingOuter=void 0,i}return h(e,t),o(e)}(dI),HI=function(t){function e(){var t;return r(this,e),(t=n(this,e,[UB,YB])).type=LB.Sqrt,t}return h(e,t),o(e,[{key:"clone",value:function(){return(new e).domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate)}}])}(II),jI=function(t){function e(){var t;return r(this,e),(t=n(this,e,[QB(1),$B(1)])).type=LB.Symlog,t._const=1,t}return h(e,t),o(e,[{key:"clone",value:function(){return(new e).domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate,!0).constant(this._const)}},{key:"constant",value:function(t,e){return arguments.length?(this._const=t,this.transformer=QB(t),this.untransformer=$B(t),this.rescale(e)):this._const}},{key:"d3Ticks",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=arguments.length>1?arguments[1]:void 0,i=this.domain(),n=i[0],r=i[i.length-1];return PI(n,r,t,this._const,this.transformer,this.untransformer,e)}},{key:"ticks",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=this.calculateVisibleDomain(this._range);return RI(e[0],e[e.length-1],t,this._const,this.transformer,this.untransformer)}},{key:"forceTicks",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=this.calculateVisibleDomain(this._range);return BI(e[0],e[e.length-1],t,this.transformer,this.untransformer)}},{key:"stepTicks",value:function(t){var e=this.calculateVisibleDomain(this._range);return BI(e[0],e[e.length-1],t,this.transformer,this.untransformer)}}])}(II);bt(jI,LI);var NI=function(){function t(){r(this,t),this.type=LB.Threshold,this._range=[0,1],this._domain=[.5],this.n=1}return o(t,[{key:"unknown",value:function(t){return arguments.length?(this._unknown=t,this):this._unknown}},{key:"scale",value:function(t){return!j(t)&&Q(+t)?this._range[Dt(this._domain,t,0,this.n)]:this._unknown}},{key:"invertExtent",value:function(t){var e=this._range.indexOf(t);return[this._domain[e-1],this._domain[e]]}},{key:"domain",value:function(t){return t?(this._domain=Array.from(t),this.n=Math.min(this._domain.length,this._range.length-1),this):this._domain.slice()}},{key:"range",value:function(t){return t?(this._range=Array.from(t),this.n=Math.min(this._domain.length,this._range.length-1),this):this._range.slice()}},{key:"clone",value:function(){return(new t).domain(this._domain).range(this._range).unknown(this._unknown)}}])}();function VI(t,e,i,n){var r,a=t.breakData;if(a&&a()){var o=a().breakDomains,s=e.domain();r=[];for(var l=0;l<s.length-1;l++)n(i,[s[l],s[l+1]]).forEach((function(t){o.some((function(e){return t>=e[0]&&t<=e[1]}))||r.push(t)}));e.domain(s)}else r=n(i);return r}function WI(t,e,i,n){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(i&&!e.includes(t)){var a=e.length;if(a>1){r?e.push(t):e.unshift(t);for(var o=0;o<a;o++){var s=r?a-1-o:o;if(!n(e[s]))break;e.splice(s,1),o--,a--}}}}var GI=function(t,e){var i,n;if(!NB(t.type))return OB(t.domain());var r=t.range(),a=Math.abs(r[r.length-1]-r[0]);if(a<2)return OB([t.domain()[0]]);var o,s,l,u=e.tickCount,c=e.forceTickCount,h=e.tickStep,d=e.noDecimals,p=void 0!==d&&d,f=e.labelStyle,v=e.breakData;if(N(h))s=t.stepTicks(h),l=v&&v()?v().breakDomains:null,o=l&&l.length?s.filter((function(t){return l.every((function(e){return t<e[0]||t>e[1]}))})):s;else if(N(c))o=VI(e,t,c,(function(e,i){return i&&i.length?t.domain(i,!0).forceTicks(e):t.forceTicks(e)}));else if("d3"===e.tickMode){var g=null!==(i=H(u)?u({axisLength:a,labelStyle:f}):u)&&void 0!==i?i:5;o=VI(e,t,g,(function(e,i){return i&&i.length?t.domain(i,!0).d3Ticks(e,{noDecimals:p}):t.d3Ticks(e,{noDecimals:p})}))}else{var y=null!==(n=H(u)?u({axisLength:a,labelStyle:f}):u)&&void 0!==n?n:5,m=H(e.tickMode)?e.tickMode:void 0;o=VI(e,t,y,(function(e,i){return i&&i.length?t.domain(i,!0).ticks(e,{noDecimals:p,customTicks:m}):t.ticks(e,{noDecimals:p,customTicks:m})}))}var _=t.domain();if(e.labelFirstVisible&&_[0]!==o[0]&&!o.includes(_[0])&&o.unshift(_[0]),e.labelLastVisible&&_[_.length-1]!==o[o.length-1]&&!o.includes(_[_.length-1])&&o.push(_[_.length-1]),e.sampling&&o.length>1&&("cartesian"===e.coordinateType||"polar"===e.coordinateType&&"radius"===e.axisOrientType)){var b,x=e.labelGap,k=void 0===x?4:x,S=e.labelFlush;if(6*o.length>a){var A=[],M=Math.floor(6*o.length/a);o.forEach((function(t,e){e%M!=0&&e!==o.length-1||A.push(t)})),b=HB(t,A,e).map((function(t,e){return{AABBBounds:t,value:A[e]}}))}else b=HB(t,o,e).map((function(t,e){return{AABBBounds:t,value:o[e]}}));for(var w=b[0],T=kt(b),C=v&&v()?UI.greedy:UI.parity;b.length>=3&&uB(b,k);)b=C(b,k);var E=e.labelFirstVisible,P=e.labelLastVisible;lB(w,T,k)&&b.includes(T)&&b.length>1&&E&&P&&(b.splice(b.indexOf(T),1),P=!1),WI(w,b,E,(function(t){return lB(t,w,k)})),WI(T,b,P,(function(t){return lB(t,T,k)||!(!E||t===w)&&lB(t,w,k)}),!0);var R=b.map((function(t){return t.value}));R.length<3&&S&&(R.length>1&&R.pop(),kt(R)!==kt(o)&&R.push(kt(o))),o=R}return OB(o)},UI={parity:function(t){return t.filter((function(t,e){return e%2==0}))},greedy:function(t,e){var i;return t.filter((function(t,n){return!(n&&lB(i,t,e)||(i=t,0))}))}},YI=function(t,e,i,n){return HB(t,e,i).map((function(t){return n?[t.x1,t.x2,t.width()]:[t.y1,t.y2,t.height()]}))},XI=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Math.max(t[0],e[0])-i/2<=Math.min(t[1],e[1])+i/2},KI=function(t,e){return t[1]<e[0]?e[0]-t[1]:e[1]<t[0]?t[0]-e[1]:0},qI=function(t,e){var i,n=t.domain();if(!n.length)return[];var r,a=e.tickCount,o=e.forceTickCount,s=e.tickStep,l=e.labelGap,u=void 0===l?4:l,c=e.axisOrientType,h=e.labelStyle,d=function(t){return["bottom","top","z"].includes(t)}(c),p=t.range(),f=t.calculateWholeRangeSize();if(f<2)return e.labelLastVisible?OB([n[n.length-1]]):OB([n[0]]);if(N(s))r=t.stepTicks(s);else if(N(o))r=t.forceTicks(o);else if(N(a)){var v=H(a)?a({axisLength:f,labelStyle:h}):a;r=t.ticks(v)}else if(e.sampling){var g=(null!==(i=e.labelStyle.fontSize)&&void 0!==i?i:12)+2,y=At(p),_=St(p);if(n.length<=f/g){var b=(_-y)/n.length,x=YI(t,n,e,d),k=Math.min.apply(Math,m(x.map((function(t){return t[2]})))),S=ZI(n,x,u,e.labelLastVisible,Math.floor(k/b),!1);r=t.stepTicks(S.step),e.labelLastVisible&&(S.delCount&&(r=r.slice(0,r.length-S.delCount)),r.push(n[n.length-1]))}else{var A=[n[0],n[Math.floor(n.length/2)],n[n.length-1]],M=YI(t,A,e,d),w=null;M.forEach((function(t){w?w[2]<t[2]&&(w=t):w=t}));var T=_-y-u>0?Math.ceil(n.length*(u+w[2])/(_-y-u)):n.length-1;r=t.stepTicks(T),!e.labelLastVisible||r.length&&r[r.length-1]===n[n.length-1]||(r.length&&Math.abs(t.scale(r[r.length-1])-t.scale(n[n.length-1]))<w[2]&&(r=r.slice(0,-1)),r.push(n[n.length-1]))}}else r=t.domain();return OB(r)},ZI=function(t,e,i,n,r,a){var o=0,s=0,l=-1,u=Number.MAX_VALUE,c=function(n){var r=!0,a=0;do{a+n<t.length&&XI(e[a],e[a+n],i)&&(r=!1),a+=n}while(r&&a<t.length);return r},h=Ft(r,t.length,(function(t){return c(t)?1:-1})),d=h;do{if(d>h&&!a&&!c(d))d++;else{if(!n){s=d;break}var p=t.length-1,f=void 0,v=0;f=t.length%d>0?t.length-t.length%d+d:t.length;do{if((f-=d)!==p&&!XI(e[f],e[p],i))break;v++}while(f>0);if(f===p){s=d,o=v;break}var g=Math.floor(t.length/d)-v+1;if(g<l)break;l=g;var y=KI(e[f],e[p]),m=f-d>=0?KI(e[f-d],e[f]):y,_=Math.abs(y-m);if(_<u&&(u=_,s=d,o=v),y<=m)break;d++}}while(d<=t.length);return{step:s,delCount:o}},JI=function(t,e,i){var n,r=i.labelStyle,a=i.getRadius,o=i.labelOffset,s=i.labelFormatter,l=i.inside,u=null==a?void 0:a(),c=null!==(n=r.angle)&&void 0!==n?n:0,h=uR(r);return e.map((function(e){var i,n,a=s?s(e):"".concat(e),d=h.quickMeasure(a),p=d.width,f=d.height,v=Math.max(p,12),g=Math.max(f,12),y=t.scale(e),m={x:0,y:0},_={align:r.textAlign,baseline:r.textBaseline},b=function(t,e,i,n,r){var a,o,s=Pe({x:0,y:0},i,t),l=rB(s,aB(n,s,e,r));return a=l,o=aB(n||1,l,e,r),{x:a.x+o[0],y:a.y+o[1]}}(y,m,u,o,l),x=b.x,k=b.y;return _.align||(Nt(x,m.x)?_.baseline||(_.baseline=k>m.y?"top":"bottom"):x>m.x?_.align="left":x<m.x&&(_.align="right")),i=x+("right"===_.align?-v:"left"===_.align?0:-v/2),n=k+("bottom"===_.baseline?-g:"top"===_.baseline?0:-g/2),(new pi).set(i,n,i+v,n+g).rotate(c,i+v/2,n+g/2)}))},QI=function(t,e){var i,n=e.tickCount,r=e.forceTickCount,a=e.tickStep,o=e.getRadius,s=e.labelOffset,l=e.labelGap,u=void 0===l?0:l,c=e.labelStyle,h=null==o?void 0:o();if(!h)return OB(t.domain());if(N(a))i=t.stepTicks(a);else if(N(r))i=t.forceTicks(r);else if(N(n)){var d=t.range(),p=Math.abs(d[d.length-1]-d[0]),f=H(n)?n({axisLength:p,labelStyle:c}):n;i=t.ticks(f)}else if(e.sampling){var v=t.domain(),g=t.range(),y=JI(t,v,e),m=At(g),_=St(g),b=Math.abs(_-m)*(h+s)/v.length,x=$I(v,y,u,Math.floor(y.reduce((function(t,e){return Math.min(t,e.width(),e.height())}),Number.MAX_VALUE)/b)),k=x.step,S=x.delCount;i=(i=t.stepTicks(k)).slice(0,i.length-S)}else i=t.domain();return OB(i)},$I=function(t,e,i,n){var r=n;do{var a=!0;r++;var o=0;do{o+r<t.length&&FB(e[o],e[o+r],i)&&(a=!1),o+=r}while(a&&o<t.length);if(a)break}while(r<=t.length);var s=0;if(t.length>2){var l=t.length-t.length%r;for(l>=t.length&&(l-=r);l>0&&FB(e[0],e[l]);)s++,l-=r}return{step:r,delCount:s}},tL=new Uint32Array(33),eL=new Uint32Array(33);eL[0]=0,tL[0]=~eL[0];for(var iL=1;iL<=32;++iL)eL[iL]=eL[iL-1]<<1|1,tL[iL]=~eL[iL];function nL(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{top:0,left:0,right:0,bottom:0},n=i.top,r=void 0===n?0:n,a=i.left,o=void 0===a?0:a,s=i.right,l=void 0===s?0:s,u=i.bottom,c=void 0===u?0:u,h=Math.max(1,Math.sqrt(t*e/1e6)),d=~~((t+o+l+h)/h),p=~~((e+r+c+h)/h),f=function(t){return~~(t/h)};return f.bitmap=function(){return function(t,e){var i=new Uint32Array(~~((t*e+32)/32));function n(t,e){i[t]|=e}function r(t,e){i[t]&=e}return{array:i,get:function(e,n){var r=n*t+e;return i[r>>>5]&1<<(31&r)},set:function(e,i){var r=i*t+e;n(r>>>5,1<<(31&r))},clear:function(e,i){var n=i*t+e;r(n>>>5,~(1<<(31&n)))},getRange:function(n){var r=n.x1,a=n.y1,o=n.x2,s=n.y2;if(o<0||s<0||r>t||a>e)return!0;for(var l,u,c,h,d=s;d>=a;--d)if((c=(l=d*t+r)>>>5)==(h=(u=d*t+o)>>>5)){if(i[c]&tL[31&l]&eL[1+(31&u)])return!0}else{if(i[c]&tL[31&l])return!0;if(i[h]&eL[1+(31&u)])return!0;for(var p=c+1;p<h;++p)if(i[p])return!0}return!1},setRange:function(i){var r=i.x1,a=i.y1,o=i.x2,s=i.y2;if(!(o<0||s<0||r>t||a>e))for(var l,u,c,h,d;a<=s;++a)if((c=(l=a*t+r)>>>5)==(h=(u=a*t+o)>>>5))n(c,tL[31&l]&eL[1+(31&u)]);else for(n(c,tL[31&l]),n(h,eL[1+(31&u)]),d=c+1;d<h;++d)n(d,4294967295)},clearRange:function(e){for(var i,n,a,o,s,l=e.x1,u=e.y1,c=e.x2,h=e.y2;u<=h;++u)if((a=(i=u*t+l)>>>5)==(o=(n=u*t+c)>>>5))r(a,eL[31&i]|tL[1+(31&n)]);else for(r(a,eL[31&i]),r(o,tL[1+(31&n)]),s=a+1;s<o;++s)r(s,0)},outOfBounds:function(i){var n=i.x1,r=i.y1,a=i.x2,o=i.y2;return n<0||r<0||o>=e||a>=t},toImageData:function(n){for(var r=n.createImageData(t,e),a=r.data,o=0;o<e;++o)for(var s=0;s<t;++s){var l=o*t+s,u=4*l,c=i[l>>>5]&1<<(31&l);a[u+0]=255*c,a[u+1]=255*c,a[u+2]=255*c,a[u+3]=31}return r}}}(d,p)},f.x=function(t){return~~((t+o)/h)},f.y=function(t){return~~((t+r)/h)},f.ratio=h,f.padding=i,f.width=t,f.height=e,f}function rL(t,e){var i=e.x1,n=e.x2,r=e.y1,a=e.y2,o=t.padding,s=o.top,l=void 0===s?0:s,u=o.left,c=void 0===u?0:u,h=o.right,d=void 0===h?0:h,p=o.bottom,f=void 0===p?0:p,v=Ut(i,-c,t.width+d),g=Ut(n,-c,t.width+d),y=Ut(r,-l,t.height+f),m=Ut(a,-l,t.height+f);return{x1:t.x(v),x2:t.x(g),y1:t.y(y),y2:t.y(m)}}function aL(t,e){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?rL(t,e):{x1:t.x(e.x1),x2:t.x(e.x2),y1:t.y(e.y1),y2:t.y(e.y2)}}function oL(t,e,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=i;r>0&&(a={x1:i.x1-r,x2:i.x2+r,y1:i.y1-r,y2:i.y2+r}),a=aL(t,a);var o=e.outOfBounds(a);return!(n&&o||(o&&(a=rL(t,a)),e.getRange(a)))}function sL(t,e,i){for(var n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],o=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:[]).filter((function(t){return N(t)})),s=0;s<o.length;s++){var l=void 0;if((l=a?i:i.clone()).setAttributes(o[s]),oL(t,e,l.AABBBounds,n,r))return e.setRange(aL(t,l.AABBBounds,!0)),o[s]}return!1}function lL(t,e,i,n,r,a,o){var s,l,u,c=null===(s=n.overlap)||void 0===s?void 0:s.clampForce,h=null===(l=n.overlap)||void 0===l?void 0:l.overlapPadding;if("bound"===i.type||"position"===i.type){if(H(o)){var d=((H(i.position)?i.position(r.attribute):i.position)||(u=n.type,"rect"===u?cL:uL)).map((function(t){return o(r.AABBBounds,a,t,n.offset)})),p=!1===i.restorePosition;return sL(t,e,r,d,c,h,p)}return!1}if("moveY"===i.type){var f=(i.offset?H(i.offset)?i.offset(r.attribute):i.offset:[]).map((function(t){return{x:r.attribute.x,y:r.attribute.y+t}}));return sL(t,e,r,f,c,h)}if("moveX"===i.type){var v=(i.offset?H(i.offset)?i.offset(r.attribute):i.offset:[]).map((function(t){return{x:r.attribute.x+t,y:r.attribute.y}}));return sL(t,e,r,v,c,h)}return!1}var uL=["top","bottom","right","left","top-right","bottom-right","top-left","bottom-left"],cL=["top","inside-top","inside"];function hL(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=t.AABBBounds,a=r.x1,o=r.x2,s=r.y1,l=r.y2,u=n.top,c=void 0===u?0:u,h=n.left,d=void 0===h?0:h,p=n.right,f=void 0===p?0:p,v=n.bottom,g=void 0===v?0:v,y=Math.min(a,o),m=Math.max(a,o),_=Math.min(s,l),b=Math.max(s,l),x=e+f,k=i+g,S=0,A=0;return y<0-d?S=-y:m>x&&(S=x-m),_<0-c?A=-_:b>k&&(A=k-b),{dx:S,dy:A}}var dL={fadeIn:function(){var t,e,i,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{from:{opacity:0,fillOpacity:0,strokeOpacity:0},to:{opacity:null!==(t=n.opacity)&&void 0!==t?t:1,fillOpacity:null!==(e=n.fillOpacity)&&void 0!==e?e:1,strokeOpacity:null!==(i=n.strokeOpacity)&&void 0!==i?i:1}}},fadeOut:function(){var t,e,i,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{from:{opacity:null!==(t=n.opacity)&&void 0!==t?t:1,fillOpacity:null!==(e=n.fillOpacity)&&void 0!==e?e:1,strokeOpacity:null!==(i=n.strokeOpacity)&&void 0!==i?i:1},to:{opacity:0,fillOpacity:0,strokeOpacity:0}}}};function pL(t,e){var i,n;return null!==(n=null===(i=dL[e])||void 0===i?void 0:i.call(dL,t))&&void 0!==n?n:{from:{},to:{}}}var fL=function(t,e,i,n){var r=Object.assign({},t.attribute),a=Object.assign({},e.attribute);return xt(null==n?void 0:n.excludeChannels).forEach((function(t){delete a[t]})),Object.keys(a).forEach((function(t){i&&!i.includes(t)&&delete a[t]})),{from:r,to:a}};function vL(t,e,i,n){t.attribute.text!==e.attribute.text&&Q(Number(t.attribute.text)*Number(e.attribute.text))&&t.animate().play(new gd({text:t.attribute.text},{text:e.attribute.text},i,n))}var gL={mode:"same-time",duration:300,easing:"linear"};function yL(t){return 3===t||4===t}var mL=function(t){if(!t||!t.attribute)return[];var e=t.attribute,i=e.points,n=e.segments;if(n&&n.length){var r=[];return n.forEach((function(t){t.points.forEach((function(t){r.push(t)}))})),r}return i};function _L(t,e,i,n,r,a){return Math.abs(e/t)<a/r?{x:i+(t>0?r:-r),y:n+e*r/Math.abs(t)}:{x:i+t*a/Math.abs(e),y:n+(e>0?a:-a)}}var bL=function(t,e){return Math.ceil(t)>Math.floor(e)},xL=function(t,e){var i=g(t,2),n=i[0],r=i[1],a=g(e,2),o=a[0];return a[1]>n&&r>o};function kL(t,e){var i=g(t,2),n=i[0],r=i[1],a=g(e,2),o=a[0],s=a[1],l=Math.max(n,o),u=Math.min(r,s);return Math.max(0,u-l)}var SL=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i};cP(),BP(),wP(),fP();var AL=function(t){function e(t,a){var o;r(this,e);var s=t.data,l=SL(t,["data"]);return(o=n(this,e,[(null==a?void 0:a.skipDefault)?t:Object.assign({data:s},ft({},e.defaultAttributes,l))])).name="label",o._onHover=function(t){var e=t.target;e===o._lastHover||ot(e.states)||(e.addState(DP.hover,!0),qP(i(o),(function(t){t===e||ot(t.states)||t.addState(DP.hoverReverse,!0)})),o._lastHover=e)},o._onUnHover=function(t){o._lastHover&&(qP(i(o),(function(t){ot(t.states)||(t.removeState(DP.hoverReverse),t.removeState(DP.hover))})),o._lastHover=null)},o._onClick=function(t){var e=t.target;if(o._lastSelect===e&&e.hasState("selected"))return o._lastSelect=null,void qP(i(o),(function(t){ot(t.states)||(t.removeState(DP.selectedReverse),t.removeState(DP.selected))}));ot(e.states)||(e.addState(DP.selected,!0),qP(i(o),(function(t){t===e||ot(t.states)||t.addState(DP.selectedReverse,!0)})),o._lastSelect=e)},o._handleRelatedGraphicSetState=function(t){var e,i,n,r,a;if((null===(e=t.detail)||void 0===e?void 0:e.type)===Al.STATE||(null===(i=t.detail)||void 0===i?void 0:i.type)===Al.ANIMATE_UPDATE&&(null===(n=t.detail.animationState)||void 0===n?void 0:n.isFirstFrameOfStep)){var s=null!==(a=null===(r=t.target)||void 0===r?void 0:r.currentStates)&&void 0!==a?a:[],l=o._isCollectionBase?m(o._graphicToText.values()):[o._graphicToText.get(t.target)];o.updateStatesOfLabels(l,s)}},o}return h(e,t),o(e,[{key:"setBitmap",value:function(t){this._bitmap=t}},{key:"setBitmapTool",value:function(t){this._bmpTool=t}},{key:"labeling",value:function(t,e,i,n){}},{key:"_getLabelLinePoints",value:function(t,e){return function(t,e){if(t&&e&&!Ye(t,e,!0)){var i=Math.min(t.x1,t.x2),n=Math.min(t.y1,t.y2),r=Math.min(e.x1,e.x2),a=Math.min(e.y1,e.y2),o=Math.abs(t.x2-i)/2,s=Math.abs(t.y2-n)/2,l=Math.abs(e.x2-r)/2,u=Math.abs(e.y2-a)/2,c=i+o,h=n+s,d=r+l,p=a+u,f=d-c,v=p-h;return[_L(f,v,c,h,o,s),_L(-f,-v,d,p,l,u)]}}(t.AABBBounds,null==e?void 0:e.AABBBounds)}},{key:"_createLabelLine",value:function(t,e){var i=this._getLabelLinePoints(t,e);if(i){var n=By.line({points:i}),r=t.attribute.line,a=void 0===r?{}:r;if(a.customShape){var o=a.customShape;n.pathProxy=function(i){return o({text:t,baseMark:e},i,new Ru)}}return e&&e.attribute.fill&&n.setAttribute("stroke",e.attribute.fill),this.attribute.line&&!ot(this.attribute.line.style)&&n.setAttributes(this.attribute.line.style),this._setStatesOfLabelLine(n),n}}},{key:"render",value:function(){var t=this;if(this._prepare(),!(j(this._idToGraphic)||this._isCollectionBase&&j(this._idToPoint))){var e=this.attribute,i=e.overlap,n=e.smartInvert,r=e.dataFilter,a=e.customLayoutFunc,o=e.customOverlapFunc,s=this.attribute.data;if(H(r)&&(s=r(s)),s&&s.length){var l=new Set;s=s.filter((function(t){return!l.has(t.id)&&l.add(t.id)}))}var u=this._initText(s);u=H(a)?a(s,u,this.getRelatedGraphic.bind(this),this._isCollectionBase?function(e){return t._idToPoint.get(e.id)}:null,this):this._layout(u),H(o)?u=o(u,this.getRelatedGraphic.bind(this),this._isCollectionBase?function(e){return t._idToPoint.get(e.id)}:null,this):!1!==i&&(u=this._overlapping(u)),H(this.attribute.onAfterOverlapping)&&this.attribute.onAfterOverlapping(u,this.getRelatedGraphic.bind(this),this._isCollectionBase?function(e){return t._idToPoint.get(e.id)}:null,this),u&&u.length&&u.forEach((function(e){t._bindEvent(e),t._setStatesOfText(e)})),!1!==n&&this._smartInvert(u),this._renderLabels(u)}}},{key:"_bindEvent",value:function(t){if(!this.attribute.disableTriggerEvent&&t){var e=this.attribute,i=e.hover,n=e.select;i&&(t.addEventListener("pointermove",this._onHover),t.addEventListener("pointerout",this._onUnHover)),n&&t.addEventListener("pointerdown",this._onClick)}}},{key:"_setStatesOfText",value:function(t){if(t){var e=this.attribute.state;e&&!ot(e)&&(t.states=e)}}},{key:"_setStatesOfLabelLine",value:function(t){if(t){var e=this.attribute.labelLineState;e&&!ot(e)&&(t.states=e)}}},{key:"_createLabelText",value:function(t){var e,i;return pR(Object.assign(Object.assign({},null===(i=null===(e=this.stage)||void 0===e?void 0:e.getTheme())||void 0===i?void 0:i.text),t),"textType")}},{key:"_prepare",value:function(){var t,e,i=[];if((H(this.attribute.getBaseMarks)?this.attribute.getBaseMarks():function(t,e){if(!e)return[];var i=t.find((function(t){return t.name===e}),!0);return i?i.getChildren():[]}(this.getRootNode(),this.attribute.baseMarkGroupName)).forEach((function(t){"willRelease"!==t.releaseStatus&&i.push(t)})),null===(t=this._idToGraphic)||void 0===t||t.clear(),null===(e=this._idToPoint)||void 0===e||e.clear(),this._baseMarks=i,this._isCollectionBase="line-data"===this.attribute.type,i&&0!==i.length){var n=this.attribute.data;if(n&&0!==n.length){if(this._idToGraphic||(this._idToGraphic=new Map),this._isCollectionBase){this._idToPoint||(this._idToPoint=new Map);for(var r=0,a=0;a<i.length;a++){var o=i[a],s=mL(o);if(s&&s.length)for(var l=0;l<s.length;l++){var u=n[r];u&&s[l]&&(N(u.id)||(u.id="vrender-component-".concat(this.name,"-").concat(r)),this._idToPoint.set(u.id,s[l]),this._idToGraphic.set(u.id,o)),r++}}}else for(var c=0;c<i.length;c++){var h=n[c],d=i[c];h&&d&&(N(h.id)||(h.id="vrender-component-".concat(this.name,"-").concat(c)),this._idToGraphic.set(h.id,d))}if(!1!==this.attribute.animation){var p=this.attribute,f=p.animation,v=p.animationEnter,g=p.animationExit,y=p.animationUpdate,m=V(f)?f:{};this._animationConfig={enter:!1!==v&&ft({},gL,m,null!=v?v:{}),exit:!1!==g&&ft({},gL,m,null!=g?g:{}),update:!1!==y&&(X(y)?y:ft({},gL,m,null!=y?y:{}))}}else this._animationConfig={enter:!1,exit:!1,update:!1}}}}},{key:"getRelatedGraphic",value:function(t){return this._idToGraphic.get(t.id)}},{key:"_initText",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=this.attribute.textStyle,i=void 0===e?{}:e,n=[],r=0;r<t.length;r++){var a=t[r],o=this.getRelatedGraphic(a);if(o){var s=Object.assign(Object.assign({fill:this._isCollectionBase?X(o.attribute.stroke)?o.attribute.stroke.find((function(t){return!!t&&!0!==t})):o.attribute.stroke:o.attribute.fill},i),a),l=this._createLabelText(s);n.push(l)}}return n}},{key:"_layout",value:function(t){for(var e=this.attribute,i=e.position,n=e.offset,r=0;r<t.length;r++){var a=t[r];if(!a)return;var o=a.attribute,s=this.getRelatedGraphic(o);if(s){a.attachedThemeGraphic=this;var l=this.getGraphicBounds(a);a.attachedThemeGraphic=null;var u=H(i)?i(o):i,c=this._isCollectionBase?this.getGraphicBounds(null,this._idToPoint.get(o.id),u):this.getGraphicBounds(s,{x:o.x,y:o.y},u),h=this.labeling(l,c,u,n);h&&a.setAttributes(h)}}return t}},{key:"_overlapping",value:function(t){var e,i,n;if(0===t.length)return[];var r=V(this.attribute.overlap)?this.attribute.overlap:{},a=this.getBaseMarkGroup(),o=null!==(e=r.size)&&void 0!==e?e:{width:null!==(i=null==a?void 0:a.AABBBounds.width())&&void 0!==i?i:0,height:null!==(n=null==a?void 0:a.AABBBounds.height())&&void 0!==n?n:0};if(0===o.width||0===o.height)return t;var s=r.strategy,l=r.priority,u=this._bmpTool||nL(o.width,o.height),c=this._bitmap||u.bitmap();return l&&(t=t.sort((function(t,e){return l(e.attribute.data)-l(t.attribute.data)}))),"shiftY"===(null==s?void 0:s.type)?this._overlapGlobal(t,r,u,c):this._overlapByStrategy(t,r,u,c)}},{key:"_overlapGlobal",value:function(t,e,i,n){var r=this,a=t.filter((function(t){return t.attribute.visible&&0!==t.attribute.opacity&&r.isMarkInsideRect(r.getRelatedGraphic(t.attribute),i)})),o=e.clampForce,l=void 0===o||o,u=e.hideOnHit,c=void 0===u||u,h=e.overlapPadding,d=e.strategy;if(l)for(var p=0;p<a.length;p++){var f=t[p],v=hL(f,i.width,i.height,i.padding),y=v.dx,m=void 0===y?0:y,_=v.dy,b=void 0===_?0:_;0===m&&0===b||(f.setAttributes({x:f.attribute.x+m,y:f.attribute.y+b}),f._isClamped=!0)}a=function(t,e){var i=e.maxY,n=void 0===i?Number.MAX_VALUE:i,r=e.labelling,a=e.globalShiftY,o=void 0===a?{enable:!0,maxIterations:10,maxError:.1,padding:1}:a,l=t.length;if(l<=1)return t;var u=new Map,c=new Map,h=function(t){return c.get(t).y1Initial},d=function(t){return c.get(t).height},p=function(t){return c.get(t).y1},f=function(t){return c.get(t).x},v=function(t){return c.get(t).x1},y=function(t){return c.get(t).x2},m=function(t){return c.get(t).attempts},_=function(t,e){c.get(t).y1=e},b=function(t,e){c.get(t).attempts=e};function x(t){for(var e=t.length-1;e>=0;e--){var i=t[e],a=t[e-1],o=t[e+1];if(a&&bL(p(a)+d(a),p(i))||0===p(i)&&i._isClamped){var s=r(i).y;o&&bL(s+d(i)/2,p(o))||s+d(i)/2<=n&&_(i,p(i)+s-(l=i,c.get(l).y))}}var l}t.sort((function(t,e){return t.attribute.x-e.attribute.x}));var k,S=s(t);try{for(S.s();!(k=S.n()).done;){var A=k.value,M=A.AABBBounds,w=M.y1,T=M.y2,C=M.x1,E=M.x2,P=A.attribute,R=P.x,B=P.y;c.set(A,{y1Initial:w,y1:w,y2:T,y:B,height:T-w,x1:C,x2:E,x:R,attempts:0});var I,L=!1,D=s(u);try{for(D.s();!(I=D.n()).done;){var O=g(I.value,2),F=O[0],z=O[1],H=F.start,j=F.end;if(C>=H&&E<=j)z.push(A),L=!0;else if(Nt(R,f(z[0]),void 0,5)){var N={start:Math.min(H,C),end:Math.max(j,E)};z.push(A),u.set(N,z),u.delete(F),L=!0}else if(kL([H,j],[C,E])/(j-H)>.5){var V={start:Math.min(H,C),end:Math.max(j,E)};z.push(A),u.set(V,z),u.delete(F),L=!0}if(L)break}}catch(t){D.e(t)}finally{D.f()}L||u.set({start:C,end:E},[A])}}catch(t){S.e(t)}finally{S.f()}var W,G=s(u.values());try{for(G.s();!(W=G.n()).done;){var U=W.value;U.sort((function(t,e){return h(t)-h(e)})),x(U)}}catch(t){G.e(t)}finally{G.f()}if(!1!==o.enable)for(var Y=o.maxIterations,X=void 0===Y?10:Y,K=o.maxError,q=void 0===K?.1:K,Z=o.padding,J=void 0===Z?1:Z,Q=o.maxAttempts,$=void 0===Q?1e3:Q,tt=o.deltaYTolerance,et=void 0===tt?Number.MAX_VALUE:tt,it=0;it<X;it++){t.sort((function(t,e){return h(t)-h(e)}));for(var nt=0,rt=0;rt<l-1;rt++){var at=t[rt];if(!(m(at)>=$)){for(var ot=void 0,st=rt+1;(ot=t[st])&&!xL([v(at),y(at)],[v(ot),y(ot)]);)st+=1;if(ot){var lt=p(at),ut=d(at),ct=p(ot),ht=ct-(lt+ut);if(ht<J){var dt=(J-ht)/2;if(nt=Math.max(nt,dt),lt+dt+d(ot)>n){var pt=lt-(J-ht),ft=h(at)-pt;Math.abs(ft)<=et&&(_(at,pt),b(at,m(at)+1))}else if(lt-dt<0){var vt=ct+(J-ht),gt=h(ot)-vt;Math.abs(gt)<=et&&(_(ot,vt),b(ot,m(ot)+1))}else{var yt=lt-dt,mt=h(at)-yt,_t=ct+dt,bt=h(ot)-_t;Math.abs(mt)<=et&&Math.abs(bt)<=et&&(_(at,yt),_(ot,_t),b(at,m(at)+1),b(ot,m(ot)+1))}}}}}if(nt<q)break}var xt,kt=s(t);try{for(kt.s();!(xt=kt.n()).done;){var St=xt.value,At=St.attribute.y+p(St)-h(St);St.setAttribute("y",At)}}catch(t){kt.e(t)}finally{kt.f()}var Mt=[];t.sort((function(t,e){return t.attribute.x-e.attribute.x}));for(var wt=0,Tt=t.length-1;wt<=Tt;)wt===Tt?Mt.push(t[wt]):(Mt.push(t[wt]),Mt.push(t[Tt])),wt++,Tt--;return Mt}(a,Object.assign(Object.assign({maxY:i.height},d),{labelling:function(t){var e=r.getRelatedGraphic(t.attribute),i=r._isCollectionBase?r.getGraphicBounds(null,r._idToPoint.get(t.attribute.id)):r.getGraphicBounds(e,t);return r.labeling(t.AABBBounds,i,"bottom",r.attribute.offset)}}));for(var x=0;x<a.length;x++){var k=a[x],S=k.AABBBounds,A=aL(i,S,!0);if(oL(i,n,S,l,h))n.setRange(A);else{if(l&&this._processClampForce(k,i,n,h))continue;c?k.setAttributes({visible:!1}):n.setRange(A)}}return a}},{key:"_processClampForce",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=hL(t,e.width,e.height,e.padding),a=r.dy,o=void 0===a?0:a,s=r.dx,l=void 0===s?0:s;if(0===l&&0===o){if(oL(e,i,t.AABBBounds,!1,n))return i.setRange(aL(e,t.AABBBounds,!0)),!0}else if(oL(e,i,{x1:t.AABBBounds.x1+l,x2:t.AABBBounds.x2+l,y1:t.AABBBounds.y1+o,y2:t.AABBBounds.y2+o}))return t.setAttributes({x:t.attribute.x+l,y:t.attribute.y+o}),i.setRange(aL(e,t.AABBBounds,!0)),!0;return!1}},{key:"_overlapByStrategy",value:function(t,e,i,n){var r,a=this,o=e.avoidBaseMark,s=e.strategy,l=void 0===s?[]:s,u=e.hideOnHit,c=void 0===u||u,h=e.clampForce,d=void 0===h||h,p=e.avoidMarks,f=void 0===p?[]:p,v=e.overlapPadding,g=[],y=l.some((function(t){return"bound"===t.type}));o&&(null===(r=this._baseMarks)||void 0===r||r.forEach((function(t){t.AABBBounds&&n.setRange(aL(i,t.AABBBounds,!0))}))),f.length>0&&f.forEach((function(t){Y(t)?function(t,e){if(!e)return[];var i=t.find((function(t){return t.name===e}),!0);return i?i.findAll((function(t){return"group"!==t.type}),!0):[]}(a.getRootNode(),t).forEach((function(t){t.AABBBounds&&n.setRange(aL(i,t.AABBBounds,!0))})):t.AABBBounds&&n.setRange(aL(i,t.AABBBounds,!0))}));for(var m=0;m<t.length;m++)if(!1!==t[m].attribute.visible){var _=t[m],b=this.getRelatedGraphic(_.attribute);if(_.update(),this.isMarkInsideRect(b,i)){if(oL(i,n,_.AABBBounds,d,v)){if(!y){n.setRange(aL(i,_.AABBBounds,!0)),g.push(_);continue}if(y&&b&&b.AABBBounds&&this._canPlaceInside(_.AABBBounds,b.AABBBounds)){n.setRange(aL(i,_.AABBBounds,!0)),g.push(_);continue}}for(var x=!1,k=0;k<l.length;k++)if(!1!==(x=lL(i,n,l[k],this.attribute,_,this._isCollectionBase?this.getGraphicBounds(null,this._idToPoint.get(t[m].attribute.id)):this.getGraphicBounds(b,t[m].attribute),this.labeling))){_.setAttributes({x:x.x,y:x.y}),g.push(_);break}(!x&&d&&this._processClampForce(_,i,n,v)||!x&&!c)&&g.push(_)}}return g}},{key:"isMarkInsideRect",value:function(t,e){var i=e.padding,n=i.left,r=i.right,a=i.top,o=i.bottom,s={x1:-n,x2:e.width+r,y1:-a,y2:e.height+o},l=t.AABBBounds;if(0!==l.width()&&0!==l.height())return Ye(t.AABBBounds,s,!0);var u=t.attribute;if("rect"===t.type){var c=u.x,h=u.x1,d=u.y,p=u.y1;return Xe({x:null!=c?c:h,y:null!=d?d:p},s,!0)}return"x"in u&&"y"in u&&Xe({x:u.x,y:u.y},s,!0)}},{key:"getBaseMarkGroup",value:function(){var t=this.attribute.baseMarkGroupName;if(t)return this.getRootNode().find((function(e){return e.name===t}),!0)}},{key:"getGraphicBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;if(t){if(!1!==t.attribute.visible)return t.AABBBounds;var n=t.attribute,r=n.x,a=n.y;return{x1:r,x2:r,y1:a,y2:a}}if(e&&i&&"inside-middle"===i){var o=e.x,s=e.y,l=e.x1,u=void 0===l?o:l,c=e.y1,h=void 0===c?s:c;return{x1:(o+u)/2,x2:(o+u)/2,y1:(s+h)/2,y2:(s+h)/2}}var d=e.x,p=e.y;return{x1:d,x2:d,y1:p,y2:p}}},{key:"_renderLabels",value:function(t){var e,i=this,n=this.attribute.syncState,r=new Map,a=this._graphicToText||new Map,o=[],s=[],l=(null!==(e=this.attribute.line)&&void 0!==e?e:{}).visible;t&&t.forEach((function(t,e){var u,c,h=i.getRelatedGraphic(t.attribute),d=i._isCollectionBase?t.attribute.id:h,p=(null==a?void 0:a.get(d))?"update":"enter";if(l&&(c=i._createLabelLine(t,h)),n&&i.updateStatesOfLabels([c?{text:t,labelLine:c}:{text:t}],null!==(u=h.currentStates)&&void 0!==u?u:[]),"enter"===p)o.push(t),r.set(d,c?{text:t,labelLine:c}:{text:t}),i._addLabel({text:t,labelLine:c},o,s,e);else if("update"===p){var f=a.get(d);a.delete(d),r.set(d,f),i._updateLabel(f,{text:t,labelLine:c})}})),this._removeLabel(a),this._graphicToText=r}},{key:"_addLabel",value:function(t,e,i,n){var r=this,a=t.text,o=t.labelLine,s=this.getRelatedGraphic(a.attribute);if(this._syncStateWithRelatedGraphic(s),!1!==this._enableAnimation&&!1!==this._animationConfig.enter){if(s){var l=pL(a.attribute,"fadeIn"),u=l.from,c=l.to;a&&this.add(a),o&&(i.push(o),this.add(o)),this._animationConfig.enter.duration>0&&s.once("animate-bind",(function(t){a.setAttributes(u),o&&o.setAttributes(u);var l=r._afterRelatedGraphicAttributeUpdate(a,e,o,i,n,s,c,r._animationConfig.enter);s.on("afterAttributeUpdate",l)}))}}else a&&this.add(a),o&&this.add(o)}},{key:"_updateLabel",value:function(t,e){var i=t.text,n=t.labelLine,r=e.text,a=e.labelLine;if(!1!==this._enableAnimation&&!1!==this._animationConfig.update){var o=this._animationConfig.update,s=o.duration,l=o.easing;(function(t,e,i){var n=function(t,e){var i={};for(var n in e.attribute)t.attribute[n]!==e.attribute[n]&&(i[n]=e.attribute[n]);return i};if(!X(i)){var r=i.duration,a=i.easing,o=i.increaseEffect,s=void 0===o||o;return t.animate().to(n(t,e),r,a),void(s&&"text"===t.type&&"text"===e.type&&vL(t,e,r,a))}i.forEach((function(i){var r=i.duration,a=i.easing,o=i.increaseEffect,s=void 0===o||o,l=i.channel;ot(fL(t,e,l,i.options).to)||t.animate().to(n(t,e),r,a),s&&"text"===t.type&&"text"===e.type&&vL(t,e,r,a)}))})(i,r,this._animationConfig.update),n&&a&&t.labelLine.animate().to(a.attribute,s,l)}else t.text.setAttributes(r.attribute),n&&a&&t.labelLine.setAttributes(a.attribute)}},{key:"_removeLabel",value:function(t){var e=this,i=function(t){e.removeChild(t.text),t.labelLine&&e.removeChild(t.labelLine)};if(!1!==this._enableAnimation&&!1!==this._animationConfig.exit){var n=this._animationConfig.exit,r=n.duration,a=n.easing;t.forEach((function(t){var e;null===(e=t.text)||void 0===e||e.animate().to(pL(t.text.attribute,"fadeOut").to,r,a).onEnd((function(){i(t)}))}))}else t.forEach((function(t){i(t)}))}},{key:"updateStatesOfLabels",value:function(t,e){t.forEach((function(t){t&&(t.text&&t.text.useStates(e),t.labelLine&&t.labelLine.useStates(e))}))}},{key:"_syncStateWithRelatedGraphic",value:function(t){this.attribute.syncState&&t&&t.on("afterAttributeUpdate",this._handleRelatedGraphicSetState)}},{key:"_afterRelatedGraphicAttributeUpdate",value:function(t,e,i,n,r,a,o,s){var l=this,u=s.mode,c=s.duration,h=s.easing,d=s.delay,p=function(s){var f,v,g,y=s.detail;if(!y)return{};var m=null===(f=y.animationState)||void 0===f?void 0:f.step;if(y.type!==Al.ANIMATE_UPDATE||!m||"wait"===m.type&&null==(null===(v=m.prev)||void 0===v?void 0:v.type))return{};if(y.type===Al.ANIMATE_END)return t.setAttributes(o),void(i&&i.setAttributes(o));var _=function(){a&&(a.onAnimateBind=void 0,a.removeEventListener("afterAttributeUpdate",p))};switch(u){case"after":y.animationState.end&&(t.animate({onStart:_}).wait(d).to(o,c,h),i&&i.animate().wait(d).to(o,c,h));break;case"after-all":r===e.length-1&&y.animationState.end&&(e.forEach((function(t){t.animate({onStart:_}).wait(d).to(o,c,h)})),n.forEach((function(t){t.animate().wait(d).to(o,c,h)})));break;default:if(l._isCollectionBase){var b=l._idToPoint.get(t.attribute.id);!b||t.animates&&t.animates.has("label-animate")||!a.containsPoint(b.x,b.y,Sl.LOCAL,null===(g=l.stage)||void 0===g?void 0:g.getPickerService())||(t.animate({onStart:_}).wait(d).to(o,c,h),i&&i.animate().wait(d).to(o,c,h))}else y.animationState.isFirstFrameOfStep&&(t.animate({onStart:_}).wait(d).to(o,c,h),i&&i.animate().wait(d).to(o,c,h))}};return p}},{key:"_smartInvert",value:function(t){var e,i,n,r,a,o,s,l=V(this.attribute.smartInvert)?this.attribute.smartInvert:{},u=l.textType,c=l.contrastRatiosThreshold,h=l.alternativeColors,d=l.mode,p=l.interactInvertType,f=null!==(e=l.fillStrategy)&&void 0!==e?e:"invertBase",v=null!==(i=l.strokeStrategy)&&void 0!==i?i:"base",g=null!==(n=l.brightColor)&&void 0!==n?n:"#ffffff",y=null!==(r=l.darkColor)&&void 0!==r?r:"#000000",m=null!==(a=l.outsideEnable)&&void 0!==a&&a;if("null"!==f||"null"!==v)for(var _=0;_<t.length;_++){var b=t[_];if(b){var x=this.getRelatedGraphic(b.attribute),k=x.attribute.fill,S=b.attribute.fill;if(V(k)&&k.gradient){var A=null===(s=null===(o=k.stops)||void 0===o?void 0:o[0])||void 0===s?void 0:s.color;A&&(k=A,S=A)}var M=eR(S,k,u,c,h,d),w=iR(M,g)?g:y,T=this._canPlaceInside(b.AABBBounds,x.AABBBounds),C=!T&&b.AABBBounds&&x.AABBBounds&&x.AABBBounds.intersects(b.AABBBounds);if(T||m||C&&"inside"===p){var E=aR(f,k,M,w);if(E&&b.setAttributes({fill:E}),0===b.attribute.lineWidth||0===b.attribute.strokeOpacity)continue;var P=aR(v,k,M,w);P&&b.setAttributes({stroke:P})}else if(C&&"none"!==p){if(0===b.attribute.lineWidth||0===b.attribute.strokeOpacity)continue;if(b.attribute.stroke){b.setAttributes({fill:eR(b.attribute.fill,b.attribute.stroke,u,c,h,d)});continue}var R=aR(f,k,M,w);R&&b.setAttributes({fill:R});var B=aR(v,k,M,w);B&&b.setAttributes({stroke:B})}}}}},{key:"_canPlaceInside",value:function(t,e){return!(!t||!e)&&e.encloses(t)}},{key:"setLocation",value:function(t){this.translateTo(t.x,t.y)}},{key:"disableAnimation",value:function(){this._enableAnimation=!1}},{key:"enableAnimation",value:function(){this._enableAnimation=!0}}])}(yS);AL.defaultAttributes={textStyle:{fontSize:12,textAlign:"center",textBaseline:"middle",boundsPadding:[-2,-1,-2,-1]},offset:0,pickable:!1};var ML={},wL=function(t,e){ML[t]=e},TL=function(t){return ML[t]},CL=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i},EL=function(t){function e(t,i){var a;r(this,e);var o=t.data,s=CL(t,["data"]);return(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:Object.assign({data:o},ft({},e.defaultAttributes,s))])).name="symbol-label",a}return h(e,t),o(e,[{key:"labeling",value:function(t,e){return function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"top",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(t){var r=t.x1,a=t.y1,o=t.x2,s=t.y2,l=Math.abs(o-r),u=Math.abs(s-a),c=(e.x1+e.x2)/2,h=(e.y1+e.y2)/2,d=0,p=0,f=0,v=0;e&&(f=Math.abs(e.x1-e.x2)/2,v=Math.abs(e.y1-e.y2)/2);var g={"top-right":-235,"top-left":235,"bottom-right":45,"bottom-left":-45};switch(i){case"top":p=-1;break;case"bottom":p=1;break;case"left":d=-1;break;case"right":d=1;break;case"bottom-left":case"bottom-right":case"top-left":case"top-right":d=Math.sin(g[i]*(Math.PI/180)),p=Math.cos(g[i]*(Math.PI/180));break;case"center":d=0,p=0}return{x:c+d*(n+f)+Math.sign(d)*(l/2),y:h+p*(n+v)+Math.sign(p)*(u/2)}}}(t,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"top",arguments.length>3&&void 0!==arguments[3]?arguments[3]:0)}}])}(AL);EL.defaultAttributes={textStyle:{fill:"#000"},position:"top",offset:5};var PL=function(){wL("symbol",EL),wL("line-data",EL)},RL=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i},BL=function(t){function e(t,i){r(this,e);var a=t.data,o=RL(t,["data"]);return n(this,e,[(null==i?void 0:i.skipDefault)?t:Object.assign({data:a},ft({},e.defaultAttributes,o))])}return h(e,t),o(e,[{key:"labeling",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"top",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(t&&e){var r=t.x1,a=t.y1,o=t.x2,s=t.y2,l=Math.abs(o-r),u=Math.abs(s-a),c=li(e,i),h=c.x,d=c.y,p=0,f=0,v=i.includes("inside");switch(i.includes("top")?f=v?1:-1:i.includes("bottom")?f=v?-1:1:i.includes("left")?p=v?1:-1:i.includes("right")&&(p=v?-1:1),i){case"top-right":case"bottom-right":p=-1;break;case"top-left":case"bottom-left":p=1}return{x:h+p*n+p*l/2,y:d+f*n+f*u/2}}}}])}(AL);BL.tag="rect-label",BL.defaultAttributes={textStyle:{fill:"#000"},position:"top",offset:5};var IL=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i},LL=function(t){function e(t,i){var a;r(this,e);var o=t.data,s=IL(t,["data"]);return(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:Object.assign({data:o},ft({},e.defaultAttributes,s))])).name="line-label",a}return h(e,t),o(e,[{key:"getGraphicBounds",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"end";if(!t||"line"!==t.type&&"area"!==t.type)return y(e,"getGraphicBounds",this,3)([t,i]);var r=t.attribute.points,a=t.attribute.segments;!r&&a&&a.length&&(r=a.reduce((function(t,e){var i;return t.concat(null!==(i=e.points)&&void 0!==i?i:[])}),[])),r&&0!==r.length||(r=[i]);var o="start"===n?0:r.length-1;return r[o]?{x1:r[o].x,x2:r[o].x,y1:r[o].y,y2:r[o].y}:void 0}},{key:"labeling",value:function(t,e){return function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"end",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(!t||!e)return{x:1/0,y:1/0};var r=t.x1,a=t.x2,o=Math.abs(a-r),s=e.x1,l=s;return"end"===i?l=s+o/2+n:"start"===i&&(l=s-o/2-n),{x:l,y:e.y1}}(t,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"end",arguments.length>3&&void 0!==arguments[3]?arguments[3]:0)}}])}(AL);LL.defaultAttributes={textStyle:{fill:"#000"},position:"end",offset:6};var DL=function(){wL("line",LL),wL("area",LL)},OL=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i},FL=function(){return o((function t(e,i,n,a,o,s,l,u,c){r(this,t),this.refDatum=e,this.center=i,this.outerCenter=n,this.quadrant=a,this.radian=o,this.middleAngle=s,this.innerRadius=l,this.outerRadius=u,this.circleCenter=c,this.labelVisible=!0}),[{key:"getLabelBounds",value:function(){return this.labelPosition&&this.labelSize?{x1:this.labelPosition.x-this.labelSize.width/2,y1:this.labelPosition.y-this.labelSize.height/2,x2:this.labelPosition.x+this.labelSize.width/2,y2:this.labelPosition.y+this.labelSize.height/2}:{x1:0,x2:0,y1:0,y2:0}}}])}(),zL=function(t){function e(t,i){var a;r(this,e);var o=t.data,s=OL(t,["data"]);return(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:Object.assign({data:o},ft({},e.defaultAttributes,s))])).name="arc-label",a._ellipsisWidth=0,a._arcLeft=new Map,a._arcRight=new Map,a._line2MinLength=0,a._alignOffset=0,a}return h(e,t),o(e,[{key:"_overlapping",value:function(t){return["inside","inside-center"].includes(this.attribute.position)?y(e,"_overlapping",this,3)([t]):t}},{key:"labeling",value:function(t,e){if(t&&e)return{x:0,y:0}}},{key:"_layout",value:function(t){var i,n,r,a=this;if(t&&t.length){var o=y(e,"_layout",this,3)([t]),s=o.map((function(t){return a.getGraphicBounds(t)})),l=Object.assign(Object.assign({},this.attribute.textStyle),{text:"…"}),u=1/0;if(!1!==l.ellipsis){var c=this._createLabelText(l),h=this.getGraphicBounds(c);u=h.x2-h.x1}var d=o.map((function(t){return t.attribute})),p=Array.from(this._idToGraphic.values());this._line2MinLength=H(this.attribute.line.line2MinLength)?this.attribute.line.line2MinLength(t,p,this.attribute):this.attribute.line.line2MinLength,this._alignOffset=null!==(i=H(this.attribute.layout.alignOffset)?this.attribute.layout.alignOffset(t,p,this.attribute):this.attribute.layout.alignOffset)&&void 0!==i?i:0;for(var f=this.layoutArcLabels(this.attribute.position,this.attribute,p,d,s,u),v=function(){var t=d[g],e=f.find((function(e){var i;return(null===(i=e.refDatum)||void 0===i?void 0:i.id)===t.id}));if(e){var i={visible:e.labelVisible,x:e.labelPosition.x,y:e.labelPosition.y,angle:e.angle,points:e.pointA&&e.pointB&&e.pointC?[e.pointA,e.pointB,e.pointC]:void 0,line:e.labelLine};"richtext"===o[g].type?i.width=null!==(n=e.labelLimit)&&void 0!==n?n:o[g].attribute.width:i.maxLineWidth=null!==(r=e.labelLimit)&&void 0!==r?r:o[g].attribute.maxLineWidth,e.refArc&&"arc3d"===e.refArc.type&&(i.anchor3d=[e.circleCenter.x-i.x,e.circleCenter.y-i.y],i.beta=e.refArc.attribute.beta),o[g].setAttributes(i)}},g=0;g<d.length;g++)v();return o}}},{key:"layoutArcLabels",value:function(t,e,i,n,r,a){var o=this;this._arcLeft.clear(),this._arcRight.clear(),this._ellipsisWidth=a;var s=0;i.forEach((function(t){t.attribute.outerRadius>s&&(s=t.attribute.outerRadius)})),n.forEach((function(t,i){var a,l,u,c=o._idToGraphic.get(t.id),h=c.attribute,d={x:null!==(a=null==h?void 0:h.x)&&void 0!==a?a:0,y:null!==(l=null==h?void 0:h.y)&&void 0!==l?l:0};if(!j(n[i])&&!j(r[i])){var p=n[i]?n[i]:null,f=r[i]?r[i]:{x1:0,x2:0,y1:0,y2:0},v=(h.startAngle+h.endAngle)/2,g=h.endAngle-h.startAngle,y=De(h.endAngle-g/2),m=Pe(d,h.outerRadius,v),_=Pe(d,s+e.line.line1MinLength,v),b=new FL(p,m,_,y,g,v,h.innerRadius,h.outerRadius,d);b.refArc=c,b.pointA=Pe(d,o.computeDatumRadius(2*d.x,2*d.y,h.outerRadius),b.middleAngle),b.labelSize={width:f.x2-f.x1,height:f.y2-f.y1},1===(u=b.quadrant)||2===u?o._arcRight.set(b.refDatum,b):yL(b.quadrant)&&o._arcLeft.set(b.refDatum,b)}}));var l=Array.from(this._arcLeft.values()),u=Array.from(this._arcRight.values()),c=[];switch(t){case"inside":case"inside-inner":case"inside-outer":case"inside-center":c.push.apply(c,m(this._layoutInsideLabels(u,e,i))),c.push.apply(c,m(this._layoutInsideLabels(l,e,i)));break;default:c.push.apply(c,m(this._layoutOutsideLabels(u,e,i))),c.push.apply(c,m(this._layoutOutsideLabels(l,e,i)))}return c}},{key:"_layoutInsideLabels",value:function(t,e,i){var n,r,a=this,o=e,s=o.spaceWidth,l=null!==(n=o.position)&&void 0!==n?n:"inside",u=null!==(r=o.offsetRadius)&&void 0!==r?r:-s;return t.forEach((function(t){var i,n,r,c,h=t.labelSize,d=t.radian,p=t.innerRadius,f=t.outerRadius;d<function(t,e){return e>2*t?NaN:2*Math.asin(e/2/t)}(f,h.height)?c=0:c=f-(d>=Math.PI?p:Math.max(p,h.height/2/Math.tan(d/2)))-s;!0!==o.rotate&&(c=f-s);var v=a._getFormatLabelText(t.refDatum,c);t.labelText=v;var g,y=Math.min(c,t.labelSize.width),m=a._computeAlign(t,e),_=0;if("inside"===l&&(_="left"===m?y:"right"===m?0:y/2),g="inside-inner"===l?p-u+_:"inside-center"===l?p+(f-p)/2:f+u-_,t.labelPosition=Pe(t.circleCenter,g,t.middleAngle),t.labelLimit=y,Vt(y,0)||(t.labelVisible=!1),!1!==o.rotate){t.angle=null!==(n=null===(i=e.textStyle)||void 0===i?void 0:i.angle)&&void 0!==n?n:t.middleAngle;var b=null!==(r=o.offsetAngle)&&void 0!==r?r:0;["inside-inner","inside-outer"].includes(l)&&(b+=Math.PI/2),t.angle+=b}})),t}},{key:"_layoutOutsideLabels",value:function(t,e,i){var n,r,a,o=this,l=null!==(n=i[0].attribute.x)&&void 0!==n?n:0,u=2*(null!==(r=i[0].attribute.y)&&void 0!==r?r:0),c=e.layout,h=e.spaceWidth;if(t.forEach((function(t){var e=yL(t.quadrant)?-1:1;t.labelPosition={x:t.outerCenter.x+e*(t.labelSize.width/2+o._line2MinLength+h),y:t.outerCenter.y}})),t.sort((function(t,e){return t.labelPosition.y-e.labelPosition.y})),!1!==e.coverEnable||"none"===c.strategy){var d,p=s(t);try{for(p.s();!(d=p.n()).done;){var f=d.value,v=f.labelPosition,g=f.labelSize;f.labelLimit=g.width,f.pointB=yL(f.quadrant)?{x:v.x+g.width/2+this._line2MinLength+h,y:v.y}:{x:v.x-g.width/2-this._line2MinLength-h,y:v.y},this._computeX(f,e,i)}}catch(t){p.e(t)}finally{p.f()}!1===e.coverEnable&&"none"===c.strategy&&this._coverLabels(t)}else{var y=u/((null===(a=e.textStyle)||void 0===a?void 0:a.fontSize)||16);this._adjustY(t,y,e,i);var m,_=t.reduce((function(t,e){var i=e.getLabelBounds(),n=i.y1,r=i.y2;return t.minY=Math.max(0,Math.min(n,t.minY)),t.maxY=Math.min(u,Math.max(r,t.maxY)),t}),{minY:1/0,maxY:-1/0}),b=_.minY,x=_.maxY,k=Math.max(Math.abs(u/2-b),Math.abs(x-u/2)),S=this._computeLayoutRadius(k,e,i),A=s(t);try{for(A.s();!(m=A.n()).done;){var M=m.value;this._computePointB(M,S,e,i),this._computeX(M,e,i)}}catch(t){A.e(t)}finally{A.f()}}var w=2*l;return t.forEach((function(t){var i,n;t.labelVisible&&(Wt(t.pointB.x,o._line2MinLength+h)||Vt(t.pointB.x,w-o._line2MinLength-h))&&(t.labelVisible=!1),t.angle=null!==(n=null===(i=e.textStyle)||void 0===i?void 0:i.angle)&&void 0!==n?n:0,e.offsetAngle&&(t.angle+=e.offsetAngle),t.labelLine=Object.assign(Object.assign({},e.line),{visible:t.labelVisible})})),t}},{key:"_computeX",value:function(t,e,i){var n,r=t.circleCenter,a=this.attribute.width;this.attribute.height;var o=0;i.forEach((function(t){t.attribute.outerRadius>o&&(o=t.attribute.outerRadius)}));var s=this.computeLayoutOuterRadius(o,e.width,e.height),l=e.line.line1MinLength,u=null===(n=e.layout)||void 0===n?void 0:n.align,c=e.spaceWidth,h=t.labelPosition,d=t.quadrant,p=t.pointB;Q(p.x*p.y)||(t.pointC={x:NaN,y:NaN},h.x=NaN,t.labelLimit=0);var f=this.computeRadius(s,e.width,e.height),v=yL(d)?-1:1,g=0,y=(v>0?a-p.x:p.x-0)+this._alignOffset-this._line2MinLength-c;"labelLine"===u&&(g=(f+l+this._line2MinLength)*v+r.x,y=(v>0?a-g:g-0)-c);var m=this._getFormatLabelText(t.refDatum,y);t.labelText=m;var _=Math.min(y,t.labelSize.width);switch(u){case"labelLine":break;case"edge":g=v>0?a-_-c:0+_+c;break;default:g=p.x+v*this._line2MinLength}var b=(_=Math.max(this._ellipsisWidth,_))<t.labelSize.width-1;t.labelLimit=b?_:null,t.pointC={x:g,y:h.y};var x=function(t){return"left"===t?0:"right"===t?1:.5}(this._computeAlign(t,e))*(b?_:t.labelSize.width);"edge"===u?(h.x=(v>0?a:0)-v*x+v*this._alignOffset,t.pointC.x+=v*this._alignOffset):h.x=g+v*(this._alignOffset+c+x)}},{key:"_computeAlign",value:function(t,e){var i,n,r,a,o,s,l=e,u=null!==(n=null===(i=l.textStyle)||void 0===i?void 0:i.textAlign)&&void 0!==n?n:null===(r=l.textStyle)||void 0===r?void 0:r.align,c=null!==(o=null===(a=l.layout)||void 0===a?void 0:a.textAlign)&&void 0!==o?o:null===(s=l.layout)||void 0===s?void 0:s.align;return"inside"!==l.position?j(u)||"auto"===u?"edge"===c?yL(t.quadrant)?"left":"right":yL(t.quadrant)?"right":"left":u:j(u)||"auto"===u?"center":u}},{key:"_getFormatLabelText",value:function(t,e){var i;return null!==(i=null==t?void 0:t.text)&&void 0!==i?i:""}},{key:"_adjustY",value:function(t,e,i,n){var r;n[0].attribute.x;var a=2*(null!==(r=n[0].attribute.y)&&void 0!==r?r:0),o=i.layout;if("vertical"===o.strategy){var s,l=0,u=t.length;if(u<=0)return;for(var c=0;c<u;c++){if(Wt(s=t[c].getLabelBounds().y1-l,0)){var h=this._shiftY(t,c,u-1,-s);this._shiftY(t,h,0,s/2)}l=t[c].getLabelBounds().y2}Wt(s=t[0].getLabelBounds().y1-0,0)&&this._shiftY(t,0,u-1,-s);for(var d=t.length-1;d>=0&&t[d].getLabelBounds().y2>a;d--)t[d].labelVisible=!1}else if("none"!==o.strategy){var p=t.map((function(t,e){return{arc:t,originIndex:e,priorityIndex:0}}));p.sort((function(t,e){return e.arc.radian-t.arc.radian})),p.forEach((function(t,e){t.priorityIndex=e,t.arc.labelVisible=!1}));for(var f=1/0,v=-1/0,g=0;g<e&&g<t.length;g++){this._storeY(t);var y=p[g].arc;this._computeYRange(y,i,n),y.labelVisible=!0;var m=y.labelPosition.y,_=this._findNeighborIndex(t,p[g]),b=_.lastIndex,x=_.nextIndex,k=t[b],S=t[x];if(-1===b&&-1!==x){var A=S.labelPosition.y;m>A?y.labelPosition.y=A-S.labelSize.height/2-y.labelSize.height/2:this._twoWayShift(t,y,S,x)}else if(-1!==b&&-1===x){var M=k.labelPosition.y;m<M?y.labelPosition.y=M+k.labelSize.height/2+y.labelSize.height/2:this._twoWayShift(t,k,y,p[g].originIndex)}else if(-1!==b&&-1!==x){var w=k.labelPosition.y,T=S.labelPosition.y;m>T?(y.labelPosition.y=T-S.labelSize.height/2-y.labelSize.height/2,this._twoWayShift(t,k,y,p[g].originIndex)):m<w?(y.labelPosition.y=w+k.labelSize.height/2+y.labelSize.height/2,this._twoWayShift(t,y,S,x)):(this._twoWayShift(t,k,y,p[g].originIndex),this._twoWayShift(t,y,S,x))}var C=Math.min(f,p[g].originIndex),E=Math.max(v,p[g].originIndex),P=void 0;if(Vt(P=t[E].getLabelBounds().y2-a,0)&&this._shiftY(t,E,0,-P),Wt(P=t[C].getLabelBounds().y1-0,0)&&this._shiftY(t,C,t.length-1,-P),Vt(P=t[E].getLabelBounds().y2-a,0)){y.labelVisible=!1,this._restoreY(t);break}o.tangentConstraint&&!this._checkYRange(t)?(y.labelVisible=!1,this._restoreY(t)):(f=C,v=E)}}}},{key:"_shiftY",value:function(t,e,i,n){for(var r=e<i?1:-1,a=e;-1!==a;){t[a].labelPosition.y+=n;var o=this._findNextVisibleIndex(t,a,i,r);if(o>=0&&o<t.length){var s=t[a].getLabelBounds(),l=s.y1,u=s.y2,c=t[o].getLabelBounds(),h=c.y1,d=c.y2;if(r>0&&u<h||r<0&&l>d)return a}a=o}return i}},{key:"_findNextVisibleIndex",value:function(t,e,i,n){for(var r=(i-e)*n,a=1;a<=r;a++){var o=e+a*n;if(t[o].labelVisible)return o}return-1}},{key:"_computePointB",value:function(t,e,i,n){var r=i,a=0;n.forEach((function(t){t.attribute.outerRadius>a&&(a=t.attribute.outerRadius)}));var o=this.computeLayoutOuterRadius(a,i.width,i.height),s=r.line.line1MinLength;if("none"===r.layout.strategy)t.pointB={x:t.outerCenter.x,y:t.outerCenter.y};else{var l=t.circleCenter,u=this.computeRadius(o,i.width,i.height),c=t.labelPosition,h=t.quadrant,d=e-Math.max(u+s,t.outerRadius),p=Math.sqrt(Math.pow(e,2)-Math.pow(Math.abs(l.y-c.y),2))-d;Q(p)?t.pointB={x:l.x+p*(yL(h)?-1:1),y:c.y}:t.pointB={x:NaN,y:NaN}}}},{key:"_storeY",value:function(t){var e,i=s(t);try{for(i.s();!(e=i.n()).done;){var n=e.value;n.labelVisible&&(n.lastLabelY=n.labelPosition.y)}}catch(t){i.e(t)}finally{i.f()}}},{key:"_computeYRange",value:function(t,e,i){var n=t.circleCenter,r={width:2*n.x,height:2*n.y},a=0;i.forEach((function(t){t.attribute.outerRadius>a&&(a=t.attribute.outerRadius)}));var o,s,l,u=this.computeLayoutOuterRadius(a,e.width,e.height),c=e.line.line1MinLength,h=r.width,d=r.height,p=this.computeRadius(u,e.width,e.height),f=this._computeLayoutRadius(d/2,e,i),v=Math.abs(t.center.x-h/2),g=t.center.y-d/2;if(Nt(h/2,v))o=0,s=1,l=-g;else if(Nt(d/2,g))o=1,s=0,l=-v;else{var y=-1/(g/v);o=y,s=-1,l=g-y*v}var m,_,b=function(t,e,i,n,r,a){if(0===t&&0===e||a<=0)return[];if(0===t){var o=-i/e,s=Math.pow(a,2)-Math.pow(o-r,2);return s<0?[]:0===s?[{x:n,y:o}]:[{x:Math.sqrt(s)+n,y:o},{x:-Math.sqrt(s)+n,y:o}]}if(0===e){var l=-i/t,u=Math.pow(a,2)-Math.pow(l-n,2);return u<0?[]:0===u?[{x:l,y:r}]:[{x:l,y:Math.sqrt(u)+r},{x:l,y:-Math.sqrt(u)+r}]}var c=Math.pow(e/t,2)+1,h=2*((i/t+n)*(e/t)-r),d=Math.pow(h,2)-4*c*(Math.pow(i/t+n,2)+Math.pow(r,2)-Math.pow(a,2));if(d<0)return[];var p=(-h+Math.sqrt(d))/(2*c),f=(-h-Math.sqrt(d))/(2*c),v=-(e*p+i)/t;return 0===d?[{x:v,y:p}]:[{x:v,y:p},{x:-(e*f+i)/t,y:f}]}(o,s,l,c+p-f,0,f);b.length<2||(b[0].x>b[1].x&&b.reverse(),b[0].x<0?Nt(b[0].y,b[1].y)?Vt(t.middleAngle,-Math.PI)&&Wt(t.middleAngle,0)||Vt(t.middleAngle,Math.PI)&&Wt(t.middleAngle,2*Math.PI)?(m=0,_=b[1].y+d/2):(m=b[1].y+d/2,_=d):b[0].y<b[1].y?(m=0,_=b[1].y+d/2):(m=b[1].y+d/2,_=r.height):(m=Math.min(b[0].y,b[1].y)+d/2,_=Math.max(b[0].y,b[1].y)+d/2),t.labelYRange=[m,_])}},{key:"_computeLayoutRadius",value:function(t,e,i){var n=e,r=n.layoutArcGap,a=n.line.line1MinLength,o=0;i.forEach((function(t){t.attribute.outerRadius>o&&(o=t.attribute.outerRadius)}));var s=this.computeLayoutOuterRadius(o,e.width,e.height),l=this.computeRadius(s,e.width,e.height)+a,u=l-r;return Math.max((Math.pow(u,2)+Math.pow(t,2))/(2*u),l)}},{key:"_findNeighborIndex",value:function(t,e){for(var i=e.originIndex,n=-1,r=-1,a=i-1;a>=0;a--)if(t[a].labelVisible){n=a;break}for(var o=i+1;o<t.length;o++)if(t[o].labelVisible){r=o;break}return{lastIndex:n,nextIndex:r}}},{key:"_twoWayShift",value:function(t,e,i,n){var r=i.getLabelBounds().y1-e.getLabelBounds().y2;if(Wt(r,0)){var a=this._shiftY(t,n,t.length-1,-r);this._shiftY(t,a,0,r/2)}}},{key:"_restoreY",value:function(t){var e,i=s(t);try{for(i.s();!(e=i.n()).done;){var n=e.value;n.labelVisible&&(n.labelPosition.y=n.lastLabelY)}}catch(t){i.e(t)}finally{i.f()}}},{key:"_checkYRange",value:function(t){var e,i=s(t);try{for(i.s();!(e=i.n()).done;){var n=e.value,r=n.labelYRange,a=n.labelPosition;if(n.labelVisible&&r&&(Wt(a.y,r[0])||Vt(a.y,r[1])))return!1}}catch(t){i.e(t)}finally{i.f()}return!0}},{key:"_coverLabels",value:function(t){if(!(t.length<=1))for(var e,i,n,r,a,o,s,l,u,c,h=t[0].getLabelBounds(),d=1;d<t.length;d++){var p=t[d].getLabelBounds();i=p,n=void 0,r=void 0,a=void 0,o=void 0,s=void 0,l=void 0,u=void 0,c=void 0,n=(e=h).x1,r=e.y1,a=e.x2,o=e.y2,s=i.x1,l=i.y1,u=i.x2,c=i.y2,n<=s&&a<=s||n>=u&&a>=u||r<=l&&o<=l||r>=c&&o>=c?h=p:t[d].labelVisible=!1}}},{key:"_getLabelLinePoints",value:function(t,e){return t.attribute.points}},{key:"_createLabelLine",value:function(t,i){var n,r,a,o,s,l=t.attribute,u=l.line,c=void 0===u?{}:u,h=l.visible,d=y(e,"_createLabelLine",this,3)([t,i]);if(d&&(d.setAttributes({visible:null===(a=null!==(n=c.visible&&h)&&void 0!==n?n:null===(r=t.attribute)||void 0===r?void 0:r.visible)||void 0===a||a,lineWidth:null!==(s=null===(o=c.style)||void 0===o?void 0:o.lineWidth)&&void 0!==s?s:1}),c.smooth&&d.setAttributes({curveType:"basis"}),"arc3d"===i.type&&i)){var p=i.attribute,f=p.beta,v=p.x,g=p.y;d.setAttributes({beta:f,anchor3d:[v,g]})}return d}},{key:"computeRadius",value:function(t,e,i,n){return this.computeLayoutRadius(e||0,i||0)*t*(j(n)?1:n)}},{key:"computeLayoutRadius",value:function(t,e){return Math.min(t/2,e/2)}},{key:"_canPlaceInside",value:function(t,e){return"inside"===this.attribute.position||"inside-center"===this.attribute.position}},{key:"computeLayoutOuterRadius",value:function(t,e,i){return t/(Math.min(e,i)/2)}},{key:"computeDatumRadius",value:function(t,e,i){var n=this.computeLayoutOuterRadius(i,t,e);return this.computeLayoutRadius(t||0,e||0)*n}}])}(AL);zL.defaultAttributes={coverEnable:!1,spaceWidth:5,layoutArcGap:6,textStyle:{visible:!0,fontSize:14,fontWeight:"normal",fillOpacity:1,boundsPadding:[-1,0,-1,0],ellipsis:!0},position:"outside",line:{visible:!0,line1MinLength:20,line2MinLength:10},layout:{align:"arc",strategy:"priority",tangentConstraint:!0}};var HL=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i},jL=function(t){function e(t,i){var a;r(this,e);var o=t.dataLabels,s=HL(t,["dataLabels"]);return(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:Object.assign({dataLabels:o},ft({},e.defaultAttributes,s))])).name="data-label",a}return h(e,t),o(e,[{key:"render",value:function(){var t,e=this,i=this.attribute,n=i.dataLabels,r=i.size;if(n&&0!==n.length){var a=r||{},o=a.width,s=void 0===o?0:o,l=a.height,u=void 0===l?0:l,c=a.padding;if(s&&u&&Q(u*s)){this._componentMap||(this._componentMap=new Map);for(var h=nL(s,u,c),d=h.bitmap(),p=new Map,f=this._componentMap,v=0;v<n.length;v++){var g=n[v],y=TL(g.type)||AL;if(y){var m=g.baseMarkGroupName,_=g.type,b=null!==(t=g.id)&&void 0!==t?t:"".concat(m,"-").concat(_,"-").concat(v);"arc"===g.type&&(g.width=r.width,g.height=r.height);var x=this._componentMap.get(b);x?(x.setBitmapTool(h),x.setBitmap(d),x.setAttributes(g),p.set(b,x)):((x=new y(g)).setBitmap(d),x.setBitmapTool(h),this.add(x),p.set(b,x))}}f.forEach((function(t,i){p.get(i)||e.removeChild(t)})),this._componentMap=p}}}},{key:"setLocation",value:function(t){this.translateTo(t.x,t.y)}},{key:"disableAnimation",value:function(){this._componentMap.forEach((function(t){t.disableAnimation()}))}},{key:"enableAnimation",value:function(){this._componentMap.forEach((function(t){t.enableAnimation()}))}}])}(yS);function NL(t,e,i,n){var r="";if(!t||0===e.length)return r;var a=e[0],o=Me.distancePP(t,a),s=i?0:1;return n?r+="M".concat(t.x,",").concat(t.y-o,"A").concat(o,",").concat(o,",0,0,").concat(s,",").concat(t.x,",").concat(t.y+o,"A").concat(o,",").concat(o,",0,0,").concat(s,",").concat(t.x,",").concat(t.y-o,"Z"):e.forEach((function(t,e){0===e?r="M".concat(t.x,",").concat(t.y):r+="A".concat(o,",").concat(o,",0,0,").concat(s,",").concat(t.x,",").concat(t.y)})),r}function VL(t,e,i){var n=i.type,r=i.closed,a=e.slice(0).reverse(),o="",s="";if("line"===n&&i.smoothLink&&i.center){var l=t[0],u=a[0],c=i.center;o=sB(t,!!r),s=sB(a,!!r);var h=Me.distancePP(u,c),d=Me.distancePP(l,c);o+="A".concat(h,",").concat(h,",0,0,1,").concat(u.x,",").concat(u.y,"L").concat(u.x,",").concat(u.y),s+="A".concat(d,",").concat(d,",0,0,0,").concat(l.x,",").concat(l.y)}else if("circle"===n){var p=i.center;o=NL(p,t,!1,!!r),s=NL(p,a,!0,!!r)}else"line"!==n&&"polygon"!==n||(o=sB(t,!!r),s=sB(a,!!r));return r?o+=s:(o+=s="L"+s.substring(1),o+="Z"),o}jL.defaultAttributes={pickable:!1};var WL=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).name="axis-grid",t.data=[],t}return h(e,t),o(e,[{key:"getInnerView",value:function(){return this._innerView}},{key:"getPrevInnerView",value:function(){return this._prevInnerView}},{key:"render",value:function(){this._prevInnerView=this._innerView&&nB(this._innerView),this.removeAllChild(!0),this._innerView=By.group({x:0,y:0,pickable:!1}),this.add(this._innerView);var t=this.attribute,e=t.items,i=t.visible;e&&e.length&&!1!==i&&(this.data=this._transformItems(e),this._renderGrid(this._innerView))}},{key:"getVerticalCoord",value:function(t,e,i){return rB(t,this.getVerticalVector(e,i,t))}},{key:"_transformItems",value:function(t){var e=this,i=[];return t.forEach((function(t){var n;i.push(Object.assign(Object.assign({},t),{point:e.getTickCoord(t.value),id:null!==(n=t.id)&&void 0!==n?n:t.label}))})),i}},{key:"_renderGrid",value:function(t){(this.attribute.subGrid||{}).visible&&this._renderGridByType(!0,t),this._renderGridByType(!1,t)}},{key:"_renderGridByType",value:function(t,i){var n=this,r=ft({},this.attribute,this.getGridAttribute(t)),a=r.type,o=r.items,s=r.style,l=r.closed,u=r.alternateColor,c=r.depth,h=void 0===c?0:c,d=t?"".concat(XR.grid,"-sub"):"".concat(XR.grid);if(o.forEach((function(t,r){var o=t.id,u=t.points,c="";if("line"===a||"polygon"===a)c=sB(u,!!l);else if("circle"===a){c=NL(n.attribute.center,u,!1,!!l)}var p=By.path(Object.assign({path:c,z:h},H(s)?ft({},n.skipDefault?null:e.defaultAttributes.style,s(t,r)):s));p.name="".concat(d,"-line"),p.id=n._getNodeId("".concat(d,"-path-").concat(o)),i.add(p)})),h&&"line"===a&&o.forEach((function(t,r){var a=t.id,o=t.points,u=[];u.push(o[0]);var c=o[1].x-o[0].x,p=o[1].y-o[0].y,f=Math.sqrt(c*c+p*p),v=h/f;u.push({x:o[0].x+c*v,y:o[0].y+p*v});var g=sB(u,!!l),y=le(u[0].x-u[1].x),m=le(u[0].y-u[1].y),_=By.path(Object.assign({path:g,z:0,alpha:y>m?(o[1].x-o[0].x>0?-1:1)*re/2:0,beta:y<m?-re/2:0,anchor3d:y>m?[u[0].x,0]:[0,u[0].y]},H(s)?ft({},n.skipDefault?null:e.defaultAttributes.style,s(t,r)):s));_.name="".concat(d,"-line"),_.id=n._getNodeId("".concat(d,"-path-").concat(a)),i.add(_)})),o.length>1&&u){var p=X(u)?u:[u,"transparent"],f=function(t){return p[t%p.length]},v=this.attribute.items,g=v[0],y=v[v.length-1],m=!Nt(g.value,0)&&!Nt(y.value,0),_=!Nt(g.value,1)&&!Nt(y.value,1),b=[],x=g.value>y.value;(x&&_||!x&&m)&&b.push(this.getGridPointsByValue(x?1:0)),o.forEach((function(t){b.push(t.points)})),(x&&m||!x&&_)&&b.push(this.getGridPointsByValue(x?0:1));for(var k=0;k<b.length-1;k++){var S=VL(b[k],b[k+1],r),A=By.path({path:S,fill:f(k)});A.name="".concat(d,"-region"),A.id=this._getNodeId("".concat(d,"-region-").concat(k)),i.add(A)}}}},{key:"_getNodeId",value:function(t){return"".concat(this.id,"-").concat(t)}},{key:"_parseTickSegment",value:function(){var t=1;return this.data.length>=2&&(t=this.data[1].value-this.data[0].value),t}},{key:"_getPointsOfSubGrid",value:function(t,e){var i=this,n=this.data.length,r=[];return n>=2&&this.data.forEach((function(n){var a=n.value;if(!e){var o=n.value-t/2;if(i.isInValidValue(o))return;a=o}r.push({value:a})})),r}},{key:"release",value:function(){y(e,"release",this,3)([]),this._prevInnerView=null,this._innerView=null}}])}(yS);WL.defaultAttributes={style:{lineWidth:1,stroke:"#999",strokeOpacity:1,lineDash:[4,4]},subGrid:{visible:!1,style:{lineWidth:1,stroke:"#999",strokeOpacity:1,lineDash:[4,4]}}},cP(),gP();var GL=function(t){function e(t,i){return r(this,e),n(this,e,[(null==i?void 0:i.skipDefault)?t:ft({},WL.defaultAttributes,t),i])}return h(e,t),o(e,[{key:"_getGridPoint",value:function(t,e){var i;if("line"===t){var n=this.attribute.length;i=[e,this.getVerticalCoord(e,n,!0)]}else if("circle"===t||"polygon"===t){var r=this.attribute,a=r.center,o=r.sides,s=void 0===o?6:o,l=r.startAngle,u=void 0===l?OP:l,c=r.endAngle,h=void 0===c?FP:c;i=oB(a,s,Me.distancePP(a,e),u,h)}return i}},{key:"getGridPointsByValue",value:function(t){var e=this.getTickCoord(t);return this._getGridPoint(this.attribute.type,e)}},{key:"getGridAttribute",value:function(t){var e,i=this,n=this.attribute,r=n.type,a=n.alignWithLabel,o=void 0===a||a,s=this._parseTickSegment(),l=[];if(t){var u=[],c=(e=ft({},this.attribute,this.attribute.subGrid)).count,h=void 0===c?4:c;if(this.data.length>=2){for(var d=this._getPointsOfSubGrid(s,o),p=0;p<d.length-1;p++){var f=d[p],v=d[p+1];u.push({id:"sub-".concat(p,"-0"),points:this.getGridPointsByValue(f.value),datum:{}});for(var g=0;g<h;g++){var y=(g+1)/(h+1),m=(1-y)*f.value+y*v.value;u.push({id:"sub-".concat(p,"-").concat(g+1),points:this.getGridPointsByValue(m),datum:{}})}p===d.length-2&&u.push({id:"sub-".concat(p,"-").concat(h+1),points:this.getGridPointsByValue(v.value),datum:{}})}l=u}}else{e=this.attribute;var _=[];this.data.forEach((function(t){var e=t.point;if(!o){var n=t.value-s/2;if(i.isInValidValue(n))return;e=i.getTickCoord(n)}_.push({id:t.label,datum:t,points:i._getGridPoint(r,e)})})),l=_}return Object.assign(Object.assign({},e),{items:l})}}])}(WL);bt(GL,AB);var UL=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i};cP(),gP();var YL=function(t){function e(t,i){return r(this,e),n(this,e,[(null==i?void 0:i.skipDefault)?t:ft({},WL.defaultAttributes,t),i])}return h(e,t),o(e,[{key:"getGridPointsByValue",value:function(t){var e=this.getTickCoord(t),i=this.attribute,n=i.radius,r=i.innerRadius,a=void 0===r?0:r;return[e,this.getVerticalCoord(e,n-a,!0)]}},{key:"getGridAttribute",value:function(t){var e,i=this,n=[],r=this.attribute,a=r.radius,o=r.innerRadius,s=void 0===o?0:o,l=r.startAngle,u=void 0===l?OP:l,c=r.endAngle,h=void 0===c?FP:c,d=r.center,p=r.subGrid,f=UL(r,["radius","innerRadius","startAngle","endAngle","center","subGrid"]),v=(f||{}).alignWithLabel,g=void 0===v||v,y=a-s,_=this._parseTickSegment();if(t){e=ft({},f,p);var b=[],x=(p||{}).count,k=void 0===x?4:x,S=this.data.length;if(S>=2){for(var A=this._getPointsOfSubGrid(_,g),M=0;M<S;M++){var w=A[M],T=A[M+1];b.push({id:"sub-".concat(M,"-0"),points:[this.getTickCoord(w.value),this.getVerticalCoord(this.getTickCoord(w.value),y,!0)],datum:{}});for(var C=0;C<k;C++){var E=(C+1)/(k+1),P=(1-E)*w.value+E*(T?T.value:g?1:w.value+_),R=this.getTickCoord(P),B=this.getVerticalCoord(R,y,!0);b.push({id:"sub-".concat(M,"-").concat(C+1),points:[R,B],datum:{}})}}Math.abs(h-u)%(2*Math.PI)==0&&b.push(b[0]),n=b}}else{e=f;var I=[];(Math.abs(h-u)%(2*Math.PI)==0?m(this.data).concat(this.data[0]):this.data).forEach((function(t){var e=t.point;if(!g){var n=t.value-_/2;if(i.isInValidValue(n))return;e=i.getTickCoord(n)}var r=i.getVerticalCoord(e,y,!0);I.push({id:t.id,points:[e,r],datum:t})})),n=I}return Object.assign(Object.assign({},e),{items:n,center:d,type:"line"})}}])}(WL);bt(YL,CB);var XL,KL="M -0.0544 0.25 C -0.0742 0.25 -0.0901 0.234 -0.0901 0.2143 L -0.0901 -0.1786 C -0.0901 -0.1983 -0.0742 -0.2143 -0.0544 -0.2143 L -0.0187 -0.2143 L -0.0187 -0.5 L 0.017 -0.5 L 0.017 -0.2143 L 0.0527 -0.2143 C 0.0724 -0.2143 0.0884 -0.1983 0.0884 -0.1786 L 0.0884 0.2143 C 0.0884 0.234 0.0724 0.25 0.0527 0.25 L 0.017 0.25 L 0.017 0.5 L -0.0187 0.5 L -0.0187 0.25 L -0.0544 0.25 Z M -0.0187 -0.1429 L -0.0544 -0.1429 L -0.0544 0.1786 L -0.0187 0.1786 L -0.0187 -0.1429 Z M 0.0527 -0.1429 L 0.017 -0.1429 L 0.017 0.1786 L 0.0527 0.1786 L 0.0527 -0.1429 Z",qL={orient:"bottom",showDetail:"auto",brushSelect:!0,zoomLock:!1,minSpan:0,maxSpan:1,delayType:"throttle",delayTime:0,realTime:!0,backgroundStyle:{fill:"white",stroke:"#D1DBEE",lineWidth:1,cornerRadius:2},dragMaskStyle:{fill:"#B0C8F9",fillOpacity:.2},backgroundChartStyle:{area:{visible:!0,stroke:"#D1DBEE",lineWidth:1,fill:"#F6F8FC"},line:{visible:!0,stroke:"#D1DBEE",lineWidth:1}},selectedBackgroundStyle:{fill:"#B0C8F9",fillOpacity:.5},selectedBackgroundChartStyle:{area:{visible:!0,stroke:"#B0C8F9",lineWidth:1,fill:"#fbb934"},line:{visible:!0,stroke:"#fbb934",lineWidth:1}},middleHandlerStyle:{visible:!0,background:{size:8,style:{fill:"white",stroke:"#B0C8F9",cornerRadius:2}},icon:{size:6,fill:"white",stroke:"#B0C8F9",symbolType:"M 0.3 -0.5 C 0.41 -0.5 0.5 -0.41 0.5 -0.3 C 0.5 -0.3 0.5 0.3 0.5 0.3 C 0.5 0.41 0.41 0.5 0.3 0.5 C 0.3 0.5 -0.3 0.5 -0.3 0.5 C -0.41 0.5 -0.5 0.41 -0.5 0.3 C -0.5 0.3 -0.5 -0.3 -0.5 -0.3 C -0.5 -0.41 -0.41 -0.5 -0.3 -0.5 C -0.3 -0.5 0.3 -0.5 0.3 -0.5 Z",lineWidth:.5}},startHandlerStyle:{visible:!0,triggerMinSize:0,symbolType:KL,fill:"white",stroke:"#B0C8F9",lineWidth:.5},endHandlerStyle:{visible:!0,triggerMinSize:0,symbolType:KL,fill:"white",stroke:"#B0C8F9",lineWidth:.5},startTextStyle:{padding:4,textStyle:{fontSize:10,fill:"#6F6F6F"}},endTextStyle:{padding:4,textStyle:{fontSize:10,fill:"#6F6F6F"}}},ZL={horizontal:{angle:0,strokeBoundsBuffer:0,boundsPadding:2,pickMode:"imprecise",cursor:"ew-resize"},vertical:{angle:Math.PI/180*90,cursor:"ns-resize",boundsPadding:2,pickMode:"imprecise",strokeBoundsBuffer:0}};!function(t){t.startHandler="startHandler",t.endHandler="endHandler",t.middleHandler="middleHandler",t.background="background"}(XL||(XL={}));var JL=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i},QL={debounce:qt,throttle:Zt};mR(),kP(),PP(),rP(),fP();var $L,tD,eD,iD,nD=function(t){function e(t,i){var a;r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:ft({},e.defaultAttributes,t)])).name="dataZoom",a._previewData=[],a._activeState=!1,a._activeCache={startPos:{x:0,y:0},lastPos:{x:0,y:0}},a._layoutCache={attPos:"x",attSize:"width",max:0},a.state={start:0,end:1},a._statePointToData=function(t){return t},a._handleTouchMove=function(t){a._activeState&&t.preventDefault()},a._onHandlerPointerDown=function(t,e){a._clearDragEvents(),"start"===e?(a._activeTag=XL.startHandler,a._activeItem=a._startHandlerMask):"end"===e?(a._activeTag=XL.endHandler,a._activeItem=a._endHandlerMask):"middleRect"===e?(a._activeTag=XL.middleHandler,a._activeItem=a._middleHandlerRect):"middleSymbol"===e?(a._activeTag=XL.middleHandler,a._activeItem=a._middleHandlerSymbol):"background"===e&&(a._activeTag=XL.background,a._activeItem=a._background),a._activeState=!0,a._activeCache.startPos=a.eventPosToStagePos(t),a._activeCache.lastPos=a.eventPosToStagePos(t);var i="browser"===ex.env?ex:a.stage,n=VP();i.addEventListener("pointermove",a._onHandlerPointerMove,{capture:!0}),a.addEventListener("pointermove",a._onHandlerPointerMove,{capture:!0}),n.forEach((function(t){i.addEventListener(t,a._onHandlerPointerUp)}))},a._pointerMove=function(t){var e=a.attribute,i=e.start,n=e.end,r=e.brushSelect,o=e.realTime,s=void 0===o||o,l=a.eventPosToStagePos(t),u=a._layoutCache,c=u.attPos,h=u.max,d=(l[c]-a._activeCache.lastPos[c])/h,p=a.state,f=p.start,v=p.end;a._activeState&&(a._activeTag===XL.middleHandler?a.moveZoomWithMiddle((a.state.start+a.state.end)/2+d):a._activeTag===XL.startHandler?f+d>v?(v=(f=v)+d,a._activeTag=XL.endHandler):f+=d:a._activeTag===XL.endHandler&&(v+d<f?(f=(v=f)+d,a._activeTag=XL.startHandler):v+=d),a._activeCache.lastPos=l,r&&a.renderDragMask()),f=Math.min(Math.max(f,0),1),v=Math.min(Math.max(v,0),1),i===f&&n===v||(a.setStateAttr(f,v,!0),s&&a._dispatchEvent("change",{start:f,end:v,tag:a._activeTag}))},a._onHandlerPointerMove=0===a.attribute.delayTime?a._pointerMove:QL[a.attribute.delayType](a._pointerMove,a.attribute.delayTime),a._onHandlerPointerUp=function(t){var e=a.attribute;e.start,e.end;var i=e.brushSelect;if(e.realTime,a._activeState&&a._activeTag===XL.background){var n=a.eventPosToStagePos(t);a.backgroundDragZoom(a._activeCache.startPos,n)}a._activeState=!1,i&&a.renderDragMask(),a._dispatchEvent("change",{start:a.state.start,end:a.state.end,tag:a._activeTag}),a._clearDragEvents()};var o=t.position,s=t.showDetail;return a._activeCache.startPos=o,a._activeCache.lastPos=o,a._showText="auto"!==s&&s,a.setPropsFromAttrs(),a}return h(e,t),o(e,[{key:"setPropsFromAttrs",value:function(){var t=this.attribute,e=t.start,i=t.end,n=t.orient,r=t.previewData,a=t.previewPointsX,o=t.previewPointsY,s=t.previewPointsX1,l=t.previewPointsY1;e&&(this.state.start=e),i&&(this.state.end=i);var u=this.getLayoutAttrFromConfig(),c=u.width,h=u.height;this._spanCache=this.state.end-this.state.start,this._isHorizontal="top"===n||"bottom"===n,this._layoutCache.max=this._isHorizontal?c:h,this._layoutCache.attPos=this._isHorizontal?"x":"y",this._layoutCache.attSize=this._isHorizontal?"width":"height",r&&(this._previewData=r),H(a)&&(this._previewPointsX=a),H(o)&&(this._previewPointsY=o),H(s)&&(this._previewPointsX1=s),H(l)&&(this._previewPointsY1=l)}},{key:"setAttributes",value:function(t,i){y(e,"setAttributes",this,3)([t,i]),this.setPropsFromAttrs()}},{key:"bindEvents",value:function(){var t=this;if(this.attribute.disableTriggerEvent)this.setAttribute("childrenPickable",!1);else{var e=this.attribute,i=e.showDetail,n=e.brushSelect;this._startHandlerMask&&this._startHandlerMask.addEventListener("pointerdown",(function(e){return t._onHandlerPointerDown(e,"start")})),this._endHandlerMask&&this._endHandlerMask.addEventListener("pointerdown",(function(e){return t._onHandlerPointerDown(e,"end")})),this._middleHandlerSymbol&&this._middleHandlerSymbol.addEventListener("pointerdown",(function(e){return t._onHandlerPointerDown(e,"middleSymbol")})),this._middleHandlerRect&&this._middleHandlerRect.addEventListener("pointerdown",(function(e){return t._onHandlerPointerDown(e,"middleRect")}));var r=n?"background":"middleRect";this._selectedBackground&&this._selectedBackground.addEventListener("pointerdown",(function(e){return t._onHandlerPointerDown(e,r)})),n&&this._background&&this._background.addEventListener("pointerdown",(function(e){return t._onHandlerPointerDown(e,"background")})),n&&this._previewGroup&&this._previewGroup.addEventListener("pointerdown",(function(e){return t._onHandlerPointerDown(e,"background")})),this._selectedPreviewGroup&&this._selectedPreviewGroup.addEventListener("pointerdown",(function(e){return t._onHandlerPointerDown(e,r)})),"auto"===i&&(this.addEventListener("pointerenter",this._onHandlerPointerEnter),this.addEventListener("pointerleave",this._onHandlerPointerLeave)),("browser"===ex.env?ex:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1})}}},{key:"dragMaskSize",value:function(){var t=this.attribute.position,e=this._layoutCache,i=e.attPos,n=e.max;return this._activeCache.lastPos[i]-t[i]>n?n+t[i]-this._activeCache.startPos[i]:this._activeCache.lastPos[i]-t[i]<0?t[i]-this._activeCache.startPos[i]:this._activeCache.lastPos[i]-this._activeCache.startPos[i]}},{key:"setStateAttr",value:function(t,e,i){var n=this.attribute,r=n.zoomLock,a=void 0!==r&&r,o=n.minSpan,s=void 0===o?0:o,l=n.maxSpan,u=void 0===l?1:l,c=e-t;c!==this._spanCache&&(a||c<s||c>u)||(this._spanCache=c,this.state.start=t,this.state.end=e,i&&this.setAttributes({start:t,end:e}))}},{key:"eventPosToStagePos",value:function(t){var e,i;return null!==(i=null===(e=this.stage)||void 0===e?void 0:e.eventPointTransform(t))&&void 0!==i?i:{x:0,y:0}}},{key:"_clearDragEvents",value:function(){var t=this,e="browser"===ex.env?ex:this.stage,i=VP();e.removeEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),i.forEach((function(i){e.removeEventListener(i,t._onHandlerPointerUp)})),this.removeEventListener("pointermove",this._onHandlerPointerMove,{capture:!0})}},{key:"_onHandlerPointerEnter",value:function(t){this._showText=!0,this.renderText()}},{key:"_onHandlerPointerLeave",value:function(t){this._showText=!1,this.renderText()}},{key:"backgroundDragZoom",value:function(t,e){var i=this._layoutCache,n=i.attPos,r=i.max,a=this.attribute.position,o=t[n]-a[n],s=e[n]-a[n],l=Math.min(Math.max(Math.min(o,s)/r,0),1),u=Math.min(Math.max(Math.max(o,s)/r,0),1);Math.abs(l-u)<.01?this.moveZoomWithMiddle(l):this.setStateAttr(l,u,!1)}},{key:"moveZoomWithMiddle",value:function(t){var e=t-(this.state.start+this.state.end)/2;0!==e&&(e>0?this.state.end+e>1&&(e=1-this.state.end):e<0&&this.state.start+e<0&&(e=-this.state.start),this.setStateAttr(this.state.start+e,this.state.end+e,!1))}},{key:"renderDragMask",value:function(){var t=this.attribute.dragMaskStyle,e=this.getLayoutAttrFromConfig(),i=e.position,n=e.width,r=e.height;this._isHorizontal?this._dragMask=this._container.createOrUpdateChild("dragMask",Object.assign({x:Ut(this.dragMaskSize()<0?this._activeCache.lastPos.x:this._activeCache.startPos.x,i.x,i.x+n),y:i.y,width:this._activeState&&this._activeTag===XL.background&&Math.abs(this.dragMaskSize())||0,height:r},t),"rect"):this._dragMask=this._container.createOrUpdateChild("dragMask",Object.assign({x:i.x,y:Ut(this.dragMaskSize()<0?this._activeCache.lastPos.y:this._activeCache.startPos.y,i.y,i.y+r),width:n,height:this._activeState&&this._activeTag===XL.background&&Math.abs(this.dragMaskSize())||0},t),"rect")}},{key:"isTextOverflow",value:function(t,e,i){if(!e)return!1;if(this._isHorizontal){if("start"===i){if(e.x1<t.x1)return!0}else if(e.x2>t.x2)return!0}else if("start"===i){if(e.y1<t.y1)return!0}else if(e.y2>t.y2)return!0;return!1}},{key:"setTextAttr",value:function(t,e){var i,n,r,a,o,s,l,u,c=this.attribute,h=c.startTextStyle,d=c.endTextStyle,p=h.formatMethod,f=JL(h,["formatMethod"]),v=d.formatMethod,g=JL(d,["formatMethod"]),y=this.state,m=y.start,_=y.end;this._startValue=this._statePointToData(m),this._endValue=this._statePointToData(_);var b,x,k,S,A=this.getLayoutAttrFromConfig(),M=A.position,w=A.width,T=A.height,C=p?p(this._startValue):this._startValue,E=v?v(this._endValue):this._endValue,P={x1:M.x,y1:M.y,x2:M.x+w,y2:M.y+T};this._isHorizontal?(b={x:M.x+m*w,y:M.y+T/2},x={x:M.x+_*w,y:M.y+T/2},k={textAlign:this.isTextOverflow(P,t,"start")?"left":"right",textBaseline:null!==(n=null===(i=null==f?void 0:f.textStyle)||void 0===i?void 0:i.textBaseline)&&void 0!==n?n:"middle"},S={textAlign:this.isTextOverflow(P,e,"end")?"right":"left",textBaseline:null!==(a=null===(r=null==g?void 0:g.textStyle)||void 0===r?void 0:r.textBaseline)&&void 0!==a?a:"middle"}):(b={x:M.x+w/2,y:M.y+m*T},x={x:M.x+w/2,y:M.y+_*T},k={textAlign:null!==(s=null===(o=null==f?void 0:f.textStyle)||void 0===o?void 0:o.textAlign)&&void 0!==s?s:"center",textBaseline:this.isTextOverflow(P,t,"start")?"top":"bottom"},S={textAlign:null!==(u=null===(l=null==g?void 0:g.textStyle)||void 0===l?void 0:l.textAlign)&&void 0!==u?u:"center",textBaseline:this.isTextOverflow(P,e,"end")?"bottom":"top"}),this._startText=this.maybeAddLabel(this._container,ft({},f,{text:C,x:b.x,y:b.y,visible:this._showText,pickable:!1,childrenPickable:!1,textStyle:k}),"data-zoom-start-text-".concat(M)),this._endText=this.maybeAddLabel(this._container,ft({},g,{text:E,x:x.x,y:x.y,visible:this._showText,pickable:!1,childrenPickable:!1,textStyle:S}),"data-zoom-end-text-".concat(M))}},{key:"renderText",value:function(){var t=null,e=null;this.setTextAttr(t,e),t=this._startText.AABBBounds,e=this._endText.AABBBounds,this.setTextAttr(t,e),t=this._startText.AABBBounds,e=this._endText.AABBBounds;var i=t,n=i.x1,r=i.x2,a=i.y1,o=i.y2,s=this.attribute.startTextStyle,l=s.dx,u=void 0===l?0:l,c=s.dy,h=void 0===c?0:c;if((new di).set(n,a,r,o).intersects(e)){var d="bottom"===this.attribute.orient||"right"===this.attribute.orient?-1:1;this._isHorizontal?this._startText.setAttribute("dy",h+d*Math.abs(e.y1-e.y2)):this._startText.setAttribute("dx",u+d*Math.abs(e.x1-e.x2))}else this._isHorizontal?this._startText.setAttribute("dy",h):this._startText.setAttribute("dx",u)}},{key:"getLayoutAttrFromConfig",value:function(){var t,e,i,n,r,a;if(this._layoutAttrFromConfig)return this._layoutAttrFromConfig;var o,s,l,u=this.attribute,c=u.position,h=u.size,d=u.orient,p=u.middleHandlerStyle,f=void 0===p?{}:p,v=u.startHandlerStyle,g=void 0===v?{}:v,y=u.endHandlerStyle,m=void 0===y?{}:y,_=u.backgroundStyle,b=void 0===_?{}:_,x=h.width,k=h.height,S=null!==(e=null===(t=f.background)||void 0===t?void 0:t.size)&&void 0!==e?e:10;f.visible?this._isHorizontal?(o=x,s=k-S,l={x:c.x,y:c.y+S}):(o=x-S,s=k,l={x:c.x+("left"===d?S:0),y:c.y}):(o=x,s=k,l=c);var A=null!==(i=g.size)&&void 0!==i?i:this._isHorizontal?s:o,M=null!==(n=m.size)&&void 0!==n?n:this._isHorizontal?s:o;return g.visible&&(this._isHorizontal?(o-=(A+M)/2,l={x:l.x+A/2,y:l.y}):(s-=(A+M)/2,l={x:l.x,y:l.y+A/2})),s+=null!==(r=b.lineWidth/2)&&void 0!==r?r:1,o+=null!==(a=b.lineWidth/2)&&void 0!==a?a:1,this._layoutAttrFromConfig={position:l,width:o,height:s},this._layoutAttrFromConfig}},{key:"render",value:function(){var t,e,i,n,r,a,o,s,l,u,c,h,d,p,f,v,g,y,m,_,b,x,k,S,A,M,w,T,C,E,P,R,B,I;this._layoutAttrFromConfig=null;var L=this.attribute,D=L.orient,O=L.backgroundStyle,F=L.backgroundChartStyle,z=void 0===F?{}:F,H=L.selectedBackgroundStyle,j=void 0===H?{}:H,N=L.selectedBackgroundChartStyle,V=void 0===N?{}:N,W=L.middleHandlerStyle,G=void 0===W?{}:W,U=L.startHandlerStyle,Y=void 0===U?{}:U,X=L.endHandlerStyle,K=void 0===X?{}:X,q=L.brushSelect,Z=L.zoomLock,J=this.state,Q=J.start,$=J.end,tt=this.getLayoutAttrFromConfig(),et=tt.position,it=tt.width,nt=tt.height,rt=null!==(t=Y.triggerMinSize)&&void 0!==t?t:40,at=null!==(e=K.triggerMinSize)&&void 0!==e?e:40,ot=this.createOrUpdateChild("dataZoom-container",{},"group");if(this._container=ot,this._background=ot.createOrUpdateChild("background",Object.assign(Object.assign({x:et.x,y:et.y,width:it,height:nt,cursor:q?"crosshair":"auto"},O),{pickable:!Z&&(null===(i=O.pickable)||void 0===i||i)}),"rect"),(null===(n=z.line)||void 0===n?void 0:n.visible)&&this.setPreviewAttributes("line",ot),(null===(r=z.area)||void 0===r?void 0:r.visible)&&this.setPreviewAttributes("area",ot),q&&this.renderDragMask(),this._isHorizontal?this._selectedBackground=ot.createOrUpdateChild("selectedBackground",Object.assign(Object.assign({x:et.x+Q*it,y:et.y,width:($-Q)*it,height:nt,cursor:q?"crosshair":"move"},j),{pickable:!Z&&(null===(a=V.pickable)||void 0===a||a)}),"rect"):this._selectedBackground=ot.createOrUpdateChild("selectedBackground",Object.assign(Object.assign({x:et.x,y:et.y+Q*nt,width:it,height:($-Q)*nt,cursor:q?"crosshair":"move"},j),{pickable:!Z&&(null===(o=j.pickable)||void 0===o||o)}),"rect"),(null===(s=V.line)||void 0===s?void 0:s.visible)&&this.setSelectedPreviewAttributes("line",ot),(null===(l=V.area)||void 0===l?void 0:l.visible)&&this.setSelectedPreviewAttributes("area",ot),this._isHorizontal){if(G.visible){var st=(null===(u=G.background)||void 0===u?void 0:u.size)||10;this._middleHandlerRect=ot.createOrUpdateChild("middleHandlerRect",Object.assign(Object.assign({x:et.x+Q*it,y:et.y-st,width:($-Q)*it,height:st},null===(c=G.background)||void 0===c?void 0:c.style),{pickable:!Z&&(null===(p=null===(d=null===(h=G.background)||void 0===h?void 0:h.style)||void 0===d?void 0:d.pickable)||void 0===p||p)}),"rect"),this._middleHandlerSymbol=ot.createOrUpdateChild("middleHandlerSymbol",Object.assign(Object.assign({x:et.x+(Q+$)/2*it,y:et.y-st/2,strokeBoundsBuffer:0,angle:0,symbolType:null!==(v=null===(f=G.icon)||void 0===f?void 0:f.symbolType)&&void 0!==v?v:"square"},G.icon),{pickable:!Z&&(null===(g=G.icon.pickable)||void 0===g||g)}),"symbol")}this._startHandler=ot.createOrUpdateChild("startHandler",Object.assign(Object.assign(Object.assign({x:et.x+Q*it,y:et.y+nt/2,size:nt,symbolType:null!==(y=Y.symbolType)&&void 0!==y?y:"square"},ZL.horizontal),Y),{pickable:!Z&&(null===(m=Y.pickable)||void 0===m||m)}),"symbol"),this._endHandler=ot.createOrUpdateChild("endHandler",Object.assign(Object.assign(Object.assign({x:et.x+$*it,y:et.y+nt/2,size:nt,symbolType:null!==(_=K.symbolType)&&void 0!==_?_:"square"},ZL.horizontal),K),{pickable:!Z&&(null===(b=K.pickable)||void 0===b||b)}),"symbol");var lt=Math.max(this._startHandler.AABBBounds.width(),rt),ut=Math.max(this._startHandler.AABBBounds.height(),rt),ct=Math.max(this._endHandler.AABBBounds.width(),at),ht=Math.max(this._endHandler.AABBBounds.height(),at);this._startHandlerMask=ot.createOrUpdateChild("startHandlerMask",Object.assign(Object.assign({x:et.x+Q*it-lt/2,y:et.y+nt/2-ut/2,width:lt,height:ut,fill:"white",fillOpacity:0,zIndex:999},ZL.horizontal),{pickable:!Z}),"rect"),this._endHandlerMask=ot.createOrUpdateChild("endHandlerMask",Object.assign(Object.assign({x:et.x+$*it-ct/2,y:et.y+nt/2-ht/2,width:ct,height:ht,fill:"white",fillOpacity:0,zIndex:999},ZL.horizontal),{pickable:!Z}),"rect")}else{if(G.visible){var dt=(null===(x=G.background)||void 0===x?void 0:x.size)||10;this._middleHandlerRect=ot.createOrUpdateChild("middleHandlerRect",Object.assign(Object.assign({x:"left"===D?et.x-dt:et.x+it,y:et.y+Q*nt,width:dt,height:($-Q)*nt},null===(k=G.background)||void 0===k?void 0:k.style),{pickable:!Z&&(null===(M=null===(A=null===(S=G.background)||void 0===S?void 0:S.style)||void 0===A?void 0:A.pickable)||void 0===M||M)}),"rect"),this._middleHandlerSymbol=ot.createOrUpdateChild("middleHandlerSymbol",Object.assign(Object.assign({x:"left"===D?et.x-dt/2:et.x+it+dt/2,y:et.y+(Q+$)/2*nt,angle:Math.PI/180*90,symbolType:null!==(T=null===(w=G.icon)||void 0===w?void 0:w.symbolType)&&void 0!==T?T:"square",strokeBoundsBuffer:0},G.icon),{pickable:!Z&&(null===(E=null===(C=G.icon)||void 0===C?void 0:C.pickable)||void 0===E||E)}),"symbol")}this._startHandler=ot.createOrUpdateChild("startHandler",Object.assign(Object.assign(Object.assign({x:et.x+it/2,y:et.y+Q*nt,size:it,symbolType:null!==(P=Y.symbolType)&&void 0!==P?P:"square"},ZL.vertical),Y),{pickable:!Z&&(null===(R=Y.pickable)||void 0===R||R)}),"symbol"),this._endHandler=ot.createOrUpdateChild("endHandler",Object.assign(Object.assign(Object.assign({x:et.x+it/2,y:et.y+$*nt,size:it,symbolType:null!==(B=K.symbolType)&&void 0!==B?B:"square"},ZL.vertical),K),{pickable:!Z&&(null===(I=K.pickable)||void 0===I||I)}),"symbol");var pt=Math.max(this._startHandler.AABBBounds.width(),rt),ft=Math.max(this._startHandler.AABBBounds.height(),rt),vt=Math.max(this._endHandler.AABBBounds.width(),at),gt=Math.max(this._endHandler.AABBBounds.height(),at);this._startHandlerMask=ot.createOrUpdateChild("startHandlerMask",Object.assign(Object.assign({x:et.x+it/2+pt/2,y:et.y+Q*nt-ft/2,width:gt,height:vt,fill:"white",fillOpacity:0,zIndex:999},ZL.vertical),{pickable:!Z}),"rect"),this._endHandlerMask=ot.createOrUpdateChild("endHandlerMask",Object.assign(Object.assign({x:et.x+it/2+vt/2,y:et.y+$*nt-gt/2,width:gt,height:vt,fill:"white",fillOpacity:0,zIndex:999},ZL.vertical),{pickable:!Z}),"rect")}this._showText&&this.renderText()}},{key:"computeBasePoints",value:function(){var t,e,i=this.attribute.orient,n=this.getLayoutAttrFromConfig(),r=n.position,a=n.width,o=n.height;return this._isHorizontal?(t=[{x:r.x,y:r.y+o}],e=[{x:r.x+a,y:r.y+o}]):"left"===i?(t=[{x:r.x+a,y:r.y}],e=[{x:r.x+a,y:r.y+o}]):(t=[{x:r.x,y:r.y+o}],e=[{x:r.x,y:r.y}]),{basePointStart:t,basePointEnd:e}}},{key:"simplifyPoints",value:function(t){var e;return t.length>1e4?function(t,e,i){return t.length<=10||i?t:function(t,e){for(var i,n,r=t[0].x,a=t[0].y,o=[t[0]],s=1,l=t.length;s<l;s++)(i=t[s].x-r)*i+(n=t[s].y-a)*n>e&&(r=t[s].x,a=t[s].y,o.push(t[s]));return t[t.length-1].x===r&&t[t.length-1].y===a||o.push(t[t.length-1]),o}(t,void 0!==e?e*e:1)}(t,null!==(e=this.attribute.tolerance)&&void 0!==e?e:this._previewData.length/1e4,!1):t}},{key:"getPreviewLinePoints",value:function(){var t=this,e=this._previewData.map((function(e){return{x:t._previewPointsX&&t._previewPointsX(e),y:t._previewPointsY&&t._previewPointsY(e)}}));if(0===e.length)return e;e=this.simplifyPoints(e);var i=this.computeBasePoints(),n=i.basePointStart,r=i.basePointEnd;return n.concat(e).concat(r)}},{key:"getPreviewAreaPoints",value:function(){var t=this,e=this._previewData.map((function(e){return{x:t._previewPointsX&&t._previewPointsX(e),y:t._previewPointsY&&t._previewPointsY(e),x1:t._previewPointsX1&&t._previewPointsX1(e),y1:t._previewPointsY1&&t._previewPointsY1(e)}}));if(0===e.length)return e;e=this.simplifyPoints(e);var i=this.computeBasePoints(),n=i.basePointStart,r=i.basePointEnd;return n.concat(e).concat(r)}},{key:"setPreviewAttributes",value:function(t,e){this._previewGroup||(this._previewGroup=e.createOrUpdateChild("previewGroup",{pickable:!1},"group")),"line"===t?this._previewLine=this._previewGroup.createOrUpdateChild("previewLine",{},"line"):this._previewArea=this._previewGroup.createOrUpdateChild("previewArea",{curveType:"basis"},"area");var i=this.attribute.backgroundChartStyle,n=void 0===i?{}:i;"line"===t&&this._previewLine.setAttributes(Object.assign({points:this.getPreviewLinePoints(),curveType:"basis",pickable:!1},n.line)),"area"===t&&this._previewArea.setAttributes(Object.assign({points:this.getPreviewAreaPoints(),curveType:"basis",pickable:!1},n.area))}},{key:"setSelectedPreviewAttributes",value:function(t,e){this._selectedPreviewGroupClip||(this._selectedPreviewGroupClip=e.createOrUpdateChild("selectedPreviewGroupClip",{pickable:!1},"group"),this._selectedPreviewGroup=this._selectedPreviewGroupClip.createOrUpdateChild("selectedPreviewGroup",{},"group")),"line"===t?this._selectedPreviewLine=this._selectedPreviewGroup.createOrUpdateChild("selectedPreviewLine",{},"line"):this._selectedPreviewArea=this._selectedPreviewGroup.createOrUpdateChild("selectedPreviewArea",{curveType:"basis"},"area");var i=this.attribute.selectedBackgroundChartStyle,n=void 0===i?{}:i,r=this.state,a=r.start,o=r.end,s=this.getLayoutAttrFromConfig(),l=s.position,u=s.width,c=s.height;this._selectedPreviewGroupClip.setAttributes({x:this._isHorizontal?l.x+a*u:l.x,y:this._isHorizontal?l.y:l.y+a*c,width:this._isHorizontal?(o-a)*u:u,height:this._isHorizontal?c:(o-a)*c,clip:!0,pickable:!1}),this._selectedPreviewGroup.setAttributes({x:-(this._isHorizontal?l.x+a*u:l.x),y:-(this._isHorizontal?l.y:l.y+a*c),width:this._isHorizontal?(o-a)*u:u,height:this._isHorizontal?c:(o-a)*c,pickable:!1}),"line"===t&&this._selectedPreviewLine.setAttributes(Object.assign({points:this.getPreviewLinePoints(),curveType:"basis",pickable:!1},n.line)),"area"===t&&this._selectedPreviewArea.setAttributes(Object.assign({points:this.getPreviewAreaPoints(),curveType:"basis",pickable:!1},n.area))}},{key:"maybeAddLabel",value:function(t,e,i){var n=this.find((function(t){return t.name===i}),!0);return n?n.setAttributes(e):(n=new bR(e)).name=i,t.add(n),n}},{key:"setStartAndEnd",value:function(t,e){var i=this.attribute,n=i.start,r=i.end;N(t)&&N(e)&&(t!==this.state.start||e!==this.state.end)&&(this.state.start=t,this.state.end=e,n===this.state.start&&r===this.state.end||(this.setStateAttr(t,e,!0),this._dispatchEvent("change",{start:t,end:e,tag:this._activeTag})))}},{key:"setPreviewData",value:function(t){this._previewData=t}},{key:"setText",value:function(t,e){"start"===e?this._startText.setAttribute("text",t):this._endText.setAttribute("text",t)}},{key:"getStartValue",value:function(){return this._startValue}},{key:"getEndTextValue",value:function(){return this._endValue}},{key:"getMiddleHandlerSize",value:function(){var t,e,i,n,r=this.attribute.middleHandlerStyle,a=void 0===r?{}:r,o=null!==(e=null===(t=a.background)||void 0===t?void 0:t.size)&&void 0!==e?e:10,s=null!==(n=null===(i=a.icon)||void 0===i?void 0:i.size)&&void 0!==n?n:10;return Math.max.apply(Math,[o].concat(m(xt(s))))}},{key:"setPreviewPointsX",value:function(t){H(t)&&(this._previewPointsX=t)}},{key:"setPreviewPointsY",value:function(t){H(t)&&(this._previewPointsY=t)}},{key:"setPreviewPointsX1",value:function(t){H(t)&&(this._previewPointsX1=t)}},{key:"setPreviewPointsY1",value:function(t){H(t)&&(this._previewPointsY1=t)}},{key:"setStatePointToData",value:function(t){H(t)&&(this._statePointToData=t)}},{key:"release",value:function(t){y(e,"release",this,3)([t]),("browser"===ex.env?ex:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1}),this._clearDragEvents()}}])}(yS);function rD(){cP(),mR()}nD.defaultAttributes=qL,function(t){t.start="start",t.startTop="startTop",t.startBottom="startBottom",t.insideStart="insideStart",t.insideStartTop="insideStartTop",t.insideStartBottom="insideStartBottom",t.middle="middle",t.insideMiddleTop="insideMiddleTop",t.insideMiddleBottom="insideMiddleBottom",t.end="end",t.endTop="endTop",t.endBottom="endBottom",t.insideEnd="insideEnd",t.insideEndTop="insideEndTop",t.insideEndBottom="insideEndBottom"}($L||($L={})),function(t){t.left="left",t.right="right",t.top="top",t.bottom="bottom",t.topLeft="topLeft",t.topRight="topRight",t.bottomLeft="bottomLeft",t.bottomRight="bottomRight",t.middle="middle",t.insideLeft="insideLeft",t.insideRight="insideRight",t.insideTop="insideTop",t.insideBottom="insideBottom",t.insideTopLeft="insideTopLeft",t.insideTopRight="insideTopRight",t.insideBottomLeft="insideBottomLeft",t.insideBottomRight="insideBottomRight"}(tD||(tD={})),function(t){t.arcInnerStart="arcInnerStart",t.arcInnerEnd="arcInnerEnd",t.arcInnerMiddle="arcInnerMiddle",t.arcOuterStart="arcOuterStart",t.arcOuterEnd="arcOuterEnd",t.arcOuterMiddle="arcOuterMiddle",t.center="center"}(eD||(eD={})),function(t){t.top="top",t.bottom="bottom",t.middle="middle",t.insideTop="insideTop",t.insideBottom="insideBottom",t.insideMiddle="insideMiddle"}(iD||(iD={}));var aD=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).name="marker",t._onHover=function(e){t._lastHover=cB(e,t._container,t._lastHover)},t._onUnHover=function(e){t._lastHover=hB(0,t._container,t._lastHover)},t._onClick=function(e){t._lastSelect=dB(e,t._container,t._lastSelect)},t}return h(e,t),o(e,[{key:"transAnimationConfig",value:function(){var t,e,i;if(!1!==this.attribute.animation){var n=V(this.attribute.animation)?this.attribute.animation:{};this._animationConfig={enter:ft({},this.defaultUpdateAnimation,n,null!==(t=this.attribute.animationEnter)&&void 0!==t?t:{}),exit:ft({},this.defaultExitAnimation,n,null!==(e=this.attribute.animationExit)&&void 0!==e?e:{}),update:ft({},this.defaultUpdateAnimation,n,null!==(i=this.attribute.animationUpdate)&&void 0!==i?i:{})}}}},{key:"setAttribute",value:function(t,i,n){y(e,"setAttribute",this,3)([t,i,n]),"visible"===t&&this.render()}},{key:"_bindEvent",value:function(){var t,e,i;if(this.attribute.interactive){var n=this.attribute,r=n.hover,a=n.select;r&&(null===(t=this._container)||void 0===t||t.addEventListener("pointermove",this._onHover),null===(e=this._container)||void 0===e||e.addEventListener("pointerout",this._onUnHover)),a&&(null===(i=this._container)||void 0===i||i.addEventListener("pointerdown",this._onClick))}}},{key:"_releaseEvent",value:function(){var t,e,i;null===(t=this._container)||void 0===t||t.removeEventListener("pointermove",this._onHover),null===(e=this._container)||void 0===e||e.removeEventListener("pointerout",this._onUnHover),null===(i=this._container)||void 0===i||i.removeEventListener("pointerdown",this._onClick)}},{key:"_initContainer",value:function(){var t,e,i,n=this.attribute,r=n.limitRect,a=void 0===r?{}:r;if(n.clipInRange){var o=By.group(Object.assign(Object.assign({},a),{clip:!0,pickable:!1}));i=By.group({x:-(null!==(t=a.x)&&void 0!==t?t:0),y:-(null!==(e=a.y)&&void 0!==e?e:0),pickable:!1}),o.add(i),this._containerClip=o,this.add(o)}else i=By.group({x:0,y:0,pickable:!1}),this.add(i);i.name="marker-container",this._container=i}},{key:"_updateContainer",value:function(){var t,e,i=this.attribute,n=i.limitRect,r=void 0===n?{}:n,a=i.clipInRange;this._containerClip&&this._containerClip.setAttributes(Object.assign({},r)),this._container.setAttributes({x:a?-(null!==(t=r.x)&&void 0!==t?t:0):0,y:a?-(null!==(e=r.y)&&void 0!==e?e:0):0})}},{key:"render",value:function(){var t;this.transAnimationConfig(),this.setAttribute("pickable",!1);var e=null===(t=this.attribute.visible)||void 0===t||t;!1===this.attribute.interactive&&this.setAttribute("childrenPickable",!1),e&&this.isValidPoints()?this._container?(this._updateContainer(),this.updateMarker(),this.markerAnimate("update")):(this._initContainer(),this.initMarker(this._container),this.markerAnimate("enter")):(this.markerAnimate("exit"),this._container=null,this.removeAllChild(!0)),this._releaseEvent(),this._bindEvent()}},{key:"release",value:function(){this.markerAnimate("exit"),y(e,"release",this,3)([]),this._releaseEvent(),this._container=null}}])}(yS);function oD(t,e,i,n){var r,a,o,s,l;if(t){null===(r=null==t?void 0:t.animates)||void 0===r||r.forEach((function(t){return t.stop("end")}));var u=null!==(o=null===(a=t.attribute)||void 0===a?void 0:a.fillOpacity)&&void 0!==o?o:1,c=null!==(l=null===(s=t.attribute)||void 0===s?void 0:s.strokeOpacity)&&void 0!==l?l:1;t.setAttributes({fillOpacity:0,strokeOpacity:0}),t.animate().wait(e).to({fillOpacity:u,strokeOpacity:c},i,n)}}function sD(t,e,i,n){t&&(oD(t.startSymbol,e,i,n),t.lines.forEach((function(t){return oD(t,e,i,n)})),oD(t.line,e,i,n),oD(t.endSymbol,e,i,n))}function lD(t,e,i,n){t&&(oD(t.getTextShape(),e,i,n),oD(t.getBgRect(),e,i,n))}function uD(t,e,i,n){var r,a,o,s;t&&(t.setAttributes({fillOpacity:null!==(a=null===(r=t.attribute)||void 0===r?void 0:r.fillOpacity)&&void 0!==a?a:1,strokeOpacity:null!==(s=null===(o=t.attribute)||void 0===o?void 0:o.strokeOpacity)&&void 0!==s?s:1}),t.animate().wait(e).to({fillOpacity:0,strokeOpacity:0},i,n))}function cD(t,e,i,n){t&&(uD(t.startSymbol,e,i,n),t.lines.forEach((function(t){return uD(t,e,i,n)})),uD(t.line,e,i,n),uD(t.endSymbol,e,i,n))}function hD(t,e,i,n){t&&(uD(t.getTextShape(),e,i,n),uD(t.getBgRect(),e,i,n))}function dD(t,e,i,n,r){var a=.1*i,o=.7*i,s=.1*i,l=.1*i;oD(t.startSymbol,n,a,r),t.lines.forEach((function(t){return t.setAttribute("clipRange",0)})),t.lines.forEach((function(e,i){var s=o/t.lines.length;e.animate().wait(n+a+i*s).to({clipRange:1},s,r)})),oD(t.endSymbol,n+a+o,s,r),xt(e).forEach((function(t){var e=n+a+o+s;oD(t.getTextShape(),e,l,r),oD(t.getBgRect(),e,l,r)}))}function pD(t,e,i,n,r){sD(t,n,i,r),xt(e).forEach((function(t){lD(t,n,i,r)}))}function fD(t,e,i,n,r){oD(t,n,i,r),xt(e).forEach((function(t){lD(t,n,i,r)}))}function vD(t,e,i,n,r){oD(t,n,i,r),xt(e).forEach((function(t){lD(t,n,i,r)}))}function gD(t,e,i,n,r,a){var o;sD(t,r,n,a),oD(e,r,n,a),(null===(o=i.getTextShape)||void 0===o?void 0:o.call(i))?lD(i,r,n,a):oD(i,r,n,a)}function yD(t,e,i,n,r,a){var o,s=.1*n,l=.65*n,u=.05*n,c=.1*n,h=.1*n;oD(t.startSymbol,r,s,a),t.lines.forEach((function(t){return t.setAttribute("clipRange",0)})),t.lines.forEach((function(e,i){var n=l/t.lines.length;e.animate().wait(r+s+i*n).to({clipRange:1},n,a)})),oD(e,r+s+l,u,a),oD(t.endSymbol,r+s+l+u,c,a),(null===(o=i.getTextShape)||void 0===o?void 0:o.call(i))?(oD(i.getTextShape(),r+s+l+u+c,h,a),oD(i.getBgRect(),r+s+l+c,h,a)):oD(i,r+s+l+c,h,a)}function mD(t,e,i,n){var r=i.enter,a=i.update,o=i.exit;if("enter"===n){var s=r.type,l=r.duration,u=r.delay,c=r.easing;"clipIn"===s?dD(t,e,l,u,c):"fadeIn"===s&&pD(t,e,l,u,c)}else if("update"===n){var h=a.type,d=a.duration,p=a.delay,f=a.easing;"clipIn"===h?dD(t,e,d,p,f):"fadeIn"===h&&pD(t,e,d,p,f)}else if("exit"===n){!function(t,e,i,n,r){cD(t,n,i,r),xt(e).forEach((function(t){hD(t,n,i,r)}))}(t,e,o.duration,o.delay,o.easing)}}function _D(t,e,i,n){var r=i.enter,a=i.update,o=i.exit;if("enter"===n){var s=r.type,l=r.duration,u=r.delay,c=r.easing;"fadeIn"===s&&fD(t,e,l,u,c)}else if("update"===n){var h=a.type,d=a.duration,p=a.delay,f=a.easing;"fadeIn"===h&&fD(t,e,d,p,f)}else if("exit"===n){!function(t,e,i,n,r){uD(t,n,i,r),xt(e).forEach((function(t){hD(t,n,i,r)}))}(t,e,o.duration,o.delay,o.easing)}}function bD(t,e,i,n){var r=i.enter,a=i.update,o=i.exit;if("enter"===n){var s=r.type,l=r.duration,u=r.delay,c=r.easing;"fadeIn"===s&&vD(t,e,l,u,c)}else if("update"===n){var h=a.type,d=a.duration,p=a.delay,f=a.easing;"fadeIn"===h&&vD(t,e,d,p,f)}else if("exit"===n){!function(t,e,i,n,r){uD(t,n,i,r),xt(e).forEach((function(t){hD(t,n,i,r)}))}(t,e,o.duration,o.delay,o.easing)}}function xD(t,e,i,n){var r=g(t,2),a=r[0],o=r[1],s=i.enter,l=i.update,u=i.exit;if("enter"===n){var c=s.type,h=s.duration,d=s.delay,p=s.easing;"fadeIn"===c?gD(a,o,e,h,d,p):"callIn"===c&&yD(a,o,e,h,d,p)}else if("update"===n){var f=l.type,v=l.duration,y=l.delay,m=l.easing;"fadeIn"===f?gD(a,o,e,v,y,m):"callIn"===f&&yD(a,o,e,v,y,m)}else if("exit"===n){!function(t,e,i,n,r,a){var o;cD(t,r,n,a),uD(e,r,n,a),(null===(o=i.getTextShape)||void 0===o?void 0:o.call(i))?hD(i,r,n,a):uD(i,r,n,a)}(a,o,e,u.duration,u.delay,u.easing)}}var kD={type:"clipIn",duration:500,easing:"linear",delay:0},SD={type:"fadeIn",duration:500,easing:"linear",delay:0},AD={type:"callIn",duration:500,easing:"linear",delay:0},MD={type:"fadeOut",duration:500,easing:"linear",delay:0},wD=function(){return o((function t(){r(this,t)}),[{key:"getLabel",value:function(){return this._label}},{key:"_addMarkLabels",value:function(t,e,i){var n=this,r=this.attribute,a=r.label,o=r.state,s=xt(null==o?void 0:o.label),l=xt(null==o?void 0:o.labelBackground),u=xt(a).map((function(r,a){var o,u,c=ft({},i,r),h=new bR(Object.assign(Object.assign({},c),{state:{panel:ft({},HP,null!==(o=l[a])&&void 0!==o?o:kt(l)),text:ft({},HP,null!==(u=s[a])&&void 0!==u?u:kt(s))}}));return h.name=e,t.add(h),n.setLabelPos(h,c),h}));this._label=1===xt(u).length?u[0]:u}},{key:"_updateMarkLabels",value:function(t){var e=this,i=this.attribute,n=i.label,r=i.state,a=xt(this._label),o=xt(null==r?void 0:r.label),s=xt(null==r?void 0:r.labelBackground);if(a.length){var l=xt(n);a.forEach((function(i,n){var r,a,u=ft({},t,l[n]);i.setAttributes(Object.assign(Object.assign({dx:0,dy:0},u),{state:{panel:ft({},HP,null!==(r=s[n])&&void 0!==r?r:kt(s)),text:ft({},HP,null!==(a=o[n])&&void 0!==a?a:kt(o))}})),e.setLabelPos(i,u)}))}}}])}(),TD=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).name="markCommonLine",t.defaultUpdateAnimation=kD,t.defaultExitAnimation=MD,t}return h(e,t),o(e,[{key:"getLine",value:function(){return this._line}},{key:"setLabelPos",value:function(t,e){var i=this.attribute.limitRect,n=e.position,r=e.confine,a=e.autoRotate,o=this.getPointAttrByPosition(n,e),s=n.toString().toLocaleLowerCase().includes("start")?this._line.getStartAngle()||0:this._line.getEndAngle()||0;if(t.setAttributes(Object.assign(Object.assign({},o.position),{angle:a?this.getRotateByAngle(o.angle,e):0,textStyle:Object.assign(Object.assign({},this.getTextStyle(n,s,a)),e.textStyle)})),i&&r){var l=i.x,u=i.y;yR(t,{x1:l,y1:u,x2:l+i.width,y2:u+i.height})}}},{key:"initMarker",value:function(t){var e=this.createSegment();e.name="mark-common-line-line",this._line=e,t.add(e),this.addMarkLineLabels(t)}},{key:"updateMarker",value:function(){this.setLineAttributes(),this.updateMarkLineLabels()}}])}(aD);bt(TD,wD);var CD=.001,ED={interactive:!0,startSymbol:{visible:!1,symbolType:"triangle",size:12,fill:"rgba(46, 47, 50)",lineWidth:0},endSymbol:{visible:!0,symbolType:"triangle",size:12,fill:"rgba(46, 47, 50)",lineWidth:0},label:{position:$L.end,refX:0,refY:0,refAngle:0,textStyle:{fill:"#fff",stroke:"#fff",lineWidth:0,fontSize:10,fontWeight:"normal",fontStyle:"normal"},padding:[2,2,4,4],panel:{visible:!0,cornerRadius:0,fill:"rgb(48, 115, 242)",fillOpacity:.8}},lineStyle:{stroke:"#b2bacf",lineWidth:1,lineDash:[2]}},PD={postiveXAxis:{start:{textAlign:"left",textBaseline:"middle"},startTop:{textAlign:"left",textBaseline:"bottom"},startBottom:{textAlign:"left",textBaseline:"top"},insideStart:{textAlign:"right",textBaseline:"middle"},insideStartTop:{textAlign:"right",textBaseline:"bottom"},insideStartBottom:{textAlign:"right",textBaseline:"top"},middle:{textAlign:"center",textBaseline:"middle"},insideMiddleTop:{textAlign:"center",textBaseline:"bottom"},insideMiddleBottom:{textAlign:"center",textBaseline:"top"},end:{textAlign:"left",textBaseline:"middle"},endTop:{textAlign:"left",textBaseline:"bottom"},endBottom:{textAlign:"left",textBaseline:"top"},insideEnd:{textAlign:"right",textBaseline:"middle"},insideEndTop:{textAlign:"right",textBaseline:"bottom"},insideEndBottom:{textAlign:"right",textBaseline:"top"}},negativeXAxis:{start:{textAlign:"right",textBaseline:"middle"},startTop:{textAlign:"right",textBaseline:"bottom"},startBottom:{textAlign:"right",textBaseline:"top"},insideStart:{textAlign:"left",textBaseline:"middle"},insideStartTop:{textAlign:"left",textBaseline:"bottom"},insideStartBottom:{textAlign:"left",textBaseline:"top"},middle:{textAlign:"center",textBaseline:"middle"},insideMiddleTop:{textAlign:"center",textBaseline:"bottom"},insideMiddleBottom:{textAlign:"center",textBaseline:"top"},end:{textAlign:"right",textBaseline:"middle"},endTop:{textAlign:"right",textBaseline:"bottom"},endBottom:{textAlign:"right",textBaseline:"top"},insideEnd:{textAlign:"left",textBaseline:"middle"},insideEndTop:{textAlign:"left",textBaseline:"bottom"},insideEndBottom:{textAlign:"left",textBaseline:"top"}}},RD={interactive:!0,startSymbol:{visible:!1,symbolType:"triangle",size:12,fill:"rgba(46, 47, 50)",lineWidth:0},endSymbol:{visible:!0,symbolType:"triangle",size:12,fill:"rgba(46, 47, 50)",lineWidth:0},label:{autoRotate:!0,position:eD.arcOuterMiddle,refX:0,refY:0,refAngle:0,textStyle:{fill:"#fff",stroke:"#fff",lineWidth:0,fontSize:10,fontWeight:"normal",fontStyle:"normal"},padding:[2,2,4,4],panel:{visible:!0,cornerRadius:0,fill:"rgb(48, 115, 242)",fillOpacity:.8}},lineStyle:{stroke:"#b2bacf",lineWidth:1,lineDash:[2]}},BD={interactive:!0,label:{position:tD.right,textStyle:{fill:"#fff",stroke:"#fff",lineWidth:0,fontSize:10,fontWeight:"normal",fontStyle:"normal"},padding:[2,2,4,4],panel:{visible:!0,cornerRadius:0,fill:"rgb(48, 115, 242)",fillOpacity:.8}},areaStyle:{fill:"#b2bacf",visible:!0}},ID={interactive:!0,label:{autoRotate:!0,position:eD.arcOuterMiddle,textStyle:{fill:"#fff",stroke:"#fff",lineWidth:0,fontSize:10,fontWeight:"normal",fontStyle:"normal"},padding:[2,2,4,4],panel:{visible:!0,cornerRadius:0,fill:"rgb(48, 115, 242)",fillOpacity:.8}},areaStyle:{fill:"#b2bacf",visible:!0}},LD={arcInnerStart:{textAlign:"center",textBaseline:"bottom"},arcInnerEnd:{textAlign:"center",textBaseline:"bottom"},arcInnerMiddle:{textAlign:"center",textBaseline:"bottom"},arcOuterStart:{textAlign:"center",textBaseline:"top"},arcOuterEnd:{textAlign:"center",textBaseline:"top"},arcOuterMiddle:{textAlign:"center",textBaseline:"top"},center:{textAlign:"center",textBaseline:"middle"}},DD={left:{textAlign:"right",textBaseline:"middle"},insideLeft:{textAlign:"left",textBaseline:"middle"},right:{textAlign:"left",textBaseline:"middle"},insideRight:{textAlign:"right",textBaseline:"middle"},top:{textAlign:"center",textBaseline:"bottom"},insideTop:{textAlign:"center",textBaseline:"top"},bottom:{textAlign:"center",textBaseline:"top"},insideBottom:{textAlign:"center",textBaseline:"bottom"},middle:{textAlign:"center",textBaseline:"middle"},topLeft:{textAlign:"right",textBaseline:"top"},insideTopLeft:{textAlign:"left",textBaseline:"top"},topRight:{textAlign:"left",textBaseline:"top"},insideTopRight:{textAlign:"right",textBaseline:"top"},bottomLeft:{textAlign:"right",textBaseline:"bottom"},insideBottomLeft:{textAlign:"left",textBaseline:"bottom"},bottomRight:{textAlign:"left",textBaseline:"bottom"},insideBottomRight:{textAlign:"right",textBaseline:"bottom"}},OD={postiveXAxis:{top:{textAlign:"left",textBaseline:"bottom"},bottom:{textAlign:"left",textBaseline:"top"},middle:{textAlign:"left",textBaseline:"middle"},insideTop:{textAlign:"right",textBaseline:"bottom"},insideBottom:{textAlign:"right",textBaseline:"top"},insideMiddle:{textAlign:"right",textBaseline:"middle"}},negativeXAxis:{top:{textAlign:"right",textBaseline:"bottom"},bottom:{textAlign:"right",textBaseline:"top"},middle:{textAlign:"right",textBaseline:"middle"},insideTop:{textAlign:"left",textBaseline:"bottom"},insideBottom:{textAlign:"left",textBaseline:"top"},insideMiddle:{textAlign:"left",textBaseline:"middle"}}};function FD(){zD._animate=mD}rD(),GR();var zD=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:ft({},e.defaultAttributes,t)])).name="markLine",a}return h(e,t),o(e,[{key:"markerAnimate",value:function(t){e._animate&&this._animationConfig&&e._animate(this._line,this._label,this._animationConfig,t)}},{key:"getPointAttrByPosition",value:function(t,e){var i,n=e.refX,r=void 0===n?0:n,a=e.refY,o=void 0===a?0:a,s=this._line.getMainSegmentPoints(),l=null!==(i=this._line.getEndAngle())&&void 0!==i?i:0,u=r*Math.cos(l)+o*Math.cos(l-Math.PI/2),c=r*Math.sin(l)+o*Math.sin(l-Math.PI/2);return t.includes("start")||t.includes("Start")?{position:{x:s[0].x+u,y:s[0].y+c},angle:l}:t.includes("middle")||t.includes("Middle")?{position:{x:(s[0].x+s[s.length-1].x)/2+u,y:(s[0].y+s[s.length-1].y)/2+c},angle:l}:{position:{x:s[s.length-1].x+u,y:s[s.length-1].y+c},angle:l}}},{key:"getRotateByAngle",value:function(t,e){var i;return(JP(t)?t:t-Math.PI)+(null!==(i=e.refAngle)&&void 0!==i?i:0)}},{key:"getTextStyle",value:function(t,e,i){return QP(Math.abs(e),Math.PI/2,CD)||QP(Math.abs(e),3*Math.PI/2,CD)?$P(i,e,t):JP(e)?PD.postiveXAxis[t]:PD.negativeXAxis[t]}},{key:"createSegment",value:function(){var t=this.attribute,e=t.points,i=t.startSymbol,n=t.endSymbol,r=t.lineStyle,a=t.mainSegmentIndex,o=t.multiSegment,s=t.state;return new YR({points:e,startSymbol:i,endSymbol:n,lineStyle:r,mainSegmentIndex:a,multiSegment:o,pickable:!1,state:{line:ft({},HP,null==s?void 0:s.line),startSymbol:ft({},HP,null==s?void 0:s.lineStartSymbol),endSymbol:ft({},HP,null==s?void 0:s.lineEndSymbol)}})}},{key:"setLineAttributes",value:function(){var t=this.attribute,e=t.points,i=t.startSymbol,n=t.endSymbol,r=t.lineStyle,a=t.mainSegmentIndex,o=t.multiSegment,s=t.state;this._line&&this._line.setAttributes({points:e,startSymbol:i,endSymbol:n,lineStyle:r,mainSegmentIndex:a,multiSegment:o,state:{line:ft({},HP,null==s?void 0:s.line),startSymbol:ft({},HP,null==s?void 0:s.lineStartSymbol),endSymbol:ft({},HP,null==s?void 0:s.lineEndSymbol)}})}},{key:"isValidPoints",value:function(){var t=this.attribute.points;if(!t||t.length<2)return!1;var e=!0;return t.forEach((function(t){if(t.length)t.forEach((function(t){Q(t.x)&&Q(t.y)||(e=!1)}));else if(!Q(t.x)||!Q(t.y))return void(e=!1)})),e}},{key:"addMarkLineLabels",value:function(t){this._addMarkLabels(t,"mark-common-line-label",e.defaultAttributes.label)}},{key:"updateMarkLineLabels",value:function(){this._updateMarkLabels(e.defaultAttributes.label)}}])}(TD);function HD(){jD._animate=_D}zD.defaultAttributes=ED,rD(),mP();var jD=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:ft({},e.defaultAttributes,t)])).name="markArea",a.defaultUpdateAnimation=SD,a.defaultExitAnimation=MD,a}return h(e,t),o(e,[{key:"markerAnimate",value:function(t){e._animate&&this._animationConfig&&e._animate(this._area,this._label,this._animationConfig,t)}},{key:"getArea",value:function(){return this._area}},{key:"getPointAttrByPosition",value:function(t){var e=this._area.AABBBounds,i=e.x1,n=e.x2,r=e.y1,a=e.y2,o={x:(i+n)/2,y:(r+a)/2};return(t.includes("left")||t.includes("Left"))&&(o.x=i),(t.includes("right")||t.includes("Right"))&&(o.x=n),(t.includes("top")||t.includes("Top"))&&(o.y=r),(t.includes("bottom")||t.includes("Bottom"))&&(o.y=a),o}},{key:"setLabelPos",value:function(t,e){var i;if(this._area){var n=null!==(i=e.position)&&void 0!==i?i:"middle",r=this.getPointAttrByPosition(n);if(t.setAttributes(Object.assign(Object.assign({},r),{textStyle:Object.assign(Object.assign({},DD[n]),e.textStyle)})),this.attribute.limitRect&&e.confine){var a=this.attribute.limitRect,o=a.x,s=a.y;yR(t,{x1:o,y1:s,x2:o+a.width,y2:s+a.height})}}}},{key:"initMarker",value:function(t){var i=this.attribute,n=i.points,r=i.areaStyle,a=i.state,o=By.polygon(Object.assign({points:n},r));o.states=ft({},HP,null==a?void 0:a.area),o.name="mark-area-polygon",this._area=o,t.add(o),this._addMarkLabels(t,"mark-area-label",e.defaultAttributes.label)}},{key:"updateMarker",value:function(){var t=this.attribute,i=t.points,n=t.areaStyle,r=t.state;this._area&&(this._area.setAttributes(Object.assign({points:i},n)),this._area.states=ft({},HP,null==r?void 0:r.area)),this._updateMarkLabels(e.defaultAttributes.label)}},{key:"isValidPoints",value:function(){var t=this.attribute.points;if(!t||t.length<3)return!1;var e=!0;return t.forEach((function(t){Q(t.x)&&Q(t.y)||(e=!1)})),e}}])}(aD);jD.defaultAttributes=BD,bt(jD,wD),rD(),UR();var ND=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:ft({},e.defaultAttributes,t)])).name="markArcLine",a}return h(e,t),o(e,[{key:"markerAnimate",value:function(t){e._animate&&this._animationConfig&&e._animate(this._line,this._label,this._animationConfig,t)}},{key:"getPointAttrByPosition",value:function(t,e){var i,n=this.attribute,r=n.center,a=n.radius,o=n.startAngle,s=n.endAngle,l=e.refX,u=void 0===l?0:l,c=e.refY,h=void 0===c?0:c;switch(t){case eD.arcInnerStart:i=o;case eD.arcOuterStart:i=o;break;case eD.arcInnerEnd:i=s;case eD.arcOuterEnd:i=s;break;case eD.center:case eD.arcInnerMiddle:case eD.arcOuterMiddle:default:i=(o+s)/2}return{position:{x:r.x+(a+h)*Math.cos(i)+u*Math.cos(i-Math.PI/2),y:r.y+(a+h)*Math.sin(i)+u*Math.sin(i-Math.PI/2)},angle:i}}},{key:"getTextStyle",value:function(t){return LD[t]}},{key:"getRotateByAngle",value:function(t,e){var i;return t-Math.PI/2+(null!==(i=e.refAngle)&&void 0!==i?i:0)}},{key:"createSegment",value:function(){var t=this.attribute,e=t.center,i=t.radius,n=t.startAngle,r=t.endAngle,a=t.startSymbol,o=t.endSymbol,s=t.lineStyle,l=t.state;return new qR({center:e,radius:i,startAngle:n,endAngle:r,startSymbol:a,endSymbol:o,lineStyle:s,state:{line:ft({},HP,null==l?void 0:l.line),startSymbol:ft({},HP,null==l?void 0:l.lineStartSymbol),endSymbol:ft({},HP,null==l?void 0:l.lineEndSymbol)}})}},{key:"setLineAttributes",value:function(){var t=this.attribute,e=t.center,i=t.radius,n=t.startAngle,r=t.endAngle,a=t.startSymbol,o=t.endSymbol,s=t.lineStyle,l=t.state;this._line&&this._line.setAttributes({center:e,radius:i,startAngle:n,endAngle:r,startSymbol:a,endSymbol:o,lineStyle:s,state:{line:ft({},HP,null==l?void 0:l.line),startSymbol:ft({},HP,null==l?void 0:l.lineStartSymbol),endSymbol:ft({},HP,null==l?void 0:l.lineEndSymbol)}})}},{key:"isValidPoints",value:function(){return!0}},{key:"addMarkLineLabels",value:function(t){this._addMarkLabels(t,"mark-common-line-label",e.defaultAttributes.label)}},{key:"updateMarkLineLabels",value:function(){this._updateMarkLabels(e.defaultAttributes.label)}}])}(TD);ND.defaultAttributes=RD,rD(),tP();var VD=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:ft({},e.defaultAttributes,t)])).name="markArcArea",a.defaultUpdateAnimation=SD,a.defaultExitAnimation=MD,a}return h(e,t),o(e,[{key:"markerAnimate",value:function(t){e._animate&&this._animationConfig&&e._animate(this._area,this._label,this._animationConfig,t)}},{key:"getArea",value:function(){return this._area}},{key:"getPointAttrByPosition",value:function(t,e){var i,n,r=this.attribute,a=r.center,o=r.innerRadius,s=r.outerRadius,l=r.startAngle,u=r.endAngle,c=e.refX,h=void 0===c?0:c,d=e.refY,p=void 0===d?0:d;switch(t){case eD.center:i=(o+s)/2,n=(l+u)/2;break;case eD.arcInnerStart:i=o,n=l;break;case eD.arcOuterStart:i=s,n=l;break;case eD.arcInnerEnd:i=o,n=u;break;case eD.arcOuterEnd:i=s,n=u;break;case eD.arcInnerMiddle:i=o,n=(l+u)/2;break;case eD.arcOuterMiddle:i=s,n=(l+u)/2;break;default:i=o,n=(l+u)/2}return{position:{x:a.x+(i+p)*Math.cos(n)+h*Math.cos(n-Math.PI/2),y:a.y+(i+p)*Math.sin(n)+h*Math.sin(n-Math.PI/2)},angle:n}}},{key:"setLabelPos",value:function(t,e){var i;if(this._area){var n=e.position,r=void 0===n?"arcInnerMiddle":n,a=e.autoRotate,o=this.getPointAttrByPosition(r,e);if(t.setAttributes(Object.assign(Object.assign({},o.position),{angle:a?o.angle-Math.PI/2+(null!==(i=e.refAngle)&&void 0!==i?i:0):0,textStyle:Object.assign(Object.assign({},LD[r]),e.textStyle)})),this.attribute.limitRect&&e.confine){var s=this.attribute.limitRect,l=s.x,u=s.y;yR(t,{x1:l,y1:u,x2:l+s.width,y2:u+s.height})}}}},{key:"initMarker",value:function(t){var i=this.attribute,n=i.center,r=i.innerRadius,a=i.outerRadius,o=i.startAngle,s=i.endAngle,l=i.areaStyle,u=i.state,c=By.arc(Object.assign({x:n.x,y:n.y,innerRadius:r,outerRadius:a,startAngle:o,endAngle:s},l));c.states=ft({},HP,null==u?void 0:u.area),c.name="polar-mark-area-area",this._area=c,t.add(c),this._addMarkLabels(t,"mark-area-label",e.defaultAttributes.label)}},{key:"updateMarker",value:function(){var t=this.attribute,i=t.center,n=t.innerRadius,r=t.outerRadius,a=t.startAngle,o=t.endAngle,s=t.areaStyle;t.label;var l=t.state;this._area&&(this._area.setAttributes(Object.assign({x:i.x,y:i.y,innerRadius:n,outerRadius:r,startAngle:a,endAngle:o},s)),this._area.states=ft({},HP,null==l?void 0:l.area)),this._updateMarkLabels(e.defaultAttributes.label)}},{key:"isValidPoints",value:function(){return!0}}])}(aD);function WD(){GD._animate=xD}VD.defaultAttributes=ID,bt(VD,wD),rD(),GR(),UR(),PP(),dP(),fP();var GD=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:ft({},e.defaultAttributes,t)])).name="markPoint",a.defaultUpdateAnimation=AD,a.defaultExitAnimation=MD,a._isArcLine=!1,a._isStraightLine=!1,a}return h(e,t),o(e,[{key:"markerAnimate",value:function(t){e._animate&&this._animationConfig&&e._animate([this._line,this._decorativeLine],this._item,this._animationConfig,t)}},{key:"setLabelPos",value:function(){}},{key:"getTextAlignAttr",value:function(t,e,i,n,r){return QP(Math.abs(n),Math.PI/2,CD)||QP(Math.abs(n),3*Math.PI/2,CD)?$P(t,n,r):JP(n)?OD.postiveXAxis[r]:OD.negativeXAxis[r]}},{key:"setItemAttributes",value:function(t,e,i,n,r){var a,o;if(t){var s=e.autoRotate,l=void 0===s||s,u=e.refX,c=void 0===u?0:u,h=e.refY,d=void 0===h?0:h,p=e.refAngle,f=void 0===p?0:p,v=e.textStyle,g=void 0===v?{}:v,y=e.richTextStyle,m=void 0===y?{}:y,_=e.imageStyle,b=void 0===_?{}:_,x=e.position,k=void 0===x?iD.middle:x,S=this.attribute.state,A=(null===(a=this._line)||void 0===a?void 0:a.getEndAngle())||0,M=c*Math.cos(A)+d*Math.cos(A-Math.PI/2),w=c*Math.sin(A)+d*Math.sin(A-Math.PI/2);if("text"===r){var T=n.x-i.x,C=n.y-i.y;t.setAttributes(Object.assign(Object.assign({},g),{textStyle:Object.assign(Object.assign({},this.getTextAlignAttr(l,T,C,A,null!==(o=e.position)&&void 0!==o?o:"end")),g.textStyle),state:{panel:ft({},HP,null==S?void 0:S.textBackground),text:ft({},HP,null==S?void 0:S.text)}}))}else"richText"===r?(t.setAttributes({dx:this.getItemDx(t,k,m)+(m.dx||0),dy:this.getItemDy(t,k,m)+(m.dy||0)}),t.states=ft({},HP,null==S?void 0:S.richText)):"image"===r&&(t.setAttributes({dx:this.getItemDx(t,k,b)+(b.dx||0),dy:this.getItemDy(t,k,b)+(b.dy||0)}),t.states=ft({},HP,null==S?void 0:S.image));var E=JP(A)?A:A-Math.PI;t.setAttributes({x:n.x+(M||0),y:n.y+(w||0),angle:l&&E+f})}}},{key:"getItemDx",value:function(t,e,i){var n,r,a=null!==(r=null===(n=null==t?void 0:t.AABBBounds)||void 0===n?void 0:n.width())&&void 0!==r?r:(null==i?void 0:i.width)||0;return e.includes("inside")?-a:0}},{key:"getItemDy",value:function(t,e,i){var n,r,a=null!==(r=null===(n=null==t?void 0:t.AABBBounds)||void 0===n?void 0:n.height())&&void 0!==r?r:(null==i?void 0:i.height)||0;return e.includes("top")||e.includes("Top")?-a:e.includes("middle")||e.includes("Middle")?-a/2:0}},{key:"initItem",value:function(t,e,i){var n,r=this.attribute.state,a=t.type,o=void 0===a?"text":a,s=t.symbolStyle,l=t.richTextStyle,u=t.imageStyle,c=t.renderCustomCallback;return"symbol"===o?(n=By.symbol(Object.assign(Object.assign({},i),s))).states=ft({},HP,null==r?void 0:r.symbol):"text"===o?n=new bR(Object.assign(Object.assign({},i),{state:{panel:ft({},HP,null==r?void 0:r.textBackground),text:ft({},HP,null==r?void 0:r.text)}})):"richText"===o?(n=By.richtext(Object.assign(Object.assign({},i),l))).states=ft({},HP,null==r?void 0:r.richText):"image"===o?(n=By.image(Object.assign(Object.assign({},i),u))).states=ft({},HP,null==r?void 0:r.image):"custom"===o&&c&&((n=c()).states=ft({},HP,null==r?void 0:r.customMark)),n.name="mark-point-".concat(o),this.setItemAttributes(n,t,e,i,o),n}},{key:"getItemLineAttr",value:function(t,e,i){var n=[],r={x:0,y:0},a=0,o=0,s=0,l=t.type,u=void 0===l?"type-s":l,c=t.arcRatio,h=void 0===c?.8:c,d=i.x-e.x,p=i.y-e.y;if(this._isStraightLine=QP(d,0,CD)||QP(p,0,CD),this._isArcLine){var f=this.attribute.position,v=f.x,g=f.y,y=i.x,m=i.y,_=(v+y)/2,b=_+h*(m>g?-1:1)*_,x=(g===m?0:-(v-y)/(g-m))*(b-_)+(g+m)/2;o=vR(g-x,v-b),s=vR(m-x,y-b),r={x:b,y:x};var k=Math.sqrt((b-v)*(b-v)+(x-g)*(x-g)),S=this.attribute.targetSymbol.style.size/2;o+=2*Math.acos(Math.sqrt(1-S*S/(4*k*k))),h>0?s<o&&(s+=2*Math.PI):o<s&&(o+=2*Math.PI),a=Math.sqrt((b-v)*(b-v)+(x-g)*(x-g))}else n="type-do"!==u||this._isStraightLine?"type-po"!==u||this._isStraightLine?"type-op"!==u||this._isStraightLine?[e,i]:[e,{x:e.x,y:i.y},i]:[e,{x:i.x,y:e.y},i]:[e,{x:(e.x+i.x)/2,y:i.y},i];return n=function(t){for(var e=[t[0]],i=1;i<t.length;i++)t[i].x===t[i-1].x&&t[i].y===t[i-1].y||e.push(t[i]);return e}(n),{points:n,center:r,radius:a,startAngle:o,endAngle:s}}},{key:"reDrawLine",value:function(t,e){this._line.release();var i=t.startSymbol,n=t.endSymbol,r=t.lineStyle;t.type;var a=this.attribute.state,o=this._isArcLine?qR:YR;this._container.removeChild(this._line),this._line=new o(Object.assign(Object.assign({},e),{pickable:!1,startSymbol:i,endSymbol:n,lineStyle:r,visible:t.visible,state:{line:ft({},HP,null==a?void 0:a.line),startSymbol:ft({},HP,null==a?void 0:a.lineStartSymbol),endSymbol:ft({},HP,null==a?void 0:a.lineEndSymbol)}})),this._container.add(this._line)}},{key:"setItemLineAttr",value:function(t,e,i){if(this._line){var n=t.startSymbol,r=t.endSymbol,a=t.lineStyle;t.type;var o=this.attribute.state,s=this.getItemLineAttr(t,e,i);this._isArcLine&&"arc-segment"===this._line.key||!this._isArcLine&&"segment"===this._line.key?this._line.setAttributes(Object.assign(Object.assign({},s),{startSymbol:n,endSymbol:r,lineStyle:a,visible:t.visible,state:{line:ft({},HP,null==o?void 0:o.line),startSymbol:ft({},HP,null==o?void 0:o.lineStartSymbol),endSymbol:ft({},HP,null==o?void 0:o.lineEndSymbol)}})):this.reDrawLine(t,s)}}},{key:"getDecorativeLineAttr",value:function(t){var e,i=(null===(e=null==t?void 0:t.decorativeLine)||void 0===e?void 0:e.length)||10,n=this._line.getEndAngle()||0;return{startPointOffsetX:i/2*Math.cos(n-Math.PI/2),startPointOffsetY:i/2*Math.sin(n-Math.PI/2),endPointOffsetX:-i/2*Math.cos(n-Math.PI/2),endPointOffsetY:-i/2*Math.sin(n-Math.PI/2)}}},{key:"setDecorativeLineAttr",value:function(t,e,i){var n;if(this._decorativeLine){var r=t.lineStyle,a=this.getDecorativeLineAttr(t),o=a.startPointOffsetX,s=a.startPointOffsetY,l=a.endPointOffsetX,u=a.endPointOffsetY;this._decorativeLine.setAttributes(Object.assign(Object.assign({points:[{x:e.x+o,y:e.y+s},{x:e.x+l,y:e.y+u}]},r),{visible:i})),this._decorativeLine.states=ft({},HP,null===(n=this.attribute.state)||void 0===n?void 0:n.line)}}},{key:"setTargetItemAttributes",value:function(t,e){var i,n;this._targetItem&&(this._targetItem.setAttributes(Object.assign({x:e.x,y:e.y,visible:null!==(i=t.visible)&&void 0!==i&&i,size:t.size},t.style)),this._targetItem.states=ft({},HP,null===(n=this.attribute.state)||void 0===n?void 0:n.targetItem))}},{key:"setAllOfItemsAttr",value:function(t,e){var i,n=this.attribute,r=n.position,a=n.itemLine,o=void 0===a?{}:a,s=n.itemContent,l=void 0===s?{}:s,u=n.limitRect,c=n.targetSymbol,h=l.type,d=void 0===h?"text":h,p=l.confine;if(u&&p){var f=u.x,v=u.y,g=u.width,y=u.height,m=gR(this._item,{x1:f,y1:v,x2:f+g,y2:v+y}),_=m.dx,b=m.dy;e.x=e.x+_,e.y=e.y+b}this.setTargetItemAttributes(c,r),this.setItemLineAttr(o,t,e),this.setItemAttributes(this._item,l,t,e,d),this.setDecorativeLineAttr(o,e,null===(i=o.decorativeLine)||void 0===i?void 0:i.visible)}},{key:"computeNewPositionAfterTargetItem",value:function(t){var e,i,n,r=this.attribute,a=r.itemContent,o=void 0===a?{}:a,s=r.targetSymbol,l=r.itemLine,u=o.offsetX,c=void 0===u?0:u,h=o.offsetY,d=void 0===h?0:h,p=s.offset,f=void 0===p?0:p,v=s.style,g=s.visible,y=void 0!==g&&g,m=s.size,_=y?null!==(i=null!==(e=v.size)&&void 0!==e?e:m)&&void 0!==i?i:20:0;return n="type-do"===l.type?vR(d,c/2):"type-po"===l.type?vR(0,c):"type-op"===l.type?vR(d,0):vR(d,c),{newPosition:{x:t.x+(_/2+f)*Math.cos(n),y:t.y+(_/2+f)*Math.sin(n)},newItemPosition:{x:t.x+(_/2+f)*Math.cos(n)+c,y:t.y+(_/2+f)*Math.sin(n)+d}}}},{key:"initMarker",value:function(t){var e=this.attribute,i=e.position,n=e.itemContent,r=void 0===n?{}:n,a=e.itemLine,o=a.type,s=void 0===o?"type-s":o,l=a.arcRatio,u=void 0===l?.8:l,c=r.offsetX,h=void 0===c?0:c,d=r.offsetY,p=void 0===d?0:d;this._isStraightLine=QP(h,0,CD)||QP(p,0,CD),this._isArcLine="type-arc"===s&&0!==u&&!this._isStraightLine;var f=this.computeNewPositionAfterTargetItem(i),v=f.newPosition,g=f.newItemPosition,y=new(this._isArcLine?qR:YR)({points:[],pickable:!1,center:{x:0,y:0},radius:0,startAngle:0,endAngle:0});y.name="mark-point-line",this._line=y,t.add(y);var m=By.line({points:[]});m.name="mark-point-decorativeLine",this._decorativeLine=m,t.add(m);var _=By.symbol({});_.name="mark-point-targetItem",this._targetItem=_,t.add(this._targetItem);var b=this.initItem(r,v,g);this._item=b,t.add(b),this.setAllOfItemsAttr(v,g)}},{key:"updateMarker",value:function(){var t=this.attribute,e=t.position,i=t.itemContent,n=void 0===i?{}:i,r=t.itemLine,a=n.type,o=void 0===a?"text":a,s=r.type,l=void 0===s?"type-s":s,u=r.arcRatio,c=void 0===u?.8:u,h=n.offsetX,d=void 0===h?0:h,p=n.offsetY,f=void 0===p?0:p;this._isStraightLine=QP(d,0,CD)||QP(f,0,CD);var v="type-arc"===l&&0!==c&&!this._isStraightLine,g=this.computeNewPositionAfterTargetItem(e),y=g.newPosition,m=g.newItemPosition;v!==this._isArcLine?(this._isArcLine=v,this.reDrawLine(r,{points:[{x:0,y:0}],pickable:!1,center:{x:0,y:0},radius:0,startAngle:0,endAngle:0})):this._isArcLine=v,this.setItemAttributes(this._item,n,y,m,o),this.setAllOfItemsAttr(y,m)}},{key:"isValidPoints",value:function(){var t=this.attribute.position;return!(!Q(t.x)||!Q(t.y))}}])}(aD);function UD(){cP(),PP(),BP()}GD.defaultAttributes={interactive:!0,targetSymbol:{visible:!1,offset:0,style:{symbolType:"circle",size:20,fill:!1,stroke:"rgba(46, 47, 50)"}},itemLine:{visible:!0,decorativeLine:{visible:!1,length:30},startSymbol:{visible:!0,clip:!0,symbolType:"circle",size:20,style:{fill:!1,stroke:"rgba(46, 47, 50)"}},endSymbol:{visible:!1,clip:!0,symbolType:"triangle",size:12,style:{fill:!1,stroke:"rgba(46, 47, 50)"}},lineStyle:{stroke:"#000",lineWidth:1}},itemContent:{type:"text",position:"middle",refX:10,symbolStyle:{symbolType:"star",fill:"rgb(48, 115, 242)",fillOpacity:.8,size:20},textStyle:{dx:0,dy:0},imageStyle:{width:80,height:80},richTextStyle:{width:100,height:100}}};var YD={space:8,style:{fill:"rgb(47, 69, 84)",cursor:"pointer",size:15},state:{disable:{fill:"rgb(170, 170, 170)",cursor:"not-allowed"},hover:{}}};UD();var XD=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:ft({},e.defaultAttributes,t)])).name="pager",a._current=1,a._onHover=function(t){var e=t.target;e.hasState("disable")||e.addState("hover")},a._onUnHover=function(t){t.target.removeState("hover")},a._onClick=function(t){var e=t.target;if("preHandler"===e.name){if(1===a._current)return;a._current-=1,1===a._current?e.addState("disable"):e.removeState("disable"),a._dispatchEvent("toPrev",{current:a._current,total:a._total,direction:"pre",event:t})}if("nextHandler"===e.name){if(a._current===a._total)return;a._current+=1,a._current===a._total?e.addState("disable"):e.removeState("disable"),a._dispatchEvent("toNext",{current:a._current,total:a._total,direction:"next",event:t})}a._current>1&&a.preHandler.removeState("disable"),a._current<a._total&&a.nextHandler.removeState("disable"),a.text.setAttribute("text",a._getPageText(a._current))},a}return h(e,t),o(e,[{key:"getCurrent",value:function(){return this._current}},{key:"render",value:function(){var t,e,i;this._reset();var n=this.attribute,r=n.layout,a=void 0===r?"horizontal":r,o=n.handler,s=void 0===o?YD:o,l=n.total,u=n.defaultCurrent,c=void 0===u?1:u,h=n.textStyle,d=n.padding,p=void 0===d?0:d;this._current=c;var f=Ei(p),v="horizontal"===a,g=By.group({x:0,y:0}),y=s.style||{},m=y.size||15,_=null!==(t=s.space)&&void 0!==t?t:8,b=s.state||{},x=s.preShape,k=s.nextShape;x||(x=v?"triangleLeft":"triangleUp"),k||(k=v?"triangleRight":"triangleDown");var S=By.symbol(Object.assign(Object.assign({strokeBoundsBuffer:0,pickMode:"imprecise"},y),{x:0,y:0,symbolType:x,size:m}));S.states=b,S.name="preHandler",this.preHandler=S,g.add(S);var A=cR(this._getPageText(l),Object.assign({textAlign:"center",textBaseline:"middle"},h),null===(i=null===(e=this.stage)||void 0===e?void 0:e.getTheme())||void 0===i?void 0:i.text),M=A.width,w=A.height,T=Z(m)?m:m[0],C=Z(m)?m:m[1],E=By.text(Object.assign({x:v?T/2+_+M/2:0,y:v?0:C/2+_+w/2,text:this._getPageText(c),textAlign:"center",textBaseline:"middle",lineHeight:null==h?void 0:h.fontSize},h));this.text=E,g.add(E);var P=By.symbol(Object.assign(Object.assign({strokeBoundsBuffer:0,pickMode:"imprecise"},y),{x:v?T+2*_+M:0,y:v?0:C+2*_+w,symbolType:k,size:m}));P.name="nextHandler",P.states=b,this.nextHandler=P,g.add(P),1===this._total?(S.addState("disable"),P.addState("disable")):1===this._current?S.addState("disable"):this._current===l&&P.addState("disable");var R=g.AABBBounds,B=R.width(),I=R.height();g.translateTo(0-R.x1+f[3],0-R.y1+f[0]),this.add(g),this.attribute.width=B+f[1]+f[3],this.attribute.height=I+f[0]+f[2],this._bindEvents()}},{key:"_bindEvents",value:function(){this.attribute.disableTriggerEvent||(this.preHandler&&(this.preHandler.addEventListener("pointerenter",this._onHover),this.preHandler.addEventListener("pointerleave",this._onUnHover),this.preHandler.addEventListener("pointerdown",this._onClick)),this.nextHandler&&(this.nextHandler.addEventListener("pointerenter",this._onHover),this.nextHandler.addEventListener("pointerleave",this._onUnHover),this.nextHandler.addEventListener("pointerdown",this._onClick)))}},{key:"_reset",value:function(){this.removeAllChild(!0),this._current=1,this._total=this.attribute.total,this.preHandler=this.nextHandler=this.text=null}},{key:"_getPageText",value:function(t){var e=this.attribute.pageFormatter;return e?H(e)?e(t,this._total):"".concat(e).replace("{current}","".concat(t)).replace("{total}","".concat(this._total)):"".concat(t,"/").concat(this._total)}},{key:"setTotal",value:function(t){t!==this.attribute.total&&(this._total=t,1!==this._current&&this._current<=t?this.setAttributes({total:t,defaultCurrent:this._current}):this.setAttribute("total",t))}}])}(yS);XD.defaultAttributes={handler:YD,textStyle:{fill:"rgb(51, 51, 51)",fontSize:12}};var KD,qD,ZD;!function(t){t.selected="selected",t.unSelected="unSelected",t.selectedHover="selectedHover",t.unSelectedHover="unSelectedHover",t.focus="focus"}(KD||(KD={})),function(t){t.legendItemHover="legendItemHover",t.legendItemUnHover="legendItemUnHover",t.legendItemClick="legendItemClick",t.legendItemAttributeUpdate="legendItemAttributeUpdate"}(qD||(qD={})),function(t){t.innerView="innerView",t.title="legendTitle",t.item="legendItem",t.itemShape="legendItemShape",t.itemLabel="legendItemLabel",t.itemValue="legendItemValue",t.focus="legendItemFocus"}(ZD||(ZD={}));var JD=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).name="legend",t._title=null,t}return h(e,t),o(e,[{key:"render",value:function(){this.removeAllChild(!0);var t=this.attribute,e=t.interactive,i=void 0===e||e,n=t.title,r=t.padding,a=void 0===r?0:r;this._parsedPadding=Ei(a);var o=By.group({x:this._parsedPadding[3],y:this._parsedPadding[0],pickable:i,childrenPickable:i});o.name=ZD.innerView,this.add(o),this._innerView=o,(null==n?void 0:n.visible)&&this._renderTitle(n),this._renderContent(),this._adjustLayout(),i&&this._bindEvents();var s=this._innerView.AABBBounds;this.attribute.width=s.width()+this._parsedPadding[1]+this._parsedPadding[3],this.attribute.height=s.height()+this._parsedPadding[0]+this._parsedPadding[2]}},{key:"_renderTitle",value:function(t){var e=t.text,i=void 0===e?"":e,n=t.textStyle,r=t.padding,a=void 0===r?0:r,o=t.background,s=t.minWidth,l=t.maxWidth,u=t.shape,c={x:0,y:0,text:i,textStyle:n,padding:Ei(a),minWidth:s,maxWidth:l};u&&u.visible&&(c.shape=Object.assign({visible:!0},u.style),N(u.space)&&(c.space=u.space)),o&&o.visible&&(c.panel=Object.assign({visible:!0},o.style));var h=new bR(c);h.name=ZD.title,this._title=h,this._innerView.add(h)}},{key:"_adjustLayout",value:function(){var t;if(this._title){var e=this._innerView.AABBBounds.width(),i=this._title.AABBBounds.width(),n=null===(t=this.attribute.title)||void 0===t?void 0:t.align;"center"===n?this._title.setAttribute("x",(e-i)/2):"end"===n&&this._title.setAttribute("x",e-i)}}}])}(yS);function QD(){cP(),BP(),kP(),PP()}function $D(){cP(),mR()}var tO=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i},eO=l(l(l(l(l({},KD.focus,{}),KD.selected,{}),KD.selectedHover,{}),KD.unSelected,{}),KD.unSelectedHover,{});$D(),UD(),LP();var iO,nO=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:ft({},e.defaultAttributes,t)])).name="discreteLegend",a._itemsContainer=null,a._itemHeightByUser=void 0,a._itemHeight=0,a._itemMaxWidth=0,a._contentMaxHeight=0,a._onHover=function(t){var e=t.target;if(e&&e.name&&e.name.startsWith(ZD.item)){var i=e.delegate;if(a._lastActiveItem){if(a._lastActiveItem.id===i.id)return;a._unHover(a._lastActiveItem,t)}a._hover(i,t)}else a._lastActiveItem&&(a._unHover(a._lastActiveItem,t),a._lastActiveItem=null)},a._onUnHover=function(t){a._lastActiveItem&&(a._unHover(a._lastActiveItem,t),a._lastActiveItem=null)},a._onClick=function(t){var e,i,n,r,o=t.target;if(o&&o.name&&o.name.startsWith(ZD.item)){var s=o.delegate,l=a.attribute.selectMode,u=void 0===l?"multiple":l;if(o.name===ZD.focus||"focus"===u){var c=s.hasState(KD.focus);s.toggleState(KD.focus),c?null===(e=a._itemsContainer)||void 0===e||e.getChildren().forEach((function(e){a._removeLegendItemState(e,[KD.unSelected,KD.unSelectedHover,KD.focus],t),a._setLegendItemState(e,KD.selected,t)})):(a._setLegendItemState(s,KD.selected,t),a._removeLegendItemState(s,[KD.unSelected,KD.unSelectedHover],t),null===(i=a._itemsContainer)||void 0===i||i.getChildren().forEach((function(e){s!==e&&(a._removeLegendItemState(e,[KD.selected,KD.selectedHover,KD.focus],t),a._setLegendItemState(e,KD.unSelected,t))})))}else{null===(n=a._itemsContainer)||void 0===n||n.getChildren().forEach((function(t){t.removeState(KD.focus)}));var h=a.attribute.allowAllCanceled,d=void 0===h||h,p=s.hasState(KD.selected),f=a._getSelectedLegends();if("multiple"===u){if(!1===d&&p&&1===f.length)return void a._dispatchLegendEvent(qD.legendItemClick,s,t);p?(a._removeLegendItemState(s,[KD.selected,KD.selectedHover],t),a._setLegendItemState(s,KD.unSelected,t)):(a._setLegendItemState(s,KD.selected,t),a._removeLegendItemState(s,[KD.unSelected,KD.unSelectedHover],t))}else a._setLegendItemState(s,KD.selected,t),a._removeLegendItemState(s,[KD.unSelected,KD.unSelectedHover],t),null===(r=a._itemsContainer)||void 0===r||r.getChildren().forEach((function(e){s!==e&&(a._removeLegendItemState(e,[KD.selected,KD.selectedHover],t),a._setLegendItemState(e,KD.unSelected,t))}))}a._dispatchLegendEvent(qD.legendItemClick,s,t)}},a}return h(e,t),o(e,[{key:"render",value:function(){y(e,"render",this,3)([]),this._lastActiveItem=null}},{key:"setSelected",value:function(t){var e,i=this;(null===(e=this._itemsContainer)||void 0===e?void 0:e.getChildren()).forEach((function(e){var n=e.data;t.includes(n.label)?(i._setLegendItemState(e,KD.selected),i._removeLegendItemState(e,[KD.unSelected,KD.unSelectedHover])):(i._removeLegendItemState(e,[KD.selected,KD.selectedHover]),i._setLegendItemState(e,KD.unSelected))}))}},{key:"_renderItems",value:function(){for(var t,e=this.attribute,i=e.item,n=void 0===i?{}:i,r=e.maxCol,a=void 0===r?1:r,o=e.maxRow,s=void 0===o?2:o,l=e.maxWidth,u=e.defaultSelected,c=e.lazyload,h=e.autoPage,d=n.spaceCol,p=void 0===d?16:d,f=n.spaceRow,v=void 0===f?8:f,g=n.verticalAlign,y=void 0===g?"middle":g,m=this._itemsContainer,_=this._itemContext,b=_.items,x=_.isHorizontal,k=_.startIndex,S=_.isScrollbar,A=S?1:x?s:a,M=this._contentMaxHeight,w=this._itemContext,T=w.doWrap,C=w.maxWidthInCol,E=w.startX,P=w.startY,R=w.pages,B=0,I=0,L=[],D=k,O=b.length;D<O&&!(c&&R>this._itemContext.currentPage*A);D++){c&&(this._itemContext.startIndex=D+1),(t=b[D]).id||(t.id=t.label),t.index=D;var F=!0;X(u)&&(F=u.includes(t.label));var z=this._renderEachItem(t,F,D,b),H=z.attribute.width,j=z.attribute.height;this._itemHeight=Math.max(this._itemHeight,j),C=Math.max(H,C),this._itemMaxWidth=Math.max(H,this._itemMaxWidth),x?(N(l)&&(S&&h?T=(R=Math.ceil((E+H)/l))>1:E+H>l&&(T=!0,E>0&&("middle"!==y&&"bottom"!==y||L.forEach((function(t){t.setAttributes({y:t.attribute.y+(I-t.attribute.height)/("middle"===y?2:1)})})),R+=1,E=0,P+=I+v,I=0,L.length=0))),0===E&&0===P||z.setAttributes({x:E,y:P}),E+=p+H,I=Math.max(I,j),L.push(z)):(N(M)&&(S&&h?T=(R=Math.ceil((P+j)/M))>1:M<=j?(R+=1,T=!0,P=0,D>0&&(E+=B+p)):M<P+j&&(R+=1,T=!0,P=0,E+=C+p,C=0)),0===E&&0===P||z.setAttributes({x:E,y:P}),P+=v+j),m.add(z),B=H}return!x||"middle"!==y&&"bottom"!==y||L.forEach((function(t){t.setAttributes({y:t.attribute.y+(I-t.attribute.height)/("middle"===y?2:1)})})),this._itemContext.doWrap=T,this._itemContext.startX=E,this._itemContext.startY=P,this._itemContext.maxWidthInCol=C,this._itemContext.pages=R,this._itemContext.maxPages=A,S&&(this._itemContext.totalPage=R),c||(this._itemContext.startIndex=b.length),this._itemContext}},{key:"_renderContent",value:function(){var t=this.attribute,e=t.item,i=void 0===e?{}:e,n=t.items,r=t.reversed,a=t.maxWidth,o=t.maxHeight;if(!1!==i.visible&&!ot(n)){var s=n;r&&(s=null==n?void 0:n.reverse()),this._contentMaxHeight=Math.max(0,o-this._parsedPadding[0]-this._parsedPadding[2]);var l=By.group({x:0,y:0});this._itemsContainer=l;var u=this.attribute,c=u.layout,h=u.autoPage,d="horizontal"===c,p=i.maxWidth,f=i.width,v=i.height,g=[];N(p)&&g.push(p),N(f)&&g.push(f),g.length&&(N(a)&&g.push(a),this._itemWidthByUser=At(g)),N(v)&&(this._itemHeightByUser=v);var y=this.attribute.pager;this._itemContext={currentPage:y&&y.defaultCurrent||1,doWrap:!1,maxWidthInCol:0,maxPages:1,pages:1,startX:0,startY:0,startIndex:0,items:s,isHorizontal:d,totalPage:1/0,isScrollbar:y&&"scrollbar"===y.type,clipContainer:void 0},this._itemContext=this._renderItems();var m=!1;this._itemContext.doWrap&&h&&this._itemContext.pages>this._itemContext.maxPages&&(m=this._renderPagerComponent()),m||(l.setAttribute("y",this._title?this._title.AABBBounds.height()+st(this.attribute,"title.space",8):0),this._innerView.add(l))}}},{key:"_bindEvents",value:function(){if(!this.attribute.disableTriggerEvent&&this._itemsContainer){var t=this.attribute,e=t.hover,i=void 0===e||e,n=t.select,r=void 0===n||n;if(i){var a="pointermove",o="pointerleave";V(i)&&(i.trigger&&(a=i.trigger),i.triggerOff&&(o=i.triggerOff)),this._itemsContainer.addEventListener(a,this._onHover),this._itemsContainer.addEventListener(o,this._onUnHover)}if(r){var s="pointerdown";V(r)&&r.trigger&&(s=r.trigger),this._itemsContainer.addEventListener(s,this._onClick)}}}},{key:"_autoEllipsis",value:function(t,e,i,n){var r,a,o=this.attribute.item,s=o.label,l=o.value,u=n.AABBBounds,c=i.AABBBounds,h=u.width(),d=c.width(),p=!1;"labelFirst"===t?d>e?p=!0:n.setAttribute("maxLineWidth",e-d):"valueFirst"===t?h>e?p=!0:i.setAttribute("maxLineWidth",e-h):h+d>e&&(p=!0),p&&(n.setAttribute("maxLineWidth",Math.max(e*(null!==(r=s.widthRatio)&&void 0!==r?r:.5),e-d)),i.setAttribute("maxLineWidth",Math.max(e*(null!==(a=l.widthRatio)&&void 0!==a?a:.5),e-h)))}},{key:"_renderEachItem",value:function(t,e,i,n){var r,a,o,s=t.id,l=t.label,u=t.value,c=t.shape,h=this.attribute.item,d=h.padding,p=void 0===d?0:d,f=h.focus,v=h.focusIconStyle,g=h.align,y=h.autoEllipsisStrategy,m=this.attribute.item,_=m.shape,b=m.label,x=m.value,k=m.background,S=this._handleStyle(_,t,e,i,n),A=this._handleStyle(b,t,e,i,n),M=this._handleStyle(x,t,e,i,n),w=this._handleStyle(k,t,e,i,n),T=Ei(p);!1===k.visible?(o=By.group({x:0,y:0,cursor:null===(r=w.style)||void 0===r?void 0:r.cursor}),this._appendDataToShape(o,ZD.item,t,o)):(o=By.group(Object.assign({x:0,y:0},w.style)),this._appendDataToShape(o,ZD.item,t,o,w.state)),o.id="".concat(null!=s?s:l,"-").concat(i),o.addState(e?KD.selected:KD.unSelected);var C=By.group({x:0,y:0,pickable:!1});o.add(C);var E,P=0,R=0,B=0;if(_&&!1!==_.visible){var I=st(S,"style.size",10);R=X(I)?I[0]||0:I,B=st(_,"space",8);var L=By.symbol(Object.assign(Object.assign({x:0,y:0,symbolType:"circle",strokeBoundsBuffer:0},c),S.style));Object.keys(S.state||{}).forEach((function(t){var e=S.state[t].fill||S.state[t].stroke;c.fill&&j(S.state[t].fill)&&e&&(S.state[t].fill=e),c.stroke&&j(S.state[t].stroke)&&e&&(S.state[t].stroke=e)})),this._appendDataToShape(L,ZD.itemShape,t,o,S.state),L.addState(e?KD.selected:KD.unSelected),C.add(L)}var D=0;if(f){var O=st(v,"size",10);E=By.symbol(Object.assign(Object.assign({x:0,y:-O/2-1,strokeBoundsBuffer:0,boundsPadding:T},v),{visible:!0,pickMode:"imprecise"})),this._appendDataToShape(E,ZD.focus,t,o),D=O}var F=b.formatMethod?b.formatMethod(l,t,i):l,z=pR(Object.assign(Object.assign({x:R/2+B,y:0,textAlign:"start",textBaseline:"middle",lineHeight:null===(a=A.style)||void 0===a?void 0:a.fontSize},A.style),{text:F,_originText:b.formatMethod?l:void 0}));this._appendDataToShape(z,ZD.itemLabel,t,o,A.state),z.addState(e?KD.selected:KD.unSelected),C.add(z);var H=st(b,"space",8);if(N(u)){var V=st(x,"space",f?8:0),W=x.formatMethod?x.formatMethod(u,t,i):u,G=pR(Object.assign(Object.assign({x:0,y:0,textAlign:"start",textBaseline:"middle",lineHeight:M.style.fontSize},M.style),{text:W,_originText:x.formatMethod?u:void 0}));if(this._appendDataToShape(G,ZD.itemValue,t,o,M.state),G.addState(e?KD.selected:KD.unSelected),this._itemWidthByUser){var U=this._itemWidthByUser-T[1]-T[3]-R-B-H-D-V;this._autoEllipsis(y,U,z,G),x.alignRight?G.setAttributes({textAlign:"right",x:this._itemWidthByUser-R/2-T[1]-T[3]-D-V}):G.setAttribute("x",H+(z.AABBBounds.empty()?0:z.AABBBounds.x2))}else G.setAttribute("x",H+(z.AABBBounds.empty()?0:z.AABBBounds.x2));P=V+(G.AABBBounds.empty()?0:G.AABBBounds.x2),C.add(G)}else this._itemWidthByUser?(z.setAttribute("maxLineWidth",this._itemWidthByUser-T[1]-T[3]-R-B-D),P=H+(z.AABBBounds.empty()?0:z.AABBBounds.x2)):P=H+(z.AABBBounds.empty()?0:z.AABBBounds.x2);E&&(E.setAttribute("x",P),C.add(E));var Y=C.AABBBounds,K=Y.width();if("right"===g){var q=Y.x2,Z=Y.x1;C.forEachChildren((function(t,e){"symbol"!==t.type&&"right"!==t.attribute.textAlign||t===E?t.setAttribute("x",Z+q-t.attribute.x-t.AABBBounds.width()):"symbol"!==t.type?t.setAttributes({x:Z+q-t.attribute.x,textAlign:"left"}):t.setAttribute("x",Z+q-t.attribute.x)}))}var J=Y.height(),Q=N(this.attribute.item.width)?this.attribute.item.width:K+T[1]+T[3],$=this._itemHeightByUser||J+T[0]+T[2];return o.attribute.width=Q,o.attribute.height=$,E&&E.setAttribute("visible",!1),C.translateTo(-Y.x1+T[3],-Y.y1+T[0]),o}},{key:"_createPager",value:function(t){var e,i,n=this.attribute,r=n.disableTriggerEvent,a=n.maxRow,o=function(t){return t<=99?99:t<=999?999:9999};return this._itemContext.isHorizontal?new XD(Object.assign(Object.assign({layout:1===a?"horizontal":"vertical",total:o(this._itemContext.pages)},ft({handler:{preShape:"triangleUp",nextShape:"triangleDown"}},t)),{defaultCurrent:null===(e=this.attribute.pager)||void 0===e?void 0:e.defaultCurrent,disableTriggerEvent:r})):new XD(Object.assign({layout:"horizontal",total:o(this._itemContext.pages),disableTriggerEvent:r,defaultCurrent:null===(i=this.attribute.pager)||void 0===i?void 0:i.defaultCurrent},t))}},{key:"_createScrollbar",value:function(t,e){var i=this.attribute.disableTriggerEvent;return this._itemContext.isHorizontal?new GP(Object.assign(Object.assign({direction:"horizontal",disableTriggerEvent:i,range:[0,.5],height:!1===t.visible?0:12},t),{width:e})):new GP(Object.assign(Object.assign({direction:"vertical",width:!1===t.visible?0:12,range:[0,.5]},t),{height:e,disableTriggerEvent:i}))}},{key:"_updatePositionOfPager",value:function(t,e,i){var n,r,a=this.attribute.pager,o=this._itemContext,s=o.totalPage,l=o.isHorizontal,u=a&&a.position||"middle";(this._pagerComponent.setTotal(s),l)?(n="start"===u?t:"end"===u?t+i-this._pagerComponent.AABBBounds.height()/2:t+i/2-this._pagerComponent.AABBBounds.height()/2,this._pagerComponent.setAttributes({x:e-this._pagerComponent.AABBBounds.width(),y:n})):(r="start"===u?0:"end"===u?e-this._pagerComponent.AABBBounds.width():(e-this._pagerComponent.AABBBounds.width())/2,this._pagerComponent.setAttributes({x:r,y:i-this._pagerComponent.AABBBounds.height()}))}},{key:"_computeScrollbarDelta",value:function(){var t,e=this._itemContext,i=e.isHorizontal,n=e.clipContainer,r=this._itemsContainer.AABBBounds,a=n.AABBBounds;return i?t=a.width()/r.width():t=a.height()/r.height(),t}},{key:"_updatePositionOfScrollbar",value:function(t,e,i){var n=this._itemContext,r=n.isHorizontal,a=(n.currentPage-1)/n.totalPage;this._pagerComponent.setScrollRange([a,a+this._computeScrollbarDelta()]),r?this._pagerComponent.setAttributes({x:0,y:i+e}):this._pagerComponent.setAttributes({x:t,y:i})}},{key:"_bindEventsOfPager",value:function(t,e){var i=this,n=this.attribute.pager||{},r=n.animation,a=void 0===r||r,o=n.animationDuration,s=void 0===o?450:o,u=n.animationEasing,c=void 0===u?"quadIn":u,h=this._itemContext.isScrollbar?function(t){var e=t.detail.value;return 0===e[0]?1:1===e[1]?i._itemContext.totalPage:e[0]*i._itemContext.totalPage+1}:function(t){return t.detail.current},d=function(n){var r=h(n);if(r!==i._itemContext.currentPage){if(i._itemContext.currentPage=r,i._itemContext&&i._itemContext.startIndex<i._itemContext.items.length){i._renderItems();var o=Math.ceil(i._itemContext.pages/i._itemContext.maxPages);if(i._itemContext.totalPage=o,i._itemContext.isScrollbar&&i._pagerComponent){var u=i._computeScrollbarDelta(),d=g(i._pagerComponent.getScrollRange(),1)[0];i._pagerComponent.setScrollRange([d,d+u])}}if(i._itemContext.isScrollbar){var p=g(i._pagerComponent.getScrollRange(),1)[0],f=(i._itemContext.isHorizontal?i._itemsContainer.AABBBounds.width():i._itemsContainer.AABBBounds.height())*p;i.updateScrollMask(),a?i._itemsContainer.animate().to(l({},e,-f),s,c):i._itemsContainer.setAttribute(e,-f)}else a?i._itemsContainer.animate().to(l({},e,-(r-1)*t),s,c):i._itemsContainer.setAttribute(e,-(r-1)*t)}};if(this._itemContext.isScrollbar){if(this._pagerComponent.addEventListener("scrollDrag",d),this._pagerComponent.addEventListener("scrollUp",d),this.attribute.pager.roamScroll){this.addEventListener("wheel",(function(t){return t.nativeEvent.preventDefault()})),this.addEventListener("wheel",Zt((function(t){var e=i._pagerComponent,n=e.getScrollRange(),r=e.attribute.direction,a=e.getSliderRenderBounds(),o=a.width,s=a.height,l="vertical"===r?t.deltaY/s:t.deltaX/o;e.setScrollRange([n[0]+l,n[1]+l],!0),i.updateScrollMask()}),50))}}else this._pagerComponent.addEventListener("toPrev",d),this._pagerComponent.addEventListener("toNext",d)}},{key:"_renderPager",value:function(){var t,e=this,i=this._title?this._title.AABBBounds.height()+st(this.attribute,"title.space",8):0,n=this.attribute,r=n.maxWidth,a=n.maxCol,o=void 0===a?1:a,s=n.maxRow,l=void 0===s?2:s,u=n.item,c=void 0===u?{}:u,h=n.pager,d=void 0===h?{}:h,p=c.spaceCol,f=void 0===p?16:p,v=c.spaceRow,g=void 0===v?8:v,y=this._itemsContainer,m=d.space,_=void 0===m?12:m,b=d.defaultCurrent,x=void 0===b?1:b,k=tO(d,["space","defaultCurrent"]),S=this._itemContext.isHorizontal,A=this._contentMaxHeight,M=0,w=0,T=0,C=0,E=0,P=0,R=1;if(S){if(w=(l-1)*g+this._itemHeight*l,M=r,t=this._createPager(k),this._pagerComponent=t,this._innerView.add(t),(T=r-t.AABBBounds.width()-_)<=0)return this._innerView.removeChild(t),!1;y.getChildren().forEach((function(t,e){var i=t.attribute,n=i.width,r=i.height;T<E+n&&(E=0,P+=r+g,R+=1),e>0&&t.setAttributes({x:E,y:P}),E+=f+n})),this._itemContext.startX=E,this._itemContext.startY=P,this._itemContext.pages=R;var B=Math.ceil(R/l);this._itemContext.totalPage=B,this._updatePositionOfPager(i,M,w)}else{if(M=this._itemMaxWidth*o+(o-1)*f,w=A,T=M,t=this._createPager(k),this._pagerComponent=t,this._innerView.add(t),(C=A-t.AABBBounds.height()-_-i)<=0)return this._innerView.removeChild(t),!1;y.getChildren().forEach((function(t,i){var n=t.attribute.height;C<P+n&&(P=0,E+=e._itemMaxWidth+f,R+=1),i>0&&t.setAttributes({x:E,y:P}),P+=g+n}));var I=Math.ceil(R/o);this._itemContext.totalPage=I,this._updatePositionOfPager(i,M,w)}x>1&&(S?y.setAttribute("y",-(x-1)*(w+g)):y.setAttribute("x",-(x-1)*(M+f)));var L=By.group({x:0,y:i,width:S?T:M,height:S?w:C,clip:!0,pickable:!1});return L.add(y),this._innerView.add(L),this._itemContext.clipContainer=L,this._bindEventsOfPager(S?w+g:M+f,S?"y":"x"),!0}},{key:"_renderScrollbar",value:function(){var t,e=this._title?this._title.AABBBounds.height()+st(this.attribute,"title.space",8):0,i=this.attribute,n=i.maxWidth,r=i.item,a=void 0===r?{}:r,o=i.pager,s=void 0===o?{}:o,l=a.spaceCol,u=void 0===l?16:l,c=a.spaceRow,h=void 0===c?8:c,d=this._itemsContainer;s.space;var p,f=s.defaultCurrent,v=void 0===f?1:f,g=tO(s,["space","defaultCurrent"]),y=this._itemContext.isHorizontal,m=this._contentMaxHeight,_=0,b=0,x=0,k=1;if(y)_=n,b=this._itemHeight,p=this._createScrollbar(g,_),this._pagerComponent=p,this._innerView.add(p);else{if(b=m-e,_=this._itemMaxWidth,p=this._createScrollbar(g,b),this._pagerComponent=p,this._innerView.add(p),b<=0)return this._innerView.removeChild(p),!1;var S=d.getChildren(),A=S.map((function(t){return t.attribute.height}));if(1===A.length||A.every((function(t){return t===A[0]}))){var M=A[0],w=b,T=Math.floor(w/(h+M));b=T*(h+M),k=Math.ceil(S.length/T)}else S.forEach((function(t,e){var i=t.attribute.height,n=k,r=x;k=Math.floor((x+i)/b)+1,x+=h+i,n!==k&&e===d.getChildren().length-1&&x-b>=1/3*i&&(b=r+i,k-=1)}));this._itemContext.totalPage=k,this._itemContext.pages=k}if(v>1)if(y){var C=this._itemsContainer.AABBBounds.width()-_;d.setAttribute("x",-Math.min((v-1)*(_+u),C))}else{var E=this._itemsContainer.AABBBounds.height()-b;d.setAttribute("y",-Math.min((v-1)*(b+h),E))}var P=By.group({x:0,y:e,width:_,height:b,clip:!0,pickable:!1});return P.add(d),this._innerView.add(P),this._itemContext.clipContainer=P,this._updatePositionOfScrollbar(_,b,e),(null===(t=s.scrollMask)||void 0===t?void 0:t.visible)&&this.renderScrollMask(P),this._bindEventsOfPager(y?_:b,y?"x":"y"),!0}},{key:"renderScrollMask",value:function(t){var e=this.attribute.pager.scrollMask,i=void 0===e?{}:e,n=i.visible,r=void 0===n||n,a=i.gradientLength,o=void 0===a?16:a,s=i.gradientStops;if(r&&s){var l=t.AABBBounds.width(),u=t.AABBBounds.height(),c=this._itemContext.isHorizontal?l:u,h=s.map((function(t){return{offset:o*t.offset/c,color:t.color}})),d=s.map((function(t){return{offset:(c-o*t.offset)/c,color:t.color}})),p=By.rect({x:0,y:0,width:l,height:u});this._scrollMask=p,this._scrollMaskContext={startStops:h,endStops:d},this.updateScrollMask(),t.add(p)}}},{key:"updateScrollMask",value:function(){if(this._scrollMask&&this._pagerComponent&&this._itemContext.isScrollbar){var t=g(this._pagerComponent.getScrollRange(),2),e=t[0],i=t[1],n=[];Nt(Ut(i,0,1),1)||n.push.apply(n,m(this._scrollMaskContext.endStops)),Nt(Ut(e,0,1),0)||n.push.apply(n,m(this._scrollMaskContext.startStops)),n.length&&(this._itemContext.isHorizontal?this._scrollMask.setAttributes({fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:n}}):this._scrollMask.setAttributes({fill:{gradient:"linear",x0:0,y0:0,x1:0,y1:1,stops:n}}))}}},{key:"_renderPagerComponent",value:function(){return this._itemContext.isScrollbar?this._renderScrollbar():this._renderPager(),!0}},{key:"_hover",value:function(t,e){this._lastActiveItem=t,t.hasState(KD.selected)?this._setLegendItemState(t,KD.selectedHover,e):this._setLegendItemState(t,KD.unSelectedHover,e);var i=t.getChildren()[0].find((function(t){return t.name===ZD.focus}),!1);i&&i.setAttribute("visible",!0),this._dispatchLegendEvent(qD.legendItemHover,t,e)}},{key:"_unHover",value:function(t,e){var i=!1;(t.hasState(KD.unSelectedHover)||t.hasState(KD.selectedHover))&&(i=!0),t.removeState(KD.unSelectedHover),t.removeState(KD.selectedHover),t.getChildren()[0].getChildren().forEach((function(t){i||!t.hasState(KD.unSelectedHover)&&!t.hasState(KD.selectedHover)||(i=!0),t.removeState(KD.unSelectedHover),t.removeState(KD.selectedHover)}));var n=t.getChildren()[0].find((function(t){return t.name===ZD.focus}),!1);n&&n.setAttribute("visible",!1),i&&this._dispatchLegendEvent(qD.legendItemAttributeUpdate,t,e),this._dispatchLegendEvent(qD.legendItemUnHover,t,e)}},{key:"_setLegendItemState",value:function(t,e,i){var n=!1;t.hasState(e)||(n=!0),t.addState(e,!0),t.getChildren()[0].getChildren().forEach((function(t){t.name!==ZD.focus&&(n||t.hasState(e)||(n=!0),t.addState(e,!0))})),n&&this._dispatchLegendEvent(qD.legendItemAttributeUpdate,t,i)}},{key:"_removeLegendItemState",value:function(t,e,i){var n=!1;e.forEach((function(e){!n&&t.hasState(e)&&(n=!0),t.removeState(e)})),t.getChildren()[0].getChildren().forEach((function(t){t.name!==ZD.focus&&e.forEach((function(e){!n&&t.hasState(e)&&(n=!0),t.removeState(e)}))})),n&&this._dispatchLegendEvent(qD.legendItemAttributeUpdate,t,i)}},{key:"_getSelectedLegends",value:function(){var t,e=[];return null===(t=this._itemsContainer)||void 0===t||t.getChildren().forEach((function(t){t.hasState(KD.selected)&&e.push(t.data)})),e}},{key:"_appendDataToShape",value:function(t,e,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};t.name=e,t.data=i,t.delegate=n,t.states=ft({},eO,r)}},{key:"_dispatchLegendEvent",value:function(t,e,i){var n=this._getSelectedLegends();n.sort((function(t,e){return t.index-e.index}));var r=n.map((function(t){return t.label}));this._dispatchEvent(t,{item:e,data:e.data,selected:e.hasState(KD.selected),currentSelectedItems:n,currentSelected:r,event:i})}},{key:"_handleStyle",value:function(t,e,i,n,r){var a={};return t.style&&(H(t.style)?a.style=t.style(e,i,n,r):a.style=t.style),t.state&&(a.state={},Object.keys(t.state).forEach((function(o){t.state[o]&&(H(t.state[o])?a.state[o]=t.state[o](e,i,n,r):a.state[o]=t.state[o])}))),a}},{key:"release",value:function(){y(e,"release",this,3)([]),this.removeAllEventListeners()}}])}(JD);function rO(t){return X(t)?t:[t,t]}function aO(t){return t?"ew-resize":"ns-resize"}nO.defaultAttributes={layout:"horizontal",title:{align:"start",space:12,textStyle:{fontSize:12,fontWeight:"bold",fill:"#2C3542"}},item:{spaceCol:16,spaceRow:8,shape:{space:8,style:{size:10,cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{opacity:.5}}},label:{space:8,style:{fontSize:12,fill:"#2C3542",cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{fill:"#D8D8D8"}}},value:{alignRight:!1,style:{fontSize:12,fill:"#ccc",cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{fill:"#D8D8D8"}}},background:{style:{cursor:"pointer"}},focus:!1,focusIconStyle:{size:10,symbolType:"M8 1C11.866 1 15 4.13401 15 8C15 11.866 11.866 15 8 15C4.13401 15 1 11.866 1 8C1 4.13401 4.13401 1 8 1ZM8.75044 2.55077L8.75 3.75H7.25L7.25006 2.5507C4.81247 2.88304 2.88304 4.81247 2.5507 7.25006L3.75 7.25V8.75L2.55077 8.75044C2.8833 11.1878 4.81264 13.117 7.25006 13.4493L7.25 12.25H8.75L8.75044 13.4492C11.1876 13.1167 13.1167 11.1876 13.4492 8.75044L12.25 8.75V7.25L13.4493 7.25006C13.117 4.81264 11.1878 2.8833 8.75044 2.55077ZM8 5.5C9.38071 5.5 10.5 6.61929 10.5 8C10.5 9.38071 9.38071 10.5 8 10.5C6.61929 10.5 5.5 9.38071 5.5 8C5.5 6.61929 6.61929 5.5 8 5.5ZM8 7C7.44772 7 7 7.44772 7 8C7 8.55228 7.44772 9 8 9C8.55228 9 9 8.55228 9 8C9 7.44772 8.55228 7 8 7Z",fill:"#333",cursor:"pointer"}},autoPage:!0,pager:{space:12,handler:{style:{size:10},space:4}},hover:!0,select:!0,selectMode:"multiple",allowAllCanceled:!0},function(t){t.innerView="innerView",t.railContainer="sliderRailContainer",t.rail="sliderRail",t.startText="sliderStartText",t.endText="sliderEndText",t.startHandler="sliderStartHandler",t.startHandlerText="startHandlerText",t.endHandler="sliderEndHandler",t.endHandlerText="sliderEndHandlerText",t.track="sliderTrack",t.trackContainer="sliderTrackContainer"}(iO||(iO={})),QD();var oO=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:ft({},e.defaultAttributes,t)])).name="slider",a._isHorizontal=!0,a._startHandler=null,a._endHandler=null,a._startHandlerText=null,a._endHandlerText=null,a._currentHandler=null,a._currentValue={},a._onTooltipShow=function(t){a._isChanging||a._tooltipState&&a._tooltipState.isActive||(a._tooltipState?a._tooltipState.isActive=!0:a._tooltipState={isActive:!0},a._onTooltipUpdate(t),a._dispatchTooltipEvent("sliderTooltipShow"))},a._onTooltipUpdate=function(t){if(!a._isChanging&&a._tooltipState&&a._tooltipState.isActive){var e=a._isHorizontal?a._rail.globalAABBBounds.width():a._rail.globalAABBBounds.height(),i=Ut(a._isHorizontal?(t.viewX-a._rail.globalAABBBounds.x1)/e:(t.viewY-a._rail.globalAABBBounds.y1)/e,0,1);i!==a._tooltipState.pos&&(a._tooltipState.pos=i,a._tooltipState.value=a.calculateValueByPos(i*e),a._updateTooltip(),a._dispatchTooltipEvent("sliderTooltipUpdate"))}},a._onTooltipHide=function(){var t=a.attribute.tooltip;t&&t.alwaysShow||(a._tooltipState=null,a._tooltipShape&&a._tooltipShape.setAttribute("visible",!1),a._tooltipText&&a._tooltipText.setAttribute("visible",!1),a._dispatchTooltipEvent("sliderTooltipHide"))},a._onHandlerPointerdown=function(t){a._clearAllDragEvents(),a._isChanging=!0;var e=a.stage.eventPointTransform(t),i=e.x,n=e.y;a._currentHandler=t.target,a._prePos=a._isHorizontal?i:n;var r=VP(),o="browser"===ex.env?ex:a.stage;o.addEventListener("pointermove",a._onHandlerPointerMove,{capture:!0}),r.forEach((function(t){o.addEventListener(t,a._onHandlerPointerUp)}))},a._onHandlerPointerMove=function(t){var e,i;a._isChanging=!0;var n=a.attribute,r=n.railWidth,o=n.railHeight,s=n.min;if(n.max!==s){var l,u,c,h=a.stage.eventPointTransform(t),d=h.x,p=h.y,f=0;a._isHorizontal?(f=(l=d)-a._prePos,u=null===(i=a._currentHandler)||void 0===i?void 0:i.attribute.x,c=r):(f=(l=p)-a._prePos,u=null===(e=a._currentHandler)||void 0===e?void 0:e.attribute.y,c=o);var v=Ut(u+f,0,c),g=a.calculateValueByPos(v);"text"===a._currentHandler.type?a._updateHandlerText(a._currentHandler,v,g):a._updateHandler(a._currentHandler,v,g),a._updateTrack(),a._prePos=l,a._dispatchChangeEvent()}},a._onHandlerPointerUp=function(t){a._isChanging=!1,a._currentHandler=null,a._clearAllDragEvents()},a._handleTouchMove=function(t){a._isChanging&&t.preventDefault()},a._onTrackPointerdown=function(t){a._clearAllDragEvents(),a._isChanging=!0;var e=a.stage.eventPointTransform(t),i=e.x,n=e.y;a._prePos=a._isHorizontal?i:n;var r=VP(),o="browser"===ex.env?ex:a.stage;o.addEventListener("pointermove",a._onTrackPointerMove,{capture:!0}),r.forEach((function(t){o.addEventListener(t,a._onTrackPointerUp)}))},a._onTrackPointerMove=function(t){a._isChanging=!0;var e=a.attribute,i=e.railWidth,n=e.railHeight,r=e.min,o=e.max,s=e.inverse;if(o!==r){var l,u,c,h=a._getHandlers(),d=h.startHandler,p=h.endHandler,f=a.stage.eventPointTransform(t),v=f.x,g=f.y;a._isHorizontal?(l=v,u=a._track.attribute.width,c=i):(l=g,u=a._track.attribute.height,c=n);var y=l-a._prePos;if(d){var m=a._isHorizontal?d.attribute.x:d.attribute.y,_=s?Ut(m+y,u,c):Ut(m+y,0,c-u),b=a.calculateValueByPos(_);a._updateHandler(d,_,b)}if(p){var x=a._isHorizontal?p.attribute.x:p.attribute.y,k=s?Ut(x+y,0,c-u):Ut(x+y,u,c),S=a.calculateValueByPos(k),A=null==d?void 0:d.attribute;a._updateHandler(p,k,S),a._track.setAttributes(a._isHorizontal?{x:Math.min(A.x,p.attribute.x),width:Math.abs(A.x-p.attribute.x)}:{y:Math.min(A.y,p.attribute.y),height:Math.abs(A.y-p.attribute.y)})}a._prePos=l,a._dispatchChangeEvent()}},a._onTrackPointerUp=function(t){a._isChanging=!1,a._clearAllDragEvents()},a._onRailPointerDown=function(t){a._clearAllDragEvents(),a._isChanging=!0;var e=a.attribute,i=(e.railWidth,e.railHeight,e.min);if(e.max!==i){var n,r,o,s=a._startHandler,l=a._endHandler;a._isHorizontal?(n=t.viewX-a._rail.globalAABBBounds.x1,r=null==s?void 0:s.attribute.x,o=null==l?void 0:l.attribute.x):(n=t.viewY-a._rail.globalAABBBounds.y1,r=null==s?void 0:s.attribute.y,o=null==l?void 0:l.attribute.y);var u=a.calculateValueByPos(n);if(N(o)){var c=Math.abs(n-r)>Math.abs(n-o)?l:s;a._updateHandler(c,n,u)}else a._updateHandler(s,n,u);a._updateTrack(),a._dispatchChangeEvent()}},a}return h(e,t),o(e,[{key:"track",get:function(){return this._track}},{key:"currentValue",get:function(){return this._currentValue}},{key:"startHandler",get:function(){return this._startHandler}},{key:"endHandler",get:function(){return this._endHandler}},{key:"tooltipShape",get:function(){return this._tooltipShape}},{key:"calculatePosByValue",value:function(t,e){var i,n=this.attribute,r=n.layout,a=n.railWidth,o=n.railHeight,s=n.min,l=n.max;return i=s===l?"start"===e?0:"end"===e?1:0:(t-s)/(l-s),(n.inverse?1-i:i)*("vertical"===r?o:a)}},{key:"calculateValueByPos",value:function(t){var e=this.attribute,i=e.layout,n=e.railWidth,r=e.railHeight,a=e.min,o="vertical"===i?r:n;return a+(e.max-a)*(e.inverse?1-t/o:t/o)}},{key:"setValue",value:function(t){var e=this.attribute,i=e.min;if(e.max!==i){var n=g(xt(t),2),r=n[0],a=n[1],o=this._getHandlers(),s=o.startHandler,l=o.endHandler;s&&this._updateHandler(s,this.calculatePosByValue(r),r),l&&this._updateHandler(l,this.calculatePosByValue(a),a),this._updateTrack()}}},{key:"render",value:function(){var t,e;this.removeAllChild(!0);var i=this.attribute,n=i.layout,r=void 0===n?"horizontal":n,a=i.railWidth,o=i.railHeight,s=i.startText,l=i.endText,u=i.min,c=i.max,h=i.showHandler,d=void 0===h||h,p=i.showTooltip,f=this.attribute.value;j(f)&&(f=[u,c]),this._currentValue={startValue:rO(f)[0],endValue:rO(f)[1]};var v="horizontal"===r;this._isHorizontal=v;var g=By.group({x:0,y:0});g.name=iO.innerView,this.add(g),this._innerView=g;var y,m=0;if(s&&s.visible){(y=By.text(Object.assign({x:v?0:a/2,y:v?o/2:0,textAlign:v?"start":"center",textBaseline:v?"middle":"top",text:s.text,lineHeight:null===(t=s.style)||void 0===t?void 0:t.fontSize},s.style))).name=iO.startText,g.add(y);var _=N(s.space)?s.space:0;m+=(v?y.AABBBounds.width():y.AABBBounds.height())+_}var b=By.group({x:v?m:0,y:v?0:m});g.add(b);var x,k=By.group({x:0,y:0});if(k.name=iO.railContainer,this._railContainer=k,b.add(k),this._mainContainer=b,this._renderRail(k),m+=v?a:o,l&&l.visible){var S=N(l.space)?l.space:0;(x=By.text(Object.assign({x:v?m+S:a/2,y:v?o/2:m+S,textAlign:v?"start":"center",textBaseline:v?"middle":"top",text:l.text,lineHeight:null===(e=l.style)||void 0===e?void 0:e.fontSize},l.style))).name=iO.endText,g.add(x)}this._renderTrack(k),d&&(this._renderHandlers(b),this._bindEvents()),p&&(this._renderTooltip(),this._bindTooltipEvents())}},{key:"_renderRail",value:function(t){var e=this.attribute,i=e.railWidth,n=e.railHeight,r=e.railStyle,a="default";!1!==e.slidable&&(a="pointer");var o=By.rect(Object.assign({x:0,y:0,width:i,height:n,cursor:a},r));return o.name=iO.rail,t.add(o),this._rail=o,o}},{key:"_renderHandlers",value:function(t){var e=this.attribute,i=e.range,n=e.min,r=e.max,a=e.handlerSize,o=void 0===a?14:a,s=e.handlerStyle,l=e.handlerText,u=e.railHeight,c=e.railWidth,h=e.slidable,d=this.attribute.value;j(d)&&(d=[n,r]);var p=l&&l.visible,f=this._isHorizontal,v=g(rO(d),2),y=v[0],m=v[1],_=this.calculatePosByValue(y,i?"start":"end"),b=this._renderHandler(Object.assign({x:f?_:c/2,y:f?u/2:_,size:o,strokeBoundsBuffer:0,cursor:!1===h?"default":aO(f)},s));if(b.name=iO.startHandler,this._startHandler=b,t.add(b),this._currentValue.startPos=_,p){var x=this._renderHandlerText(y,i?"start":"end");x.name=iO.startHandlerText,t.add(x),this._startHandlerText=x}if(i){var k=this.calculatePosByValue(m,"end"),S=this._renderHandler(Object.assign({x:f?k:c/2,y:f?u/2:k,size:o,strokeBoundsBuffer:0,cursor:!1===h?"default":aO(f)},s));if(S.name=iO.endHandler,this._endHandler=S,t.add(S),this._currentValue.endPos=k,p){var A=this._renderHandlerText(m,"end");A.name=iO.endHandlerText,t.add(A),this._endHandlerText=A}}}},{key:"_renderTrack",value:function(t){var e,i,n=this.attribute,r=n.range,a=n.min,o=n.max,s=n.railHeight,l=n.railWidth,u=n.trackStyle,c=n.railStyle,h=n.slidable,d=n.value;if(j(d))r?(e=a,i=o):e=i=a;else if(r){var p=Yt(d,a,o);e=p[0],i=p[1]}else e=a,i=Ut(d,a,o);var f=this._isHorizontal;r||(e=a);var v=By.group({x:0,y:0,width:l,height:s,cornerRadius:null==c?void 0:c.cornerRadius,clip:!0,pickable:!1});v.name=iO.trackContainer;var g,y=V(r)&&!0===r.draggableTrack;g=!1===h?"default":!1===r||!1===y?"pointer":aO(f);var m=this.calculatePosByValue(e,"start"),_=this.calculatePosByValue(i,r?"end":"start"),b=By.rect(Object.assign({x:f?Math.min(m,_):0,y:f?0:Math.min(m,_),width:f?Math.abs(_-m):l,height:f?s:Math.abs(_-m),cursor:g},u));b.name=iO.track,this._track=b,v.add(b),t.add(v)}},{key:"_renderHandler",value:function(t){return By.symbol(t)}},{key:"_renderHandlerText",value:function(t,e){var i,n,r,a=this.attribute,o=a.align,s=a.handlerSize,l=void 0===s?14:s,u=a.handlerText,c=void 0===u?{}:u,h=a.railHeight,d=a.railWidth,p=a.slidable,f=this._isHorizontal,v=this.calculatePosByValue(t,e),g=null!==(i=c.space)&&void 0!==i?i:4,y={text:c.formatter?c.formatter(t):t.toFixed(null!==(n=c.precision)&&void 0!==n?n:0),lineHeight:null===(r=c.style)||void 0===r?void 0:r.lineHeight,cursor:!1===p?"default":aO(f)};return f?"top"===o?(y.textBaseline="bottom",y.textAlign="center",y.x=v,y.y=(h-l)/2-g):(y.textBaseline="top",y.textAlign="center",y.x=v,y.y=(h+l)/2+g):"left"===o?(y.textBaseline="middle",y.textAlign="end",y.x=(d-l)/2-g,y.y=v):(y.textBaseline="middle",y.textAlign="start",y.x=(d+l)/2+g,y.y=v),By.text(Object.assign(Object.assign({},y),c.style))}},{key:"_renderTooltip",value:function(){var t,e=this.attribute,i=e.tooltip,n=e.railHeight,r=e.railWidth,a=e.align;i&&i.alwaysShow?this._tooltipState={value:this._currentValue.startValue,pos:this._currentValue.startPos}:this._tooltipState=null;var o=this._isHorizontal?0:r/2,s=this._isHorizontal?n/2:0;if(i&&i.shape){var l=By.symbol(Object.assign({pickable:!1,visible:!!this._tooltipState,x:o,y:s,symbolType:"circle"},i.shapeStyle));this._tooltipShape=l,this._mainContainer.add(l)}var u=i&&i.text||{},c=null!==(t=u.space)&&void 0!==t?t:6,h={pickable:!1,visible:!!this._tooltipState,text:""};this._isHorizontal?(h.x=o,h.y="top"===a?s-n/2-c:s+n/2+c,h.textAlign="center",h.textBaseline="top"===a?"bottom":"top"):(h.y=s,h.x="left"===a?o-r/2-c:s+r/2+c,h.textAlign="left"===a?"end":"start",h.textBaseline="middle");var d=By.text(Object.assign(Object.assign({},h),u.style));this._mainContainer.add(d),this._tooltipText=d,this._tooltipState&&this._updateTooltip()}},{key:"_updateTooltip",value:function(){var t,e;if((this._tooltipShape||this._tooltipText)&&this._tooltipState){var i=this.attribute,n=i.railWidth,r=i.railHeight,a=this._isHorizontal?n:r,o=this._tooltipState.pos*a,s=this._isHorizontal?"x":"y";this._tooltipShape&&this._tooltipShape.setAttributes(l({visible:!0},s,o));var u=this.attribute.align;if(this._tooltipText){var c=this.attribute.tooltip&&this.attribute.tooltip.text||{};this._tooltipText.setAttributes(l(l({visible:!0},s,o),"text",c.formatter?c.formatter(this._tooltipState.value):this._isHorizontal||"left"!==u?"≈ ".concat(this._tooltipState.value.toFixed(null!==(e=c.precision)&&void 0!==e?e:0)):"".concat(this._tooltipState.value.toFixed(null!==(t=c.precision)&&void 0!==t?t:0)," ≈")))}}}},{key:"_bindEvents",value:function(){if(!this.attribute.disableTriggerEvent){var t=this.attribute,e=t.slidable,i=t.range;e&&(this._startHandler&&this._startHandler.addEventListener("pointerdown",this._onHandlerPointerdown),this._startHandlerText&&this._startHandlerText.addEventListener("pointerdown",this._onHandlerPointerdown),this._endHandler&&this._endHandler.addEventListener("pointerdown",this._onHandlerPointerdown),this._endHandlerText&&this._endHandlerText.addEventListener("pointerdown",this._onHandlerPointerdown),V(i)&&i.draggableTrack&&this._track.addEventListener("pointerdown",this._onTrackPointerdown),this._railContainer.addEventListener("pointerdown",this._onRailPointerDown),("browser"===ex.env?ex:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1}))}}},{key:"_bindTooltipEvents",value:function(){this.attribute.disableTriggerEvent||(this._mainContainer.addEventListener("pointerenter",this._onTooltipShow),this._mainContainer.addEventListener("pointermove",this._onTooltipUpdate),this._mainContainer.addEventListener("pointerleave",this._onTooltipHide))}},{key:"_clearAllDragEvents",value:function(){var t=this,e=VP(),i="browser"===ex.env?ex:this.stage;i.removeEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),e.forEach((function(e){i.removeEventListener(e,t._onHandlerPointerUp)})),i.removeEventListener("pointermove",this._onTrackPointerMove,{capture:!0}),e.forEach((function(e){i.removeEventListener(e,t._onTrackPointerUp)}))}},{key:"_updateTrack",value:function(){var t=this.attribute,e=t.inverse,i=t.railWidth,n=t.railHeight,r=this._startHandler,a=this._endHandler;if(this._isHorizontal){var o=null==r?void 0:r.attribute.x;if(a){var s=null==a?void 0:a.attribute.x;this._track.setAttributes({x:Math.min(o,s),width:Math.abs(o-s)})}else e?this._track.setAttributes({x:o,width:i-o}):this._track.setAttributes({width:o})}else{var l=null==r?void 0:r.attribute.y;if(a){var u=null==a?void 0:a.attribute.y;this._track.setAttributes({y:Math.min(l,u),height:Math.abs(l-u)})}else e?this._track.setAttributes({y:l,height:n-l}):this._track.setAttributes({height:l})}}},{key:"_updateHandler",value:function(t,e,i){var n,r=this._isHorizontal;t.setAttribute(r?"x":"y",e);var a=t.name===iO.startHandler?this._startHandlerText:this._endHandlerText;if(a){var o=this.attribute.handlerText,s=void 0===o?{}:o;a.setAttributes(l({text:s.formatter?s.formatter(i):i.toFixed(null!==(n=s.precision)&&void 0!==n?n:0)},r?"x":"y",e))}t.name===iO.startHandler?(this._currentValue.startValue=i,this._currentValue.startPos=e):(this._currentValue.endValue=i,this._currentValue.endPos=e)}},{key:"_updateHandlerText",value:function(t,e,i){var n,r=this._isHorizontal,a=this.attribute.handlerText,o=void 0===a?{}:a;t.setAttributes(l(l({},r?"x":"y",e),"text",o.formatter?o.formatter(i):i.toFixed(null!==(n=o.precision)&&void 0!==n?n:0)));var s=t.name===iO.startHandlerText?this._startHandler:this._endHandler;s&&s.setAttributes(l({},r?"x":"y",e)),t.name===iO.startHandlerText?(this._currentValue.startValue=i,this._currentValue.startPos=e):(this._currentValue.endValue=i,this._currentValue.endPos=e)}},{key:"_dispatchChangeEvent",value:function(){var t=!!this.attribute.range,e=this._currentValue;this._dispatchEvent("change",{value:t?[Math.min(e.endValue,e.startValue),Math.max(e.endValue,e.startValue)]:e.startValue,position:t?[Math.min(e.endPos,e.startPos),Math.max(e.endPos,e.startPos)]:e.startPos})}},{key:"_dispatchTooltipEvent",value:function(t){this._dispatchEvent("sliderTooltip",{type:t,position:this._tooltipState&&this._tooltipState.pos,value:this._tooltipState&&this._tooltipState.value})}},{key:"_getHandlers",value:function(){var t,e,i=this.attribute.inverse,n=this._startHandler,r=this._endHandler;return r?(this._isHorizontal?(!i&&r.attribute.x<(null==n?void 0:n.attribute.x)||i&&r.attribute.x>(null==n?void 0:n.attribute.x))&&(n=(t=[r,n])[0],r=t[1]):(!i&&r.attribute.y<(null==n?void 0:n.attribute.y)||i&&r.attribute.y>(null==n?void 0:n.attribute.y))&&(n=(e=[r,n])[0],r=e[1]),{startHandler:n,endHandler:r}):{startHandler:n,endHandler:r}}},{key:"release",value:function(t){y(e,"release",this,3)([t]),("browser"===ex.env?ex:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1}),this._clearAllDragEvents()}}])}(yS);oO.defaultAttributes={slidable:!0,layout:"horizontal",align:"bottom",height:8,showHandler:!0,handlerSize:14,handlerStyle:{symbolType:"circle",fill:"#fff",stroke:"#91caff",lineWidth:2},tooltip:{shapeStyle:{symbolType:"circle",fill:"#fff",stroke:"#91caff",lineWidth:2},text:{style:{fill:"#2C3542",fontSize:12}}},railStyle:{fill:"rgba(0,0,0,.04)"},trackStyle:{fill:"#91caff"},showValue:!0,valueStyle:{fill:"#2C3542",fontSize:12},startText:{style:{fill:"#2C3542",fontSize:12}},endText:{style:{fill:"#2C3542",fontSize:12}},handlerText:{visible:!0,space:4,precision:0,style:{fill:"#2C3542",fontSize:12}}},$D(),QD();var sO=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:ft({},e.defaultAttributes,t)])).name="colorLegend",a._onSliderToolipChange=function(t){var e=a._slider.tooltipShape;if(e&&t.detail&&!j(t.detail.value)){var i=a._colorScale.scale(t.detail.value);e.setAttribute("fill",i)}a.dispatchEvent(t)},a._onSliderChange=function(t){a._updateColor(),a.dispatchEvent(t)},a}return h(e,t),o(e,[{key:"setSelected",value:function(t){this._slider&&(this._slider.setValue(t),this._updateColor())}},{key:"_renderContent",value:function(){for(var t=this.attribute,e=t.colors,i=t.slidable,n=t.layout,r=t.align,a=t.min,o=t.max,s=t.value,l=t.railWidth,u=t.railHeight,c=t.showHandler,h=void 0===c||c,d=t.handlerSize,p=t.handlerStyle,f=t.railStyle,v=t.trackStyle,g=t.startText,y=t.endText,m=t.handlerText,_=t.showTooltip,b=t.tooltip,x=t.inverse,k=t.disableTriggerEvent,S=[],A=(o-a)/(e.length-1),M=0;M<e.length;M++)S.push(a+A*M);this._colorScale=(new II).domain(S,!0).range(e),this._color=this._getTrackColor();var w=new oO({x:0,y:0,range:{draggableTrack:!0},slidable:i,layout:n,align:r,min:a,max:o,value:s,railWidth:l,railHeight:u,showHandler:h,handlerSize:d,handlerStyle:p,railStyle:f,trackStyle:Object.assign({fill:this._color},v),startText:g,endText:y,handlerText:m,showTooltip:_,tooltip:b,disableTriggerEvent:k,inverse:x});this._innerView.add(w),this._slider=w,w.translateTo(0-w.AABBBounds.x1,(this._title?this._title.AABBBounds.height()+st(this.attribute,"title.space",12):0)-w.AABBBounds.y1),this._updateColor()}},{key:"_bindEvents",value:function(){this.attribute.disableTriggerEvent||this._slider&&(this._slider.addEventListener("change",this._onSliderChange),this._slider.addEventListener("sliderTooltip",this._onSliderToolipChange))}},{key:"_getTrackColor",value:function(){var t=this.attribute,e=t.colors,i=t.layout,n=t.inverse;if(!ot(e)){var r=e.length;if(1===r)return e[0];for(var a=[],o=0;o<r;o++){var s=o/(r-1);a.push({offset:s,color:e[o]})}var l="horizontal"===i,u={gradient:"linear",stops:a,x0:0,y0:0,x1:l?1:0,y1:l?0:1};return n&&(l?(u.x0=1,u.x1=0):(u.y0=1,u.y1=0)),u}}},{key:"_updateColor",value:function(){var t,e=this.attribute,i=e.layout,n=void 0===i?"horizontal":i,r=e.colors,a=e.railWidth,o=e.railHeight,s=this._slider,l=s.startHandler,u=s.endHandler,c=s.track,h=s.attribute,d=this._slider.currentValue,p=d.startValue,f=d.endValue,v=d.startPos,g=d.endPos,y=null===(t=h.handlerStyle)||void 0===t?void 0:t.fill;if(l&&!y){var m=this._colorScale.scale(p);l.setAttribute("fill",m)}if(u&&!y){var _=this._colorScale.scale(f);u.setAttribute("fill",_)}var b="horizontal"===n?a:o;if(Math.abs(v-g)!==b&&r&&r.length>1){var x=this._color.stops,k=Math.min(v,g),S=Math.max(v,g),A=k/b,M=S/b,w=M-A,T=x.filter((function(t){return t.offset>A&&t.offset<M})),C=Math.min(p,f),E=Math.max(p,f),P=this._colorScale.scale(C),R=this._colorScale.scale(E),B=[{offset:0,color:P}];T.forEach((function(t){B.push({offset:(t.offset-A)/w,color:t.color})})),B.push({offset:1,color:R}),c.setAttribute("fill",Object.assign(Object.assign({},this._color),{stops:B}))}}}])}(JD);function lO(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"bottom",e=0;return"top"===t?"\n    M".concat(e,",-6L").concat(e-3.5,",-2.5\n    v5\n    h7\n    v-5\n    Z\n"):"left"===t?"\n    M".concat((e=1)-6,",0L").concat(e-6+2.5,",-3.5\n    h5\n    v7\n    h-5\n    Z\n"):"right"===t?"\n    M".concat((e=-1)+6,",0L").concat(e+6-2.5,",-3.5\n    h-5\n    v7\n    h5\n    Z\n  "):"\n    M".concat(e,",6L").concat(e-3.5,",2.5\n    v-5\n    h7\n    v5\n    Z\n")}sO.defaultAttributes={layout:"horizontal",title:{align:"start",space:12,textStyle:{fontSize:12,fontWeight:"bold",fill:"rgba(46, 47, 50, 1)"}},handlerSize:10,handlerStyle:{fill:null,lineWidth:4,stroke:"#fff",outerBorder:{distance:2,lineWidth:1,stroke:"#ccc"}},tooltip:{shapeStyle:{lineWidth:4,stroke:"#fff"}}},$D(),QD(),gP();var uO=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:ft({},e.defaultAttributes,t)])).name="sizeLegend",a._onSliderChange=function(t){a.dispatchEvent(t)},a._onSliderToolipChange=function(t){a.dispatchEvent(t)},a}return h(e,t),o(e,[{key:"setSelected",value:function(t){this._slider&&this._slider.setValue(t)}},{key:"_renderContent",value:function(){var t=this.attribute,e=t.slidable,i=t.layout,n=t.align,r=t.min,a=t.max,o=t.value,s=t.railWidth,l=t.railHeight,u=t.showHandler,c=void 0===u||u,h=t.handlerSize,d=t.handlerStyle,p=t.railStyle,f=t.trackStyle,v=t.startText,g=t.endText,y=t.handlerText,m=t.showTooltip,_=t.tooltip,b=t.sizeBackground,x=t.disableTriggerEvent,k=t.inverse,S=By.group({x:0,y:0});this._innerView.add(S);var A=new oO({x:0,y:0,zIndex:1,range:{draggableTrack:!0},slidable:e,layout:i,align:n,min:r,max:a,value:o,railWidth:s,railHeight:l,showHandler:c,handlerSize:h,handlerStyle:Object.assign({symbolType:lO(n)},d),railStyle:p,trackStyle:f,startText:v,endText:g,handlerText:y,showTooltip:m,tooltip:_,disableTriggerEvent:x,inverse:k});S.add(A);var M,w=0;"horizontal"===i?"top"===n?(M="M0,0L".concat(s,",0L").concat(k?0:s,",12Z"),w=l):(M="M0,12L".concat(s,",12L").concat(k?0:s,",0Z"),A.setAttribute("y",12)):"left"===n?M="M".concat(s,",0L").concat(s+12,",").concat(k?0:l,"L").concat(s,",").concat(l,"Z"):(M="M0,".concat(k?0:l,"L12,").concat(l,"L12,0Z"),A.setAttribute("x",12));var T=By.path(Object.assign(Object.assign({x:0,y:w,path:M},b),{zIndex:0}));S.add(T);var C=this._title?this._title.AABBBounds.height()+st(this.attribute,"title.space",12):0;S.translate(0-S.AABBBounds.x1,C-S.AABBBounds.y1),this._slider=A}},{key:"_bindEvents",value:function(){this.attribute.disableTriggerEvent||this._slider&&(this._slider.addEventListener("change",this._onSliderChange),this._slider.addEventListener("sliderTooltip",this._onSliderToolipChange))}}])}(JD);uO.defaultAttributes={layout:"horizontal",title:{align:"start",space:12,textStyle:{fontSize:12,fontWeight:"bold",fill:"rgba(46, 47, 50, 1)"}},handlerSize:10,handlerStyle:{lineWidth:1,stroke:"#ccc",fill:"#fff"},sizeBackground:{fill:"rgba(20,20,20,0.1)"}},cP(),BP(),wP();var cO=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:ft({},e.defaultAttributes,t)])).name="title",a}return h(e,t),o(e,[{key:"render",value:function(){var t,e,i,n,r,a,o,s,l,u,c,h,d,p,f,v,g,y,m,_,b=this.attribute,x=b.textType,k=b.text,S=b.subtextType,A=b.textStyle,M=void 0===A?{}:A,w=b.subtext,T=b.subtextStyle,C=void 0===T?{}:T,E=b.width,P=b.height,R=b.minWidth,B=b.maxWidth,I=b.minHeight,L=b.maxHeight,D=b.align,O=b.verticalAlign,F=b.padding,z=Ei(void 0===F?0:F),H=this.createOrUpdateChild("title-container",{x:z[3],y:z[0],zIndex:1},"group"),j=null!==(t=M.height)&&void 0!==t?t:P;if(!1!==this.attribute.visible&&!1!==M.visible){var V=M.width,W=M.maxHeight,G=M.maxWidth,U=M.x,Y=void 0===U?0:U,K=M.y,q=void 0===K?0:K,Z=M.ellipsis,J=void 0===Z||Z,Q=M.wordBreak,$=void 0===Q?"break-word":Q,tt=M.maxWidth,et=M.lineClamp;if("rich"===x||N(M.character)){var it=Object.assign({x:Y,y:q,width:null!==(e=null!=V?V:E)&&void 0!==e?e:0,height:null!=j?j:0,ellipsis:null==J||J,wordBreak:null!=$?$:"break-word",maxHeight:null!=W?W:L,maxWidth:null!=G?G:tt,textConfig:null!==(i=M.character)&&void 0!==i?i:k},M);this._mainTitle=H.createOrUpdateChild("mainTitle",it,"richtext")}else if("html"===x){var nt=Object.assign({html:Object.assign(Object.assign({dom:k},jP),M),x:Y,y:q,width:null!==(n=null!=V?V:E)&&void 0!==n?n:0,height:null!=j?j:0,ellipsis:J,wordBreak:$,maxHeight:null!=W?W:L,maxWidth:null!=G?G:tt,textConfig:[]},M);this._mainTitle=H.createOrUpdateChild("mainTitle",nt,"richtext")}else N(k)&&(this._mainTitle=H.createOrUpdateChild("mainTitle",Object.assign(Object.assign({text:X(k)?k:[k],whiteSpace:"normal"},M),{maxLineWidth:null!==(a=null!==(r=M.maxLineWidth)&&void 0!==r?r:V)&&void 0!==a?a:E,heightLimit:null!==(o=M.height)&&void 0!==o?o:L,lineClamp:et,ellipsis:J,x:Y,y:q}),"text"))}var rt=this._mainTitle?this._mainTitle.AABBBounds.height():0,at=this._mainTitle?this._mainTitle.AABBBounds.width():0;if(!1!==this.attribute.visible&&!1!==C.visible){var ot=C.width,st=C.height,lt=C.maxWidth,ut=C.maxHeight,ct=C.x,ht=void 0===ct?0:ct,dt=C.y,pt=void 0===dt?0:dt,ft=C.ellipsis,vt=void 0===ft||ft,gt=C.wordBreak,yt=void 0===gt?"break-word":gt,mt=C.lineClamp,_t=Math.max(Number.MIN_VALUE,L-rt);if("rich"===S||N(C.character)){var bt=Object.assign({x:ht,y:pt,width:null!==(s=null!=ot?ot:E)&&void 0!==s?s:0,height:null!==(l=null!=st?st:P)&&void 0!==l?l:0,ellipsis:vt,wordBreak:yt,maxHeight:null!=ut?ut:_t,maxWidth:null!=lt?lt:B,textConfig:null!==(u=C.character)&&void 0!==u?u:w},C);this._subTitle=H.createOrUpdateChild("subTitle",bt,"richtext")}else if("html"===S){var xt=Object.assign({html:Object.assign(Object.assign({dom:w},jP),C),x:ht,y:pt,width:null!==(c=null!=ot?ot:E)&&void 0!==c?c:0,height:null!==(h=null!=st?st:P)&&void 0!==h?h:0,ellipsis:vt,wordBreak:yt,maxHeight:null!=ut?ut:_t,maxWidth:null!=lt?lt:B,textConfig:[]},C);this._subTitle=H.createOrUpdateChild("subTitle",xt,"richtext")}else N(w)&&(this._subTitle=H.createOrUpdateChild("subTitle",Object.assign(Object.assign({text:X(w)?w:[w],whiteSpace:"normal"},C),{maxLineWidth:null!==(d=C.maxLineWidth)&&void 0!==d?d:E,heightLimit:null!==(p=C.heightLimit)&&void 0!==p?p:_t,lineClamp:mt,ellipsis:vt,x:0,y:rt}),"text"))}var kt=this._subTitle?this._subTitle.AABBBounds.height():0,St=this._subTitle?this._subTitle.AABBBounds.width():0,At=Math.max(at,St),Mt=rt+(null!==(f=C.height)&&void 0!==f?f:kt);if(N(E)&&(At=E),N(P)&&(Mt=P),N(R)&&At<R&&(At=R),N(B)&&At>B&&(At=B),N(I)&&Mt<I&&(Mt=I),N(L)&&Mt>L&&(Mt=L),H.attribute.width=At,H.attribute.height=Mt,H.attribute.boundsPadding=z,this._mainTitle){if(N(D)||N(M.align)){var wt=M.align?M.align:D,Tt=null!==(v=M.width)&&void 0!==v?v:At;"center"===wt?(this._mainTitle.setAttribute("x",Tt/2),this._mainTitle.setAttribute("textAlign","center")):"right"===wt?(this._mainTitle.setAttribute("x",Tt),this._mainTitle.setAttribute("textAlign","right")):(this._mainTitle.setAttribute("x",0),this._mainTitle.setAttribute("textAlign","left"))}var Ct=M.verticalAlign?M.verticalAlign:O,Et=null!=j?j:this._mainTitle.AABBBounds.empty()?0:this._mainTitle.AABBBounds.height();"middle"===Ct?(this._mainTitle.setAttribute("y",Et/2),this._mainTitle.setAttribute("textBaseline","middle")):"bottom"===Ct?(this._mainTitle.setAttribute("y",Et),this._mainTitle.setAttribute("textBaseline","bottom")):(this._mainTitle.setAttribute("y",0),this._mainTitle.setAttribute("textBaseline","top"))}if(this._subTitle){if(N(D)||N(C.align)){var Pt=C.align?C.align:D,Rt=null!==(y=null!==(g=C.width)&&void 0!==g?g:M.width)&&void 0!==y?y:At;"center"===Pt?(this._subTitle.setAttribute("x",Rt/2),this._subTitle.setAttribute("textAlign","center")):"right"===Pt?(this._subTitle.setAttribute("x",Rt),this._subTitle.setAttribute("textAlign","right")):(this._subTitle.setAttribute("x",0),this._subTitle.setAttribute("textAlign","left"))}var Bt=C.verticalAlign?C.verticalAlign:O,It=this._mainTitle?N(j)?this._mainTitle.AABBBounds.y1+Math.max(this._mainTitle.AABBBounds.empty()?0:this._mainTitle.AABBBounds.height(),j):this._mainTitle.AABBBounds.y2:0,Lt=null!==(_=null!==(m=C.height)&&void 0!==m?m:P)&&void 0!==_?_:this._subTitle.AABBBounds.empty()?0:this._subTitle.AABBBounds.height();"middle"===Bt?(this._subTitle.setAttribute("y",It+Lt/2),this._subTitle.setAttribute("textBaseline","middle")):"bottom"===Bt?(this._subTitle.setAttribute("y",It+Lt),this._subTitle.setAttribute("textBaseline","bottom")):(this._subTitle.setAttribute("y",It),this._subTitle.setAttribute("textBaseline","top"))}}}])}(yS);cO.defaultAttributes={textStyle:{ellipsis:"...",fill:"#333",fontSize:20,fontWeight:"bold",textAlign:"left",textBaseline:"top"},subtextStyle:{ellipsis:"...",fill:"#6F6F6F",fontSize:16,fontWeight:"normal",textAlign:"left",textBaseline:"top"}};var hO={title:{style:{text:"",fontSize:20,fill:"black",fontWeight:"normal",fillOpacity:1,textBaseline:"top",textAlign:"center"}},content:{style:{text:"",fontSize:16,fill:"black",fontWeight:"normal",fillOpacity:1,textBaseline:"top",textAlign:"center"}}};cP(),BP(),wP();var dO,pO,fO=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).name="indicator",t}return h(e,t),o(e,[{key:"_renderText",value:function(t,e,i,n,r,a){if(!1!==e.visible){var o=ft({},st(hO,r),e.style,{visible:e.visible});o.lineHeight=N(o.lineHeight)?o.lineHeight:o.fontSize,e.formatMethod&&(o._originText=o.text,o.text=e.formatMethod(o.text,o));var s=pR(o);return s.name=a,t.appendChild(s),e.autoFit&&Q(i)&&this._setLocalAutoFit(i,s,e),e.autoLimit&&Q(n)&&s.setAttribute("maxLineWidth",i),s}}},{key:"render",value:function(){var t,e,i=this;if(this.removeAllChild(!0),!0===this.attribute.visible){var n=this.attribute,r=n.title,a=void 0===r?{}:r,o=n.content,s=n.size,l=n.limitRatio,u=void 0===l?1/0:l,c=Math.min(s.width,s.height)*u,h=this.createOrUpdateChild("indicator-container",{x:0,y:0,zIndex:1,pickable:null===(t=this.attribute.pickable)||void 0===t||t},"group");if(N(a)&&(this._title=this._renderText(h,a,c,u,"title.style","indicator-title")),N(o)){var d=xt(o),p=[];d.forEach((function(t,e){!1!==t.visible&&p.push(i._renderText(h,t,c,u,"content.style","indicator-content-"+e))})),this._content=p}this._setGlobalAutoFit(c),this._setYPosition();var f=null!==(e=null==h?void 0:h.AABBBounds.height())&&void 0!==e?e:0;h.setAttribute("y",s.height/2-f/2),h.setAttribute("x",s.width/2)}}},{key:"_setLocalAutoFit",value:function(t,e,i){var n,r,a,o,s,l,u,c,h;if("default"===(null!==(n=i.fitStrategy)&&void 0!==n?n:"default")){var d=cR(null!==(a=null===(r=i.style)||void 0===r?void 0:r.text)&&void 0!==a?a:"",null!==(o=i.style)&&void 0!==o?o:{},null===(l=null===(s=this.stage)||void 0===s?void 0:s.getTheme())||void 0===l?void 0:l.text).width;if(d>0){var p=t*(null!==(u=i.fitPercent)&&void 0!==u?u:.5)/d,f=Math.floor((null!==(h=null===(c=i.style)||void 0===c?void 0:c.fontSize)&&void 0!==h?h:20)*p);e.setAttribute("fontSize",f),e.setAttribute("lineHeight",N(i.style.lineHeight)?i.style.lineHeight:f)}}}},{key:"_setGlobalAutoFit",value:function(t){var e,i,n,r,a,o,s,l=this,u=t/2,c=[],h=0,d=null!==(e=this.attribute.title)&&void 0!==e?e:{};d.autoFit&&"inscribed"===d.fitStrategy?(this._title.setAttribute("fontSize",12),c.push({text:this._title,spec:null!==(i=this.attribute.title)&&void 0!==i?i:{}})):h+=null!==(o=null===(a=null===(r=null===(n=this._title)||void 0===n?void 0:n.AABBBounds)||void 0===r?void 0:r.height)||void 0===a?void 0:a.call(r))&&void 0!==o?o:0;var p=null!==(s=d.space)&&void 0!==s?s:0;if(h+=p,xt(this.attribute.content).filter((function(t){return!1!==t.visible})).forEach((function(t,e){var i,n,r,a,o=l._content[e];t.autoFit&&"inscribed"===t.fitStrategy?(o.setAttribute("fontSize",12),c.push({text:o,spec:t})):h+=null!==(r=null===(n=null===(i=null==o?void 0:o.AABBBounds)||void 0===i?void 0:i.height)||void 0===n?void 0:n.call(i))&&void 0!==r?r:0;var s=null!==(a=t.space)&&void 0!==a?a:0;h+=s})),!(c.length<=0)){var f=12/c.reduce((function(t,e){return Math.max(t,e.text.AABBBounds.width())}),0)*c.length,v=h/2,g=Math.pow(f,2)+1,y=2*v*f,m=Math.pow(v,2)-Math.pow(u,2),_=2*(f*((-y+Math.sqrt(Math.pow(y,2)-4*g*m))/(2*g))+v),b=(_-h)/c.length;Q(_)&&c.forEach((function(t){var e,i=null===(e=t.spec.style)||void 0===e?void 0:e.lineHeight;t.text.setAttribute("fontSize",b),t.text.setAttribute("lineHeight",N(i)?i:b)}))}}},{key:"_setYPosition",value:function(){var t,e,i,n,r,a,o=this,s=0,l=null!==(n=null===(i=null===(e=null===(t=this._title)||void 0===t?void 0:t.AABBBounds)||void 0===e?void 0:e.height)||void 0===i?void 0:i.call(e))&&void 0!==n?n:0,u=null!==(a=null===(r=this.attribute.title)||void 0===r?void 0:r.space)&&void 0!==a?a:0;xt(this.attribute.content).filter((function(t){return!1!==t.visible})).forEach((function(t,e){var i,n=o._content[e];n.setAttribute("y",l+u+s);var r=null!==(i=t.space)&&void 0!==i?i:0;s+=n.AABBBounds.height()+r}))}}])}(yS),vO=function(t){function e(t){return r(this,e),n(this,e,[t])}return h(e,t),o(e)}(jg);!function(t){t.OnPlay="onPlay",t.OnPause="onPause",t.OnForward="onForward",t.OnBackward="onBackward"}(dO||(dO={})),function(t){t.Start="start",t.Pause="pause",t.Forward="forward",t.Backward="backward"}(pO||(pO={}));var gO=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:ft({},e.defaultAttributes,t)]))._isPaused=!0,a.updateAttributes=function(){a._startAttr={style:Object.assign(Object.assign(Object.assign({symbolType:"M 414.5 0.0238 c 228.9128 0 414.4762 185.5634 414.4762 414.4762 s -185.5634 414.4762 -414.4762 414.4762 S 0.0238 643.4128 0.0238 414.5 S 185.5872 0.0238 414.5 0.0238 z m 0 73.1429 C 225.9865 73.1667 73.1667 225.9865 73.1667 414.5 s 152.8198 341.3333 341.3333 341.3333 s 341.3333 -152.8198 341.3333 -341.3333 S 603.0135 73.1667 414.5 73.1667 z m -73.1429 161.4994 a 48.7619 48.7619 0 0 1 25.9901 7.5093 l 201.7524 127.1223 a 48.7619 48.7619 0 0 1 0.3657 82.2613 l -201.7524 129.6335 A 48.7619 48.7619 0 0 1 292.5952 540.1838 v -256.7314 a 48.7619 48.7619 0 0 1 48.7619 -48.7619 z m 24.381 92.9402 v 167.9116 l 131.9497 -84.7726 L 365.7381 327.6063 z"},e.defaultControllerAttr),{visible:a.attribute.start.visible}),a.attribute.start.style)},a._pauseAttr={style:Object.assign(Object.assign(Object.assign({symbolType:"M 414.5 0.0238 c 228.9128 0 414.4762 185.5634 414.4762 414.4762 s -185.5634 414.4762 -414.4762 414.4762 S 0.0238 643.4128 0.0238 414.5 S 185.5872 0.0238 414.5 0.0238 z m 0 73.1429 C 225.9865 73.1667 73.1667 225.9865 73.1667 414.5 s 152.8198 341.3333 341.3333 341.3333 s 341.3333 -152.8198 341.3333 -341.3333 S 603.0135 73.1667 414.5 73.1667 z m -48.7619 195.0476 v 316.9524 h -73.1429 V 268.2143 h 73.1429 z m 158.4762 0 v 316.9524 h -73.1429 V 268.2143 h 73.1429 z"},e.defaultControllerAttr),{visible:a.attribute.pause.visible}),a.attribute.pause.style)},a._forwardAttr={style:Object.assign(Object.assign(Object.assign({},e.defaultControllerAttr),{visible:a.attribute.forward.visible}),a.attribute.forward.style)},a._backwardAttr={style:Object.assign(Object.assign(Object.assign({},e.defaultControllerAttr),{visible:a.attribute.backward.visible}),a.attribute.backward.style)},a.updateLayout()},a.updateLayout=function(){var t,e,i,n;a._layout=a.attribute.layout,"horizontal"===a._layout?(a._backwardAttr.style.symbolType=null!==(t=a._backwardAttr.style.symbolType)&&void 0!==t?t:"M 521.29 734.276 L 230.929 448.019 L 521.29 161.762 c 37.685 -37.153 38.003 -97.625 0.707 -134.384 c -37.297 -36.758 -98.646 -36.435 -136.331 0.718 l -357.43 352.378 c -0.155 0.153 -0.297 0.314 -0.451 0.468 c -0.084 0.082 -0.172 0.157 -0.256 0.239 c -18.357 18.092 -27.581 41.929 -27.743 65.902 c -0.004 0.311 -0.017 0.623 -0.018 0.934 c 0.001 0.316 0.014 0.632 0.018 0.948 c 0.165 23.97 9.389 47.803 27.743 65.892 c 0.083 0.082 0.171 0.157 0.255 0.239 c 0.154 0.154 0.296 0.315 0.452 0.468 l 357.43 352.378 c 37.685 37.153 99.034 37.476 136.331 0.718 c 37.297 -36.758 36.979 -97.231 -0.707 -134.384 z",a._forwardAttr.style.symbolType=null!==(e=a._forwardAttr.style.symbolType)&&void 0!==e?e:"M 30 163 L 320.361 449.257 L 30 735.514 c -37.685 37.153 -38.003 97.625 -0.707 134.384 c 37.297 36.758 98.646 36.435 136.331 -0.718 l 357.43 -352.378 c 0.155 -0.153 0.297 -0.314 0.451 -0.468 c 0.084 -0.082 0.172 -0.157 0.256 -0.239 c 18.357 -18.092 27.581 -41.929 27.743 -65.902 c 0.004 -0.311 0.017 -0.623 0.018 -0.934 c -0.001 -0.316 -0.014 -0.632 -0.018 -0.948 c -0.165 -23.97 -9.389 -47.803 -27.743 -65.892 c -0.083 -0.082 -0.171 -0.157 -0.255 -0.239 c -0.154 -0.154 -0.296 -0.315 -0.452 -0.468 l -357.43 -352.378 c -37.685 -37.153 -99.034 -37.476 -136.331 -0.718 c -37.297 36.758 -36.979 97.231 0.707 134.384 z"):"vertical"===a._layout&&(a._backwardAttr.style.symbolType=null!==(i=a._backwardAttr.style.symbolType)&&void 0!==i?i:"m 161.724 521.29 l 286.257 -290.361 l 286.257 290.361 c 37.153 37.685 97.625 38.003 134.384 0.707 c 36.758 -37.297 36.435 -98.646 -0.718 -136.331 l -352.378 -357.43 c -0.153 -0.155 -0.314 -0.297 -0.468 -0.451 c -0.082 -0.084 -0.157 -0.172 -0.239 -0.256 c -18.092 -18.357 -41.929 -27.581 -65.902 -27.743 c -0.311 -0.004 -0.623 -0.017 -0.934 -0.018 c -0.316 0.001 -0.632 0.014 -0.948 0.018 c -23.97 0.165 -47.803 9.389 -65.892 27.743 c -0.082 0.083 -0.157 0.171 -0.239 0.255 c -0.154 0.154 -0.315 0.296 -0.468 0.452 l -352.378 357.43 c -37.153 37.685 -37.476 99.034 -0.718 136.331 c 36.758 37.297 97.231 36.979 134.384 -0.707 z",a._forwardAttr.style.symbolType=null!==(n=a._forwardAttr.style.symbolType)&&void 0!==n?n:"M 734.276 28.71 L 448.019 319.071 L 161.762 28.71 c -37.153 -37.685 -97.625 -38.003 -134.384 -0.707 c -36.758 37.297 -36.435 98.646 0.718 136.331 l 352.378 357.43 c 0.153 0.155 0.314 0.297 0.468 0.451 c 0.082 0.084 0.157 0.172 0.239 0.256 c 18.092 18.357 41.929 27.581 65.902 27.743 c 0.311 0.004 0.623 0.017 0.934 0.018 c 0.316 -0.001 0.632 -0.014 0.948 -0.018 c 23.97 -0.165 47.803 -9.389 65.892 -27.743 c 0.082 -0.083 0.157 -0.171 0.239 -0.255 c 0.154 -0.154 0.315 -0.296 0.468 -0.452 l 352.378 -357.43 c 37.153 -37.685 37.476 -99.034 0.718 -136.331 c -36.758 -37.297 -97.231 -36.979 -134.384 0.707 z")},a._initPlay=function(){j(a._playController)&&(a._playController=new vO(Object.assign({},a._startAttr.style)),a.add(a._playController))},a._initBackward=function(){j(a._backwardController)&&(a._backwardController=new vO(Object.assign({},a._backwardAttr.style)),a.add(a._backwardController))},a._initForward=function(){j(a._forwardController)&&(a._forwardController=new vO(Object.assign({},a._forwardAttr.style)),a.add(a._forwardController))},a._initEvents=function(){a.attribute.disableTriggerEvent||(a._playController.addEventListener("pointerdown",(function(t){t.stopPropagation(),!0===a._isPaused?a.play():a.pause()})),a._backwardController.addEventListener("pointerdown",(function(t){t.stopPropagation(),a.backward()})),a._forwardController.addEventListener("pointerdown",(function(t){t.stopPropagation(),a.forward()})))},a.renderPlay=function(){a._isPaused?a._playController.setAttributes(Object.assign({symbolType:a._playController.getComputedAttribute("symbolType")},a._startAttr.style)):a._playController.setAttributes(Object.assign({symbolType:a._playController.getComputedAttribute("symbolType")},a._pauseAttr.style))},a.renderBackward=function(){a._backwardController.setAttributes(a._backwardAttr.style)},a.renderForward=function(){a._forwardController.setAttributes(a._forwardAttr.style)},a.play=function(){a._dispatchEvent(dO.OnPlay)},a.pause=function(){a._dispatchEvent(dO.OnPause)},a.forward=function(){a._dispatchEvent(dO.OnForward)},a.backward=function(){a._dispatchEvent(dO.OnBackward)},a.togglePlay=function(){a._playController.setAttributes(a._startAttr.style),a._isPaused=!0},a.togglePause=function(){a._playController.setAttributes(a._pauseAttr.style),a._isPaused=!1},a.updateAttributes(),a._initPlay(),a._initBackward(),a._initForward(),a._initEvents(),a}return h(e,t),o(e,[{key:"render",value:function(){this.updateAttributes(),this.renderPlay(),this.renderBackward(),this.renderForward()}}])}(yS);gO.defaultControllerAttr={visible:!0,x:0,y:0,size:20,fill:"#91caff",pickMode:"imprecise",cursor:"pointer"},gO.defaultAttributes=l(l(l(l({},pO.Start,{}),pO.Pause,{}),pO.Backward,{}),pO.Forward,{});var yO,mO,_O={visible:!0,style:{x:0,y:0,dx:0,dy:0,size:20},order:0,space:10},bO=[200,10];!function(t){t.Default="default",t.Reverse="reverse"}(yO||(yO={})),function(t){t.change="change",t.play="play",t.pause="pause",t.backward="backward",t.forward="forward",t.end="end",t.OnChange="change",t.OnPlay="play",t.OnPause="pause",t.OnBackward="backward",t.OnForward="forward",t.OnEnd="end"}(mO||(mO={}));var xO=function(t){var e=t.direction,i=t.maxIndex,n=t.minIndex,r=t.dataIndex;return function(t){var e=t.direction,i=t.maxIndex,n=t.dataIndex;return e===yO.Default&&n===i}({direction:e,maxIndex:i,dataIndex:r})||function(t){var e=t.direction,i=t.minIndex,n=t.dataIndex;return e===yO.Reverse&&n===i}({direction:e,minIndex:n,dataIndex:r})},kO=function(t){var e=t.direction,i=t.maxIndex,n=t.minIndex,r=t.dataIndex;return function(t){var e=t.direction,i=t.minIndex,n=t.dataIndex;return e===yO.Default&&n===i}({direction:e,minIndex:n,dataIndex:r})||function(t){var e=t.direction,i=t.maxIndex,n=t.dataIndex;return e===yO.Reverse&&n===i}({direction:e,maxIndex:i,dataIndex:r})},SO=function(t){return"top"===t||"bottom"===t},AO=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:ft({},e.defaultAttributes,t)]))._data=[],a._dataIndex=0,a._layoutInfo={},a._updateSliderAttrs=function(){var t,e,i;Q(a._handlerStyle.size)?i=a._handlerStyle.size:a._handlerStyle.size&&a._handlerStyle.size.length&&(i=he(a._handlerStyle.size[0],a._handlerStyle.size[1]));var n={visible:a._sliderVisible,min:a._minIndex,max:a._maxIndex,value:a._dataIndex,railWidth:a._railStyle.width,railHeight:a._railStyle.height,railStyle:a._railStyle,trackStyle:a._trackStyle,handlerSize:Q(i)?i:void 0,handlerStyle:a._handlerStyle,dy:a.attribute.slider.dy,dx:a.attribute.slider.dx,slidable:!0,range:!1,handlerText:{visible:!1},startText:{visible:!1},endText:{visible:!1},disableTriggerEvent:a.attribute.disableTriggerEvent};if(SO(a._orient)){var r=Math.max(0,a._layoutInfo.slider.size),o=null!==(t=a._railStyle.height)&&void 0!==t?t:bO[1];n.layout="horizontal",n.railHeight=o,n.railWidth=r,n.x=a._layoutInfo.slider.x,n.y=a._layoutInfo.slider.y}else{var s=Math.max(0,a._layoutInfo.slider.size),l=null!==(e=a._railStyle.width)&&void 0!==e?e:bO[1];n.layout="vertical",n.railWidth=l,n.railHeight=s,n.x=a._layoutInfo.slider.x,n.y=a._layoutInfo.slider.y}return n},a._initSlider=function(){var t=a._updateSliderAttrs();a._slider=new oO(t),a._sliderVisible&&a.add(a._slider)},a._updateControllerAttrs=function(){var t={start:a._start,pause:a._pause,forward:a._forward,backward:a._backward,disableTriggerEvent:a.attribute.disableTriggerEvent};return t.layout=SO(a._orient)?"horizontal":"vertical",t.start=Object.assign(Object.assign({},t.start),{style:Object.assign(Object.assign({},t.start.style),{x:a._layoutInfo.start.x,y:a._layoutInfo.start.y})}),t.pause=Object.assign(Object.assign({},t.pause),{style:Object.assign(Object.assign({},t.pause.style),{x:a._layoutInfo.start.x,y:a._layoutInfo.start.y})}),t.backward=Object.assign(Object.assign({},t.backward),{style:Object.assign(Object.assign({},t.backward.style),{x:a._layoutInfo.backward.x,y:a._layoutInfo.backward.y})}),t.forward=Object.assign(Object.assign({},t.forward),{style:Object.assign(Object.assign({},t.forward.style),{x:a._layoutInfo.forward.x,y:a._layoutInfo.forward.y})}),t},a._initController=function(){var t=a._updateControllerAttrs();a._controller=new gO(t),a._controllerVisible&&a.add(a._controller)},a._initAttributes(),a._initDataIndex(),a._initLayoutInfo(),a._initController(),a._initSlider(),a}return h(e,t),o(e,[{key:"getMinIndex",value:function(){return this._minIndex}},{key:"getMaxIndex",value:function(){return this._maxIndex}},{key:"getDataIndex",value:function(){return this._dataIndex}},{key:"_initAttributes",value:function(){this._size=this.attribute.size,this._orient=this.attribute.orient,this._data=this.attribute.data,this._minIndex=0,this._maxIndex=this._data.length-1;var t=this.attribute,e=t.slider,i=void 0===e?{}:e,n=t.controller,r=void 0===n?{}:n;this._sliderVisible=i.visible,this._railStyle=Object.assign({},i.railStyle),this._trackStyle=Object.assign({},i.trackStyle),this._handlerStyle=Object.assign({},i.handlerStyle),this._controllerVisible=r.visible,this._start=Object.assign({},r.start),this._pause=Object.assign({},r.pause),this._forward=Object.assign({},r.forward),this._backward=Object.assign({},r.backward)}},{key:"_initDataIndex",value:function(){var t;this._dataIndex=null!==(t=this.attribute.dataIndex)&&void 0!==t?t:0}},{key:"_initLayoutInfo",value:function(){var t,e,i,n=this,r=[this._start,this._backward,this._forward].sort((function(t,e){return t.order-e.order})),a=r.filter((function(t){return"end"!==t.position})),o=r.filter((function(t){return"end"===t.position})),s=null!==(t=SO(this._orient)?this._railStyle.height:this._railStyle.width)&&void 0!==t?t:bO[1],l=r.reduce((function(t,e){var i=e.style.size,n=Z(i)?i:he(i[0],i[1]);return t+e.space+n}),0),u=this._sliderVisible?(SO(this._orient)?null===(e=this._size)||void 0===e?void 0:e.width:null===(i=this._size)||void 0===i?void 0:i.height)-l:0,c=u-this.attribute.slider.space,h=a.reduce((function(t,e){var i=e.key,r=e.space,a=e.style.size,o=Z(a)?a:he(a[0],a[1]);return n._layoutInfo[i]=Object.assign(Object.assign({},n._layoutInfo[i]),{size:o,x:SO(n._orient)?t+r:(n._size.width-o)/2,y:SO(n._orient)?(n._size.height-o)/2:t+r}),t+r+o}),0);this._layoutInfo.slider=Object.assign(Object.assign({},this._layoutInfo.slider),{size:c,x:SO(this._orient)?h+this.attribute.slider.space:(this._size.width-s)/2,y:SO(this._orient)?(this._size.height-s)/2:h+this.attribute.slider.space}),o.reduce((function(t,e){var i=e.key,r=e.space,a=e.style.size,o=Z(a)?a:he(a[0],a[1]);return n._layoutInfo[i]=Object.assign(Object.assign({},n._layoutInfo[i]),{size:o,x:SO(n._orient)?t+r:(n._size.width-o)/2,y:SO(n._orient)?(n._size.height-o)/2:t+r}),t+r+o}),h+u)}},{key:"render",value:function(){this._initLayoutInfo(),this.renderSlider(),this.renderController()}},{key:"renderSlider",value:function(){var t=this._updateSliderAttrs();this._slider.setAttributes(t)}},{key:"renderController",value:function(){var t=this._updateControllerAttrs();this._controller.setAttributes(t)}},{key:"dispatchCustomEvent",value:function(t,e){this._dispatchEvent(t,{eventType:t,index:e,value:this._data[e]})}}])}(yS);function MO(){QD(),cP(),PP()}AO.defaultAttributes={visible:!0,data:[],interval:1e3,orient:"bottom",align:"center",size:{height:20,width:300},slider:{visible:!0,space:10,dx:0,dy:0,railStyle:{cornerRadius:5},trackStyle:{},handlerStyle:{}},controller:{visible:!0,start:Object.assign(Object.assign({},_O),{key:"start",position:"start",space:0}),pause:Object.assign(Object.assign({},_O),{key:"pause",position:"start"}),forward:Object.assign(Object.assign({},_O),{key:"forward",position:"end"}),backward:Object.assign(Object.assign({},_O),{key:"backward",position:"start"})}},MO();var wO=function(t){function e(t,a){var o;return r(this,e),(o=n(this,e,[(null==a?void 0:a.skipDefault)?t:ft({},t)]))._activeIndex=-1,o._isReachEnd=!1,o._initAttributes=function(){var t,n,r;y((i(o),e),"_initAttributes",o,3)([]),o._alternate=null!==(t=o.attribute.alternate)&&void 0!==t&&t,o._interval=null!==(n=o.attribute.interval)&&void 0!==n?n:1e3,o._direction=null!==(r=o.attribute.direction)&&void 0!==r?r:yO.Default},o._initDataIndex=function(){var t;o._dataIndex=j(o.attribute.dataIndex)?"default"===o._direction?o._minIndex:o._maxIndex:null!==(t=o.attribute.dataIndex)&&void 0!==t?t:0,o._slider.setAttribute("value",o._dataIndex)},o._initEvents=function(){o.attribute.disableTriggerEvent||(o._controller.addEventListener(dO.OnPlay,(function(t){t.stopPropagation(),o.play()})),o._controller.addEventListener(dO.OnPause,(function(t){t.stopPropagation(),o.pause()})),o._controller.addEventListener(dO.OnForward,(function(t){t.stopPropagation(),o.forward()})),o._controller.addEventListener(dO.OnBackward,(function(t){t.stopPropagation(),o.backward()})),o._slider.addEventListener("change",(function(t){var e=Math.floor(t.detail.value)+.5;o._dataIndex=t.detail.value>=e?Math.ceil(t.detail.value):Math.floor(t.detail.value),o._slider.setValue(o._dataIndex),o.dispatchCustomEvent(mO.change)})))},o.play=function(){o._isPlaying||1!==o._data.length&&(o._controller.togglePause(),o._isPlaying=!0,(xO({dataIndex:o._dataIndex,maxIndex:o._maxIndex,minIndex:o._minIndex,direction:o._direction})||kO({dataIndex:o._dataIndex,maxIndex:o._maxIndex,minIndex:o._minIndex,direction:o._direction}))&&(o._direction===yO.Default?o._updateDataIndex(o._minIndex):o._updateDataIndex(o._maxIndex)),o.dispatchCustomEvent(mO.play),o._isReachEnd=!1,o._tickTime=Date.now(),o._rafId=ex.getRequestAnimationFrame()(o._play.bind(i(o),!0)))},o._play=function(t){var e=Date.now();if(o._isReachEnd&&e-o._tickTime>=o._interval)return o._isReachEnd=!1,void o._playEnd();t&&o._activeIndex!==o._dataIndex?(o.dispatchCustomEvent(mO.change),o._activeIndex=o._dataIndex):e-o._tickTime>=o._interval&&(o._tickTime=e,o._updateDataIndex(function(t,e,i,n){return"default"===t?Math.min(e+1,n):Math.max(e-1,i)}(o._direction,o._dataIndex,o._minIndex,o._maxIndex)),o._activeIndex=o._dataIndex,o.dispatchCustomEvent(mO.change)),("default"===o._direction&&o._dataIndex>=o._maxIndex||"reverse"===o._direction&&o._dataIndex<=o._minIndex)&&(o._isReachEnd=!0),o._rafId=ex.getRequestAnimationFrame()(o._play.bind(i(o),!1))},o._updateDataIndex=function(t){o._dataIndex=t,o._slider.setValue(o._dataIndex)},o._playEnd=function(){o._isPlaying=!1,o._controller.togglePlay(),ex.getCancelAnimationFrame()(o._rafId),o._activeIndex=-1,o.dispatchCustomEvent(mO.end)},o.pause=function(){o._isPlaying&&(o._isPlaying=!1,ex.getCancelAnimationFrame()(o._rafId),o._controller.togglePlay(),o.dispatchCustomEvent(mO.pause))},o.backward=function(){var t,e=o.attribute.loop;t=void 0!==e&&e?o._dataIndex-1<o._minIndex?o._maxIndex:o._dataIndex-1:Math.max(o._dataIndex-1,o._minIndex),o._updateDataIndex(t),o.dispatchCustomEvent(mO.change),o.dispatchCustomEvent(mO.backward)},o.forward=function(){var t,e=o.attribute.loop;t=void 0!==e&&e?o._dataIndex+1>o._maxIndex?o._minIndex:o._dataIndex+1:Math.min(o._dataIndex+1,o._maxIndex),o._updateDataIndex(t),o.dispatchCustomEvent(mO.change),o.dispatchCustomEvent(mO.forward)},o._initAttributes(),o._initDataIndex(),o._initEvents(),o}return h(e,t),o(e,[{key:"setAttributes",value:function(t,i){y(e,"setAttributes",this,3)([t,i]),this._initAttributes()}},{key:"dispatchCustomEvent",value:function(t){y(e,"dispatchCustomEvent",this,3)([t,this._dataIndex])}}])}(AO),TO=function(t,e,i,n){return new(i||(i=Promise))((function(r,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,s)}l((n=n.apply(t,e||[])).next())}))};MO();var CO,EO=function(t){function e(t){var a;return r(this,e),(a=n(this,e,[t]))._isPlaying=!1,a._startTime=Date.now(),a._initAttributes=function(){var t;y((i(a),e),"_initAttributes",a,3)([]),a._maxIndex=a._data.length,a._slider.setAttribute("max",a._maxIndex),a._isPlaying=!1,a._elapsed=0,a._interval=null!==(t=a.attribute.interval)&&void 0!==t?t:1e3;var n=a._data.length;a.attribute.totalDuration&&a._data.length?(a._totalDuration=a.attribute.totalDuration,a._interval=a._totalDuration/(null!=n?n:1)):(a._totalDuration=a._interval*n,a._interval=a.attribute.interval)},a._initDataIndex=function(){var t;a._dataIndex=null!==(t=a.attribute.dataIndex)&&void 0!==t?t:a._minIndex},a._initEvents=function(){a.attribute.disableTriggerEvent||(a._controller.addEventListener(dO.OnPlay,(function(t){t.stopPropagation(),a.play()})),a._controller.addEventListener(dO.OnPause,(function(t){t.stopPropagation(),a.pause()})),a._controller.addEventListener(dO.OnForward,(function(t){t.stopPropagation(),a.forward()})),a._controller.addEventListener(dO.OnBackward,(function(t){t.stopPropagation(),a.backward()})),a._slider.addEventListener("change",(function(t){var e;t.stopPropagation();var i=null===(e=t.detail)||void 0===e?void 0:e.value,n=i/a._maxIndex;a._elapsed=n*a._totalDuration,a._startTime=Date.now()-a._elapsed,a._dispatchChange(i)})))},a._getSliderValue=function(){var t=a._elapsed/a._totalDuration;return Math.min(t*a._maxIndex,a._maxIndex)},a._updateSlider=function(){var t=a._getSliderValue();a._dataIndex=Math.floor(t),a._slider.setValue(Math.min(t,a._maxIndex)),a._dispatchChange(Math.floor(t))},a._dispatchChange=function(t){var e=Math.floor(t);e!==a._activeIndex&&(a._dataIndex=e,a._activeIndex=e,e!==a._maxIndex&&a.dispatchCustomEvent(mO.change))},a.play=function(){return TO(i(a),void 0,void 0,f().mark((function t(){return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._isPlaying||(this._controller.togglePause(),this._isPlaying=!0,this._elapsed>=this._totalDuration&&(this._elapsed=0),this._startTime=Date.now()-this._elapsed,this.dispatchCustomEvent(mO.play),this._rafId=ex.getRequestAnimationFrame()(this._play.bind(this)));case 1:case"end":return t.stop()}}),t,this)})))},a._play=function(){a._elapsed=Date.now()-a._startTime;var t=a._getSliderValue();a._updateSlider(),t>=a._maxIndex?a._playEnd():a._rafId=ex.getRequestAnimationFrame()(a._play.bind(i(a)))},a._playEnd=function(){a._isPlaying=!1,ex.getCancelAnimationFrame()(a._rafId),a._controller.togglePlay(),a.dispatchCustomEvent(mO.end)},a.pause=function(){a._isPlaying&&(a._isPlaying=!1,a._elapsed=Date.now()-a._startTime,ex.getCancelAnimationFrame()(a._rafId),a._controller.togglePlay(),a.dispatchCustomEvent(mO.pause))},a.backward=function(){var t=Date.now(),e=1*a._interval,i=a._elapsed-e;i<=0?(a._elapsed=0,a._startTime=t):(a._elapsed=i,a._startTime=a._startTime+a._interval),a._updateSlider(),a.dispatchCustomEvent(mO.backward)},a.forward=function(){var t=Date.now(),e=1*a._interval,i=a._elapsed+e;i>=a._totalDuration?(a._startTime=t-a._totalDuration,a._elapsed=a._totalDuration):(a._startTime=a._startTime-e,a._elapsed=i),a._updateSlider(),a.dispatchCustomEvent(mO.forward)},a._initAttributes(),a._initDataIndex(),a._initEvents(),a}return h(e,t),o(e,[{key:"dispatchCustomEvent",value:function(t){y(e,"dispatchCustomEvent",this,3)([t,this._dataIndex])}},{key:"render",value:function(){y(e,"render",this,3)([])}}])}(AO);!function(t){t.drawStart="drawStart",t.drawEnd="drawEnd",t.drawing="drawing",t.moving="moving",t.moveStart="moveStart",t.moveEnd="moveEnd",t.brushActive="brushActive",t.brushClear="brushClear"}(CO||(CO={}));var PO={trigger:"pointerdown",updateTrigger:"pointermove",endTrigger:["pointerup","pointerleave"],resetTrigger:"pointerupoutside",hasMask:!0,brushMode:"single",brushType:"rect",brushStyle:{fill:"#B0C8F9",fillOpacity:.2,stroke:"#B0C8F9",strokeWidth:2},brushMoved:!0,removeOnClick:!0,delayType:"throttle",delayTime:10,interactiveRange:{minY:-1/0,maxY:1/0,minX:-1/0,maxX:1/0}};var RO={debounce:qt,throttle:Zt};cP(),mP();var BO=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:ft({},e.defaultAttributes,t)])).name="brush",a._activeDrawState=!1,a._cacheDrawPoints=[],a._activeMoveState=!1,a._operatingMaskMoveDx=0,a._operatingMaskMoveDy=0,a._operatingMaskMoveRangeX=[-1/0,1/0],a._operatingMaskMoveRangeY=[-1/0,1/0],a._brushMaskAABBBoundsDict={},a._firstUpdate=!0,a._onBrushStart=function(t){if(a._outOfInteractiveRange(t))a._isEmptyMask()||(a._clearMask(),a._dispatchBrushEvent(CO.brushClear,t));else{var e=a.attribute,i=e.updateTrigger,n=void 0===i?PO.updateTrigger:i,r=e.endTrigger,o=void 0===r?PO.endTrigger:r,s=e.brushMoved,l=void 0===s||s;xt(n).forEach((function(t){return a.stage.addEventListener(t,a._onBrushingWithDelay)})),xt(o).forEach((function(t){return a.stage.addEventListener(t,a._onBrushEnd)})),t.stopPropagation(),a._firstUpdate=!0,a._activeMoveState=l&&a._isPosInBrushMask(t),a._activeDrawState=!a._activeMoveState,a._startPos=a.eventPosToStagePos(t),a._cacheDrawPoints=[a._startPos]}},a._onBrushing=function(t){a._outOfInteractiveRange(t)||(t.stopPropagation(),a._firstUpdate?(a._activeDrawState&&a._initDraw(t),a._activeMoveState&&a._initMove(t),a._firstUpdate=!1):(a._activeDrawState&&a._drawing(t),a._activeMoveState&&a._moving(t)))},a._onBrushingWithDelay=0===a.attribute.delayTime?a._onBrushing:RO[a.attribute.delayType](a._onBrushing,a.attribute.delayTime),a._onBrushEnd=function(t){a._releaseBrushUpdateEvents(),t.preventDefault(),a._activeDrawState&&a._drawEnd(t),a._activeMoveState&&a._moveEnd(t),a._activeDrawState=!1,a._activeMoveState=!1},a._onBrushClear=function(t){t.preventDefault(),a._isEmptyMask()||(a._clearMask(),a._dispatchBrushEvent(CO.brushClear,t)),a._activeDrawState=!1,a._activeMoveState=!1},a}return h(e,t),o(e,[{key:"_bindBrushEvents",value:function(){var t=this;if(this.releaseBrushEvents(),!this.attribute.disableTriggerEvent){var e=this.attribute,i=e.trigger,n=void 0===i?PO.trigger:i,r=e.resetTrigger,a=void 0===r?PO.resetTrigger:r;xt(n).forEach((function(e){return t.stage.addEventListener(e,t._onBrushStart)})),xt(a).forEach((function(e){return t.stage.addEventListener(e,t._onBrushClear)}))}}},{key:"_initDraw",value:function(t){var e=this.attribute.brushMode,i=this.eventPosToStagePos(t);this._cacheDrawPoints.push(i),"single"===e&&this._clearMask(),this._addBrushMask(),this._dispatchBrushEvent(CO.drawStart,t),1===Object.keys(this._brushMaskAABBBoundsDict).length&&this._dispatchBrushEvent(CO.brushActive,t)}},{key:"_initMove",value:function(t){var e,i;this._cacheMovePoint=this.eventPosToStagePos(t),this._operatingMaskMoveDx=null!==(e=this._operatingMask.attribute.dx)&&void 0!==e?e:0,this._operatingMaskMoveDy=null!==(i=this._operatingMask.attribute.dy)&&void 0!==i?i:0;var n=this.attribute.interactiveRange,r=n.minY,a=void 0===r?-1/0:r,o=n.maxY,s=void 0===o?1/0:o,l=n.minX,u=void 0===l?-1/0:l,c=n.maxX,h=void 0===c?1/0:c,d=this._operatingMask.globalAABBBounds,p=u-d.x1,f=h-d.x2,v=a-d.y1,g=s-d.y2;this._operatingMaskMoveRangeX=[p,f],this._operatingMaskMoveRangeY=[v,g],this._operatingMask.setAttribute("pickable",!0),this._dispatchBrushEvent(CO.moveStart,t)}},{key:"_drawing",value:function(t){var e,i=this.eventPosToStagePos(t),n=this.attribute.brushType,r=this._cacheDrawPoints.length;if(r>0){var a=null!==(e=this._cacheDrawPoints[this._cacheDrawPoints.length-1])&&void 0!==e?e:{};if(i.x===a.x&&i.y===a.y)return}"polygon"===n||r<=1?this._cacheDrawPoints.push(i):this._cacheDrawPoints[r-1]=i;var o=this._computeMaskPoints();this._operatingMask.setAttribute("points",o),this._dispatchBrushEvent(CO.drawing,t)}},{key:"_moving",value:function(t){var e=this._cacheMovePoint,i=this.eventPosToStagePos(t);if(i.x!==(null==e?void 0:e.x)||i.y!==(null==e?void 0:e.y)){var n=i.x-e.x,r=i.y-e.y,a=Math.min(this._operatingMaskMoveRangeX[1],Math.max(this._operatingMaskMoveRangeX[0],n))+this._operatingMaskMoveDx,o=Math.min(this._operatingMaskMoveRangeY[1],Math.max(this._operatingMaskMoveRangeY[0],r))+this._operatingMaskMoveDy;this._operatingMask.setAttributes({dx:a,dy:o}),this._brushMaskAABBBoundsDict[this._operatingMask.name]=this._operatingMask.AABBBounds,this._dispatchBrushEvent(CO.moving,t)}}},{key:"_drawEnd",value:function(t){var e=this.attribute,i=e.removeOnClick,n=void 0===i||i,r=e.sizeThreshold,a=void 0===r?5:r;if(this._outOfInteractiveRange(t))this._isEmptyMask()||(this._clearMask(),this._dispatchBrushEvent(CO.brushClear,t));else{var o=this._startPos,s=o.x,l=o.y,u=this.eventPosToStagePos(t),c=u.x,h=u.y;Math.abs(c-s)<=1&&Math.abs(h-l)<=1&&n?this._isEmptyMask()||(this._clearMask(),this._dispatchBrushEvent(CO.brushClear,t)):Math.abs(c-s)<a&&Math.abs(l-h)<a?(delete this._brushMaskAABBBoundsDict[this._operatingMask.name],this._container.setAttributes({}),this._container.removeChild(this._operatingMask),this._isEmptyMask()&&this._dispatchBrushEvent(CO.brushClear,t)):(this._brushMaskAABBBoundsDict[this._operatingMask.name]=this._operatingMask.AABBBounds,this._dispatchBrushEvent(CO.drawEnd,t))}}},{key:"_moveEnd",value:function(t){this._operatingMask&&this._operatingMask.setAttribute("pickable",!1),this._dispatchBrushEvent(CO.moveEnd,t)}},{key:"render",value:function(){this._bindBrushEvents();var t=this.createOrUpdateChild("brush-container",{},"group");this._container=t}},{key:"releaseBrushEvents",value:function(){var t=this,e=this.attribute,i=e.trigger,n=void 0===i?PO.trigger:i,r=e.resetTrigger,a=void 0===r?PO.resetTrigger:r;xt(n).forEach((function(e){return t.stage.removeEventListener(e,t._onBrushStart)})),xt(a).forEach((function(e){return t.stage.removeEventListener(e,t._onBrushClear)})),this._releaseBrushUpdateEvents()}},{key:"_releaseBrushUpdateEvents",value:function(){var t=this,e=this.attribute,i=e.updateTrigger,n=void 0===i?PO.updateTrigger:i,r=e.endTrigger,a=void 0===r?PO.endTrigger:r;xt(n).forEach((function(e){return t.stage.removeEventListener(e,t._onBrushingWithDelay)})),xt(a).forEach((function(e){return t.stage.removeEventListener(e,t._onBrushEnd)}))}},{key:"_computeMaskPoints",value:function(){var t=this.attribute,e=t.brushType,i=t.xRange,n=void 0===i?[0,0]:i,r=t.yRange,a=void 0===r?[0,0]:r,o=this._cacheDrawPoints[0],s=this._cacheDrawPoints[this._cacheDrawPoints.length-1];return"rect"===e?[o,{x:s.x,y:o.y},s,{x:o.x,y:s.y}]:"x"===e?[{x:o.x,y:a[0]},{x:s.x,y:a[0]},{x:s.x,y:a[1]},{x:o.x,y:a[1]}]:"y"===e?[{x:n[0],y:o.y},{x:n[0],y:s.y},{x:n[1],y:s.y},{x:n[1],y:o.y}]:ct(this._cacheDrawPoints)}},{key:"_addBrushMask",value:function(){var t,e=this.attribute,i=e.brushStyle,n=e.hasMask,r=By.polygon(Object.assign(Object.assign({points:ct(this._cacheDrawPoints),cursor:"move",pickable:!1},i),{opacity:n?null!==(t=i.opacity)&&void 0!==t?t:1:0}));r.name="brush-".concat(Date.now()),this._operatingMask=r,this._container.add(r),this._brushMaskAABBBoundsDict[r.name]=r.AABBBounds}},{key:"_isPosInBrushMask",value:function(t){for(var e,i=this,n=this.eventPosToStagePos(t),r=this._container.getChildren(),a=function(){var t=r[o].attribute,e=t.points,a=void 0===e?[]:e,s=t.dx,l=void 0===s?0:s,u=t.dy,c=void 0===u?0:u,h=a.map((function(t){return{x:t.x+l,y:t.y+c}}));if(ii(h,n.x,n.y))return{v:(i._operatingMask=r[o],!0)}},o=0;o<r.length;o++)if(e=a())return e.v;return!1}},{key:"_outOfInteractiveRange",value:function(t){var e=this.attribute.interactiveRange,i=e.minY,n=void 0===i?-1/0:i,r=e.maxY,a=void 0===r?1/0:r,o=e.minX,s=void 0===o?-1/0:o,l=e.maxX,u=void 0===l?1/0:l,c=this.eventPosToStagePos(t);return c.x>u||c.x<s||c.y>a||c.y<n}},{key:"eventPosToStagePos",value:function(t){return this.stage.eventPointTransform(t)}},{key:"_dispatchBrushEvent",value:function(t,e){this._dispatchEvent(t,{operateMask:this._operatingMask,operatedMaskAABBBounds:this._brushMaskAABBBoundsDict,event:e})}},{key:"_clearMask",value:function(){this._brushMaskAABBBoundsDict={},this._container.incrementalClearChild(),this._operatingMask=null}},{key:"_isEmptyMask",value:function(){var t=this;return ot(this._brushMaskAABBBoundsDict)||Object.keys(this._brushMaskAABBBoundsDict).every((function(e){return t._brushMaskAABBBoundsDict[e].empty()}))}}])}(yS);BO.defaultAttributes=PO;var IO=function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];var r=[t.shape].concat(m(i.map((function(t){return null==t?void 0:t.shape})))),a=[t.key].concat(m(i.map((function(t){return null==t?void 0:t.key})))),o=[t.value].concat(m(i.map((function(t){return null==t?void 0:t.value}))));return ft.apply(void 0,[t].concat(i,[{shape:r.every(j)?void 0:ft.apply(void 0,[{}].concat(m(r))),key:a.every(j)?void 0:ft.apply(void 0,[{}].concat(m(a))),value:o.every(j)?void 0:ft.apply(void 0,[{}].concat(m(o)))}]))},LO=function(t){var e=t.width,i=t.height,n=t.wordBreak,r=void 0===n?"break-word":n,a=t.textAlign,o=t.textBaseline,s=t.text;return Array.isArray(s)?{width:e,height:i,wordBreak:r,textAlign:a,textBaseline:o,singleLine:!1,textConfig:xt(s).map((function(e){return Object.assign(Object.assign({},t),{text:e})}))}:{width:e,height:i,wordBreak:r,textAlign:a,textBaseline:o,singleLine:!1,textConfig:null==s?void 0:s.text}},DO={panel:{visible:!0,cornerRadius:[3,3,3,3],fill:"white",shadow:!0,shadowBlur:12,shadowColor:"rgba(0, 0, 0, 0.1)",shadowOffsetX:0,shadowOffsetY:4,shadowSpread:0,stroke:"white"},titleStyle:{value:{fill:"#4E5969",fontFamily:zP,fontSize:14,lineHeight:18,textAlign:"left",textBaseline:"middle"},spaceRow:6},contentStyle:{shape:{fill:"black",size:8,symbolType:"circle",spacing:6},key:{fill:"#4E5969",fontFamily:zP,fontSize:12,lineHeight:18,textAlign:"left",textBaseline:"middle",spacing:26},value:{fill:"#4E5969",fontFamily:zP,fontSize:12,lineHeight:18,textAlign:"right",textBaseline:"middle",spacing:0},spaceRow:6},padding:10,positionX:"right",positionY:"bottom",offsetX:10,offsetY:10,parentBounds:(new pi).setValue(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),autoCalculatePosition:!0,autoMeasure:!0,pickable:!1,childrenPickable:!1,zIndex:500},OO=["pointerX","pointerY","offsetX","offsetY","positionX","positionY","parentBounds"];cP(),kP(),PP(),BP(),wP();var FO=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[(null==i?void 0:i.skipDefault)?t:ft({},e.defaultAttributes,t),i])).name="tooltip",a}return h(e,t),o(e,[{key:"render",value:function(){var t,i=this,n=this.attribute,r=n.visible,a=n.content,o=n.panel,s=n.keyWidth,l=n.valueWidth,u=n.hasContentShape,c=n.autoCalculatePosition,h=n.autoMeasure,d=n.align;if(r){h&&e.measureTooltip(this.attribute),c&&e.calculateTooltipPosition(this.attribute);var p=Ei(this.attribute.padding);this._tooltipPanel=this.createOrUpdateChild("tooltip-background",Object.assign({visible:!0},o),"rect"),this._tooltipTitleContainer=this.createOrUpdateChild("tooltip-title",{visible:!0,x:p[3],y:p[0]},"group");var f=e.getTitleAttr(this.attribute);this._tooltipTitleSymbol=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-shape",ft({symbolType:"circle"},f.shape,{visible:ZP(f)&&ZP(f.shape)}),"symbol"),"object"!=b(f.value.text)||null===f.value.text||"rich"!==f.value.text.type&&"html"!==f.value.text.type?f.value.multiLine?this._tooltipTitle=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-value",Object.assign({visible:ZP(f)&&ZP(f.value)},LO(f.value)),"richtext"):this._tooltipTitle=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-value",Object.assign({text:null!==(t=f.value.text)&&void 0!==t?t:"",visible:ZP(f)&&ZP(f.value)},f.value),"text"):"rich"===f.value.text.type?this._tooltipTitle=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-value",Object.assign({visible:ZP(f)&&ZP(f.value)},LO(f.value)),"richtext"):"html"===f.value.text.type&&(this._tooltipTitle=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-value",Object.assign({html:Object.assign(Object.assign({dom:f.value.text.text},jP),f.value),visible:ZP(f)&&ZP(f.value),width:f.value.width,height:f.value.height,wordBreak:f.value.wordBreak,textAlign:f.value.textAlign,textBaseline:f.value.textBaseline,singleLine:!1,textConfig:[]},f.value),"richtext"));var v=ZP(f.shape)?f.shape.size+f.shape.spacing:0,g=f.value,y=g.textAlign,m=g.textBaseline,_=o.width-p[3]-p[0]-v;"center"===y?this._tooltipTitle.setAttribute("x",v+_/2):"right"===y||"end"===y?this._tooltipTitle.setAttribute("x",v+_):this._tooltipTitle.setAttribute("x",v),"bottom"===m?this._tooltipTitle.setAttribute("y",f.height):"middle"===m?this._tooltipTitle.setAttribute("y",f.height/2):this._tooltipTitle.setAttribute("y",0);var x=ZP(f)?f.height+f.spaceRow:0;if(this._tooltipContent=this.createOrUpdateChild("tooltip-content",{visible:!0},"group"),this._tooltipContent.removeAllChild(!0),a&&a.length){this._tooltipContent.setAttribute("x",p[3]),this._tooltipContent.setAttribute("y",p[0]+x);var k=0;a.forEach((function(t,n){var r=e.getContentAttr(i.attribute,n);if(ZP(r)){var a="tooltip-content-".concat(n),o=i._tooltipContent.createOrUpdateChild(a,{visible:!0,x:0,y:k},"group"),c=r.shape.size+r.shape.spacing,h="right"===d?(u?c:0)+(ZP(r.key)?s+r.key.spacing:0)+(ZP(r.value)?l:0):0;i._createShape("right"===d?h-r.shape.size/2:h+r.shape.size/2,r,o,a),u&&("right"===d?h-=c:h+=c);var p=i._createKey(r,o,a);p&&(fR(d,p,r.key.textAlign,h,s),p.setAttribute("y",0),"right"===d?h-=s+r.key.spacing:h+=s+r.key.spacing);var f=i._createValue(r,o,a);if(f){var v="right";N(r.value.textAlign)?v=r.value.textAlign:ZP(r.key)||"right"===d||(v="left"),f.setAttribute("textAlign",v),fR(d,f,v,h,l),f.setAttribute("y",0)}k+=r.height+r.spaceRow}}))}}else this.hideAll()}},{key:"_createShape",value:function(t,e,i,n){var r;if(ZP(e.shape))return i.createOrUpdateChild("".concat(n,"-shape"),Object.assign({visible:!0,x:t,y:e.shape.size/2+((null!==(r=vd(e.key.lineHeight,e.key.fontSize))&&void 0!==r?r:e.key.fontSize)-e.shape.size)/2},e.shape),"symbol")}},{key:"_createKey",value:function(t,e,i){var n;if(ZP(t.key))return t.key.multiLine?e.createOrUpdateChild("".concat(i,"-key"),Object.assign(Object.assign({visible:!0},LO(t.key)),{textBaseline:"top"}),"richtext"):"object"!=b(t.key.text)||null===t.key.text||"rich"!==t.key.text.type&&"html"!==t.key.text.type?e.createOrUpdateChild("".concat(i,"-key"),Object.assign(Object.assign({visible:!0,text:null!==(n=t.key.text)&&void 0!==n?n:""},t.key),{textBaseline:"top"}),"text"):"rich"===t.key.text.type?e.createOrUpdateChild("".concat(i,"-value"),Object.assign(Object.assign({visible:!0},LO(t.key)),{textBaseline:"top"}),"richtext"):e.createOrUpdateChild("".concat(i,"-value"),{html:Object.assign(Object.assign({dom:t.key.text.text},jP),t.key)},"richtext")}},{key:"_createValue",value:function(t,e,i){var n;if(ZP(t.value))return t.value.multiLine?e.createOrUpdateChild("".concat(i,"-value"),Object.assign(Object.assign({visible:!0},LO(t.value)),{textBaseline:"top"}),"richtext"):"object"!=b(t.value.text)||null===t.value.text||"rich"!==t.value.text.type&&"html"!==t.value.text.type?e.createOrUpdateChild("".concat(i,"-value"),Object.assign(Object.assign({visible:!0,text:null!==(n=t.value.text)&&void 0!==n?n:""},t.value),{textBaseline:"top"}),"text"):"rich"===t.value.text.type?e.createOrUpdateChild("".concat(i,"-value"),Object.assign(Object.assign({visible:!0},LO(t.value)),{textBaseline:"top"}),"richtext"):e.createOrUpdateChild("".concat(i,"-value"),{html:Object.assign({dom:t.value.text.text,container:"",width:30,height:30,style:{}},t.value)},"richtext")}},{key:"setAttributes",value:function(t,i){var n=Object.keys(t);this.attribute.autoCalculatePosition&&n.every((function(t){return OO.includes(t)}))?(this._mergeAttributes(t,n),j(this.attribute.panel.width)&&this.attribute.autoMeasure&&e.measureTooltip(this.attribute),e.calculateTooltipPosition(this.attribute),y(e,"setAttributes",this,3)([{x:this.attribute.x,y:this.attribute.y},i])):y(e,"setAttributes",this,3)([t,i])}}],[{key:"calculateTooltipPosition",value:function(t){var e=t.panel,i=e.width,n=void 0===i?0:i,r=e.height,a=void 0===r?0:r,o=t.offsetX,s=t.offsetY,l=t.pointerX,u=t.pointerY,c=t.positionX,h=t.positionY,d=t.parentBounds,p=l,f=u;return"left"===c?p-=n+o:"center"===c?p-=n/2:p+=o,"top"===h?f-=a+s:"middle"===h?f-=a/2:f+=s,p+n>d.x2&&(p-=n+o),f+a>d.y2&&(f-=a+s),p<d.x1&&(p=d.x1),f<d.y1&&(f=d.y1),t.x=p,t.y=f,t}},{key:"measureTooltip",value:function(t){var i=t.content,n=t.contentStyle,r=Ei(t.padding),a=e.getTitleAttr(t),o=0,s=r[0]+r[2],l=0,u=a.value,c=a.shape,h=null!=c?c:{},d=h.visible,p=void 0!==d&&d,f=h.symbolType,v=void 0===f?"":f;if(N(u)&&"object"!=b(a.value.text)){var y=uR(u).quickMeasure(u.text),m=y.width,_=y.height;o=m,l=_}if(p&&Of[v]&&(o+=c.size+c.spacing,l=Math.max(c.size,l)),t.title&&(t.title.width=o,t.title.height=l),ZP(a)&&(s+=l+a.spaceRow),i&&i.length){var x=[];if(i.forEach((function(i,n){var r=e.getContentAttr(t,n);(i.key||i.value)&&ZP(r)&&x.push([i,r])})),x.length){var k=!1,S=[],A=[],M=[];x.forEach((function(t,e){var i,r=g(t,2),a=r[0],o=r[1],l=o.key,u=o.value,c=o.shape,h=o.spaceRow,d=ZP(c),p=null!==(i=null==c?void 0:c.symbolType)&&void 0!==i?i:"",f=uR(l),v=uR(u),y=0;if(ZP(l)){var m=f.quickMeasure(l.text),_=m.width,b=m.height;A.push(_),y=Math.max(y,b)}if(ZP(u)){var w=v.quickMeasure(u.text),T=w.width,C=w.height;M.push(T),y=Math.max(y,C)}d&&Of[p]&&(k=!0,S.push(c.size),y=Math.max(c.size,y)),a.height=y,s+=y,e<x.length-1&&(s+=null!=h?h:n.spaceRow)}));var w=S.length?Math.max.apply(Math,S):0,T=A.length?Math.max.apply(Math,A):0,C=M.length?Math.max.apply(Math,M):0;o=Math.max(T+C+n.key.spacing+n.value.spacing+(k?w+n.shape.spacing:0),o),i.forEach((function(t){t.width=o})),t.hasContentShape=k,t.keyWidth=T,t.valueWidth=C}}return t.panel.width=o+r[1]+r[3],t.panel.height=s,t}},{key:"getTitleAttr",value:function(t){return IO({},e.defaultAttributes.titleStyle,e.defaultAttributes.title,t.titleStyle,t.title)}},{key:"getContentAttr",value:function(t,i){return IO({},e.defaultAttributes.contentStyle,t.contentStyle,t.content[i])}}])}(yS);FO.defaultAttributes=DO;var zO=Nt;function HO(t,e){var i=[];return t.forEach((function(t){var n=+t[e];Q(n)&&i.push(n)})),0===i.length?null:At(i)}function jO(t,e){var i=[];return t.forEach((function(t){var n=+t[e];Q(n)&&i.push(n)})),0===i.length?null:St(i)}function NO(t,e){return t.reduce((function(t,i){var n=e?+i[e]:+i;return Q(n)&&(t+=n),t}),0)}function VO(t,e){var i=0,n=0;return t.forEach((function(t){var r=e?+t[e]:+t;Q(r)&&(i+=r,n++)})),i/n}function WO(t,e){var i=VO(t,e);if(t.length<=1)return 0;var n=t.reduce((function(t,n){return t+Math.pow(e?+n[e]:+n-i,2)}),0);return n/(t.length-1)}function GO(t,e){var i=UO(t),n=UO(e),r=Math.asin((t.x*e.y-e.x*t.y)/i/n),a=Math.acos((t.x*e.x+t.y*e.y)/i/n);return r<0?-a:a}function UO(t,e){return void 0===e&&(e={x:0,y:0}),Me.distancePP(t,e)}function YO(t){return Q(t.x)&&Q(t.y)}function XO(t,e,i){var n,r,a,o,s=!1;if(e&&H(e))try{for(var l=C(t),u=l.next();!u.done;u=l.next()){var c=u.value;try{for(var h=(a=void 0,C(c.getSeries(i))),d=h.next();!d.done;d=h.next()){var p=d.value;if(s=!!e.call(null,p))return s}}catch(t){a={error:t}}finally{try{d&&!d.done&&(o=h.return)&&o.call(h)}finally{if(a)throw a.error}}}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}return s}function KO(t,e){var i,n,r,a,o=[];try{for(var s=C(t),l=s.next();!l.done;l=s.next()){var u=l.value;try{for(var c=(r=void 0,C(u.getSeries(e))),h=c.next();!h.done;h=c.next()){var d=h.value;o.push(d)}}catch(t){r={error:t}}finally{try{h&&!h.done&&(a=c.return)&&a.call(c)}finally{if(r)throw r.error}}}}catch(t){i={error:t}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return o}var qO,ZO,JO,QO=function(t,e){for(var i=0;i<t.length;i++)for(var n=t[i].getSeries(),r=0;r<n.length;r++){var a=n[r];if(e&&a&&a.coordinate===e)return a;if(!e&&a)return a}return null};function $O(t){return function(e){return X(t)?t.reduce((function(t,e){return null==t?void 0:t[e]}),e):null==e?void 0:e[t]}}function tF(e){var i,n;return e.type===t.SeriesTypeEnum.sankey?null!==(i=e.direction)&&void 0!==i?i:"horizontal":null!==(n=e.direction)&&void 0!==n?n:"vertical"}t.SeriesTypeForThemeEnum=void 0,(qO=t.SeriesTypeForThemeEnum||(t.SeriesTypeForThemeEnum={})).area_horizontal="area_horizontal",qO.area_vertical="area_vertical",qO.area_stack="area_stack",qO.line_horizontal="line_horizontal",qO.line_vertical="line_vertical",qO.line_stack="line_stack",qO.bar_horizontal="bar_horizontal",qO.bar_vertical="bar_vertical",qO.bar_stack="bar_stack",qO.bar3d_horizontal="bar3d_horizontal",qO.bar3d_vertical="bar3d_vertical",qO.bar3d_stack="bar3d_stack",qO.rangeColumn_horizontal="rangeColumn_horizontal",qO.rangeColumn_vertical="rangeColumn_vertical",qO.rangeColumn3d_horizontal="rangeColumn3d_horizontal",qO.rangeColumn3d_vertical="rangeColumn3d_vertical",qO.rangeArea_horizontal="rangeArea_horizontal",qO.rangeArea_vertical="rangeArea_vertical",qO.linearProgress_horizontal="linearProgress_horizontal",qO.linearProgress_vertical="linearProgress_vertical",qO.linearProgress_stack="linearProgress_stack",qO.boxPlot_horizontal="boxPlot_horizontal",qO.boxPlot_vertical="boxPlot_vertical",qO.sankey_horizontal="sankey_horizontal",qO.sankey_vertical="sankey_vertical",qO.waterfall_horizontal="waterfall_horizontal",qO.waterfall_vertical="waterfall_vertical",qO.circularProgress_stack="circularProgress_stack",qO.radar_stack="radar_stack",qO.rose_stack="rose_stack",t.SeriesTypeEnum=void 0,(ZO=t.SeriesTypeEnum||(t.SeriesTypeEnum={})).area="area",ZO.line="line",ZO.bar="bar",ZO.bar3d="bar3d",ZO.rangeColumn="rangeColumn",ZO.rangeColumn3d="rangeColumn3d",ZO.rangeArea="rangeArea",ZO.dot="dot",ZO.geo="geo",ZO.link="link",ZO.map="map",ZO.pie="pie",ZO.pie3d="pie3d",ZO.radar="radar",ZO.rose="rose",ZO.scatter="scatter",ZO.circularProgress="circularProgress",ZO.wordCloud="wordCloud",ZO.wordCloud3d="wordCloud3d",ZO.funnel="funnel",ZO.funnel3d="funnel3d",ZO.linearProgress="linearProgress",ZO.boxPlot="boxPlot",ZO.sankey="sankey",ZO.gaugePointer="gaugePointer",ZO.gauge="gauge",ZO.treemap="treemap",ZO.sunburst="sunburst",ZO.circlePacking="circlePacking",ZO.waterfall="waterfall",ZO.heatmap="heatmap",ZO.correlation="correlation",ZO.liquid="liquid",ZO.venn="venn",ZO.mosaic="mosaic",ZO.pictogram="pictogram",t.SeriesMarkNameEnum=void 0,(JO=t.SeriesMarkNameEnum||(t.SeriesMarkNameEnum={})).label="label",JO.point="point",JO.line="line",JO.area="area",JO.bar="bar",JO.bar3d="bar3d",JO.boxPlot="boxPlot",JO.outlier="outlier",JO.circlePacking="circlePacking",JO.group="group",JO.gridBackground="gridBackground",JO.grid="grid",JO.dot="dot",JO.title="title",JO.subTitle="subTitle",JO.symbol="symbol",JO.funnel="funnel",JO.funnel3d="funnel3d",JO.transform="transform",JO.transform3d="transform3d",JO.transformLabel="transformLabel",JO.outerLabel="outerLabel",JO.outerLabelLine="outerLabelLine",JO.pin="pin",JO.pinBackground="pinBackground",JO.pointer="pointer",JO.segment="segment",JO.track="track",JO.cell="cell",JO.cellBackground="cellBackground",JO.link="link",JO.arrow="arrow",JO.pie="pie",JO.pie3d="pie3d",JO.labelLine="labelLine",JO.progress="progress",JO.minLabel="minLabel",JO.maxLabel="maxLabel",JO.rose="rose",JO.node="node",JO.sunburst="sunburst",JO.nonLeaf="nonLeaf",JO.leaf="leaf",JO.nonLeafLabel="nonLeafLabel",JO.leaderLine="leaderLine",JO.stackLabel="stackLabel",JO.word="word",JO.fillingWord="fillingWord",JO.wordMask="wordMask",JO.nodePoint="nodePoint",JO.ripplePoint="ripplePoint",JO.centerPoint="centerPoint",JO.centerLabel="centerLabel",JO.barBackground="barBackground",JO.lineLabel="lineLabel",JO.areaLabel="areaLabel",JO.liquidGroup="liquidGroup",JO.liquid="liquid",JO.liquidBackground="liquidBackground",JO.liquidOutline="liquidOutline",JO.circle="circle",JO.overlap="overlap",JO.overlapLabel="overlapLabel",JO.pictogram="pictogram";var eF={primaryFontColor:"titleFontColor",tertiaryFontColor:"labelFontColor",axisLabelFontColor:"axisFontColor",axisMarkerFontColor:"labelReverseFontColor",dataZoomHandleStrokeColor:"dataZoomHandlerStrokeColor",sliderHandleColor:"dataZoomHandlerFillColor",sliderRailColor:"dataZoomBackgroundColor",sliderTrackColor:"dataZoomSelectedColor",playerControllerColor:"dataZoomSelectedColor",popupBackgroundColor:"tooltipBackgroundColor",hoverBackgroundColor:"axisGridColor"},iF={titleFontColor:"primaryFontColor",labelFontColor:"tertiaryFontColor",axisFontColor:"axisLabelFontColor",labelReverseFontColor:"axisMarkerFontColor",dataZoomHandlerStrokeColor:"dataZoomHandleStrokeColor",dataZoomHandlerFillColor:"sliderHandleColor",dataZoomBackgroundColor:"sliderRailColor",dataZoomSelectedColor:"sliderTrackColor",tooltipBackgroundColor:"popupBackgroundColor"};function nF(t,e){var i;if(!t)return[];var n=cF(t,e);if(!n||X(n))return null!==(i=n)&&void 0!==i?i:[];if(V(n)){var r=n.dataScheme;return r?lF(r)?r.map((function(i){return A(A({},i),{scheme:i.scheme.map((function(i){return sF(i)?aF(t,i,e):i})).filter(N)})})):r.map((function(i){return sF(i)?aF(t,i,e):i})).filter(N):[]}return[]}function rF(t,e){var i,n;return lF(t)?null!==(n=null===(i=t.find((function(t){return N(t.isAvailable)?H(t.isAvailable)?t.isAvailable(e):!!t.isAvailable:!N(t.maxDomainLength)||(null==e?void 0:e.length)<=t.maxDomainLength})))||void 0===i?void 0:i.scheme)&&void 0!==n?n:t[t.length-1].scheme:t}function aF(t,e,i){var n,r=cF(t,i);if(r){var a,o=r.palette;if(V(o)&&(a=null!==(n=function(t,e){var i=eF[e];if(i&&t[i])return t[i];if(t[e])return t[e];var n=iF[e];return n?t[n]:void 0}(o,e.key))&&void 0!==n?n:e.default),a){if(j(e.a)&&j(e.l)||!Y(a))return a;var s=new Ti(a);if(N(e.l)){var l=s.color,u=mi(l.r,l.g,l.b),c=yi(u.h,u.s,e.l),h=new Ti("rgb(".concat(c.r,", ").concat(c.g,", ").concat(c.b,")"));h.setOpacity(s.color.opacity),s=h}return N(e.a)&&s.setOpacity(e.a),s.toRGBA()}}}var oF=function(t,e,i){if(e&&sF(t)){var n=aF(e,t,i);if(n)return n}return t};function sF(t){return t&&"palette"===t.type&&!!t.key}function lF(t){return!(!X(t)||0===t.length)&&t.every((function(t){return N(t.scheme)}))}function uF(t){return X(t)?{dataScheme:t}:t}function cF(t,e){var i,n,r,a=(null!=e?e:{}).type;if(!e||j(a))r=null==t?void 0:t.default;else{var o=tF(e);r=null!==(n=null!==(i=null==t?void 0:t["".concat(a,"_").concat(o)])&&void 0!==i?i:null==t?void 0:t[a])&&void 0!==n?n:null==t?void 0:t.default}return r}var hF=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype.range=function(e){return e?(this._range=e,this._resetRange(),this):t.prototype.range.call(this)},e.prototype.domain=function(e){return e?(t.prototype.domain.call(this,e),this._resetRange(),this):t.prototype.domain.call(this)},e.prototype._resetRange=function(){if(lF(this._range)){var e=rF(this._range,this._domain);t.prototype.range.call(this,e)}else t.prototype.range.call(this,this._range)},e}(uI),dF={linear:II,band:dI,point:zI,ordinal:uI,threshold:NI,colorOrdinal:hF};function pF(t){var e=dF[t];return e?new e:null}function fF(t,e,i){if(!e)return t;var n=e.range(),r=i&&e._calculateWholeRange?e._calculateWholeRange(n):e.range(),a=Math.min(r[0],r[r.length-1]),o=Math.max(r[0],r[r.length-1]);return Math.min(Math.max(a,t),o)}function vF(t){return N(null==t?void 0:t.field)&&N(null==t?void 0:t.scale)}function gF(t){switch(t){case"left":case"right":case"top":case"bottom":return!0;default:return!1}}function yF(t){return!!Y(t)&&(!!t.endsWith("%")&&Uk(t.substring(0,t.length-1)))}function mF(t,e,i,n){var r,a;return void 0===n&&(n=0),Z(t)?t:yF(t)?Number(t.substring(0,t.length-1))*e/100:H(t)?t(i):V(t)?e*(null!==(r=t.percent)&&void 0!==r?r:0)+(null!==(a=t.offset)&&void 0!==a?a:0):n}function _F(t,e,i){var n,r,a,o,s={top:0,bottom:0,left:0,right:0};return Object.values(t).every((function(t){return Z(t)}))?(s.top=null!==(n=t.top)&&void 0!==n?n:0,s.right=null!==(r=t.right)&&void 0!==r?r:0,s.bottom=null!==(a=t.bottom)&&void 0!==a?a:0,s.left=null!==(o=t.left)&&void 0!==o?o:0,s):([{orients:["left","right"],size:e.width},{orients:["top","bottom"],size:e.height}].forEach((function(e){e.orients.forEach((function(n){s[n]=mF(t[n],e.size,i)}))})),s)}function bF(t){var e,i={};return X(t)?(j(t[0])||(i.top=i.left=i.bottom=i.right=t[0]),j(t[1])||(i.left=i.right=t[1]),j(t[2])||(i.bottom=t[2]),j(t[3])||(i.left=t[3]),i):Z(t)||yF(t)||H(t)||V(e=t)&&("percent"in e||"offset"in e)?(i.top=i.left=i.bottom=i.right=t,i):V(t)?i=A({},t):i}function xF(t,e,i){return i?{x:t.x+e.x,y:t.y+e.y}:t}var kF=function(t,e){var i=Number(t),n=t.toString();return isNaN(i)&&"%"===n[n.length-1]?e*(Number(n.slice(0,n.length-1))/100):i},SF=[{maxDomainLength:10,scheme:["#1664FF","#1AC6FF","#FF8A00","#3CC780","#7442D4","#FFC400","#304D77","#B48DEB","#009488","#FF7DDA"]},{scheme:["#1664FF","#B2CFFF","#1AC6FF","#94EFFF","#FF8A00","#FFCE7A","#3CC780","#B9EDCD","#7442D4","#DDC5FA","#FFC400","#FAE878","#304D77","#8B959E","#B48DEB","#EFE3FF","#009488","#59BAA8","#FF7DDA","#FFCFEE"]}],AF={default:{dataScheme:SF,palette:{backgroundColor:"#ffffff",borderColor:"#e3e5e8",shadowColor:"rgba(33,37,44,0.1)",hoverBackgroundColor:"#f1f2f5",sliderRailColor:"#f1f3f4",sliderHandleColor:"#ffffff",sliderTrackColor:"#0040ff",popupBackgroundColor:"#ffffff",primaryFontColor:"#21252c",secondaryFontColor:"#606773",tertiaryFontColor:"#89909d",axisLabelFontColor:"#89909d",disableFontColor:"#bcc1cb",axisMarkerFontColor:"#ffffff",axisGridColor:"#f1f2f5",axisDomainColor:"#d9dde4",dataZoomHandleStrokeColor:"#aeb5be",dataZoomChartColor:"#c9ced8",playerControllerColor:"#0040ff",scrollBarSliderColor:"rgba(0,0,0,0.3)",axisMarkerBackgroundColor:"#21252c",markLabelBackgroundColor:"#f1f2f5",markLineStrokeColor:"#606773",dangerColor:"#e33232",warningColor:"#ffc528",successColor:"#07a35a",infoColor:"#3073f2",discreteLegendPagerTextColor:"rgb(51, 51, 51)",discreteLegendPagerHandlerColor:"rgb(47, 69, 84)",discreteLegendPagerHandlerDisableColor:"rgb(170, 170, 170)",emptyCircleColor:"#e3e5e8",linearProgressTrackColor:"#E7EBED"}}},MF=function(t){var e={label:{style:{fill:"white",textBaseline:"middle",lineWidth:2}},outerLabel:{style:{fontSize:{type:"token",key:"l4FontSize"},fill:{type:"palette",key:"secondaryFontColor"}},line:{style:{stroke:{type:"palette",key:"axisDomainColor"}}}},transformLabel:{style:{fontSize:{type:"token",key:"l4FontSize"},fill:{type:"palette",key:"secondaryFontColor"},textBaseline:"middle"}}};return e[t?"transform3d":"transform"]={style:{fill:{type:"palette",key:"axisGridColor"}}},e},wF=MF(),TF=MF(!0),CF="M1 0 C1 0.55228 0.55228 1 0 1 C-0.552285 1 -1 0.55228 -1 0 C-1 -0.552285 -0.552285 -1 0 -1 C0.55228 -1 1 -0.552285 1 0Z",EF={pointer:{type:"path",width:.4,height:.4,style:{path:"M-0.020059 -0.978425 C-0.018029 -0.9888053 -0.013378 -1 0 -1 C0.01342 -1 0.01812 -0.989146 0.0201 -0.978425 C0.02161 -0.9702819 0.0692 -0.459505 0.09486 -0.184807 C0.10298 -0.097849 0.1089 -0.034548 0.11047 -0.018339 C0.11698 0.04908 0.07373 0.11111 0.00002 0.11111 C-0.07369 0.11111 -0.117184 0.04991 -0.110423 -0.018339 C-0.103662 -0.086591 -0.022089 -0.9680447 -0.020059 -0.978425Z"}},pin:{width:.025,height:.025,style:{path:CF,fill:"#888"}},pinBackground:{width:.06,height:.06,style:{path:CF,fill:"#ddd"}}},PF={word:{padding:1,style:{textAlign:"center",textBaseline:"alphabetic"}}},RF={word:{padding:1,style:{textAlign:"center",textBaseline:"alphabetic"}}},BF="__VCHART",IF=500,LF=500,DF="".concat(BF,"_ARC_TRANSFORM_VALUE"),OF="".concat(BF,"_ARC_RATIO"),FF="".concat(BF,"_ARC_START_ANGLE"),zF="".concat(BF,"_ARC_END_ANGLE"),HF="".concat(BF,"_ARC_K"),jF="".concat(BF,"_ARC_MIDDLE_ANGLE"),NF="".concat(BF,"_ARC_QUADRANT"),VF="".concat(BF,"_ARC_RADIAN"),WF=-Math.PI/2,GF=3*Math.PI/2,UF=.6,YF={scatter:{point:{style:{size:8,symbolType:"circle",lineWidth:0,fillOpacity:.8}},label:{visible:!1,offset:5,position:"top",style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}}},line:{label:{visible:!1,position:"top",offset:5,style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}},point:{style:{symbolType:"circle"}}},area:{label:{visible:!1,offset:5,position:"top",style:{stroke:{type:"palette",key:"backgroundColor"},lineWidth:2}},point:{style:{symbolType:"circle"}},seriesMark:"area"},bar:{label:{visible:!1,position:"outside",offset:5,style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}}},bar3d:{bar3d:{style:{length:3}},label:{visible:!1,style:{offset:12,position:"outside"}}},pie:{outerRadius:.6,pie:{style:{fillOpacity:1}},label:{visible:!1,interactive:!0,position:"outside",style:{fontWeight:"normal",stroke:{type:"palette",key:"backgroundColor"},fillOpacity:1}},innerLabel:{style:{lineWidth:2}},emptyCircle:{style:{fill:{type:"palette",key:"emptyCircleColor"},fillOpacity:1}}},pie3d:{outerRadius:.6,pie3d:{style:{height:10,fillOpacity:1}},label:{visible:!1,interactive:!0,position:"outside"}},map:{defaultFillColor:"#f3f3f3",area:{style:{lineWidth:.5,strokeOpacity:1,stroke:"black",fillOpacity:1}},label:{interactive:!1,style:{fontSize:{type:"token",key:"l6FontSize"},lineHeight:{type:"token",key:"l6LineHeight"},textBaseline:"middle",fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"},stroke:{type:"palette",key:"backgroundColor"}}}},radar:{label:{visible:!1,offset:5,style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}},point:{style:{symbolType:"circle"}}},dot:{dot:{style:{size:10,fillOpacity:1}},symbol:{style:{size:10}},title:{style:{textAlign:"left",textBaseline:"middle",fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}},subTitle:{style:{textAlign:"left",textBaseline:"top",fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}}},link:{arrow:{style:{size:10}}},wordCloud:PF,wordCloud3d:RF,funnel:wF,funnel3d:TF,linearProgress:{bandWidth:30,progress:{style:{fillOpacity:1}},track:{style:{fill:{type:"palette",key:"linearProgressTrackColor"},fillOpacity:1}}},circularProgress:{outerRadius:.8,innerRadius:.6,progress:{style:{fillOpacity:1}},track:{style:{fillOpacity:.2}},tickMask:{visible:!1,angle:3,offsetAngle:0,forceAlign:!0}},waterfall:{seriesFieldName:{total:"total",increase:"increase",decrease:"decrease"},leaderLine:{style:{stroke:"black",lineWidth:1,lineDash:[4,4]}},stackLabel:{visible:!0,offset:12,position:"withChange",style:{fill:"black",fontSize:{type:"token",key:"l4FontSize"}}},label:{visible:!1,offset:12,position:"inside",style:{lineWidth:2}}},gauge:{outerRadius:.8,innerRadius:.6,padAngle:1.146,segment:{style:{fillOpacity:1}},tickMask:{visible:!1,angle:3,offsetAngle:0,forceAlign:!0}},gaugePointer:EF,treemap:{gapWidth:1,nodePadding:[5],nonLeaf:{visible:!1,style:{fillOpacity:.5}},label:{style:{fill:"white",textBaseline:"middle",textAlign:"center",fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}},nonLeafLabel:{padding:24,style:{fill:"black",stroke:{type:"palette",key:"backgroundColor"},lineWidth:2,fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},textBaseline:"middle",textAlign:"center"}}},sunburst:{innerRadius:0,outerRadius:1,startAngle:-90,endAngle:270,gap:0,labelLayout:{align:"center",offset:0,rotate:"radial"},sunburst:{style:{stroke:{type:"palette",key:"backgroundColor"},fillOpacity:1,cursor:"pointer"}},label:{visible:!0,style:{cursor:"pointer",fill:{type:"palette",key:"primaryFontColor"},fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}}},rangeColumn:{label:{visible:!1,offset:5,position:"inside",style:{lineWidth:2,fill:{type:"palette",key:"axisMarkerFontColor"}},minLabel:{position:"end"},maxLabel:{position:"start"}}},circlePacking:{layoutPadding:5,circlePacking:{visible:!0,style:{cursor:"pointer",stroke:{type:"palette",key:"backgroundColor"}}},label:{visible:!0,style:{cursor:"pointer",fill:"black",stroke:{type:"palette",key:"backgroundColor"},lineWidth:2,fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}}},heatmap:{cell:{style:{shape:"square",fillOpacity:1}},cellBackground:{visible:!1}},sankey:{link:{style:{fillOpacity:.15,round:!0}}},rose:{rose:{style:{fillOpacity:1}},label:{style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"},textAlign:"center",textBaseline:"middle"}}},boxPlot:{boxPlot:{style:{lineWidth:1}},label:{style:{lineWidth:2}}},correlation:{centerLabel:{visible:!0,position:"center",style:{fill:"#fff",text:""}},label:{visible:!0,position:"bottom",style:{fill:"#000"}}},liquid:{outlinePadding:10,liquidBackground:{style:{lineWidth:0,fillOpacity:.2}},liquidOutline:{style:{lineWidth:2}}},venn:{circle:{style:{opacity:.8},state:{hover:{opacity:1}}},overlap:{style:{opacity:.8},state:{hover:{opacity:1,stroke:"white",lineWidth:2}}},label:{visible:!0,style:{fill:"white",textBaseline:"middle",textAlign:"center",fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"}}},overlapLabel:{visible:!0,style:{textBaseline:"middle",textAlign:"center",fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}}},mosaic:{label:{visible:!1,position:"center",style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}},bar:{style:{lineWidth:1,stroke:{type:"palette",key:"backgroundColor"}}}}},XF={label:{space:8},title:{space:8},maxHeight:"30%",unit:{visible:!1,style:{fontSize:{type:"token",key:"l5FontSize"},fill:{type:"palette",key:"axisLabelFontColor"},fontWeight:"normal",fillOpacity:1}}},KF={label:{space:12,autoLimit:!0},title:{space:12,autoRotate:!0},maxWidth:"30%",unit:{visible:!1,style:{fontSize:{type:"token",key:"l5FontSize"},fill:{type:"palette",key:"axisLabelFontColor"},fontWeight:"normal",fillOpacity:1}}},qF=A(A({},XF),{label:{space:0}}),ZF={trigger:"hover",bandField:{visible:!1,line:{type:"rect",visible:!0,style:{fill:{type:"palette",key:"axisGridColor"},opacity:.7,lineWidth:0,stroke:{type:"palette",key:"markLineStrokeColor"},lineDash:[2,3]}},label:{visible:!1,style:{fontWeight:"normal",fill:{type:"palette",key:"axisMarkerFontColor"},fontSize:{type:"token",key:"l5FontSize"}},labelBackground:{padding:{bottom:0,top:0,left:2,right:2},style:{fill:{type:"palette",key:"axisMarkerBackgroundColor"},cornerRadius:1}}}},linearField:{visible:!1,line:{type:"line",visible:!0,style:{stroke:{type:"palette",key:"markLineStrokeColor"},fill:"transparent",opacity:.7,lineDash:[2,3]}},label:{visible:!1,style:{fontWeight:"normal",fill:{type:"palette",key:"axisMarkerFontColor"},fontSize:{type:"token",key:"l5FontSize"}},labelBackground:{padding:{bottom:0,top:0,left:2,right:2},style:{fill:{type:"palette",key:"axisMarkerBackgroundColor"},cornerRadius:1}}}}},JF=function(t){return{area:{style:{visible:t,stroke:!1,fill:{type:"palette",key:"dataZoomChartColor"}}},line:{style:{visible:t,stroke:{type:"palette",key:"dataZoomChartColor"},lineWidth:1}}}},QF={padding:[12,0],showDetail:"auto",brushSelect:!1,middleHandler:{visible:!1,background:{size:6,style:{stroke:{type:"palette",key:"dataZoomHandleStrokeColor"},cornerRadius:2}},icon:{style:{size:4,fill:{type:"palette",key:"sliderHandleColor"},stroke:{type:"palette",key:"dataZoomHandleStrokeColor"},symbolType:"M 0.3 -0.5 C 0.41 -0.5 0.5 -0.41 0.5 -0.3 C 0.5 -0.3 0.5 0.3 0.5 0.3 C 0.5 0.41 0.41 0.5 0.3 0.5 C 0.3 0.5 -0.3 0.5 -0.3 0.5 C -0.41 0.5 -0.5 0.41 -0.5 0.3 C -0.5 0.3 -0.5 -0.3 -0.5 -0.3 C -0.5 -0.41 -0.41 -0.5 -0.3 -0.5 C -0.3 -0.5 0.3 -0.5 0.3 -0.5 Z",lineWidth:.5}}},background:{size:20,style:{fill:{type:"palette",key:"sliderRailColor"},lineWidth:0}},selectedBackground:{style:{fill:{type:"palette",key:"sliderTrackColor"},fillOpacity:.1,outerBorder:{stroke:{type:"palette",key:"sliderTrackColor"},strokeOpacity:.2,distance:-.5,lineWidth:1}}},selectedBackgroundChart:JF(!1),startHandler:{style:{symbolType:"M-0.5-2.4h0.9c0.4,0,0.7,0.3,0.7,0.7v3.3c0,0.4-0.3,0.7-0.7,0.7h-0.9c-0.4,0-0.7-0.3-0.7-0.7v-3.3\nC-1.2-2-0.9-2.4-0.5-2.4z M-0.4-1.4L-0.4-1.4c0,0,0,0.1,0,0.1v2.6c0,0.1,0,0.1,0,0.1l0,0c0,0,0-0.1,0-0.1v-2.6\nC-0.4-1.4-0.4-1.4-0.4-1.4z M0.3-1.4L0.3-1.4c0,0,0,0.1,0,0.1v2.6c0,0.1,0,0.1,0,0.1l0,0c0,0,0-0.1,0-0.1v-2.6\nC0.3-1.4,0.3-1.4,0.3-1.4z;",fill:{type:"palette",key:"sliderHandleColor"},scaleX:1.2,scaleY:1.2,stroke:{type:"palette",key:"dataZoomHandleStrokeColor"},lineWidth:1}},endHandler:{style:{symbolType:"M-0.5-2.4h0.9c0.4,0,0.7,0.3,0.7,0.7v3.3c0,0.4-0.3,0.7-0.7,0.7h-0.9c-0.4,0-0.7-0.3-0.7-0.7v-3.3\nC-1.2-2-0.9-2.4-0.5-2.4z M-0.4-1.4L-0.4-1.4c0,0,0,0.1,0,0.1v2.6c0,0.1,0,0.1,0,0.1l0,0c0,0,0-0.1,0-0.1v-2.6\nC-0.4-1.4-0.4-1.4-0.4-1.4z M0.3-1.4L0.3-1.4c0,0,0,0.1,0,0.1v2.6c0,0.1,0,0.1,0,0.1l0,0c0,0,0-0.1,0-0.1v-2.6\nC0.3-1.4,0.3-1.4,0.3-1.4z;",fill:{type:"palette",key:"sliderHandleColor"},scaleX:1.2,scaleY:1.2,stroke:{type:"palette",key:"dataZoomHandleStrokeColor"},lineWidth:1}},startText:{padding:8,style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}}},endText:{padding:8,style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}}},backgroundChart:JF(!0)},$F=function(t,e){return{fontSize:{type:"token",key:t},fill:{type:"palette",key:e},fontWeight:"normal",fillOpacity:1,textBaseline:"top",textAlign:"center"}},tz={title:{visible:!0,autoLimit:!1,autoFit:!1,style:$F("l1FontSize","primaryFontColor")},content:{visible:!0,style:$F("l2FontSize","tertiaryFontColor")}},ez={orient:"right",position:"middle",padding:[16,24],title:{visible:!1,padding:0,textStyle:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fontWeight:"normal",fill:{type:"palette",key:"primaryFontColor"}},space:12},handler:{visible:!0},startText:{style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fontWeight:"normal",fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}},space:6},endText:{style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fontWeight:"normal",fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}},space:6},handlerText:{style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fontWeight:"normal",fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}},space:6}},iz=function(t){var e={width:200,height:8,style:{fill:{type:"palette",key:"sliderRailColor"}}};return t?(e.width=200,e.height=8):(e.width=8,e.height=200),A(A({},ez),{rail:e,handler:{style:{symbolType:"circle",lineWidth:0,outerBorder:{lineWidth:2,distance:.8,stroke:"#ffffff"},shadowBlur:12,shadowOffsetX:0,shadowOffsetY:4,shadowColor:{type:"palette",key:"shadowColor"}}}})},nz={horizontal:iz(!0),vertical:iz(!1)},rz=function(t){var e={style:{fill:{type:"palette",key:"sliderRailColor"}}};return t?(e.width=200,e.height=4):(e.height=200,e.width=4),A(A({},ez),{sizeBackground:{fill:{type:"palette",key:"dataZoomChartColor"}},track:{style:{fill:{type:"palette",key:"sliderTrackColor",a:.8}}},rail:e,handler:{style:{symbolType:"circle",lineWidth:0,outerBorder:{lineWidth:2,distance:.8,stroke:{type:"palette",key:"sliderTrackColor"}},fill:{type:"palette",key:"sliderHandleColor"}}}})},az={horizontal:rz(!0),vertical:rz(!1)},oz={visible:!0,offset:12,position:"top",space:10,nameLabel:{visible:!0,style:{textBaseline:"middle",textAlign:"left",fill:"black",fontSize:{type:"token",key:"l6FontSize"}}},valueLabel:{visible:!0,style:{textBaseline:"middle",textAlign:"left",fill:"black",fontSize:{type:"token",key:"l6FontSize"}}},background:{visible:!0,padding:{top:4,bottom:4,left:6,right:6},style:{cornerRadius:2,lineWidth:1,fill:"white",stroke:"grey"}},leader:{visible:!1,style:{lineWidth:1,stroke:"red"}}},sz={area:{style:{fill:{type:"palette",key:"axisDomainColor",a:.25}}},label:{style:{fontSize:{type:"token",key:"l4FontSize"},fontWeight:"normal",fontStyle:"normal",fill:{type:"palette",key:"primaryFontColor"}},labelBackground:{padding:{top:2,bottom:2,right:4,left:4},style:{cornerRadius:3,fill:{type:"palette",key:"markLabelBackgroundColor"}}}}},lz=function(t){return{visible:t,symbolType:"triangle",size:10,style:{fill:{type:"palette",key:"markLineStrokeColor"},stroke:null,lineWidth:0}}},uz={style:{fontSize:{type:"token",key:"l4FontSize"},fontWeight:"normal",fontStyle:"normal",fill:{type:"palette",key:"primaryFontColor"}},labelBackground:{padding:{top:2,bottom:2,right:4,left:4},style:{cornerRadius:3,fill:{type:"palette",key:"markLabelBackgroundColor"}}},refY:5},cz={line:{style:{lineDash:[3,3],stroke:{type:"palette",key:"markLineStrokeColor"}}},startSymbol:lz(!1),endSymbol:lz(!0),label:uz},hz={itemLine:{decorativeLine:{visible:!1},startSymbol:{size:5,visible:!0,style:{fill:{type:"palette",key:"markLineStrokeColor"},stroke:null,lineWidth:0}},endSymbol:{style:{fill:{type:"palette",key:"markLineStrokeColor"},stroke:null,lineWidth:0}},line:{style:{stroke:{type:"palette",key:"markLineStrokeColor"}}}},itemContent:{offsetY:-50}};function dz(t,e){return t&&e.key in t?t[e.key]:e.default}function pz(t){return t&&"token"===t.type&&!!t.key}var fz={fontFamily:"PingFang SC,Helvetica Neue,Microsoft Yahei,system-ui,-apple-system,segoe ui,Roboto,Helvetica,Arial,sans-serif,apple color emoji,segoe ui emoji,segoe ui symbol",fontSize:14,l1FontSize:32,l1LineHeight:"150%",l2FontSize:20,l2LineHeight:"140%",l3FontSize:16,l3LineHeight:"150%",l4FontSize:14,l4LineHeight:"150%",l5FontSize:12,l5LineHeight:"130%",l6FontSize:10,l6LineHeight:"120%"},vz={name:"light",background:{type:"palette",key:"backgroundColor"},padding:20,fontFamily:{type:"token",key:"fontFamily"},colorScheme:AF,token:fz,mark:{text:{style:{fontSize:{type:"token",key:"l4FontSize"},fontWeight:"normal",fillOpacity:1}}},markByName:{label:{style:{fontSize:{type:"token",key:"l4FontSize"},fontWeight:"normal",fillOpacity:1,lineJoin:"bevel"}},area:{style:{fillOpacity:.2}},line:{style:{lineWidth:2,lineCap:"round",lineJoin:"round"}},point:{style:{size:8,stroke:{type:"palette",key:"backgroundColor"},lineWidth:1,fillOpacity:1}},word:{style:{fontWeight:null,fontSize:null}},fillingWord:{style:{fontWeight:null,fontSize:null}},sunburst:{style:{lineWidth:1,stroke:{type:"palette",key:"backgroundColor"}}},circlePacking:{style:{lineWidth:1,stroke:{type:"palette",key:"backgroundColor"}}},funnel3d:{style:{stroke:!1}},barBackground:{visible:!1,style:{fill:{type:"palette",key:"primaryFontColor",a:.06},stroke:"transparent"}}},series:YF,component:{discreteLegend:{orient:"bottom",position:"middle",padding:[16,24],title:{visible:!1,padding:0,textStyle:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fill:{type:"palette",key:"primaryFontColor"},fontWeight:"normal"},space:12},pager:{textStyle:{fill:{type:"palette",key:"discreteLegendPagerTextColor"}},handler:{style:{fill:{type:"palette",key:"discreteLegendPagerHandlerColor"}},state:{disable:{fill:{type:"palette",key:"discreteLegendPagerHandlerDisableColor"}}}}},item:{visible:!0,spaceCol:10,spaceRow:6,padding:2,background:{state:{selectedHover:{fill:{type:"palette",key:"hoverBackgroundColor"}},unSelectedHover:{fill:{type:"palette",key:"hoverBackgroundColor"}}}},shape:{space:6,style:{lineWidth:0,fillOpacity:1,opacity:1},state:{unSelected:{fillOpacity:.2,opacity:1}}},label:{space:6,style:{fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"},fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},opacity:1},state:{unSelected:{fill:{type:"palette",key:"disableFontColor"},opacity:1}}}},allowAllCanceled:!1},colorLegend:nz,sizeLegend:az,axis:{domainLine:{visible:!0,style:{lineWidth:1,stroke:{type:"palette",key:"axisDomainColor"},strokeOpacity:1}},grid:{visible:!0,style:{lineWidth:1,stroke:{type:"palette",key:"axisGridColor"},strokeOpacity:1,lineDash:[]}},subGrid:{visible:!1,style:{lineWidth:1,stroke:{type:"palette",key:"axisGridColor"},strokeOpacity:1,lineDash:[4,4]}},tick:{visible:!0,inside:!1,tickSize:4,alignWithLabel:!0,style:{lineWidth:1,stroke:{type:"palette",key:"axisDomainColor"},strokeOpacity:1}},subTick:{visible:!1,tickSize:2,style:{lineWidth:1,stroke:{type:"palette",key:"axisDomainColor"},strokeOpacity:1}},label:{visible:!0,inside:!1,space:10,style:{fontSize:{type:"token",key:"l5FontSize"},fill:{type:"palette",key:"axisLabelFontColor"},fontWeight:"normal",fillOpacity:1}},title:{space:10,padding:0,style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fill:{type:"palette",key:"secondaryFontColor"},fontWeight:"normal",fillOpacity:1}}},axisBand:{domainLine:{visible:!0},grid:{visible:!1},subGrid:{visible:!1},tick:{visible:!0},subTick:{visible:!1}},axisLinear:{domainLine:{visible:!1},grid:{visible:!0},subGrid:{visible:!1},tick:{visible:!1},subTick:{visible:!1}},axisX:XF,axisY:KF,axisZ:qF,axisAngle:{grid:{visible:!0,style:{lineDash:[6,6]}},label:{space:5}},axisRadius:{grid:{smooth:!0,visible:!0},subGrid:{smooth:!0,visible:!1}},markLine:cz,markArea:sz,markPoint:hz,polarMarkLine:cz,polarMarkArea:sz,polarMarkPoint:hz,geoMarkPoint:hz,tooltip:{offset:{x:10,y:10},panel:{padding:{top:10,left:10,right:10,bottom:10},backgroundColor:{type:"palette",key:"popupBackgroundColor"},border:{color:{type:"palette",key:"popupBackgroundColor"},width:0,radius:3},shadow:{x:0,y:4,blur:12,spread:0,color:{type:"palette",key:"shadowColor"}}},spaceRow:6,titleLabel:{fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"},fontColor:{type:"palette",key:"primaryFontColor"},fontWeight:"bold",textBaseline:"middle",spacing:0},shape:{size:8,spacing:6},keyLabel:{fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"},fontColor:{type:"palette",key:"secondaryFontColor"},textBaseline:"middle",spacing:26},valueLabel:{fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"},fontColor:{type:"palette",key:"primaryFontColor"},fontWeight:"bold",textBaseline:"middle",spacing:0}},dataZoom:QF,crosshair:ZF,player:{visible:!0,position:"start",padding:{top:20,bottom:20},slider:{space:10,trackStyle:{fill:{type:"palette",key:"sliderTrackColor"},fillOpacity:.8},railStyle:{fill:{type:"palette",key:"sliderRailColor"}},handlerStyle:{size:15,stroke:{type:"palette",key:"backgroundColor"},lineWidth:2,fill:{type:"palette",key:"playerControllerColor"}}},controller:{start:{order:0,space:10,position:"start",style:{size:12,fill:{type:"palette",key:"playerControllerColor"},fillOpacity:.8}},pause:{order:0,space:10,position:"start",style:{size:12,fill:{type:"palette",key:"playerControllerColor"},fillOpacity:.8}},backward:{order:0,space:10,position:"start",style:{size:12,fill:{type:"palette",key:"playerControllerColor"},fillOpacity:.8}},forward:{order:0,space:10,position:"start",style:{size:12,fill:{type:"palette",key:"playerControllerColor"},fillOpacity:.8}}}},brush:{style:{fill:"#B0C8F9",fillOpacity:.2,stroke:"#B0C8F9",lineWidth:2},brushMode:"single",brushType:"rect",brushMoved:!0,removeOnClick:!0,delayType:"throttle",delayTime:0},indicator:tz,title:{padding:{top:4,bottom:20},textStyle:{fontSize:{type:"token",key:"l3FontSize"},lineHeight:{type:"token",key:"l3LineHeight"},fill:{type:"palette",key:"primaryFontColor"}},subtextStyle:{fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"},fill:{type:"palette",key:"tertiaryFontColor"}}},mapLabel:oz,poptip:{visible:!0,position:"auto",padding:8,titleStyle:{fontSize:{type:"token",key:"l5FontSize"},fontWeight:"bold",fill:{type:"palette",key:"primaryFontColor"}},contentStyle:{fontSize:{type:"token",key:"l5FontSize"},fill:{type:"palette",key:"primaryFontColor"}},panel:{visible:!0,fill:{type:"palette",key:"popupBackgroundColor"},cornerRadius:3,lineWidth:0,shadowBlur:12,shadowOffsetX:0,shadowOffsetY:4,shadowColor:{type:"palette",key:"shadowColor"},size:0,space:12}},totalLabel:{visible:!1,offset:5,overlap:{clampForce:!0,strategy:[]},smartInvert:!1,animation:!1,style:{fontSize:{type:"token",key:"l4FontSize"},fill:{type:"palette",key:"primaryFontColor"}}},scrollBar:{horizontal:{height:10,slider:{style:{fill:{type:"palette",key:"scrollBarSliderColor"}}}},vertical:{width:10,slider:{style:{fill:{type:"palette",key:"scrollBarSliderColor"}}}}}},animationThreshold:2e3},gz={name:"dark",colorScheme:{default:{dataScheme:SF,palette:{backgroundColor:"#202226",borderColor:"#404349",shadowColor:"rgba(0,0,0,0.1)",hoverBackgroundColor:"#404349",sliderRailColor:"#404349",sliderHandleColor:"#202226",sliderTrackColor:"#4284FF",popupBackgroundColor:"#404349",primaryFontColor:"#fdfdfd",secondaryFontColor:"#bbbdc3",tertiaryFontColor:"#888c93",axisLabelFontColor:"#888c93",disableFontColor:"#55595f",axisMarkerFontColor:"#202226",axisGridColor:"#404349",axisDomainColor:"#4b4f54",dataZoomHandleStrokeColor:"#bbbdc3",dataZoomChartColor:"#55595F",playerControllerColor:"#4284FF",scrollBarSliderColor:"rgba(255,255,255,0.3)",axisMarkerBackgroundColor:"#fdfdfd",markLabelBackgroundColor:"#404349",markLineStrokeColor:"#bbbdc3",dangerColor:"#eb4b4b",warningColor:"#f0bd30",successColor:"#14b267",infoColor:"#4284ff",discreteLegendPagerTextColor:"#BBBDC3",discreteLegendPagerHandlerColor:"#BBBDC3",discreteLegendPagerHandlerDisableColor:"#55595F",emptyCircleColor:"#bbbdc3",linearProgressTrackColor:"#404349"}}},component:{dataZoom:{selectedBackground:{style:{fillOpacity:.4,outerBorder:{strokeOpacity:.4}}}}}},yz=function(t,e){return t===e||!H(t)&&!H(e)&&(X(t)&&X(e)?e.every((function(e){return t.some((function(t){return yz(t,e)}))})):!(!V(t)||!V(e))&&Object.keys(e).every((function(i){return yz(t[i],e[i])})))},mz=function(t,e,i){if(j(e))return t;var n=e[0];return j(n)?t:1===e.length?(t[n]=i,t):(j(t[n])&&("number"==typeof e[1]?t[n]=[]:t[n]={}),mz(t[n],e.slice(1),i))},_z=function(t){return t instanceof Ms||function(t){try{return t instanceof Element}catch(i){var e=Object.keys(t);return["children","innerHTML","classList","setAttribute","tagName","getBoundingClientRect"].every((function(t){return e.includes(t)}))}}(t)};function bz(t){return ct(t,_z,arguments.length>1&&void 0!==arguments[1]?arguments[1]:["data"])}function xz(t){for(var e=-1,i=arguments.length<=1?0:arguments.length-1;++e<i;){ht(t,e+1<1||arguments.length<=e+1?void 0:arguments[e+1],!0,!0)}return t}var kz=function(){function t(){}return t.registerChart=function(e,i){t._charts[e]=i},t.registerSeries=function(e,i){t._series[e]=i},t.registerComponent=function(e,i,n){t._components[e]={cmp:i,alwaysCheck:n}},t.registerMark=function(e,i){t._marks[e]=i},t.registerRegion=function(e,i){t._regions[e]=i},t.registerTransform=function(e,i){t.transforms[e]=i},t.registerLayout=function(e,i){t._layout[e]=i},t.registerAnimation=function(e,i){t._animations[e]=i},t.registerImplement=function(e,i){t._implements[e]=i},t.registerChartPlugin=function(e,i){t._chartPlugin[e]=i},t.registerComponentPlugin=function(e,i){t._componentPlugin[e]=i},t.createChart=function(e,i,n){return t._charts[e]?new(0,t._charts[e])(i,n):null},t.createChartSpecTransformer=function(e,i){if(!t._charts[e])return null;var n=t._charts[e];return new(0,n.transformerConstructor)(A({seriesType:n.seriesType},i))},t.createRegion=function(e,i,n){return t._regions[e]?new(0,t._regions[e])(i,n):null},t.createRegionSpecTransformer=function(e,i){return t._regions[e]?new(0,t._regions[e].transformerConstructor)(i):null},t.createSeries=function(e,i,n){return t._series[e]?new(0,t._series[e])(i,n):null},t.createSeriesSpecTransformer=function(e,i){return t._series[e]?new(0,t._series[e].transformerConstructor)(i):null},t.createMark=function(e,i,n){if(!t._marks[e])return null;var r=new(0,t._marks[e])(i,n);return"group"===r.type&&r.setMarkConfig({interactive:!1}),r},t.getComponents=function(){return Object.values(t._components)},t.getComponentInKey=function(e){return t._components[e].cmp},t.getLayout=function(){return Object.values(t._layout)},t.getLayoutInKey=function(e){return t._layout[e]},t.getSeries=function(){return Object.values(t._series)},t.getSeriesInType=function(e){return t._series[e]},t.getRegionInType=function(e){return t._regions[e]},t.getAnimationInKey=function(e){return t._animations[e]},t.getImplementInKey=function(e){return t._implements[e]},t.getSeriesMarkMap=function(e){return t._series[e]?t._series[e].mark:{}},t.getChartPlugins=function(){return Object.values(t._chartPlugin)},t.getComponentPlugins=function(){return Object.values(t._componentPlugin)},t.getComponentPluginInType=function(e){return t._componentPlugin[e]},t.registerFormatter=function(t){this._formatter=t},t.getFormatter=function(){return this._formatter},t._charts={},t._series={},t._components={},t._marks={},t._regions={},t._animations={},t._implements={},t._chartPlugin={},t._componentPlugin={},t.transforms={fields:wo,filter:cn,fold:Mo},t.dataParser={csv:zo,dsv:Fo,tsv:Ho},t._layout={},t}();function Sz(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return xz.apply(void 0,P([Az(t)],E(e.map(Az)),!1))}function Az(t){var e;if(!t)return t;var i=function(t){t&&(t=Object.keys(t).reduce((function(e,i){var n=t[i];return e[i]=uF(n),e}),{}));return t}(t.colorScheme);return Object.assign({},t,{colorScheme:i,token:null!==(e=t.token)&&void 0!==e?e:{},series:Object.assign({},t.series)})}var Mz,wz=["animationThreshold","colorScheme","name","padding"];function Tz(t,e,i,n){if(!t)return t;e||(e=t.colorScheme),i||(i=t.token);var r={};return Object.keys(t).forEach((function(a){var o=t[a];wz.includes(a)?r[a]=o:G(o)?sF(o)?r[a]=oF(o,e,n):pz(o)?r[a]=dz(i,o):r[a]=Tz(o,e,i,n):r[a]=o})),r}var Cz=((Mz={})[vz.name]=vz,Mz),Ez=vz.name,Pz=new Map(Object.keys(Cz).map((function(t){return[t,Cz[t]]}))),Rz=new Map(Object.keys(Cz).map((function(t){return[t,Tz(Cz[t])]}))),Bz=new Map(Object.keys(Cz).map((function(t){return[t,t===Ez]}))),Iz=function(t,e){if(t){var i=Fz(e);Pz.set(t,i),Rz.set(t,Tz(i)),Bz.set(t,!0)}},Lz=function(t,e){return void 0===t&&(t=Ez),void 0===e&&(e=!1),Bz.has(t)&&!Bz.get(t)&&Iz(t,Pz.get(t)),e?Rz.get(t):Pz.get(t)},Dz=function(t){return Pz.delete(t)&&Rz.delete(t)&&Bz.delete(t)},Oz=function(t){return!!Y(t)&&Pz.has(t)},Fz=function(t){var e,i=null!==(e=t.type)&&void 0!==e?e:Ez;return Sz({},Lz(i),t)},zz=function(){function t(){}return t.registerInstance=function(e){t.instances.set(e.id,e)},t.unregisterInstance=function(e){t.instances.delete(e.id)},t.getInstance=function(e){return t.instances.get(e)},t.instanceExist=function(e){return t.instances.has(e)},t.forEach=function(e,i,n){void 0===i&&(i=[]);var r=xt(i);return t.instances.forEach((function(t,i,n){r.includes(i)||e(t,i,n)}),n)},t.instances=new Map,t}(),Hz=function(){function t(){}return t.registerTheme=function(t,e){Iz(t,e)},t.getTheme=function(t,e){return void 0===e&&(e=!1),Lz(t,e)},t.removeTheme=function(t){return Dz(t)},t.themeExist=function(t){return Oz(t)},t.getDefaultTheme=function(){return t.themes.get(Ez)},t.setCurrentTheme=function(e){t.themeExist(e)&&(t._currentThemeName=e,zz.forEach((function(t){return null==t?void 0:t.setCurrentTheme(e)})))},t.getCurrentTheme=function(e){return void 0===e&&(e=!1),t.getTheme(t._currentThemeName,e)},t.getCurrentThemeName=function(){return t._currentThemeName},t.themes=Pz,t._currentThemeName=Ez,t}();function jz(t,e){return Y(t)?Hz.themeExist(t)?Hz.getTheme(t,e):{}:V(t)?t:{}}function Nz(t,e){if(void 0===e&&(e={data:function(t){return t}}),!t)return t;if(t.constructor===Object){var i={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e[n]){i[n]=e[n](t[n]);continue}i[n]=Nz(t[n],e)}return i}return X(t)?t.map((function(t){return Nz(t,e)})):t}function Vz(t,e){if(!t)return t;if(G(t)){var i={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(Y(t[n])&&e.getFunction(t[n])){i[n]=e.getFunction(t[n]);continue}i[n]=Vz(t[n],e)}return i}return X(t)?t.map((function(t){return Vz(t,e)})):t}var Wz=function(t,e,i,n){return function(t,e,i){return uR(t,e,i,{fontFamily:fz.fontFamily,fontSize:fz.fontSize})}(e,i,n).measure(t)},Gz="".concat(BF,"_MEASURE_CANVAS_ID"),Uz="".concat(BF,"_DEFAULT_DATA_INDEX"),Yz="".concat(BF,"_DEFAULT_DATA_KEY"),Xz="".concat(BF,"_DEFAULT_DATA_SERIES_FIELD"),Kz="".concat(BF,"_DEFAULT_SERIES_STYLE_NAME"),qz="".concat(BF,"_STACK_KEY"),Zz="".concat(BF,"_STACK_START"),Jz="".concat(BF,"_STACK_END"),Qz="".concat(BF,"_STACK_START_PERCENT"),$z="".concat(BF,"_STACK_END_PERCENT"),tH="".concat(BF,"_STACK_START_OffsetSilhouette"),eH="".concat(BF,"_STACK_END_OffsetSilhouette"),iH="".concat(BF,"_STACK_TOTAL"),nH="".concat(BF,"_STACK_TOTAL_PERCENT"),rH="".concat(BF,"_STACK_TOTAL_TOP"),aH="".concat(BF,"_STACK_TOTAL_BOTTOM"),oH="".concat(BF,"_MOSAIC_VALUE_START_PERCENT"),sH="".concat(BF,"_MOSAIC_VALUE_END_PERCENT"),lH="".concat(BF,"_MOSAIC_CAT_START_PERCENT"),uH="".concat(BF,"_MOSAIC_CAT_END_PERCENT"),cH="".concat(BF,"_SEGMENT_START"),hH="".concat(BF,"_SEGMENT_END");function dH(t,e){for(var i=0;i<e.length;i++){var n=e[i],r=pH(t,n.key);r?r.operations=P([],E(new Set(r.operations.concat(n.operations))),!1):t.push(n)}return t}function pH(t,e){return t.find((function(t){return t.key===e}))}function fH(t,e){var i;if(!t)return null!=e?e:null;var n=t.getFields();return n&&n[e]?null!==(i=n[e].alias)&&void 0!==i?i:e:null!=e?e:null}function vH(t,e,i){var n=t.getStackSort(),r={},a=null;return n&&(a={},t.getSeries().forEach((function(t){var e=t.getSeriesField();if(e){var i=t.getRawDataStatisticsByField(e);i.values&&(a[e]||(a[e]={lastIndex:0,sort:{}}),i.values.forEach((function(t,i){t in a[e].sort||(a[e].sort[t]=a[e].lastIndex,a[e].lastIndex++)})))}}))),t.getSeries().forEach((function(t){var n,o=t.getStackData(),s=t.getStackValue(),l=t.getStackValueField(),u=!i||i(t);o&&l&&u&&(r[s]=null!==(n=r[s])&&void 0!==n?n:{groupField:o.groupField,nodes:{}},kH(t,o,r[s],l,e,a))})),n?gH(r):r}function gH(t,e){var i;for(var n in t)(null===(i=t[n].sortDatums)||void 0===i?void 0:i.length)?(t[n].sortDatums.sort((function(t,e){return t.index-e.index})),t[n].values=t[n].sortDatums.map((function(t){return t.datum}))):gH(t[n].nodes);return t}function yH(t,e){if("values"in t&&t.values.length){var i=NO(t.values,e),n=jO(t.values,$z);t.values.forEach((function(t){t[iH]=i,t[nH]=n}))}else for(var r in t.nodes)yH(t.nodes[r],e)}function mH(t,e){var i,n;if("values"in t&&t.values.length)N(null===(i=t.values[0])||void 0===i?void 0:i[iH])?t.total=null===(n=t.values[0])||void 0===n?void 0:n[iH]:t.total=NO(t.values,e);else{for(var r in t.nodes)mH(t.nodes[r],e);t.nodes&&(t.total=NO(Object.keys(t.nodes).map((function(e){return t.nodes[e]})),"total"))}}function _H(t,e,i){var n;if(e.groupField&&e.nodes){var r=(null===(n=t.getRawDataStatisticsByField(e.groupField,!1))||void 0===n?void 0:n.values)||[],a={key:"".concat(e.groupField),values:r.map((function(t){var i=e.nodes[t];return{groupValue:t,value:i.total,end:i.total}}))};xH(a,!1,!0,!1,{key:"groupField",start:"start",end:"end",startPercent:"startPercent",endPercent:"endPercent"}),a.values.forEach((function(t){e.nodes[t.groupValue].mosaicData=t}))}else if("values"in e&&e.values.length&&i&&i.length){for(var o=i.length,s=0,l=1,u=0,c=1,h=0;h<o;h++)if(h%2==0){var d=l-s;l=s+i[h].endPercent*d,s+=i[h].startPercent*d}else{var p=c-u;c=u+i[h].endPercent*p,u+=i[h].startPercent*p}o%2==0?e.values.forEach((function(t){var e=l-s;t[uH]=s+e*t[$z],t[lH]=s+e*t[Qz],t[sH]=c,t[oH]=u})):e.values.forEach((function(t){var e=c-u;t[sH]=u+e*t[$z],t[oH]=u+e*t[Qz],t[uH]=l,t[lH]=s}))}for(var f in e.nodes)_H(t,e.nodes[f],e.nodes[f].mosaicData?i?P(P([],E(i),!1),[e.nodes[f].mosaicData],!1):[e.nodes[f].mosaicData]:null)}function bH(t){if(t.values.length)for(var e=t.values[t.values.length-1][Jz]/2,i=0;i<t.values.length;i++)t.values[i][tH]=t.values[i][Zz]-e,t.values[i][eH]=t.values[i][Jz]-e}function xH(t,e,i,n,r){void 0===r&&(r={key:qz,start:Zz,end:Jz,startPercent:Qz,endPercent:$z,max:rH,min:aH});var a=n&&N(r.min),o=n&&N(r.max);if(t.values.length>0){for(var s=0,l=0,u=1,c=0,h=null,d=null,p=t.values.length,f=0;f<p;f++){(c=(v=t.values[e?p-1-f:f])[r.end])>=0?(v[r.start]=s,s+=v[r.end],v[r.end]=s):(v[r.start]=l,l+=v[r.end],v[r.end]=l),v[r.key]=t.key,o&&(delete v[r.max],(!d||v[r.end]>d[r.end])&&(d=v)),a&&(delete v[r.min],(!h||v[r.start]<h[r.start])&&(h=v))}if(o&&d&&(d[r.max]=!0),a&&h&&(h[r.min]=!0),i)for(f=0;f<p;f++){var v,g=(c=(v=t.values[e?p-1-f:f])[r.end])>=0?s:l;u=c>=0?1:-1,v[r.startPercent]=0===g?0:Math.min(1,v[r.start]/g)*u,v[r.endPercent]=0===g?0:Math.min(1,v[r.end]/g)*u}}for(var y in t.nodes)xH(t.nodes[y],e,i,n,r)}function kH(t,e,i,n,r,a,o){var s,l;if("values"in e)if(r&&e.values.forEach((function(t){return t[Jz]=function(t){if(Q(t))return t;var e=+t;return Q(e)?e:0}(t[n])})),i.series.push({s:t,values:e.values}),a){var u=t.getSeriesField();e.values.forEach((function(e){i.sortDatums.push({series:t,datum:e,index:u?a[u].sort[e[u]]:0})}))}else(s=i.values).push.apply(s,P([],E(e.values),!1));else for(var c in e.nodes){var h=o?"".concat(o,"_").concat(c):c;i.nodes[c]||(i.nodes[c]={values:[],series:[],nodes:{},sortDatums:[],key:h},N(null===(l=e.nodes[c])||void 0===l?void 0:l.groupField)&&(i.nodes[c].groupField=e.nodes[c].groupField)),kH(t,e.nodes[c],i.nodes[c],n,r,a,h)}}var SH,AH,MH,wH,TH,CH,EH,PH,RH,BH,IH,LH,DH,OH,FH,zH=function(t,e,i,n){void 0===i&&(i="key"),void 0===n&&(n="children");for(var r=0;r<t.length;r++){var a=t[r];if(a[i]===e)return a;if(a[n]){var o=zH(a[n],e,i,n);if(o)return o}}return null},HH=function(t,e,i,n){void 0===i&&(i="key"),void 0===n&&(n="children");for(var r=0;r<t.length;r++){var a=t[r];if(a[n])for(var o=0;o<a[n].length;o++){var s=a[n][o];if(s[i]===e)return a;var l=HH([s],e,i,n);if(l)return l}}return null};function jH(t,e,i,n,r){return void 0===n&&(n="value"),void 0===r&&(r="children"),Array.isArray(t)?t.map((function(t){var a=A({},t);return Array.isArray(a[r])&&(a[r]=jH(a[r],e,i,n,r)),a})).filter((function(t){return+t[n]>=e&&+t[n]<=i||t[r]&&t[r].length>0})):t}function NH(t){void 0===t&&(t={});var e=A({},t);if(H(t.style)?e.style=function(e,i,n,r){return GH(t.style(e,i,n,r))}:ot(t.style)||(e.style=GH(t.style)),!ot(t.state)){var i={};Object.keys(t.state).forEach((function(e){H(t.state[e])?i[e]=function(i,n,r,a){return GH(t.state[e](i,n,r,a))}:ot(t.state[e])||(i[e]=GH(t.state[e]))})),e.state=i}return e}function VH(t){if(ot(t))return null;var e={};return Object.keys(t).forEach((function(i){H(t[i])?e[i]=function(e,n,r,a){return GH(t[i](e,n,r,a))}:ot(t[i])||(e[i]=GH(t[i]))})),e}function WH(t,e){if(ot(t))return null;var i={};return Object.keys(t).forEach((function(n){H(t[n])?i[n]=t[n](e):i[n]=t[n]})),GH(i)}function GH(t){return(null==t?void 0:t.angle)&&(t.angle=we(t.angle)),t}!function(t){t.enter="enter",t.update="update",t.exit="exit",t.group="group",t.connectNulls="connectNulls"}(SH||(SH={})),function(t){t.enter="enter",t.update="update",t.exit="exit",t.unChange="unChange"}(AH||(AH={})),function(t){t.arc="arc",t.arc3d="arc3d",t.area="area",t.image="image",t.line="line",t.path="path",t.rect="rect",t.rect3d="rect3d",t.rule="rule",t.shape="shape",t.symbol="symbol",t.text="text",t.richtext="richtext",t.polygon="polygon",t.pyramid3d="pyramid3d",t.circle="circle",t.cell="cell",t.interval="interval",t.group="group",t.glyph="glyph",t.component="component",t.largeRects="largeRects",t.largeSymbols="largeSymbols"}(MH||(MH={})),function(t){t.axis="axis",t.grid="grid",t.legend="legend",t.slider="slider",t.label="label",t.datazoom="datazoom",t.player="player",t.title="title",t.scrollbar="scrollbar"}(wH||(wH={})),function(t){t[t.player=1]="player",t[t.rollUp=2]="rollUp",t[t.drillDown=3]="drillDown",t[t.slider=4]="slider",t[t.datazoom=5]="datazoom",t[t.legend=6]="legend",t[t.scrollbar=7]="scrollbar",t[t.brush=8]="brush",t[t.normal=9]="normal"}(TH||(TH={})),function(t){t.lineAxis="lineAxis",t.circleAxis="circleAxis"}(CH||(CH={})),function(t){t.lineAxisGrid="lineAxisGrid",t.circleAxisGrid="circleAxisGrid"}(EH||(EH={})),function(t){t.discreteLegend="discreteLegend",t.colorLegend="colorLegend",t.sizeLegend="sizeLegend"}(PH||(PH={})),function(t){t.lineCrosshair="lineCrosshair",t.rectCrosshair="rectCrosshair",t.sectorCrosshair="sectorCrosshair",t.circleCrosshair="circleCrosshair",t.polygonCrosshair="polygonCrosshair",t.ringCrosshair="ringCrosshair"}(RH||(RH={})),function(t){t.symbolLabel="symbolLabel",t.rectLabel="rectLabel",t.lineLabel="lineLabel",t.dataLabel="dataLabel"}(BH||(BH={})),function(t){t.continuousPlayer="continuousPlayer",t.discretePlayer="discretePlayer"}(IH||(IH={})),function(t){t.before="before",t.layouting="layouting",t.reevaluate="reevaluate",t.after="after"}(LH||(LH={})),function(t){t.BEFORE_EVALUATE_DATA="beforeEvaluateData",t.AFTER_EVALUATE_DATA="afterEvaluateData",t.BEFORE_EVALUATE_SCALE="beforeEvaluateScale",t.AFTER_EVALUATE_SCALE="afterEvaluateScale",t.BEFORE_PARSE_VIEW="beforeParseView",t.AFTER_PARSE_VIEW="afterParseView",t.BEFORE_TRANSFORM="beforeTransform",t.AFTER_TRANSFORM="afterTransform",t.BEFORE_CREATE_VRENDER_STAGE="beforeCreateVRenderStage",t.AFTER_CREATE_VRENDER_STAGE="afterCreateVRenderStage",t.BEFORE_CREATE_VRENDER_LAYER="beforeCreateVRenderLayer",t.AFTER_CREATE_VRENDER_LAYER="afterCreateVRenderLayer",t.BEFORE_STAGE_RESIZE="beforeStageResize",t.AFTER_STAGE_RESIZE="afterStageResize",t.BEFORE_VRENDER_DRAW="beforeVRenderDraw",t.AFTER_VRENDER_DRAW="afterVRenderDraw",t.BEFORE_MARK_JOIN="beforeMarkJoin",t.AFTER_MARK_JOIN="afterMarkJoin",t.BEFORE_MARK_UPDATE="beforeMarkUpdate",t.AFTER_MARK_UPDATE="afterMarkUpdate",t.BEFORE_MARK_STATE="beforeMarkState",t.AFTER_MARK_STATE="afterMarkState",t.BEFORE_MARK_ENCODE="beforeMarkEncode",t.AFTER_MARK_ENCODE="afterMarkEncode",t.BEFORE_DO_LAYOUT="beforeDoLayout",t.AFTER_DO_LAYOUT="afterDoLayout",t.BEFORE_MARK_LAYOUT_END="beforeMarkLayoutEnd",t.AFTER_MARK_LAYOUT_END="afterMarkLayoutEnd",t.BEFORE_DO_RENDER="beforeDoRender",t.AFTER_DO_RENDER="afterDoRender",t.BEFORE_MARK_RENDER_END="beforeMarkRenderEnd",t.AFTER_MARK_RENDER_END="afterMarkRenderEnd",t.BEFORE_CREATE_VRENDER_MARK="beforeCreateVRenderMark",t.AFTER_CREATE_VRENDER_MARK="afterCreateVRenderMark",t.BEFORE_ADD_VRENDER_MARK="beforeAddVRenderMark",t.AFTER_ADD_VRENDER_MARK="afterAddVRenderMark",t.AFTER_VRENDER_NEXT_RENDER="afterVRenderNextRender",t.BEFORE_ELEMENT_UPDATE_DATA="beforeElementUpdateData",t.AFTER_ELEMENT_UPDATE_DATA="afterElementUpdateData",t.BEFORE_ELEMENT_STATE="beforeElementState",t.AFTER_ELEMENT_STATE="afterElementState",t.BEFORE_ELEMENT_ENCODE="beforeElementEncode",t.AFTER_ELEMENT_ENCODE="afterElementEncode",t.ANIMATION_START="animationStart",t.ANIMATION_END="animationEnd",t.ELEMENT_ANIMATION_START="elementAnimationStart",t.ELEMENT_ANIMATION_END="elementAnimationEnd",t.ALL_ANIMATION_START="allAnimationStart",t.ALL_ANIMATION_END="allAnimationEnd"}(DH||(DH={})),function(t){t.signal="signal",t.data="data",t.scale="scale",t.coordinate="coordinate",t.mark="mark"}(OH||(OH={})),function(t){t.active="active",t.selected="selected",t.highlight="highlight",t.blur="blur"}(FH||(FH={}));var UH="__vgrammar_scene_item__",YH=[MH.line,MH.area],XH=[MH.arc3d,MH.rect3d,MH.pyramid3d],KH="key",qH=[{}],ZH=["key"],JH="VGRAMMAR_IMMEDIATE_ANIMATION",QH=0,$H=1e3,tj=0,ej=0,ij=!1,nj=!1,rj="quintInOut",aj={stopWhenStateChange:!1,immediatelyApply:!0},oj="_mo_hide_";function sj(t,e){return xt(t).reduce((function(t,i){var n=Y(i)?e.getGrammarById(i):i;return n&&t.push(n),t}),[])}function lj(t,e){if(j(t))return[];if(function(t){return!H(t)&&!!(null==t?void 0:t.signal)}(t)){var i=t.signal;if(Y(i))return xt(e.getGrammarById(i));if("signal"===(null==i?void 0:i.grammarType))return[i]}else if(function(t){return!H(t)&&!!(null==t?void 0:t.callback)}(t))return sj(t.dependency,e);return[]}function uj(t){return H(t)||(null==t?void 0:t.signal)||!!(null==t?void 0:t.callback)}function cj(t,e,i,n){if(j(t))return t;if(H(t))return n?t.call(null,i,n,e):t.call(null,i,e);if(t.signal){var r=t.signal;return Y(r)?null==e?void 0:e[r]:r.output()}return t.callback?n?t.callback.call(null,i,n,e):t.callback.call(null,i,e):t}function hj(t,e){return dj(t)?t.output():e[t]}var dj=function(t){return t&&!j(t.grammarType)},pj=function(t){return H(t)?t:function(e){return e[t]}};function fj(t){return!!(null==t?void 0:t.scale)}function vj(t){return!!(null==t?void 0:t.field)}function gj(t,e){if(!t)return[];var i=[];return t.scale&&(i=dj(t.scale)?[t.scale]:xt(e.getScaleById(t.scale))),i.concat(lj(t,e))}function yj(t,e){switch(e){case"line":return t.some((function(t){return["x","y","defined"].includes(t)}));case"area":return t.some((function(t){return["x","y","x1","y1","defined"].includes(t)}));case"largeRects":return t.some((function(t){return["x","y","width","y1"].includes(t)}));case"largeSymbols":return t.some((function(t){return["x","y"].includes(t)}))}return!1}function mj(t,e,i,n,r){i&&(uj(i)?e.forEach((function(e){var r=cj(i,n,e.datum,t);Object.assign(e.nextAttrs,r)})):Object.keys(i).forEach((function(a){var o,s,l=i[a],u=r&&!function(t,e){if(["x","y","dx","dy"].includes(e))return!0;switch(t){case MH.arc:return["innerRadius","outerRadius","startAngle","endAngle"].includes(e);case MH.group:case MH.rect:case MH.image:return["width","height","y1"].includes(e);case MH.path:case MH.shape:return["path","customPath"].includes(e);case MH.line:return"defined"===e;case MH.area:return["x1","y1","defined"].includes(e);case MH.rule:return["x1","y1"].includes(e);case MH.symbol:return"size"===e;case MH.polygon:return"points"===e;case MH.text:return"text"===e}return!1}(t.mark.markType,a)?[e[0]]:e;if(fj(l)){var c=hj(l.scale,n),h=null!==(o=null==l?void 0:l.offset)&&void 0!==o?o:0,d=!j(l.band)&&c.bandwidth?c.bandwidth()*l.band:null,p=Y(null==l?void 0:l.field),f=p?Qk(l.field):null,v=p?null:j(null==l?void 0:l.value)?0:null===(s=c.scale)||void 0===s?void 0:s.call(c,l.value);u.forEach((function(t){var e;p&&(v=null===(e=c.scale)||void 0===e?void 0:e.call(c,f(t.datum))),t.nextAttrs[a]=Z(v)||Z(d)?v+h+d:v}))}else if(vj(l)){var g=Qk(l.field);u.forEach((function(t){t.nextAttrs[a]=g(t.datum)}))}else u.forEach((function(e){e.nextAttrs[a]=cj(l,n,e.datum,t)}))})))}function _j(t,e,i,n){if(!t)return null;if(uj(t))return cj(t,n,e,i);var r={};return Object.keys(t).forEach((function(a){var o,s,l,u=t[a];if(fj(u)){var c=hj(u.scale,n),h=null!==(o=null==u?void 0:u.offset)&&void 0!==o?o:0,d=!j(u.band)&&c.bandwidth?c.bandwidth()*u.band:null,p=Y(null==u?void 0:u.field),f=p?Qk(u.field):null,v=p?null===(s=c.scale)||void 0===s?void 0:s.call(c,f(e)):j(null==u?void 0:u.value)?0:null===(l=c.scale)||void 0===l?void 0:l.call(c,u.value);r[a]=Z(v)||Z(d)?v+h+d:v}else if(vj(u)){var g=Qk(u.field);r[a]=g(e)}else r[a]=cj(u,n,e,i)})),r}var bj=function(){return o((function t(e,i,n,a){r(this,t),this.channelEncoder={},this.marks=e,i&&this.registerChannelEncoder(i),n&&this.registerDefaultEncoder(n),this.progressiveChannels&&this.registerProgressiveChannels(a)}),[{key:"getMarks",value:function(){return this.marks}},{key:"registerChannelEncoder",value:function(t,e){return Y(t)?this.channelEncoder[t]=e:Object.assign(this.channelEncoder,t),this}},{key:"registerFunctionEncoder",value:function(t){return this.functionEncoder=t,this}},{key:"registerDefaultEncoder",value:function(t){return this.defaultEncoder=t,this}},{key:"registerProgressiveChannels",value:function(t){return this.progressiveChannels=xt(t),this}},{key:"getChannelEncoder",value:function(){return this.channelEncoder}},{key:"getFunctionEncoder",value:function(){return this.functionEncoder}},{key:"getDefaultEncoder",value:function(){return this.defaultEncoder}},{key:"getProgressiveChannels",value:function(){return this.progressiveChannels}}])}(),xj=function(){function t(){r(this,t)}return o(t,null,[{key:"registerPlotMarks",value:function(e,i){t._plotMarks[e]=i}},{key:"createPlotMark",value:function(e,i){return t._plotMarks[e]?new t._plotMarks[e](i):null}},{key:"registerMark",value:function(e,i){t._marks[e]=i}},{key:"createMark",value:function(e,i,n){return t._marks[e]?new t._marks[e](i,e,n):null}},{key:"hasMark",value:function(e){return!!t._marks[e]}},{key:"getMark",value:function(e){return t._marks[e]}},{key:"registerComponent",value:function(e,i){t._components[e]=i}},{key:"createComponent",value:function(e,i,n,r){var a=t._components[e];return a?new a(i,n,r):null}},{key:"hasComponent",value:function(e){return!!t._components[e]}},{key:"registerGraphicComponent",value:function(e,i){t._graphicComponents[e]=i}},{key:"createGraphicComponent",value:function(e,i,n){var r=t._graphicComponents[e];return r?r(i,n):null}},{key:"registerTransform",value:function(e,i,n){t._transforms[e]=Object.assign(i,{type:e,isBuiltIn:!!n})}},{key:"getTransform",value:function(e){return t._transforms[e]}},{key:"unregisterRuntimeTransforms",value:function(){Object.keys(t._transforms).forEach((function(e){t._transforms[e]&&!t._transforms[e].isBuiltIn&&(t._transforms[e]=null)}))}},{key:"registerGrammar",value:function(e,i,n){t._grammars[e]={grammarClass:i,specKey:null!=n?n:e}}},{key:"createGrammar",value:function(e,i,n){var r,a=null===(r=t._grammars[e])||void 0===r?void 0:r.grammarClass;return a?new a(i,n):null}},{key:"getGrammars",value:function(){return this._grammars}},{key:"getGlyph",value:function(e){return t._glyphs[e]}},{key:"createInteraction",value:function(e,i,n){var r=t._interactions[e];return r?new r(i,n):null}},{key:"hasInteraction",value:function(e){return!!t._interactions[e]}}])}();xj._plotMarks={},xj._marks={},xj._components={},xj._graphicComponents={},xj._transforms={},xj._grammars={},xj._glyphs={},xj._animations={},xj._interactions={},xj._graphics={},xj._stageEventPlugins={},xj.registerGlyph=function(t,e,i,n,r){return xj._glyphs[t]=new bj(e,i,n,r),xj._glyphs[t]},xj.registerAnimationType=function(t,e){xj._animations[t]=e},xj.getAnimationType=function(t){return xj._animations[t]},xj.registerInteraction=function(t,e){xj._interactions[t]=e},xj.registerGraphic=function(t,e){xj._graphics[t]=e},xj.getGraphicType=function(t){return xj._graphics[t]},xj.createGraphic=function(t,e){var i=xj._graphics[t];return i?i(e):null},xj.registerDefaultLayout=function(t){xj.defaultLayout=t},xj.getDefaultLayout=function(){return xj.defaultLayout},xj.registerStageEventPlugin=function(t,e){xj._stageEventPlugins[t]=e},xj.getStageEventPlugin=function(t){return xj._stageEventPlugins[t]};function kj(t,e){var i,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=xj.getGraphicType(e)?xj.createGraphic(e,n):xj.createGraphicComponent(e,n,{skipDefault:null===(i=null==t?void 0:t.spec)||void 0===i?void 0:i.skipTheme});return r||Lt.getInstance().error("create ".concat(e," graphic failed!")),r}var Sj=function(t){t&&(t[UH]=null,t.release(),t.parent&&t.parent.removeChild(t))},Aj=["fillOpacity"],Mj=function(t,e,i){var n;return"fillOpacity"===e?(t.fillOpacity=null!==(n=i.fillOpacity)&&void 0!==n?n:1,["fillOpacity"]):[]};var wj=l(l(l({rect3d:[{channels:["x","y","z","x1","y1","width","height","length"],transform:function(t,e,i){var n,r,a,o,s,l,u,c,h,d,p,f;Q(e.width)||!Q(e.x1)&&Q(i.width)?(t.x=Math.min(null!==(n=i.x)&&void 0!==n?n:0,null!==(r=i.x1)&&void 0!==r?r:1/0),t.width=i.width):Q(e.x1)||!Q(e.width)&&Q(i.x1)?(t.x=Math.min(i.x,i.x1),t.width=Math.abs(i.x1-i.x)):(t.x=Math.min(null!==(a=i.x)&&void 0!==a?a:0,null!==(o=i.x1)&&void 0!==o?o:1/0),t.width=i.width),Q(e.height)||!Q(e.y1)&&Q(i.height)?(t.y=Math.min(null!==(s=i.y)&&void 0!==s?s:0,null!==(l=i.y1)&&void 0!==l?l:1/0),t.height=i.height):Q(e.y1)||!Q(e.height)&&Q(i.y1)?(t.y=Math.min(i.y,i.y1),t.height=Math.abs(i.y1-i.y)):(t.y=Math.min(null!==(u=i.y)&&void 0!==u?u:0,null!==(c=i.y1)&&void 0!==c?c:1/0),t.height=i.height),Q(e.length)||!Q(e.z1)&&Q(i.length)?(t.z=Math.min(null!==(h=i.z)&&void 0!==h?h:0,null!==(d=i.z1)&&void 0!==d?d:1/0),t.length=i.length):Q(e.z1)||!Q(e.length)&&Q(i.z1)?(t.z=Math.min(i.z,i.z1),t.length=Math.abs(i.z1-i.z)):(t.z=Math.min(null!==(p=i.z)&&void 0!==p?p:0,null!==(f=i.z1)&&void 0!==f?f:1/0),t.length=i.length)},storedAttrs:"sizeAttrs"}]},MH.text,[{channels:["text","limit","autoLimit","maxLineWidth","textType","_originText"],transform:function(t,e,i){var n,r,a,o,s=null!==(n=i.limit)&&void 0!==n?n:1/0,l=null!==(r=i.autoLimit)&&void 0!==r?r:1/0,u=Math.min(s,l),c=G(i.text)&&!j(i.text.text),h=c?i.text.text:i.text;t.maxLineWidth=u===1/0?i.maxLineWidth:u,c||i.textType?"rich"===i.text.type||"rich"===i.textType?t.textConfig=h:"html"===i.text.type?(t.html=h,t.text=null!==(a=i._originText)&&void 0!==a?a:"",t.renderable=!1):"react"===i.text.type?(t.react=h,t.text=null!==(o=i._originText)&&void 0!==o?o:"",t.renderable=!1):t.text=h:t.text=h},storedAttrs:"limitAttrs"}]),MH.rule,[{channels:["x","y","x1","y1"],transform:function(t,e,i){var n=function(t){var e=t.x,i=t.y,n=t.x1,r=t.y1;return Q(e)&&Q(i)&&Q(n)&&Q(r)?[{x:e,y:i},{x:n,y:r}]:[]}(i);t.points=n,t.x=0,t.y=0},storedAttrs:"pointAttrs"}]),MH.symbol,[{channels:["shape","symbolType"],transform:function(t,e,i){var n;t.symbolType=null!==(n=e.shape)&&void 0!==n?n:e.symbolType}},{channels:["image","fill","background"],transform:function(t,e,i){e.image?(t.background=e.image,t.fill=!1):i.image?(t.background=i.image,t.fill=!1):(t.fill=i.fill,t.background=i.background)},storedAttrs:"imageAttrs"}]);var Tj=function(t,e,i,n){var r={},a=e?Object.keys(e):[],o=Y(t)?wj[t]:t;if(o&&o.length){var s=[];a.forEach((function(t){var a=!1;o.forEach((function(o,l){if(o.channels.includes(t)){if(!s[l])if(o.storedAttrs){var u=function(t,e,i,n,r,a){var o=r.getGraphicAttribute(t,!1,a);if(o)return e.forEach((function(t){t in n&&(o[t]=n[t])})),o;var s={};return e.forEach((function(t){s[t]=n[t]})),i[t]=s,s}(o.storedAttrs,o.channels,r,e,i,n);o.transform(r,e,u)}else o.transform(r,e,null);s[l]=!0,a=!0}})),a||(Aj.includes(t)?Mj(r,t,e):r[t]=e[t])}))}else a.forEach((function(t){Aj.includes(t)?Mj(r,t,e):r[t]=e[t]}));return r},Cj=function(t,e,i){return!(!j(t)||!j(e))||!j(t)&&!j(e)&&("lineDash"===i?function(t,e){return t.length===e.length&&t.join("-")===e.join("-")}(t,e):"stroke"===i||"fill"===i?function(t,e){if(t===e)return!0;if(b(t)!=b(e))return!1;if(Y(t))return!1;if(t.gradient!==e.gradient)return!1;var i=Object.keys(t),n=Object.keys(e);return i.length===n.length&&i.every((function(i){return"stops"===i?function(t,e){var i,n;if(t===e)return!0;var r=null!==(i=t&&t.length)&&void 0!==i?i:0;return r===(null!==(n=e&&e.length)&&void 0!==n?n:0)&&0!==r&&t.every((function(t,i){return!t&&!e[i]||t&&e[i]&&t.color===e[i].color&&t.offset===e[i].offset}))}(t[i],e[i]):t[i]===e[i]}))}(t,e):t===e)},Ej=["stroke","strokeOpacity","lineDash","lineDashOffset","lineCap","lineJoin","lineWidth","miterLimit"],Pj=["fill","fillOpacity","background","texture","texturePadding","textureSize","textureColor"].concat(Ej);function Rj(t,e,i){var n;if(!t||t.length<=1)return null;var r="area"===(null===(n=null==i?void 0:i.mark)||void 0===n?void 0:n.markType)?Pj:Ej,a=[],o=null;return t.forEach((function(t,e){o&&r.every((function(e){return Cj(o[e],t[e],e)}))||(a.length&&(a[a.length-1].endIndex=e),o=t,a.push({attrs:o,startIndex:e}))})),a.length>=2?a.map((function(t){var i=Bj(t.attrs);return i.points=e.slice(t.startIndex,j(t.endIndex)?e.length:t.endIndex),i})):null}function Bj(t){var e={};if(!t)return e;var i=["x","y","x1","y1","defined","size","width","height","context"];return Object.keys(t).forEach((function(n){i.includes(n)||(e[n]=t[n])})),e}var Ij=function(){return o((function t(e){var i=this;r(this,t),this.data=null,this.states=[],this.diffState=AH.enter,this.isReserved=!1,this.runtimeStatesEncoder=null,this.items=[],this.getStateAttrs=function(t,e){var n,r,a,o,s=!j(null===(n=i.runtimeStatesEncoder)||void 0===n?void 0:n[t]),u=s?Object.assign(Object.assign({},null===(r=i.mark.getSpec().encode)||void 0===r?void 0:r[t]),i.runtimeStatesEncoder[t]):null===(a=i.mark.getSpec().encode)||void 0===a?void 0:a[t];if(!u)return{};if(H(u))return u(i.getDatum(),i,t,e);if(!s&&(null===(o=i.graphicItem.states)||void 0===o?void 0:o[t]))return i.graphicItem.states[t];var c=i.items.map((function(t){return Object.assign({},t,{nextAttrs:{}})}));mj(i,c,u,i.mark.parameters());var h=i.transformElementItems(c,i.mark.markType);return i.graphicItem.states?i.graphicItem.states[t]||(i.graphicItem.states[t]=h):i.graphicItem.states=l({},t,h),h},this.mark=e}),[{key:"initGraphicItem",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.graphicItem){var i=this.mark.getAttributeTransforms();if(this.graphicItem=this.mark.addGraphicItem(i?Tj(i,e,this):e,this.groupKey),this.graphicItem){var n=this.mark.getSpec().graphicName;Y(n)?this.graphicItem.name=n:H(n)&&(this.graphicItem.name=n(this)),this.graphicItem[UH]=this,i&&(this.graphicItem.onBeforeAttributeUpdate=function(e){return t.mark?Tj(i,e,t):e}),this.clearGraphicAttributes(),this.mark.needAnimate()&&(this.setPrevGraphicAttributes(null),this.setNextGraphicAttributes(Object.assign({},e)),this.setFinalGraphicAttributes(Object.assign({},e)))}}}},{key:"updateGraphicItem",value:function(){var t;if(this.graphicItem){this.diffState===AH.exit?this.graphicItem.releaseStatus="willRelease":this.graphicItem.releaseStatus=void 0;var e=null===(t=this.mark.animate)||void 0===t?void 0:t.getAnimationConfigs("state");e&&0!==e.length&&(this.graphicItem.stateAnimateConfig=e[0].originConfig)}}},{key:"getGraphicItem",value:function(){return this.graphicItem}},{key:"removeGraphicItem",value:function(){var t,e;this.graphicItem&&(null===(e=null===(t=this.graphicItem.animates)||void 0===t?void 0:t.forEach)||void 0===e||e.call(t,(function(t){return t.stop()}))),this.graphicItem&&(Sj(this.graphicItem),this.graphicItem[UH]=null,this.graphicItem=null)}},{key:"resetGraphicItem",value:function(){this.graphicItem&&(this.graphicItem=null)}},{key:"getBounds",value:function(){var t;return null===(t=this.graphicItem)||void 0===t?void 0:t.AABBBounds}},{key:"getStates",value:function(){return this.states}},{key:"updateData",value:function(t,e,i){var n,r=this;this.mark.emit(DH.BEFORE_ELEMENT_UPDATE_DATA,{groupKey:t,data:e,key:i},this),this.data=e;var a=pj(i);return this.items=e.map((function(t){return{datum:t,key:a(t),view:r.mark.view,nextAttrs:{}}})),this.groupKey=t,this.key=this.mark.isCollectionMark()?t:null===(n=this.items)||void 0===n?void 0:n[0].key,this.mark.emit(DH.AFTER_ELEMENT_UPDATE_DATA,{groupKey:t,data:e,key:i},this),this.items}},{key:"state",value:function(t,e){var i,n=this.mark.isCollectionMark(),r=this.states,a=xt(cj(t,e,this.getDatum(),this)),o=null===(i=this.mark.getSpec())||void 0===i?void 0:i.stateSort;o&&a.length&&a.sort(o);var s=a.length!==r.length||a.some((function(t,e){return t!==r[e]}));this.states=a,!n&&s&&this.diffState===AH.unChange&&(this.diffState=AH.update)}},{key:"encodeGraphic",value:function(t){this.coordinateTransformEncode(this.items);var e=this.transformElementItems(this.items,this.mark.markType);t&&Object.assign(e,t),this.graphicItem?(this.graphicItem.clearStates(),this.graphicItem.states={},this.graphicItem.stateProxy=null,oj in this.graphicItem.attribute&&"visible"in e&&delete this.graphicItem.attribute[oj],this.applyGraphicAttributes(e)):this.initGraphicItem(e),this.diffState!==AH.enter&&this.diffState!==AH.update||!this.states.length||this.useStates(this.states),this.mark.markType===MH.shape&&(this.graphicItem.datum=this.items[0].datum),this.items.forEach((function(t){t.nextAttrs={}})),this._setCustomizedShape()}},{key:"_setCustomizedShape",value:function(){var t,e=this;if(this.graphicItem){var i=null===(t=this.mark.getSpec())||void 0===t?void 0:t.setCustomizedShape;i&&(this.graphicItem.pathProxy=function(t){return i(e.data,t,new Ru)})}}},{key:"encodeItems",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3?arguments[3]:void 0,r=this.mark.isCollectionMark(),a=e[SH.update],o=e[SH.enter],s=e[SH.exit],l=this.mark.isLargeMode()||r&&!this.mark.getSpec().enableSegments;this.diffState===AH.enter?(o&&mj(this,t,o,n,l),a&&mj(this,t,a,n,l)):this.diffState===AH.update?((r&&o||i)&&mj(this,t,o,n,l),a&&mj(this,t,a,n,l)):this.diffState===AH.exit&&s&&(i&&mj(this,t,o,n,l),mj(this,t,s,n,l))}},{key:"coordinateTransformEncode",value:function(t){if(this.mark.coord&&"arc"!==this.mark.markType&&!0!==this.mark.disableCoordinateTransform){var e=this.mark.coord.output();t.forEach((function(t){var i=t.nextAttrs,n=e.convert(i);Object.assign(i,n)}))}}},{key:"hasStateAnimation",value:function(){var t,e=null===(t=this.mark.animate)||void 0===t?void 0:t.getAnimationConfigs("state");return e&&e.length>0}},{key:"clearStates",value:function(t){var e=z(t)?t:this.hasStateAnimation();this.states=[],this.graphicItem&&this.graphicItem.clearStates(e),this.runtimeStatesEncoder&&(this.runtimeStatesEncoder={})}},{key:"_updateRuntimeStates",value:function(t,e){this.runtimeStatesEncoder||(this.runtimeStatesEncoder={}),this.runtimeStatesEncoder[t]=e}},{key:"hasState",value:function(t){return this.states&&t&&this.states.includes(t)}},{key:"updateStates",value:function(t){var e=this;if(!this.graphicItem)return!1;var i=this.states.slice(),n=this.mark.getSpec().encode,r=!1,a=!1;return Object.keys(t).forEach((function(o){var s;if(o){var l=t[o];if(V(l)&&!mt(l,null===(s=e.runtimeStatesEncoder)||void 0===s?void 0:s[o]))i.includes(o)?r=!0:i.push(o),e._updateRuntimeStates(o,l),a=!0;else if(l)!i.includes(o)&&(null==n?void 0:n[o])&&(i.push(o),a=!0);else if(i.length){var u=i.filter((function(t){return t!==o}));u.length!==i.length&&(a=!0,i=u),e.runtimeStatesEncoder&&e.runtimeStatesEncoder[o]&&(e.runtimeStatesEncoder[o]=null)}}})),r&&this.graphicItem.clearStates(),!!a&&(this.useStates(i),!0)}},{key:"addState",value:function(t,e){var i;if(!this.graphicItem)return!1;if(e&&Y(t)&&!mt(e,null===(i=this.runtimeStatesEncoder)||void 0===i?void 0:i[t])){var n=this.states.slice();return n.includes(t)?this.graphicItem.clearStates():n.push(t),this._updateRuntimeStates(t,e),this.useStates(n),!0}var r=this.mark.getSpec().encode,a=xt(t).reduce((function(t,e){return e&&!t.includes(e)&&(null==r?void 0:r[e])&&t.push(e),t}),this.states.slice());return a.length!==this.states.length&&(this.useStates(a),!0)}},{key:"removeState",value:function(t){var e=this;if(!this.graphicItem)return!1;var i=xt(t);if(!i.length)return!1;var n=this.states.filter((function(t){return!i.includes(t)}));return n.length!==this.states.length&&(this.runtimeStatesEncoder&&i.forEach((function(t){e.runtimeStatesEncoder[t]=null})),this.useStates(n),!0)}},{key:"useStates",value:function(t,e){var i;if(!this.graphicItem)return!1;this.mark.emit(DH.BEFORE_ELEMENT_STATE,{states:t},this);var n=null===(i=this.mark.getSpec())||void 0===i?void 0:i.stateSort;n&&t.sort(n),this.states=t;var r=z(e)?e:this.hasStateAnimation();return this.graphicItem.stateProxy=this.getStateAttrs,this.graphicItem.useStates(this.states,r),this.mark.emit(DH.AFTER_ELEMENT_STATE,{states:t},this),!0}},{key:"diffAttributes",value:function(t){var e={},i=this.getFinalGraphicAttributes();for(var n in t)ut(i,n)&&mt(i[n],t[n])||(e[n]=t[n]);return e}},{key:"transformElementItems",value:function(t,e,i){var n,r,a,o,s,l=t[0];if(!l.nextAttrs||0===Object.keys(l.nextAttrs).length)return{};var u=l.nextAttrs;if(function(t){return[MH.line,MH.area,MH.largeRects,MH.largeSymbols].includes(t)}(e)&&t&&t.length&&j(null===(n=l.nextAttrs)||void 0===n?void 0:n.points)&&(!0===i||yj(Object.keys(l.nextAttrs),this.mark.markType))){var c=this.mark.getSpec(),h=this.getGraphicAttribute("points",!1),d=this.getGraphicAttribute("segments",!1),p=c.enableSegments,f=null===(r=this.mark.getSpec().encode)||void 0===r?void 0:r[SH.connectNulls],v=t.map((function(t){return t.nextAttrs})),g=this.mark.isProgressive();if(u=Bj(u),e===MH.line||e===MH.area){var y=function(t,e,i,n){return t&&t.length&&(1!==t.length||e)?t.some((function(t){return yj(Object.keys(t.nextAttrs),"line")}))?t.map((function(t,e){var r,a=t.nextAttrs,o=null!==(r=null==i?void 0:i[e])&&void 0!==r?r:{},s=o.x,l=o.y,u=o.x1,c=o.y1,h=o.defined;return j(a.x)&&(a.x=s),j(a.y)&&(a.y=l),j(a.defined)&&!1===h&&(a.defined=!1),a.context=t.key,n&&(j(a.x1)&&(a.x1=u),j(a.y1)&&(a.y1=c)),a})):null!=i?i:[]:[]}(t,!0,h,e===MH.area);if(g)u.segments=(null!==(s=null===(o=null===(a=this.graphicItem)||void 0===a?void 0:a.attribute)||void 0===o?void 0:o.segments)&&void 0!==s?s:[]).concat([{points:y}]);else if(f){if(u.segments=function(t,e,i){if(!t||t.length<=1)return null;var n,r,a=!!i&&i.mark.getSpec().enableSegments,o=[],s=null;if(t.forEach((function(t,i){(s=e[i])&&!1!==s.defined?(n||(r={items:[],points:[]},o.push(r)),r.points.push(s),r.items.push(t),!1===n&&(r.isConnect=!0,r={items:[],points:[]},o.push(r)),n=!0):n=!1})),(o=o.filter((function(t){return t.points.length>0}))).length>=2){var l=[];return o.forEach((function(t){if(t.isConnect)l.push({points:t.points,isConnect:!0});else{if(a){var e=Rj(t.items,t.points,i);if(e)return void e.forEach((function(t){l.push(t)}))}var n=Bj(t.items[0]);n.points=t.points,l.push(n)}})),l}return a?Rj(t,e,i):null}(v,y,this),u.segments&&u.segments.some((function(t){return t.isConnect}))){var m=_j(f,this.getDatum(),this,this.mark.parameters());m&&u.segments.forEach((function(t){t.isConnect&&Object.assign(t,m)}))}u.points=y}else if(p){var _=y&&0!==y.length?y:function(t){return t?t.reduce((function(t,e){return t.concat(e.points)}),[]):null}(d),b=Rj(v,_,this);b?(u.segments=b,u.points=null):(u.segments=null,u.points=_),u=function(t,e){var i;if(!t||!t.segments||!t.segments.length)return t;var n="area"===(null===(i=null==e?void 0:e.mark)||void 0===i?void 0:i.markType)?["fillOpacity","strokeOpacity"]:["strokeOpacity"],r={};return Object.keys(t).forEach((function(e){n.includes(e)||(r[e]=t[e])})),r}(u,this)}else u.points=y,u.segments=null}else e===MH.largeRects?u.points=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(!t||!t.length||1===t.length&&!e)return[];var n=new Float32Array(4*t.length);return t.forEach((function(t,e){var r,a,o,s,l=t.nextAttrs,u=null!==(r=l.x)&&void 0!==r?r:i[4*e],c=null!==(a=l.y)&&void 0!==a?a:i[4*e+1],h=null!==(o=l.width)&&void 0!==o?o:i[4*e+2],d=null!==(s=l.y1)&&void 0!==s?s:i[4*e+3];n[4*e]=u,n[4*e+1]=c,n[4*e+2]=h,n[4*e+3]=d-c})),n}(t,!0,h):e===MH.largeSymbols&&(u.points=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(!t||!t.length||1===t.length&&!e)return[];var n=new Float32Array(2*t.length);return t.forEach((function(t,e){var r,a,o=t.nextAttrs,s=null!==(r=o.x)&&void 0!==r?r:i[2*e],l=null!==(a=o.y)&&void 0!==a?a:i[2*e+1];n[2*e]=s,n[2*e+1]=l})),n}(t,!0,h))}return u}},{key:"applyGraphicAttributes",value:function(t){var e,i,n,r=this;if(!ot(t))if(this.mark.needAnimate()){var a=this.diffAttributes(t),o=null!==(e=this.getPrevGraphicAttributes())&&void 0!==e?e:{},s=null!==(i=this.getFinalGraphicAttributes())&&void 0!==i?i:{};Object.keys(a).forEach((function(t){o[t]=r.getGraphicAttribute(t),s[t]=a[t]})),this.setNextGraphicAttributes(a),this.setPrevGraphicAttributes(o),this.setFinalGraphicAttributes(s);var l=null===(n=this.mark.animate)||void 0===n?void 0:n.getElementAnimators(this).filter((function(t){var e;return!(null===(e=t.animationOptions.timeline.controlOptions)||void 0===e?void 0:e.ignoreLoopFinalAttributes)||!t.animationOptions.timeline.loop})),u=(l||[]).reduce((function(t,e){return Object.assign(t,e.getEndAttributes())}),{}),c=Object.assign({},u,s);this.graphicItem.setAttributes(c)}else this.graphicItem.setAttributes(t)}},{key:"getGraphicAttribute",value:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.graphicItem){if(i){var n,r=this.getPrevGraphicAttributes();if(!j(n=st(r,t)))return n}var a=this.mark.getAttributeTransforms(),o=[t];if(a&&a.length){var s=a.find((function(e){return e.storedAttrs&&e.channels.includes(t)}));s&&(o=[s.storedAttrs,t])}return st(null===(e=this.graphicItem)||void 0===e?void 0:e.attribute,o)}}},{key:"setGraphicAttribute",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.graphicItem){var n=this.getFinalGraphicAttributes(),r=this.getPrevGraphicAttributes();i&&n&&(n[t]=e),r&&!ut(r,t)&&(r[t]=this.graphicItem.attribute[t]),this.graphicItem.setAttribute(t,e)}}},{key:"setGraphicAttributes",value:function(t){var e=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.graphicItem){var n=this.getFinalGraphicAttributes(),r=this.getPrevGraphicAttributes();Object.keys(t).forEach((function(a){n&&i&&(n[a]=t[a]),r&&!ut(r,a)&&(r[a]=e.graphicItem.attribute[a])})),this.graphicItem.setAttributes(t)}}},{key:"getFinalGraphicAttributes",value:function(){return this.graphicItem.finalAttrs}},{key:"setFinalGraphicAttributes",value:function(t){this.graphicItem.finalAttrs=t}},{key:"getPrevGraphicAttributes",value:function(){return this.graphicItem.prevAttrs}},{key:"setPrevGraphicAttributes",value:function(t){this.graphicItem.prevAttrs=t}},{key:"getNextGraphicAttributes",value:function(){return this.graphicItem.nextAttrs}},{key:"getFinalAnimationAttribute",value:function(t){var e,i;return null!==(i=null===(e=this.getFinalGraphicAttributes())||void 0===e?void 0:e[t])&&void 0!==i?i:this.getGraphicAttribute(t)}},{key:"getFinalAnimationAttributes",value:function(){var t;return null!==(t=this.getFinalGraphicAttributes())&&void 0!==t?t:this.graphicItem.attribute}},{key:"setNextGraphicAttributes",value:function(t){this.graphicItem.nextAttrs=t}},{key:"clearChangedGraphicAttributes",value:function(){this.graphicItem&&(this.setPrevGraphicAttributes(null),this.setNextGraphicAttributes(null))}},{key:"clearGraphicAttributes",value:function(){this.graphicItem&&(this.graphicItem.prevAttrs&&this.setPrevGraphicAttributes(null),this.graphicItem.nextAttrs&&this.setNextGraphicAttributes(null),this.graphicItem.finalAttrs&&this.setFinalGraphicAttributes(null))}},{key:"remove",value:function(){this.graphicItem&&(Sj(this.graphicItem),this.graphicItem=null)}},{key:"release",value:function(){this.removeGraphicItem(),this.mark=null,this.data=null,this.items=null}},{key:"getItemAttribute",value:function(t){var e,i;if(null===(e=this.items)||void 0===e?void 0:e.length)return this.mark.isCollectionMark()?j(t)?this.items.map((function(t){return t.nextAttrs})):this.items.map((function(e){var i;return null===(i=e.nextAttrs)||void 0===i?void 0:i[t]})):j(t)?this.items[0].nextAttrs:null===(i=this.items[0].nextAttrs)||void 0===i?void 0:i[t]}},{key:"setItemAttributes",value:function(t){var e;(null===(e=this.items)||void 0===e?void 0:e.length)&&(this.mark.isCollectionMark()?X(t)&&this.items.forEach((function(e,i){Object.assign(e.nextAttrs,t[i])})):Object.assign(this.items[0].nextAttrs,t))}},{key:"getItem",value:function(){var t,e;return this.mark&&this.mark.isCollectionMark()?null!==(t=this.items)&&void 0!==t?t:[]:null===(e=this.items)||void 0===e?void 0:e[0]}},{key:"getDatum",value:function(){var t,e;return this.mark&&this.mark.isCollectionMark()?null!==(t=this.data)&&void 0!==t?t:[]:null===(e=this.data)||void 0===e?void 0:e[0]}}])}(),Lj=function(){return o((function t(e,i){r(this,t),this.references=new Map,this.view=e,this.depend(null==i?void 0:i.dependency)}),[{key:"getStartState",value:function(){return null}},{key:"depend",value:function(t){var e=this;this.references.clear(),xt(t).map((function(t){return Y(t)?e.view.getGrammarById(t):t})).filter((function(t){return!j(t)})).forEach((function(t){var i;e.references.set(t,(null!==(i=e.references.get(t))&&void 0!==i?i:0)+1)}))}},{key:"parameters",value:function(){var t={};return this.references.forEach((function(e,i){N(i.id())&&(t[i.id()]=i.output())})),t}},{key:"bind",value:function(){var t=this,e=this.getEvents();(null!=e?e:[]).forEach((function(e){e.type&&e.handler&&(X(e.type)?e.type.forEach((function(i){i&&"none"!==i&&t.view.addEventListener(i,e.handler)})):"none"!==e.type&&t.view.addEventListener(e.type,e.handler))}))}},{key:"unbind",value:function(){var t=this,e=this.getEvents();(null!=e?e:[]).forEach((function(e){e.type&&e.handler&&(X(e.type)?e.type.forEach((function(i){i&&"none"!==i&&t.view.removeEventListener(i,e.handler)})):"none"!==e.type&&t.view.removeEventListener(e.type,e.handler))}))}},{key:"start",value:function(t){}},{key:"reset",value:function(t){}},{key:"dispatchEvent",value:function(t,e){this.view.emit("".concat(this.type,":").concat(t),e),"start"===t&&this.options.onStart?this.options.onStart(e):"reset"===t&&this.options.onReset?this.options.onReset(e):"update"===t&&this.options.onUpdate?this.options.onUpdate(e):"end"===t&&this.options.onEnd&&this.options.onEnd(e)}}])}(),Dj=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[t,i])).type=e.type,a.handleStart=function(t){a.start(t.element)},a.handleReset=function(t){a.reset(t.element)},a.options=Object.assign({},e.defaultOptions,i),a._marks=t.getMarksBySelector(a.options.selector),a}return h(e,t),o(e,[{key:"getEvents",value:function(){return[{type:this.options.trigger,handler:this.handleStart},{type:this.options.triggerOff,handler:this.handleReset}]}},{key:"getStartState",value:function(){return this.options.state}},{key:"start",value:function(t){t&&this._marks&&this._marks.includes(t.mark)&&(t.addState(this.options.state),this._prevActiveElement=t)}},{key:"reset",value:function(t){var e=null!=t?t:this._prevActiveElement;e&&this._marks&&this._marks.includes(e.mark)&&e.removeState(this.options.state)}}])}(Lj);Dj.type="element-active",Dj.defaultOptions={state:FH.active,trigger:"pointerover",triggerOff:"pointerout"};var Oj=function(t){return t.filterField?function(e){var i;return null===(i=e.getDatum())||void 0===i?void 0:i[t.filterField]}:function(e){return e[t.filterType]}},Fj=function(t,e){if(!e||!t)return null;var i={};return t.forEach((function(t){var n=t&&t.getSpec(),r=n&&n.encode;r&&e.forEach((function(e){e&&r[e]&&(i[e]||(i[e]=[]),i[e].push(t))}))})),i},zj=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[t,i])).type=e.type,a._resetType=[],a.resetAll=function(){var t=a.options,e=t.state,i=t.reverseState;a._statedElements&&a._statedElements.length&&(a.clearAllStates(e,i),a.dispatchEvent("reset",{elements:a._statedElements,options:a.options}),a._statedElements=[])},a.handleStart=function(t){a.start(t.element)},a.handleReset=function(t){if(a._statedElements&&a._statedElements.length){var e=t.element,i=e&&a._marks&&a._marks.includes(e.mark);(a._resetType.includes("view")&&!i||a._resetType.includes("self")&&i)&&a.resetAll()}},a.options=Object.assign({},e.defaultOptions,i),a._marks=t.getMarksBySelector(a.options.selector),a._stateMarks=Fj(a._marks,[a.options.state,a.options.reverseState]),a}return h(e,t),o(e,[{key:"getStartState",value:function(){return this.options.state}},{key:"getEvents",value:function(){var t=this,e=this.options.triggerOff,i=this.options.trigger,n=[{type:i,handler:this.handleStart}],r=function(t){var e=xt(t),i=[],n=[];return e.forEach((function(t){"empty"===t?i.push("view"):Y(t)&&"none"!==t?t.includes("view:")?(n.push(t.replace("view:","")),i.push("view")):(n.push(t),i.push("self")):Z(t)&&i.push("timeout")})),{eventNames:n,resetType:i}}(e),a=r.eventNames,o=r.resetType;return a.forEach((function(e){e&&(X(i)?!i.includes(e):e!==i)&&n.push({type:e,handler:t.handleReset})})),this._resetType=o,n}},{key:"start",value:function(t){var e=this,i=this.options,n=i.state,r=i.reverseState,a=i.isMultiple;if(t&&this._marks&&this._marks.includes(t.mark))if(t.hasState(n)){if(this._resetType.includes("self")){var o=this._statedElements&&this._statedElements.filter((function(e){return e!==t}));o&&o.length?this._statedElements=this.updateStates(o,this._statedElements,n,r):this.resetAll()}}else this._timer&&clearTimeout(this._timer),t.addState(n),this._statedElements=this.updateStates(a&&this._statedElements?[].concat(m(this._statedElements),[t]):[t],this._statedElements,n,r),this.dispatchEvent("start",{elements:this._statedElements,options:this.options}),this._resetType.includes("timeout")&&(this._timer=setTimeout((function(){e.resetAll()}),this.options.triggerOff));else this._resetType.includes("view")&&this._statedElements&&this._statedElements.length&&this.resetAll()}},{key:"reset",value:function(t){t?this._marks&&this._marks.includes(t.mark)&&t.removeState([this.options.state,this.options.reverseState]):this.resetAll()}}])}(Lj);zj.type="element-select",zj.defaultOptions={state:FH.selected,trigger:"click"};var Hj=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[t,i])).type=e.type,a.handleStart=function(t){a.start(t.element)},a.handleReset=function(t){if(a._statedElements&&a._statedElements.length){var e=t.element;if(e){var i=a._marks&&a._marks.includes(e.mark);"view"!==a._resetType||i?"self"===a._resetType&&i&&a.resetAll():a.resetAll()}}},a.options=Object.assign({},e.defaultOptions,i),a._marks=t.getMarksBySelector(a.options.selector),a._stateMarks=Fj(a._marks,[a.options.highlightState,a.options.blurState]),a}return h(e,t),o(e,[{key:"getStartState",value:function(){return this.options.highlightState}},{key:"getEvents",value:function(){var t=this.options.triggerOff,e=[{type:this.options.trigger,handler:this.handleStart}],i=t;return Y(t)&&t.includes("view:")?(i=t.replace("view:",""),this._resetType="view"):this._resetType="self",e.push({type:i,handler:this.handleReset}),e}},{key:"resetAll",value:function(){var t=this.options,e=t.highlightState,i=t.blurState;this._lastElement&&(this.clearAllStates(e,i),this.dispatchEvent("reset",{elements:[this._lastElement],options:this.options}),this._lastElement=null,this._statedElements=null)}},{key:"start",value:function(t){if(t&&this._marks&&this._marks.includes(t.mark)){var e=this.options,i=e.highlightState,n=e.blurState;if(this._lastElement===t)return;this._statedElements=this.updateStates([t],this._statedElements,i,n),this._lastElement=t,this.dispatchEvent("start",{elements:[t],options:this.options})}else this._lastElement&&"view"===this._resetType&&this.resetAll()}},{key:"reset",value:function(t){t?this._marks&&this._marks.includes(t.mark)&&t.removeState([this.options.highlightState,this.options.blurState]):this.resetAll()}}])}(Lj);Hj.type="element-highlight",Hj.defaultOptions={highlightState:FH.highlight,blurState:FH.blur,trigger:"pointerover",triggerOff:"pointerout"};var jj=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[t,i])).type=e.type,a.handleStart=function(t){a.start(t.element)},a.handleReset=function(t){t.element&&a._marks&&a._marks.includes(t.element.mark)&&a.resetAll()},a.options=Object.assign({},e.defaultOptions,i),a._marks=t.getMarksBySelector(a.options.selector),a}return h(e,t),o(e,[{key:"getStartState",value:function(){return this.options.highlightState}},{key:"getEvents",value:function(){return[{type:this.options.trigger,handler:this.handleStart},{type:this.options.triggerOff,handler:this.handleReset}]}},{key:"resetAll",value:function(){var t=[this.options.highlightState,this.options.blurState];this._marks.forEach((function(e){e.elements.forEach((function(e){e.removeState(t)}))}))}},{key:"start",value:function(t){var e=this;if(t&&this._marks&&this._marks.includes(t.mark)){var i=t.key;if(j(i))return;this._marks.forEach((function(t){t.elements.forEach((function(t){t.key===i?t.updateStates(l(l({},e.options.blurState,!1),e.options.highlightState,!0)):t.updateStates(l(l({},e.options.blurState,!0),e.options.highlightState,!1))}))}))}}},{key:"reset",value:function(t){t?this._marks&&this._marks.includes(t.mark)&&t.removeState([this.options.highlightState,this.options.blurState]):this.resetAll()}}])}(Lj);jj.type="element-highlight-by-key",jj.defaultOptions={highlightState:FH.highlight,blurState:FH.blur,trigger:"pointerover",triggerOff:"pointerout"};var Nj=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[t,i])).type=e.type,a.handleStart=function(t){a.start(t.element)},a.handleReset=function(t){var e=t.element;e&&a._marks&&a._marks.includes(e.mark)&&a.resetAll()},a.options=Object.assign({},e.defaultOptions,i),a._marks=t.getMarksBySelector(a.options.selector),a}return h(e,t),o(e,[{key:"getStartState",value:function(){return this.options.highlightState}},{key:"getEvents",value:function(){return[{type:this.options.trigger,handler:this.handleStart},{type:this.options.triggerOff,handler:this.handleReset}]}},{key:"resetAll",value:function(){var t=[this.options.highlightState,this.options.blurState];this._marks.forEach((function(e){e.elements.forEach((function(e){e.removeState(t)}))}))}},{key:"start",value:function(t){var e=this;if(t&&this._marks&&this._marks.includes(t.mark)){var i=t.groupKey;if(j(i))return;this._marks.forEach((function(t){t.elements.forEach((function(t){t.groupKey===i?t.updateStates(l(l({},e.options.blurState,!1),e.options.highlightState,!0)):t.updateStates(l(l({},e.options.blurState,!0),e.options.highlightState,!1))}))}))}}},{key:"reset",value:function(t){t?this._marks&&this._marks.includes(t.mark)&&t.removeState([this.options.highlightState,this.options.blurState]):this.resetAll()}}])}(Lj);Nj.type="element-highlight-by-group",Nj.defaultOptions={highlightState:FH.highlight,blurState:FH.blur,trigger:"pointerover",triggerOff:"pointerout"};var Vj=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[t,i])).type=e.type,a.handleStart=function(t){var e,i;a.start(null===(i=null===(e=t.detail)||void 0===e?void 0:e.data)||void 0===i?void 0:i.id)},a.handleReset=function(t){a.resetAll()},a.options=Object.assign({},e.defaultOptions,i),a._marks=t.getMarksBySelector(a.options.selector),a}return h(e,t),o(e,[{key:"getEvents",value:function(){return[{type:qD.legendItemHover,handler:this.handleStart},{type:qD.legendItemUnHover,handler:this.handleReset}]}},{key:"getStartState",value:function(){return this.options.state}},{key:"start",value:function(t){var e=this,i=t;if(!j(i)){var n=Oj(this.options);this._marks.forEach((function(t){t.elements.forEach((function(t){n(t)===i?t.addState(e.options.state):t.removeState(e.options.state)}))}))}}},{key:"resetAll",value:function(){var t=this;this._marks.forEach((function(e){e.elements.forEach((function(e){e.removeState(t.options.state)}))}))}},{key:"reset",value:function(t){t?this._marks&&this._marks.includes(t.mark)&&t.removeState(this.options.state):this.resetAll()}}])}(Lj);Vj.type="element-active-by-legend",Vj.defaultOptions={state:FH.active,filterType:"groupKey"};var Wj=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[t,i])).type=e.type,a.handleStart=function(t,e){var i,n;a.start(null===(n=null===(i=t.detail)||void 0===i?void 0:i.data)||void 0===n?void 0:n.id)},a.handleReset=function(t){a.resetAll()},a.options=Object.assign({},e.defaultOptions,i),a._marks=t.getMarksBySelector(a.options.selector),a}return h(e,t),o(e,[{key:"getStartState",value:function(){return this.options.highlightState}},{key:"getEvents",value:function(){return[{type:qD.legendItemHover,handler:this.handleStart},{type:qD.legendItemUnHover,handler:this.handleReset}]}},{key:"start",value:function(t){var e=this;if(!j(t)){var i=Oj(this.options);this._marks.forEach((function(n){n.elements.forEach((function(n){i(n)===t?n.updateStates(l(l({},e.options.blurState,!1),e.options.highlightState,!0)):n.updateStates(l(l({},e.options.blurState,!0),e.options.highlightState,!1))}))}))}}},{key:"resetAll",value:function(){var t=[this.options.highlightState,this.options.blurState];this._marks.forEach((function(e){e.elements.forEach((function(e){e.removeState(t)}))}))}},{key:"reset",value:function(t){t?this._marks&&this._marks.includes(t.mark)&&t.removeState([this.options.highlightState,this.options.blurState]):this.resetAll()}}])}(Lj);Wj.type="element-highlight-by-legend",Wj.defaultOptions={highlightState:FH.highlight,blurState:FH.blur,filterType:"groupKey"};var Gj=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[t,i])).type=e.type,a.handleStart=function(t,e){if(a.options.shouldStart?a.options.shouldStart(t):a._filterByName(t)){var i=a._parseTargetKey(t,e);a.start(i)}},a.handleReset=function(t){(a.options.shouldReset?a.options.shouldReset(t):a._filterByName(t))&&a.resetAll()},a.options=Object.assign({},e.defaultOptions,i),a._marks=t.getMarksBySelector(a.options.selector),a}return h(e,t),o(e,[{key:"getStartState",value:function(){return this.options.highlightState}},{key:"getEvents",value:function(){return[{type:this.options.trigger,handler:this.handleStart},{type:this.options.triggerOff,handler:this.handleReset}]}},{key:"_filterByName",value:function(t){var e,i=xt(this.options.graphicName);return(null===(e=null==t?void 0:t.target)||void 0===e?void 0:e.name)&&i.includes(t.target.name)}},{key:"_parseTargetKey",value:function(t,e){return this.options.parseData?this.options.parseData(t):"text"===t.target.type?t.target.attribute.text:null}},{key:"start",value:function(t){var e=this;if(!j(t)){var i=Oj(this.options);this._marks.forEach((function(n){n.elements.forEach((function(n){i(n)===t?n.updateStates(l(l({},e.options.blurState,!1),e.options.highlightState,!0)):n.updateStates(l(l({},e.options.blurState,!0),e.options.highlightState,!1))}))}))}}},{key:"resetAll",value:function(){var t=[this.options.blurState,this.options.highlightState];this._marks.forEach((function(e){e.elements.forEach((function(e){e.removeState(t)}))}))}},{key:"reset",value:function(t){t?this._marks&&this._marks.includes(t.mark)&&t.removeState([this.options.highlightState,this.options.blurState]):this.resetAll()}}])}(Lj);Gj.type="element-highlight-by-name",Gj.defaultOptions={trigger:"pointerover",triggerOff:"pointerout",highlightState:FH.highlight,blurState:FH.blur,filterType:"groupKey"};var Uj=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[t,i])).type=e.type,a.handleStart=function(t){if(t&&t.element&&a._marks.includes(t.element.mark)&&(a.options.shouldStart?a.options.shouldStart(t):a._filterByName(t))){var e=a._parseTargetKey(t,t.element);a.start(e)}},a.handleReset=function(t){t&&t.element&&a._marks.includes(t.element.mark)&&a.reset()},a.options=Object.assign({},e.defaultOptions,i),a._marks=t.getMarksBySelector(a.options.selector),a}return h(e,t),o(e,[{key:"_filterByName",value:function(t){var e;return!!(null===(e=null==t?void 0:t.target)||void 0===e?void 0:e.name)}},{key:"_parseTargetKey",value:function(t,e){return t.target.name}},{key:"start",value:function(t){var e=this;j(t)||this._marks.forEach((function(i){i.elements.forEach((function(i){var n;(null===(n=i.getGraphicItem())||void 0===n?void 0:n.name)===t?i.updateStates(l(l({},e.options.blurState,!1),e.options.highlightState,!0)):i.updateStates(l(l({},e.options.blurState,!0),e.options.highlightState,!1))}))}))}},{key:"reset",value:function(){var t=[this.options.blurState,this.options.highlightState];this._marks.forEach((function(e){e.elements.forEach((function(e){e.removeState(t)}))}))}}])}(Hj);Uj.type="element-highlight-by-graphic-name";var Yj=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).type=e.type,t}return h(e,t),o(e,[{key:"start",value:function(t){var i,n=this,r=null===(i=t.getGraphicItem())||void 0===i?void 0:i.name;r&&this._marks.forEach((function(t){t.elements.forEach((function(t){var i;(null===(i=t.getGraphicItem())||void 0===i?void 0:i.name)===r&&y(e,"start",n,3)([t])}))}))}}])}(zj);function Xj(t){if(t)return t.type===LB.Band?t.bandwidth():t.type===LB.Point?t.step():void 0}Yj.type="element-select-by-graphic-name";var Kj=function(){return o((function t(){r(this,t)}),[{key:"updateStates",value:function(t,e,i,n){return t&&t.length?(i&&n?e&&e.length?(this.toggleReverseStateOfElements(t,e,n),this.toggleStateOfElements(t,e,i)):this.addBothStateOfElements(t,i,n):i&&(e&&e.length?this.toggleStateOfElements(t,e,i):this.addStateOfElements(t,i)),t):null}},{key:"toggleReverseStateOfElements",value:function(t,e,i){var n=this;e.forEach((function(t){i&&n._stateMarks[i]&&n._stateMarks[i].includes(t.mark)&&t.addState(i)})),t.forEach((function(t){i&&n._stateMarks[i]&&n._stateMarks[i].includes(t.mark)&&t.removeState(i)}))}},{key:"toggleStateOfElements",value:function(t,e,i){var n=this;e.forEach((function(t){i&&n._stateMarks[i]&&n._stateMarks[i].includes(t.mark)&&t.removeState(i)})),t.forEach((function(t){i&&n._stateMarks[i]&&n._stateMarks[i].includes(t.mark)&&t.addState(i)}))}},{key:"addBothStateOfElements",value:function(t,e,i){var n=this;this._marks.forEach((function(r){var a,o=i&&n._stateMarks[i]&&n._stateMarks[i].includes(r),s=e&&n._stateMarks[e]&&n._stateMarks[e].includes(r);(o||s)&&(null===(a=r.elements)||void 0===a||a.forEach((function(n){t&&t.includes(n)?s&&n.addState(e):o&&n.addState(i)})))}))}},{key:"addStateOfElements",value:function(t,e){var i=this;this._marks.forEach((function(n){var r,a=e&&i._stateMarks[e]&&i._stateMarks[e].includes(n);a&&(null===(r=n.elements)||void 0===r||r.forEach((function(i){t&&t.includes(i)&&a&&i.addState(e)})))}))}},{key:"clearAllStates",value:function(t,e){var i=this;this._statedElements&&this._statedElements.length&&this._marks.forEach((function(n){n&&n.elements&&(e&&i._stateMarks[e]&&i._stateMarks[e].includes(n)&&n.elements.forEach((function(t){t.removeState(e)})),t&&i._stateMarks[t]&&i._stateMarks[t].includes(n)&&n.elements.forEach((function(e){i._statedElements.includes(e)&&e.removeState(t)})))}))}}])}(),qj=function(t,e){return dj(t)?t.output():t&&V(t)?H(t.callback)?function(i){return t.callback(i,e)}:H(t.value)?t.value(e):t:t},Zj=function(t,e){return t?V(t)?Object.keys(t).reduce((function(i,n){var r=t[n];return i[n]=qj(r,e),i}),{}):t.map((function(t){return qj(t,e)})):t},Jj=-1,Qj=function(t){function e(t){var i;return r(this,e),(i=n(this,e)).spec={},i.references=new Map,i.targets=[],i.transforms=[],i.view=t,i.uid=++Jj,i}return h(e,t),o(e,[{key:"parse",value:function(t){return this.id(t.id),this.name(t.name),this.depend(t.dependency),this}},{key:"depend",value:function(t){var e,i=this;if(null===(e=this.spec)||void 0===e?void 0:e.dependency){var n=xt(this.spec.dependency).map((function(t){return Y(t)?i.view.getGrammarById(t):t}));this.detach(n)}this.spec.dependency=t;var r=xt(t).map((function(t){return Y(t)?i.view.getGrammarById(t):t}));return this.attach(r),this.commit(),this}},{key:"addEventListener",value:function(t,e,i){var n=e;return i&&!1===i.trap||((n=e).raw=e),i&&i.target&&(n.target=i.target),this.on(t,n),this}},{key:"removeEventListener",value:function(t,e){return e?this.off(t,e):this.off(t),this}},{key:"emit",value:function(t){for(var i,n,r,a=arguments.length,o=new Array(a>1?a-1:0),s=1;s<a;s++)o[s-1]=arguments[s];return null===(r=null===(n=this.view)||void 0===n?void 0:n.emit)||void 0===r||(i=r).call.apply(i,[n,t].concat(o)),y(e,"emit",this,3)([t].concat(o))}},{key:"emitGrammarEvent",value:function(t){for(var i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];return y(e,"emit",this,3)([t].concat(n))}},{key:"evaluateTransform",value:function(t,e,i){if(!t||!t.length)return e;for(var n=e,r=0,a=t.length;r<a;){var o=t[r];this.emit(DH.BEFORE_TRANSFORM,o.type),n=o.transform(o.isRawOptions?o.options:Zj(o.options,i),n,i,this.view),r++,this.emit(DH.AFTER_TRANSFORM,o.type)}return n}},{key:"set",value:function(t){return!1}},{key:"id",value:function(t){return arguments.length?(this.view.grammars.unrecord(this),this._id=t,this.view.grammars.record(this),this):this._id}},{key:"name",value:function(t){return arguments.length?(this._name=t,this):this._name}},{key:"attach",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return xt(t).filter((function(t){return!j(t)})).forEach((function(n){var r;j(t)||(n.targets.includes(e)||n.targets.push(e),e.references.set(n,(null!==(r=e.references.get(n))&&void 0!==r?r:0)+i))})),this}},{key:"detach",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return xt(t).filter((function(t){return!j(t)})).forEach((function(t){var n=e.references.get(t)-i;n>0?e.references.set(t,n-1):(e.references.delete(t),t.targets.includes(e)&&(t.targets=t.targets.filter((function(t){return t!==e}))))})),this}},{key:"detachAll",value:function(){var t=this;this.references.forEach((function(e,i){t.detach(i,e)}))}},{key:"link",value:function(t){this.grammarSource=t}},{key:"run",value:function(){var t,e=null===(t=this.grammarSource)||void 0===t?void 0:t.output(),i=this.parameters();return this.evaluate(e,i)}},{key:"commit",value:function(){this.view.commit(this)}},{key:"parameters",value:function(){var t={};return this.references.forEach((function(e,i){N(i.id())&&(t[i.id()]=i.output())})),t}},{key:"getSpec",value:function(){return this.spec}},{key:"reuse",value:function(t){return this}},{key:"clear",value:function(){this.spec=null,this.view=null}},{key:"release",value:function(){this.clear()}},{key:"setFunctionSpec",value:function(t,e){return j(this.spec[e])||this.detach(lj(this.spec[e],this.view)),this.spec[e]=t,this.attach(lj(t,this.view)),this.commit(),this}}])}(O),$j=function(t,e,i){var n,r;if("callback"===t&&H(e))return{references:[],value:{callback:e,dependency:[]}};if(!j(e.data)){var a=i.getDataById(e.data);return{references:[a],value:a}}if(!j(e.customized)){var o=i.getCustomizedById(e.customized);return{references:[o],value:o}}if(!j(e.scale)){var s=i.getScaleById(e.scale);return{references:[s],value:s}}if((r=e)&&(r.signal||r.callback)){var l=lj(e,i);return{references:l,value:e.callback?{value:e.callback,dependency:l}:null!==(n=null==l?void 0:l[0])&&void 0!==n?n:e}}return{value:e}},tN=function(t,e){var i=xj.getTransform(t.type);if(i){var n={},r=[];return Object.keys(t).forEach((function(i){var a;if("type"!==i){var o=t[i];if("dependency"!==i){var s=function(t,e,i){if(j(e))return{value:e};if(X(e)){var n=e.map((function(e){return $j(t,e,i)}));return{references:n.reduce((function(t,e){return e.references&&t.concat(e.references),t}),[]),value:n.map((function(t){return t.value}))}}return $j(t,e,i)}(i,o,e);s&&((null===(a=s.references)||void 0===a?void 0:a.length)&&(r=r.concat(s.references)),n[i]=s.value)}else(null==o?void 0:o.length)&&(r=r.concat(sj(o,e)))}})),{markPhase:i.markPhase,transform:i.transform,canProgressive:i.canProgressive,type:i.type,options:n,references:r}}},eN=function(t,e){if(null==t?void 0:t.length){var i=[],n=[];return t.forEach((function(t){var r,a=tN(t,e);a&&((null===(r=a.references)||void 0===r?void 0:r.length)&&(n=n.concat(a.references)),i.push(a))})),{transforms:i,refs:n}}return null},iN={csv:zo,dsv:Fo,tsv:Ho,json:function(t){if(!Y(t))return xt(t);try{return xt(JSON.parse(t))}catch(t){return[]}}},nN=function(t){function e(t,i,a){var o;return r(this,e),(o=n(this,e,[t])).grammarType="data",o.spec={},o._dataIDKey="VGRAMMAR_DATA_ID_KEY_".concat(o.uid),o._loadTasks=[],o._postFilters=[],o.ingest=function(t){var e=function(t,e){if(j(t))return t;if(H(t))return t.call(null,e);if(t.signal){var i=t.signal;return Y(i)?null==e?void 0:e[i]:i.output()}return t.callback?t.callback.call(null,e):t}(t.format,o.parameters());return o._input=function(t,e){if(!e||!iN[e.type])return xt(t);var i="dsv"===e.type?{delimiter:e.delimiter}:{};return iN[e.type](t,i,new Ms(new Ss))}(t.values,e),o._input},o.load=function(t){if(t.values)return o.ingest(t)},o.relay=function(t){return t[0]},o._loadTasks=[],j(i)||o.values(i,a),o}return h(e,t),o(e,[{key:"parse",value:function(t){return y(e,"parse",this,3)([t]),this._isLoaded=!1,this.source(t.source,t.format,!1),this.url(t.url,t.format,!1),this.values(t.values,t.format,!1),this.transform(t.transform),this.parseLoad(t),this.commit(),this}},{key:"parseDataSource",value:function(t){var e=this,i=[],n=[],r=t.format?lj(t.format,this.view)[0]:null;if(r&&i.push(r),t.values){var a=lj(t.values,this.view)[0];a&&i.push(a),n.push({type:"ingest",transform:this.ingest,isRawOptions:!0,options:{values:t.values,format:t.format}})}else if(t.url){var o=lj(t.url,this.view)[0];o&&i.push(o),n.push({type:"load",transform:this.load,options:{url:null!=o?o:t.url,format:null!=r?r:t.format}})}else if(t.source){var s=[];xt(t.source).forEach((function(t){var n=dj(t)?t:e.view.getDataById(t);n&&(i.push(n),s.push(n))})),s.length&&(n.push({type:"relay",transform:this.relay,options:s}),this.grammarSource=s[0])}return{transforms:n,refs:i}}},{key:"evaluate",value:function(t,e){this.view.emit(DH.BEFORE_EVALUATE_DATA);var i=this._isLoaded?this.transforms:this._loadTasks.concat(this.transforms);this.grammarSource&&(this._input=t);var n=this.evaluateTransform(i,this._input,e),r=this._evaluateFilter(n,e);return this.setValues(r),this._isLoaded=!0,this.view.emit(DH.AFTER_EVALUATE_DATA),this}},{key:"output",value:function(){return this._values}},{key:"getDataIDKey",value:function(){return this._dataIDKey}},{key:"values",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=Object.assign({},this.spec,{values:t,format:e});return j(t)||(n.url=void 0,n.source=void 0),i?this.parseLoad(n):this}},{key:"url",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=Object.assign({},this.spec,{url:t,format:e});return j(t)||(n.values=void 0,n.source=void 0),i?this.parseLoad(n):this}},{key:"source",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=Object.assign({},this.spec,{source:t,format:e});return j(t)||(n.values=void 0,n.url=void 0),i?this.parseLoad(n):this}},{key:"parseLoad",value:function(t){this.detach(this.parseDataSource(this.spec).refs),this.spec=t;var e=this.parseDataSource(this.spec);return this.attach(e.refs),this._loadTasks=e.transforms,this._isLoaded=!1,this.commit(),this}},{key:"setValues",value:function(t){var e=this;this._values=xt(t).map((function(t,i){var n=t===Object(t)?t:{data:t};return n[e._dataIDKey]=i,n}))}},{key:"field",value:function(t){return this._values.map((function(e){return e[t]}))}},{key:"transform",value:function(t){var e=eN(this.spec.transform,this.view);e&&(this.detach(e.refs),this.transforms=[]),this.spec.transform=t;var i=eN(this.spec.transform,this.view);return i&&(this.attach(i.refs),this.transforms=i.transforms),this.commit(),this}},{key:"getValue",value:function(){return this._values}},{key:"getInput",value:function(){return this._input}},{key:"addDataFilter",value:function(t){return this._postFilters=this._postFilters.concat(xt(t)),this._postFilters.sort((function(t,e){var i,n;return(null!==(i=t.rank)&&void 0!==i?i:0)-(null!==(n=e.rank)&&void 0!==n?n:0)})),this}},{key:"removeDataFilter",value:function(t){var e=xt(t);return this._postFilters=this._postFilters.filter((function(t){return!e.includes(t)})),this}},{key:"_evaluateFilter",value:function(t,e){return this._postFilters.reduce((function(t,i){return i.filter(t,e)}),t)}},{key:"reuse",value:function(t){return t.grammarType!==this.grammarType||(this._isLoaded=!1,this._values=t.output()),this}},{key:"clear",value:function(){y(e,"clear",this,3)([]),this._input=null,this._values=null}}])}(Qj);function rN(t,e,i,n){for(var r,a,o=t[e];e>i&&(r=t[a=Math.floor((e-1)/2)],o&&r&&n(o,r)<0);)t[e]=r,e=a;return t[e]=o}function aN(t,e,i,n){for(var r,a=e,o=null!=i?i:t.length,s=t[e],l=2*e+1;l<o;)(r=l+1)<o&&n(t[l],t[r])>=0&&(l=r),t[e]=t[l],l=2*(e=l)+1;return t[e]=s,rN(t,e,a,n)}var oN=function(){return o((function t(e){r(this,t),this.compare=e,this.nodes=[]}),[{key:"size",value:function(){return this.nodes.length}},{key:"last",value:function(){return this.nodes[0]}},{key:"validate",value:function(){for(var t=this.nodes.length-1;t>0;t-=1){var e=Math.floor((t-1)/2);if(this.compare(this.nodes[e],this.nodes[t])>0)return!1}return!0}},{key:"push",value:function(t){if(this.nodes.includes(t)){var e=this.nodes.indexOf(t);return rN(this.nodes,e,0,this.compare),aN(this.nodes,e,null,this.compare)}return this.nodes.push(t),rN(this.nodes,this.nodes.length-1,0,this.compare)}},{key:"remove",value:function(t){if(this.nodes.includes(t)){var e=this.nodes.indexOf(t);this.nodes=this.nodes.slice(0,e).concat(this.nodes.slice(e+1)),rN(this.nodes,e,0,this.compare),aN(this.nodes,e,null,this.compare)}}},{key:"pop",value:function(){var t,e=this.nodes.pop();return this.nodes.length?(t=this.nodes[0],this.nodes[0]=e,aN(this.nodes,0,null,this.compare)):t=e,t}},{key:"clear",value:function(){this.nodes=[]}}])}(),sN=function(){return o((function t(e){r(this,t),this.list=[],this.ids={},this.idFunc=e||Kk}),[{key:"add",value:function(t){var e=this.idFunc(t);return this.ids[e]||(this.ids[e]=1,this.list.push(t)),this}},{key:"remove",value:function(t){var e=this.idFunc(t);return this.ids[e]&&(this.ids[e]=0,this.list=this.list.filter((function(e){return e!==t}))),this}},{key:"forEach",value:function(t,e){e?this.list.slice().reverse().forEach(t):this.list.forEach(t)}},{key:"filter",value:function(t){return this.list.filter(t)}},{key:"length",get:function(){return this.list.length}},{key:"getElementByIndex",value:function(t){return this.list[t]}}])}(),lN=function(){return o((function t(){r(this,t),this.grammars=[],this.logger=Lt.getInstance(),this._curRank=0,this._committed=new sN((function(t){return t.uid})),this._heap=new oN((function(t,e){return(null==t?void 0:t.qrank)-(null==e?void 0:e.qrank)})),this._beforeRunner=null,this._afterRunner=null,this._updateCounter=0,this._finishFirstRender=!1}),[{key:"add",value:function(t){if(t)return this._setRankOfGrammar(t),this.commit(t),!this.grammars.includes(t)&&(this.grammars.push(t),!0)}},{key:"remove",value:function(t){t&&(this._committed.remove(t),this._heap.remove(t),this.grammars=this.grammars.filter((function(e){return e!==t})))}},{key:"_setRankOfGrammar",value:function(t){t&&(t.rank=++this._curRank)}},{key:"_reRank",value:function(t){for(var e=this,i=[t];i.length;){var n=i.pop();this._setRankOfGrammar(n);var r=n.targets;r&&r.forEach((function(n){i.push(n),n===t&&e.logger.error("Cycle detected in dataflow graph.")}))}}},{key:"_enqueue",value:function(t){t&&(t.qrank=t.rank,this._heap.push(t))}},{key:"_logGrammarRunInfo",value:function(t){if(this.logger.canLogError()){var e=[{key:"id",value:t.id()},{key:"name",value:t.name()}].reduce((function(t,e,i){return j(e.value)?t:"".concat(t).concat(i?" , ":"").concat(e.key,": ").concat(e.value)}),"");this.logger.debug("Run Operator: ",t,e)}}},{key:"hasCommitted",value:function(){return!!this._committed.length}},{key:"commit",value:function(t){return this._committed.add(t),this}},{key:"_beforeEvaluate",value:function(){var t=this;this.grammars.forEach((function(e){e.targets.some((function(t){return(null==t?void 0:t.rank)<(null==e?void 0:e.rank)}))&&t._reRank(e)})),this._committed.forEach((function(e){return t._enqueue(e)})),this._committed=new sN((function(t){return t.uid}))}},{key:"_enqueueTargets",value:function(t){var e=this;t.targets&&t.targets.length&&this._finishFirstRender&&t.targets.forEach((function(t){return e._enqueue(t)}))}},{key:"evaluate",value:function(){if(this._beforeRunner&&this._beforeRunner(this),!this._committed.length)return this.logger.info("Dataflow invoked, but nothing to do."),!1;this._updateCounter+=1;var t,e,i=0;for(this.logger.canLogInfo()&&(e=Date.now(),this.logger.debug("-- START PROPAGATION (".concat(this._updateCounter,") -----"))),this._beforeEvaluate();this._heap.size()>0;)(t=this._heap.pop())&&(t.rank===t.qrank?(t.run(),this._logGrammarRunInfo(t),this._enqueueTargets(t),i+=1):this._enqueue(t));return this.logger.canLogInfo()&&(e=Date.now()-e,this.logger.info("> ".concat(i," grammars updated; ").concat(e," ms"))),this._afterRunner&&this._afterRunner(this),this._finishFirstRender=!0,!0}},{key:"runBefore",value:function(t){this._beforeRunner=t}},{key:"runAfter",value:function(t){this._afterRunner=t}},{key:"release",value:function(){this._heap&&(this._heap.clear(),this._heap=null),this.logger=null,this._committed=null}}])}(),uN=function(t,e,i,n,r){var a=function(t){if(r||!t||n&&!n(t)||i.call(null,t),t.markType===MH.group){var o=t[e];o&&o.forEach((function(t){a(t)}))}r&&(!t||n&&!n(t)||i.call(null,t))};a(t)},cN=function(){return o((function t(e){var i=this;r(this,t),this.handleAfterNextRender=function(){i._stage&&!i._viewOptions.disableDirtyBounds&&i._stage.enableDirtyBounds(),i._view.emit(DH.AFTER_VRENDER_DRAW),i._view.emit(DH.AFTER_VRENDER_NEXT_RENDER)},this._view=e}),[{key:"initialize",value:function(t,e,i,n){return this._width=t,this._height=e,this._viewOptions=i,this._eventConfig=n,this.initStage(),this}},{key:"stage",value:function(){var t;return null!==(t=this._stage)&&void 0!==t?t:null}},{key:"gestureController",value:function(){var t;return null!==(t=this._gestureController)&&void 0!==t?t:null}},{key:"canvas",value:function(){return this._stage?this._stage.window.getNativeHandler().nativeCanvas:null}},{key:"context",value:function(){return this._stage?this._stage.window.getContext().nativeContext:null}},{key:"combineIncrementalLayers",value:function(){var t=this;return this._stage&&function(t){return Kf(this,void 0,void 0,f().mark((function e(){var i,n;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=[],n=t.getChildren(),e.next=3,new Promise((function(t){nc.global.getRequestAnimationFrame()((function(){t(null)}))}));case 3:return n.forEach((function(t){t.subLayers.size&&t.subLayers.forEach((function(t){t.drawContribution&&t.drawContribution.hooks&&t.drawContribution.rendering&&i.push(new Promise((function(e){t.drawContribution.hooks.completeDraw.tap("outWait",(function(){t.drawContribution.hooks.completeDraw.taps=t.drawContribution.hooks.completeDraw.taps.filter((function(t){return"outWait"!==t.name})),e(null)}))})))}))})),e.next=6,Promise.all(i);case 6:case"end":return e.stop()}}),e)})))}(this._stage).then((function(){t._stage&&t._stage.defaultLayer.combineSubLayer()})),this}},{key:"background",value:function(t){if(this._stage)return this._stage.background=t,this}},{key:"setDpr",value:function(t,e){var i,n;return null===(n=null===(i=this._stage)||void 0===i?void 0:i.setDpr)||void 0===n||n.call(i,t),e&&this.renderNextFrame(),this}},{key:"shouldResize",value:function(t,e){return t!==this._width||e!==this._height}},{key:"resize",value:function(t,e){return this._view.emit(DH.BEFORE_STAGE_RESIZE),this.shouldResize(t,e)&&(this._width=t,this._height=e,this._stage&&this._stage.resize(t,e)),this._view.emit(DH.AFTER_STAGE_RESIZE),this}},{key:"setViewBox",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._stage?(!t||this._viewBox&&t.x1===this._viewBox.x1&&t.x2===this._viewBox.x2&&t.y1===this._viewBox.y1&&t.y2===this._viewBox.y2||(this._viewBox=t,this._stage.setViewBox(t.x1,t.y1,t.x2-t.x1,t.y2-t.y1,e)),this):this}},{key:"render",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._view.emit(DH.BEFORE_VRENDER_DRAW),this.initStage(),this._stage.disableDirtyBounds(),this._stage.afterNextRender(this.handleAfterNextRender),t&&(this._stage.render(),this._view.emit(DH.AFTER_VRENDER_DRAW)),this}},{key:"renderNextFrame",value:function(){return this.initStage(),this._stage.renderNextFrame(),this}},{key:"toCanvas",value:function(){return this._stage?this._stage.toCanvas():null}},{key:"preventRender",value:function(t){this._stage&&this._stage.preventRender(t)}},{key:"release",value:function(){var t;this._view.traverseMarkTree((function(t){t.release()})),this._dragController&&this._dragController.release(),this._gestureController&&this._gestureController.release(),this._stage!==(null===(t=this._viewOptions)||void 0===t?void 0:t.stage)&&this._stage.release(),this._stage=null,this._layer=null,this._dragController=null,this._gestureController=null}},{key:"createStage",value:function(){var t,e,i,n,r;this._view.emit(DH.BEFORE_CREATE_VRENDER_STAGE);var a,o=this._viewOptions,s=null!==(t=o.stage)&&void 0!==t?t:(a={width:this._width,height:this._height,renderStyle:o.renderStyle,viewBox:o.viewBox,dpr:o.dpr,canvas:o.renderCanvas,canvasControled:o.canvasControled,container:o.container,title:o.rendererTitle,beforeRender:o.beforeRender,afterRender:o.afterRender,disableDirtyBounds:!0,autoRender:!0,pluginList:o.pluginList,enableHtmlAttribute:o.enableHtmlAttribute,optimize:o.optimize,ticker:o.ticker,supportsTouchEvents:o.supportsTouchEvents,supportsPointerEvents:o.supportsPointerEvents,event:{clickInterval:this._eventConfig.clickInterval,autoPreventDefault:!!this._eventConfig.autoPreventDefault},ReactDOM:o.ReactDOM,autoRefresh:o.autoRefresh},new gx(a));(null===(e=o.options3d)||void 0===e?void 0:e.enable)&&s.set3dOptions(o.options3d),s.enableIncrementalAutoRender(),this._viewBox=o.viewBox,this._view.emit(DH.AFTER_CREATE_VRENDER_STAGE),this._view.emit(DH.BEFORE_CREATE_VRENDER_LAYER);var l=null!==(i=o.layer)&&void 0!==i?i:s.defaultLayer;if(this._view.emit(DH.AFTER_CREATE_VRENDER_LAYER),(null===(n=this._eventConfig)||void 0===n?void 0:n.drag)&&xj.getStageEventPlugin("drag")&&(this._dragController=new(xj.getStageEventPlugin("drag"))(s)),(null===(r=this._eventConfig)||void 0===r?void 0:r.gesture)&&xj.getStageEventPlugin("gesture")){var u=V(this._eventConfig.gesture)?this._eventConfig.gesture:{};this._gestureController=new(xj.getStageEventPlugin("gesture"))(s,u)}return{stage:s,layer:l}}},{key:"initStage",value:function(){if(!this._stage){var t=this.createStage(),e=t.stage,i=t.layer;this._stage=e,this._layer=i;var n=this._view.background();this.background(n)}}}])}();function hN(t){return j(t.offsetX)?j(t.x)?t.changedTouches&&t.changedTouches.length?function(t){var e=t.changedTouches[0];return{canvasX:e.x,canvasY:e.y}}(t):{canvasX:0,canvasY:0}:function(t){return{canvasX:t.x,canvasY:t.y}}(t):function(t){return{canvasX:t.offsetX,canvasY:t.offsetY}}(t)}function dN(t,e){var i=["canvasX","canvasY"];return(!(arguments.length>2&&void 0!==arguments[2])||arguments[2])&&(i.push("clientX"),i.push("clientY")),i.forEach((function(i){Q(e[i])&&Object.defineProperty(t,i,{value:e[i],writable:!0})})),[e.canvasX,e.canvasY]}var pN="window",fN="view",vN="width",gN="height",yN="viewWidth",mN="viewHeight",_N="padding",bN="viewBox",xN="autoFit";function kN(t,e,i,n){var r,a;n===pN&&function(t){["touches","changedTouches","targetTouches"].forEach((function(e){t[e]&&t[e].length&&Array.from(t[e]).forEach((function(t){dN(t,hN(t),!1)}))}));var e=hN(t);dN(t,e)}(e.changedTouches?e.changedTouches[0]:e);var o=null===(r=e.target)||void 0===r?void 0:r[UH];if(!o&&n===fN)for(var s=e.target,l=null===(a=t.rootMark)||void 0===a?void 0:a.graphicItem;(null==s?void 0:s.parent)&&s.parent!==l;)if((s=s.parent)[UH]){o=s[UH];break}return e.element=o,e}var SN=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments)).grammarType="signal",t.spec={value:null,update:null},t}return h(e,t),o(e,[{key:"parse",value:function(t){return y(e,"parse",this,3)([t]),this.value(t.value),this.update(t.update),this.commit(),this}},{key:"evaluate",value:function(t,e){return this._signal=this.spec.update?cj(this.spec.update,e,this._signal):this.spec.value,this.spec.value=this._signal,this}},{key:"output",value:function(){return this._signal}},{key:"getValue",value:function(){return this.output()}},{key:"set",value:function(t){if(X(t)&&X(this.value)&&t.length===this.value.length){for(var e=0;e<t.length;e++)if(this.value[e]!==t[e])return this._signal=t,this.spec.value=t,!0;return!1}return this._signal!==t&&(this._signal=t,this.spec.value=t,!0)}},{key:"update",value:function(t){return j(t)||this.value(void 0),this.setFunctionSpec(t,"update")}},{key:"value",value:function(t){return j(t)||this.update(void 0),this.spec.value=t,this.commit(),this}},{key:"reuse",value:function(t){return t.grammarType!==this.grammarType||(this._signal=t.output()),this}},{key:"clear",value:function(){y(e,"clear",this,3)([]),this._signal=null}}])}(Qj),AN=-1,MN=[vN,gN,_N,yN,mN,bN,xN],wN=function(t){var e,i,n,r;return Z(t)?{top:t,bottom:t,left:t,right:t}:{top:null!==(e=null==t?void 0:t.top)&&void 0!==e?e:0,bottom:null!==(i=null==t?void 0:t.bottom)&&void 0!==i?i:0,left:null!==(n=null==t?void 0:t.left)&&void 0!==n?n:0,right:null!==(r=null==t?void 0:t.right)&&void 0!==r?r:0}};function TN(t,e,i){var n=new Map;if(!t||0===t.length)return{keys:[],data:n};if(!e)return n.set(KH,i?t.slice().sort(i):t.slice()),{keys:ZH,data:n};var r=pj(e);if(1===t.length){var a=r(t[0]);return n.set(a,[t[0]]),{keys:[a],data:n}}var o=new Set;return t.forEach((function(t){var e,i=r(t),a=null!==(e=n.get(i))&&void 0!==e?e:[];a.push(t),n.set(i,a),o.add(i)})),i&&o.forEach((function(t){n.get(t).sort(i)})),{keys:Array.from(o),data:n}}var CN=function(){return o((function t(e,i,n){r(this,t),this.prevData=(null==e?void 0:e.length)?TN(e,null!=i?i:null,n):null}),[{key:"setCurrentData",value:function(t){this.currentData=t}},{key:"getCurrentData",value:function(){return this.currentData}},{key:"doDiff",value:function(){var t=this;if(this.callback)if(this.currentData&&this.prevData){var e=new Map(this.prevData.data);this.currentData.keys.forEach((function(i){t.callback(i,t.currentData.data.get(i),e.get(i)),e.delete(i)})),this.prevData.keys.forEach((function(i){e.has(i)&&t.callback(i,null,e.get(i))}))}else this.currentData?this.currentData.keys.forEach((function(e){t.callback(e,t.currentData.data.get(e),null)})):this.prevData&&this.prevData.keys.forEach((function(e){t.callback(e,null,t.prevData.data.get(e))}))}},{key:"setCallback",value:function(t){this.callback=t}},{key:"updateToCurrent",value:function(){this.prevData=this.currentData,this.currentData=null}},{key:"reset",value:function(){this.prevData=null}}])}();var EN=function(t){function e(t,a,o){var s;return r(this,e),(s=n(this,e,[t])).grammarType="mark",s.elements=[],s.elementMap=new Map,s.isUpdated=!0,s._isReentered=!1,s.differ=new CN([]),s.markType=a,s.spec.type=a,s.spec.encode={update:{}},s.spec.group=o,o&&(s.group=o,s.attach(o),o.appendChild(i(s))),s}return h(e,t),o(e,[{key:"parse",value:function(t){var i,n,r,a=this;if(y(e,"parse",this,3)([t]),this.spec.group){var o=Y(this.spec.group)?this.view.getMarkById(this.spec.group):this.spec.group;this.detach(o)}var s=Y(t.group)?this.view.getMarkById(t.group):t.group;return this.attach(s),this.join(null===(i=t.from)||void 0===i?void 0:i.data,t.key,t.sort,t.groupBy,t.groupSort),this.coordinate(t.coordinate),this.state(t.state,this.spec.stateSort),Object.keys(null!==(n=this.spec.encode)&&void 0!==n?n:{}).forEach((function(t){a.encodeState(t,{},!0)})),Object.keys(null!==(r=t.encode)&&void 0!==r?r:{}).forEach((function(e){a.encodeState(e,t.encode[e])})),this.animation(t.animation),this.animationState(t.animationState),this.morph(t.morph,t.morphKey,t.morphElementKey),this.layout(t.layout),this.configure(t),this.transform(t.transform),this.parseAddition(t),this.spec=t,this.markType=t.type,this.commit(),this}},{key:"parameters",value:function(){var t;return null!==(t=this._finalParameters)&&void 0!==t?t:y(e,"parameters",this,3)([])}},{key:"parseAddition",value:function(t){return this}},{key:"reuse",value:function(t){var e,i=this;if(t.grammarType!==this.grammarType)return this;var n=t;return this.markType=n.markType,this.coord=n.coord,this.elementMap=n.elementMap,this.elements=n.elements,this.elementMap.forEach((function(t){return t.mark=i})),this.differ=n.differ,null===(e=this.reuseAnimate)||void 0===e||e.call(this,n),this._context=n._context,this.graphicItem=n.graphicItem,this.graphicIndex=n.graphicIndex,this.graphicParent=n.graphicParent,this.needClear=n.needClear,this.isUpdated=n.isUpdated,this}},{key:"needLayout",value:function(){return!j(this.spec.layout)}},{key:"handleLayoutEnd",value:function(){}},{key:"handleRenderEnd",value:function(){this.needClear&&(this.cleanExitElements(),this.elementMap.forEach((function(t){t.diffState===AH.exit?t.clearGraphicAttributes():t.clearChangedGraphicAttributes()})),this.differ.updateToCurrent(),this.needClear=!1)}},{key:"evaluateMainTasks",value:function(t,e){var i,n;if(this.needSkipBeforeLayout()&&this.view.getLayoutState()===LH.before)return this;var r=null===(i=this.view.renderer)||void 0===i?void 0:i.stage();this.init(r,e);var a=this.evaluateTransform(this._getTransformsBeforeJoin(),null!=t?t:qH,e),o=null==a?void 0:a.progressive;if(o?this.renderContext={large:!1}:(this.evaluateGroup(a),this.renderContext=this.parseRenderContext(a,e)),null===(n=this.renderContext)||void 0===n?void 0:n.progressive)this.differ.reset(),this.elementMap.clear(),this.evaluateProgressive();else{var s=null;if(o){if(this.renderContext.parameters=e,this.renderContext.beforeTransformProgressive=a.progressive,s=a.progressive.output(),a.progressive.canAnimate&&a.progressive.unfinished())return this.update(this.spec),this}else s=a;this.emit(DH.BEFORE_MARK_JOIN),this.evaluateJoin(s),this.emit(DH.AFTER_MARK_JOIN),this.emit(DH.BEFORE_MARK_STATE),this.evaluateState(this.elements,this.spec.state,e),this.emit(DH.AFTER_MARK_STATE),this.emit(DH.BEFORE_MARK_ENCODE),this.evaluateEncode(this.elements,this._getEncoders(),e),this.emit(DH.AFTER_MARK_ENCODE)}return this.update(this.spec),this}},{key:"evaluateGroup",value:function(t){if(this.markType!==MH.group){var e=TN(null!=t?t:qH,this.spec.groupBy,this.spec.groupSort);this._groupEncodeResult=null,this._groupedData=e}}},{key:"_getTransformsAfterEncodeItems",value:function(){return this.transforms&&this.transforms.filter((function(t){return"afterEncodeItems"===t.markPhase}))}},{key:"_getTransformsAfterEncode",value:function(){return this.transforms&&this.transforms.filter((function(t){return j(t.markPhase)||"afterEncode"===t.markPhase}))}},{key:"_getTransformsBeforeJoin",value:function(){return this.transforms?this.transforms.filter((function(t){return"beforeJoin"===t.markPhase})):[]}},{key:"evaluate",value:function(t,e){var i;return this.evaluateMainTasks(t,e),(null===(i=this.renderContext)||void 0===i?void 0:i.progressive)||this.evaluateTransform(this._getTransformsAfterEncode(),this.elements,e),this}},{key:"output",value:function(){return this}},{key:"join",value:function(t,e,i,n,r){return this.grammarSource&&(this.detach(this.grammarSource),this.grammarSource=null),this.spec.from=null,j(t)||(Y(t)?this.grammarSource=this.view.getDataById(t):this.grammarSource=t,this.spec.from={data:t},this.attach(this.grammarSource)),this.spec.key=e,this.spec.sort=i,this.spec.groupBy=n,this.spec.groupSort=r,this.commit(),this}},{key:"coordinate",value:function(t){return Y(t)?this.coord=this.view.getCoordinateById(t):this.coord=t,this.attach(this.coord),this.commit(),this}},{key:"state",value:function(t,e){return this.spec.stateSort=e,this.setFunctionSpec(t,"state")}},{key:"encode",value:function(t,e,i){return this.encodeState(AH.update,t,e,i)}},{key:"encodeState",value:function(t,e,i,n){var r=this;if(t===AH.enter&&(this._isReentered=!0),this.spec.encode[t]){var a=this.spec.encode[t];if(uj(a))this.detach(gj(a,this.view));else{var o=Y(e);o&&n||!o&&i?(Object.keys(a).forEach((function(t){r.detach(gj(a[t],r.view))})),this.spec.encode[t]={}):o?this.detach(gj(a[e],this.view)):Object.keys(e).forEach((function(t){r.detach(gj(a[t],r.view))}))}}return e&&(this.spec.encode[t]||(this.spec.encode[t]={}),Y(e)?(this.spec.encode[t][e]=i,this.attach(gj(i,this.view))):uj(e)?(this.spec.encode[t]=e,this.attach(gj(e,this.view))):e&&(Object.assign(this.spec.encode[t],e),Object.values(e).forEach((function(t){r.attach(gj(t,r.view))})))),this.commit(),this}},{key:"_getEncoders",value:function(){var t;return null!==(t=this.spec.encode)&&void 0!==t?t:{}}},{key:"animation",value:function(t){return this.spec.animation=t,this}},{key:"animationState",value:function(t){return this.setFunctionSpec(t,"animationState")}},{key:"layout",value:function(t){return this.spec.layout=t,this.commit(),this}},{key:"morph",value:function(t,e,i){return this.spec.morph=t,this.spec.morphKey=e,this.spec.morphElementKey=i,this}},{key:"transform",value:function(t){var e=eN(this.spec.transform,this.view);e&&(this.detach(e.refs),this.transforms=[]);var i=eN(t,this.view);return i&&(this.attach(i.refs),this.transforms=i.transforms),this.spec.transform=t,this.commit(),this}},{key:"configure",value:function(t){var e=this,i=["clip","clipPath","zIndex","interactive","context","setCustomizedShape","large","largeThreshold","progressiveStep","progressiveThreshold","support3d","morph","morphKey","morphElementKey","attributeTransforms","skipTheme","enableSegments","stateSort","graphicName","overflow"];return null===t?(i.forEach((function(t){j(e.spec[t])||(e.spec[t]=void 0)})),this):(i.forEach((function(i){j(t[i])||(e.spec[i]=t[i])})),this)}},{key:"context",value:function(t){return this.spec.context=t,this._context=t,this}},{key:"isCollectionMark",value:function(){return YH.includes(this.markType)}},{key:"needAnimate",value:function(){var t;return!(null===(t=this.renderContext)||void 0===t?void 0:t.progressive)&&!j(this.spec.animation)}},{key:"getAllElements",value:function(){var t=this,e=this.elements.slice();return this.elementMap.forEach((function(t){t.diffState!==AH.exit||e.includes(t)||e.push(t)})),this.spec.sort&&e.sort((function(e,i){return t.spec.sort(e.getDatum(),i.getDatum())})),e}},{key:"getScales",value:function(){var t={};return this.references.forEach((function(e,i){i.grammarType===OH.scale&&(t[i.id()]=i.output())})),t}},{key:"getScalesByChannel",value:function(){var t=this.spec.encode;if(!t)return{};var e={},i=this.parameters();return Object.keys(t).forEach((function(n){var r=t[n];r&&!uj(r)&&Object.keys(r).forEach((function(t){fj(r[t])&&(e[t]=hj(r[t].scale,i))}))})),e}},{key:"getFieldsByChannel",value:function(){var t=this.spec.encode;if(!t)return{};var e={};return Object.keys(t).forEach((function(i){var n=t[i];uj(n)||Object.keys(n).forEach((function(t){vj(n[t])&&(e[t]=n[t].field)}))})),e}},{key:"init",value:function(t,e){var i,n,r,a,o,s=this;if(this._delegateEvent||(this._delegateEvent=function(t,e){var i=kN(s.view,t,0,fN),n=t.element;(null==n?void 0:n.mark)===s&&s.emitGrammarEvent(e,i,n)},this.initEvent()),null===(i=this.initAnimate)||void 0===i||i.call(this,this.spec),!this.group){var l=hj(this.spec.group,e);this.group=l,l&&l.appendChild(this)}var u=this.group?this.group.getGroupGraphicItem():t.defaultLayer,c=null!==(a=null===(r=null===(n=this.group)||void 0===n?void 0:n.children)||void 0===r?void 0:r.indexOf(this))&&void 0!==a?a:0;if(this.markType!==MH.group){if(!this.graphicItem){var h=kj(this,MH.group,{pickable:!1,zIndex:null!==(o=this.spec.zIndex)&&void 0!==o?o:0,overflow:this.spec.overflow});(this.spec.support3d||XH.includes(this.markType))&&h.setMode("3d"),h.name="".concat(this.id()||this.markType),this.graphicItem=h}this.graphicParent=this.graphicItem,!u||this.graphicIndex===c&&this.graphicItem.parent===u||u.insertIntoKeepIdx(this.graphicItem,c)}else this.graphicParent=u,this.graphicParent.setAttributes({overflow:this.spec.overflow});this.graphicIndex=c}},{key:"update",value:function(t){var e;if(this.emit(DH.BEFORE_MARK_UPDATE),this._context=this.spec.context,this.isUpdated=!0,this.renderContext.progressive||null===(e=this.updateAnimate)||void 0===e||e.call(this,t),this.markType!==MH.group){if(j(t.zIndex)||this.graphicItem.setAttribute("zIndex",t.zIndex),j(t.clip)||this.graphicItem.setAttribute("clip",t.clip),!j(t.clipPath)){var i=X(t.clipPath)?t.clipPath:t.clipPath(this.elements);i&&i.length?this.graphicItem.setAttribute("path",i):this.graphicItem.setAttributes({path:i,clip:!1})}j(t.overflow)||this.graphicItem.setAttribute("overflow",t.overflow),this.elementMap.forEach((function(t){t.updateGraphicItem()}))}else this.elementMap.forEach((function(t){t.updateGraphicItem()}));this.emit(DH.AFTER_MARK_UPDATE)}},{key:"createElement",value:function(){return new Ij(this)}},{key:"evaluateJoin",value:function(t){var e,i,n,r,a=this;this.needClear=!0;var o=pj(null!==(n=null!==(e=this.spec.key)&&void 0!==e?e:null===(i=this.grammarSource)||void 0===i?void 0:i.getDataIDKey())&&void 0!==n?n:function(){return KH}),s=pj(null!==(r=this.spec.groupBy)&&void 0!==r?r:function(){return KH}),l=this.spec.sort,u=this.isCollectionMark(),c=new Set(this.elements.filter((function(t){return t.diffState===AH.enter}))),h=[];this.differ.setCallback((function(t,e,i){var n,r,l=t;if(j(e))(r=a.elementMap.get(l))&&(r.diffState=AH.exit);else if(j(i)){if((r=a.elementMap.has(l)?a.elementMap.get(l):a.createElement()).diffState===AH.exit){r.diffState=AH.enter;var d=null===(n=a.animate)||void 0===n?void 0:n.getElementAnimators(r,AH.exit);d&&d.forEach((function(t){return t.stop("start")}))}r.diffState=AH.enter;var p=u?t:s(e[0]);r.updateData(p,e,o),a.elementMap.set(l,r),h.push(r)}else if(r=a.elementMap.get(l)){r.diffState=AH.update;var f=u?t:s(e[0]);r.updateData(f,e,o),h.push(r)}c.delete(r)}));var d=null!=t?t:qH;u?this.differ.setCurrentData(this._groupedData):this.differ.setCurrentData(TN(d,(function(t){return"".concat(s(t),"-").concat(o(t))}),void 0)),this.differ.doDiff(),c.forEach((function(t){a.elementMap.delete(u?t.groupKey:"".concat(t.groupKey,"-").concat(t.key)),t.remove(),t.release()})),this.elements=h,l&&this.elements.length>=2&&this.elements.sort((function(t,e){return l(t.getDatum(),e.getDatum())}))}},{key:"evaluateState",value:function(t,e,i){e&&t.forEach((function(t){t.state(e,i)}))}},{key:"evaluateGroupEncode",value:function(t,e,i){if(this._groupedData&&e){var n={};return this._groupedData.keys.forEach((function(r){var a=t.find((function(t){return t.groupKey===r}));a&&(n[r]=_j(e,a.items&&a.items[0]&&a.items[0].datum,a,i))})),this._groupEncodeResult=n,n}}},{key:"getChannelsFromConfig",value:function(t){var e=this.spec;return j(e.interactive)?null:{pickable:e.interactive}}},{key:"evaluateEncode",value:function(t,e,i,n){var r=this,a=this.getChannelsFromConfig();if(e){this.emit(DH.BEFORE_ELEMENT_ENCODE,{encoders:e,parameters:i},this);var o=n?null:this.evaluateGroupEncode(t,e[SH.group],i);t.forEach((function(t){r.markType===MH.glyph&&r._groupEncodeResult?t.items.forEach((function(e){e.nextAttrs=Object.assign(e.nextAttrs,a,r._groupEncodeResult[t.groupKey])})):(null==o?void 0:o[t.groupKey])&&!r.isCollectionMark()?t.items.forEach((function(e){e.nextAttrs=Object.assign(e.nextAttrs,a,o[t.groupKey])})):a&&t.items.forEach((function(t){t.nextAttrs=Object.assign(t.nextAttrs,a)})),t.encodeItems(t.items,e,r._isReentered,i),r.isCollectionMark()&&(null==o?void 0:o[t.groupKey])&&N(o[t.groupKey].defined)&&(t.items.forEach((function(e){e.nextAttrs.defined=o[t.groupKey].defined})),delete o[t.groupKey].defined)})),this._isReentered=!1,this.evaluateTransform(this._getTransformsAfterEncodeItems(),t,i),t.forEach((function(t){t.encodeGraphic(r.isCollectionMark()?null==o?void 0:o[t.groupKey]:null)})),this.emit(DH.AFTER_ELEMENT_ENCODE,{encoders:e,parameters:i},this)}else t.forEach((function(t){t.initGraphicItem(a)}))}},{key:"addGraphicItem",value:function(t,e,i){var n,r=null!=i?i:kj(this,this.markType,t);if(r){if(null===(n=this.renderContext)||void 0===n?void 0:n.progressive){var a;if(this._groupedData){var o=this._groupedData.keys.indexOf(e);o>=0&&(a=this.graphicParent.getChildAt(o))}else a=this.graphicParent.at(0);this.isCollectionMark()?(r.incremental=1,a.appendChild(r)):a.incrementalAppendChild(r)}else this.graphicParent.appendChild(r);return r}}},{key:"parseRenderContext",value:function(t,e){var i=this,n=this.markType!==MH.group&&this.spec.progressiveStep>0&&this.spec.progressiveThreshold>0&&this.spec.progressiveStep<this.spec.progressiveThreshold,r=this.spec.large&&this.spec.largeThreshold>0&&t.length>=this.spec.largeThreshold;if(n){var a=this._groupedData;return a&&a.keys&&a.keys.some((function(t){return a.data.get(t).length>i.spec.progressiveThreshold}))?{large:r,parameters:e,progressive:{data:t,step:this.spec.progressiveStep,currentIndex:0,totalStep:a.keys.reduce((function(t,e){return Math.max(Math.ceil(a.data.get(e).length/i.spec.progressiveStep),t)}),1),groupedData:a.data}}:{large:r}}return{large:r}}},{key:"isProgressive",value:function(){return this.renderContext&&(!!this.renderContext.progressive||!!this.renderContext.beforeTransformProgressive)}},{key:"canAnimateAfterProgressive",value:function(){return this.renderContext&&this.renderContext.beforeTransformProgressive&&this.renderContext.beforeTransformProgressive.canAnimate()}},{key:"isDoingProgressive",value:function(){return this.renderContext&&(this.renderContext.progressive&&this.renderContext.progressive.currentIndex<this.renderContext.progressive.totalStep||this.renderContext.beforeTransformProgressive&&this.renderContext.beforeTransformProgressive.unfinished())}},{key:"clearProgressive",value:function(){this.renderContext&&this.renderContext.progressive&&(this.elements=[],this.graphicParent.children.forEach((function(t){t.incrementalClearChild()})),this.graphicParent.removeAllChild()),this.renderContext&&this.renderContext.beforeTransformProgressive&&this.renderContext.beforeTransformProgressive.release(),this.renderContext=null}},{key:"restartProgressive",value:function(){this.renderContext&&this.renderContext.progressive&&(this.renderContext.progressive.currentIndex=0)}},{key:"evaluateJoinProgressive",value:function(){var t,e,i,n=this,r=this.renderContext.progressive.currentIndex,a=pj(null!==(i=null!==(t=this.spec.key)&&void 0!==t?t:null===(e=this.grammarSource)||void 0===e?void 0:e.getDataIDKey())&&void 0!==i?i:function(){return KH}),o=[];if(this.isCollectionMark())return this._groupedData.keys.forEach((function(t,e){var i=n.renderContext.progressive.groupedData.get(t),s=n.renderContext.progressive.step,l=i.slice(r*s,(r+1)*s);if(0===r){var u=n.createElement();u.diffState=AH.enter,u.updateData(t,l,a),o.push(u)}else{var c=n.elements[e];c.updateData(t,l,a),o.push(c)}})),o;var s={};return this._groupedData.keys.forEach((function(t){var e=n.renderContext.progressive.groupedData.get(t),i=n.renderContext.progressive.step,l=e.slice(r*i,(r+1)*i),u=[];l.forEach((function(e){var i=n.createElement();i.diffState=AH.enter,i.updateData(t,[e],a),u.push(i),o.push(i)})),s[t]=u})),{groupElements:s,elements:o}}},{key:"evaluateEncodeProgressive",value:function(t,e,i){var n=this.renderContext.progressive.currentIndex;if(0===n){if(this.evaluateEncode(t,e,i),0===n&&this._groupEncodeResult&&!this.isCollectionMark()&&this.markType!==MH.glyph){var r=t[0],a=r.getGraphicItem(),o=null==a?void 0:a.parent;o&&this._groupEncodeResult[r.groupKey]&&o.setTheme({common:this._groupEncodeResult[r.groupKey]})}}else this.evaluateEncode(t,e,i,!0)}},{key:"evaluateProgressive",value:function(){var t,e,i,n=this;if(null===(t=this.renderContext)||void 0===t?void 0:t.beforeTransformProgressive){var r=this.renderContext.beforeTransformProgressive;r.progressiveRun();var a=r.output();if(r.canAnimate){if(r.unfinished())return;this.evaluateGroup(a)}return this.emit(DH.BEFORE_MARK_JOIN),this.evaluateJoin(a),this.emit(DH.AFTER_MARK_JOIN),this.emit(DH.BEFORE_MARK_STATE),this.evaluateState(this.elements,this.spec.state,this.renderContext.parameters),this.emit(DH.AFTER_MARK_STATE),this.emit(DH.BEFORE_MARK_ENCODE),this.evaluateEncode(this.elements,this._getEncoders(),this.renderContext.parameters),void this.emit(DH.AFTER_MARK_ENCODE)}if(null===(e=this.renderContext)||void 0===e?void 0:e.progressive){var o=this.renderContext.parameters;this.emit(DH.BEFORE_MARK_JOIN);var s=this.evaluateJoinProgressive(),l=Array.isArray(s)?s:s.elements;if(this.emit(DH.AFTER_MARK_JOIN),0===this.renderContext.progressive.currentIndex?(this.graphicParent.removeAllChild(),this._groupedData.keys.forEach((function(t){var e=kj(n,MH.group,{pickable:!1,zIndex:n.spec.zIndex});e.incremental=n.renderContext.progressive.step,n.graphicParent.appendChild(e)})),this.elements=l):this.elements=this.elements.concat(l),this.emit(DH.BEFORE_MARK_STATE),this.evaluateState(l,this.spec.state,o),this.emit(DH.AFTER_MARK_STATE),this.emit(DH.BEFORE_MARK_ENCODE),Array.isArray(s))this.evaluateEncodeProgressive(l,this._getEncoders(),o);else{var u=s.groupElements;Object.keys(u).forEach((function(t){n.evaluateEncodeProgressive(u[t],n._getEncoders(),o)}))}this.emit(DH.AFTER_MARK_ENCODE);var c=null===(i=this._getTransformsAfterEncode())||void 0===i?void 0:i.filter((function(t){return!0===t.canProgressive}));(null==c?void 0:c.length)&&this.evaluateTransform(c,this.elements,o),this.renderContext.progressive.currentIndex+=1}}},{key:"isLargeMode",value:function(){return this.renderContext&&this.renderContext.large}},{key:"cleanExitElements",value:function(){var t=this;this.elementMap.forEach((function(e,i){e.diffState!==AH.exit||e.isReserved||(t.elementMap.delete(i),e.remove(),e.release())}))}},{key:"getGroupGraphicItem",value:function(){if(this.elements&&this.elements[0]&&this.elements[0].getGraphicItem)return this.elements[0].getGraphicItem()}},{key:"getBounds",value:function(){var t;return this.graphicItem?this.graphicItem.AABBBounds:null===(t=this.getGroupGraphicItem())||void 0===t?void 0:t.AABBBounds}},{key:"getMorphConfig",value:function(){var t;return{morph:null!==(t=this.spec.morph)&&void 0!==t&&t,morphKey:this.spec.morphKey,morphElementKey:this.spec.morphElementKey}}},{key:"getAttributeTransforms",value:function(){var t;return null!==(t=this.spec.attributeTransforms)&&void 0!==t?t:wj[this.markType]}},{key:"getContext",value:function(){return this._context}},{key:"needSkipBeforeLayout",value:function(){var t,e;if(!0===(null===(t=this.spec.layout)||void 0===t?void 0:t.skipBeforeLayouted))return!0;for(var i=this.group;i;){if(!0===(null===(e=i.getSpec().layout)||void 0===e?void 0:e.skipBeforeLayouted))return!0;i=i.group}return!1}},{key:"initEvent",value:function(){if(this._delegateEvent){var t=this.view.renderer.stage();t&&t.on("*",this._delegateEvent)}}},{key:"releaseEvent",value:function(){if(this._delegateEvent){var t=this.view.renderer.stage();t&&t.off("*",this._delegateEvent)}}},{key:"clear",value:function(){var t;this.releaseEvent(),this.transforms=null,this.elementMap=null,this.elements=null,this.graphicItem=null,this.animate=null,null===(t=this.group)||void 0===t||t.removeChild(this),this.group=null,y(e,"clear",this,3)([])}},{key:"prepareRelease",value:function(){var t;this.differ.setCurrentData(null),null===(t=this.animate)||void 0===t||t.stop(),this.elementMap.forEach((function(t){return t.diffState=AH.exit})),this._finalParameters=this.parameters()}},{key:"release",value:function(){this.releaseEvent(),this.elements.forEach((function(t){return t.release()})),this.differ=null,this.elements=[],this.elementMap.clear(),this._finalParameters=null,this.animate&&this.animate.release(),this.graphicItem&&Sj(this.graphicItem),this.detachAll(),y(e,"release",this,3)([])}}])}(Qj),PN=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[t,MH.group,i])).children=[],a}return h(e,t),o(e,[{key:"parseRenderContext",value:function(){return{large:!1}}},{key:"appendChild",value:function(t){return this.children.push(t),this}},{key:"removeChild",value:function(t){return this.children=this.children.filter((function(e){return e!==t})),this}},{key:"includesChild",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return!!this.children.includes(t)||!!e&&this.children.some((function(e){return e.markType===MH.group&&e.includesChild(t,!0)}))}},{key:"updateLayoutChildren",value:function(){return this.children.length?(this.layoutChildren||(this.layoutChildren=[]),this.layoutChildren=this.children.filter((function(t){return t.needLayout()})),this):this}},{key:"getAttributeTransforms",value:function(){return wj.rect}},{key:"evaluateJoin",value:function(t){if(!this.elements.length){var e=this.createElement();e.updateData(KH,qH,(function(){return""})),this.elements=[e],this.elementMap.set(KH,e)}}},{key:"getChannelsFromConfig",value:function(t){var e=this.spec,i={};if(j(e.clip)||(i.clip=e.clip),j(e.zIndex)||(i.zIndex=e.zIndex),!j(e.clipPath)){var n=H(e.clipPath)?e.clipPath([t]):e.clipPath;n&&n.length?i.path=n:(i.path=null,i.clip=!1)}return j(e.interactive)||(i.pickable=e.interactive),i}},{key:"evaluateGroupEncode",value:function(t,e,i){var n,r=this.elements[0],a={};return mj(r,[Object.assign({},null===(n=r.items)||void 0===n?void 0:n[0],{nextAttrs:a})],e,i),this._groupEncodeResult=a,a}},{key:"evaluateEncode",value:function(t,e,i,n){var r=this,a=this.getChannelsFromConfig();if(e){this.emit(DH.BEFORE_ELEMENT_ENCODE,{encoders:e,parameters:i},this);var o=n?null:this.evaluateGroupEncode(t,e[SH.group],i);t.forEach((function(t){t.items.forEach((function(t){t.nextAttrs=Object.assign(t.nextAttrs,a,o)})),t.encodeItems(t.items,e,r._isReentered,i)})),this._isReentered=!1,this.evaluateTransform(this._getTransformsAfterEncodeItems(),t,i),t.forEach((function(t){t.encodeGraphic()})),this.emit(DH.AFTER_ELEMENT_ENCODE,{encoders:e,parameters:i},this)}else t.forEach((function(t){t.initGraphicItem(a)}))}},{key:"addGraphicItem",value:function(t,e,i){var n=null!=i?i:kj(this,this.markType,t);if(n)return this.emit(DH.BEFORE_ADD_VRENDER_MARK,{graphicItem:n}),n.name="".concat(this.id()||this.markType),this.graphicParent.insertIntoKeepIdx(n,this.graphicIndex),this.emit(DH.AFTER_ADD_VRENDER_MARK,{graphicItem:n}),n}}])}(EN),RN=function(){return o((function t(e,i){r(this,t),this._grammars={signal:[],data:[],scale:[],coordinate:[],mark:[],customized:[]},this._grammarMap={signal:{},data:{},scale:{},coordinate:{},mark:{},customized:{}},this._size=0,this._mapKey=Y(e)?function(t){return t[e]}:e,this._warning=i}),[{key:"record",value:function(t){var e,i,n=t.grammarType,r=this._mapKey(t);return this._grammarMap[n]?(this._grammars[n].push(t),j(r)||(this._grammarMap[n][r]?null===(e=this._warning)||void 0===e||e.call(this,r,t):this._grammarMap[n][r]=t)):(this._grammars.customized.push(t),j(r)||(this._grammarMap.customized[r]?null===(i=this._warning)||void 0===i||i.call(this,r,t):this._grammarMap.customized[r]=t)),this._size+=1,this}},{key:"unrecord",value:function(t){var e=t.grammarType,i=this._mapKey(t);return this._grammarMap[e]?(this._grammars[e]=this._grammars[e].filter((function(e){return e!==t})),j(i)||this._grammarMap[e][i]!==t||delete this._grammarMap[e][i]):(this._grammars.customized=this._grammars.customized.filter((function(e){return e!==t})),j(i)||this._grammarMap.customized[i]!==t||delete this._grammarMap.customized[i]),this._size-=1,this}},{key:"size",value:function(){return this._size}},{key:"getSignal",value:function(t){var e;return null!==(e=this._grammarMap.signal[t])&&void 0!==e?e:null}},{key:"getData",value:function(t){var e;return null!==(e=this._grammarMap.data[t])&&void 0!==e?e:null}},{key:"getScale",value:function(t){var e;return null!==(e=this._grammarMap.scale[t])&&void 0!==e?e:null}},{key:"getCoordinate",value:function(t){var e;return null!==(e=this._grammarMap.coordinate[t])&&void 0!==e?e:null}},{key:"getMark",value:function(t){var e;return null!==(e=this._grammarMap.mark[t])&&void 0!==e?e:null}},{key:"getCustomized",value:function(t){var e;return null!==(e=this._grammarMap.customized[t])&&void 0!==e?e:null}},{key:"getGrammar",value:function(t){return this._grammarMap.data[t]?this._grammarMap.data[t]:this._grammarMap.signal[t]?this._grammarMap.signal[t]:this._grammarMap.scale[t]?this._grammarMap.scale[t]:this._grammarMap.coordinate[t]?this._grammarMap.coordinate[t]:this._grammarMap.mark[t]?this._grammarMap.mark[t]:this._grammarMap.customized[t]?this._grammarMap.customized[t]:null}},{key:"getAllSignals",value:function(){return this._grammars.signal}},{key:"getAllData",value:function(){return this._grammars.data}},{key:"getAllScales",value:function(){return this._grammars.scale}},{key:"getAllCoordinates",value:function(){return this._grammars.coordinate}},{key:"getAllMarks",value:function(){return this._grammars.mark}},{key:"getAllCustomized",value:function(){return this._grammars.customized}},{key:"traverse",value:function(t){var e;Object.values(null!==(e=this._grammars)&&void 0!==e?e:{}).forEach((function(e){return(null!=e?e:[]).forEach((function(e){t.call(null,e)}))}))}},{key:"find",value:function(t){var e=null;return this.traverse((function(i){return!0===t.call(null,i)&&(e=i,!0)})),e}},{key:"filter",value:function(t){var e=[];return this.traverse((function(i){!0===t.call(null,i)&&e.push(i)})),e}},{key:"clear",value:function(){this._size=0,this._grammars={signal:[],data:[],scale:[],coordinate:[],mark:[],customized:[]},this._grammarMap={signal:{},data:{},scale:{},coordinate:{},mark:{},customized:{}}}},{key:"release",value:function(){this._size=0,this._grammars=null,this._grammarMap=null}}])}(),BN=function(t){function e(){var t;return r(this,e),(t=n(this,e,arguments))._markNodes=[],t}return h(e,t),o(e,[{key:"record",value:function(t){if(y(e,"record",this,3)([t]),"mark"===t.grammarType){var i=t,n={mark:i,parent:null,children:[]};this._markNodes.forEach((function(t){var e=t.mark;e.markType===MH.group&&e.includesChild(i,!1)?(t.children.push(n),n.parent=t):i.markType===MH.group&&i.includesChild(e,!1)&&(n.children.push(t),t.parent=n)})),this._markNodes.push(n)}return this}},{key:"unrecord",value:function(t){if(y(e,"unrecord",this,3)([t]),"mark"===t.grammarType){var i=t,n=this._markNodes.find((function(t){return t.mark===i}));this._markNodes.forEach((function(t){t.mark.markType===MH.group&&t.children.includes(n)?(t.children=t.children.filter((function(t){return t!==n})),n.parent=null):i.markType===MH.group&&n.children.includes(t)&&(n.children=n.children.filter((function(e){return e!==t})),t.parent=null)})),this._markNodes=this._markNodes.filter((function(t){return t!==n}))}return this}},{key:"getAllMarkNodes",value:function(){return this._markNodes}},{key:"clear",value:function(){y(e,"clear",this,3)([]),this._markNodes=[]}},{key:"release",value:function(){y(e,"release",this,3)([]),this._markNodes=null}}])}(RN),IN=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"addGraphicItem",value:function(t,i){var n=t&&t.limitAttrs,r=kj(this,n&&("rich"===n.textType||n.text&&"rich"===n.text.type)?MH.richtext:MH.text,t);return y(e,"addGraphicItem",this,3)([t,i,r])}},{key:"release",value:function(){y(e,"release",this,3)([])}}])}(EN);IN.markType=MH.text;var LN={axis:{label:{visible:!0,inside:!1,space:4,style:{fontSize:12,fill:"#89909d",fontWeight:"normal",fillOpacity:1}},tick:{visible:!0,inside:!1,alignWithLabel:!0,length:4,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},subTick:{visible:!1,inside:!1,count:4,length:2,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},line:{visible:!0,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},items:[],start:{x:0,y:0},end:{x:100,y:0},x:0,y:0},circleAxis:{title:{space:4,padding:[0,0,0,0],textStyle:{fontSize:12,fill:"#333333",fontWeight:"normal",fillOpacity:1},text:"theta"},label:{visible:!0,inside:!1,space:4,style:{fontSize:12,fill:"#6F6F6F",fontWeight:"normal",fillOpacity:1}},tick:{visible:!0,inside:!1,alignWithLabel:!0,length:4,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},subTick:{visible:!1,inside:!1,count:4,length:2,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},line:{visible:!0,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},items:[],startAngle:0,endAngle:2*Math.PI,radius:100,innerRadius:0,center:{x:0,y:0},x:0,y:0},grid:{style:{stroke:"#f1f2f5"}},circleGrid:{style:{stroke:"#f1f2f5"}},discreteLegend:{layout:"vertical",title:{align:"start",space:12,textStyle:{fontSize:12,fontWeight:"bold",fill:"#2C3542"}},item:{spaceCol:10,spaceRow:10,shape:{space:4,style:{size:10,cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{fill:"#D8D8D8",stroke:"#D8D8D8",fillOpacity:.5}}},label:{space:4,style:{fontSize:12,fill:"black",cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{fill:"#D8D8D8",fillOpacity:.5}}},value:{alignRight:!1,style:{fontSize:12,fill:"#ccc",cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{fill:"#D8D8D8"}}},background:{style:{cursor:"pointer"},state:{selectedHover:{fillOpacity:.7,fill:"gray"},unSelectedHover:{fillOpacity:.2,fill:"gray"}}},focus:!1,focusIconStyle:{size:10,fill:"#333",cursor:"pointer"},visible:!0,padding:{top:2,bottom:2,left:2,right:2}},autoPage:!0,pager:{space:12,handler:{style:{size:10},space:4}},hover:!0,select:!0,selectMode:"multiple",allowAllCanceled:!1,items:[{index:0,id:"",label:"",shape:{fill:"#6690F2",stroke:"#6690F2",symbolType:"circle"}}]},colorLegend:{title:{visible:!1,text:""},colors:[],layout:"horizontal",railWidth:200,railHeight:8,railStyle:{cornerRadius:5}},sizeLegend:{title:{visible:!1,text:""},trackStyle:{fill:"#ccc"},layout:"horizontal",align:"bottom",railWidth:200,railHeight:6,min:0,max:1,value:[0,1]},lineCrosshair:{start:{x:0,y:0},end:{x:0,y:0}},rectCrosshair:{start:{x:0,y:0},end:{x:0,y:0},rectStyle:{width:10,height:10}},sectorCrosshair:{center:{x:0,y:0},radius:100,startAngle:0,endAngle:Math.PI/6},circleCrosshair:{center:{x:0,y:0},radius:100,startAngle:0,endAngle:2*Math.PI},polygonCrosshair:{center:{x:0,y:0},radius:100,startAngle:0,endAngle:2*Math.PI,sides:6},slider:{layout:"horizontal",railWidth:200,railHeight:10,railStyle:{cornerRadius:5},range:{draggableTrack:!0},startText:{visible:!0,text:"",space:8},endText:{visible:!0,text:"",space:8},min:0,max:1,value:[0,1]},dataLabel:{size:{width:400,height:400},dataLabels:[]},pointLabel:{data:[{text:"",fill:"#606773",data:{}}],overlap:{avoidBaseMark:!1,clampForce:!1,size:{width:1e3,height:1e3}},smartInvert:!1},lineLabel:{type:"line",data:[{text:"",data:{}}],position:"start",overlap:{avoidBaseMark:!1,clampForce:!1,size:{width:1e3,height:1e3}},smartInvert:!1},areaLabel:{type:"area",data:[{text:"",data:{}}],position:"end",overlap:{avoidBaseMark:!1,clampForce:!1,size:{width:1e3,height:1e3}},smartInvert:!1},rectLabel:{type:"rect",data:[{text:"",fill:"#606773",data:{}}],position:"top",overlap:{size:{width:1e3,height:1e3},strategy:[{type:"position"}]},smartInvert:!1},symbolLabel:{type:"symbol",data:[{text:"",fill:"#606773",data:{}}],position:"top",overlap:{avoidBaseMark:!0,size:{width:1e3,height:1e3},strategy:[{type:"position"}]},smartInvert:!1},arcLabel:{type:"arc",data:[{text:"",fill:"#606773",data:{}}],width:800,height:600,position:"outside",zIndex:302},lineDataLabel:{type:"line-data",data:[{text:""}],position:"top",overlap:{avoidBaseMark:!1,clampForce:!1},smartInvert:!1},datazoom:{orient:"bottom",showDetail:"auto",brushSelect:!0,start:0,end:1,position:{x:0,y:0},size:{width:500,height:40},previewData:[]},continuousPlayer:{},discretePlayer:{},tooltip:{},title:{textStyle:{fill:"#21252c"},subtextStyle:{fill:"#606773"}},scrollbar:{width:12,height:12,padding:[2,2],railStyle:{fill:"rgba(0, 0, 0, .1)"}}},DN={symbol:{shape:"circle",size:8},text:{fontSize:14,fill:"#000000"}},ON=Object.assign({},LN);ON.axis=Object.assign({},ON.axis,{label:{style:{fill:"#bbbdc3"}},line:{style:{stroke:"#4b4f54"}},tick:{style:{stroke:"#4b4f54"}},subTick:{style:{stroke:"#4b4f54"}}}),ON.circleAxis=Object.assign({},ON.circleAxis,{label:{style:{fill:"#bbbdc3"}},line:{style:{stroke:"#4b4f54"}},tick:{style:{stroke:"#4b4f54"}},subTick:{style:{stroke:"#4b4f54"}}}),ON.grid=Object.assign({},ON.grid,{style:{stroke:"#404349"}}),ON.circleGrid=Object.assign({},ON.circleGrid,{style:{stroke:"#404349"}}),ON.rectLabel=Object.assign({},ON.rectLabel,{data:[{text:"",fill:"#888c93",data:{}}]}),ON.lineLabel=Object.assign({},ON.lineLabel,{data:[{text:"",fill:"#888c93",data:{}}]}),ON.symbolLabel=Object.assign({},ON.symbolLabel,{data:[{text:"",fill:"#888c93",data:{}}]}),ON.title=Object.assign({},ON.title,{textStyle:{fill:"#fdfdfd"},subtextStyle:{fill:"#888c93"}});var FN={name:"dark",padding:5,background:"#202226",palette:{default:["#5383F4","#7BCF8E","#FF9D2C","#FFDB26","#7568D9","#80D8FB","#1857A3","#CAB0E8","#FF8867","#B9E493","#2CB4A8","#B9E4E3"]},marks:DN,components:ON},zN={name:"default",padding:5,palette:{default:["#6690F2","#70D6A3","#B4E6E2","#63B5FC","#FF8F62","#FFDC83","#BCC5FD","#A29BFE","#63C4C7","#F68484"]},marks:DN,components:LN},HN=function(){function t(){r(this,t)}return o(t,null,[{key:"registerTheme",value:function(e,i){e&&t._themes.set(e,i)}},{key:"unregisterTheme",value:function(e){t._themes.delete(e)}},{key:"getTheme",value:function(e){return t._themes.get(e)}},{key:"getDefaultTheme",value:function(){return t.getTheme("default")}}])}();HN._themes=new Map,HN.registerTheme("default",zN),HN.registerTheme("dark",FN);var jN=function(t){function e(t,i,a,o){var s;return r(this,e),(s=n(this,e,[t,MH.component,a]))._componentDatum=l({},KH,0),s.componentType=i,s.spec.type="component",s.spec.componentType=i,s.mode=o,s._updateComponentEncoders(),s}return h(e,t),o(e,[{key:"configureComponent",value:function(t){return this.spec.componentConfig=t,this.commit(),this}},{key:"addGraphicItem",value:function(t,e,i){var n=null!=i?i:xj.createGraphicComponent(this.componentType,t,{mode:this.mode,skipDefault:this.spec.skipTheme});return n&&(this.emit(DH.BEFORE_ADD_VRENDER_MARK,{graphicItem:n}),this.graphicParent.appendChild(n),this.emit(DH.AFTER_ADD_VRENDER_MARK,{graphicItem:n})),n}},{key:"join",value:function(t){return y(e,"join",this,3)([t,KH])}},{key:"encodeState",value:function(t,i,n){return y(e,"encodeState",this,3)([t,i,n]),this._updateComponentEncoders(),this}},{key:"parseRenderContext",value:function(){return{large:!1}}},{key:"_prepareRejoin",value:function(){this._componentDatum[KH]+=1}},{key:"evaluateJoin",value:function(t){return this.spec.key=KH,t?(t[KH]=this._componentDatum[KH],this._componentDatum=t):this._componentDatum=l({},KH,this._componentDatum[KH]),y(e,"evaluateJoin",this,3)([[this._componentDatum]])}},{key:"_updateComponentEncoders",value:function(){this._encoders=this.spec.encode}},{key:"_getEncoders",value:function(){var t;return null!==(t=this._encoders)&&void 0!==t?t:{}}}])}(EN),NN=Symbol.for("key"),VN=function(){return o((function t(){r(this,t)}),[{key:"diffGrammar",value:function(t,e){return function(t,e,i){var n={enter:[],exit:[],update:[]},r=new CN(t,i);return r.setCallback((function(t,e,i){j(e)?n.exit.push({prev:i[0]}):j(i)?n.enter.push({next:e[0]}):n.update.push({next:e[0],prev:i[0]})})),r.setCurrentData(TN(e,i)),r.doDiff(),n}(t,e,(function(t){var e;return null!==(e=t.id())&&void 0!==e?e:Symbol()}))}},{key:"diffMark",value:function(t,e,i){var n={enter:[],exit:[],update:[]},r=[],a=[];t.forEach((function(t){t.markType!==MH.group&&(i.morph&&t.getMorphConfig().morph||i.morphAll||i.reuse)?r.push(t):n.exit.push({prev:[t]})})),e.forEach((function(t){t.markType!==MH.group&&(i.morph&&t.getMorphConfig().morph||i.morphAll||i.reuse)?a.push(t):n.enter.push({next:[t]})}));var o=this.diffUpdateByGroup(r,a,(function(t){return t.getMorphConfig().morphKey}),(function(t){return t.getMorphConfig().morphKey}));r=o.prev,a=o.next,n.update=n.update.concat(o.update);var s=this.diffUpdateByGroup(r,a,(function(t){return t.id()}),(function(t){return t.id()}));r=s.prev,a=s.next,n.update=n.update.concat(s.update);var l=TN(r,(function(t){var e,i;return null===(i=null===(e=t.group)||void 0===e?void 0:e.id)||void 0===i?void 0:i.call(e)})),u=TN(a,(function(t){var e,i;return null===(i=null===(e=t.group)||void 0===e?void 0:e.id)||void 0===i?void 0:i.call(e)}));return Object.keys(u).forEach((function(t){var e=l.data.get(t),i=u.data.get(t);if(e&&i){for(var o=0;o<Math.max(e.length,i.length);o+=1){var s=e[o],c=i[o];s&&c?n.update.push({prev:[s],next:[c]}):s?n.exit.push({prev:[s]}):c&&n.enter.push({next:[c]})}r=r.filter((function(t){return!e.includes(t)})),a=a.filter((function(t){return!i.includes(t)}))}})),r.forEach((function(t){return n.exit.push({prev:[t]})})),a.forEach((function(t){return n.enter.push({next:[t]})})),n}},{key:"diffUpdateByGroup",value:function(t,e,i,n){var r=TN(t,(function(t){var e;return null!==(e=i(t))&&void 0!==e?e:NN})),a=TN(e,(function(t){var e;return null!==(e=n(t))&&void 0!==e?e:NN})),o=t,s=e,l=[];return a.keys.forEach((function(t){if(t!==NN){var e=r.data.get(t),i=a.data.get(t);e&&i&&(l.push({prev:e,next:i}),o=o.filter((function(t){return!e.includes(t)})),s=s.filter((function(t){return!i.includes(t)})))}})),{prev:o,next:s,update:l}}}])}(),WN=function(t){function e(){var t,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(this,e),(t=n(this,e))._observer=null,t._onResize=qt((function(){var e=t._getContainerSize();e&&t.resize(e.width,e.height)}),100),t.delegateEvent=function(e,n){var r=kN(i(t),e,0,fN);t.emit(n,r,e.element)},t.handleProgressiveFrame=function(){t._progressiveMarks.length&&t._progressiveMarks.forEach((function(t){t.isDoingProgressive()&&t.evaluateProgressive()})),t.doPreProgressive()},t._config=o,t._options=Object.assign({mode:"browser"},a),t.initialize(),t}return h(e,t),o(e,[{key:"getGrammarById",value:function(t){return this.grammars.getGrammar(t)}},{key:"getSignalById",value:function(t){return this.grammars.getSignal(t)}},{key:"getDataById",value:function(t){return this.grammars.getData(t)}},{key:"getScaleById",value:function(t){return this.grammars.getScale(t)}},{key:"getCoordinateById",value:function(t){return this.grammars.getCoordinate(t)}},{key:"getMarkById",value:function(t){return this.grammars.getMark(t)}},{key:"getCustomizedById",value:function(t){return this.grammars.getCustomized(t)}},{key:"getGrammarsByName",value:function(t){return this.grammars.filter((function(e){return e.name()===t}))}},{key:"getGrammarsByType",value:function(t){return this.grammars.filter((function(e){return e.grammarType===t}))}},{key:"getMarksByType",value:function(t){return this.grammars.getAllMarks().filter((function(e){return e.markType===t}))}},{key:"getMarksByName",value:function(t){return this.grammars.getAllMarks().filter((function(e){return e.name()===t}))}},{key:"getMarksBySelector",value:function(t){var e=this;if(!t)return null;var i=xt(t),n=[];return i.forEach((function(t){if(dj(t))n.push(t);else if("#"!==t[0]){var i="@"===t[0]?e.getMarksByName(t.slice(1)):MH[t]?e.getMarksByType(t):null;i&&i.length&&i.forEach((function(t){n.push(t)}))}else{var r=e.getMarkById(t.slice(1));r&&n.push(r)}})),n}},{key:"updateSignal",value:function(t,e){Y(t)&&(t=this.getSignalById(t)),t.set(e),this.commit(t)}},{key:"signal",value:function(t,e){var i=new SN(this);return arguments.length>=1&&i.value(t),arguments.length>=2&&i.update(e),this.grammars.record(i),this._dataflow.add(i),i}},{key:"data",value:function(t){var e=new nN(this,t);return this.grammars.record(e),this._dataflow.add(e),e}},{key:"scale",value:function(t){var e=xj.createGrammar("scale",this,t);return e&&(this.grammars.record(e),this._dataflow.add(e)),e}},{key:"coordinate",value:function(t){var e=xj.createGrammar("coordinate",this,t);return e&&(this.grammars.record(e),this._dataflow.add(e)),e}},{key:"mark",value:function(t,e,i){var n,r=Y(e)?this.getMarkById(e):e;switch(t){case MH.group:n=new PN(this,r);break;case MH.glyph:var a=xj.getMark(MH.glyph);a&&(n=new a(this,null==i?void 0:i.glyphType,r));break;case MH.component:n=xj.hasComponent(null==i?void 0:i.componentType)?xj.createComponent(null==i?void 0:i.componentType,this,r,null==i?void 0:i.mode):new jN(this,null==i?void 0:i.componentType,r,null==i?void 0:i.mode);break;case MH.text:n=new IN(this,t,r);break;default:n=xj.hasMark(t)?xj.createMark(t,this,r):new EN(this,t,r)}return this.grammars.record(n),this._dataflow.add(n),n}},{key:"group",value:function(t){return this.mark(MH.group,t)}},{key:"glyph",value:function(t,e){return this.mark(MH.glyph,e,{glyphType:t})}},{key:"component",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"2d";return this.mark(MH.component,e,{componentType:t,mode:i})}},{key:"axis",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"2d";return this.mark(MH.component,t,{componentType:wH.axis,mode:e})}},{key:"grid",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"2d";return this.mark(MH.component,t,{componentType:wH.grid,mode:e})}},{key:"legend",value:function(t){return this.mark(MH.component,t,{componentType:wH.legend})}},{key:"slider",value:function(t){return this.mark(MH.component,t,{componentType:wH.slider})}},{key:"label",value:function(t){return this.mark(MH.component,t,{componentType:wH.label})}},{key:"datazoom",value:function(t){return this.mark(MH.component,t,{componentType:wH.datazoom})}},{key:"player",value:function(t){return this.mark(MH.component,t,{componentType:wH.player})}},{key:"title",value:function(t){return this.mark(MH.component,t,{componentType:wH.title})}},{key:"scrollbar",value:function(t){return this.mark(MH.component,t,{componentType:wH.scrollbar})}},{key:"customized",value:function(t,e){var i=xj.createGrammar(t,this,null==e?void 0:e.type);if(i)return i.parse(e),this.grammars.record(i),this._dataflow.add(i),i}},{key:"addGrammar",value:function(t){return this.grammars.find((function(e){return e.uid===t.uid}))||(this.grammars.record(t),this._dataflow.add(t),t.parse(t.getSpec()),this._needBuildLayoutTree=!0),this}},{key:"removeGrammar",value:function(t){var e=Y(t)?this.getGrammarById(t):t;return e&&this.grammars.find((function(t){return t.uid===e.uid}))?("mark"===e.grammarType&&e.prepareRelease(),this._cachedGrammars.record(e),this._dataflow.remove(e),this.grammars.unrecord(e),this._needBuildLayoutTree=!0,this):this}},{key:"removeAllGrammars",value:function(){var t=this;return this.grammars.traverse((function(e){"signal"===e.grammarType&&MN.includes(e.id())||"mark"===e.grammarType&&"root"===e.id()||t.removeGrammar(e)})),this}},{key:"removeAllGraphicItems",value:function(){return this.traverseMarkTree((function(t){t.graphicItem&&(Sj(t.graphicItem),t.elementMap.forEach((function(t){t.resetGraphicItem()})),t.graphicItem=null)})),this}},{key:"parseSpec",value:function(t){var e,i,n,r,a,o,s,l,u=this;if(this.emit(DH.BEFORE_PARSE_VIEW),this._spec=t,function(t){var e,i=function(t,e){var n,r;t.group=e;var a=null!==(n=t.id)&&void 0!==n?n:"VGRAMMAR_MARK_"+ ++AN;t.id=a,(null!==(r=t.marks)&&void 0!==r?r:[]).forEach((function(t){return i(t,a)}))};(null!==(e=t.marks)&&void 0!==e?e:[]).forEach((function(t){return i(t,"root")}))}(t),t.theme?this.theme(t.theme):this.theme(HN.getDefaultTheme()),t.width&&this.width(t.width),t.height&&this.height(t.height),this.padding(null!==(i=null!==(e=t.padding)&&void 0!==e?e:this._options.padding)&&void 0!==i?i:this._theme.padding),!this.width()||!this.height()){var c=this._getContainerSize();c&&(this.updateSignal(vN,c.width),this.updateSignal(gN,c.height))}(null===(n=t.signals)||void 0===n?void 0:n.length)&&t.signals.forEach((function(t){u.signal().parse(t)})),(null===(r=t.data)||void 0===r?void 0:r.length)&&t.data.forEach((function(t){u.data(null).parse(t)})),(null===(a=t.coordinates)||void 0===a?void 0:a.length)&&t.coordinates.forEach((function(t){var e;null===(e=u.coordinate(t.type))||void 0===e||e.parse(t)})),(null===(o=t.scales)||void 0===o?void 0:o.length)&&t.scales.forEach((function(t){var e;null===(e=u.scale(t.type))||void 0===e||e.parse(t)}));var h=xj.getGrammars();return Object.keys(h).forEach((function(e){var i=h[e].specKey;t[i]&&t[i].length&&t[i].forEach((function(t){u.customized(e,t)}))})),t.marks&&t.marks.length&&t.marks.forEach((function(t){u.parseMarkSpec(t)})),t.events&&t.events.length&&t.events.forEach((function(t){var e;null===(e=u.event)||void 0===e||e.call(u,t)})),t.interactions&&t.interactions.length&&t.interactions.forEach((function(t){u.interaction(t.type,t)})),!1===t.animation?null===(s=this.animate)||void 0===s||s.disable():null===(l=this.animate)||void 0===l||l.enable(),this.emit(DH.AFTER_PARSE_VIEW),this._needBuildLayoutTree=!0,this._layoutState=LH.before,this}},{key:"updateSpec",value:function(t){return this.removeAllInteractions(),this.removeAllGrammars(),this.parseSpec(t)}},{key:"parseBuiltIn",value:function(){var t=this;(function(t,e,i){var n,r,a,o,s;return[{id:vN,value:null!==(n=t[vN])&&void 0!==n?n:0},{id:gN,value:null!==(r=t[gN])&&void 0!==r?r:0},{id:_N,value:wN(null!==(o=null!==(a=t[_N])&&void 0!==a?a:e[_N])&&void 0!==o?o:null==i?void 0:i.padding)},{id:yN,update:{callback:function(t,e){var i=wN(e[_N]);return e[vN]-i.left-i.right},dependency:[vN,_N]}},{id:mN,update:{callback:function(t,e){var i=wN(e[_N]);return e[gN]-i.top-i.bottom},dependency:[gN,_N]}},{id:bN,update:{callback:function(t,e){var i=wN(e[_N]);return(t||new di).setValue(i.left,i.top,i.left+e[yN],i.top+e[mN])},dependency:[yN,mN,_N]}},{id:xN,value:null!==(s=t[xN])&&void 0!==s?s:e[xN]}]})(this._options,this._config,this.getCurrentTheme()).forEach((function(e){var i=t.signal().parse(e);e.value&&i.set(e.value)})),this.parseMarkSpec({id:"root",type:"group",encode:{enter:{x:0,y:0},update:{width:{signal:"width"},height:{signal:"height"}}}}),this.rootMark=this.getMarkById("root")}},{key:"parseMarkSpec",value:function(t){var e,i=this,n=t.type===MH.glyph?{glyphType:t.glyphType}:t.type===MH.component?{componentType:t.componentType,mode:t.mode}:null;this.mark(t.type,t.group,n).parse(t),null===(e=t.marks)||void 0===e||e.forEach((function(t){i.parseMarkSpec(t)}))}},{key:"theme",value:function(t){var e,i,n,r,a,o;Y(t)?this._theme=null!==(e=HN.getTheme(t))&&void 0!==e?e:HN.getDefaultTheme():this._theme=t;var s=null!==(i=this._spec)&&void 0!==i?i:{},l=s.background,u=s.padding;return this._theme?(this.background(null!==(n=null!=l?l:this._options.background)&&void 0!==n?n:this._theme.background),this.padding(null!==(r=null!=u?u:this._options.padding)&&void 0!==r?r:this._theme.padding),null===(o=null===(a=this.renderer.stage())||void 0===a?void 0:a.setTheme)||void 0===o||o.call(a,Object.assign({},this._theme.marks))):(this.background(null!=l?l:this._options.background),this.padding(null!=u?u:this._options.padding)),this}},{key:"getCurrentTheme",value:function(){return this._theme}},{key:"setCurrentTheme",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.theme(t),this.grammars.getAllMarks().forEach((function(t){t.commit()})),e?(this.evaluate(),this.renderer.render(!0)):this._dataflow.evaluate(),this}},{key:"background",value:function(t){return arguments.length?(this._background=t,this.renderer.background(t),t):this._background}},{key:"width",value:function(t){var e=this.getSignalById(vN);return arguments.length?(this._options.width=t,this.updateSignal(e,t),t):e.output()}},{key:"height",value:function(t){var e=this.getSignalById(gN);return arguments.length?(this._options.height=t,this.updateSignal(e,t),t):e.output()}},{key:"viewWidth",value:function(t){var e=this.getSignalById(yN);if(arguments.length){var i=this.padding();return this.width(t+i.left+i.right),t}return e.output()}},{key:"viewHeight",value:function(t){var e=this.getSignalById(mN);if(arguments.length){var i=this.padding();return this.height(t+i.top+i.bottom),t}return e.output()}},{key:"padding",value:function(t){var e=this.getSignalById(_N);if(arguments.length){var i=wN(t);return this.updateSignal(e,i),i}return wN(e.output())}},{key:"autoFit",value:function(t){var e=this.getSignalById(xN);return arguments.length?(this.updateSignal(e,t),t):e.output()}},{key:"getViewBox",value:function(){var t=this.getSignalById(bN);return null==t?void 0:t.output()}},{key:"updateLayoutTag",value:function(){return this._layoutState=LH.before,this}},{key:"getLayoutState",value:function(){return this._layoutState}},{key:"buildLayoutTree",value:function(){var t={},e=[];this.traverseMarkTree((function(i){t[i.id()]=!0,i.group&&t[i.group.id()]||e.push(i),i.markType===MH.group&&i.updateLayoutChildren()}),(function(t){return t.needLayout()})),this._layoutMarks=e}},{key:"doLayout",value:function(){var t,e=this._options.doLayout||xj.getDefaultLayout();e&&(null===(t=this._layoutMarks)||void 0===t?void 0:t.length)&&(this.emit(DH.BEFORE_DO_LAYOUT),e(this._layoutMarks,this._options,this),this.emit(DH.AFTER_DO_LAYOUT))}},{key:"handleLayoutEnd",value:function(){this.emit(DH.BEFORE_MARK_LAYOUT_END),this._layoutMarks.forEach((function(t){uN(t,"layoutChildren",(function(t){t.handleLayoutEnd()}),(function(e){return e!==t}))})),this.emit(DH.AFTER_MARK_LAYOUT_END)}},{key:"handleRenderEnd",value:function(){this.emit(DH.BEFORE_MARK_RENDER_END),uN(this.rootMark,"children",(function(t){t.handleRenderEnd()})),this.emit(DH.AFTER_MARK_RENDER_END)}},{key:"commit",value:function(t){return this._dataflow.commit(t),this}},{key:"run",value:function(t){return this.evaluate(t),this}},{key:"doRender",value:function(t){this.emit(DH.BEFORE_DO_RENDER),this.renderer&&(!this._progressiveMarks&&this.animate?this.animate.animate():this.traverseMarkTree((function(t){t.cleanExitElements()}),null,!0),this.renderer.render(t),this.handleRenderEnd()),this.emit(DH.AFTER_DO_RENDER)}},{key:"evaluate",value:function(t){var e,i,n=function(t){var e,i,n,r,a,o=null!=t?t:{},s=o.reuse,l=void 0===s||s,u=o.morph,c=void 0===u||u,h=o.morphAll,d=void 0!==h&&h,p=o.animation,f=void 0===p?{}:p,v=o.enableExitAnimation,g=void 0===v||v;return{reuse:l,morph:c,morphAll:d,animation:{easing:null!==(e=f.easing)&&void 0!==e?e:rj,delay:null!==(i=f.delay)&&void 0!==i?i:tj,duration:null!==(n=f.duration)&&void 0!==n?n:$H,oneByOne:null!==(r=f.oneByOne)&&void 0!==r?r:nj,splitPath:null!==(a=f.splitPath)&&void 0!==a?a:null},enableExitAnimation:g}}(t),r=this._cachedGrammars.size()>0;r&&(this.reuseCachedGrammars(n),this.detachCachedGrammar());var a=this._resizeRenderer(),o=this._dataflow.hasCommitted();return r||o||this._layoutState||a?(this.clearProgressive(),this._dataflow.evaluate(),this._needBuildLayoutTree&&(this.buildLayoutTree(),this._needBuildLayoutTree=!1),this._layoutState&&(this._layoutState=LH.layouting,this.doLayout(),this._dataflow.hasCommitted()&&(this._layoutState=LH.reevaluate,this._dataflow.evaluate()),this._layoutState=LH.after,(null===(e=this._layoutMarks)||void 0===e?void 0:e.length)&&this.handleLayoutEnd()),this._layoutState=null,this.findProgressiveMarks(),this._resizeRenderer(),null===(i=this.morph)||void 0===i||i.call(this,n),this.releaseCachedGrammars(n),this.doRender(!0),this.doPreProgressive(),this):this}},{key:"reuseCachedGrammars",value:function(t){var e=this;if(t.reuse){var i=function(t){t.next.reuse(t.prev),t.prev.detachAll(),t.prev.clear(),e._cachedGrammars.unrecord(t.prev)};this._differ.diffGrammar(this._cachedGrammars.getAllSignals(),this.grammars.getAllSignals().filter((function(t){return!MN.includes(t.id())}))).update.forEach(i),this._differ.diffGrammar(this._cachedGrammars.getAllData(),this.grammars.getAllData()).update.forEach(i),this._differ.diffGrammar(this._cachedGrammars.getAllScales(),this.grammars.getAllScales()).update.forEach(i),this._differ.diffGrammar(this._cachedGrammars.getAllCoordinates(),this.grammars.getAllCoordinates()).update.forEach(i)}this._differ.diffMark(this._cachedGrammars.getAllMarks(),this.grammars.getAllMarks().filter((function(t){return"root"!==t.id()})),t).update.forEach((function(i){var n,r=1===i.prev.length&&1===i.next.length&&i.prev[0].markType===i.next[0].markType,a=i.prev.every((function(t){return t.getMorphConfig().morph}))&&i.next.every((function(t){return t.getMorphConfig().morph}));e.morph&&(t.morph&&a||t.morphAll)?null===(n=e.addMorphMarks)||void 0===n||n.call(e,{prev:i.prev,next:i.next}):r&&t.reuse&&(i.next[0].reuse(i.prev[0]),i.prev[0].detachAll(),i.prev[0].clear(),e._cachedGrammars.unrecord(i.prev[0]))}))}},{key:"detachCachedGrammar",value:function(){this._cachedGrammars.traverse((function(t){var e,i;if(t.detachAll(),"mark"===t.grammarType){var n=t;null===(i=null===(e=n.group)||void 0===e?void 0:e.removeChild)||void 0===i||i.call(e,n)}}))}},{key:"releaseCachedGrammars",value:function(t){var e=this;this._cachedGrammars.traverse((function(t){"mark"!==t.grammarType&&t.release()}));var i=this._cachedGrammars.getAllMarkNodes();i.forEach((function(i){var n;null===(n=i.mark.animate)||void 0===n||n.stop(),t.enableExitAnimation&&e.animate&&e.animate.animateAddition(i.mark)}));var n=function(t){if(t.mark.view&&(!t.mark.animate||0===t.mark.animate.getAnimatorCount())&&(!t.children||0===t.children.length)){t.mark.release();var e=t.parent;e&&(t.parent.children=t.parent.children.filter((function(e){return e!==t})),t.parent=null,n(e))}};i.forEach((function(t){var e=t.mark;e.animate&&0!==e.animate.getAnimatorCount()?e.addEventListener("animationEnd",(function(){e.animate&&0===e.animate.getAnimatorCount()&&n(t)})):n(t)})),this._cachedGrammars.clear()}},{key:"runAfter",value:function(t){var e=this;return this._dataflow.runAfter((function(){t.call(null,e)})),this}},{key:"runBefore",value:function(t){var e=this;return this._dataflow.runBefore((function(){t.call(null,e)})),this}},{key:"getImageBuffer",value:function(){var t,e;if("node"===this._options.mode){var i=null===(e=null===(t=this.renderer)||void 0===t?void 0:t.stage)||void 0===e?void 0:e.call(t);return i?(i.render(),i.window.getImageBuffer()):(this.logger.error(new ReferenceError("render is not defined")),null)}this.logger.error(new TypeError("getImageBuffer() now only support node environment."))}},{key:"traverseMarkTree",value:function(t,e,i){return uN(this.rootMark,"children",t,e,i),this}},{key:"_bindResizeEvent",value:function(){var t,e,i,n,r,a;if(this.autoFit()){var o=null===(r=null===(n=null===(i=null===(e=null===(t=this.renderer)||void 0===t?void 0:t.stage)||void 0===e?void 0:e.call(t))||void 0===i?void 0:i.window)||void 0===n?void 0:n.getContainer)||void 0===r?void 0:r.call(n);if(o){var s=window.ResizeObserver;this._observer=new s(this._onResize),null===(a=this._observer)||void 0===a||a.observe(o)}window.addEventListener("resize",this._onResize)}}},{key:"_unBindResizeEvent",value:function(){this.autoFit()&&(window.removeEventListener("resize",this._onResize),this._observer&&(this._observer.disconnect(),this._observer=null))}},{key:"_getContainerSize",value:function(){var t,e,i,n,r,a,o,s,l,u,c,h=null===(r=null===(n=null===(i=null===(e=null===(t=this.renderer)||void 0===t?void 0:t.stage)||void 0===e?void 0:e.call(t))||void 0===i?void 0:i.window)||void 0===n?void 0:n.getContainer)||void 0===r?void 0:r.call(n);if(h){var d=Pi(h),p=d.width,f=d.height;return{width:null!==(s=null!==(o=null===(a=this._spec)||void 0===a?void 0:a.width)&&void 0!==o?o:this._options.width)&&void 0!==s?s:p,height:null!==(c=null!==(u=null===(l=this._spec)||void 0===l?void 0:l.height)&&void 0!==u?u:this._options.height)&&void 0!==c?c:f}}return null}},{key:"resize",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=!1;return t!==this.width()&&(n=!0,this.updateSignal(vN,t)),e!==this.height()&&(n=!0,this.updateSignal(gN,e)),n&&(i?this.evaluate({morph:!1}):this._dataflow.evaluate()),this}},{key:"_resizeRenderer",value:function(){var t=this.width(),e=this.height();return!!this.renderer.shouldResize(t,e)&&(this.renderer.resize(t,e),this.emit("resize",{},{width:t,height:e}),!0)}},{key:"interaction",value:function(t,e){var i=xj.createInteraction(t,this,e);return i&&(i.bind(),this._boundInteractions||(this._boundInteractions=[]),this._boundInteractions.push(i)),i}},{key:"removeInteraction",value:function(t,e){if(this._boundInteractions){var i=this._boundInteractions.filter((function(i){var n;return j(e)?Y(t)?i.type===t:t?i===t:void 0:(null===(n=i.options)||void 0===n?void 0:n.id)===e}));i.length&&i.forEach((function(t){t.unbind()}))}return this}},{key:"removeAllInteractions",value:function(){return this._boundInteractions&&(this._boundInteractions.forEach((function(t){t.unbind()})),this._boundInteractions=null),this}},{key:"initializeEventConfig",value:function(t){var e=Object.assign({defaults:{}},t),i=function(t,e){e.forEach((function(e){X(t[e])&&(t[e]=t[e].reduce((function(t,e){return t[e]=!0,t}),{}))}))};return i(e.defaults,["prevent","allow"]),i(e,[fN,pN]),e}},{key:"initEvent",value:function(){var t=this.renderer.stage();t&&t.on("*",this.delegateEvent)}},{key:"releaseStageEvent",value:function(){var t=this.renderer.stage();t&&t.off("*",this.delegateEvent)}},{key:"addEventListener",value:function(t,e,i){var n=e;return i&&!1===i.trap||((n=e).raw=e),i&&i.target&&(n.target=i.target),this.on(t,n),this}},{key:"removeEventListener",value:function(t,e){return e?this.off(t,e):this.off(t),this}},{key:"initializeRenderer",value:function(){var t=this._options.width,e=this._options.height;this.renderer=new cN(this),this.renderer.initialize(t,e,this._options,this._eventConfig).background(this._background)}},{key:"initialize",value:function(){var t,e,i,n=this;this.grammars=new RN((function(t){return t.id()}),(function(t,e){return n.logger.warn("Grammar id '".concat(t,"' has been occupied"),e)})),this._cachedGrammars=new BN((function(t){return t.id()})),this._options.logger&&Lt.setInstance(this._options.logger),this.logger=Lt.getInstance(null!==(t=this._options.logLevel)&&void 0!==t?t:0),this._dataflow=new lN,this.animate=null===(e=this.initAnimate)||void 0===e?void 0:e.call(this,this),this._differ=new VN,this._options.hooks&&(Object.keys(this._options.hooks).forEach((function(t){n.on(t,n._options.hooks[t])})),this.hooks=this._options.hooks),this.container=null,this.renderer=null,this._eventListeners=[],this._eventConfig=this.initializeEventConfig(this._options.eventConfig),this._theme=this._options.disableTheme?null:HN.getDefaultTheme(),this.parseBuiltIn(),(i=this._options).mode&&ex.setEnv(i.mode,i.modeParams||{}),this.initializeRenderer(),this._eventConfig.disable||this.initEvent(),this._bindResizeEvent(),this._needBuildLayoutTree=!0,this._layoutState=LH.before,this.theme(this._theme)}},{key:"pauseProgressive",value:function(){return!1}},{key:"resumeProgressive",value:function(){return!1}},{key:"restartProgressive",value:function(){return!1}},{key:"findProgressiveMarks",value:function(){var t=[];return this.traverseMarkTree((function(e){t.push(e)}),(function(t){return t.markType!==MH.group&&t.isProgressive()})),t.length?(this._progressiveMarks=t,this.renderer&&this.renderer.combineIncrementalLayers(),t):(this._progressiveMarks=null,null)}},{key:"doPreProgressive",value:function(){if(this._progressiveMarks&&this._progressiveMarks.some((function(t){return t.isDoingProgressive()}))){var t=ex.getRequestAnimationFrame();this._progressiveRafId=t(this.handleProgressiveFrame)}else this._progressiveMarks&&this.animate&&this._progressiveMarks.every((function(t){return t.canAnimateAfterProgressive()}))?this.animate.animate():this._progressiveMarks&&(this._progressiveMarks=null)}},{key:"clearProgressive",value:function(){this._progressiveRafId&&ex.getCancelAnimationFrame()(this._progressiveRafId),this._progressiveMarks&&this._progressiveMarks.length&&(this._progressiveMarks.forEach((function(t){t.clearProgressive()})),this._progressiveMarks=null)}},{key:"release",value:function(){var t,e,i,n;this.removeAllInteractions(),this.releaseStageEvent(),this._unBindResizeEvent(),this.clearProgressive(),xj.unregisterRuntimeTransforms(),Lt.setInstance(null),null===(t=this.animate)||void 0===t||t.stop(),this.grammars.release(),this._cachedGrammars.release(),this._dataflow.release(),this._dataflow=null,null===(i=null===(e=this.renderer)||void 0===e?void 0:e.release)||void 0===i||i.call(e),this.renderer=null,this._boundInteractions=null,this.removeAllListeners(),null===(n=this._eventListeners)||void 0===n||n.forEach((function(t){t.source.removeEventListener(t.type,t.handler)})),this._eventListeners=null}}],[{key:"useRegisters",value:function(t){t.forEach((function(t){t()}))}}])}(O),GN=function(t,e,i,n,r){var a,o,s={prev:t.map((function(t){return t.getDatum()})),next:e.map((function(t){return t.getDatum()}))},l={prev:t.slice(),next:e.slice()},u=i.animation.easing,c=cj(i.animation.delay,r,s,l),h=cj(i.animation.duration,r,s,l),d=cj(i.animation.oneByOne,r,s,l),p=cj(i.animation.splitPath,r,s,l),f=Q(d)&&d>0?function(t){return Z(d)?t*d:!0===d?t*h:0}:void 0;1!==t.length&&0!==t.length||1!==e.length?1===t.length&&e.length>1?function(t,e,i){var n,r=e.filter((function(t){return t&&t.toCustomPath&&t.valid}));r.length||__DEV__&&console.error(r," is not validate"),t.valid&&t.toCustomPath||__DEV__&&console.error(t," is not validate");var a=("clone"===(null==i?void 0:i.splitPath)?rp:null!==(n=null==i?void 0:i.splitPath)&&void 0!==n?n:ap)(t,r.length,!1),o=null==i?void 0:i.onEnd,s=r.length,l=function(){0==--s&&o&&o()};r.forEach((function(e,n){var o,s=a[n],u=(null!==(o=null==i?void 0:i.delay)&&void 0!==o?o:0)+((null==i?void 0:i.individualDelay)?i.individualDelay(n,r.length,s,e):0);tp(s,e,Object.assign({},i,{onEnd:l,delay:u}),t.globalTransMatrix)}))}(t[0].getGraphicItem(),e.map((function(t){return t.getGraphicItem()})),{delay:c,duration:h,easing:u,onEnd:n,individualDelay:f,splitPath:p}):t.length>1&&1===e.length&&function(t,e,i){var n,r,a,o=t.filter((function(t){return t.toCustomPath&&t.valid}));o.length||__DEV__&&console.error(t," is not validate"),e.valid&&e.toCustomPath||__DEV__&&console.error(e," is not validate");var s=("clone"===(null==i?void 0:i.splitPath)?rp:null!==(n=null==i?void 0:i.splitPath)&&void 0!==n?n:ap)(e,o.length,!0),l=e.attribute;e.setAttribute("visible",!1);var u=o.map((function(t,e){return Zd(t.toCustomPath(),s[e].toCustomPath(),{fromTransform:t.globalTransMatrix,toTransfrom:s[e].globalTransMatrix})})),c=o.map((function(t,e){return Qd(t.attribute,l)}));if(null==i?void 0:i.individualDelay){var h=i.onEnd,d=o.length,p=function(){0==--d&&(e.setAttributes({visible:!0,ratio:null},!1,{type:Al.ANIMATE_END}),e.detachShadow(),h&&h())};s.forEach((function(e,n){var r,a,s,l=(null!==(r=i.delay)&&void 0!==r?r:0)+i.individualDelay(n,o.length,t[n],e),h=e.animate(Object.assign({},i,{onEnd:p}));h.wait(l),h.play(new $d({morphingData:u[n],saveOnEnd:!0,otherAttrs:c[n]},null!==(a=i.duration)&&void 0!==a?a:td,null!==(s=i.easing)&&void 0!==s?s:ed))}))}else{var f=null==i?void 0:i.onEnd,v=i?Object.assign({},i):{};v.onEnd=function(){e.setAttribute("visible",!0,!1,{type:Al.ANIMATE_END}),e.detachShadow(),f&&f()};var g=e.animate(v);(null==i?void 0:i.delay)&&g.wait(i.delay),g.play(new ep({morphingData:u,otherAttrs:c},null!==(r=null==i?void 0:i.duration)&&void 0!==r?r:td,null!==(a=null==i?void 0:i.easing)&&void 0!==a?a:ed))}}(t.map((function(t){return t.getGraphicItem()})),e[0].getGraphicItem(),{delay:c,duration:h,easing:u,onEnd:n,individualDelay:f,splitPath:p}):tp(null===(o=null===(a=t[0])||void 0===a?void 0:a.getGraphicItem)||void 0===o?void 0:o.call(a),e[0].getGraphicItem(),{delay:c,duration:h,easing:u,onEnd:n})},UN=function(t,e){var i=Math.floor(t.length/e);return new Array(e).fill(0).map((function(n,r){return t.slice(i*r,r===e-1?t.length:i*(r+1))}))},YN=function(t){var e=t.getMorphConfig();if(!j(e.morphElementKey)){var i=pj(e.morphElementKey);t.elements&&t.elements.forEach((function(t){t.morphKey=i(t.getDatum())}))}},XN=function(t,e,i){var n=function(t,e,i){var n={enter:[],exit:[],update:[]},r=new CN(t,i);return r.setCallback((function(t,e,i){j(e)?n.exit.push({prev:i}):j(i)?n.enter.push({next:e}):n.update.push({next:e,prev:i})})),r.setCurrentData(TN(e,i)),r.doDiff(),n}(t.reduce((function(t,e){return YN(e),t.concat(e.elements)}),[]),e.reduce((function(t,e){return YN(e),t.concat(e.elements)}),[]),(function(t){var e;return null!==(e=t.morphKey)&&void 0!==e?e:t.key}));t.forEach((function(t){var e,i;return null===(i=null===(e=t.animate)||void 0===e?void 0:e.disable)||void 0===i?void 0:i.call(e)})),e.forEach((function(t){var e,i;return null===(i=null===(e=t.animate)||void 0===e?void 0:e.disable)||void 0===i?void 0:i.call(e)}));var r=t.concat(e).reduce((function(t,e){return Object.assign(t,e.parameters()),t}),{}),a=0,o=function(){0===(a-=1)&&e.forEach((function(t){var e,i;null===(i=null===(e=t.animate)||void 0===e?void 0:e.enable)||void 0===i||i.call(e)}))};n.enter.forEach((function(t){t.next.forEach((function(t){GN([],[t],i,o,r)})),a+=1})),n.update.forEach((function(t){for(var e=Math.min(t.prev.length,t.next.length),n=UN(t.prev,e),s=UN(t.next,e),l=0;l<e;l++)GN(n[l],s[l],i,o,r),a+=1}))},KN=function(){return o((function t(){r(this,t)}),[{key:"morph",value:function(t){var e;null===(e=this._willMorphMarks)||void 0===e||e.forEach((function(e){XN(e.prev,e.next,t)})),this._willMorphMarks=null}},{key:"addMorphMarks",value:function(t){this._willMorphMarks||(this._willMorphMarks=[]),this._willMorphMarks.push(t)}}])}(),qN=function(){CP(),tP(),xj.registerGraphic(MH.arc,by),wL("arc",zL)},ZN=function(){CP(),rP(),xj.registerGraphic(MH.area,yy),DL(),PL()},JN=function(){CP(),gP(),xj.registerGraphic(MH.path,fy)},QN=function(){CP(),kP(),wL("rect",BL),xj.registerGraphic(MH.rect,Xg)},$N=function(){CP(),fP(),xj.registerGraphic(MH.rule,Gg)},tV=function(){CP(),PP(),PL(),xj.registerGraphic(MH.symbol,Ng)},eV=function(){CP(),BP(),wP(),xj.registerGraphic(MH.text,zg)},iV=function(){CP(),lP(),xj.registerGraphic(MH.glyph,Qg)},nV=function(t){function e(t){var a;return r(this,e),(a=n(this,e,[t])).getStateAttrs=function(t,e){var n,r,o,s,u=!j(null===(n=a.runtimeStatesEncoder)||void 0===n?void 0:n[t]),c=u?Object.assign(Object.assign({},null===(r=a.mark.getSpec().encode)||void 0===r?void 0:r[t]),a.runtimeStatesEncoder[t]):null===(o=a.mark.getSpec().encode)||void 0===o?void 0:o[t],h={};if(!c)return h;if(H(c))return h.attributes=c(a.getDatum(),i(a),t,e),h;if(!u&&(null===(s=a.graphicItem.glyphStates)||void 0===s?void 0:s[t]))return a.graphicItem.glyphStates[t];if(c){var d=a.items[0],p=[Object.assign({},d,{nextAttrs:{}})];return mj(i(a),p,c,a.mark.parameters()),a.coordinateTransformEncode(p),h.attributes=p[0].nextAttrs,a.graphicItem.glyphStates?a.graphicItem.glyphStates[t]||(a.graphicItem.glyphStates[t]=h):a.graphicItem.glyphStates=l({},t,h),h}return h},a.glyphMeta=a.mark.getGlyphMeta(),a}return h(e,t),o(e,[{key:"getGlyphGraphicItems",value:function(){return this.glyphGraphicItems}},{key:"initGraphicItem",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.graphicItem){this.graphicItem=this.mark.addGraphicItem(e,this.groupKey),this.graphicItem[UH]=this,this.graphicItem.onBeforeAttributeUpdate=this._onGlyphAttributeUpdate(!1);var i=this.glyphMeta.getMarks();this.glyphGraphicItems={},this.graphicItem.getSubGraphic().forEach((function(e){var n=i[e.name];t.glyphGraphicItems[e.name]=e,e.onBeforeAttributeUpdate=function(i){return t.mark?Tj(n,i,t,e.name):i}})),this.clearGraphicAttributes()}}},{key:"useStates",value:function(t,e){if(!this.graphicItem)return!1;this.mark.emit(DH.BEFORE_ELEMENT_STATE,{states:t},this),this.states=t.slice();var i=z(e)?e:this.hasStateAnimation();return this.graphicItem.glyphStateProxy=this.getStateAttrs,this.graphicItem.useStates(this.states,i),this.mark.emit(DH.AFTER_ELEMENT_STATE,{states:t},this),!0}},{key:"encodeGraphic",value:function(){this.coordinateTransformEncode(this.items);var t=this.transformElementItems(this.items,this.mark.markType),e=!this.graphicItem;this.graphicItem?(this.graphicItem.clearStates(),this.graphicItem.states={},this.graphicItem.stateProxy=null):this.initGraphicItem(),this.diffState===AH.enter||e?(this.graphicItem.onBeforeAttributeUpdate=this._onGlyphAttributeUpdate(!0),this.applyGraphicAttributes(t),this.graphicItem.onBeforeAttributeUpdate=this._onGlyphAttributeUpdate(!1)):this.applyGraphicAttributes(t),this.diffState!==AH.enter&&this.diffState!==AH.update||!this.states.length||(Object.values(this.glyphGraphicItems).forEach((function(t){t.states={}})),this.useStates(this.states)),this.items.map((function(t){t.nextAttrs={}}))}},{key:"encodeCustom",value:function(t){var e,i,n=this,r={},a=this.glyphMeta.getChannelEncoder(),o=this.glyphMeta.getFunctionEncoder();(o&&(r=o.call(null,Object.assign({},null===(e=this.graphicItem)||void 0===e?void 0:e.attribute,t),this.getDatum(),this,this.mark.getGlyphConfig())),a)&&Object.keys(a).forEach((function(e){var o;if(!j(t[e])){i||(i=Object.assign({},null===(o=n.graphicItem)||void 0===o?void 0:o.attribute,t));var s=a[e].call(null,e,t[e],i,n.getDatum(),n,n.mark.getGlyphConfig());Object.keys(null!=s?s:{}).forEach((function(t){var e;r[t]=Object.assign(null!==(e=r[t])&&void 0!==e?e:{},s[t])}))}}));return r}},{key:"encodeDefault",value:function(){var t={};if(this.glyphMeta.getDefaultEncoder()){var e=this.glyphMeta.getDefaultEncoder().call(null,this.getDatum(),this,this.mark.getGlyphConfig());Object.assign(t,e)}return t}},{key:"_onGlyphAttributeUpdate",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(i){if(!t.mark)return i;var n=t.glyphMeta.getMarks(),r=Tj(t.mark.getAttributeTransforms(),i,t),a=e?t.encodeDefault():null,o=t.encodeCustom(i);return Object.keys(n).forEach((function(r){var s=n[r],l=t.glyphGraphicItems[r],u=null==o?void 0:o[r],c=Object.assign({},u);if(e){var h=null==a?void 0:a[r];Object.keys(null!=h?h:{}).forEach((function(e){ut(t.items[0].nextAttrs,e)||ut(c,e)||(c[e]=h[e])}))}var d=Object.assign({},function(t,e){var i;return(null!==(i=wj[t])&&void 0!==i?i:[]).reduce((function(t,i){return i.channels.forEach((function(i){ut(e,i)&&(t[i]=e[i])})),t}),{})}(s,i),c),p=t._generateGlyphItems(s,t.items,d);t.coordinateTransformEncode(p);var f=t.transformElementItems(p,s);t.applyGlyphGraphicAttributes(f,r,l),s===MH.shape&&(l.datum=p[0].datum)})),r}}},{key:"_generateGlyphItems",value:function(t,e,i){var n=e.map((function(t){return Object.assign({},t,{nextAttrs:i})}));return YH.includes(t)&&this.mark.getSpec().enableSegments&&n.forEach((function(t,n){t.nextAttrs=Object.assign({},e[n].nextAttrs,i)})),n}},{key:"getGraphicAttribute",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0;if(this.graphicItem){var n=this.getPrevGraphicAttributes(i);return e&&ut(n,t)?n[t]:(i?this.glyphGraphicItems[i]:this.graphicItem).attribute[t]}}},{key:"setGraphicAttribute",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3?arguments[3]:void 0;if(this.graphicItem){var r=n?this.glyphGraphicItems[n]:this.graphicItem,a=this.getFinalGraphicAttributes(n),o=this.getPrevGraphicAttributes(n);i&&(a[t]=e),ut(o,t)||(o[t]=r.attribute[t]),r.setAttribute(t,e)}}},{key:"setGraphicAttributes",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2?arguments[2]:void 0;if(this.graphicItem){var n=i?this.glyphGraphicItems[i]:this.graphicItem,r=this.getFinalGraphicAttributes(i),a=this.getPrevGraphicAttributes(i);Object.keys(t).forEach((function(i){e&&(r[i]=t[i]),ut(a,i)||(a[i]=n.attribute[i])})),n.setAttributes(t)}}},{key:"diffAttributes",value:function(t,e){var i={},n=this.getFinalGraphicAttributes(e);for(var r in t)ut(n,r)&&mt(n[r],t[r])||(i[r]=t[r]);return i}},{key:"applyGlyphGraphicAttributes",value:function(t,e,i){var n,r;if(this.mark.needAnimate()){var a=this.diffAttributes(t,e),o=null!==(n=this.getPrevGraphicAttributes(e))&&void 0!==n?n:{},s=null!==(r=this.getFinalGraphicAttributes(e))&&void 0!==r?r:{};Object.keys(a).forEach((function(t){o[t]=i.attribute[t],s[t]=a[t]})),this.setNextGraphicAttributes(a,e),this.setPrevGraphicAttributes(o,e),this.setFinalGraphicAttributes(s,e),i.setAttributes(a)}else i.setAttributes(t)}},{key:"getFinalGraphicAttributes",value:function(t){return(t?this.glyphGraphicItems[t]:this.graphicItem).finalAttrs}},{key:"setFinalGraphicAttributes",value:function(t,e){(e?this.glyphGraphicItems[e]:this.graphicItem).finalAttrs=t}},{key:"getPrevGraphicAttributes",value:function(t){return(t?this.glyphGraphicItems[t]:this.graphicItem).prevAttrs}},{key:"setPrevGraphicAttributes",value:function(t,e){(e?this.glyphGraphicItems[e]:this.graphicItem).prevAttrs=t}},{key:"getNextGraphicAttributes",value:function(t){return(t?this.glyphGraphicItems[t]:this.graphicItem).nextAttrs}},{key:"setNextGraphicAttributes",value:function(t,e){(e?this.glyphGraphicItems[e]:this.graphicItem).nextAttrs=t}},{key:"clearChangedGraphicAttributes",value:function(){var t=this;this.setPrevGraphicAttributes(null),this.setNextGraphicAttributes(null),Object.keys(this.glyphGraphicItems).forEach((function(e){t.setPrevGraphicAttributes(null,e),t.setNextGraphicAttributes(null,e)}))}},{key:"clearGraphicAttributes",value:function(){var t=this;this.setPrevGraphicAttributes(null),this.setNextGraphicAttributes(null),this.setFinalGraphicAttributes(null),Object.keys(this.glyphGraphicItems).forEach((function(e){t.setPrevGraphicAttributes(null,e),t.setNextGraphicAttributes(null,e),t.setFinalGraphicAttributes(null,e)}))}},{key:"remove",value:function(){this.glyphGraphicItems=null,y(e,"remove",this,3)([])}},{key:"release",value:function(){this.glyphGraphicItems&&(Object.values(this.glyphGraphicItems).forEach((function(t){t[UH]=null})),this.glyphGraphicItems=null),y(e,"release",this,3)([])}}])}(Ij),rV=function(t){function e(t,i,a){var o;return r(this,e),(o=n(this,e,[t,MH.glyph,a])).glyphType=i,o.glyphMeta=xj.getGlyph(i),o}return h(e,t),o(e,[{key:"configureGlyph",value:function(t){return this.spec.glyphConfig=t,this.commit(),this}},{key:"getGlyphMeta",value:function(){return this.glyphMeta}},{key:"getGlyphConfig",value:function(){return this.spec.glyphConfig}},{key:"addGraphicItem",value:function(t,i){var n=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(xj.getGraphicType(MH.glyph)){var n=xj.createGraphic(MH.glyph,i),r=e.getMarks(),a=Object.keys(r).map((function(t){if(xj.getGraphicType(r[t])){var e=xj.createGraphic(r[t]);if(e)return e.name=t,e}}));return n.setSubGraphic(a),n}}(this,this.glyphMeta,t);return y(e,"addGraphicItem",this,3)([t,i,n])}},{key:"createElement",value:function(){return new nV(this)}}])}(EN);rV.markType=MH.glyph;var aV=function(){xj.registerMark(MH.glyph,rV)},oV=function(t){return function(e,i,n){var r,a,o,s=null!==(o=null!==(r=e.getGraphicAttribute("direction",!1))&&void 0!==r?r:null===(a=e.mark.getGlyphConfig())||void 0===a?void 0:a.direction)&&void 0!==o?o:"vertical",l=t(e,s,i);if(!Q(l))return{};var u=e.getGraphicAttribute("x",!1),c=e.getGraphicAttribute("y",!1),h=e.getGraphicAttribute("min",!1),d=e.getGraphicAttribute("max",!1),p=e.getGraphicAttribute("q1",!1),f=e.getGraphicAttribute("q3",!1),v=e.getGraphicAttribute("median",!1),g={from:{x:u,y:c},to:{x:u,y:c}};return Q(h)&&(g.from.min=l,g.to.min=h),Q(d)&&(g.from.max=l,g.to.max=d),Q(p)&&(g.from.q1=l,g.to.q1=p),Q(f)&&(g.from.q3=l,g.to.q3=f),Q(v)&&(g.from.median=l,g.to.median=v),g}},sV=function(t){return function(e,i,n){var r,a,o,s=null!==(o=null!==(r=e.getGraphicAttribute("direction",!1))&&void 0!==r?r:null===(a=e.mark.getGlyphConfig())||void 0===a?void 0:a.direction)&&void 0!==o?o:"vertical",l=t(e,s,i);if(!Q(l))return{};var u=e.getGraphicAttribute("x",!0),c=e.getGraphicAttribute("y",!0),h=e.getGraphicAttribute("min",!0),d=e.getGraphicAttribute("max",!0),p=e.getGraphicAttribute("q1",!0),f=e.getGraphicAttribute("q3",!0),v=e.getGraphicAttribute("median",!0),g={from:{x:u,y:c},to:{x:u,y:c}};return Q(h)&&(g.to.min=l,g.from.min=h),Q(d)&&(g.to.max=l,g.from.max=d),Q(p)&&(g.to.q1=l,g.from.q1=p),Q(f)&&(g.to.q3=l,g.from.q3=f),Q(v)&&(g.to.median=l,g.from.median=v),g}},lV=function(t,e,i){var n,r,a,o,s,l,u,c,h,d,p,f,v,g,y,m,_;if(i&&Q(i.center))return i.center;if(rS(e)){v=null===(r=null===(n=t.getGraphicAttribute("points",!1,"median"))||void 0===n?void 0:n[0])||void 0===r?void 0:r.x,g=null===(o=null===(a=t.getGraphicAttribute("points",!1,"max"))||void 0===a?void 0:a[0])||void 0===o?void 0:o.x,y=null===(l=null===(s=t.getGraphicAttribute("points",!1,"min"))||void 0===s?void 0:s[0])||void 0===l?void 0:l.x;var b=t.getGraphicAttribute("width",!1,"box"),x=t.getGraphicAttribute("x",!1,"box");m=x,_=x+b}else{v=null===(c=null===(u=t.getGraphicAttribute("points",!1,"median"))||void 0===u?void 0:u[0])||void 0===c?void 0:c.y,g=null===(d=null===(h=t.getGraphicAttribute("points",!1,"max"))||void 0===h?void 0:h[0])||void 0===d?void 0:d.y,y=null===(f=null===(p=t.getGraphicAttribute("points",!1,"min"))||void 0===p?void 0:p[0])||void 0===f?void 0:f.y;var k=t.getGraphicAttribute("height",!1,"box"),S=t.getGraphicAttribute("y",!1,"box");m=S,_=S+k}return Q(v)?v:Q(m)&&Q(_)?(m+_)/2:Q(g)&&Q(y)?(g+y)/2:Q(y)?y:Q(g)?g:NaN},uV=function(t,e,i,n){var r,a,o,s,l,u,c,h,d={shaft:{},box:{},max:{},min:{},median:{}},p=null!==(r=t.x)&&void 0!==r?r:i.getGraphicAttribute("x",!1),f=null!==(a=t.y)&&void 0!==a?a:i.getGraphicAttribute("y",!1),v=null!==(o=t.width)&&void 0!==o?o:i.getGraphicAttribute("width",!1),g=null!==(s=t.height)&&void 0!==s?s:i.getGraphicAttribute("height",!1),y=null!==(l=t.boxWidth)&&void 0!==l?l:i.getGraphicAttribute("boxWidth",!1),m=null!==(u=t.boxHeight)&&void 0!==u?u:i.getGraphicAttribute("boxHeight",!1),_=null!==(c=t.ruleWidth)&&void 0!==c?c:i.getGraphicAttribute("ruleWidth",!1),b=null!==(h=t.ruleHeight)&&void 0!==h?h:i.getGraphicAttribute("ruleHeight",!1);return n&&rS(n.direction)?(Q(m)?(Object.assign(d.box,{y:f-m/2,y1:f+m/2}),Object.assign(d.median,{y:f-m/2,y1:f+m/2})):(Object.assign(d.box,{y:f-g/2,y1:f+g/2}),Object.assign(d.median,{y:f-g/2,y1:f+g/2})),Q(b)?(Object.assign(d.max,{y:f-b/2,y1:f+b/2}),Object.assign(d.min,{y:f-b/2,y1:f+b/2})):(Object.assign(d.max,{y:f-g/2,y1:f+g/2}),Object.assign(d.min,{y:f-g/2,y1:f+g/2}))):(Q(y)?(Object.assign(d.box,{x:p-y/2,x1:p+y/2}),Object.assign(d.median,{x:p-y/2,x1:p+y/2})):(Object.assign(d.box,{x:p-v/2,x1:p+v/2}),Object.assign(d.median,{x:p-v/2,x1:p+v/2})),Q(_)?(Object.assign(d.max,{x:p-_/2,x1:p+_/2}),Object.assign(d.min,{x:p-_/2,x1:p+_/2})):(Object.assign(d.max,{x:p-v/2,x1:p+v/2}),Object.assign(d.min,{x:p-v/2,x1:p+v/2}))),d},cV=oV(lV),hV=sV(lV);var dV=function(t,e,i){var n,r,a,o,s,l,u,c,h;if(Q(null==i?void 0:i.center))return i.center;if(rS(e)){s=null===(r=null===(n=t.getGraphicAttribute("points",!1,"median"))||void 0===n?void 0:n[0])||void 0===r?void 0:r.x;var d=t.getGraphicAttribute("width",!1,"minMaxBox"),p=t.getGraphicAttribute("x",!1,"minMaxBox");u=p,l=p+d;var f=t.getGraphicAttribute("width",!1,"q1q3Box"),v=t.getGraphicAttribute("x",!1,"q1q3Box");c=v,h=v+f}else{s=null===(o=null===(a=t.getGraphicAttribute("points",!1,"median"))||void 0===a?void 0:a[0])||void 0===o?void 0:o.y;var g=t.getGraphicAttribute("height",!1,"minMaxBox"),y=t.getGraphicAttribute("y",!1,"minMaxBox");u=y,l=y+g;var m=t.getGraphicAttribute("height",!1,"q1q3Box"),_=t.getGraphicAttribute("y",!1,"q1q3Box");c=_,h=_+m}return Q(s)?s:Q(c)&&Q(h)?(c+h)/2:Q(l)&&Q(u)?(l+u)/2:Q(u)?u:Q(l)?l:NaN},pV=function(t,e,i,n){var r,a,o,s,l,u,c,h,d={minMaxBox:{},q1q3Box:{},median:{}},p=null!==(r=t.x)&&void 0!==r?r:i.getGraphicAttribute("x",!1),f=null!==(a=t.y)&&void 0!==a?a:i.getGraphicAttribute("y",!1),v=null!==(o=t.width)&&void 0!==o?o:i.getGraphicAttribute("width",!1),g=null!==(s=t.minMaxWidth)&&void 0!==s?s:i.getGraphicAttribute("minMaxWidth",!1),y=null!==(l=t.q1q3Width)&&void 0!==l?l:i.getGraphicAttribute("q1q3Width",!1),m=null!==(u=t.height)&&void 0!==u?u:i.getGraphicAttribute("height",!1),_=null!==(c=t.minMaxHeight)&&void 0!==c?c:i.getGraphicAttribute("minMaxHeight",!1),b=null!==(h=t.q1q3Height)&&void 0!==h?h:i.getGraphicAttribute("q1q3Height",!1);return n&&rS(n.direction)?(Q(_)?Object.assign(d.minMaxBox,{y:f-_/2,y1:f+_/2}):Object.assign(d.minMaxBox,{y:f-m/2,y1:f+m/2}),Q(b)?(Object.assign(d.q1q3Box,{y:f-b/2,y1:f+b/2}),Object.assign(d.median,{y:f-b/2,y1:f+b/2})):(Object.assign(d.q1q3Box,{y:f-m/2,y1:f+m/2}),Object.assign(d.median,{y:f-m/2,y1:f+m/2}))):(Q(g)?Object.assign(d.minMaxBox,{x:p-g/2,x1:p+g/2}):Object.assign(d.minMaxBox,{x:p-v/2,x1:p+v/2}),Q(y)?(Object.assign(d.q1q3Box,{x:p-y/2,x1:p+y/2}),Object.assign(d.median,{x:p-y/2,x1:p+y/2})):(Object.assign(d.q1q3Box,{x:p-v/2,x1:p+v/2}),Object.assign(d.median,{x:p-v/2,x1:p+v/2}))),d},fV=oV(dV),vV=sV(dV);var gV=function(t,e){var i,n=null!==(i=t.curvature)&&void 0!==i?i:.5,r="number"==typeof e?t.thickness*e:t.thickness,a=t.x0,o=t.x1,s=t.y0,l=t.y1,u=a+n*(o-a),c=o+n*(a-o),h=function(t){return t};!1!==t.round&&(a=Math.round(a),o=Math.round(o),s=Math.round(s),l=Math.round(l),u=Math.round(u),c=Math.round(c),h=Math.round),"line"===t.pathType||t.pathType,"center"===t.align?(s=h(t.y0-r/2),l=h(t.y1-r/2)):"end"===t.align?(s=h(t.y0+t.thickness/2-r),l=h(t.y1+t.thickness/2-r)):(s=h(t.y0-t.thickness/2),l=h(t.y1-t.thickness/2));var d=h(s+r),p=h(l+r),f=Math.abs(o-a)>1e-6,v=t.endArrow&&f?"L".concat(o,",").concat(h(l-r/2),"L").concat(h(o+r),",").concat(h((l+p)/2),"L").concat(o,",").concat(h(p+r/2)):"",g=t.startArrow&&f?"L".concat(a,",").concat(h(d+r/2),"L").concat(h(a-r),",").concat(h((s+d)/2),"L").concat(a,",").concat(h(s-r/2)):"";return"line"===t.pathType?"M".concat(a,",").concat(s,"L").concat(o,",").concat(l).concat(v,"L").concat(o,",").concat(p,"L").concat(a,",").concat(d).concat(g,"Z"):"polyline"===t.pathType?"M".concat(a,",").concat(s,"L").concat(u,",").concat(s,"L").concat(u,",").concat(l,"L").concat(o,",").concat(l,"\n    ").concat(v,"L").concat(o,",").concat(p,"L").concat(u,",").concat(p,"L").concat(u,",").concat(d,"L").concat(a,",").concat(d).concat(g,"Z"):"M".concat(a,",").concat(s,"C").concat(u,",").concat(s,",").concat(c,",").concat(l,",").concat(o,",").concat(l,"\n  ").concat(v,"L").concat(o,",").concat(p,"C").concat(c,",").concat(p,",").concat(u,",").concat(d,",").concat(a,",").concat(d).concat(g,"Z")},yV=function(t,e){var i,n=null!==(i=t.curvature)&&void 0!==i?i:.5,r="number"==typeof e?t.thickness*e:t.thickness,a=t.y0,o=t.y1,s=t.x0,l=t.x1,u=a+n*(o-a),c=o+n*(a-o),h=function(t){return t};!1!==t.round&&(h=Math.round,a=Math.round(a),o=Math.round(o),s=Math.round(s),l=Math.round(l),u=Math.round(u),c=Math.round(c)),"line"===t.pathType||t.pathType,"center"===t.align?(s=h(t.x0-r/2),l=h(t.x1-r/2)):"end"===t.align?(s=h(t.x0+t.thickness/2-r),l=h(t.x1+t.thickness/2-r)):(s=h(t.x0-t.thickness/2),l=h(t.x1-t.thickness/2));var d=h(s+r),p=h(l+r),f=Math.abs(o-a)>1e-6,v=t.endArrow&&f?"L".concat(h(l-r/2),",").concat(o,"L").concat(h((l+p)/2),",").concat(h(o+r),"L").concat(h(p+r/2),",").concat(o):"",g=t.startArrow&&f?"L".concat(h(d+r/2),",").concat(a,"L").concat(h((d+s)/2),",").concat(h(a-r),"L").concat(h(s-r/2),",").concat(a):"";return"line"===t.pathType?"M".concat(s,",").concat(a,"L").concat(l,",").concat(o).concat(v,"L").concat(p,",").concat(o,"L").concat(d,",").concat(a).concat(g,"Z"):"polyline"===t.pathType?"M".concat(s,",").concat(a,"L").concat(s,",").concat(u,"L").concat(l,",").concat(u,"L").concat(l,",").concat(o,"\n    ").concat(v,"L").concat(p,",").concat(o,"L").concat(p,",").concat(u,"L").concat(d,",").concat(u,"L").concat(d,",").concat(a).concat(g,"Z"):"M".concat(s,",").concat(a,"C").concat(s,",").concat(u,",").concat(l,",").concat(c,",").concat(l,",").concat(o,"\n  ").concat(v,"L").concat(p,",").concat(o,"C").concat(p,",").concat(c,",").concat(d,",").concat(u,",").concat(d,",").concat(a).concat(g,"Z")},mV=function(t,e,i,n){var r,a=null!==(r=t.direction)&&void 0!==r?r:null==n?void 0:n.direction,o=["vertical","TB","BT"].includes(a)?yV:gV,s="number"==typeof t.ratio&&t.ratio>=0&&t.ratio<=1,l=Object.keys(t);return["x0","y0","x1","y1"].every((function(t){return l.includes(t)}))?{back:{path:s?o(t,1):""},front:{path:o(t,s?t.ratio:1)}}:{}},_V=function(t,e,i){var n={x0:t.getGraphicAttribute("x0",!1),x1:t.getGraphicAttribute("x1",!1),y0:t.getGraphicAttribute("y0",!1),y1:t.getGraphicAttribute("y1",!1),thickness:t.getGraphicAttribute("thickness",!1),round:t.getGraphicAttribute("round",!1),align:t.getGraphicAttribute("align",!1),pathType:t.getGraphicAttribute("pathType",!1),endArrow:t.getGraphicAttribute("endArrow",!1),startArrow:t.getGraphicAttribute("startArrow",!1)};return Object.keys(n).forEach((function(t){j(n[t])&&delete n[t]})),{from:Object.assign({},n,{x1:n.x0,y1:n.y0}),to:n}},bV=function(t,e,i){var n={x0:t.getGraphicAttribute("x0",!0),x1:t.getGraphicAttribute("x1",!0),y0:t.getGraphicAttribute("y0",!0),y1:t.getGraphicAttribute("y1",!0),thickness:t.getGraphicAttribute("thickness",!0),round:t.getGraphicAttribute("round",!0),align:t.getGraphicAttribute("align",!0),pathType:t.getGraphicAttribute("pathType",!0),endArrow:t.getGraphicAttribute("endArrow",!0),startArrow:t.getGraphicAttribute("startArrow",!0)};return Object.keys(n).forEach((function(t){j(n[t])&&delete n[t]})),{from:n,to:Object.assign({},n,{x1:n.x0,y1:n.y0})}},xV=function(t,e,i){var n={thickness:t.getGraphicAttribute("thickness",!1),round:t.getGraphicAttribute("round",!1),align:t.getGraphicAttribute("align",!1),pathType:t.getGraphicAttribute("pathType",!1),endArrow:t.getGraphicAttribute("endArrow",!1),startArrow:t.getGraphicAttribute("startArrow",!1)};return Object.keys(n).forEach((function(t){j(n[t])&&delete n[t]})),{from:Object.assign(Object.assign({x0:t.getGraphicAttribute("x0",!0),x1:t.getGraphicAttribute("x1",!0),y0:t.getGraphicAttribute("y0",!0),y1:t.getGraphicAttribute("y1",!0)},n),n),to:Object.assign({x0:t.getGraphicAttribute("x0",!1),x1:t.getGraphicAttribute("x1",!1),y0:t.getGraphicAttribute("y0",!1),y1:t.getGraphicAttribute("y1",!1)},n)}},kV=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"parseAddition",value:function(t){return y(e,"parseAddition",this,3)([t]),this.scale(t.scale),this}},{key:"scale",value:function(t){if(this.spec.scale){var e=Y(this.spec.scale)?this.view.getScaleById(this.spec.scale):this.spec.scale;this.detach(e),this.spec.scale=void 0}var i=Y(t)?this.view.getScaleById(t):t;return this.spec.scale=i,this.attach(i),this._updateComponentEncoders(),this.commit(),this}},{key:"getScale",value:function(){return Y(this.spec.scale)?this.view.getScaleById(this.spec.scale):this.spec.scale}}])}(jN),SV=function(t,e,i,n,r,a){var o,s=t.getCoordinateAxisPosition();r&&"auto"===r.position&&(r.position=i?"content":s);var l=t.getCoordinateAxisPoints(n);if(l){var u={start:l[0],end:l[1],verticalFactor:("top"===s||"left"===s?-1:1)*(i?-1:1)*((null===(o=t.getSpec().range)||void 0===o?void 0:o.reversed)?-1:1)};if(a&&"polar"===e.type){var c=e.angle();u.center=e.origin(),u.startAngle=c[0],u.endAngle=c[1]}return u}var h=e.radius(),d=e.angle();return{center:e.origin(),radius:h[1],innerRadius:h[0],inside:i,startAngle:d[0],endAngle:d[1]}},AV=function(t){function e(t,i,a){var o;return r(this,e),(o=n(this,e,[t,wH.axis,i])).spec.componentType=wH.axis,o.mode=a,o}return h(e,t),o(e,[{key:"parseAddition",value:function(t){return y(e,"parseAddition",this,3)([t]),this.axisType(t.axisType),this.tickCount(t.tickCount),this.inside(t.inside),this.baseValue(t.baseValue),this}},{key:"scale",value:function(t){return y(e,"scale",this,3)([t]),this._axisComponentType=null,this}},{key:"axisType",value:function(t){return this.spec.axisType=t,this._axisComponentType=null,this._prepareRejoin(),this.commit(),this}},{key:"addGraphicItem",value:function(t,i){var n=ft({x:0,y:0,start:{x:0,y:0},end:{x:0,y:0}},t),r=xj.createGraphicComponent(this._getAxisComponentType(),n,{mode:this.mode,skipDefault:this.spec.skipTheme});return y(e,"addGraphicItem",this,3)([n,i,r])}},{key:"tickCount",value:function(t){var e=Y(this.spec.scale)?this.view.getScaleById(this.spec.scale):this.spec.scale;return e&&e.tickCount(t),this.setFunctionSpec(t,"tickCount")}},{key:"inside",value:function(t){return this.setFunctionSpec(t,"inside")}},{key:"baseValue",value:function(t){return this.setFunctionSpec(t,"baseValue")}},{key:"getAxisComponentType",value:function(){return this._axisComponentType}},{key:"_updateComponentEncoders",value:function(){var t=this,e=Y(this.spec.scale)?this.view.getScaleById(this.spec.scale):this.spec.scale,i=Object.assign({update:{}},this.spec.encode),n=Object.keys(i).reduce((function(n,r){var a=i[r];return a&&(n[r]={callback:function(i,n,r){var o,s,l=t.spec.skipTheme?null:t.view.getCurrentTheme(),u=_j(a,i,n,r),c=cj(t.spec.inside,r,i,n),h=cj(t.spec.baseValue,r,i,n),d=null===(o=null==e?void 0:e.getCoordinate)||void 0===o?void 0:o.call(e);d&&(u=Object.assign(SV(e,d,c,h,t.spec.layout),u));var p=null===(s=null==e?void 0:e.getScale)||void 0===s?void 0:s.call(e),f=cj(t.spec.tickCount,r,i,n);switch(t._getAxisComponentType()){case CH.lineAxis:return function(t,e,i,n){var r,a,o,s,l=null!==(a=null===(r=null==e?void 0:e.components)||void 0===r?void 0:r.axis)&&void 0!==a?a:{};return t?ft({},l,{items:[(null!==(s=null===(o=t.tickData)||void 0===o?void 0:o.call(t,n))&&void 0!==s?s:[]).map((function(t){return{id:t.index,label:t.tick,value:t.value,rawValue:t.tick}}))]},null!=i?i:{}):ft({},l,null!=i?i:{})}(p,l,u,f);case CH.circleAxis:return function(t,e,i,n){var r,a,o,s,l=null!==(a=null===(r=null==e?void 0:e.components)||void 0===r?void 0:r.circleAxis)&&void 0!==a?a:{};return t?ft({},l,{items:[(null!==(s=null===(o=t.tickData)||void 0===o?void 0:o.call(t,n))&&void 0!==s?s:[]).map((function(t){return{id:t.index,label:t.tick,value:t.value,rawValue:t.tick}}))]},null!=i?i:{}):ft({},l,null!=i?i:{})}(p,l,u,f)}return u}}),n}),{});this._encoders=n}},{key:"_getAxisComponentType",value:function(){var t;if(this._axisComponentType)return this._axisComponentType;var e=this.spec.axisType;if(j(e)){var i=Y(this.spec.scale)?this.view.getScaleById(this.spec.scale):this.spec.scale;e=(null===(t=null==i?void 0:i.getCoordinate)||void 0===t?void 0:t.call(i))?i.getCoordinateAxisPoints()?"line":"circle":"line"}return this._axisComponentType="circle"===e?CH.circleAxis:CH.lineAxis,this._axisComponentType}}])}(kV);AV.componentType=wH.axis;var MV=function(){xj.registerGraphicComponent(CH.lineAxis,(function(t,e){return new TB(t,e)})),xj.registerComponent(wH.axis,AV)},wV=function(){xj.registerGraphicComponent(CH.circleAxis,(function(t){return new IB(t)})),xj.registerComponent(wH.axis,AV)},TV=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i},CV=function(t){function e(t,i){var a;return r(this,e),(a=n(this,e,[t,wH.label,i])).spec.componentType=wH.label,a}return h(e,t),o(e,[{key:"parseAddition",value:function(t){return y(e,"parseAddition",this,3)([t]),this.labelStyle(t.labelStyle),this.size(t.size),this.target(t.target),this}},{key:"labelStyle",value:function(t){return this.setFunctionSpec(t,"labelStyle")}},{key:"size",value:function(t){return this.setFunctionSpec(t,"size")}},{key:"target",value:function(t){var e=this;if(this.spec.target){var i=xt(this.spec.target).map((function(t){return Y(t)?e.view.getMarkById(t):t}));this.detach(i)}if(this.spec.target=t,t){var n=xt(t).map((function(t){return Y(t)?e.view.getMarkById(t):t}));this.attach(n)}return this.commit(),this}},{key:"_updateComponentEncoders",value:function(){var t=this,e=Object.assign({update:{}},this.spec.encode),i=Object.keys(e).reduce((function(i,n){var r=e[n];return r&&(i[n]={callback:function(e,i,n){var a,o,s,l,u=xt(t.spec.target).map((function(e){return Y(e)?t.view.getMarkById(e):e})),c=null===(o=null===(a=t.group)||void 0===a?void 0:a.getGroupGraphicItem)||void 0===o?void 0:o.call(a),h=cj(t.spec.size,n);h||(h=c?{width:null!==(s=c.attribute.width)&&void 0!==s?s:c.AABBBounds.width(),height:null!==(l=c.attribute.height)&&void 0!==l?l:c.AABBBounds.height()}:{width:1/0,height:1/0});var d=t.spec.skipTheme?null:t.view.getCurrentTheme();return function(t,e,i,n,r){var a,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},s=null===(a=o.components)||void 0===a?void 0:a.dataLabel,l=t.map((function(t,e){var a,s,l,u,c,h=Object.assign(Object.assign({},r),{labelIndex:e}),d=null!==(a=cj(n,h,t))&&void 0!==a?a:{},p=o.components,f=void 0===p?{}:p,v={};switch(t.markType){case MH.line:case MH.area:v="line"===d.type?f.lineLabel:"area"===d.type?f.areaLabel:f.lineDataLabel;break;case MH.rect:case MH.rect3d:case MH.interval:v=f.rectLabel;break;case MH.symbol:case MH.circle:case MH.cell:v=f.symbolLabel;break;case MH.arc:case MH.arc3d:v=f.arcLabel;break;case MH.polygon:case MH.path:default:v=f.pointLabel}var g=null!==(s=d.data)&&void 0!==s?s:[],y=null!==(u=null===(l=null==v?void 0:v.data)||void 0===l?void 0:l[0])&&void 0!==u?u:{};if(g&&g.length>0)g.forEach((function(e,n){if(t.elements[n]){var r=_j(i,e,t.elements[n],h);ft(e,y,r)}}));else{var m=function(t,e){var i=t.data,n=TV(t,["data"]);return Object.assign(Object.assign({},ft({},e,n)),{data:i})};t.elements.forEach((function(e){if("willRelease"!==e.getGraphicItem().releaseStatus)if(t.isCollectionMark())e.getDatum().forEach((function(t){var n=_j(i,t,e,h);g.push(m(n,y))}));else{var n=_j(i,e.getDatum(),e,h);g.push(m(n,y))}}))}var _=ft({},v,{baseMarkGroupName:null===(c=t.graphicItem)||void 0===c?void 0:c.name,getBaseMarks:function(){return t.elements.map((function(t){return t.getGraphicItem()}))}},null!=d?d:{});return _.data=null!=g?g:v.data,_})).filter((function(t){return!j(t)})),u=ft({},s,{size:e});return u.dataLabels=l,u}(u,h,r,t.spec.labelStyle,n,d)}}),i}),{});this._encoders=i}}])}(jN);CV.componentType=wH.label;var EV=function(){xj.registerGraphicComponent(wH.label,(function(t){return new jL(t)})),xj.registerComponent(wH.label,CV)},PV=function(t){function e(t,i,a){var o;return r(this,e),(o=n(this,e,[t,wH.grid,i])).spec.componentType=wH.grid,o.mode=a,o}return h(e,t),o(e,[{key:"parseAddition",value:function(t){return y(e,"parseAddition",this,3)([t]),this.target(t.target),this.gridType(t.gridType),this.gridShape(t.gridShape),this}},{key:"scale",value:function(t){return y(e,"scale",this,3)([t]),this._gridComponentType=null,this}},{key:"gridType",value:function(t){return this.spec.gridType=t,this._gridComponentType=null,this._prepareRejoin(),this.commit(),this}},{key:"gridShape",value:function(t){return this.spec.gridShape=t,this.commit(),this}},{key:"target",value:function(t){if(this.spec.target){var e=Y(this.spec.target)?this.view.getMarkById(this.spec.target):this.spec.target;this.detach(e)}this.spec.target=t;var i=Y(t)?this.view.getMarkById(t):t;return this.attach(i),this._targetAxis=i,this._gridComponentType=null,this._updateComponentEncoders(),this.commit(),this}},{key:"tickCount",value:function(t){var e=Y(this.spec.scale)?this.view.getScaleById(this.spec.scale):this.spec.scale;return e&&e.tickCount(t),this.setFunctionSpec(t,"tickCount")}},{key:"inside",value:function(t){return this.setFunctionSpec(t,"inside")}},{key:"baseValue",value:function(t){return this.setFunctionSpec(t,"baseValue")}},{key:"addGraphicItem",value:function(t,i){var n=ft({x:0,y:0,start:{x:0,y:0},end:{x:0,y:0}},t),r=xj.createGraphicComponent(this._getGridComponentType(),n,{mode:this.mode,skipDefault:this.spec.skipTheme});return y(e,"addGraphicItem",this,3)([n,i,r])}},{key:"_updateComponentEncoders",value:function(){var t=this,e=Object.assign({update:{}},this.spec.encode),i=Object.keys(e).reduce((function(i,n){var r=e[n];return r&&(i[n]={callback:function(e,i,n){var a,o,s,l,u,c=t.spec.skipTheme?null:t.view.getCurrentTheme(),h=_j(r,e,i,n),d=cj(t.spec.baseValue,n,e,i);if(t._targetAxis){var p=null===(a=t._targetAxis.getSpec())||void 0===a?void 0:a.scale;u=Y(p)?t.view.getScaleById(p):p;var f=t._targetAxis.elements[0];if(f)switch(t._getGridComponentType()){case EH.lineAxisGrid:h=Object.assign({x:f.getGraphicAttribute("x"),y:f.getGraphicAttribute("y"),start:f.getGraphicAttribute("start"),end:f.getGraphicAttribute("end"),verticalFactor:null!==(o=f.getGraphicAttribute("verticalFactor"))&&void 0!==o?o:1},h);break;case EH.circleAxisGrid:h=Object.assign({x:f.getGraphicAttribute("x"),y:f.getGraphicAttribute("y"),center:f.getGraphicAttribute("center"),radius:f.getGraphicAttribute("radius"),innerRadius:f.getGraphicAttribute("innerRadius"),inside:f.getGraphicAttribute("inside"),startAngle:f.getGraphicAttribute("startAngle"),endAngle:f.getGraphicAttribute("endAngle")},h)}}else{u=Y(t.spec.scale)?t.view.getScaleById(t.spec.scale):t.spec.scale;var v=cj(t.spec.inside,n,e,i),g=null===(s=null==u?void 0:u.getCoordinate)||void 0===s?void 0:s.call(u);g&&(h=Object.assign(SV(u,g,v,d,t.spec.layout,!0),h))}t._getGridComponentType()===EH.lineAxisGrid&&(h="line"!==t.spec.gridShape&&t.spec.gridShape?Object.assign({center:h.start,closed:!0},h,{type:t.spec.gridShape}):Object.assign({},h,{type:"line"}));var y=null===(l=null==u?void 0:u.getScale)||void 0===l?void 0:l.call(u),m=cj(t.spec.tickCount,n,e,i);switch(t._getGridComponentType()){case EH.lineAxisGrid:return function(t,e,i,n){var r,a,o,s,l=null!==(a=null===(r=null==e?void 0:e.components)||void 0===r?void 0:r.grid)&&void 0!==a?a:{};return t?ft({},l,{items:(null!==(s=null===(o=t.tickData)||void 0===o?void 0:o.call(t,n))&&void 0!==s?s:[]).map((function(t){return{id:t.index,label:t.tick,value:t.value,rawValue:t.tick}}))},null!=i?i:{}):ft({},l,null!=i?i:{})}(y,c,h,m);case EH.circleAxisGrid:return function(t,e,i,n){var r,a,o,s,l=null!==(a=null===(r=null==e?void 0:e.components)||void 0===r?void 0:r.circleGrid)&&void 0!==a?a:{};return t?ft({},l,{items:(null!==(s=null===(o=t.tickData)||void 0===o?void 0:o.call(t,n))&&void 0!==s?s:[]).map((function(t){return{id:t.index,label:t.tick,value:t.value,rawValue:t.tick}}))},null!=i?i:{}):ft({},l,null!=i?i:{})}(y,c,h,m)}return h}}),i}),{});this._encoders=i}},{key:"_getGridComponentType",value:function(){var t;if(this._gridComponentType)return this._gridComponentType;if(this.spec.gridType)"circle"===this.spec.gridType?this._gridComponentType=EH.circleAxisGrid:this._gridComponentType=EH.lineAxisGrid;else if(this._targetAxis)switch(this._targetAxis.getAxisComponentType()){case CH.circleAxis:this._gridComponentType=EH.circleAxisGrid;break;case CH.lineAxis:default:this._gridComponentType=EH.lineAxisGrid}else if(this.spec.scale){var e=Y(this.spec.scale)?this.view.getScaleById(this.spec.scale):this.spec.scale;this._gridComponentType=(null===(t=null==e?void 0:e.getCoordinate)||void 0===t?void 0:t.call(e))?e.getCoordinateAxisPoints()?EH.lineAxisGrid:EH.circleAxisGrid:EH.lineAxisGrid}else this._gridComponentType=EH.lineAxisGrid;return this._gridComponentType}}])}(kV);PV.componentType=wH.grid;var RV=function(){xj.registerGraphicComponent(EH.lineAxisGrid,(function(t,e){return new GL(t,e)})),xj.registerComponent(wH.grid,PV)},BV=function(){xj.registerGraphicComponent(EH.circleAxisGrid,(function(t,e){return new YL(t,e)})),xj.registerComponent(wH.grid,PV)},IV=function(t,e,i){return e.filter((function(e){return t.callback(e,i)}))},LV=function(t,e,i){var n=t.callback,r=t.as;if(!t.all)return e.forEach((function(t){var e=n(t,i);if(!j(r)){if(j(t))return;t[r]=e}return e})),e;var a=n(e,i);return j(r)||j(e)?a:(e[r]=a,e)};function DV(t){return t.reduce((function(t,e){return t+e}),0)}var OV={min:At,max:St,average:function(t){return 0===t.length?0:DV(t)/t.length},sum:DV};function FV(t,e,i,n){var r,a,o,s=Math.floor(e.length/t),l=[],u=e.length,c=0,h=0;l[h++]=c;for(var d=1;d<u-1;d+=s){for(var p=Math.min(d+s,u-1),f=Math.min(d+2*s,u),v=(f+p)/2,g=0,y=p;y<f;y++){var m=e[y][n];Number.isNaN(m)||(g+=m)}g/=f-p;var _=d,b=Math.min(d+s,u),x=d-1,k=e[c][n];r=-1,o=_;for(var S=_;S<b;S++){var A=e[S][n];Number.isNaN(n)||(a=Math.abs((x-v)*(A-k)-(x-S)*(g-k)))>r&&(r=a,o=S)}l[h++]=o,c=o}return l[h-1]!==u-1&&(l[h++]=u-1),l.map((function(t){return i?e[t].i:t}))}function zV(t,e,i,n,r){var a=Math.floor(e.length/t),o=[],s=e.length,l=0,u=[];o.push(l),e[l][r]=e[l][r];for(var c=1;c<s-1;c+=a){a>s-c&&(a=s-c,u.length=a),u=[];for(var h=0;h<a;h++)u.push(e[c+h][r]);var d=OV[n](u);l=Math.min(Math.round(c+u.length/2)||0,s-1),e[l][r]=d,o.push(l)}return o.map((function(t){return i?e[t].i:t}))}function HV(t,e,i,n){return zV(t,e,i,"min",n)}function jV(t,e,i,n){return zV(t,e,i,"max",n)}function NV(t,e,i,n){return zV(t,e,i,"average",n)}function VV(t,e,i,n){return zV(t,e,i,"sum",n)}var WV=function(t,e){var i=t.size,n=t.factor||1;if(Array.isArray(i)&&(i=Math.floor(i[1]-i[0])),(i*=n)<=0)return[];if(e.length<=i)return e;if(t.skipfirst)return e.slice(0,1);var r=t.mode,a=t.yfield,o=t.groupBy,s=null!=a?a:"y",u=FV;if("min"===r?u=HV:"max"===r?u=jV:"average"===r?u=NV:"sum"===r&&(u=VV),e.length){var c={};if(o){for(var h=0,d=e.length;h<d;h++){var p=e[h],f=p[o];c[f]||(c[f]=[]),c[f].push(l(l({},s,p[s]),"i",h))}var v=[];return Object.keys(c).forEach((function(t){var n=c[t];if(n.length<=i){var r=n.map((function(t){return t.i}));v=v.concat(r)}else{var a=u(i,n,!0,s);v=v.concat(a),n.forEach((function(t){return e[t.i][s]=t[s]}))}})),v.sort((function(t,e){return t-e})),v.map((function(t){return e[t]}))}return u(i,e,!1,s).map((function(t){return e[t]}))}return[]};var GV=function(t,e){if(e&&0!==e.length){var i=t.radius;j(i)&&"symbol"===e[0].mark.markType&&(i=!0);var n=t.direction,r=t.delta,a=t.deltaMul,o=void 0===a?1:a,s=t.groupBy,l=function(e){!function(t){t.forEach((function(t){t.getGraphicAttribute(oj)&&(t.setGraphicAttribute("visible",!0),t.setGraphicAttribute(oj,!1))}))}(e);var a=t.sort?e.slice().sort((function(t,e){return t.getGraphicAttribute("x")-e.getGraphicAttribute("x")})):e;0===n?function(t,e,i,n){if(n){var r=-1/0,a=0,o=j(e),s=e;t.forEach((function(t){if(!1!==t.getGraphicAttribute("visible")){var e=t.getGraphicAttribute("size")/2,n=t.getGraphicAttribute("x"),l=t.getGraphicAttribute("y");o&&(s=(e+a)*i),Math.pow(-1/0-n,2)+Math.pow(r-l,2)<Math.pow(s+a+e,2)?t.getGraphicAttribute("forceShow")||(t.setGraphicAttribute(oj,!0),t.setGraphicAttribute("visible",!1)):r=l,a=e}}))}}(a,r,o,i):1===n?function(t,e,i,n){if(n){var r=-1/0,a=0,o=j(e),s=e;t.forEach((function(t){if(!1!==t.getGraphicAttribute("visible")){var e=t.getGraphicAttribute("size")/2,n=t.getGraphicAttribute("x");o&&(s=(e+a)*i),Math.abs(n-r)<s+a+e?t.getGraphicAttribute("forceShow")||(t.setGraphicAttribute(oj,!0),t.setGraphicAttribute("visible",!1)):r=n,a=e}}))}}(a,r,o,i):function(t,e,i,n){if(n){var r=-1/0,a=0,o=j(e),s=e;t.forEach((function(t){if(!1!==t.getGraphicAttribute("visible")){var e=t.getGraphicAttribute("size")/2,n=t.getGraphicAttribute("y");o&&(s=(e+a)*i),Math.abs(n-r)<s+a+e?t.getGraphicAttribute("forceShow")||(t.setGraphicAttribute(oj,!0),t.setGraphicAttribute("visible",!1)):r=n,a=e}}))}}(a,r,o,i)};if(s){var u=e.reduce((function(t,e){var i=e.getDatum()[s];return t[i]?t[i].push(e):t[i]=[e],t}),{});Object.keys(u).forEach((function(t){l(u[t])}))}else l(e);return e}},UV=function(){xj.registerTransform("sampling",{transform:WV,markPhase:"afterEncode"},!0)},YV=function(){xj.registerTransform("markoverlap",{transform:GV,markPhase:"afterEncode"},!0)},XV=function(t,e,i){var n,r=t.getGraphicAttribute("clipRangeByDimension",!1),a=null!==(n=t.getGraphicAttribute("clipRange",!1))&&void 0!==n?n:1;return e&&e.clipDimension?{from:{clipRange:0,clipRangeByDimension:e.clipDimension},to:{clipRange:a,clipRangeByDimension:r}}:{from:{clipRange:0},to:{clipRange:a}}},KV=function(t,e,i){var n,r=t.getGraphicAttribute("clipRangeByDimension",!0),a=null!==(n=t.getGraphicAttribute("clipRange",!0))&&void 0!==n?n:1;return e&&e.clipDimension?{from:{clipRange:a,clipRangeByDimension:e.clipDimension},to:{clipRange:0,clipRangeByDimension:r}}:{from:{clipRange:a},to:{clipRange:0}}},qV=function(t,e,i){var n,r,a,o,s=null!==(n=t.getFinalAnimationAttributes())&&void 0!==n?n:{};return{from:{opacity:0,fillOpacity:0,strokeOpacity:0},to:{opacity:null!==(r=s.opacity)&&void 0!==r?r:1,fillOpacity:null!==(a=s.fillOpacity)&&void 0!==a?a:1,strokeOpacity:null!==(o=s.strokeOpacity)&&void 0!==o?o:1}}},ZV=function(t,e,i){var n,r,a;return{from:{opacity:null!==(n=t.getGraphicAttribute("opacity",!0))&&void 0!==n?n:1,fillOpacity:null!==(r=t.getGraphicAttribute("fillOpacity",!0))&&void 0!==r?r:1,strokeOpacity:null!==(a=t.getGraphicAttribute("strokeOpacity",!0))&&void 0!==a?a:1},to:{opacity:0,fillOpacity:0,strokeOpacity:0}}},JV=function(t,e,i){switch(null==e?void 0:e.direction){case"x":var n=t.getFinalAnimationAttribute("x"),r=t.getFinalAnimationAttribute("x1"),a=t.getFinalAnimationAttribute("width");return{from:N(a)?{x:n+a/2,x1:void 0,width:0}:{x:(n+r)/2,x1:(n+r)/2,width:void 0},to:{x:n,x1:r,width:a}};case"y":var o=t.getFinalAnimationAttribute("y"),s=t.getFinalAnimationAttribute("y1"),l=t.getFinalAnimationAttribute("height");return{from:N(l)?{y:o+l/2,y1:void 0,height:0}:{y:(o+s)/2,y1:(o+s)/2,height:void 0},to:{y:o,y1:s,height:l}};default:var u=t.getFinalAnimationAttribute("x"),c=t.getFinalAnimationAttribute("x1"),h=t.getFinalAnimationAttribute("width"),d=t.getFinalAnimationAttribute("y"),p=t.getFinalAnimationAttribute("y1"),f=t.getFinalAnimationAttribute("height"),v={};return N(h)?(v.x=u+h/2,v.width=0,v.x1=void 0):(v.x=(u+c)/2,v.x1=(u+c)/2,v.width=void 0),N(f)?(v.y=d+f/2,v.height=0,v.y1=void 0):(v.y=(d+p)/2,v.y1=(d+p)/2,v.height=void 0),{from:v,to:{x:u,y:d,x1:c,y1:p,width:h,height:f}}}},QV=function(t,e,i){switch(null==e?void 0:e.direction){case"x":var n=t.getFinalAnimationAttribute("x"),r=t.getFinalAnimationAttribute("x1"),a=t.getFinalAnimationAttribute("width");return{to:N(a)?{x:n+a/2,x1:void 0,width:0}:{x:(n+r)/2,x1:(n+r)/2,width:void 0}};case"y":var o=t.getFinalAnimationAttribute("y"),s=t.getFinalAnimationAttribute("y1"),l=t.getFinalAnimationAttribute("height");return{to:N(l)?{y:o+l/2,y1:void 0,height:0}:{y:(o+s)/2,y1:(o+s)/2,height:void 0}};default:var u=t.getFinalAnimationAttribute("x"),c=t.getFinalAnimationAttribute("y"),h=t.getFinalAnimationAttribute("x1"),d=t.getFinalAnimationAttribute("y1"),p=t.getFinalAnimationAttribute("width"),f=t.getFinalAnimationAttribute("height"),v={};return N(p)?(v.x=u+p/2,v.width=0,v.x1=void 0):(v.x=(u+h)/2,v.x1=(u+h)/2,v.width=void 0),N(f)?(v.y=c+f/2,v.height=0,v.y1=void 0):(v.y=(c+d)/2,v.y1=(c+d)/2,v.height=void 0),{to:v}}};var $V=function(t,e,i){var n;return!1!==(null!==(n=null==e?void 0:e.overall)&&void 0!==n&&n)?function(t,e,i){var n,r,a=t.getFinalAnimationAttribute("x"),o=t.getFinalAnimationAttribute("x1"),s=t.getFinalAnimationAttribute("width");return e&&"negative"===e.orient?Z(e.overall)?r=e.overall:i.group?(r=null!==(n=i.groupWidth)&&void 0!==n?n:i.group.getBounds().width(),i.groupWidth=r):r=i.width:r=Z(null==e?void 0:e.overall)?null==e?void 0:e.overall:0,{from:{x:r,x1:j(o)?void 0:r,width:j(s)?void 0:0},to:{x:a,x1:o,width:s}}}(t,e,i):function(t,e,i){var n=t.getFinalAnimationAttribute("x"),r=t.getFinalAnimationAttribute("x1"),a=t.getFinalAnimationAttribute("width");if(e&&"negative"===e.orient){var o=N(a)?Math.max(n,n+a):Math.max(n,r);return{from:{x:o,x1:j(r)?void 0:o,width:j(a)?void 0:0},to:{x:n,x1:r,width:a}}}var s=N(a)?Math.min(n,n+a):Math.min(n,r);return{from:{x:s,x1:j(r)?void 0:s,width:j(a)?void 0:0},to:{x:n,x1:r,width:a}}}(t,e)};var tW=function(t,e,i){var n;return!1!==(null!==(n=null==e?void 0:e.overall)&&void 0!==n&&n)?function(t,e,i){var n,r,a=t.getFinalAnimationAttribute("x1"),o=t.getFinalAnimationAttribute("width");return e&&"negative"===e.orient?Z(e.overall)?r=e.overall:i.group?(r=null!==(n=i.groupWidth)&&void 0!==n?n:i.group.getBounds().width(),i.groupWidth=r):r=i.width:r=Z(null==e?void 0:e.overall)?e.overall:0,{to:{x:r,x1:j(a)?void 0:r,width:j(o)?void 0:0}}}(t,e,i):function(t,e,i){var n=t.getFinalAnimationAttribute("x"),r=t.getFinalAnimationAttribute("x1"),a=t.getFinalAnimationAttribute("width");if(e&&"negative"===e.orient){var o=N(a)?Math.max(n,n+a):Math.max(n,r);return{to:{x:o,x1:j(r)?void 0:o,width:j(a)?void 0:0}}}var s=N(a)?Math.min(n,n+a):Math.min(n,r);return{to:{x:s,x1:j(r)?void 0:s,width:j(a)?void 0:0}}}(t,e)};var eW=function(t,e,i){var n;return!1!==(null!==(n=null==e?void 0:e.overall)&&void 0!==n&&n)?function(t,e,i){var n,r,a=t.getFinalAnimationAttribute("y"),o=t.getFinalAnimationAttribute("y1"),s=t.getFinalAnimationAttribute("height");return e&&"negative"===e.orient?Z(e.overall)?r=e.overall:i.group?(r=null!==(n=i.groupHeight)&&void 0!==n?n:i.group.getBounds().height(),i.groupHeight=r):r=i.height:r=Z(null==e?void 0:e.overall)?e.overall:0,{from:{y:r,y1:j(o)?void 0:r,height:j(s)?void 0:0},to:{y:a,y1:o,height:s}}}(t,e,i):function(t,e,i){var n=t.getFinalAnimationAttribute("y"),r=t.getFinalAnimationAttribute("y1"),a=t.getFinalAnimationAttribute("height");if(e&&"negative"===e.orient){var o=N(a)?Math.max(n,n+a):Math.max(n,r);return{from:{y:o,y1:j(r)?void 0:o,height:j(a)?void 0:0},to:{y:n,y1:r,height:a}}}var s=N(a)?Math.min(n,n+a):Math.min(n,r);return{from:{y:s,y1:j(r)?void 0:s,height:j(a)?void 0:0},to:{y:n,y1:r,height:a}}}(t,e)};var iW=function(t,e,i){var n;return!1!==(null!==(n=null==e?void 0:e.overall)&&void 0!==n&&n)?function(t,e,i){var n,r,a=t.getFinalAnimationAttribute("y1"),o=t.getFinalAnimationAttribute("height");return e&&"negative"===e.orient?Z(e.overall)?r=e.overall:i.group?(r=null!==(n=i.groupHeight)&&void 0!==n?n:i.group.getBounds().height(),i.groupHeight=r):r=i.height:r=Z(null==e?void 0:e.overall)?e.overall:0,{to:{y:r,y1:j(a)?void 0:r,height:j(o)?void 0:0}}}(t,e,i):function(t,e,i){var n=t.getFinalAnimationAttribute("y"),r=t.getFinalAnimationAttribute("y1"),a=t.getFinalAnimationAttribute("height");if(e&&"negative"===e.orient){var o=N(a)?Math.max(n,n+a):Math.max(n,r);return{to:{y:o,y1:j(r)?void 0:o,height:j(a)?void 0:0}}}var s=N(a)?Math.min(n,n+a):Math.min(n,r);return{to:{y:s,y1:j(r)?void 0:s,height:j(a)?void 0:0}}}(t,e)},nW=function(t,e,i){var n;return!1!==(null!==(n=null==e?void 0:e.overall)&&void 0!==n&&n)?function(t,e,i){var n=t.getFinalAnimationAttributes();if(e&&"anticlockwise"===e.orient){var r=Z(e.overall)?e.overall:2*Math.PI;return{from:{startAngle:r,endAngle:r},to:{startAngle:null==n?void 0:n.startAngle,endAngle:null==n?void 0:n.endAngle}}}var a=Z(null==e?void 0:e.overall)?e.overall:0;return{from:{startAngle:a,endAngle:a},to:{startAngle:null==n?void 0:n.startAngle,endAngle:null==n?void 0:n.endAngle}}}(t,e):function(t,e,i){var n=t.getFinalAnimationAttributes();return e&&"anticlockwise"===e.orient?{from:{startAngle:null==n?void 0:n.endAngle},to:{startAngle:null==n?void 0:n.startAngle}}:{from:{endAngle:null==n?void 0:n.startAngle},to:{endAngle:null==n?void 0:n.endAngle}}}(t,e)},rW=function(t,e,i){var n;return!1!==(null!==(n=null==e?void 0:e.overall)&&void 0!==n&&n)?function(t,e,i){if(e&&"anticlockwise"===e.orient){var n=Z(e.overall)?e.overall:2*Math.PI;return{from:{startAngle:t.getGraphicAttribute("startAngle",!0),endAngle:t.getGraphicAttribute("endAngle",!0)},to:{startAngle:n,endAngle:n}}}var r=Z(null==e?void 0:e.overall)?e.overall:0;return{from:{startAngle:t.getGraphicAttribute("startAngle",!0),endAngle:t.getGraphicAttribute("endAngle",!0)},to:{startAngle:r,endAngle:r}}}(t,e):function(t,e,i){var n=t.getFinalAnimationAttributes();return e&&"anticlockwise"===e.orient?{from:{startAngle:t.getGraphicAttribute("startAngle",!0)},to:{startAngle:null==n?void 0:n.endAngle}}:{from:{endAngle:t.getGraphicAttribute("endAngle",!0)},to:{endAngle:null==n?void 0:n.startAngle}}}(t,e)},aW=function(t,e,i){var n;return!1!==(null!==(n=null==e?void 0:e.overall)&&void 0!==n&&n)?function(t,e,i){var n=t.getFinalAnimationAttributes(),r=Z(null==e?void 0:e.overall)?e.overall:0;return{from:{innerRadius:r,outerRadius:r},to:{innerRadius:null==n?void 0:n.innerRadius,outerRadius:null==n?void 0:n.outerRadius}}}(t,e):function(t,e,i){var n=t.getFinalAnimationAttributes();return e&&"inside"===e.orient?{from:{innerRadius:null==n?void 0:n.outerRadius},to:{innerRadius:null==n?void 0:n.innerRadius}}:{from:{outerRadius:null==n?void 0:n.innerRadius},to:{outerRadius:null==n?void 0:n.outerRadius}}}(t,e)},oW=function(t,e,i){var n;return!1!==(null!==(n=null==e?void 0:e.overall)&&void 0!==n&&n)?function(t,e,i){var n=Z(null==e?void 0:e.overall)?e.overall:0;return{from:{innerRadius:t.getGraphicAttribute("innerRadius",!0),outerRadius:t.getGraphicAttribute("outerRadius",!0)},to:{innerRadius:n,outerRadius:n}}}(t,e):function(t,e,i){var n=t.getFinalAnimationAttributes();return e&&"inside"===e.orient?{from:{innerRadius:t.getGraphicAttribute("innerRadius",!0)},to:{innerRadius:null==n?void 0:n.outerRadius}}:{from:{outerRadius:t.getGraphicAttribute("outerRadius",!0)},to:{outerRadius:null==n?void 0:n.innerRadius}}}(t,e)},sW=function(t,e,i){var n=t.getGraphicAttribute("points",!1),r={x:0,y:0};return n.forEach((function(t){r.x+=t.x,r.y+=t.y})),r.x/=n.length,r.y/=n.length,e&&e.center&&(Q(e.center.x)&&(r.x=e.center.x),Q(e.center.y)&&(r.y=e.center.y)),"area"===t.mark.markType&&(r.x1=r.x,r.y1=r.y),n.map((function(t){return Object.assign({},t,r)}))},lW=function(t,e,i){return{from:{points:sW(t,e)},to:{points:t.getGraphicAttribute("points",!1)}}},uW=function(t,e,i){return{from:{points:t.getGraphicAttribute("points",!0)},to:{points:sW(t,e)}}},cW=function(t,e,i){return t.getGraphicAttribute("points",!1).map((function(t){var n;if(e&&"negative"===e.orient){var r=i.width;return i.group&&(r=null!==(n=i.groupWidth)&&void 0!==n?n:i.group.getBounds().width(),i.groupWidth=r),Object.assign(Object.assign({},t),{x:r,y:t.y,x1:r,y1:t.y1,defined:!1!==t.defined})}return Object.assign(Object.assign({},t),{x:0,y:t.y,x1:0,y1:t.y1,defined:!1!==t.defined})}))},hW=function(t,e,i){return{from:{points:cW(t,e,i)},to:{points:t.getGraphicAttribute("points",!1)}}},dW=function(t,e,i){return{from:{points:t.getGraphicAttribute("points",!0)},to:{points:cW(t,e,i)}}},pW=function(t,e,i){return t.getGraphicAttribute("points",!1).map((function(t){var n;if(e&&"negative"===e.orient){var r=i.height;return i.group&&(r=null!==(n=i.groupHeight)&&void 0!==n?n:i.group.getBounds().height(),i.groupHeight=r),Object.assign(Object.assign({},t),{x:t.x,y:r,x1:t.x1,y1:r,defined:!1!==t.defined})}return Object.assign(Object.assign({},t),{x:t.x,y:0,x1:t.x1,y1:0,defined:!1!==t.defined})}))},fW=function(t,e,i){return{from:{points:pW(t,e,i)},to:{points:t.getGraphicAttribute("points",!1)}}},vW=function(t,e,i){return{from:{points:t.getGraphicAttribute("points",!0)},to:{points:pW(t,e,i)}}},gW=function(t,e,i){var n,r,a=null!=e?e:{},o=a.offset,s=void 0===o?0:o,l=a.orient,u=a.direction,c=a.point,h=a.excludeChannels,d=void 0===h?[]:h,p=0,f=0;"negative"===l&&(i.group?(p=null!==(n=i.groupWidth)&&void 0!==n?n:i.group.getBounds().width(),f=null!==(r=i.groupHeight)&&void 0!==r?r:i.group.getBounds().height(),i.groupWidth=p,i.groupHeight=f):(p=i.width,f=i.height)),p+=s,f+=s;var v=H(c)?c.call(null,t.getDatum(),t,i):c,g=v&&Q(v.x)?v.x:p,y=v&&Q(v.y)?v.y:f,m=d.includes("x")?t.getGraphicAttribute("x"):t.getFinalAnimationAttribute("x"),_=d.includes("y")?t.getGraphicAttribute("y"):t.getFinalAnimationAttribute("y");switch(u){case"x":return{from:{x:g},to:{x:m}};case"y":return{from:{y:y},to:{y:_}};default:return{from:{x:g,y:y},to:{x:m,y:_}}}},yW=function(t,e,i){var n,r,a=null!=e?e:{},o=a.offset,s=void 0===o?0:o,l=a.orient,u=a.direction,c=a.point,h=i.group?i.group.getBounds():null,d=null!==(n=null==h?void 0:h.width())&&void 0!==n?n:i.width,p=null!==(r=null==h?void 0:h.height())&&void 0!==r?r:i.height,f=("negative"===l?d:0)+s,v=("negative"===l?p:0)+s,g=H(c)?c.call(null,t.getDatum(),t,i):c,y=g&&Q(g.x)?g.x:f,m=g&&Q(g.y)?g.y:v;switch(u){case"x":return{from:{x:t.getGraphicAttribute("x",!0)},to:{x:y}};case"y":return{from:{y:t.getGraphicAttribute("y",!0)},to:{y:m}};default:return{from:{x:t.getGraphicAttribute("x",!0),y:t.getGraphicAttribute("y",!0)},to:{x:y,y:m}}}},mW=function(t,e,i){var n,r,a,o,s=t.getFinalAnimationAttributes();switch(null==e?void 0:e.direction){case"x":return{from:{scaleX:0},to:{scaleX:null!==(n=null==s?void 0:s.scaleX)&&void 0!==n?n:1}};case"y":return{from:{scaleY:0},to:{scaleY:null!==(r=null==s?void 0:s.scaleY)&&void 0!==r?r:1}};default:return{from:{scaleX:0,scaleY:0},to:{scaleX:null!==(a=null==s?void 0:s.scaleX)&&void 0!==a?a:1,scaleY:null!==(o=null==s?void 0:s.scaleY)&&void 0!==o?o:1}}}},_W=function(t,e,i){var n,r,a,o;switch(null==e?void 0:e.direction){case"x":return{from:{scaleX:null!==(n=t.getGraphicAttribute("scaleX",!0))&&void 0!==n?n:1},to:{scaleX:0}};case"y":return{from:{scaleY:null!==(r=t.getGraphicAttribute("scaleY",!0))&&void 0!==r?r:1},to:{scaleY:0}};default:return{from:{scaleX:null!==(a=t.getGraphicAttribute("scaleX",!0))&&void 0!==a?a:1,scaleY:null!==(o=t.getGraphicAttribute("scaleY",!0))&&void 0!==o?o:1},to:{scaleX:0,scaleY:0}}}},bW={symbol:["_mo_hide_","visible"]},xW=function(t,e,i){var n,r=Object.assign({},t.getPrevGraphicAttributes()),a=Object.assign({},t.getNextGraphicAttributes());e&&xt(e.excludeChannels).forEach((function(t){delete r[t],delete a[t]})),t.mark&&t.mark.markType&&(n=bW[t.mark.markType])&&n.forEach((function(t){delete r[t],delete a[t]})),Object.keys(a).forEach((function(t){mt(r[t],a[t])&&(delete r[t],delete a[t])}));var o=t.getFinalGraphicAttributes();return Object.keys(r).forEach((function(t){j(a[t])&&(j(o[t])||mt(r[t],o[t])?delete r[t]:a[t]=o[t])})),{from:r,to:a}},kW=function(t,e,i){var n,r=null!==(n=t.getFinalAnimationAttribute("angle"))&&void 0!==n?n:0;return{from:{angle:Nt(r/(2*Math.PI),0)?Math.round(r/(2*Math.PI))*Math.PI*2:Q(null==e?void 0:e.angle)?e.angle:"anticlockwise"===(null==e?void 0:e.orient)?Math.ceil(r/(2*Math.PI))*Math.PI*2:Math.floor(r/(2*Math.PI))*Math.PI*2},to:{angle:r}}},SW=function(t,e,i){var n,r=null!==(n=t.getGraphicAttribute("angle",!0))&&void 0!==n?n:0;return{from:{angle:r},to:{angle:Nt(r/(2*Math.PI),0)?Math.round(r/(2*Math.PI))*Math.PI*2:Q(null==e?void 0:e.angle)?e.angle:"anticlockwise"===(null==e?void 0:e.orient)?Math.ceil(r/(2*Math.PI))*Math.PI*2:Math.floor(r/(2*Math.PI))*Math.PI*2}}},AW=function(){xj.registerAnimationType("clipIn",XV)},MW=function(){xj.registerAnimationType("clipOut",KV)},wW=function(){xj.registerAnimationType("fadeIn",qV)},TW=function(){xj.registerAnimationType("fadeOut",ZV)},CW=function(){xj.registerAnimationType("growCenterIn",JV)},EW=function(){xj.registerAnimationType("growCenterOut",QV)},PW=function(){xj.registerAnimationType("growHeightIn",eW)},RW=function(){xj.registerAnimationType("growHeightOut",iW)},BW=function(){xj.registerAnimationType("growWidthIn",$V)},IW=function(){xj.registerAnimationType("growWidthOut",tW)},LW=function(){xj.registerAnimationType("growPointsIn",lW)},DW=function(){xj.registerAnimationType("growPointsOut",uW)},OW=function(){xj.registerAnimationType("growPointsXIn",hW)},FW=function(){xj.registerAnimationType("growPointsXOut",dW)},zW=function(){xj.registerAnimationType("growPointsYIn",fW)},HW=function(){xj.registerAnimationType("growPointsYOut",vW)},jW=function(){xj.registerAnimationType("growAngleIn",nW)},NW=function(){xj.registerAnimationType("growAngleOut",rW)},VW=function(){xj.registerAnimationType("growRadiusIn",aW)},WW=function(){xj.registerAnimationType("growRadiusOut",oW)},GW=function(){xj.registerAnimationType("moveIn",gW)},UW=function(){xj.registerAnimationType("moveOut",yW)},YW=function(){xj.registerAnimationType("scaleIn",mW)},XW=function(){xj.registerAnimationType("scaleOut",_W)},KW=function(){xj.registerAnimationType("rotateIn",kW)},qW=function(){xj.registerAnimationType("rotateOut",SW)},ZW=function(){xj.registerAnimationType("update",xW)},JW=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"encodeState",value:function(t,i,n){return y(e,"encodeState",this,3)([t,i,n]),this._updateComponentEncoders(t),this}},{key:"_updateComponentEncoders",value:function(t){this._encoders||(this._encoders={});var e=this.spec.encode[t];if(e&&"update"===t){var i=this.parameters(),n=uj(e)?null:Object.keys(e).reduce((function(t,n){return fj(e[n])&&(t[n]=hj(e[n].scale,i)),t}),{});this._encoders[t]={callback:function(t,i,r){var a=_j(e,t,i,r);if(j(a.size)){var o=n.x?Xj(n.x):void 0,s=n.y?Xj(n.y):void 0;j(o)&&j(s)?a.size=10:j(o)?a.size=s:j(s)&&(a.size=o),a.size=[o,s]}return j(a.shape)&&(a.shape="rect"),a}}}else this._encoders[t]=e}},{key:"_getEncoders",value:function(){var t;return null!==(t=this._encoders)&&void 0!==t?t:{}}},{key:"getAttributeTransforms",value:function(){return[{channels:["size","padding"],transform:function(t,e,i){if(Z(i.padding)&&i.padding>0)t.size=X(i.size)?i.size.map((function(t){return Math.max(t-i.padding,1)})):Math.max(i.size-i.padding,1);else if(X(i.padding)&&2===i.padding.length){var n=X(i.size)?i.size:[i.size,i.size];t.size=[Math.max(n[0]-i.padding[0],1),Math.max(n[1]-i.padding[1],1)]}else t.size=i.size},storedAttrs:"paddingAttrs"}].concat(wj.symbol)}},{key:"release",value:function(){y(e,"release",this,3)([]),this._encoders=null}}])}(EN);JW.markType=MH.cell;var QW=function(){return o((function t(e){var i=this;r(this,t),this._animations=[],this._additionalAnimateMarks=[],this.isEnabled=!0,this._onAnimationStart=function(t){i._additionalAnimateMarks=i._additionalAnimateMarks.filter((function(t){var e;return null===(e=null==t?void 0:t.animate)||void 0===e?void 0:e.isAnimating()})),0===i._animations.length&&0===i._additionalAnimateMarks.length&&i._view.emit(DH.ALL_ANIMATION_START,{}),i._animations=i._animations.concat({config:t.animationConfig,mark:t.mark})},this._onAnimationEnd=function(t){i._additionalAnimateMarks=i._additionalAnimateMarks.filter((function(t){var e;return null===(e=null==t?void 0:t.animate)||void 0===e?void 0:e.isAnimating()})),i._animations=i._animations.filter((function(e){return e.config!==t.animationConfig||e.mark!==t.mark})),0===i._animations.length&&0===i._additionalAnimateMarks.length&&i._view.emit(DH.ALL_ANIMATION_END,{})},this._view=e,this._view.addEventListener(DH.ANIMATION_START,this._onAnimationStart),this._view.addEventListener(DH.ANIMATION_END,this._onAnimationEnd)}),[{key:"stop",value:function(){return this._view.traverseMarkTree((function(t){var e,i;t.animate&&(null===(i=(e=t.animate).stop)||void 0===i||i.call(e))})),this._additionalAnimateMarks.forEach((function(t){var e,i;t.view&&t.animate&&(null===(i=(e=t.animate).stop)||void 0===i||i.call(e))})),this._additionalAnimateMarks=[],this}},{key:"pause",value:function(){return this._view.traverseMarkTree((function(t){var e,i;t.animate&&(null===(i=(e=t.animate).pause)||void 0===i||i.call(e))})),this._additionalAnimateMarks.forEach((function(t){var e,i;t.view&&t.animate&&(null===(i=(e=t.animate).pause)||void 0===i||i.call(e))})),this}},{key:"resume",value:function(){return this._view.traverseMarkTree((function(t){var e,i;t.animate&&(null===(i=(e=t.animate).resume)||void 0===i||i.call(e))})),this._additionalAnimateMarks.forEach((function(t){var e,i;t.view&&t.animate&&(null===(i=(e=t.animate).resume)||void 0===i||i.call(e))})),this}},{key:"enable",value:function(){return this.isEnabled=!0,this._view.traverseMarkTree((function(t){var e,i;t.animate&&(null===(i=(e=t.animate).enable)||void 0===i||i.call(e))})),this}},{key:"disable",value:function(){return this.isEnabled=!1,this._view.traverseMarkTree((function(t){var e,i;t.animate&&(null===(i=(e=t.animate).disable)||void 0===i||i.call(e))})),this._additionalAnimateMarks.forEach((function(t){var e,i;t.view&&t.animate&&(null===(i=(e=t.animate).stop)||void 0===i||i.call(e))})),this._additionalAnimateMarks=[],this}},{key:"enableAnimationState",value:function(t){return this._view.traverseMarkTree((function(e){var i,n;e.animate&&(null===(n=(i=e.animate).enableAnimationState)||void 0===n||n.call(i,t))})),this}},{key:"disableAnimationState",value:function(t){return this._view.traverseMarkTree((function(e){var i,n;e.animate&&(null===(n=(i=e.animate).disableAnimationState)||void 0===n||n.call(i,t))})),this}},{key:"isAnimating",value:function(){return 0!==this._animations.length||this._additionalAnimateMarks.some((function(t){var e;return(null===(e=null==t?void 0:t.animate)||void 0===e?void 0:e.isAnimating())||!1}))}},{key:"animate",value:function(){return this.isEnabled?(this._view.traverseMarkTree((function(t){t.isUpdated&&t.animate&&t.animate.animate(),t.cleanExitElements(),t.isUpdated=!1}),null,!0),this):this}},{key:"animateAddition",value:function(t){var e,i=null===(e=t.animate)||void 0===e?void 0:e.animate();return i&&i.isAnimating()&&this._additionalAnimateMarks.push(t),this}},{key:"release",value:function(){this._additionalAnimateMarks=[],this._animations=[],this._view.removeEventListener(DH.ALL_ANIMATION_START,this._onAnimationStart),this._view.removeEventListener(DH.ALL_ANIMATION_END,this._onAnimationEnd),this._view=null}}])}(),$W=function(){return o((function t(){r(this,t)}),[{key:"initAnimate",value:function(t){return this.animate=new QW(t),this.animate}}])}(),tG=function(t,e){if(!t)return null;if(t.from){var i=t.from,n=Object.keys(i);n.forEach((function(t){j(i[t])&&delete i[t]}));var r=yj(n,e.mark.markType)&&!N(i.segments);if(r){var a=e.items.map((function(t){return Object.assign({},t,{nextAttrs:Object.assign({},i)})}));t.from=e.transformElementItems(a,e.mark.markType,r)}}if(t.to){var o=t.to,s=Object.keys(o);s.forEach((function(t){j(o[t])&&delete o[t]}));var l=yj(s,e.mark.markType)&&!N(o.segments);if(l){var u=e.items.map((function(t){return Object.assign({},t,{nextAttrs:Object.assign({},o)})}));t.to=e.transformElementItems(u,e.mark.markType,l)}}return t};var eG=function(t,e,i,n,r){return H(i)?i(t.getDatum(),t,r):i};var iG=function(t){function e(t,i,a,o,s){var l;return r(this,e),(l=n(this,e,[t,i,a,o,s]))._interpolator=null==s?void 0:s.interpolator,l._element=null==s?void 0:s.element,l}return h(e,t),o(e,[{key:"onBind",value:function(){var t,e;this.from=null!==(t=this.from)&&void 0!==t?t:{},this.to=null!==(e=this.to)&&void 0!==e?e:{}}},{key:"getEndProps",value:function(){return this.to}},{key:"onUpdate",value:function(t,e,i){this._interpolator&&this._element&&this._interpolator.call(this,e,this.from,this.to,i,this._element.getDatum(),this._element,this.params.parameters)}}])}(Yh),nG=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"getEndProps",value:function(){return this.to}},{key:"onBind",value:function(){var t,e=this,i=null!==(t=this.target.constructor.NOWORK_ANIMATE_ATTR)&&void 0!==t?t:Pv,n=Object.keys(i).filter((function(t){return 0!==i[t]}));this.subAnimate.animate.preventAttrs(n);var r=Object.assign({},this.from),a=Object.assign({},this.to),o=[];Object.keys(a).forEach((function(t){n.includes(t)?(r[t]=a[t],e.from[t]=a[t]):j(r[t])?r[t]=e.target.getComputedAttribute(t):o.push(t)})),this.target.animates.forEach((function(t){t!==e.subAnimate.animate&&t.preventAttrs(o)})),this._fromAttribute=r,this._toAttribute=a}},{key:"onStart",value:function(){var t=this;if(this._fromAttribute){var e={};Object.keys(this._fromAttribute).forEach((function(i){t.subAnimate.animate.validAttr(i)&&(e[i]=t._fromAttribute[i])})),this.target.setAttributes(e,!1,{type:Al.ANIMATE_UPDATE,animationState:{ratio:0,end:!1}})}}},{key:"onEnd",value:function(){var t=this;if(this._toAttribute){var e={};Object.keys(this._toAttribute).forEach((function(i){t.subAnimate.animate.validAttr(i)&&(e[i]=t._toAttribute[i])})),this.target.setAttributes(e,!1,{type:Al.ANIMATE_END})}}},{key:"update",value:function(t,e,i){var n=this;0===this.updateCount&&this.onFirstRun(),this.updateCount+=1;var r=this.step.getLastProps();Object.keys(r).forEach((function(t){n.subAnimate.animate.validAttr(t)&&(i[t]=r[t])})),this.onUpdate(t,e,i),t&&this.onEnd()}},{key:"onUpdate",value:function(t,e,i){this.target.stepInterpolate(this.subAnimate,this.subAnimate.animate,i,this.step,e,t,this._toAttribute,this._fromAttribute)}}])}(Yh);Kh.mode|=wl.SET_ATTR_IMMEDIATELY;var rG=0,aG=function(t){var e;if(j(t)||j(t.prototype))return!1;var i=null!==(e=t.prototype)&&void 0!==e?e:{};return i instanceof Yh||"onBind"in i&&"onStart"in i&&"onEnd"in i&&"onUpdate"in i},oG=function(){return o((function t(e,i,n){r(this,t),this.id=rG++,this.isAnimating=!1,this.runnings=[],this.element=e,this.animationOptions=n,this.unit=i}),[{key:"callback",value:function(t){return this.callbackFunction=t,this}},{key:"animate",value:function(t,e){return this.isAnimating=!0,this.animateElement(t,e),0===this.runnings.length&&this.animationEnd(),this}},{key:"stop",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"end",e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.runnings.forEach((function(e){return e.stop(t)})),this.animationEnd(e),this}},{key:"pause",value:function(){return this.runnings.forEach((function(t){return t.pause()})),this}},{key:"resume",value:function(){return this.runnings.forEach((function(t){return t.resume()})),this}},{key:"startAt",value:function(t){var e=this;return this.runnings.forEach((function(i){var n=e.unit.initialDelay;i.startAt(n+t)})),this}},{key:"getTotalAnimationTime",value:function(){var t,e=this.unit.initialDelay+this.unit.loopDuration*this.unit.loopCount;return null!==(t=this.unit.totalTime)&&void 0!==t?t:e}},{key:"getEndAttributes",value:function(){return this.runnings.reduce((function(t,e){return Object.assign(t,e.getEndProps())}),{})}},{key:"animationEnd",value:function(){var t,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isAnimating=!1,this.runnings=null,e&&(null===(t=this.callbackFunction)||void 0===t||t.call(null))}},{key:"animateElement",value:function(t,e){var i=this,n=this.element.getGraphicItem();if(n){var r=n.animate();this.runnings.push(r),r.startAt(this.unit.initialDelay),r.wait(this.unit.loopDelay),this.unit.timeSlices.forEach((function(n){i.animateTimeSlice(r,n,t,e)})),r.wait(this.unit.loopDelayAfter),r.loop(this.unit.loopCount-1),Q(this.unit.totalTime)&&setTimeout((function(){r&&r.stop("end")}),this.unit.totalTime),r.onEnd((function(){i.runnings=i.runnings.filter((function(t){return t!==r})),0===i.runnings.length&&i.animationEnd()}))}}},{key:"animateTimeSlice",value:function(t,e,i,n){var r=this,a=e.delay,o=e.delayAfter,s=e.duration,l=e.effects;if(a>0&&t.wait(a),l.length<0)t.wait(s);else{var u=l.map((function(t,e){var a,o=null!==(a=t.type?function(t,e,i,n){var r=H(e.options)?e.options.call(null,t.getDatum(),t,n):e.options;if(!e.type||!xj.getAnimationType(e.type))return null;var a=xj.getAnimationType(e.type)(t,r,i);return tG(a,t)}(r.element,t,i,n):t.channel?function(t,e,i,n){var r=e.channel,a=null;return X(r)?a=r.reduce((function(e,i){return e.from[i]=t.getGraphicAttribute(i,!0),e.to[i]=t.getGraphicAttribute(i,!1),e}),{from:{},to:{}}):V(r)&&(a=Object.keys(r).reduce((function(e,i){var a,o,s=!j(null===(a=r[i])||void 0===a?void 0:a.from),l=!j(null===(o=r[i])||void 0===o?void 0:o.to);return(s||l)&&(e.from[i]=s?eG(t,0,r[i].from,0,n):void 0,e.to[i]=l?eG(t,0,r[i].to,0,n):t.getGraphicAttribute(i,!1)),e}),{from:{},to:{}})),tG(a,t)}(r.element,t,0,n):void 0)&&void 0!==a?a:{},l=o.custom||(null==t?void 0:t.custom),u=(null==o?void 0:o.customParameters)||(null==t?void 0:t.customParameters);o.from&&Object.keys(o.from).length&&r.unit&&r.animationOptions.timeline.controlOptions.immediatelyApply&&"component"!==r.element.mark.markType&&r.element.getGraphicItem().setAttributes(o.from);var c=aG(l);return j(l)||aG(l)?c?new l(o.from,o.to,s,t.easing,u):o.to?new nG(o.from,o.to,s,t.easing):void 0:new iG(o.from,o.to,s,t.easing,{interpolator:l,element:r.element,parameters:u})})).filter((function(t){return!j(t)}));1===u.length?t.play(u[0]):u.length>1&&t.play(new Sd(s,u))}o>0&&t.wait(o)}}])}();function sG(t){var e=[];return Object.keys(t).forEach((function(i){e=e.concat(lG(i,t[i]))})),e}function lG(t,e){var i=[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return xt(e).forEach((function(e){var r,a=function(t){var e,i,n,r,a,o,s,l,u,c,h,d;if(j(t.timeSlices)){var p=t;return{startTime:null!==(e=p.startTime)&&void 0!==e?e:QH,totalTime:p.totalTime,oneByOne:null!==(i=p.oneByOne)&&void 0!==i?i:nj,loop:null!==(n=p.loop)&&void 0!==n?n:ij,controlOptions:ft({},aj,null!==(r=p.controlOptions)&&void 0!==r?r:{}),timeSlices:[{duration:null!==(a=p.duration)&&void 0!==a?a:$H,delay:null!==(o=p.delay)&&void 0!==o?o:tj,delayAfter:null!==(s=p.delayAfter)&&void 0!==s?s:ej,effects:[{type:p.type,channel:p.channel,custom:p.custom,easing:null!==(l=p.easing)&&void 0!==l?l:rj,customParameters:p.customParameters,options:p.options}]}]}}var f=xt(t.timeSlices).filter((function(t){return t.effects&&xt(t.effects).filter((function(t){return t.channel||t.type})).length}));if(f.length)return{startTime:null!==(u=t.startTime)&&void 0!==u?u:QH,totalTime:t.totalTime,oneByOne:null!==(c=t.oneByOne)&&void 0!==c?c:nj,loop:null!==(h=t.loop)&&void 0!==h?h:ij,controlOptions:ft({},aj,null!==(d=t.controlOptions)&&void 0!==d?d:{}),timeSlices:f.map((function(t){var e,i;return{duration:t.duration,delay:null!==(e=t.delay)&&void 0!==e?e:tj,delayAfter:null!==(i=t.delayAfter)&&void 0!==i?i:ej,effects:xt(t.effects).filter((function(t){return t.channel||t.type})).map((function(t){var e;return{type:t.type,channel:t.channel,custom:t.custom,easing:null!==(e=t.easing)&&void 0!==e?e:rj,customParameters:t.customParameters,options:t.options}}))}})),partitioner:t.partitioner,sort:t.sort}}(e);a&&(i.push({state:t,id:null!==(r=a.id)&&void 0!==r?r:"".concat(t,"-").concat(n),timeline:a,originConfig:e}),n+=1)})),i}function uG(t,e,i){return H(t)?t.call(null,e.getDatum(),e,i):t}var cG,hG,dG,pG=function(){return o((function t(e){r(this,t),this.parallelArrangers=[this],this.totalTime=0,this.startTime=0,this.endTime=0,this.animators=e.filter((function(t){return!j(t)})),this.totalTime=this.animators.reduce((function(t,e){return Math.max(t,e.getTotalAnimationTime())}),0)}),[{key:"parallel",value:function(t){var e=Array.from(new Set(this.parallelArrangers.concat(t.parallelArrangers)));return e.forEach((function(t){t.parallelArrangers=e})),this.arrangeTime(),this}},{key:"after",value:function(t){return this.afterArranger=t,this.arrangeTime(),this}},{key:"arrangeTime",value:function(){var t=this.parallelArrangers.reduce((function(t,e){return Math.max(t,e.totalTime)}),this.totalTime),e=this.parallelArrangers.reduce((function(t,e){var i,n;return Math.max(t,null!==(n=null===(i=e.afterArranger)||void 0===i?void 0:i.endTime)&&void 0!==n?n:0)}),0);this.parallelArrangers.forEach((function(i){i.startTime=e,i.endTime=e+t,i.animators.forEach((function(t){t.startAt(e)}))}))}}])}(),fG=function(){return o((function t(e,i){r(this,t),this.state=null,this.immediateConfigs=[],this.isEnabled=!0,this.disabledStates=[],this.animators=new Map,this.elementRecorder=new WeakMap,this.timelineCount={},this.mark=e,this.configs=sG(null!=i?i:{})}),[{key:"getAnimationConfigs",value:function(t){var e;return this.isEnabled?(null!==(e=this.configs)&&void 0!==e?e:[]).filter((function(e){return e.state===t})):[]}},{key:"updateConfig",value:function(t){this.configs=sG(null!=t?t:{})}},{key:"updateState",value:function(t){this.state=t}},{key:"animate",value:function(){var t=this;if(this.isEnabled&&this.configs&&this.configs.length){var e=this.mark.getAllElements(),i=this.mark.parameters();return e.forEach((function(e){var i;e.isReserved&&e.diffState!==AH.exit&&(e.isReserved=!1);var n=null===(i=t.elementRecorder.get(e))||void 0===i?void 0:i.prevState;(t.configs.some((function(t){return n!==e.diffState&&t.state===n&&t.timeline.controlOptions.stopWhenStateChange}))||e.diffState===AH.exit&&n!==e.diffState)&&t.clearElementAnimation(e,!1)})),this.configs.forEach((function(n){t.animateByTimeline(n,e,i)})),this.mark.cleanExitElements(),this}}},{key:"runAnimationByState",value:function(t){var e=this;if(this.isEnabled){var i=this.configs.filter((function(e){return e.state===t})),n=this.mark.getAllElements(),r=this.mark.parameters(),a=i.reduce((function(t,i){return t.concat(e.animateByTimeline(i,n,r,!0))}),[]);return new pG(a)}}},{key:"stopAnimationByState",value:function(t){var e=this.animators.get(t);return e&&e.forEach((function(t){return t.stop("end")})),this}},{key:"pauseAnimationByState",value:function(t){var e=this.animators.get(t);return e&&e.forEach((function(t){return t.pause()})),this}},{key:"resumeAnimationByState",value:function(t){var e=this.animators.get(t);return e&&e.forEach((function(t){return t.resume()})),this}},{key:"run",value:function(t){var e=this;if(this.isEnabled){var i=lG(JH,t,this.immediateConfigs.length);this.immediateConfigs=this.immediateConfigs.concat(i);var n=this.mark.getAllElements(),r=this.mark.parameters(),a=i.reduce((function(t,i){return t.concat(e.animateByTimeline(i,n,r,!0))}),[]);return new pG(a)}}},{key:"stop",value:function(){return this.animators.forEach((function(t){t.forEach((function(t){return t.stop("end")}))})),this}},{key:"pause",value:function(){return this.animators.forEach((function(t){return t.forEach((function(t){return t.pause()}))})),this}},{key:"resume",value:function(){return this.animators.forEach((function(t){return t.forEach((function(t){return t.resume()}))})),this}},{key:"reverse",value:function(){return this}},{key:"restart",value:function(){return this}},{key:"record",value:function(){return this}},{key:"recordEnd",value:function(){return this}},{key:"isAnimating",value:function(){var t=!1;return this.animators.forEach((function(e){t=t||e.some((function(t){return t.isAnimating}))})),t}},{key:"isElementAnimating",value:function(t){var e,i=null===(e=this.elementRecorder.get(t))||void 0===e?void 0:e.count;return j(i)||Object.values(i).every((function(t){return 0===t}))}},{key:"getAnimatorCount",value:function(){var t=0;return this.animators.forEach((function(e){return t+=e.length})),t}},{key:"getAllAnimators",value:function(){var t=[];return this.animators.forEach((function(e){t.push.apply(t,m(e))})),t}},{key:"getElementAnimators",value:function(t,e){var i,n=xt(t),r=[];return e?r=null!==(i=this.animators.get(e))&&void 0!==i?i:[]:this.animators.forEach((function(t){r=r.concat(t)})),r.filter((function(t){return n.includes(t.element)}))}},{key:"enable",value:function(){return this.isEnabled=!0,this}},{key:"disable",value:function(){return this.isEnabled=!1,this.stop(),this.animators.clear(),this}},{key:"enableAnimationState",value:function(t){var e=xt(t);return this.disabledStates=this.disabledStates.filter((function(t){return!e.includes(t)})),this}},{key:"disableAnimationState",value:function(t){var e=xt(t);return this.disabledStates=this.disabledStates.concat(e),this}},{key:"release",value:function(){this.stop(),this.animators.clear(),this.configs=null,this.animators=null,this.elementRecorder=null,this.timelineCount=null}},{key:"animateByTimeline",value:function(t,e,i){var n,r=this,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=[],s=e.filter((function(e){var n=!(e.isReserved&&e.diffState===AH.exit),o=r.getAnimationState(e),s=!r.disabledStates.includes(o),l=a||o===t.state,u=!t.timeline.partitioner||t.timeline.partitioner(e.getDatum(),e,i);return n&&s&&l&&u}));if(s.length){j(this.timelineCount[t.id])&&(this.timelineCount[t.id]=0),t.timeline.sort&&s.sort((function(e,n){return t.timeline.sort(e.getDatum(),n.getDatum(),e,n,i)}));var u={width:this.mark.view.width(),height:this.mark.view.height(),group:null!==(n=this.mark.group)&&void 0!==n?n:null,mark:this.mark,view:this.mark.view,elementCount:s.length,elementIndex:0};s.forEach((function(e){var i;(null!==(i=r.animators.get(t.state))&&void 0!==i?i:[]).filter((function(i){return i.element===e&&i.animationOptions.id===t.id})).forEach((function(t){t.stop(null,!1),r.handleAnimatorEnd(t,!1)}))})),s.forEach((function(e,n){u.elementIndex=n;var a=Object.assign(l({},"VGRAMMAR_ANIMATION_PARAMETERS",u),i),c=r.getAnimationUnit(t.timeline,e,n,s.length,a);o.push(r.animateElement(t,c,e,u,a))}))}return o}},{key:"animateElement",value:function(t,e,i,n,r){var a,o,s=this,l=new oG(i,e,t);if(l.animate(n,r),l.isAnimating){i.diffState===AH.exit&&(i.isReserved=!0);var u=0===this.timelineCount[t.id];this.timelineCount[t.id]+=1;var c=null!==(a=this.elementRecorder.get(i))&&void 0!==a?a:{prevState:t.state,count:{}};c.prevState=t.state,c.count[t.state]=(null!==(o=c.count[t.state])&&void 0!==o?o:0)+1,this.elementRecorder.set(i,c);var h=this.animators.get(t.state);h?h.push(l):this.animators.set(t.state,[l]),l.callback((function(){s.handleAnimatorEnd(l)}));var d={mark:this.mark,animationState:t.state,animationConfig:t.originConfig};return u&&this.mark.emit(DH.ANIMATION_START,d),this.mark.emit(DH.ELEMENT_ANIMATION_START,d,i),l}}},{key:"getAnimationState",value:function(t){var e=cj(this.state,this.mark.parameters(),t.getDatum(),t);return null!=e?e:t.diffState}},{key:"getAnimationUnit",value:function(t,e,i,n,r){var a=[],o=uG(t.startTime,e,r),s=uG(t.totalTime,e,r),l=uG(t.oneByOne,e,r),u=uG(t.loop,e,r),c=0;t.timeSlices.forEach((function(t){var i,o=uG(t.delay,e,r),l=uG(t.delayAfter,e,r),u=null!==(i=uG(t.duration,e,r))&&void 0!==i?i:s/n,h=xt(t.effects).map((function(t){return Object.assign({},t,{customParameters:uG(t.customParameters,e,r)})}));a.push({effects:h,duration:u,delay:o,delayAfter:l}),c+=o+u+l}));var h=Z(l)?l:!0===l?c:0;return{initialDelay:o,loopCount:Z(u)?u:!0===u?1/0:1,loopDelay:h*i,loopDelayAfter:h*(n-i-1),loopAnimateDuration:c,loopDuration:c+h*(n-1),totalTime:s,timeSlices:a}}},{key:"clearElementAnimation",value:function(t){var e=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.animators.forEach((function(n){n.forEach((function(n){n.element===t&&(n.animationOptions.state===AH.exit?n.stop("start",!1):n.stop("end",!1),e.handleAnimatorEnd(n,i))}))})),this.elementRecorder.delete(t)}},{key:"clearAllElements",value:function(){var t=this,e=this.mark.getAllElements();e&&e.forEach((function(i,n){t.clearElement(i,n===e.length-1)}))}},{key:"clearElement",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.clearElementAnimation(t),t.getGraphicItem()&&(t.clearGraphicAttributes(),t.diffState===AH.exit&&(t.isReserved=!1),e&&this.mark.cleanExitElements())}},{key:"handleAnimatorEnd",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=t.element,n=t.animationOptions,r=n.state,a=r===JH,o=this.elementRecorder.get(i).count;o[r]-=1,this.animators.set(r,this.animators.get(r).filter((function(e){return e!==t}))),0===this.animators.get(r).length&&this.animators.delete(r),this.timelineCount[n.id]-=1;var s=0===this.timelineCount[n.id],l=a?this.immediateConfigs.find((function(t){return t.id===n.id})).originConfig:this.configs.find((function(t){return t.id===n.id})).originConfig;s&&(delete this.timelineCount[n.id],a&&(this.immediateConfigs=this.immediateConfigs.filter((function(t){return t.id!==n.id})))),e&&(0===Object.keys(this.timelineCount).length?this.clearAllElements():r===AH.exit&&0===o[AH.exit]&&this.clearElement(i));var u={mark:this.mark,animationState:r,animationConfig:l};s&&this.mark.emit(DH.ANIMATION_END,u),this.mark.emit(DH.ELEMENT_ANIMATION_END,u,i)}}])}(),vG=function(){return o((function t(){r(this,t),this.animate=new fG(this,{})}),[{key:"initAnimate",value:function(t){this.animate||(this.animate=new fG(this,t.animation),this.needAnimate()&&this.animate.updateState(t.animationState))}},{key:"reuseAnimate",value:function(t){this.animate=t.animate,this.animate.mark=this}},{key:"updateAnimate",value:function(t){this.animate.updateConfig(t.animation),this.animate.updateState(t.animationState)}}])}(),gG=function(){xj.registerStageEventPlugin("gesture",ZS)},yG=function(){bt(WN,$W),bt(EN,vG)},mG=["pointerdown","pointerup","pointerupoutside","pointertap","pointerover","pointermove","pointerenter","pointerleave","pointerout","mousedown","mouseup","mouseupoutside","rightdown","rightup","rightupoutside","click","dblclick","mousemove","mouseover","mouseout","mouseenter","mouseleave","wheel","touchstart","touchend","touchendoutside","touchmove","touchcancel","tap","dragstart","drag","dragenter","dragleave","dragover","dragend","drop","pan","panstart","panend","press","pressup","pressend","pinch","pinchstart","pinchend","swipe"];!function(t){t.initialized="initialized",t.rendered="rendered",t.renderFinished="renderFinished",t.animationFinished="animationFinished",t.regionSeriesDataFilterOver="regionSeriesDataFilterOver",t.afterInitData="afterInitData",t.afterInitEvent="afterInitEvent",t.afterInitMark="afterInitMark",t.rawDataUpdate="rawDataUpdate",t.viewDataFilterOver="viewDataFilterOver",t.viewDataUpdate="viewDataUpdate",t.viewDataStatisticsUpdate="viewDataStatisticsUpdate",t.markDeltaYUpdate="markDeltaYUpdate",t.viewDataLabelUpdate="viewDataLabelUpdate",t.scaleDomainUpdate="scaleDomainUpdate",t.scaleUpdate="scaleUpdate",t.dataZoomChange="dataZoomChange",t.drill="drill",t.layoutStart="layoutStart",t.layoutEnd="layoutEnd",t.layoutRectUpdate="layoutRectUpdate",t.playerPlay="playerPlay",t.playerPause="playerPause",t.playerEnd="playerEnd",t.playerChange="playerChange",t.playerForward="playerForward",t.playerBackward="playerBackward",t.scrollBarChange="scrollBarChange",t.brushStart="brushStart",t.brushChange="brushChange",t.brushEnd="brushEnd",t.brushClear="brushClear",t.brushActive="brushActive",t.legendSelectedDataChange="legendSelectedDataChange",t.legendFilter="legendFilter",t.legendItemClick="legendItemClick",t.legendItemHover="legendItemHover",t.legendItemUnHover="legendItemUnHover",t.tooltipShow="tooltipShow",t.tooltipHide="tooltipHide",t.tooltipRelease="tooltipRelease",t.afterResize="afterResize",t.afterRender="afterRender",t.afterLayout="afterLayout"}(cG||(cG={})),function(t){t.chart="chart",t.window="window",t.canvas="canvas"}(hG||(hG={})),function(t){t.vchart="vchart",t.chart="chart",t.model="model",t.mark="mark"}(dG||(dG={}));var _G=[dG.mark,dG.model,dG.chart,dG.vchart],bG=function(t,e){var i,n;return t===e||!j(t)&&!j(e)&&(t.value===e.value&&(null===(i=t.axis)||void 0===i?void 0:i.id)===(null===(n=e.axis)||void 0===n?void 0:n.id))},xG=function(t,e,i,n){var r,a,o,s=e.getScale(),l=WB(s.type),u=[],c=e.getOption().getChart().getSeriesInIndex(e.getSpecInfo().seriesIndexes),h=function(r){if(r.coordinate===i){var a=xt(n(r)),c=null===(o=r.getViewData())||void 0===o?void 0:o.latestData;if(a&&c)if(l){var h=[],d=[];c.forEach((function(e,i){var n;(null===(n=e[a[0]])||void 0===n?void 0:n.toString())===(null==t?void 0:t.toString())&&(h.push(e),d.push(i))})),u.push({series:r,datum:h,key:kG(r,d)})}else if(N(a[1])){var p=[],f=[];c.forEach((function(e,i){var n;((null===(n=e[a[0]])||void 0===n?void 0:n.toString())===(null==t?void 0:t.toString())||N(e[a[0]])&&N(e[a[1]])&&t>=e[a[0]]&&t<e[a[1]])&&(p.push(e),f.push(i))})),u.push({series:r,datum:p,key:kG(r,f)})}else{var v=function(t,e){var i=t.tooltipFilterRange,n="function"==typeof i?i({scale:e}):i;return Q(n)?[-n,n]:n}(e.getSpec(),s),g=[],y=[];if(v)c.forEach((function(e,i){if(N(e[a[0]])){var n=e[a[0]]-t;n>=v[0]&&n<=v[1]&&(g.push(e),y.push(i))}}));else{var m=1/0,_=0;c.forEach((function(e,i){if(N(e[a[0]])){var n=Math.abs(e[a[0]]-t),r=Math.sign(e[a[0]]-t);n<m?(m=n,g=[e],y=[i],_=r):n===m&&r===_&&(g.push(e),y.push(i))}}))}u.push({series:r,datum:g,key:kG(r,y)})}}};try{for(var d=C(c),p=d.next();!p.done;p=d.next()){h(p.value)}}catch(t){r={error:t}}finally{try{p&&!p.done&&(a=d.return)&&a.call(d)}finally{if(r)throw r.error}}return u},kG=function(t,e){return"".concat(t.id,"_").concat(e.join("_"))},SG=function(t,e,i){var n=t.getAllComponents().filter((function(n){return"axes"===n.specKey&&e(n)&&function(t,e,i){var n=t.getRegionsInIds(xt(e.layout.layoutBindRegionID));return null==n?void 0:n.some((function(t){var e=t.getLayoutRect(),n=t.getLayoutStartPoint();return function(t,e,i){return t.x>=e.x&&t.x<=i.x&&t.y>=e.y&&t.y<=i.y}(i,{x:n.x,y:n.y},{x:e.width+n.x,y:e.height+n.y})}))}(t,n,i)}));return n.length?n:null},AG=function(t,e){if(!t)return null;var i=SG(t,(function(t){return"angle"===t.getOrient()}),e),n=SG(t,(function(t){return"radius"===t.getOrient()}),e);if(!(i&&i.length||n&&n.length))return null;var r=[],a=function(t){return t.getDimensionField()[0]},o=e.x,s=e.y;return i&&i.forEach((function(t){var e,i=t.getScale();if(i&&WB(i.type)){var l=i.domain(),u=i.range(),c=t.getCenter(),h={x:o-t.getLayoutStartPoint().x-c.x,y:s-t.getLayoutStartPoint().y-c.y},d=GO({x:1,y:0},h);d=function(t,e){var i=2*Math.PI,n=At(e),r=St(e);return t<n?t+=Math.ceil((n-t)/i)*i:t>r&&(t-=Math.ceil((t-r)/i)*i),t}(d,u);var p=UO(h),f=null===(e=n[0])||void 0===e?void 0:e.getScale(),v=null==f?void 0:f.range();if((d-(null==u?void 0:u[0]))*(d-(null==u?void 0:u[1]))>0||(p-(null==v?void 0:v[0]))*(p-(null==v?void 0:v[1]))>0)return;var g=t.invert(d);if(j(g))return;var y=l.findIndex((function(t){return(null==t?void 0:t.toString())===g.toString()}));y<0&&(y=void 0);var m=xG(g,t,"polar",a);r.push({index:y,value:g,position:i.scale(g),axis:t,data:m})}})),n&&n.forEach((function(t){var e,n=t.getScale(),l=null==n?void 0:n.range();if(n&&WB(n.type)){var u=t.getCenter(),c={x:o-t.getLayoutStartPoint().x-u.x,y:s-t.getLayoutStartPoint().y-u.y},h=GO({x:1,y:0},c);h<-Math.PI/2&&(h=2*Math.PI+h);var d=UO(c),p=null===(e=i[0])||void 0===e?void 0:e.getScale(),f=null==p?void 0:p.range();if((h-(null==f?void 0:f[0]))*(h-(null==f?void 0:f[1]))>0||(d-(null==l?void 0:l[0]))*(d-(null==l?void 0:l[1]))>0)return;var v=n.invert(d);if(j(v))return;var g=n.domain().findIndex((function(t){return(null==t?void 0:t.toString())===v.toString()}));g<0&&(g=void 0);var y=xG(v,t,"polar",a);r.push({index:g,value:v,position:n.scale(v),axis:t,data:y})}})),r.length?r:null};function MG(t){return"bottom"===t||"top"===t}function wG(t){return"left"===t||"right"===t}function TG(t){return"z"===t}function CG(t,e){return gF(t.orient)||e&&e.includes(t.orient)?t.orient:"left"}function EG(t){return"top"===t||"bottom"===t?"horizontal":"vertical"}function PG(t,e){var i,n=null!==(i=t.type)&&void 0!==i?i:function(t,e){return e?MG(t)?"linear":"band":MG(t)?"band":"linear"}(t.orient,e);return{axisType:n,componentName:"".concat(B.cartesianAxis,"-").concat(n)}}var RG,BG,IG=function(t){return t.fieldX[0]},LG=function(t){return t.fieldY[0]},DG=function(t){var e;return[t.fieldX[0],null!==(e=t.fieldX2)&&void 0!==e?e:t.fieldX[1]]},OG=function(t){var e;return[t.fieldY[0],null!==(e=t.fieldY2)&&void 0!==e?e:t.fieldY[1]]},FG=function(t,e){return t?e?IG:DG:e?LG:OG},zG=function(t,e,i){var n,r;if(!t)return null;var a=e.x,o=e.y,s=null!==(n=SG(t,(function(t){return MG(t.getOrient())}),e))&&void 0!==n?n:[],l=null!==(r=SG(t,(function(t){return wG(t.getOrient())}),e))&&void 0!==r?r:[];if(!s.length&&!l.length)return null;var u=new Set,c=new Set,h=new Set;[s,l].forEach((function(t){return t.forEach((function(t){WB(t.getScale().type)?u.add(t):c.add(t),i&&t.getSpec().hasDimensionTooltip&&h.add(t)}))}));var d=[],p=function(t){var e="x"===t,i=e?a:o;(e?s:l).forEach((function(t){if(h.size>0){if(h.has(t))(n=HG(t,i,FG(e,WB(t.getScale().type))))&&d.push(n)}else{var n,r=u.size>0;if((r?u:c).has(t))(n=HG(t,i,FG(e,r)))&&d.push(n)}}))};return"horizontal"===t.getSpec().direction?(p("y"),0===d.length&&p("x")):(p("x"),0===d.length&&p("y")),d.length?d:null},HG=function(t,e,i){var n=t.positionToData(e,!0);return j(n)?null:jG(t,n,i)},jG=function(t,e,i){var n=t.getScale();if(j(e))return null;var r=n.domain().findIndex((function(t){return(null==t?void 0:t.toString())===e.toString()}));r<0&&(r=void 0);var a=xG(e,t,"cartesian",null!=i?i:MG(t.getOrient())?IG:LG);return{index:r,value:e,position:n.scale(e),axis:t,data:a}},NG=function(){function t(t,e){this._eventDispatcher=t,this._mode=e}return Object.defineProperty(t.prototype,"chart",{get:function(){var t,e;return this._chart||(this._chart=null===(e=(t=this._eventDispatcher.globalInstance).getChart)||void 0===e?void 0:e.call(t)),this._chart},enumerable:!1,configurable:!0}),t.prototype.register=function(t,e){var i,n;(null!==(n=null===(i=this.chart)||void 0===i?void 0:i.getOption().onError)&&void 0!==n?n:Ok)("Method not implemented.")},t.prototype.unregister=function(){var t,e;(null!==(e=null===(t=this.chart)||void 0===t?void 0:t.getOption().onError)&&void 0!==e?e:Ok)("Method not implemented.")},t.prototype.getTargetDimensionInfo=function(t,e){var i,n,r=null!==(i=zG(this.chart,{x:t,y:e}))&&void 0!==i?i:[],a=null!==(n=AG(this.chart,{x:t,y:e}))&&void 0!==n?n:[],o=[].concat(r,a);return 0===o.length?null:o},t.prototype.dispatch=function(t,e){var i,n=null===(i=this.chart)||void 0===i?void 0:i.getAllComponents().filter((function(t){return"axes"===t.specKey&&(!(null==e?void 0:e.filter)||e.filter(t))})),r=n.filter((function(t){return WB(t.getScale().type)})),a=r.length?r:n.filter((function(t){var e=t.getOrient();return MG(e)||"angle"===e})),o=[];return a.forEach((function(e){var i=jG(e,t);i&&o.push(i)})),this._callback.call(null,{action:"enter",dimensionInfo:o}),o},t}(),VG=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onClick=function(t){if(t){var i=t.event.viewX,n=t.event.viewY,r=e.getTargetDimensionInfo(i,n);r&&e._callback.call(null,A(A({},t),{action:"click",dimensionInfo:r.slice()}))}},e}return S(e,t),e.prototype.register=function(t,e){this._callback=e.callback,this._eventDispatcher.register("pointertap",{query:A(A({},e.query),{source:hG.chart}),callback:this.onClick})},e.prototype.unregister=function(){this._eventDispatcher.unregister("pointertap",{query:null,callback:this.onClick})},e}(NG),WG=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._cacheDimensionInfo=null,e.onMouseMove=function(t){if(t){var i=t.event.viewX,n=t.event.viewY,r=e.getTargetDimensionInfo(i,n);null===r&&null!==e._cacheDimensionInfo?(e._callback.call(null,A(A({},t),{action:"leave",dimensionInfo:e._cacheDimensionInfo.slice()})),e._cacheDimensionInfo=r):null===r||null!==e._cacheDimensionInfo&&r.length===e._cacheDimensionInfo.length&&!r.some((function(t,i){return!bG(t,e._cacheDimensionInfo[i])}))?null!==r&&e._callback.call(null,A(A({},t),{action:"move",dimensionInfo:r.slice()})):(e._callback.call(null,A(A({},t),{action:"enter",dimensionInfo:r.slice()})),e._cacheDimensionInfo=r)}},e.onMouseOut=function(t){t&&(e._callback.call(null,A(A({},t),{action:"leave",dimensionInfo:e._cacheDimensionInfo?e._cacheDimensionInfo.slice():[]})),e._cacheDimensionInfo=null)},e}return S(e,t),e.prototype.register=function(t,e){this._callback=e.callback,this._eventDispatcher.register("pointermove",{query:A(A({},e.query),{source:hG.chart}),callback:this.onMouseMove}),this._eventDispatcher.register("pointerout",{query:A(A({},e.query),{source:hG.canvas}),callback:this.onMouseOut}),Nk(this._mode)&&this._eventDispatcher.register("pointerdown",{query:A(A({},e.query),{source:hG.chart}),callback:this.onMouseMove})},e.prototype.unregister=function(){this._eventDispatcher.unregister("pointermove",{query:null,callback:this.onMouseMove}),Nk(this._mode)&&this._eventDispatcher.unregister("pointerdown",{query:null,callback:this.onMouseMove})},e}(NG);t.DimensionEventEnum=void 0,(RG=t.DimensionEventEnum||(t.DimensionEventEnum={})).dimensionHover="dimensionHover",RG.dimensionClick="dimensionClick";var GG=((BG={})[t.DimensionEventEnum.dimensionHover]=WG,BG[t.DimensionEventEnum.dimensionClick]=VG,BG),UG=function(){function t(t,e){this._composedEventMap=new Map,this._eventDispatcher=t,this._mode=e}return t.prototype.getComposedEventMap=function(){return this._composedEventMap},t.prototype.on=function(t,e,i){var n="function"==typeof e?{query:null,callback:e}:{query:e,callback:i};if(GG[t]){var r=new GG[t](this._eventDispatcher,this._mode);r.register(t,n),this._composedEventMap.set(i,{eventType:t,event:r})}else this._eventDispatcher.register(t,n);return this},t.prototype.off=function(t,e,i){var n,r,a,o,s=null!=i?i:e;if(GG[t])if(s)null===(a=this._composedEventMap.get(s))||void 0===a||a.event.unregister(),this._composedEventMap.delete(s);else try{for(var l=C(this._composedEventMap.entries()),u=l.next();!u.done;u=l.next()){var c=u.value;c[1].eventType===t&&(null===(o=this._composedEventMap.get(c[0]))||void 0===o||o.event.unregister(),this._composedEventMap.delete(c[0]))}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}else if(s){var h={callback:s,query:null,filter:{nodeName:null,type:t,level:null,source:e.source,markName:null,filter:null,userId:null}};this._eventDispatcher.unregister(t,h)}else this._eventDispatcher.unregister(t);return this},t.prototype.emit=function(t,e,i){return this._eventDispatcher.dispatch(t,e,i),this},t.prototype.prevent=function(t,e){return this._eventDispatcher.prevent(t,e),this},t.prototype.allow=function(t){return this._eventDispatcher.allow(t),this},t.prototype.release=function(){this._eventDispatcher.clear(),this._composedEventMap.clear()},t}(),YG=function(){function t(){this._map=new Map,this._levelNodes=new Map,this._levelNodes.set(dG.vchart,[]),this._levelNodes.set(dG.chart,[]),this._levelNodes.set(dG.model,[]),this._levelNodes.set(dG.mark,[])}return t.prototype.addHandler=function(t,e){var i,n={level:e,handler:t};return null===(i=this._levelNodes.get(e))||void 0===i||i.push(n),this._map.set(t.callback,n),this},t.prototype.removeHandler=function(t){var e=this._map.get(t.callback);if(!e)return this;this._map.delete(t.callback);var i=this._levelNodes.get(e.level),n=null==i?void 0:i.findIndex((function(e){return e.handler.callback===t.callback}));return void 0!==n&&n>=0&&(null==i||i.splice(n,1)),this},t.prototype.preventHandler=function(t){return t&&(t.prevented=!0),this},t.prototype.allowHandler=function(t){return t&&(t.prevented=!1),this},t.prototype.getHandlers=function(t){var e;return(null===(e=this._levelNodes.get(t))||void 0===e?void 0:e.map((function(t){return t.handler})))||[]},t.prototype.getAllHandlers=function(){return Array.from(this._map.values()).map((function(t){return t.handler}))||[]},t.prototype.getCount=function(){return this._map.size},t.prototype.release=function(){this._map.clear(),this._levelNodes.clear()},t}(),XG={cartesianAxis:"axis","cartesianAxis-band":"axis","cartesianAxis-linear":"axis","cartesianAxis-time":"axis",polarAxis:"axis","polarAxis-band":"axis","polarAxis-linear":"axis",discreteLegend:"legend",continuousLegend:"legend",colorLegend:"legend",sizeLegend:"legend"},KG=function(){function t(t,e){var i=this;this._viewBubbles=new Map,this._windowBubbles=new Map,this._canvasBubbles=new Map,this._viewListeners=new Map,this._windowListeners=new Map,this._canvasListeners=new Map,this._onDelegate=function(t){var e,n,r=i.globalInstance.getChart(),a=N(t.modelId)&&(null==r?void 0:r.getModelById(t.modelId))||void 0,o=N(t.markId)&&(null==r?void 0:r.getMarkById(t.markId))||null,s=new Map,l=null===(e=t.item)||void 0===e?void 0:e.mark;for(l&&N(l.id())&&s.set(l.id(),t.item);null==l?void 0:l.elements;){var u=l.id();N(u)&&!s.has(u)&&s.set(u,l.elements[0]),l=l.group}var c=st(t.event,"target"),h=t.datum;a&&"component"===a.modelType&&(h=null!==(n=a.getDatum(c))&&void 0!==n?n:h);var d={event:t.event,item:t.item,source:t.source,datum:h,itemMap:s,chart:r,model:a,mark:null!=o?o:void 0,node:st(t.event,"target")};i.dispatch(t.type,d)},this._onDelegateInteractionEvent=function(t){var e=i.globalInstance.getChart(),n=t.event,r=null;n.elements&&(r=n.elements);var a={event:t.event,chart:e,items:r,datums:r&&r.map((function(t){return t.getDatum()}))};i.dispatch(t.type,a)},this.globalInstance=t,this._compiler=e}return t.prototype.register=function(t,e){var i,n,r,a,o;this._parseQuery(e);var s=this.getEventBubble((null===(i=e.filter)||void 0===i?void 0:i.source)||hG.chart),l=this.getEventListeners((null===(n=e.filter)||void 0===n?void 0:n.source)||hG.chart);if(s.get(t)||s.set(t,new YG),s.get(t).addHandler(e,null===(r=e.filter)||void 0===r?void 0:r.level),this._isValidEvent(t)&&!l.has(t)){var u=this._onDelegate.bind(this);this._compiler.addEventListener(null===(a=e.filter)||void 0===a?void 0:a.source,t,u),l.set(t,u)}else if(this._isInteractionEvent(t)&&!l.has(t)){u=this._onDelegateInteractionEvent.bind(this);this._compiler.addEventListener(null===(o=e.filter)||void 0===o?void 0:o.source,t,u),l.set(t,u)}return this},t.prototype.unregister=function(t,e){var i,n,r,a,o,s=!1,l=this.getEventBubble((null===(i=null==e?void 0:e.filter)||void 0===i?void 0:i.source)||hG.chart),u=this.getEventListeners((null===(n=null==e?void 0:e.filter)||void 0===n?void 0:n.source)||hG.chart);e?(null==(o=l.get(t))||o.removeHandler(e),0===(null==o?void 0:o.getCount())&&(null==o||o.release(),l.delete(t),s=!0),(null===(r=null==e?void 0:e.wrappedCallback)||void 0===r?void 0:r.cancel)&&e.wrappedCallback.cancel()):(null==(o=l.get(t))||o.release(),l.delete(t),s=!0);if(s&&this._isValidEvent(t)){var c=u.get(t);this._compiler.removeEventListener((null===(a=null==e?void 0:e.filter)||void 0===a?void 0:a.source)||hG.chart,t,c),u.delete(t)}return this},t.prototype.dispatch=function(t,e,i){var n=this.getEventBubble(e.source||hG.chart).get(t);if(!n)return this;var r=!1;if(i){var a=n.getHandlers(i);r=this._invoke(a,t,e)}else for(var o=0;!r&&o<_G.length;)r=this._invoke(n.getHandlers(_G[o]),t,e),o++;return this},t.prototype.prevent=function(t,e){var i=this;return["canvas","chart","window"].forEach((function(n){var r=i.getEventBubble(n).get(t);r&&r.getAllHandlers().forEach((function(t){e?_G.indexOf(t.filter.level)<_G.indexOf(e.level)&&t.callback!==e.handler&&r.preventHandler(t):r.preventHandler(t)}))})),this},t.prototype.allow=function(t){var e=this;return["canvas","chart","window"].forEach((function(i){var n=e.getEventBubble(i).get(t);n&&n.getAllHandlers().forEach((function(t){return n.allowHandler(t)}))})),this},t.prototype.clear=function(){var t=this;[hG.chart,hG.window,hG.canvas].forEach((function(e){var i,n,r=t.getEventListeners(e);try{for(var a=C(r.entries()),o=a.next();!o.done;o=a.next()){var s=o.value;t._compiler.removeEventListener(e,s[0],s[1])}}catch(t){i={error:t}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}r.clear()})),[this._viewBubbles,this._windowBubbles,this._canvasBubbles].forEach((function(t){var e,i;try{for(var n=C(t.values()),r=n.next();!r.done;r=n.next()){r.value.release()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(i=n.return)&&i.call(n)}finally{if(e)throw e.error}}t.clear()}))},t.prototype.release=function(){this.clear(),this.globalInstance=null,this._compiler=null},t.prototype._filter=function(t,e,i){var n,r,a;if(H(t.filter)&&!t.filter(i))return!1;if(t.nodeName&&st(i,"node.name")!==t.nodeName)return!1;if(t.markName&&(null===(n=null==i?void 0:i.mark)||void 0===n?void 0:n.name)!==t.markName)return!1;var o=null===(r=i.model)||void 0===r?void 0:r.type;return XG[o]&&(o=XG[o]),(!t.type||o===t.type)&&(!("mark"===t.level&&!t.type&&!(null==i?void 0:i.mark))&&(!("model"===t.level&&!t.type&&!(null==i?void 0:i.model))&&(!N(t.userId)||(null===(a=i.model)||void 0===a?void 0:a.userId)===t.userId)))},t.prototype._prepareParams=function(t,e){if(t.markName&&e.mark&&e.itemMap){var i=e.mark.getProductId(),n=e.itemMap.get(i),r=null==n?void 0:n.getDatum();return A(A({},e),{item:n,datum:r})}return A({},e)},t.prototype._invoke=function(t,e,i){var n=this,r=t.map((function(t){var r,a,o,s=t.filter;if(!t.prevented&&(!t.query||n._filter(s,e,i))){var l=(t.wrappedCallback||t.callback).call(null,n._prepareParams(s,i)),u=null!=l?l:null===(r=t.query)||void 0===r?void 0:r.consume;return u&&(null===(a=i.event)||void 0===a||a.stopPropagation(),null===(o=i.event)||void 0===o||o.preventDefault()),!!u}}));return r.some((function(t){return!0===t}))},t.prototype._getQueryLevel=function(t){return t?t.level?t.level:N(t.id)?dG.model:dG.vchart:dG.vchart},t.prototype._parseQuery=function(t){var e,i=t.query;(null==i?void 0:i.throttle)?t.wrappedCallback=Zt(t.callback,i.throttle):(null==i?void 0:i.debounce)&&(t.wrappedCallback=qt(t.callback,i.debounce));var n=this._getQueryLevel(i),r=null,a=hG.chart,o=null,s=null,l=null;return(null==i?void 0:i.nodeName)&&(o=i.nodeName),(null==i?void 0:i.markName)&&(s=i.markName),!(null==i?void 0:i.type)||n!==dG.model&&n!==dG.mark||(r=i.type),(null==i?void 0:i.source)&&(a=i.source),N(null==i?void 0:i.id)&&(l=null==i?void 0:i.id,n=dG.model),t.filter={level:n,markName:s,type:r,source:a,nodeName:o,userId:l,filter:null!==(e=null==i?void 0:i.filter)&&void 0!==e?e:null},t},t.prototype.getEventBubble=function(t){switch(t){case hG.chart:return this._viewBubbles;case hG.window:return this._windowBubbles;case hG.canvas:return this._canvasBubbles;default:return this._viewBubbles}},t.prototype.getEventListeners=function(t){switch(t){case hG.chart:return this._viewListeners;case hG.window:return this._windowListeners;case hG.canvas:return this._canvasListeners;default:return this._viewListeners}},t.prototype._isValidEvent=function(t){return mG.includes(t)||Object.values(DH).includes(t)},t.prototype._isInteractionEvent=function(t){var e;return t&&(e=t.split(":")[0])&&xj.hasInteraction(e)},t}();function qG(t,e,i){t.getTransform(e)||t.registerTransform(e,i)}function ZG(t,e,i){t.getParser(e)||t.registerParser(e,i)}var JG,QG=new Map;function $G(){JG||(ZG(JG=new Ss,"geojson",ns),ZG(JG,"topojson",as),qG(JG,"simplify",Ao))}function tU(t,e,i){void 0===i&&(i={type:"geojson",centroid:!0}),QG.has(t)&&Dk("map type of '".concat(t,"' already exists, will be overwritten.")),$G();var n=new Ms(JG),r=ft({},{centroid:!0,simplify:!1},i);"topojson"===i.type?n.parse(e,{type:"topojson",options:r}):n.parse(e,{type:"geojson",options:r});var a=i.simplify;!0===a?n.transform({type:"simplify"}):V(a)&&n.transform({type:"simplify",options:a}),QG.set(t,n)}function eU(t){QG.has(t)?QG.delete(t):Dk("map type of '".concat(t,"' does not exists."))}function iU(t,e){void 0===e&&(e=!1);var i=e;return t.latestData instanceof Ms&&(i=!1),i?ct(t.latestData):t.latestData&&t.latestData.slice()}var nU,rU,aU,oU=function(t,e){return 0===t.length?[]:1===t.length?iU(t[0],null==e?void 0:e.deep):t.map((function(t){return iU(t,null==e?void 0:e.deep)}))};function sU(t,e,i){qG(e=e instanceof Ss?e:t.dataSet,"copyDataView",oU);var n=new Ms(e,i);return n.parse([t],{type:"dataview"}),n.transform({type:"copyDataView",level:nU.copyDataView}),n}function lU(t,e,i){var n;if(void 0===i&&(i=[]),t instanceof Ms)return t;var r,a=t.id,o=t.values,s=void 0===o?[]:o,l=t.fromDataIndex,u=t.fromDataId,c=t.transforms,h=void 0===c?[]:c,d=t.parser?ct(t.parser):{clone:!0},p=ct(t.fields);d.clone=!(!1===d.clone);var f=i.find((function(t){return t.name===a}));if(f)r=f;else{var v={name:a};if(p&&(v.fields=p),r=new Ms(e,v),"string"==typeof u){if(!(g=i.find((function(t){return t.name===u}))))return Dk("no data matches fromDataId ".concat(u)),null;r.parse([g],{type:"dataview"}),r.transform({type:"copyDataView"})}else if("number"==typeof l){var g;if(!(g=i[l]))return Dk("no data matches fromDataIndex ".concat(l)),null;r.parse([g],{type:"dataview"}),r.transform({type:"copyDataView"})}else Array.isArray(s)?r.parse(s,d):!Y(s)||d&&!["csv","dsv","tsv"].includes(d.type)?(r.parse([]),Dk("values should be array")):r.parse(s,null!==(n=d)&&void 0!==n?n:{type:"csv"});h&&h.length&&h.forEach((function(t){e.getTransform(t.type)&&r.transform(t)}))}return r}function uU(t,e,i){t&&(e.fields&&t.setFields(e.fields,i),t.parseNewData(e.values,e.parser))}function cU(e){switch(e){case t.RenderModeEnum["desktop-browser"]:case t.RenderModeEnum["mobile-browser"]:return"browser";case t.RenderModeEnum.node:case t.RenderModeEnum.worker:return"node";case t.RenderModeEnum.miniApp:case t.RenderModeEnum["desktop-miniApp"]:return"feishu";case t.RenderModeEnum.lynx:return"lynx";case t.RenderModeEnum.wx:return"wx";case t.RenderModeEnum.tt:return"tt";case t.RenderModeEnum.harmony:return"harmony"}return"browser"}!function(t){t[t.copyDataView=-10]="copyDataView",t[t.treemapFilter=-8]="treemapFilter",t[t.treemapFlatten=-7]="treemapFlatten",t[t.dotObjFlat=-7]="dotObjFlat",t[t.linkDotInfo=-7]="linkDotInfo",t[t.sankeyLayout=-7]="sankeyLayout",t[t.dataZoomFilter=-6]="dataZoomFilter",t[t.legendFilter=-5]="legendFilter"}(nU||(nU={})),function(t){t.appear="appear",t.disappear="disappear",t.enter="enter",t.update="update",t.state="state",t.exit="exit",t.normal="normal",t.none="none"}(rU||(rU={})),function(t){t.data="data",t.signal="signal",t.mark="mark"}(aU||(aU={}));var hU,dU,pU=function(){function t(t,e){var i,n=this;this._viewListeners=new Map,this._windowListeners=new Map,this._canvasListeners=new Map,this.isInited=!1,this._released=!1,this._model=((i={})[aU.signal]={},i[aU.data]={},i[aU.mark]={},i),this._compileChart=null,this.handleStageRender=function(){var t,e;null===(e=null===(t=n._compileChart)||void 0===t?void 0:t.getEvent())||void 0===e||e.emit(cG.afterRender,{chart:n._compileChart})},this._container=t,this._option=e}return t.prototype.getVGrammarView=function(){return this._view},t.prototype.getModel=function(){return this._model},t.prototype.getRenderer=function(){var t;return null===(t=this._view)||void 0===t?void 0:t.renderer},t.prototype.getCanvas=function(){var t;return null===(t=this._view)||void 0===t?void 0:t.renderer.canvas()},t.prototype.getStage=function(){var t;return null===(t=this._view)||void 0===t?void 0:t.renderer.stage()},t.prototype.initView=function(){var t,e,i,n,r=this;if(!this._released&&(this.isInited=!0,!this._view)){var a=new Lt(null!==(t=this._option.logLevel)&&void 0!==t?t:Rt.Error);(null===(e=this._option)||void 0===e?void 0:e.onError)&&a.addErrorHandler((function(){for(var t,e,i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];null===(e=null===(t=r._option)||void 0===t?void 0:t.onError)||void 0===e||e.call.apply(e,P([t],E(i),!1))}));var o=this._option,s=o.performanceHook,l=o.autoRefreshDpr,u=o.dpr,c=o.mode,h=o.gestureConfig,d=o.interactive,p=o.clickInterval,f=o.autoPreventDefault,v=M(o,["performanceHook","autoRefreshDpr","dpr","mode","gestureConfig","interactive","clickInterval","autoPreventDefault"]);this._view=new WN(A(A({width:this._width,height:this._height,container:null!==(i=this._container.dom)&&void 0!==i?i:null,renderCanvas:null!==(n=this._container.canvas)&&void 0!==n?n:null,hooks:s},v),{dpr:u,autoRefresh:N(l)?l:!N(u),mode:cU(c),autoFit:!1,eventConfig:{gesture:N(h)?h:Nk(c),disable:!1===d,clickInterval:p,autoPreventDefault:f},doLayout:function(){var t;null===(t=r._compileChart)||void 0===t||t.onLayout(r._view)},logger:a,logLevel:a.level()})),this._setCanvasStyle(),this.getStage().hooks.afterRender.tap("chart-event",this.handleStageRender),!1!==d&&this._viewListeners.forEach((function(t){var e;null===(e=r._view)||void 0===e||e.addEventListener(t.type,t.callback)}))}},t.prototype._setCanvasStyle=function(){if(this._view&&this._container.dom&&!Y(this._container.dom)){this._container.dom.style.display="block",this._container.dom.style.position="relative";var t=this.getCanvas();t&&(t.style.display="block")}},t.prototype.compileInteractions=function(){var t,e=this;if(this._view.removeAllInteractions(),null===(t=this._interactions)||void 0===t?void 0:t.length){var i={};this._interactions.forEach((function(t){var n;if(t.regionId){var r="".concat(t.regionId,"-").concat(t.type,"-").concat(null!==(n=t.id)&&void 0!==n?n:""),a=i[r];i[r]=a?A(A(A({},a),t),{selector:P(P([],E(a.selector),!1),E(t.selector),!1)}):t}else e._view.interaction(t.type,t)})),Object.keys(i).forEach((function(t){var n=e._view.interaction(i[t].type,i[t]);if(e._compileChart){var r=e._compileChart.getRegionsInIds([i[t].regionId])[0];r&&r.interaction.addVgrammarInteraction(n.getStartState(),n)}}))}},t.prototype.compile=function(t,e){if(!this._released){var i=t.chart;this._compileChart=i,this.initView(),this._view&&(i.compile(),i.afterCompile(),this.updateDepend(),this.compileInteractions())}},t.prototype.clearNextRender=function(){return!!this._nextRafId&&(ex.getCancelAnimationFrame()(this._nextRafId),this._nextRafId=null,!0)},t.prototype.clear=function(t,e){void 0===e&&(e=!1);var i=t.chart;this.clearNextRender(),i.clear(),this.releaseGrammar(e)},t.prototype.renderNextTick=function(t){var e=this;this._released||this._nextRafId||(this._nextRafId=ex.getRequestAnimationFrame()((function(){e._nextRafId=null,e.render(t)})))},t.prototype.render=function(t){var e,i;this._released||(this.initView(),this._view&&(null===(e=this._view)||void 0===e||e.run(t),this.clearNextRender()&&(null===(i=this._view)||void 0===i||i.run(t))))},t.prototype.updateViewBox=function(t,e){void 0===e&&(e=!0),this._view&&this._view.renderer.setViewBox(t,e)},t.prototype.resize=function(t,e,i){void 0===i&&(i=!0),this._view&&(this._width=t,this._height=e,this._view.resize(t,e),i&&this.render({morph:!1}))},t.prototype.setBackground=function(t){var e;null===(e=this._view)||void 0===e||e.background(t)},t.prototype.setSize=function(t,e){this._width=t,this._height=e,this._view&&(this._view.width(t),this._view.height(e))},t.prototype.setViewBox=function(t,e){void 0===e&&(e=!0),this._view&&this._view.renderer.setViewBox(t,e)},t.prototype.addEventListener=function(t,e,i){var n,r;if(!1!==this._option.interactive)if(t===hG.chart){var a=function(n,r){var a,o,s,l=null!==(o=null===(a=null==r?void 0:r.mark)||void 0===a?void 0:a.getContext())&&void 0!==o?o:{},u=N(l.modelId)?l.modelId:null,c=N(l.markId)?l.markId:null,h=N(l.modelUserId)?l.modelUserId:null,d=N(l.markUserId)?l.markUserId:null,p={event:n,type:e,source:t,item:r,datum:(null===(s=null==r?void 0:r.getDatum)||void 0===s?void 0:s.call(r))||null,markId:c,modelId:u,markUserId:d,modelUserId:h};i.call(null,p)}.bind(this);this._viewListeners.set(i,{type:e,callback:a}),null===(n=this._view)||void 0===n||n.addEventListener(e,a)}else if(t===hG.window){a=function(n){var r={event:n,type:e,source:t,item:null,datum:null,markId:null,modelId:null,markUserId:null,modelUserId:null};i.call(null,r)}.bind(this);this._windowListeners.set(i,{type:e,callback:a});var o=this._getGlobalThis();null==o||o.addEventListener(e,a)}else if(t===hG.canvas){a=function(n){var r={event:n,type:e,source:t,item:null,datum:null,markId:null,modelId:null,markUserId:null,modelUserId:null};i.call(null,r)}.bind(this);this._canvasListeners.set(i,{type:e,callback:a});var s=null===(r=this.getStage())||void 0===r?void 0:r.window;null==s||s.addEventListener(e,a)}},t.prototype.removeEventListener=function(t,e,i){var n,r,a,o,s;if(!1!==this._option.interactive)if(t===hG.chart)(c=null===(n=this._viewListeners.get(i))||void 0===n?void 0:n.callback)&&(null===(r=this._view)||void 0===r||r.removeEventListener(e,c)),this._viewListeners.delete(i);else if(t===hG.window){var l=this._getGlobalThis();(c=null===(a=this._windowListeners.get(i))||void 0===a?void 0:a.callback)&&(null==l||l.removeEventListener(e,c)),this._windowListeners.delete(i)}else if(t===hG.canvas){var u=null===(o=this.getStage())||void 0===o?void 0:o.window,c=null===(s=this._canvasListeners.get(i))||void 0===s?void 0:s.callback;u&&c&&(null==u||u.removeEventListener(e,c)),this._canvasListeners.delete(i)}},t.prototype.releaseEvent=function(){var t=this.getStage();t&&t.hooks.afterRender.unTap("chart-event",this.handleStageRender),this._viewListeners.clear(),this._windowListeners.clear(),this._canvasListeners.clear()},t.prototype.release=function(){var t;this.clearNextRender(),this.releaseEvent(),this._option=this._container=null,this._releaseModel(),null===(t=this._view)||void 0===t||t.release(),this._view=null,this.isInited=!1,this._compileChart=null,this._released=!0},t.prototype.releaseGrammar=function(t){var e,i;void 0===t&&(t=!1),this._releaseModel(),t&&(null===(e=this._view)||void 0===e||e.removeAllGraphicItems()),null===(i=this._view)||void 0===i||i.removeAllGrammars()},t.prototype._releaseModel=function(){var t=this;Object.keys(this._model).forEach((function(e){Object.values(t._model[e]).forEach((function(t){Object.values(t).forEach((function(t){t.removeProduct(!0)}))})),t._model[e]={}}))},t.prototype.addGrammarItem=function(t){var e=t.getProduct();if(!j(e)){var i=e.id(),n=t.grammarType;j(this._model[n][i])&&(this._model[n][i]={}),this._model[n][i][t.id]=t}},t.prototype.removeGrammarItem=function(t,e){var i,n=t.getProduct();if(!j(n)){var r=n.id(),a=t.grammarType,o=this._model[a][r];N(o)&&(delete o[t.id],0===Object.keys(o).length&&delete this._model[a][r]),e||null===(i=this._view)||void 0===i||i.removeGrammar(n)}},t.prototype.addInteraction=function(t){this._interactions||(this._interactions=[]),this._interactions.push(t)},t.prototype.removeInteraction=function(t){this._interactions&&(this._interactions=this._interactions.filter((function(e){return e.seriesId!==t})))},t.prototype.updateDepend=function(t){return N(t)&&t.length>0?t.every((function(t){return t.updateDepend()})):(Object.values(this._model).forEach((function(t){Object.values(t).forEach((function(t){var e=Object.values(t),i=e[0].getProduct(),n=e.reduce((function(t,e){return e.getDepend().length>0?t.concat(e.getDepend()):t}),[]).filter((function(t){return!!t})).map((function(t){return t.getProduct()}));i.depend(n)}))})),!0)},t.prototype._getGlobalThis=function(){var t;return jk(this._option.mode)?globalThis:null===(t=this.getStage())||void 0===t?void 0:t.window},t}();function fU(t){return new Promise((function(e){t.convertToBlob().then((function(t){var i=new FileReader;i.readAsDataURL(t),i.onload=function(){e(i.result)}}))}))}function vU(t,e){var i;return w(this,void 0,void 0,(function(){return T(this,(function(n){if(!t)return[2,""];try{if(void 0!==OffscreenCanvas&&t instanceof OffscreenCanvas)return[2,fU(t)]}catch(t){(null!==(i=null==e?void 0:e.onError)&&void 0!==i?i:Ok)("getCanvasDataURL error : ".concat(t.toString()))}return[2,t.toDataURL()]}))}))}function gU(t){t.crosshair=xt(t.crosshair||{}).map((function(e){var i;return xz(((i={})["horizontal"===t.direction?"yField":"xField"]={visible:!0,line:{visible:!0,type:"rect"}},i),e)}))}function yU(t,e,i){var n,r=t.width,a=t.height;if(N(r)&&N(a))return{width:r,height:a};var o=i.width,s=i.height,l=e.container,u=e.canvas;if(l){var c=Pi(l,i.width,i.height);o=c.width,s=c.height}else if(u&&jk(e.mode)){var h=Pi(Y(u)?ex.getElementById(u):u,i.width,i.height);o=h.width,s=h.height}else if(Vk(e.mode)&&(null===(n=e.modeParams)||void 0===n?void 0:n.domref)){var d=e.modeParams.domref;o=d.width,s=d.height}return{width:o=null!=r?r:o,height:s=null!=a?a:s}}function mU(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=function(i){return e.reduce((function(t,e){return t||(null==e?void 0:e[i])}),t[i])};return Object.assign(t,{change:n("change"),reCompile:n("reCompile"),reMake:n("reMake"),reRender:n("reRender"),reSize:n("reSize"),reTransformSpec:n("reTransformSpec"),changeTheme:n("changeTheme"),changeBackground:n("changeBackground")}),t}function _U(t,e){return"line"===t||"area"===t||"common"===t&&e.series.every((function(t){return"area"===t.type||"line"===t.type}))?{paddingInner:1,paddingOuter:0}:{paddingOuter:0}}!function(t){t.STATE_NORMAL="normal",t.STATE_HOVER="hover",t.STATE_HOVER_REVERSE="hover_reverse",t.STATE_DIMENSION_HOVER="dimension_hover",t.STATE_DIMENSION_HOVER_REVERSE="dimension_hover_reverse",t.STATE_SELECTED="selected",t.STATE_SELECTED_REVERSE="selected_reverse",t.STATE_SANKEY_EMPHASIS="selected",t.STATE_SANKEY_EMPHASIS_REVERSE="blur"}(hU||(hU={})),function(t){t.STATE_HOVER_REVERSE="hover_reverse",t.STATE_DIMENSION_HOVER_REVERSE="dimension_hover_reverse",t.STATE_SELECTED_REVERSE="selected_reverse"}(dU||(dU={}));var bU,xU=function(){function t(){this._children=[],this._markNameMap={},this._infoMap=new Map}return t.prototype.getMarkNameMap=function(){return this._markNameMap},t.prototype.addMark=function(e,i){j(e)||(this._children.push(e),this._markNameMap[e.name]=e,this._infoMap.set(e,ft({},t.defaultMarkInfo,i)))},t.prototype.removeMark=function(t){var e=this._children.findIndex((function(e){return e.name===t}));e>=0&&(this._infoMap.delete(this._children[e]),delete this._markNameMap[t],this._children.splice(e,1))},t.prototype.clear=function(){this._children=[],this._markNameMap={},this._infoMap.clear()},t.prototype.forEach=function(t){this._children.forEach(t)},t.prototype.includes=function(t,e){return this._children.includes(t,e)},t.prototype.get=function(t){return isNaN(Number(t))?this._markNameMap[t]:this._children[t]},t.prototype.getMarks=function(){return this._children.slice()},t.prototype.getMarksInType=function(t){var e=xt(t);return this._children.filter((function(t){return e.includes(t.type)}))},t.prototype.getMarkInId=function(t){return this._children.find((function(e){return e.id===t}))},t.prototype.getMarkWithInfo=function(t){var e=this;return this._children.find((function(i){return Object.keys(t).every((function(n){return t[n]===e._infoMap.get(i)[n]}))}))},t.defaultMarkInfo={},t}(),kU=function(){function e(t){var e=this;this._marks=new xU,this._markReverse=new xU,this.onHover=function(t){switch(t.action){case"enter":e.interaction.getEventElement(hU.STATE_DIMENSION_HOVER).forEach((function(t){return e.interaction.addEventElement(hU.STATE_DIMENSION_HOVER_REVERSE,t)})),e.interaction.clearEventElement(hU.STATE_DIMENSION_HOVER,!1),e.getEventElement(t).forEach((function(t){return e.interaction.addEventElement(hU.STATE_DIMENSION_HOVER,t)})),e.interaction.reverseEventElement(hU.STATE_DIMENSION_HOVER);break;case"leave":e.interaction.clearEventElement(hU.STATE_DIMENSION_HOVER,!0),t=null}},this._option=t,this.event=this._option.model.getOption().getChart().getEvent(),this.interaction=t.interaction,this.initConfig(t.mode)}return Object.defineProperty(e.prototype,"hover",{get:function(){return this._hover},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"select",{get:function(){return this._select},enumerable:!1,configurable:!0}),e.prototype.setStateKeys=function(t){},e.prototype.registerMark=function(t){ot(t.stateStyle[hU.STATE_DIMENSION_HOVER])||this._marks.addMark(t),ot(t.stateStyle[hU.STATE_DIMENSION_HOVER_REVERSE])||this._markReverse.addMark(t)},e.prototype.init=function(){this.initEvent()},e.prototype.release=function(){this.releaseEvent()},e.prototype.initEvent=function(){this.event.on(t.DimensionEventEnum.dimensionHover,this.onHover)},e.prototype.releaseEvent=function(){this.event.release()},e.prototype.initConfig=function(t){},e.prototype.getEventElement=function(t,e){var i=this;void 0===e&&(e=!1);var n=[];return t.dimensionInfo.forEach((function(t){t.data.forEach((function(t){var r=(e?i._markReverse:i._marks).getMarks().filter((function(e){return e.model===t.series&&e.getVisible()}));r.forEach((function(i){var r=i.getProduct();if(r&&r.elements){var a=r.elements.filter((function(i){var n,r=i.getDatum();return n=X(r)?r.every((function(e,i){return e===t.datum[i]})):t.datum.some((function(t){return t===r})),e?!n:n}));n.push.apply(n,P([],E(a),!1))}}))}))})),n},e}();var SU={};Object.values(hU).forEach((function(t){SU[t]=!0}));var AU=((bU={})[hU.STATE_HOVER]=hU.STATE_HOVER_REVERSE,bU[hU.STATE_SELECTED]=hU.STATE_SELECTED_REVERSE,bU[hU.STATE_DIMENSION_HOVER]=hU.STATE_DIMENSION_HOVER_REVERSE,bU);function MU(t){return AU[t]}var wU,TU,CU,EU=function(){function t(){this._stateMarks=new Map,this._stateElements=new Map,this._vgrammarInteractions=new Map,this._disableTriggerEvent=!1}return t.prototype.addVgrammarInteraction=function(t,e){t&&(this._vgrammarInteractions.get(t)?this._vgrammarInteractions.get(t).push(e):this._vgrammarInteractions.set(t,[e]))},t.markStateEnable=function(t,e){return!ot(t.stateStyle[e])},t.prototype.setDisableActiveEffect=function(t){this._disableTriggerEvent=t},t.prototype.registerMark=function(t,e){var i;this._stateMarks.has(t)||this._stateMarks.set(t,[]),null===(i=this._stateMarks.get(t))||void 0===i||i.push(e)},t.prototype.getStateMark=function(t){return this._stateMarks.get(t)},t.prototype.filterEventMark=function(t,e){var i;return!(!t.mark||!(null===(i=this._stateMarks.get(e))||void 0===i?void 0:i.includes(t.mark)))},t.prototype.getEventElement=function(t){var e;return null!==(e=this._stateElements.get(t))&&void 0!==e?e:[]},t.prototype.getEventElementData=function(t){return this.getEventElement(t).map((function(t){return t.getDatum()}))},t.prototype.exchangeEventElement=function(t,e){var i,n=this;if(!this._disableTriggerEvent){var r=MU(t);null===(i=this._stateElements.get(t))||void 0===i||i.forEach((function(e){e.removeState(t),r&&n.addEventElement(r,e)})),e.getStates().includes(t)||(e.addState(t),r&&e.removeState(r)),this._stateElements.set(t,[e])}},t.prototype.removeEventElement=function(t,e){var i,n;if(!this._disableTriggerEvent){e.removeState(t);var r=null!==(n=null===(i=this._stateElements.get(t))||void 0===i?void 0:i.filter((function(t){return t!==e})))&&void 0!==n?n:[];this._stateElements.set(t,r);var a=MU(t);a&&(0===r.length?this.clearEventElement(a,!1):this.addEventElement(a,e))}},t.prototype.addEventElement=function(t,e){var i;if(!this._disableTriggerEvent){e.getStates().includes(t)||e.addState(t);var n=null!==(i=this._stateElements.get(t))&&void 0!==i?i:[];n.push(e),this._stateElements.set(t,n)}},t.prototype.clearEventElement=function(t,e){var i;if(!this._disableTriggerEvent&&(null===(i=this._stateElements.get(t))||void 0===i||i.forEach((function(e){e.removeState(t)})),this._stateElements.set(t,[]),e)){var n=MU(t);n&&this.clearEventElement(n,!1)}},t.prototype.clearAllEventElement=function(){var t,e;if(!this._disableTriggerEvent)try{for(var i=C(this._stateElements),n=i.next();!n.done;n=i.next()){var r=E(n.value,2),a=r[0];r[1].forEach((function(t){t.clearStates()})),this._stateElements.set(a,[])}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},t.prototype.reverseEventElement=function(t){var e=this;if(!this._disableTriggerEvent){var i=MU(t);if(i){var n=this.getStateMark(i);if(n){var r=this.getEventElement(t);if(r.length)this.getEventElement(i).length||(1===r.length?n.forEach((function(t){t.getProduct().elements.filter((function(t){return t!==r[0]})).forEach((function(t){e.addEventElement(i,t)}))})):n.forEach((function(t){t.getProduct().elements.filter((function(t){return!r.includes(t)})).forEach((function(t){e.addEventElement(i,t)}))})))}}}},t.prototype.startInteraction=function(t,e){var i=this._vgrammarInteractions.get(t);i&&i.forEach((function(t){t.start(e)}))},t.prototype.resetInteraction=function(t,e){var i=this._vgrammarInteractions.get(t);i&&i.forEach((function(t){t.reset(e)}))},t.prototype.resetAllInteraction=function(){var t,e;try{for(var i=C(this._vgrammarInteractions),n=i.next();!n.done;n=i.next()){var r=E(n.value,2),a=(r[0],r[1]);a&&a.forEach((function(t){t.reset(null)}))}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},t}();!function(t){t[t.SeriesGroup=0]="SeriesGroup",t[t.Axis_Grid=50]="Axis_Grid",t[t.CrossHair_Grid=100]="CrossHair_Grid",t[t.Region=450]="Region",t[t.Mark=300]="Mark",t[t.Node=400]="Node",t[t.Axis=100]="Axis",t[t.MarkLine=500]="MarkLine",t[t.MarkArea=100]="MarkArea",t[t.MarkPoint=500]="MarkPoint",t[t.DataZoom=500]="DataZoom",t[t.ScrollBar=500]="ScrollBar",t[t.Player=500]="Player",t[t.Legend=500]="Legend",t[t.CrossHair=500]="CrossHair",t[t.Indicator=500]="Indicator",t[t.Title=500]="Title",t[t.Label=500]="Label",t[t.Brush=500]="Brush",t[t.CustomMark=500]="CustomMark",t[t.Interaction=700]="Interaction"}(wU||(wU={})),function(t){t[t.Indicator=10]="Indicator",t[t.Region=20]="Region",t[t.Axis=30]="Axis",t[t.DataZoom=40]="DataZoom",t[t.Player=40]="Player",t[t.ScrollBar=40]="ScrollBar",t[t.Legend=50]="Legend",t[t.Title=70]="Title",t[t.CustomMark=70]="CustomMark"}(TU||(TU={})),function(t){t[t.Default=0]="Default",t[t.Theme=1]="Theme",t[t.Chart=2]="Chart",t[t.Base_Series=3]="Base_Series",t[t.Series=4]="Series",t[t.Mark=5]="Mark",t[t.User_Chart=6]="User_Chart",t[t.User_Series=7]="User_Series",t[t.User_Mark=8]="User_Mark",t[t.User_SeriesStyle=9]="User_SeriesStyle",t[t.Built_In=99]="Built_In"}(CU||(CU={}));var PU=function(){function t(t){this._option=t,this.getCompiler=this._option.getCompiler}return t.prototype.getOption=function(){return this._option},t.prototype.getVGrammarView=function(){var t;return null===(t=this.getCompiler())||void 0===t?void 0:t.getVGrammarView()},t.prototype.release=function(){this._option=null,this.getCompiler=null},t}(),RU=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.id=Gk(),e._compiledProductId=null,e._depend=[],e}return S(e,t),e.prototype.getProduct=function(){if(N(this._product))return this._product;var t=this.getVGrammarView(),e=this.getProductId();return N(e)&&N(t)&&(this._product=this._lookupGrammar(e)),this._product},e.prototype.getProductId=function(){var t;return null!==(t=this._compiledProductId)&&void 0!==t?t:this.generateProductId()},e.prototype.getDepend=function(){return this._depend},e.prototype.setDepend=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._depend=t},e.prototype.compile=function(t){this._compileProduct(t),this._afterCompile(t)},e.prototype._afterCompile=function(t){var e;N(this._product)&&(null===(e=this.getCompiler())||void 0===e||e.addGrammarItem(this))},e.prototype.updateDepend=function(){if(N(this._product)){var t=this.getDepend().map((function(t){return t.getProduct()})).filter(N);return this._product.depend(t),t.length===this.getDepend().length}return!1},e.prototype.release=function(){this.removeProduct(),t.prototype.release.call(this),this._depend=[]},e.prototype.removeProduct=function(t){this.getCompiler().removeGrammarItem(this,t),this._product=null,this._compiledProductId=null},e}(PU),BU=function(t){function e(e,i,n,r){var a=t.call(this,e)||this;return a.grammarType=aU.signal,a.name=i,a._value=n,a._updateFunc=r,a}return S(e,t),e.prototype.getValue=function(){return this._value},e.prototype.getUpdateFunc=function(){return this._updateFunc},e.prototype.updateSignal=function(t,e){this._value=t,this._updateFunc=e,this.compile()},e.prototype._compileProduct=function(){var t=this.getVGrammarView();if(t){if(!this.getProduct()){var e=this.getProductId();this._product=t.signal().id(e),this._compiledProductId=e}N(this._value)&&this._product.value(this._value),N(this._updateFunc)&&this._product.update(this._updateFunc)}},e.prototype.generateProductId=function(){return this.name},e.prototype._lookupGrammar=function(t){var e;return null===(e=this.getCompiler().getVGrammarView())||void 0===e?void 0:e.getSignalById(t)},e}(RU),IU=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._signalMap={},e}return S(e,t),e.prototype.getSignalMap=function(){return this._signalMap},e.prototype.getSignal=function(t){return this._signalMap[t]},e.prototype.updateSignal=function(t,e,i){this._signalMap[t]?this._signalMap[t].updateSignal(e,i):(this._signalMap[t]=new BU(this._option,t,e,i),this._signalMap[t].compile())},e.prototype.compile=function(){Object.values(this._signalMap).forEach((function(t){t.compile()}))},e.prototype.release=function(){t.prototype.release.call(this),Object.values(this._signalMap).forEach((function(t){t.release()})),this._signalMap={}},e}(PU),LU=function(t){function e(e){var i=t.call(this,e)||this;return e.stateKeyToSignalName?i.stateKeyToSignalName=e.stateKeyToSignalName:i.stateKeyToSignalName=function(){return"state_signal"},i.initStateMap(),i}return S(e,t),e.prototype.getStateMap=function(){return this._stateMap},e.prototype._getDefaultStateMap=function(){return{}},e.prototype.initStateMap=function(t){this._stateMap=null!=t?t:this._getDefaultStateMap()},e.prototype.compile=function(t){var e=this,i=null!=t?t:this._stateMap;Object.keys(i).forEach((function(t){var n=e.stateKeyToSignalName(t),r=i[t];e.updateSignal(n,r)}))},e.prototype.updateState=function(t,e){if(t&&(ft(this._stateMap,t),this.compile(t),!e))return this.getCompiler().renderNextTick()},e}(IU),DU=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.id=Gk(),e.stateKeyToSignalName=function(t){return"".concat(BF,"_animate_").concat(e.id,"_").concat(t)},e}return S(e,t),e.prototype.getAnimationStateSignalName=function(){return this.stateKeyToSignalName("animationState")},e.prototype.updateAnimateState=function(t,e){t===rU.update?this.updateState({animationState:{callback:function(t,e){return e.diffState}}},e):t===rU.appear?this.updateState({animationState:{callback:function(t,e){return"exit"===e.diffState?rU.none:rU.appear}}},e):this.updateState({animationState:{callback:function(e,i){return t}}},e)},e.prototype._getDefaultStateMap=function(){return{animationState:{callback:function(t,e){return"exit"===e.diffState?rU.exit:"update"===e.diffState?rU.update:rU.appear}}}},e}(LU),OU=function(){function t(t){this._option=t,this.type=t.type}return t.prototype._initTheme=function(t,e){return this._theme=this.getTheme(t,e),this._mergeThemeToSpec(t,e)},t.prototype.getTheme=function(t,e){},t.prototype.transformSpec=function(t,e,i){this._transformSpecBeforeMergingTheme(t,e,i);var n=this._initTheme(t,e);return this._transformSpecAfterMergingTheme(n.spec,e,i),n},t.prototype._transformSpecBeforeMergingTheme=function(t,e,i){},t.prototype._transformSpecAfterMergingTheme=function(t,e,i){},t.prototype._mergeThemeToSpec=function(t,e){var i=this._theme;if(this._shouldMergeThemeToSpec()){var n=this._getDefaultSpecFromChart(e),r=function(t){return xz({},i,n,t)};return X(t)?{spec:t.map((function(t){return r(t)})),theme:i}:{spec:r(t),theme:i}}return{spec:t,theme:i}},t.prototype._shouldMergeThemeToSpec=function(){return!0},t.prototype._getDefaultSpecFromChart=function(t){},t}(),FU=function(t){function e(e,i){var n,r=this;return(r=t.call(this,i)||this).transformerConstructor=OU,r.type="null",r.modelType="null",r.userId=void 0,r._data=null,r._layout=null,r.specKey="",r._marks=new xU,r._lastLayoutRect=null,r.id=Gk(),r.userId=e.id,r._spec=e,r.effect={},r.event=new UG(i.eventDispatcher,i.mode),null===(n=i.map)||void 0===n||n.set(r.id,r),r}return S(e,t),e.prototype.getSpec=function(){return this._spec||{}},e.prototype.getSpecPath=function(){var t;return null===(t=this._option)||void 0===t?void 0:t.specPath},e.prototype.getSpecInfoPath=function(){var t,e,i;return null!==(e=null===(t=this._option)||void 0===t?void 0:t.specInfoPath)&&void 0!==e?e:null===(i=this._option)||void 0===i?void 0:i.specPath},e.prototype.getData=function(){return this._data},Object.defineProperty(e.prototype,"layout",{get:function(){return this._layout},enumerable:!1,configurable:!0}),e.prototype.getOption=function(){return this._option},e.prototype.getMarks=function(){var t,e;return null!==(e=null===(t=this._marks)||void 0===t?void 0:t.getMarks())&&void 0!==e?e:[]},e.prototype.getMarkNameMap=function(){var t;return null===(t=this._marks)||void 0===t?void 0:t.getMarkNameMap()},e.prototype.getMarkSet=function(){return this._marks},e.prototype.getChart=function(){return this._option.getChart()},Object.defineProperty(e.prototype,"_theme",{get:function(){var t;return null===(t=this.getSpecInfo())||void 0===t?void 0:t.theme},enumerable:!1,configurable:!0}),e.prototype._releaseEvent=function(){this.event.release()},e.prototype.created=function(){this.setAttrFromSpec()},e.prototype.init=function(t){},e.prototype.afterInit=function(){},e.prototype.getVisible=function(){var t;return!1!==(null===(t=this._spec)||void 0===t?void 0:t.visible)},e.prototype.onLayoutStart=function(t,e,i){var n;null===(n=this._layout)||void 0===n||n.onLayoutStart(t,e,i)},e.prototype.onLayoutEnd=function(t){var e;null===(e=this._layout)||void 0===e||e.onLayoutEnd(t),this.getMarks().forEach((function(t){return t.updateLayoutState(!0,!0)}))},e.prototype.onEvaluateEnd=function(t){},e.prototype.onDataUpdate=function(){},e.prototype.beforeRelease=function(){},e.prototype.clear=function(){this.getMarks().forEach((function(t){var e;return null===(e=t.clear)||void 0===e?void 0:e.call(t)}))},e.prototype.release=function(){var e;this._releaseEvent(),this._spec=void 0,this.getMarks().forEach((function(t){return t.release()})),null===(e=this._data)||void 0===e||e.release(),this._data=null,this._marks.clear(),t.prototype.release.call(this)},e.prototype.updateSpec=function(t){var e=this._compareSpec(t,this._spec);return this._spec=t,e},e.prototype._compareSpec=function(t,e){return{change:!1,reMake:!1,reRender:!1,reSize:!1,reCompile:!1}},e.prototype.reInit=function(t){t&&(this._spec=t),this.setAttrFromSpec()},e.prototype.updateLayoutAttribute=function(){},e.prototype.setAttrFromSpec=function(){var t;null===(t=this._layout)||void 0===t||t.setAttrFromSpec(this._spec,this._option.getChartViewRect())},e.prototype._convertMarkStyle=function(t){return A({},t)},e.prototype.setMarkStyle=function(t,e,i,n){N(t)&&N(e)&&t.setStyle(this._convertMarkStyle(e),i,n)},e.prototype.initMarkStyleWithSpec=function(t,e,i){var n=this;if(N(t)&&N(e)){var r=e.style,a=e.state,o=A({},e);r&&(o.style=this._convertMarkStyle(r)),a&&(o.state={},Object.keys(a).forEach((function(t){o.state[t]=n._convertMarkStyle(a[t])}))),t.initStyleWithSpec(o,i)}},e.prototype.stateKeyToSignalName=function(t,e){var i="".concat(BF,"_").concat(this.modelType,"_").concat(this.type,"_").concat(this.id,"_").concat(t);return e&&(i+="_".concat(e)),i},e.prototype.compileData=function(){var t;null===(t=this._data)||void 0===t||t.compile()},e.prototype.compileMarks=function(t){this.getMarks().forEach((function(e){e.compile({group:t})}))},e.prototype._createMark=function(t,e,i){void 0===e&&(e={});var n=t.type,r=t.name,a=kz.createMark(n,r,A({model:this,map:this._option.map,getCompiler:this.getCompiler,globalScale:this._option.globalScale},e));return a&&(a.created(),i&&a.setMarkConfig(i)),a},e.prototype._getDataIdKey=function(){},e.prototype.getColorScheme=function(){var t,e;return null===(e=(t=this._option).getTheme)||void 0===e?void 0:e.call(t).colorScheme},e.prototype.getSpecInfo=function(){var t,e,i;return function(t,e,i){if(!j(e))return st(t,e,i)}(null!==(i=null===(e=(t=this._option).getSpecInfo)||void 0===e?void 0:e.call(t))&&void 0!==i?i:{},this.getSpecInfoPath())},e.prototype.getSpecIndex=function(){var t=this.getSpecPath();if(!(null==t?void 0:t.length))return 0;var e=Number(t[t.length-1]);return isNaN(e)?0:e},e}(PU),zU=function(){function t(t,e){var i,n=this;this.layoutClip=!1,this.autoIndent=!1,this._layoutStartPoint={x:0,y:0},this._layoutRect={width:0,height:0},this._layoutRectLevelMap={width:0,height:0},this._minWidth=null,this._maxWidth=null,this._minHeight=null,this._maxHeight=null,this._lastComputeRect=null,this._lastComputeOutBounds={x1:0,x2:0,y1:0,y2:0},this.getLayoutRect=function(){return n._layoutRect},this.layoutType="normal",this._layoutOrient="left",this.layoutPaddingLeft=0,this.layoutPaddingTop=0,this.layoutPaddingRight=0,this.layoutPaddingBottom=0,this.layoutOffsetX=0,this.layoutOffsetY=0,this.layoutLevel=TU.Region,this._model=t,this._option=e,this.layoutLevel=e.layoutLevel,this.layoutType=e.layoutType,e.layoutOrient&&(this.layoutOrient=e.layoutOrient),this._spec=null===(i=null==t?void 0:t.getSpec)||void 0===i?void 0:i.call(t)}return t.prototype.getSpec=function(){return this._spec||{}},t.prototype.getLayoutStartPoint=function(){return this._layoutStartPoint},Object.defineProperty(t.prototype,"layoutRectLevelMap",{get:function(){return this._layoutRectLevelMap},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minWidth",{get:function(){return this._minWidth},set:function(t){this._minWidth=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(t){this._maxWidth=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minHeight",{get:function(){return this._minHeight},set:function(t){this._minHeight=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxHeight",{get:function(){return this._maxHeight},set:function(t){this._maxHeight=t},enumerable:!1,configurable:!0}),t.prototype.getLastComputeOutBounds=function(){return this._lastComputeOutBounds},Object.defineProperty(t.prototype,"layoutOrient",{get:function(){return this._layoutOrient},set:function(t){this._layoutOrient=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"model",{get:function(){return this._model},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this._model.type},enumerable:!1,configurable:!0}),t.prototype._setLayoutAttributeFromSpec=function(t,e){var i,n,r,a;if(this._spec&&!1!==this._spec.visible){var o=_F(bF(t.padding),e,e);this.layoutPaddingLeft=o.left,this.layoutPaddingRight=o.right,this.layoutPaddingTop=o.top,this.layoutPaddingBottom=o.bottom,this._minHeight=j(t.minHeight)?null!==(i=this._minHeight)&&void 0!==i?i:null:mF(t.minHeight,e.height,e),this._maxHeight=j(t.maxHeight)?null!==(n=this._maxHeight)&&void 0!==n?n:null:mF(t.maxHeight,e.height,e),this._minWidth=j(t.minWidth)?null!==(r=this._minWidth)&&void 0!==r?r:null:mF(t.minWidth,e.width,e),this._maxWidth=j(t.maxWidth)?null!==(a=this._maxWidth)&&void 0!==a?a:null:mF(t.maxWidth,e.width,e),t.width&&this.setLayoutRect({width:mF(t.width,e.width,e)},{width:9}),t.height&&this.setLayoutRect({height:mF(t.height,e.height,e)},{height:9}),j(t.offsetX)||(this.layoutOffsetX=mF(t.offsetX,e.width,e)),j(t.offsetY)||(this.layoutOffsetY=mF(t.offsetY,e.height,e)),t.alignSelf&&(this.alignSelf=t.alignSelf)}},t.prototype.setAttrFromSpec=function(t,e){var i,n,r,a;this._spec=t,this.layoutType=null!==(i=t.layoutType)&&void 0!==i?i:this.layoutType,this.layoutLevel=null!==(n=t.layoutLevel)&&void 0!==n?n:this.layoutLevel,this.layoutOrient=null!==(r=t.orient)&&void 0!==r?r:this.layoutOrient,this._setLayoutAttributeFromSpec(t,e),this.layoutClip=null!==(a=t.clip)&&void 0!==a?a:this.layoutClip},t.prototype.onLayoutStart=function(t,e,i){this._setLayoutAttributeFromSpec(this._spec,e)},t.prototype.onLayoutEnd=function(t){},t.prototype._getAbsoluteSpecValue=function(t){var e=this,i={top:null,bottom:null,left:null,right:null};return["top","bottom","left","right"].forEach((function(n){j(e._spec[n])||(i[n]=mF(e._spec[n],"top"===n||"bottom"===n?t.height:t.width,t))})),i},t.prototype.absoluteLayoutInRect=function(t){var e=this._getAbsoluteSpecValue(t),i=e.top,n=e.bottom,r=e.left,a=e.right,o={width:t.width-this.layoutPaddingLeft-this.layoutPaddingRight,height:t.height-this.layoutPaddingTop-this.layoutPaddingBottom};j(r)||(o.width-=r),j(a)||(o.width-=a),j(i)||(o.height-=i),j(n)||(o.height-=n),this.setLayoutRect(o);var s=this.computeBoundsInRect(this.getLayoutRect()),l=s.width,u=s.height;this.setLayoutRect({width:l,height:u});var c={x:t.x,y:t.y};!0===this._spec.center?(c.x=t.x+.5*t.width-.5*l,c.y=t.y+.5*t.height-.5*u):(j(r)?j(a)||(c.x=t.x+t.width-this.layoutPaddingRight-a-l):c.x=t.x+r+this.layoutPaddingLeft,j(i)?j(n)||(c.y=t.y+t.height-this.layoutPaddingBottom-n-u):c.y=t.y+i+this.layoutPaddingTop),this.setLayoutStartPosition(c)},t.prototype.setLayoutStartPosition=function(t){var e,i;this._option.transformLayoutPosition&&(t=this._option.transformLayoutPosition(t)),Q(t.x)&&(this._layoutStartPoint.x=t.x),Q(t.y)&&(this._layoutStartPoint.y=t.y),null===(i=(e=this._model).afterSetLayoutStartPoint)||void 0===i||i.call(e,this._layoutStartPoint)},t.prototype.setLayoutRect=function(t,e){var i,n,r,a,o=t.width,s=t.height;Q(o)&&(null!==(i=null==e?void 0:e.width)&&void 0!==i?i:0)>=this._layoutRectLevelMap.width&&(this._layoutRect.width=o,this._layoutRectLevelMap.width=null!==(n=null==e?void 0:e.width)&&void 0!==n?n:0),Q(s)&&(null!==(r=null==e?void 0:e.height)&&void 0!==r?r:0)>=this._layoutRectLevelMap.height&&(this._layoutRect.height=s,this._layoutRectLevelMap.height=null!==(a=null==e?void 0:e.height)&&void 0!==a?a:0),this.setRectInSpec(this._layoutRect)},t.prototype.getLayout=function(){return{x:this._layoutStartPoint.x,y:this._layoutStartPoint.y,width:this._layoutRect.width,height:this._layoutRect.height}},t.prototype.mergeLayoutRect=function(t){var e={width:t.width,height:t.height};return this._layoutRectLevelMap.width>0&&(e.width=this._layoutRect.width),this._layoutRectLevelMap.height>0&&(e.height=this._layoutRect.height),e},t.prototype.getOrientPosAttribute=function(){return"bottom"===this._layoutOrient||"top"===this._layoutOrient?"x":"y"},t.prototype.getOrientSizeAttribute=function(){return"bottom"===this._layoutOrient||"top"===this._layoutOrient?"width":"height"},t.prototype.changeBoundsBySetting=function(t){return this._layoutRectLevelMap.width>0&&(t.x2=t.x1+this._layoutRect.width),this._layoutRectLevelMap.height>0&&(t.y2=t.y1+this._layoutRect.height),t.x1-=this._layoutStartPoint.x,t.x2-=this._layoutStartPoint.x,t.y1-=this._layoutStartPoint.y,t.y2-=this._layoutStartPoint.y,t},t.prototype.setRectInSpec=function(t){var e=A({},t);return this._layoutRectLevelMap.width<9?(j(this._minWidth)||(e.width=Math.max(e.width,this._minWidth)),j(this._maxWidth)||(e.width=Math.min(e.width,this._maxWidth))):e.width=this._layoutRect.width,this._layoutRectLevelMap.height<9?(j(this._minHeight)||(e.height=Math.max(e.height,this._minHeight)),j(this._maxHeight)||(e.height=Math.min(e.height,this._maxHeight))):e.height=this._layoutRect.height,e},t.prototype.computeBoundsInRect=function(t){if(this._lastComputeRect=t,!("region-relative"!==this.layoutType&&"region-relative-overlap"!==this.layoutType||(9!==this._layoutRectLevelMap.width||"left"!==this.layoutOrient&&"right"!==this.layoutOrient)&&(9!==this._layoutRectLevelMap.height||"bottom"!==this.layoutOrient&&"top"!==this.layoutOrient)))return this._layoutRect;var e=A({},this._model.getBoundsInRect(this.setRectInSpec(t),t));this.changeBoundsBySetting(e),this.autoIndent&&e.x2-e.x1>0&&e.y2-e.y1>0&&(this._lastComputeOutBounds.x1=Math.ceil(-e.x1),this._lastComputeOutBounds.x2=Math.ceil(e.x2-t.width),this._lastComputeOutBounds.y1=Math.ceil(-e.y1),this._lastComputeOutBounds.y2=Math.ceil(e.y2-t.height));var i=this.setRectInSpec(function(t,e){return t?{width:Math.ceil(Math.min(t.x2-t.x1,e.width)),height:Math.ceil(Math.min(t.y2-t.y1,e.height))}:{width:0,height:0}}(e,t));return this._option.transformLayoutRect&&(i=this._option.transformLayoutRect(i)),i},t.prototype.getModelId=function(){return this._model.id},t.prototype.getModelVisible=function(){return this._model.getVisible()},t}(),HU=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.layoutType="normal",e.layoutLevel=0,e.layoutZIndex=0,e._forceLayoutTag=!1,e._layout=null,e._orient=null,e._layoutRect={width:0,height:0},e._layoutStartPos={x:0,y:0},e._isLayout=!0,e.getGraphicBounds=function(){return e._layout?{x1:e._layout.getLayoutStartPoint().x,y1:e._layout.getLayoutStartPoint().y,x2:e._layout.getLayoutStartPoint().x+e._layout.getLayoutRect().width,y2:e._layout.getLayoutStartPoint().y+e._layout.getLayoutRect().height}:{x1:0,x2:0,y1:0,y2:0}},e._transformLayoutRect=null,e._transformLayoutPosition=null,e}return S(e,t),Object.defineProperty(e.prototype,"layoutOrient",{get:function(){return this._orient},set:function(t){this._orient=t,this._layout&&(this._layout.layoutOrient=t)},enumerable:!1,configurable:!0}),e.prototype.initLayout=function(){"none"!==this.layoutType&&(this._layout=new zU(this,{layoutType:this.layoutType,layoutLevel:this.layoutLevel,layoutOrient:this._orient,transformLayoutRect:this._transformLayoutRect,transformLayoutPosition:this._transformLayoutPosition}),this._orient&&"radius"!==this._orient&&"angle"!==this._orient&&this._layout&&(this._layout.layoutOrient=this._orient))},e.prototype.onLayoutStart=function(e,i,n){this._isLayout=!0,t.prototype.onLayoutStart.call(this,e,i,n)},e.prototype.onLayoutEnd=function(e){t.prototype.onLayoutEnd.call(this,e),this.updateLayoutAttribute();var i=this.getLayoutRect();!this._forceLayoutTag&&mt(this._lastLayoutRect,i)||(this._lastLayoutRect=A({},i)),this._forceLayoutTag=!1,this._isLayout=!1},e.prototype.afterSetLayoutStartPoint=function(t){},e.prototype._forceLayout=function(){var t;this._isLayout||(this._forceLayoutTag=!0,null===(t=this._option.globalInstance.getChart())||void 0===t||t.setLayoutTag(!0))},e.prototype.getLayoutStartPoint=function(){return this._layout?this._layout.getLayoutStartPoint():this._layoutStartPos},e.prototype.setLayoutStartPosition=function(t){return this._layout?this._layout.setLayoutStartPosition(t):this._layoutStartPos=ft(this._layoutStartPos,t)},e.prototype.getLayoutRect=function(){return this._layout?this._layout.getLayoutRect():this._layoutRect},e.prototype.setLayoutRect=function(t,e){return this._layout?this._layout.setLayoutRect(t):this._lastLayoutRect=ft(this._layoutRect,t)},e.prototype.getLastComputeOutBounds=function(){var t;return null===(t=this._layout)||void 0===t?void 0:t.getLastComputeOutBounds()},e.prototype.setAttrFromSpec=function(){var e,i,n,r,a;t.prototype.setAttrFromSpec.call(this),this.layoutClip=null!==(e=this._spec.clip)&&void 0!==e?e:this.layoutClip,this.layoutZIndex=null!==(i=this._spec.zIndex)&&void 0!==i?i:this.layoutZIndex,this.layoutType=null!==(n=this._spec.layoutType)&&void 0!==n?n:this.layoutType,this._orient=null!==(r=this._spec.orient)&&void 0!==r?r:this._orient,this.layoutLevel=null!==(a=this._spec.layoutLevel)&&void 0!==a?a:this.layoutLevel},e}(FU),jU=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._initTheme=function(t,e){return{spec:t,theme:this._theme}},e}(OU),NU=function(t){function e(i,n){var r,a=this;return(a=t.call(this,i,n)||this).transformerConstructor=jU,a.modelType="region",a.specKey="region",a.type=e.type,a._series=[],a.layoutType="region",a.layoutZIndex=wU.Region,a.interaction=new EU,a.seriesDataFilterOver=function(){a.event.emit(cG.regionSeriesDataFilterOver,{model:a,chart:a.getChart()}),a._series.forEach((function(t){t.getViewDataFilter()&&t.reTransformViewData()}))},a.getBoundsInRect=function(){return{x1:a._layout.getLayoutStartPoint().x,y1:a._layout.getLayoutStartPoint().y,x2:a._layout.getLayoutStartPoint().x+a._layout.getLayoutRect().width,y2:a._layout.getLayoutStartPoint().y+a._layout.getLayoutRect().height}},a.userId=i.id,a.coordinate=null!==(r=i.coordinate)&&void 0!==r?r:"cartesian",a._option.animation&&(a.animate=new DU({getCompiler:n.getCompiler})),a.interaction.setDisableActiveEffect(a._option.disableTriggerEvent),a}return S(e,t),e.prototype.getMaxWidth=function(){return this._layout.maxWidth},e.prototype.setMaxWidth=function(t){this._layout.maxWidth=t},e.prototype.getMaxHeight=function(){return this._layout.maxHeight},e.prototype.setMaxHeight=function(t){this._layout.maxHeight=t},e.prototype.getGroupMark=function(){return this._groupMark},e.prototype.getInteractionMark=function(){return this._interactionMark},e.prototype.getStackInverse=function(){return!0===this._spec.stackInverse},e.prototype.getStackSort=function(){return!0===this._spec.stackSort},e.prototype._getClipDefaultValue=function(){var t,e,i,n,r=this._option.getChart().getSpec(),a=null===(e=null===(t=r.dataZoom)||void 0===t?void 0:t.some)||void 0===e?void 0:e.call(t,(function(t){var e;return"axis"===(null!==(e=t.filterMode)&&void 0!==e?e:"filter")})),o=null===(n=null===(i=r.scrollBar)||void 0===i?void 0:i.some)||void 0===n?void 0:n.call(i,(function(t){var e;return"axis"===(null!==(e=t.filterMode)&&void 0!==e?e:"axis")}));return!(!a&&!o)||this._layout.layoutClip},e.prototype.created=function(){var e,i,n=this;this.initLayout(),t.prototype.created.call(this);var r=null!==(e=this._spec.clip)&&void 0!==e?e:this._getClipDefaultValue();this._groupMark=this._createGroupMark("regionGroup",this.userId,this.layoutZIndex),this._spec.roam&&this._groupMark.setMarkConfig({interactive:!0}),this._interactionMark=this._createGroupMark("regionInteractionGroup",(null!==(i=this.userId)&&void 0!==i?i:this.type)+"_interaction",wU.Interaction),ot(this._spec.style)||(this._backgroundMark=this._createMark({type:"rect",name:"regionBackground"}),r&&(this._foregroundMark=this._createMark({type:"rect",name:"regionForeground"})),[this._backgroundMark,this._foregroundMark].forEach((function(t){t&&(t.created(),n.setMarkStyle(t,{width:function(){return n.getLayoutRect().width},height:function(){return n.getLayoutRect().height}},"normal",CU.Built_In),n._groupMark.addMark(t))})),this._backgroundMark&&this._backgroundMark.setMarkConfig({zIndex:wU.SeriesGroup-1}),this._foregroundMark&&this._foregroundMark.setMarkConfig({zIndex:wU.Mark+1})),this.createTrigger()},e.prototype._createGroupMark=function(t,e,i){var n,r,a=this,o=this._createMark({type:"group",name:t});o.setUserId(e),o.setMarkConfig({zIndex:i});var s=null!==(n=this._spec.clip)&&void 0!==n?n:this._getClipDefaultValue();return this.setMarkStyle(o,{x:function(){return a.getLayoutStartPoint().x},y:function(){return a.getLayoutStartPoint().y},width:function(){return a.getLayoutRect().width},height:function(){return a.getLayoutRect().height},clip:s},"normal",CU.Built_In),this.setMarkStyle(o,{cornerRadius:null===(r=this._spec.style)||void 0===r?void 0:r.cornerRadius},"normal",CU.User_Mark),this._marks.addMark(o),o},e.prototype.init=function(e){t.prototype.init.call(this,e),this.initMark(),this.initSeriesDataflow(),this.initInteraction(),this.initTrigger()},e.prototype.initMark=function(){this._initBackgroundMarkStyle(),this._initForegroundMarkStyle()},e.prototype._initBackgroundMarkStyle=function(){var t,e;this._backgroundMark&&(this.setMarkStyle(this._backgroundMark,A({fillOpacity:(null===(t=this._spec.style)||void 0===t?void 0:t.fill)?1:0},this._spec.style),"normal",CU.User_Mark),(null!==(e=this._spec.clip)&&void 0!==e?e:this._getClipDefaultValue())&&this.setMarkStyle(this._backgroundMark,{strokeOpacity:0},"normal",CU.Built_In))},e.prototype._initForegroundMarkStyle=function(){this._foregroundMark&&this.setMarkStyle(this._foregroundMark,A(A({},this._spec.style),{fillOpacity:0,pickable:!1}),"normal",CU.User_Mark)},e.prototype._compareSpec=function(e,i){var n=t.prototype._compareSpec.call(this,e,i);return mt(null==i?void 0:i.style,null==e?void 0:e.style)||(n.reMake=!0),n},e.prototype.reInit=function(e){t.prototype.reInit.call(this,e),this._initBackgroundMarkStyle(),this._initForegroundMarkStyle()},e.prototype.addSeries=function(t){t&&(this._series.includes(t)||this._series.push(t))},e.prototype.removeSeries=function(t){if(t){var e=this._series.findIndex((function(e){return e===t}));e>=0&&this._series.splice(e,1)}},e.prototype.getSeries=function(t){return void 0===t&&(t={}),this._series.filter((function(e){var i,n;return(!t.name||(null==e?void 0:e.name)===t.name)&&(!t.userId||xt(t.userId).includes(e.userId))&&(!N(t.specIndex)||xt(t.specIndex).includes(e.getSpecIndex()))&&(!t.id||e.id===t.id)&&(!t.type||e.type===t.type)&&(!t.coordinateType||e.coordinate===t.coordinateType)&&(!t.dataName||(null===(n=null===(i=e.getRawData)||void 0===i?void 0:i.call(e))||void 0===n?void 0:n.name)===t.dataName)}))},e.prototype.getSeriesInName=function(t){return this.getSeries({name:t})[0]},e.prototype.getSeriesInUserId=function(t){return this.getSeries({userId:t})[0]},e.prototype.getSeriesInId=function(t){return this.getSeries({id:t})[0]},e.prototype.getSeriesInType=function(t){return this.getSeries({type:t})},e.prototype.getSeriesInCoordinateType=function(t){return this.getSeries({coordinateType:t})},e.prototype.getSeriesInDataName=function(t){return this.getSeries({dataName:t})},e.prototype.onRender=function(t){},e.prototype.initSeriesDataflow=function(){var t=this._series.map((function(t){var e;return null!==(e=t.getViewDataFilter())&&void 0!==e?e:t.getViewData()})).filter((function(t){return!!t}));this._option.dataSet.multipleDataViewAddListener(t,"change",this.seriesDataFilterOver)},e.prototype.release=function(){t.prototype.release.call(this),this._series=[]},e.prototype.createTrigger=function(){var t=A(A({},this._option),{model:this,interaction:this.interaction});this._trigger=new kU(t)},e.prototype.initTrigger=function(){var t=this;this._series.forEach((function(e){e.getMarksWithoutRoot().forEach((function(e){t._trigger.registerMark(e)}))})),this._trigger.init()},e.prototype.initInteraction=function(){var t=this;this._option.disableTriggerEvent||this._series.forEach((function(e){e.getMarksWithoutRoot().forEach((function(e){for(var i in dU)ot(e.stateStyle[dU[i]])||t.interaction.registerMark(dU[i],e)}))}))},e.prototype.compileMarks=function(t){var e=this;this.getMarks().forEach((function(i){var n;i.compile({group:t,context:{model:e}}),null===(n=i.getProduct())||void 0===n||n.layout((function(t,e,i,n){}))}))},e.prototype.compile=function(){var t;null===(t=this.animate)||void 0===t||t.compile(),this.compileMarks()},e.prototype.onLayoutEnd=function(e){this._series.forEach((function(t){return t.onLayoutEnd(e)})),t.prototype.onLayoutEnd.call(this,e)},e.type="region",e.transformerConstructor=jU,e.specKey="region",e}(HU);function VU(t){var e=[],i=[],n=[];return t.forEach((function(t){j(t.getSpec().position)||"start"===t.getSpec().position?e.push(t):"middle"===t.getSpec().position?i.push(t):"end"===t.getSpec().position&&n.push(t)})),{startItems:e,endItems:n,middleItems:i}}function WU(t,e,i){e?t.forEach((function(t){var e=kt(t),n=e.getLayoutStartPoint().y+e.getLayoutRect().height-t[0].getLayoutStartPoint().y,r=(i-n)/2;t.forEach((function(t){t.setLayoutStartPosition({x:t.getLayoutStartPoint().x,y:t.getLayoutStartPoint().y+r})}))})):t.forEach((function(t){var e=kt(t),n=e.getLayoutStartPoint().x+e.getLayoutRect().width-t[0].getLayoutStartPoint().x,r=(i-n)/2;t.forEach((function(t){t.setLayoutStartPosition({x:t.getLayoutStartPoint().x+r,y:t.getLayoutStartPoint().y})}))}))}function GU(t,e,i,n){var r;t.forEach((function(t,a){t.length>1&&(r=i[a],t.forEach((function(t){if(t.alignSelf&&"start"!==t.alignSelf){var i=t.getLayoutStartPoint(),a="middle"===t.alignSelf?.5:1,o=e?r-(t.getLayoutRect().width+t.layoutPaddingLeft+t.layoutPaddingRight):r-(t.getLayoutRect().height+t.layoutPaddingTop+t.layoutPaddingBottom);e?t.setLayoutStartPosition({x:i.x+n*o*a,y:i.y}):t.setLayoutStartPosition({x:i.x,y:i.y+n*o*a})}})))}))}function UU(t,e,i,n,r){if(t.length){var a=0,o="right"===r,s=o?-1:1,l=o?e.rightCurrent:e.leftCurrent,u=e.topCurrent,c=[],h=[],d=[];t.forEach((function(t){var n=e.getItemComputeLayoutRect(t),r=t.computeBoundsInRect(n);t.setLayoutRect(r);var p=r.height+t.layoutPaddingTop+t.layoutPaddingBottom,f=r.width+t.layoutPaddingLeft+t.layoutPaddingRight,v=o?-r.width-t.layoutPaddingRight:t.layoutPaddingLeft;t.setLayoutStartPosition({x:l+t.layoutOffsetX+v,y:u+t.layoutOffsetY+t.layoutPaddingTop}),(u+=p)>i&&h.length?(d.push(a),l+=s*a,a=f,u=e.topCurrent+p,t.setLayoutStartPosition({x:l+t.layoutOffsetX+v,y:e.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),c.push(h),h=[t]):(a=Math.max(a,f),h.push(t))})),d.push(a),c.push(h),GU(c,!0,d,s),n&&WU(c,!0,i),o?e.rightCurrent=l+s*a:e.leftCurrent=l+s*a}}function YU(t,e,i,n){if(t.length){var r=0,a="right"===n,o=a?-1:1,s=a?e.rightCurrent:e.leftCurrent,l=e.bottomCurrent,u=[],c=[],h=[];t.forEach((function(t){var i=e.getItemComputeLayoutRect(t),n=t.computeBoundsInRect(i);t.setLayoutRect(n);var d=n.height+t.layoutPaddingTop+t.layoutPaddingBottom,p=n.width+t.layoutPaddingLeft+t.layoutPaddingRight,f=a?-n.width-t.layoutPaddingRight:t.layoutPaddingLeft;l<d&&c.length?(h.push(r),s+=o*r,r=p,l=e.bottomCurrent,t.setLayoutStartPosition({x:s+t.layoutOffsetX+f,y:l+t.layoutOffsetY-n.height-t.layoutPaddingBottom}),u.push(c),c=[t]):(t.setLayoutStartPosition({x:s+t.layoutOffsetX+f,y:l+t.layoutOffsetY-n.height-t.layoutPaddingBottom}),r=Math.max(r,p),l-=d,c.push(t))})),h.push(r),u.push(c),GU(u,!0,h,o),a?e.rightCurrent=s+o*r:e.leftCurrent=s+o*r}}function XU(t,e,i,n,r){if(t.length){var a="top"===r,o=a?1:-1,s=0,l=e.leftCurrent,u=a?e.topCurrent:e.bottomCurrent,c=[],h=[],d=[];t.forEach((function(t){var n=e.getItemComputeLayoutRect(t),r=t.computeBoundsInRect(n);t.setLayoutRect(r);var p=r.height+t.layoutPaddingTop+t.layoutPaddingBottom,f=r.width+t.layoutPaddingLeft+t.layoutPaddingRight,v=a?t.layoutPaddingTop:-r.height-t.layoutPaddingBottom;t.setLayoutStartPosition({x:l+t.layoutOffsetX+t.layoutPaddingLeft,y:u+t.layoutOffsetY+v}),(l+=f)>i&&h.length?(d.push(s),l=e.leftCurrent+f,u+=o*s,s=p,t.setLayoutStartPosition({x:e.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft,y:u+t.layoutOffsetY+v}),c.push(h),h=[t]):(s=Math.max(s,p),h.push(t))})),d.push(s),c.push(h),GU(c,!1,d,o),n&&WU(c,!1,i),a?e.topCurrent=u+o*s:e.bottomCurrent=u+o*s}}function KU(t,e,i,n){if(t.length){var r="top"===n,a=r?1:-1,o=0,s=e.rightCurrent,l=r?e.topCurrent:e.bottomCurrent,u=[],c=[],h=[];t.forEach((function(t){var i=e.getItemComputeLayoutRect(t),n=t.computeBoundsInRect(i);t.setLayoutRect(n);var h=n.height+t.layoutPaddingTop+t.layoutPaddingBottom,d=n.width+t.layoutPaddingLeft+t.layoutPaddingRight,p=r?t.layoutPaddingTop:-n.height-t.layoutPaddingBottom;s<d&&c.length?(s=e.rightCurrent,l+=a*o,o=h,t.setLayoutStartPosition({x:e.rightCurrent+t.layoutOffsetX-n.width-t.layoutPaddingRight,y:l+t.layoutOffsetY+p}),u.push(c),c=[t]):(c.push(t),t.setLayoutStartPosition({x:s+t.layoutOffsetX-n.width-t.layoutPaddingRight,y:l+t.layoutOffsetY+p}),o=Math.max(o,h),s-=d)})),h.push(o),u.push(c),GU(u,!1,h,a),r?e.topCurrent=l+a*o:e.bottomCurrent=l+a*o}}var qU=function(){function t(t,e){this.leftCurrent=0,this.topCurrent=0,this.rightCurrent=0,this.bottomCurrent=0,this._onError=null==e?void 0:e.onError}return t.prototype._layoutInit=function(t,e,i,n){this._chartLayoutRect=i,this._chartViewBox=n,this.leftCurrent=i.x,this.topCurrent=i.y,this.rightCurrent=i.x+i.width,this.bottomCurrent=i.height+i.y,e.sort((function(t,e){return e.layoutLevel-t.layoutLevel}))},t.prototype._layoutNormalItems=function(t){this.layoutNormalInlineItems(t.filter((function(t){return"normal-inline"===t.layoutType}))),this.layoutNormalItems(t.filter((function(t){return"normal"===t.layoutType})))},t.prototype._groupItems=function(t){var e=t.filter((function(t){return"region"===t.layoutType})),i=t.filter((function(t){return"region-relative"===t.layoutType})),n=t.filter((function(t){return"region-relative-overlap"===t.layoutType})),r=i.concat(n),a={left:{items:[],rect:{width:0,height:0}},right:{items:[],rect:{width:0,height:0}},top:{items:[],rect:{width:0,height:0}},bottom:{items:[],rect:{width:0,height:0}},z:{items:[],rect:{width:0,height:0}}};return n.forEach((function(t){a[t.layoutOrient].items.push(t)})),{regionItems:e,relativeItems:i,relativeOverlapItems:n,allRelatives:r,overlapItems:a}},t.prototype.layoutItems=function(t,e,i,n){this._layoutInit(t,e,i,n),this._layoutNormalItems(e);var r={left:this.leftCurrent,top:this.topCurrent,right:this.rightCurrent,bottom:this.bottomCurrent},a=this._groupItems(e),o=a.regionItems,s=a.relativeItems,l=a.relativeOverlapItems,u=a.allRelatives,c=a.overlapItems;this.layoutRegionItems(o,s,l,c),this._processAutoIndent(o,s,l,c,u,r),this.layoutAbsoluteItems(e.filter((function(t){return"absolute"===t.layoutType})))},t.prototype._processAutoIndent=function(t,e,i,n,r,a){if(void 0===n&&(n={left:{items:[],rect:{width:0,height:0}},right:{items:[],rect:{width:0,height:0}},top:{items:[],rect:{width:0,height:0}},bottom:{items:[],rect:{width:0,height:0}},z:{items:[],rect:{width:0,height:0}}}),r.some((function(t){return t.autoIndent}))){var o=this._checkAutoIndent(r,a),s=o.top,l=o.bottom,u=o.left,c=o.right;(s||l||u||c)&&(this.topCurrent=a.top+s,this.bottomCurrent=a.bottom-l,this.leftCurrent=a.left+u,this.rightCurrent=a.right-c,this.layoutRegionItems(t,e,i,n))}},t.prototype.layoutNormalItems=function(t){var e=this;t.forEach((function(t){var i=e.getItemComputeLayoutRect(t),n=t.computeBoundsInRect(i);t.setLayoutRect(n),"left"===t.layoutOrient?(t.setLayoutStartPosition({x:e.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft,y:e.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),e.leftCurrent+=n.width+t.layoutPaddingLeft+t.layoutPaddingRight):"top"===t.layoutOrient?(t.setLayoutStartPosition({x:e.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft,y:e.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),e.topCurrent+=n.height+t.layoutPaddingTop+t.layoutPaddingBottom):"right"===t.layoutOrient?(t.setLayoutStartPosition({x:e.rightCurrent+t.layoutOffsetX-n.width-t.layoutPaddingRight,y:e.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),e.rightCurrent-=n.width+t.layoutPaddingLeft+t.layoutPaddingRight):"bottom"===t.layoutOrient&&(t.setLayoutStartPosition({x:e.leftCurrent+t.layoutOffsetX+t.layoutPaddingRight,y:e.bottomCurrent+t.layoutOffsetY-n.height-t.layoutPaddingBottom}),e.bottomCurrent-=n.height+t.layoutPaddingTop+t.layoutPaddingBottom)}))},t.prototype.layoutNormalInlineItems=function(t){var e=t.filter((function(t){return"left"===t.layoutOrient})),i=t.filter((function(t){return"right"===t.layoutOrient})),n=t.filter((function(t){return"top"===t.layoutOrient})),r=t.filter((function(t){return"bottom"===t.layoutOrient})),a=this._chartLayoutRect.width+this._chartLayoutRect.x,o=this._chartLayoutRect.height+this._chartLayoutRect.y;e.length&&function(t,e,i){var n=VU(t),r=n.startItems,a=n.middleItems,o=n.endItems;r.length&&UU(r,e,i,!1,"left"),a.length&&UU(a,e,i,!0,"left"),o.length&&YU(o,e,0,"left")}(e,this,o),n.length&&function(t,e,i){var n=VU(t),r=n.startItems,a=n.middleItems,o=n.endItems;r.length&&XU(r,e,i,!1,"top"),a.length&&XU(a,e,i,!0,"top"),o.length&&KU(o,e,0,"top")}(n,this,a),i.length&&function(t,e,i){var n=VU(t),r=n.startItems,a=n.middleItems,o=n.endItems;r.length&&UU(r,e,i,!1,"right"),a.length&&UU(a,e,i,!0,"right"),o.length&&YU(o,e,0,"right")}(i,this,o),r.length&&function(t,e,i){var n=VU(t),r=n.startItems,a=n.middleItems,o=n.endItems;r.length&&XU(r,e,i,!1,"bottom"),a.length&&XU(a,e,i,!0,"bottom"),o.length&&KU(o,e,0,"bottom")}(r,this,a)},t.prototype._layoutRelativeOverlap=function(t,e){var i=this;e.items.forEach((function(t){var n=i.getItemComputeLayoutRect(t),r=t.computeBoundsInRect(n);e.rect.width=Math.max(r.width+t.layoutPaddingLeft+t.layoutPaddingRight,e.rect.width),e.rect.height=Math.max(r.height+t.layoutPaddingTop+t.layoutPaddingBottom,e.rect.height)})),e.items.forEach((function(n){n.setLayoutRect(e.rect),"left"===t?n.setLayoutStartPosition({x:i.leftCurrent+n.layoutOffsetX}):"right"===t?n.setLayoutStartPosition({x:i.rightCurrent-e.rect.width+n.layoutOffsetX}):"top"===t?n.setLayoutStartPosition({x:i.topCurrent+n.layoutOffsetY}):n.setLayoutStartPosition({x:i.bottomCurrent-e.rect.height+n.layoutOffsetY})})),"left"===t?this.leftCurrent+=e.rect.width:"right"===t?this.rightCurrent-=e.rect.width:"top"===t?this.topCurrent+=e.rect.height:this.bottomCurrent-=e.rect.height},t.prototype._layoutRelativeItem=function(t,e){var i=t.computeBoundsInRect(e);"left"===t.layoutOrient||"right"===t.layoutOrient?t.setLayoutRect({width:i.width}):t.setLayoutRect({height:i.height}),"left"===t.layoutOrient?(t.setLayoutStartPosition({x:this.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft}),this.leftCurrent+=i.width+t.layoutPaddingLeft+t.layoutPaddingRight):"right"===t.layoutOrient?(this.rightCurrent-=i.width+t.layoutPaddingLeft+t.layoutPaddingRight,t.setLayoutStartPosition({x:this.rightCurrent+t.layoutOffsetX+t.layoutPaddingLeft})):"top"===t.layoutOrient?(t.setLayoutStartPosition({y:this.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),this.topCurrent+=i.height+t.layoutPaddingTop+t.layoutPaddingBottom):"bottom"===t.layoutOrient&&(this.bottomCurrent-=i.height+t.layoutPaddingTop+t.layoutPaddingBottom,t.setLayoutStartPosition({y:this.bottomCurrent+t.layoutOffsetY+t.layoutPaddingTop}))},t.prototype._layoutRegionItem=function(t,e,i){var n=this,r=Math.max(Math.min.apply(Math,P([e],E(t.map((function(t){var e;return null!==(e=t.maxWidth)&&void 0!==e?e:Number.MAX_VALUE}))),!1)),0),a=Math.max(Math.min.apply(Math,P([i],E(t.map((function(t){var e;return null!==(e=t.maxHeight)&&void 0!==e?e:Number.MAX_VALUE}))),!1)),0);return t.forEach((function(t){var e=r-t.layoutPaddingLeft-t.layoutPaddingRight,i=a-t.layoutPaddingTop-t.layoutPaddingBottom;t.setLayoutRect({width:e,height:i}),t.setLayoutStartPosition({x:n.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft,y:n.topCurrent+t.layoutOffsetY+t.layoutPaddingTop})})),{regionHeight:a,regionWidth:r}},t.prototype.layoutRegionItems=function(t,e,i,n){var r=this;void 0===n&&(n={left:{items:[],rect:{width:0,height:0}},right:{items:[],rect:{width:0,height:0}},top:{items:[],rect:{width:0,height:0}},bottom:{items:[],rect:{width:0,height:0}},z:{items:[],rect:{width:0,height:0}}});var a=(this.rightCurrent,this.leftCurrent),o=(this.bottomCurrent,this.topCurrent);e.filter((function(t){return"left"===t.layoutOrient||"right"===t.layoutOrient})).forEach((function(t){r._layoutRelativeItem(t,r.getItemComputeLayoutRect(t))})),this._layoutRelativeOverlap("left",n.left),this._layoutRelativeOverlap("right",n.right),a=this.rightCurrent-this.leftCurrent,e.filter((function(t){return"top"===t.layoutOrient||"bottom"===t.layoutOrient})).forEach((function(t){r._layoutRelativeItem(t,r.getItemComputeLayoutRect(t))})),this._layoutRelativeOverlap("top",n.top),this._layoutRelativeOverlap("bottom",n.bottom),o=this.bottomCurrent-this.topCurrent;var s=this._layoutRegionItem(t,a,o),l=s.regionWidth,u=s.regionHeight;e.concat(i).forEach((function(e){if(["left","right"].includes(e.layoutOrient)){var i=r.filterRegionsWithID(t,e.layoutBindRegionID[0]);e.setLayoutRect({height:i.getLayoutRect().height}),e.setLayoutStartPosition({y:i.getLayoutStartPoint().y+e.layoutOffsetY+e.layoutPaddingTop}),"right"===e.layoutOrient&&e.setLayoutStartPosition({x:e.getLayoutStartPoint().x+l-a})}else if(["top","bottom"].includes(e.layoutOrient)){i=r.filterRegionsWithID(t,e.layoutBindRegionID[0]);e.setLayoutRect({width:i.getLayoutRect().width}),e.setLayoutStartPosition({x:i.getLayoutStartPoint().x+e.layoutOffsetX+e.layoutPaddingLeft}),"bottom"===e.layoutOrient&&e.setLayoutStartPosition({y:e.getLayoutStartPoint().y+u-o})}}))},t.prototype.layoutAbsoluteItems=function(t){var e=this;t.forEach((function(t){t.absoluteLayoutInRect(e._chartLayoutRect)}))},t.prototype.filterRegionsWithID=function(t,e){var i,n=t.find((function(t){return t.getModelId()===e}));return n||(null!==(i=this._onError)&&void 0!==i?i:Ok)("can not find target region item, invalid id"),n},t.prototype.getItemComputeLayoutRect=function(t){return{width:this.rightCurrent-this.leftCurrent-t.layoutPaddingLeft-t.layoutPaddingRight,height:this.bottomCurrent-this.topCurrent-t.layoutPaddingTop-t.layoutPaddingBottom}},t.prototype._checkAutoIndent=function(t,e){var i=this,n={top:0,left:0,bottom:0,right:0};return t.forEach((function(t){if(t.getModelVisible()&&t.autoIndent){var r="left"===t.layoutOrient||"right"===t.layoutOrient,a=t.getLastComputeOutBounds(),o=i._getOutInLayout(a,t,e);r?(n.top=Math.max(n.top,o.top),n.bottom=Math.max(n.bottom,o.bottom)):(n.left=Math.max(n.left,o.left),n.right=Math.max(n.right,o.right))}})),n},t.prototype._getOutInLayout=function(t,e,i){var n=e.getLayoutStartPoint(),r=n.x,a=n.y,o=e.getLayoutRect(),s=o.width,l=o.height;return{left:i.left-(r-t.x1),right:r+s+t.x2-i.right,top:i.top-(a-t.y1),bottom:a+l+t.y2-i.bottom}},t.type="base",t}(),ZU=["linear","radial","conical"],JU={linear:{x0:0,y0:0,x1:1,y1:1},radial:{x0:0,y0:0,x1:1,y1:1,r0:0,r1:1},conical:{x:.5,y:.5,startAngle:0,endAngle:2*Math.PI}},QU=["line","area","trail"];function $U(t){return QU.includes(t)}var tY,eY=function(t){function e(e,i){var n=t.call(this,e)||this;return n._stateInfoList=[],n._mark=i,n}return S(e,t),e.prototype.getStateInfoList=function(){return this._stateInfoList},e.prototype._getDefaultStateMap=function(){return{markUpdateRank:1}},e.prototype.getStateInfo=function(t){return this._stateInfoList.find((function(e){return e.stateValue===t}))},e.prototype.addStateInfo=function(t){if(!this.getStateInfo(t.stateValue)){t.level=t.level||0;for(var e=!0,i=0;i<this._stateInfoList.length;i++){var n=this._stateInfoList[i].level;if(n&&n>t.level){this._stateInfoList.splice(i,0,t),e=!1;break}}e&&this._stateInfoList.push(t)}},e.prototype._clearStateBeforeSet=function(t){t.datums=null,t.items=null,t.fields=null,t.filter=null},e.prototype.changeStateInfo=function(t){var e=this.getStateInfo(t.stateValue);if(e){if(void 0!==t.datums&&(this._clearStateBeforeSet(e),e.datums=t.datums,e.datumKeys=t.datumKeys),void 0!==t.items&&(this._clearStateBeforeSet(e),e.items=t.items),void 0!==t.fields)if(this._clearStateBeforeSet(e),null===t.fields)e.fields=t.fields;else for(var i in e.fields=e.fields||{},t.fields){var n=t.fields[i];e.fields[i]=e.fields[i]||{};var r=e.fields[i];N(n.domain)&&(r.domain=n.domain),N(n.type)&&(r.type=n.type)}t.filter&&(this._clearStateBeforeSet(e),e.filter=t.filter)}else this.addStateInfo(t)},e.prototype.clearStateInfo=function(t){var e=this;t.forEach((function(t){e.getStateInfo(t)&&e.changeStateInfo({stateValue:t,datumKeys:null,datums:null,fields:null,items:null,filter:null,cache:{}})}))},e.prototype.checkOneState=function(t,e,i,n){var r;n=z($U)?n:!t.mark||$U(t.mark.markType);var a=!1,o=!1;if(N(i.datums)&&i.datums.length>0)a=this.checkDatumState(i,e,n),o=!0;else if(i.items)a=null!==(r=this.checkItemsState(i,t))&&void 0!==r&&r,o=!0;else if(i.fields)a=this.checkFieldsState(i,e,t,n),o=!0;else if(!a&&i.filter){var s={mark:this._mark,renderNode:t,type:t.mark.markType};a=i.filter(e,s),o=!0}return o?a?"in":"out":"skip"},e.prototype.checkState=function(t,e){for(var i=t.getStates().filter((function(t){return function(t){return!!SU[t]}(t)})).map((function(t){return[t,10]})),n=!t.mark||$U(t.mark.markType),r=0;r<this._stateInfoList.length;r++){var a=this._stateInfoList[r],o=this.checkOneState(t,e,a,n);"skip"!==o&&("in"===o&&i.push([a.stateValue,a.level]))}return i.map((function(t){return t[0]}))},e.prototype.checkDatumState=function(t,e,i){var n=!1,r=i?e[0]:e;if(X(t.datums)){var a=t.datumKeys||Object.keys(t.datums[0]).filter((function(t){return!t.startsWith(BF)}));n=t.datums.some((function(t){return i&&X(null==t?void 0:t.items)?a.every((function(e){var i,n;return(null===(n=null===(i=null==t?void 0:t.items)||void 0===i?void 0:i[0])||void 0===n?void 0:n[e])===(null==r?void 0:r[e])})):a.every((function(e){return(null==t?void 0:t[e])===(null==r?void 0:r[e])}))}))}else if(V(t.datums)){var o=t.datumKeys||Object.keys(t.datums).filter((function(t){return!t.startsWith(BF)}));n=o.every((function(e){var n,a;return i?(null===(n=t.datums.items)||void 0===n?void 0:n[0][e])===r[e]:(null===(a=t.datums)||void 0===a?void 0:a[e])===r[e]}))}else n=e===t.datums;return n},e.prototype.checkItemsState=function(t,e){var i;return null===(i=t.items)||void 0===i?void 0:i.includes(e)},e.prototype.checkFieldsState=function(t,e,i,n){var r,a=!0,o=function(o){var l=t.fields[o],u=l.type,c=l.domain,h=n?null===(r=e[0])||void 0===r?void 0:r[o]:e[o];if(NB(u)&&c.length>1){if(s.checkLinearFieldState(c,o,e,i,n))return a=!1,"break";a=!0}else{if(!c.some((function(t){return t===h})))return a=!1,"break";a=!0}},s=this;for(var l in t.fields){if("break"===o(l))break}return a},e.prototype.checkLinearFieldState=function(t,e,i,n,r){var a,o=r?null===(a=i[0])||void 0===a?void 0:a[e]:i[e];return o<t[0]||o>t[t.length-1]},e.prototype.updateLayoutState=function(t){return this._stateMap.markUpdateRank++,this.updateState({markUpdateRank:this._stateMap.markUpdateRank},t)},e.prototype.compileState=function(t,e){var i=this;t.state({callback:function(t,e){return i.checkState(e,t)}},e)},e}(LU),iY=function(t){function e(e,i){var n=t.call(this,e)||this;return n.grammarType=aU.data,n._data=null,n._data=i,n}return S(e,t),e.prototype.getDataView=function(){return this._data},e.prototype.setDataView=function(t){this._data=t},e.prototype.getLatestData=function(){var t;return null===(t=this._data)||void 0===t?void 0:t.latestData},e.prototype.release=function(){t.prototype.release.call(this),this._data=null},e.prototype.updateData=function(t){var e=this.getProduct(),i=this.getLatestData();if(e&&i&&(e.values(i),!t))return this.getCompiler().renderNextTick()},e.prototype._compileProduct=function(){var t=this.getLatestData();j(t)||(j(this.getProduct())?this._initProduct(t):this._product.values(t))},e.prototype._initProduct=function(t){var e,i,n=this.getVGrammarView();if(n&&t){var r=this.getProductId();this._product=null===(i=null===(e=null==n?void 0:n.data)||void 0===e?void 0:e.call(n,t))||void 0===i?void 0:i.id(r),this._compiledProductId=r}},e.prototype.generateProductId=function(){var t;return"".concat(null===(t=this.getDataView())||void 0===t?void 0:t.name)},e.prototype._lookupGrammar=function(t){var e,i;return null===(i=null===(e=this.getCompiler().getVGrammarView())||void 0===e?void 0:e.getDataById)||void 0===i?void 0:i.call(e,t)},e}(RU),nY=function(t){function e(e){var i=t.call(this,e)||this;return i._mark=e.mark,i}return S(e,t),e.prototype.setCompiledProductId=function(t){this._compiledProductId=t},e.prototype.generateProductId=function(){var e=t.prototype.generateProductId.call(this);return N(e)?e:"".concat(BF,"_markData_").concat(this._mark.id)},e.prototype._compileProduct=function(){var t,e=null===(t=this._data)||void 0===t?void 0:t.latestData;j(e)||N(this.getProduct())||this._initProduct(e)},e}(iY),rY=function(t){function e(e,i,n){var r=t.call(this,e)||this;return r.grammarType=aU.mark,r.type=void 0,r.name="mark",r._markConfig={zIndex:wU.Mark,morph:!1},r._visible=!0,r.stateStyle={},r._unCompileChannel={},r._skipBeforeLayouted=!1,r.name=i,r.model=n,r.key=e.key,r.state=new eY(A(A({},e),{stateKeyToSignalName:r.stateKeyToSignalName.bind(r)}),r),r._event=new UG(n.getOption().eventDispatcher,n.getOption().mode),r}return S(e,t),e.prototype.getMarkConfig=function(){return this._markConfig},e.prototype.setMarkConfig=function(t){var e=this;Object.keys(t).forEach((function(i){e._markConfig[i]=t[i]}))},e.prototype.getVisible=function(){return this._visible},e.prototype.setVisible=function(t){this._visible=t},e.prototype.getUserId=function(){return this._userId},e.prototype.setUserId=function(t){N(t)&&(this._userId=t)},e.prototype.getDataView=function(){var t;return null===(t=this._data)||void 0===t?void 0:t.getDataView()},e.prototype.setDataView=function(t,e){j(this._data)&&this.initMarkData(A(A({},this._option),{mark:this})),N(e)&&this._data.setCompiledProductId(e),this._data.setDataView(t)},e.prototype.getData=function(){return this._data},e.prototype.setData=function(t){this._data=t},e.prototype.hasState=function(t){return t in this.state.getStateMap()},e.prototype.getState=function(t){return this.state.getStateMap()[t]},e.prototype.getAnimationConfig=function(){return this._animationConfig},e.prototype.setAnimationConfig=function(t){this._animationConfig=t},e.prototype.setSkipBeforeLayouted=function(t){this._skipBeforeLayouted=t},e.prototype.getSkipBeforeLayouted=function(){return this._skipBeforeLayouted},e.prototype.getGroupKey=function(){return this._groupKey},e.prototype.setGroupKey=function(t){this._groupKey=t},e.prototype.setStateSortCallback=function(t){this._stateSort=t},e.prototype.setTransform=function(t){this._transform=t},e.prototype.initMarkData=function(t){this._data=new nY(t)},e.prototype.stateKeyToSignalName=function(t){return"".concat(BF,"_").concat(this.type,"_").concat(this.id,"_").concat(t)},e.prototype.getAttribute=function(t,e,i,n){},e.prototype._compileProduct=function(t){var e=this.getProduct();this.getVisible()?N(e)||this.getCompiler().isInited&&(this._initProduct(null==t?void 0:t.group),j(this._product)||(this.compileSignal(),this.compileData(),this.compileState(),this.compileEncode(),this.compileAnimation(),this.compileContext(null==t?void 0:t.context),this.compileTransform())):N(e)&&this.removeProduct()},e.prototype._initProduct=function(t){var e=this.getVGrammarView(),i=this.getProductId();this._product=e.mark(this.type,null!=t?t:e.rootMark).id(i),this.name&&this._product&&this._product.name(this.name),this._compiledProductId=i},e.prototype.generateProductId=function(){return this._userId?"".concat(this._userId):"".concat(this.name,"_").concat(this.id)},e.prototype.compileData=function(){if(!j(this._data)){this._data.compile();var t=this._data.getProduct();N(this._product)&&N(t)&&this._product.join(t,this.key,void 0,this.getGroupKey())}},e.prototype.updateStaticEncode=function(){if(this._product){var t=this._separateStyle(),e=t.enterStyles,i=t.updateStyles;this._product.encodeState("group",e,!0),this._product.encode(i,!0)}},e.prototype._separateStyle=function(){var t=this,e=this.stateStyle,i=hU.STATE_NORMAL,n=e[i];M(e,["symbol"==typeof i?i:i+""]);var r=this._option.noSeparateStyle?null:{},a={};return Object.keys(n).forEach((function(e){t._unCompileChannel[e]||(t._option.noSeparateStyle||function(t,e,i){var n,r=null===(n=e[t])||void 0===n?void 0:n.style,a=function(t,e){return("fill"===t||"stroke"===t)&&(null==e?void 0:e.gradient)&&(null==e?void 0:e.stops)}(t,r);return!!a||!!H(r)||!(!(null==r?void 0:r.scale)||r.field===i)}(e,n,t.getGroupKey())?a[e]={callback:t.compileCommonAttributeCallback(e,"normal"),dependency:[t.stateKeyToSignalName("markUpdateRank")]}:r[e]=t.compileCommonAttributeCallback(e,"normal"))})),{enterStyles:r,updateStyles:a}},e.prototype.compileEncode=function(){var t=this,e=this.stateStyle,i=hU.STATE_NORMAL;e[i];var n=M(e,["symbol"==typeof i?i:i+""]),r=this._separateStyle(),a=r.enterStyles,o=r.updateStyles;this._product.encode(o,!0),this._product.encodeState("group",a,!0),Object.keys(n).forEach((function(e){var i={};Object.keys(n[e]).forEach((function(n){t._unCompileChannel[n]||(i[n]={callback:t.compileCommonAttributeCallback(n,e),dependency:[t.stateKeyToSignalName("markUpdateRank")]})})),t._product.encodeState(e,i,!0)})),this._skipBeforeLayouted&&this._product.layout({skipBeforeLayouted:this._skipBeforeLayouted})},e.prototype.compileState=function(){this.state.compileState(this._product,this._stateSort)},e.prototype.compileAnimation=function(){var t,e,i,n,r=this;if(this._animationConfig){var a;if("component"===this.type)a=null===(t=this.model.animate)||void 0===t?void 0:t.getAnimationStateSignalName();else{var o=null===(i=(e=this.model).getRegion)||void 0===i?void 0:i.call(e);a=null===(n=null==o?void 0:o.animate)||void 0===n?void 0:n.getAnimationStateSignalName()}this._product.animation(this._animationConfig),this._product.animationState({callback:function(t,e,i){var n;return null===(n=i[a])||void 0===n?void 0:n.callback(t,e)},dependency:a}),this._animationConfig.normal&&(this._animationConfig.appear?this._event.on(DH.ANIMATION_END,(function(t){var e=t.event;e.mark===r.getProduct()&&e.animationState===rU.appear&&r.runAnimationByState(rU.normal)})):this._event.on(DH.AFTER_DO_RENDER,(function(){r.runAnimationByState(rU.normal)})))}},e.prototype.compileContext=function(t){var e=A(A({},this._markConfig),{context:A({markId:this.id,modelId:this.model.id,markUserId:this._userId,modelUserId:this.model.userId},t)});this._product.configure(e)},e.prototype.compileSignal=function(){this.state.compile()},e.prototype._computeAttribute=function(t,e){return function(t,e){}},e.prototype.compileCommonAttributeCallback=function(t,e){var i=this._computeAttribute(t,e),n={mark:null,parent:null,element:null};return function(t,e){return n.mark=e.mark,n.parent=e.mark.group,n.element=e,i(t,n)}},e.prototype.compileTransform=function(){var t;(null===(t=this._transform)||void 0===t?void 0:t.length)&&this.getProduct().transform(this._transform)},e.prototype._lookupGrammar=function(t){var e;return null===(e=this.getCompiler().getVGrammarView())||void 0===e?void 0:e.getMarkById(t)},e.prototype.updateState=function(t,e){return this.state.updateState(t,e)},e.prototype.updateLayoutState=function(t,e){return e&&this.getMarks().length>0&&this.getMarks().forEach((function(t){return t.state.updateLayoutState(!0)})),this.state.updateLayoutState(t)},e.prototype.updateMarkState=function(t){var e=this;if(this._product){var i=this.state.getStateInfo(t);this._product.elements.forEach((function(n){"in"===e.state.checkOneState(n,n.getDatum(),i)?n.addState(t):n.removeState(t)}))}},e.prototype.getMarks=function(){return[]},e.prototype.runAnimationByState=function(t){var e,i;return null===(i=null===(e=this.getProduct())||void 0===e?void 0:e.animate)||void 0===i?void 0:i.runAnimationByState(t)},e.prototype.stopAnimationByState=function(t){var e,i;return null===(i=null===(e=this.getProduct())||void 0===e?void 0:e.animate)||void 0===i?void 0:i.stopAnimationByState(t)},e.prototype.pauseAnimationByState=function(t){var e,i;return null===(i=null===(e=this.getProduct())||void 0===e?void 0:e.animate)||void 0===i?void 0:i.pauseAnimationByState(t)},e.prototype.resumeAnimationByState=function(t){var e,i;return null===(i=null===(e=this.getProduct())||void 0===e?void 0:e.animate)||void 0===i?void 0:i.resumeAnimationByState(t)},e.prototype.getProductElements=function(){var t=this.getProduct();if(t)return t.elements},e.prototype.clear=function(){this._event.off(DH.AFTER_DO_RENDER)},e.prototype.release=function(){t.prototype.release.call(this),this.state.release()},e}(RU),aY=function(t){function e(e,i){var n,r=this;return(r=t.call(this,i,e,i.model)||this)._extensionChannel={},r._computeExChannel={},r._attributeContext=i.attributeContext,null===(n=i.map)||void 0===n||n.set(r.id,r),r}return S(e,t),e.prototype.created=function(){this._initStyle()},e.prototype.initStyleWithSpec=function(t,e){t&&(N(t.id)&&(this._userId=t.id),z(t.interactive)&&(this._markConfig.interactive=t.interactive),N(t.zIndex)&&(this._markConfig.zIndex=t.zIndex),z(t.visible)&&this.setVisible(t.visible),this._initSpecStyle(t,this.stateStyle,e))},e.prototype._transformStyleValue=function(t,e){if(t.scale){var i=t.scale,n=i.range();return i.range(n.map(e)),t}return"function"==typeof t?function(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];return e(t.apply(void 0,P([],E(i),!1)))}:e(t)},e.prototype.convertAngleToRadian=function(t){return this._transformStyleValue(t,we)},e.prototype.isUserLevel=function(t){return[CU.User_Mark,CU.User_Series,CU.User_Chart,CU.User_SeriesStyle].includes(t)},e.prototype.setStyle=function(t,e,i,n){var r=this;if(void 0===e&&(e="normal"),void 0===i&&(i=0),void 0===n&&(n=this.stateStyle),!j(t)){void 0===n[e]&&(n[e]={});var a=this.isUserLevel(i);Object.keys(t).forEach((function(o){var s=t[o];j(s)||(s=r._filterAttribute(o,s,e,i,a,n),r.setAttribute(o,s,e,i,n))}))}},e.prototype.getStyle=function(t,e){var i;return void 0===e&&(e="normal"),null===(i=this.stateStyle[e][t])||void 0===i?void 0:i.style},e.prototype._filterAttribute=function(t,e,i,n,r,a){var o=this;void 0===a&&(a=this.stateStyle);var s=this._styleConvert(e);if(r)switch(t){case"angle":s=this.convertAngleToRadian(s);break;case"innerPadding":case"outerPadding":s=this._transformStyleValue(s,(function(t){return-t}));break;case"curveType":s=this._transformStyleValue(s,(function(t){return e=t,i=o._option.model.direction,"monotone"===e?"horizontal"===i?"monotoneY":"monotoneX":e;var e,i}))}return s},e.prototype.setReferer=function(t,e,i,n){var r,a;if(void 0===n&&(n=this.stateStyle),t)if(e&&i){var o=null!==(a=n[i])&&void 0!==a?a:((r={})[e]={},r);n[i][e]=A(A({},o[e]),{referer:t})}else Object.entries(n).forEach((function(e){var i=E(e,2),r=i[0],a=i[1];Object.entries(a).forEach((function(e){var i=E(e,2),a=i[0];i[1],n[r][a].referer=t}))}))},e.prototype.setPostProcess=function(t,e,i){var n;void 0===i&&(i="normal"),(null===(n=this.stateStyle[i])||void 0===n?void 0:n[t])&&(this.stateStyle[i][t].postProcess=e)},e.prototype.getAttribute=function(t,e,i,n){return void 0===i&&(i="normal"),this._computeAttribute(t,i)(e,n)},e.prototype.setAttribute=function(t,e,i,n,r){var a;void 0===i&&(i="normal"),void 0===n&&(n=0),void 0===r&&(r=this.stateStyle),void 0===r[i]&&(r[i]={}),void 0===r[i][t]&&(r[i][t]={level:n,style:e,referer:void 0});var o=null===(a=r[i][t])||void 0===a?void 0:a.level;N(o)&&o<=n&&xz(r[i][t],{style:e,level:n}),"normal"!==i&&t in this._extensionChannel&&this._extensionChannel[t].forEach((function(t){void 0===r[i][t]&&(r[i][t]=r.normal[t])}))},e.prototype._getDefaultStyle=function(){return{visible:!0,x:0,y:0}},e.prototype._styleConvert=function(t){if(!t)return t;if(VB(t.type)||t.scale){var e=function(t,e){if("scale"in t&&t.scale)return Y(t.scale)&&(null==e?void 0:e.globalScale)?e.globalScale.registerMarkAttributeScale(t,e.seriesId):t.scale;var i=pF(t.type);return i&&function(t,e){t&&e&&(e.domain&&t.domain(e.domain),e.range&&t.range(e.range),e.specified&&t.specified&&t.specified(e.specified),e.clamp&&t.clamp&&t.clamp(e.clamp))}(i,t),i}(t,{globalScale:this._option.globalScale,seriesId:this._option.seriesId});if(e)return{scale:e,field:t.field,changeDomain:t.changeDomain}}return t},e.prototype._computeAttribute=function(t,e){var i,n=this,r=null===(i=this.stateStyle[e])||void 0===i?void 0:i[t];r||(r=this.stateStyle.normal[t]);var a=this._computeStateAttribute(r,t,e),o=H(null==r?void 0:r.postProcess),s=t in this._computeExChannel;if(o&&s){var l=this._computeExChannel[t];return function(i,o){var s=a(i,o);return s=r.postProcess(s,i,n._attributeContext,o,n.getDataView()),l(t,i,e,o,s)}}if(o)return function(t,e){return r.postProcess(a(t,e),t,n._attributeContext,e,n.getDataView())};if(s){var u=this._computeExChannel[t];return function(i,n){return u(t,i,e,n,a(i,n))}}return a},e.prototype._computeStateAttribute=function(t,e,i){var n,r=this;return t?t.referer?t.referer._computeAttribute(e,i):t.style?"function"==typeof t.style?function(e,i){return t.style(e,r._attributeContext,i,r.getDataView())}:ZU.includes(t.style.gradient)?this._computeGradientAttr(t.style):["outerBorder","innerBorder"].includes(e)?this._computeBorderAttr(t.style):VB(null===(n=t.style.scale)||void 0===n?void 0:n.type)?function(e,i){var n=e;return"series"===r.model.modelType&&r.model.getMarkData&&(n=r.model.getMarkData(e)),t.style.scale.scale(n[t.style.field])}:function(e,i){return t.style}:function(e,i){return t.style}:function(t,e){}},e.prototype._initStyle=function(){var t=this._getDefaultStyle();this.setStyle(t,"normal",0)},e.prototype._initSpecStyle=function(t,e,i){var n=this;t.style&&this.setStyle(t.style,"normal",CU.User_Mark,e);var r=t.state;r&&Object.keys(r).forEach((function(t){var i=r[t];if("style"in i){var a=i.style,o={stateValue:t};"level"in i&&(o.level=i.level),"filter"in i&&(o=H(i.filter)?A({filter:i.filter},o):A(A({},i.filter),o)),n.state.addStateInfo(o),n.setStyle(a,t,CU.User_Mark,e)}else n.setStyle(i,t,CU.User_Mark,e)}))},e.prototype._computeGradientAttr=function(t){var e,i,n=this,r=t.gradient,a=t.scale,o=t.field,s=M(t,["gradient","scale","field"]),l=a,u=o;if(!(a&&o||"series"!==this.model.modelType)){var c=this.model.getColorAttribute(),h=c.scale,d=c.field;a||(l=h),u||(u=d)}var p=rF(nF(this.model.getColorScheme(),"series"===this.model.modelType?null===(i=(e=this.model).getSpec)||void 0===i?void 0:i.call(e):void 0),this.model.getDefaultColorDomain()),f=A(A({},JU[r]),s);return function(t,e){var i={},a=n.getDataView();return Object.keys(f).forEach((function(r){var o=f[r];"stops"===r?i.stops=o.map((function(i){var r=i.opacity,o=i.color,s=i.offset,c=null!=o?o:null==l?void 0:l.scale(t[u]);return H(o)&&(c=o(t,n._attributeContext,e,a)),N(r)&&(c=Ti.SetOpacity(c,r)),{offset:H(s)?s(t,n._attributeContext,e,a):s,color:c||p[0]}})):H(o)?i[r]=o(t,n._attributeContext,e,a):i[r]=o})),i.gradient=r,i}},e.prototype._computeBorderAttr=function(t){var e=this,i=t.scale,n=t.field,r=M(t,["scale","field"]);return function(t,a){var o,s,l,u={};if(Object.keys(r).forEach((function(i){var n=r[i];H(n)?u[i]=n(t,e._attributeContext,a,e.getDataView()):u[i]=n})),"stroke"in u)ZU.includes(null===(l=r.stroke)||void 0===l?void 0:l.gradient)&&(u.stroke=e._computeGradientAttr(r.stroke)(t,a));else{var c=rF(nF(e.model.getColorScheme(),"series"===e.model.modelType?null===(s=(o=e.model).getSpec)||void 0===s?void 0:s.call(o):void 0),e.model.getDefaultColorDomain()),h=i,d=n;if(!(i&&n||"series"!==e.model.modelType)){var p=e.model.getColorAttribute(),f=p.scale,v=p.field;i||(h=f),d||(d=v),u.stroke=(null==h?void 0:h.scale(t[d]))||c[0]}}return u}},e}(rY),oY=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i._marks=[],i}return S(e,t),e.prototype.getMarks=function(){return this._marks},e.prototype._getDefaultStyle=function(){return A({},t.prototype._getDefaultStyle.call(this))},e.prototype.isMarkExist=function(t){return void 0!==this._marks.find((function(e){return e.id===t.id}))},e.prototype.addMark=function(t){return this.isMarkExist(t)?(Dk("Mark already exists, add mark failed."),!1):(this._marks.push(t),!0)},e.prototype.removeMark=function(t){var e=this._marks.findIndex((function(e){return e.id===t.id||e.name===t.name}));return-1===e?(Dk("Mark does not exists, removeMark failed."),!1):(this._marks.splice(e,1),!0)},e.prototype.getMarkInType=function(t){return this._marks.filter((function(e){return e.type===t}))},e.prototype.getMarkInId=function(t){return this._marks.find((function(e){return e.id===t}))},e.prototype.getMarkInUserId=function(t){var e;if(this._marks.forEach((function(i){i.getUserId()===t&&(e=i)})),!e)for(var i=0;i<this._marks.length;i++){var n=this._marks[i];if("group"===n.type&&(e=n.getMarkInUserId(t)),e)break}return e},e.prototype.getMarkInName=function(t){return this._marks.filter((function(e){return e.name===t}))},e.prototype._compileProduct=function(e){var i=this;t.prototype._compileProduct.call(this,e),this._product.configure({zIndex:this._markConfig.zIndex}),(null==e?void 0:e.ignoreChildren)||this.getMarks().forEach((function(t){t.getProduct()&&t.removeProduct(),t.compile({group:i._product})}))},e.type="group",e}(aY),sY=function(){CP(),cP(),xj.registerGraphic(MH.group,Iv),kz.registerMark(oY.type,oY)},lY={measureText:Wz},uY=function(){function t(){this.functions={}}return t.instance=function(){return t.instance_||(t.instance_=new t),t.instance_},t.prototype.registerFunction=function(t,e){t&&e&&(this.functions[t]=e)},t.prototype.unregisterFunction=function(t){t&&delete this.functions[t]},t.prototype.getFunction=function(t){return this.functions[t]||null},t.prototype.getFunctionNameList=function(){return Object.keys(this.functions)},t}(),cY=function(){CA(Ac)},hY=function(){qw(Ac)},dY=function(){function t(){this.id=Gk(),this._plugins=[]}return t.prototype.add=function(t){var e=this;if(!t||0===t.length)return null;var i=[];return t.forEach((function(t){e._plugins.find((function(e){return e.id===t.id}))?Dk("不要重复添加相同的plugin"):(e._plugins.push(t),i.push(t),t.onAdd&&t.onAdd(e))})),i},t.prototype.load=function(t){var e=this.add(t);e&&e.length&&this.activate(t)},t.prototype.activate=function(t){t.length&&t.forEach((function(t){t.init&&t.init()}))},t.prototype.get=function(t){return this._plugins.find((function(e){return e.id===t}))},t.prototype.getAll=function(){return this._plugins.slice()},t.prototype.release=function(t){var e=this.get(t);e&&(e.release(this),this._plugins=this._plugins.filter((function(t){return t!==e})))},t.prototype.releaseAll=function(){var t=this;this._plugins.forEach((function(e){e.release(t)})),this._plugins=[]},t.prototype.clear=function(t){var e=this.get(t);e&&e.clear(this)},t.prototype.clearAll=function(){var t=this;this._plugins.forEach((function(e){var i;null===(i=e.clear)||void 0===i||i.call(e,t)}))},t}(),pY=function(t){function e(e){var i=t.call(this)||this;return i.globalInstance=e,i}return S(e,t),e.prototype.onInit=function(t){var e=this;this._plugins.forEach((function(i){i.onInit&&i.onInit(e,t)}))},e.prototype.onBeforeResize=function(t,e){var i=this;this._plugins.forEach((function(n){n.onBeforeResize&&n.onBeforeResize(i,t,e)}))},e.prototype.onAfterChartSpecTransform=function(t,e){var i=this;this._plugins.forEach((function(n){n.onAfterChartSpecTransform&&n.onAfterChartSpecTransform(i,t,e)}))},e.prototype.onAfterModelSpecTransform=function(t,e,i){var n=this;this._plugins.forEach((function(r){r.onAfterModelSpecTransform&&r.onAfterModelSpecTransform(n,t,e,i)}))},e.prototype.onBeforeInitChart=function(t,e){var i=this;this._plugins.forEach((function(n){n.onBeforeInitChart&&n.onBeforeInitChart(i,t,e)}))},e.prototype.releaseAll=function(){t.prototype.releaseAll.call(this),this.globalInstance=null},e}(dY),fY=new Map;function vY(t,e){fY.has(t)&&Dk("svg source key of '".concat(t,"' already exists, will be overwritten.")),tY||ZG(tY=new Ss,"svg",fs);var i=new Ms(tY);i.parse(e,{type:"svg"}),fY.set(t,i)}function gY(t){fY.has(t)?fY.delete(t):Dk("map type of '".concat(t,"' does not exists."))}function yY(t){return fY.get(t)}var mY=function(){function e(e,i){var n,r,a,o,s,l,u,c,h=this;this.id=Gk(),this._userEvents=[],this._autoSize=!0,this._option={mode:t.RenderModeEnum["desktop-browser"],onError:function(t){throw new Error(t)},optimize:{disableCheckGraphicWidthOutRange:!0}},this._observer=null,this._context={},this._doResize=function(){var t=h.getCurrentSize(),e=t.width,i=t.height;h._currentSize.width===e&&h._currentSize.height===i||(h._currentSize={width:e,height:i},h.resizeSync(e,i))},this._renderSync=function(t){var e;void 0===t&&(t={});var i=h;return h._beforeRender(t)?(null===(e=h._compiler)||void 0===e||e.render(t.morphConfig),h._afterRender(),i):i},this._updateSpec=function(t,e,i){var n,r;void 0===e&&(e=!1);var a=h._spec,o={changeBackground:!1,reTransformSpec:!1,change:!1,reMake:!1,reCompile:!1,reSize:!1,changeTheme:!1};if(h._setNewSpec(t,e)){mt(a.theme,h._spec.theme)?mt(h._spec.background,a.background)||(o.reMake=!0,o.changeBackground=!0):o.changeTheme=!0;var s=h._shouldChartResize(a);if(o.reSize=s,h._spec.type!==a.type)return null===(r=null===(n=h._compiler)||void 0===n?void 0:n.getVGrammarView())||void 0===r||r.updateLayoutTag(),o.reMake=!0,o.reTransformSpec=!0,o.change=!0,o.changeTheme=!0,o;h._initChartSpec(h._spec,"updateSpec");var l=mU(h._chart.updateSpec(h._spec),o);return i?A(A({},l),i):l}},this._option=A(A(A({},this._option),{animation:!1!==e.animation}),i),(null==i?void 0:i.optimize)&&(this._option.optimize=A(A({},this._option.optimize),i.optimize)),this._onError=null===(n=this._option)||void 0===n?void 0:n.onError;var d=this._option,p=d.dom,f=d.renderCanvas,v=d.mode,g=d.stage,y=d.poptip,m=M(d,["dom","renderCanvas","mode","stage","poptip"]),_=jk(v);if(_?cY():"node"===v&&hY(),_&&p&&(this._container=Y(p)?ex.getElementById(p):p),f&&(this._canvas=f),g&&(this._stage=g),"node"===v||this._container||this._canvas||this._stage){this._viewBox=this._option.viewBox,this._currentThemeName=Hz.getCurrentThemeName(),this._setNewSpec(e),this._updateCurrentTheme(),this._currentSize=this.getCurrentSize();var b=[];!1!=!y&&b.push("poptipForText"),"sankey"===e.type&&b.push("scrollbar");var x=A({},m.performanceHook||{});Object.keys(x).forEach((function(t){m.performanceHook[t]=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];x[t].apply(x,P(P([],E(e),!1),[h],!1))}})),this._compiler=new pU({dom:null!==(a=this._container)&&void 0!==a?a:"none",canvas:f},A(A({mode:this._option.mode,stage:g,pluginList:b},m),{background:this._getBackground(),onError:this._onError})),this._compiler.setSize(this._currentSize.width,this._currentSize.height),this._eventDispatcher=new KG(this,this._compiler),this._event=new UG(this._eventDispatcher,v),this._compiler.initView(),this._setFontFamilyTheme(null===(o=this._currentTheme)||void 0===o?void 0:o.fontFamily),this._initDataSet(this._option.dataSet),this._autoSize=!!_&&(null===(l=null!==(s=e.autoFit)&&void 0!==s?s:this._option.autoFit)||void 0===l||l),this._bindResizeEvent(),this._bindVGrammarViewEvent(),this._initChartPlugin(),zz.registerInstance(this),null===(c=null===(u=this._option.performanceHook)||void 0===u?void 0:u.afterCreateVChart)||void 0===c||c.call(u,this)}else null===(r=this._option)||void 0===r||r.onError("please specify container or renderCanvas!")}return e.useRegisters=function(t){t.forEach((function(t){"function"==typeof t?t():console.error("Invalid function:",t)}))},e.useChart=function(t){t.forEach((function(t){return kz.registerChart(t.type,t)}))},e.useSeries=function(t){t.forEach((function(t){return kz.registerSeries(t.type,t)}))},e.useComponent=function(t){t.forEach((function(t){return kz.registerComponent(t.type,t)}))},e.useMark=function(t){t.forEach((function(t){var e;return kz.registerMark(null!==(e=t.constructorType)&&void 0!==e?e:t.type,t)}))},e.useLayout=function(t){t.forEach((function(t){return kz.registerLayout(t.type,t)}))},e.registerDataSetTransform=function(t,e){kz.registerTransform(t,e)},e.registerFunction=function(t,e){t&&e&&uY.instance().registerFunction(t,e)},e.unregisterFunction=function(t){t&&uY.instance().unregisterFunction(t)},e.getFunction=function(t){return t?uY.instance().getFunction(t):null},e.getFunctionList=function(){return uY.instance().getFunctionNameList()},e.registerMap=function(t,e,i){var n=kz.getImplementInKey("registerMap");n&&n(t,e,i)},e.unregisterMap=function(t){var e=kz.getImplementInKey("unregisterMap");e&&e(t)},e.getMap=function(t){return e=t,QG.get(e);var e},e.registerSVG=function(t,e,i){var n=kz.getImplementInKey("registerSVG");n&&n(t,e,i)},e.unregisterSVG=function(t){var e=kz.getImplementInKey("unregisterSVG");e&&e(t)},e.getSVG=function(t){return yY(t)},e.hideTooltip=function(t){void 0===t&&(t=[]),zz.forEach((function(t){var e;return null===(e=null==t?void 0:t.hideTooltip)||void 0===e?void 0:e.call(t)}),t)},e.getLogger=function(){return Lt.getInstance()},e.prototype.getSpec=function(){return this._spec},e.prototype.getSpecInfo=function(){return this._specInfo},e.prototype.getDataSet=function(){return this._dataSet},e.prototype._setNewSpec=function(t,e){return!!t&&(Y(t)&&(t=JSON.parse(t)),e&&this._originalSpec&&(t=xz({},this._originalSpec,t)),this._originalSpec=t,this._spec=this._getSpecFromOriginalSpec(),!0)},e.prototype._getSpecFromOriginalSpec=function(){var t,e=Nz(this._originalSpec);return e.data=null!==(t=e.data)&&void 0!==t?t:[],e},e.prototype._initChartSpec=function(t,i){var n,r;e.getFunctionList()&&e.getFunctionList().length&&(t=Vz(t,e)),this._spec=t,this._chartSpecTransformer||(this._chartSpecTransformer=kz.createChartSpecTransformer(this._spec.type,this._getChartOption(this._spec.type))),null===(n=this._chartSpecTransformer)||void 0===n||n.transformSpec(this._spec),this._chartPluginApply("onAfterChartSpecTransform",this._spec,i),this._specInfo=null===(r=this._chartSpecTransformer)||void 0===r?void 0:r.transformModelSpec(this._spec),this._chartPluginApply("onAfterModelSpecTransform",this._spec,this._specInfo,i)},e.prototype._updateSpecInfo=function(){var t;this._chartSpecTransformer||(this._chartSpecTransformer=kz.createChartSpecTransformer(this._spec.type,this._getChartOption(this._spec.type))),this._specInfo=null===(t=this._chartSpecTransformer)||void 0===t?void 0:t.createSpecInfo(this._spec)},e.prototype._initChart=function(t){var e,i,n;if(this._compiler)if(this._chart)null===(i=this._option)||void 0===i||i.onError("chart is already initialized");else{var r=kz.createChart(t.type,t,this._getChartOption(t.type));r?(this._chart=r,this._chart.setCanvasRect(this._currentSize.width,this._currentSize.height),this._chart.created(this._chartSpecTransformer),this._chart.init(),this._event.emit(cG.initialized,{chart:r,vchart:this})):null===(n=this._option)||void 0===n||n.onError("init chart fail")}else null===(e=this._option)||void 0===e||e.onError("compiler is not initialized")},e.prototype._releaseData=function(){this._dataSet&&(this._dataSet.dataViewMap={},this._dataSet=null)},e.prototype._bindVGrammarViewEvent=function(){var t=this;if(this._compiler){var e=this._compiler.getVGrammarView();e.addEventListener(DH.ALL_ANIMATION_END,(function(){t._event.emit(cG.animationFinished,{chart:t._chart,vchart:t})})),e.addEventListener(DH.AFTER_VRENDER_NEXT_RENDER,(function(){t._event.emit(cG.renderFinished,{chart:t._chart,vchart:t})}))}},e.prototype._bindResizeEvent=function(){var t,e;if(this._autoSize){if(this._onResize=Zt(this._doResize,null!==(t=this._option.resizeDelay)&&void 0!==t?t:100),this._container){var i=window.ResizeObserver;i&&(this._observer=new i(this._onResize),null===(e=this._observer)||void 0===e||e.observe(this._container))}window.addEventListener("resize",this._onResize)}},e.prototype._unBindResizeEvent=function(){this._autoSize&&(window.removeEventListener("resize",this._onResize),this._observer&&(this._observer.disconnect(),this._observer=null))},e.prototype.getCurrentSize=function(){var t,e,i,n;return yU(this._spec,{container:this._container,canvas:this._canvas,mode:this._getMode(),modeParams:this._option.modeParams},{width:null!==(e=null===(t=this._currentSize)||void 0===t?void 0:t.width)&&void 0!==e?e:IF,height:null!==(n=null===(i=this._currentSize)||void 0===i?void 0:i.height)&&void 0!==n?n:LF})},e.prototype._initDataSet=function(t){for(var e in this._dataSet=t instanceof Ss?t:new Ss,ZG(this._dataSet,"dataview",os),ZG(this._dataSet,"array",I),qG(this._dataSet,"copyDataView",oU),kz.transforms)qG(this._dataSet,e,kz.transforms[e]);for(var e in kz.dataParser)ZG(this._dataSet,e,kz.dataParser[e])},e.prototype.updateCustomConfigAndRerender=function(t,e,i){if(void 0===i&&(i={}),!this._isReleased&&t)return H(t)&&(t=t()),t.reAnimate&&(this.stopAnimation(),this._updateAnimateState(!0)),this._reCompile(t),e?this._renderSync(i):this._renderAsync(i)},e.prototype._updateCustomConfigAndRecompile=function(t,e){return void 0===e&&(e={}),!!t&&(this._reCompile(t),this._beforeRender(e))},e.prototype._reCompile=function(t,e){var i,n,r,a,o,s,l,u,c,h,d=this;if(t.reMake&&(this._releaseData(),this._initDataSet(),null===(i=this._chart)||void 0===i||i.release(),this._chart=null),t.reTransformSpec&&(this._chartSpecTransformer=null),t.changeTheme?(this._setCurrentTheme(),this._setFontFamilyTheme(null===(n=this._currentTheme)||void 0===n?void 0:n.fontFamily)):t.changeBackground&&(null===(r=this._compiler)||void 0===r||r.setBackground(this._getBackground())),t.reMake)null===(a=this._compiler)||void 0===a||a.releaseGrammar(!1===(null===(o=this._option)||void 0===o?void 0:o.animation)||!1===(null===(s=this._spec)||void 0===s?void 0:s.animation)),this._userEvents.forEach((function(t){var e;return null===(e=d._event)||void 0===e?void 0:e.on(t.eType,t.query,t.handler)})),t.reSize&&this._doResize();else if(t.reCompile&&(null===(l=this._compiler)||void 0===l||l.clear({chart:this._chart,vChart:this},!1===(null===(u=this._option)||void 0===u?void 0:u.animation)||!1===(null===(c=this._spec)||void 0===c?void 0:c.animation)),null===(h=this._compiler)||void 0===h||h.compile({chart:this._chart,vChart:this},{})),t.reSize){var p=this.getCurrentSize(),f=p.width,v=p.height;this._chart.onResize(f,v,!1),this._compiler.resize(f,v,!1)}},e.prototype._beforeRender=function(t){var e,i,n,r,a,o,s,l;if(void 0===t&&(t={}),this._isReleased)return!1;if(this._chart)return!0;var u=t.transformSpec,c=t.actionSource;return u&&this._initChartSpec(this._spec,"render"),this._chartPluginApply("onBeforeInitChart",this._spec,c),null===(i=null===(e=this._option.performanceHook)||void 0===e?void 0:e.beforeInitializeChart)||void 0===i||i.call(e,this),this._initChart(this._spec),null===(r=null===(n=this._option.performanceHook)||void 0===n?void 0:n.afterInitializeChart)||void 0===r||r.call(n,this),!(!this._chart||!this._compiler)&&(null===(o=null===(a=this._option.performanceHook)||void 0===a?void 0:a.beforeCompileToVGrammar)||void 0===o||o.call(a),this._compiler.compile({chart:this._chart,vChart:this},{performanceHook:this._option.performanceHook}),null===(l=null===(s=this._option.performanceHook)||void 0===s?void 0:s.afterCompileToVGrammar)||void 0===l||l.call(s),!0)},e.prototype._afterRender=function(){return!this._isReleased&&(this._updateAnimateState(),this._event.emit(cG.rendered,{chart:this._chart,vchart:this}),!0)},e.prototype.renderSync=function(t){return this._renderSync({morphConfig:t,transformSpec:!0,actionSource:"render"})},e.prototype.renderAsync=function(t){return w(this,void 0,void 0,(function(){return T(this,(function(e){return[2,this._renderAsync({morphConfig:t,transformSpec:!0,actionSource:"render"})]}))}))},e.prototype._renderAsync=function(t){return void 0===t&&(t={}),w(this,void 0,void 0,(function(){return T(this,(function(e){return[2,this._renderSync(t)]}))}))},e.prototype._updateAnimateState=function(t){var e,i;if(this._option.animation){var n=t?rU.appear:rU.update;null===(e=this._chart)||void 0===e||e.getAllRegions().forEach((function(t){var e;null===(e=t.animate)||void 0===e||e.updateAnimateState(n,!0)})),null===(i=this._chart)||void 0===i||i.getAllComponents().forEach((function(t){var e;null===(e=t.animate)||void 0===e||e.updateAnimateState(n,!0)}))}},e.prototype.release=function(){var t,e,i,n;(null===(t=this._onResize)||void 0===t?void 0:t.cancel)&&this._onResize.cancel(),this._chartPluginApply("releaseAll"),this._chartPlugin=null,this._chartSpecTransformer=null,null===(e=this._chart)||void 0===e||e.release(),null===(i=this._eventDispatcher)||void 0===i||i.release(),null===(n=this._compiler)||void 0===n||n.release(),this._unBindResizeEvent(),this._releaseData(),this._onError=null,this._onResize=null,this._container=null,this._currentTheme=null,this._option=null,this._chart=null,this._compiler=null,this._spec=null,this._specInfo=null,this._originalSpec=null,this._userEvents=null,this._event=null,this._eventDispatcher=null,this._isReleased=!0,zz.unregisterInstance(this)},e.prototype.updateData=function(t,e,i,n){return w(this,void 0,void 0,(function(){return T(this,(function(r){return[2,this.updateDataSync(t,e,i,n)]}))}))},e.prototype._updateDataById=function(t,e,i){var n=this._spec.data.find((function(e){return e.name===t||e.id===t}));n?n.id===t?n.values=e:n.name===t&&n.parse(e,i):X(e)?this._spec.data.push({id:t,values:e}):this._spec.data.push(e)},e.prototype.updateDataInBatches=function(t){return w(this,void 0,void 0,(function(){var e=this;return T(this,(function(i){return this._chart?(this._chart.updateFullData(t.map((function(t){return{id:t.id,values:t.data,parser:t.options}}))),this._chart.updateGlobalScaleDomain(),this._compiler.render(),[2,this]):(this._spec.data=xt(this._spec.data),t.forEach((function(t){var i=t.id,n=t.data,r=t.options;e._updateDataById(i,n,r)})),[2,this])}))}))},e.prototype.updateDataSync=function(t,e,i,n){return j(this._dataSet)?this:this._chart?((null==n?void 0:n.reAnimate)&&(this.stopAnimation(),this._updateAnimateState(!0)),this._chart.updateData(t,e,!0,i),this._compiler.render(),this):(this._spec.data=xt(this._spec.data),this._updateDataById(t,e,i),this)},e.prototype.updateFullDataSync=function(t,e,i){var n=this;if(void 0===e&&(e=!0),this._chart)return(null==i?void 0:i.reAnimate)&&(this.stopAnimation(),this._updateAnimateState(!0)),this._chart.updateFullData(t),e&&this._compiler.render(),this;var r=xt(this._spec.data);return xt(t).forEach((function(t){var e=t.id,i=t.values,a=t.parser,o=t.fields,s=r.find((function(t){return t.name===e}));if(s)s instanceof Ms?(s.setFields(ct(o)),s.parse(i,ct(a))):(s.values=i,N(a)&&(s.parser=a),N(o)&&(s.fields=o));else{var l=lU(t,n._dataSet,r);X(n._spec.data)&&n._spec.data.push(l)}})),this},e.prototype.updateFullData=function(t,e){return void 0===e&&(e=!0),w(this,void 0,void 0,(function(){return T(this,(function(i){return[2,this.updateFullDataSync(t,e)]}))}))},e.prototype.updateSpec=function(t,e,i,n){return void 0===e&&(e=!1),w(this,void 0,void 0,(function(){var r;return T(this,(function(a){switch(a.label){case 0:return(r=this._updateSpec(t,e,n))?[4,this.updateCustomConfigAndRerender(r,!1,{morphConfig:i,transformSpec:r.reTransformSpec,actionSource:"updateSpec"})]:[2,this];case 1:return a.sent(),[2,this]}}))}))},e.prototype.updateSpecSync=function(t,e,i,n){void 0===e&&(e=!1);var r=this._updateSpec(t,e,n);return r?(this.updateCustomConfigAndRerender(r,!0,{morphConfig:i,transformSpec:r.reTransformSpec,actionSource:"updateSpec"}),this):this},e.prototype.updateSpecAndRecompile=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i={});var n=this._updateSpec(t,e);return this._updateCustomConfigAndRecompile(n,A({actionSource:"updateSpecAndRecompile"},i))},e.prototype.updateModelSpec=function(t,e,i,n){return void 0===i&&(i=!1),w(this,void 0,void 0,(function(){return T(this,(function(r){return[2,this.updateModelSpecSync(t,e,i,n)]}))}))},e.prototype.updateModelSpecSync=function(t,e,i,n){if(void 0===i&&(i=!1),!e||!this._spec)return this;if(Y(e)&&(e=JSON.parse(e)),H(t)||function(t,e,i,n){Object.keys(t).forEach((function(r){if(V(e))e.type===r&&(X(t[r])?t[r].length>=e.index&&(t[r][e.index]=n?xz({},t[r][e.index],i):i):t[r]=n?xz({},t[r],i):i);else if(X(t[r])){var a=t[r].findIndex((function(t){return t.id===e}));a>=0&&(t[r][a]=n?xz({},t[r][a],i):i)}else t.id===e&&(t[r]=n?xz({},t[r],i):i)}))}(this._spec,t,e,i),this._chart){var r=this._chart.getModelInFilter(t);if(r)return this._updateModelSpec(r,e,!0,i,n)}return this},e.prototype._updateModelSpec=function(t,e,i,n,r){void 0===i&&(i=!1),void 0===n&&(n=!1),n&&(e=xz({},t.getSpec(),e));var a=t.updateSpec(e);return t.reInit(e),(a.change||a.reCompile||a.reMake||a.reSize||a.reRender)&&this._chart.reDataFlow(),this.updateCustomConfigAndRerender(a,i,{morphConfig:r,transformSpec:!1,actionSource:"updateModelSpec"})},e.prototype.resize=function(t,e){return w(this,void 0,void 0,(function(){return T(this,(function(i){return[2,this.resizeSync(t,e)]}))}))},e.prototype.resizeSync=function(t,e){var i,n;return this._beforeResize(t,e)?(null===(n=(i=this._compiler).resize)||void 0===n||n.call(i,t,e),this._afterResize()):this},e.prototype._beforeResize=function(t,e){var i,n,r,a;if(!this._chart||!this._compiler)return!1;var o=this._chart.getCanvasRect();return(!o||o.width!==t||o.height!==e)&&(this._chartPluginApply("onBeforeResize",t,e),null===(n=null===(i=this._option.performanceHook)||void 0===i?void 0:i.beforeResizeWithUpdate)||void 0===n||n.call(i),this._chart.onResize(t,e,!1),null===(a=null===(r=this._option.performanceHook)||void 0===r?void 0:r.afterResizeWithUpdate)||void 0===a||a.call(r),!0)},e.prototype._afterResize=function(){return this._isReleased||this._event.emit(cG.afterResize,{chart:this._chart}),this},e.prototype.updateViewBox=function(t,e,i){return void 0===e&&(e=!0),void 0===i&&(i=!0),this._chart&&this._compiler?(this._viewBox=t,this._chart.updateViewBox(t,i),i&&(this._compiler.render(),this._chart.onEvaluateEnd()),this._compiler.updateViewBox(t,e),this):this},e.prototype.on=function(t,e,i){var n;this._userEvents&&(this._userEvents.push({eType:t,query:"function"==typeof e?null:e,handler:"function"==typeof e?e:i}),null===(n=this._event)||void 0===n||n.on(t,e,i))},e.prototype.off=function(t,e){var i,n=this;if(this._userEvents&&0!==this._userEvents.length)if(e){var r=this._userEvents.findIndex((function(i){return i.eType===t&&i.handler===e}));r>=0&&(this._userEvents.splice(r,1),null===(i=this._event)||void 0===i||i.off(t,e))}else this._userEvents.forEach((function(e){var i;e.eType===t&&(null===(i=n._event)||void 0===i||i.off(t,e.handler))})),this._userEvents=this._userEvents.filter((function(e){return e.eType!==t}))},e.prototype.updateState=function(t,e){this._chart&&this._chart.updateState(t,e)},e.prototype.setSelected=function(t,e,i){this._chart&&this._chart.setSelected(t,e,i)},e.prototype.setHovered=function(t,e,i){this._chart&&this._chart.setHovered(t,e,i)},e.prototype.clearState=function(t){this._chart&&this._chart.clearState(t)},e.prototype.clearAllStates=function(){this._chart&&this._chart.clearAllStates()},e.prototype.clearSelected=function(){this._chart&&this._chart.clearSelected()},e.prototype.clearHovered=function(){this._chart&&this._chart.clearHovered()},e.prototype._updateCurrentTheme=function(t){var e,i,n,r=this._option.theme,a=null===(e=this._spec)||void 0===e?void 0:e.theme,o=null===(i=this._spec)||void 0===i?void 0:i.type;t&&(this._currentThemeName=t);var s,l,u=function(t,e){var i;return(null===(i=e.chart)||void 0===i?void 0:i[t])&&(e=Sz({},e,e.chart[t])),e};if(ot(r)&&ot(a))s=jz(this._currentThemeName,!0),this._currentTheme=u(o,s);else if(Y(r)&&(!a||Y(a))||Y(a)&&(!r||Y(r))){var c=Sz({},jz(this._currentThemeName,!0),jz(r,!0),jz(a,!0));this._currentTheme=u(o,c)}else{c=Sz({},jz(this._currentThemeName),jz(r),jz(a));this._currentTheme=Tz(u(o,c))}l=st(this._currentTheme,"component.poptip"),ft(kR.poptip,xR,l),null===(n=this._compiler)||void 0===n||n.setBackground(this._getBackground())},e.prototype._shouldChartResize=function(t){var e,i,n=!1;j(this._spec.width)?!j(t.width)&&(this._spec.width=t.width):this._spec.width!==t.width&&(n=!0),j(this._spec.height)?!j(t.height)&&(this._spec.height=t.height):this._spec.height!==t.height&&(n=!0);var r=this._autoSize;return this._autoSize=!!jk(this._option.mode)&&(null===(i=null!==(e=this._spec.autoFit)&&void 0!==e?e:this._option.autoFit)||void 0===i||i),this._autoSize!==r&&(n=!0),n},e.prototype._getBackground=function(){return("string"==typeof this._spec.background||V(this._spec.background)&&this._spec.background.gradient?this._spec.background:null)||this._currentTheme.background||this._option.background},e.prototype.getCurrentTheme=function(){return jz(this._currentThemeName)},e.prototype.getCurrentThemeName=function(){return this._currentThemeName},e.prototype.setCurrentTheme=function(t){return w(this,void 0,void 0,(function(){return T(this,(function(e){return[2,this.setCurrentThemeSync(t)]}))}))},e.prototype.setCurrentThemeSync=function(t){var e;if(!Hz.themeExist(t))return this;var i=this._setCurrentTheme(t);return this._setFontFamilyTheme(null===(e=this._currentTheme)||void 0===e?void 0:e.fontFamily),this.updateCustomConfigAndRerender(i,!0,{transformSpec:!1,actionSource:"setCurrentTheme"}),this},e.prototype._setCurrentTheme=function(t){var e;return this._updateCurrentTheme(t),this._initChartSpec(this._getSpecFromOriginalSpec(),"setCurrentTheme"),null===(e=this._chart)||void 0===e||e.setCurrentTheme(),{change:!0,reMake:!1}},e.prototype._setFontFamilyTheme=function(t){var e;t&&(null===(e=this.getStage())||void 0===e||e.setTheme({text:{fontFamily:t},richtext:{fontFamily:t}}))},e.prototype._getTooltipComponent=function(){var t;return null===(t=this._chart)||void 0===t?void 0:t.getComponentsByType(B.tooltip)[0]},e.prototype.setTooltipHandler=function(t){var e,i;this._context.tooltipHandler=t;var n=this._getTooltipComponent();n&&(null===(i=null===(e=n.tooltipHandler)||void 0===e?void 0:e.release)||void 0===i||i.call(e),n.tooltipHandler=t)},e.prototype.getTooltipHandlerByUser=function(){var t;return null===(t=this._context)||void 0===t?void 0:t.tooltipHandler},e.prototype.getTooltipHandler=function(){var t=this._getTooltipComponent();return t?t.tooltipHandler:this._context.tooltipHandler},e.prototype.showTooltip=function(t,e){var i,n=this._getTooltipComponent();return null!==(i=N(t)&&"none"!==(null==n?void 0:n.showTooltip(t,e)))&&void 0!==i&&i},e.prototype.hideTooltip=function(){var t,e=this._getTooltipComponent();return null!==(t=null==e?void 0:e.hideTooltip())&&void 0!==t&&t},e.prototype.getLegendDataById=function(t){var e,i=null===(e=this._chart)||void 0===e?void 0:e.getComponentByUserId(t);return i?i.getLegendData():[]},e.prototype.getLegendDataByIndex=function(t){var e;void 0===t&&(t=0);var i=null===(e=this._chart)||void 0===e?void 0:e.getComponentsByType(B.discreteLegend);return i&&i[t]?i[t].getLegendData():[]},e.prototype.getLegendSelectedDataById=function(t){var e,i=null===(e=this._chart)||void 0===e?void 0:e.getComponentByUserId(t);return i?i.getSelectedData():[]},e.prototype.getLegendSelectedDataByIndex=function(t){var e;void 0===t&&(t=0);var i=null===(e=this._chart)||void 0===e?void 0:e.getComponentsByType(B.discreteLegend);return i&&i[t]?i[t].getSelectedData():[]},e.prototype.setLegendSelectedDataById=function(t,e){var i,n=null===(i=this._chart)||void 0===i?void 0:i.getComponentByUserId(t);n&&n.setSelectedData(e)},e.prototype.setLegendSelectedDataByIndex=function(t,e){var i;void 0===t&&(t=0);var n=null===(i=this._chart)||void 0===i?void 0:i.getComponentsByType(B.discreteLegend);n&&n[t]&&n[t].setSelectedData(e)},e.prototype.getDataURL=function(){var t;return w(this,void 0,void 0,(function(){var e;return T(this,(function(i){switch(i.label){case 0:return e=this.getStage(),this._chart&&e?(e.render(),[4,vU(this._chart.getCanvas(),{onError:this._onError})]):[3,2];case 1:return[2,i.sent()];case 2:return null===(t=this._option)||void 0===t||t.onError(new ReferenceError("render is not defined")),[2,null]}}))}))},e.prototype.exportImg=function(t){var e,i;return w(this,void 0,void 0,(function(){var n;return T(this,(function(r){switch(r.label){case 0:return jk(this._option.mode)?[4,this.getDataURL()]:(null===(e=this._option)||void 0===e||e.onError(new TypeError("non-browser environment can not export img")),[2]);case 1:return(n=r.sent())?function(t,e){void 0===t&&(t="vchart");var i=document.createElement("a");i.setAttribute("href",e),i.setAttribute("target","_blank"),i.setAttribute("download","".concat(t,".png")),i.dispatchEvent(new MouseEvent("click"))}(t,n):null===(i=this._option)||void 0===i||i.onError(new ReferenceError("render is not defined")),[2]}}))}))},e.prototype.exportCanvas=function(){var t,e=this.getStage();if(this._chart&&e)return e.toCanvas();null===(t=this._option)||void 0===t||t.onError(new ReferenceError("render is not defined"))},e.prototype.getImageBuffer=function(){var t,e;if("node"===this._option.mode){var i=this.getStage();return i?(i.render(),i.window.getImageBuffer()):(null===(e=this._option)||void 0===e||e.onError(new ReferenceError("render is not defined")),null)}null===(t=this._option)||void 0===t||t.onError(new TypeError("getImageBuffer() now only support node environment."))},e.prototype.setLayout=function(t){var e;this._option.layout=t,null===(e=this._chart)||void 0===e||e.setLayout(t)},e.prototype.reLayout=function(){var t;null===(t=this._chart)||void 0===t||t.setLayoutTag(!0)},e.prototype.getCompiler=function(){return this._compiler},e.prototype.getChart=function(){return this._chart},e.prototype.getStage=function(){return this._compiler.getStage()},e.prototype.getCanvas=function(){var t;return null===(t=this._compiler)||void 0===t?void 0:t.getCanvas()},e.prototype.getContainer=function(){var t,e;return N(this._container)?this._container:(e=Y(this._canvas)?ex.getElementById(this._canvas):this._canvas,N(e)?e.parentElement:null===(t=this.getCanvas())||void 0===t?void 0:t.parentElement)},e.prototype.getComponents=function(){return this._chart.getAllComponents()},e.prototype.getScale=function(t){var e,i=null===(e=this._chart)||void 0===e?void 0:e.getGlobalScale();return null==i?void 0:i.getScale(t)},e.prototype.setDimensionIndex=function(t,e){var i;return void 0===e&&(e={}),null===(i=this._chart)||void 0===i?void 0:i.setDimensionIndex(t,e)},e.prototype.stopAnimation=function(){var t,e,i;null===(i=null===(e=null===(t=this._compiler)||void 0===t?void 0:t.getVGrammarView())||void 0===e?void 0:e.animate)||void 0===i||i.stop()},e.prototype.pauseAnimation=function(){var t,e,i;null===(i=null===(e=null===(t=this._compiler)||void 0===t?void 0:t.getVGrammarView())||void 0===e?void 0:e.animate)||void 0===i||i.pause()},e.prototype.resumeAnimation=function(){var t,e,i;null===(i=null===(e=null===(t=this._compiler)||void 0===t?void 0:t.getVGrammarView())||void 0===e?void 0:e.animate)||void 0===i||i.resume()},e.prototype.convertDatumToPosition=function(t,e,i,n){var r;if(void 0===e&&(e={}),void 0===i&&(i=!1),!this._chart)return null;if(ot(t))return null;var a,o=e.seriesId,s=e.seriesIndex,l=void 0===s?0:s;if(N(o)?a=this._chart.getSeriesInUserId(o):N(l)&&(a=null===(r=this._chart.getSeriesInIndex([l]))||void 0===r?void 0:r[0]),a){var u=Object.keys(t),c=a.getViewData().latestData.find((function(e){return u.every((function(i){return e[i]==t[i]}))})),h=a.getRegion().getLayoutStartPoint(),d=void 0;return(d=c?a.dataToPosition(c,n):a.dataToPosition(t,n))?xF(d,h,i):null}return null},e.prototype.convertValueToPosition=function(t,e,i){var n,r;if(void 0===i&&(i=!1),!this._chart||j(t)||ot(e))return null;if(!X(t)){var a=e,o=a.axisId,s=a.axisIndex,l=void 0;if(N(o)?l=this._chart.getComponentsByKey("axes").find((function(t){return t.userId===o})):N(s)&&(l=null===(n=this._chart.getComponentsByKey("axes"))||void 0===n?void 0:n[s]),!l)return Dk("Please check whether the `axisId` or `axisIndex` is set!"),null;var u=null==l?void 0:l.valueToPosition(t);if(i){var c=l.getLayoutStartPoint(),h=l.getOrient();return u+("bottom"===h||"top"===h?c.x:c.y)}return u}var d,p=e,f=p.seriesId,v=p.seriesIndex;return N(f)?d=this._chart.getSeriesInUserId(f):N(v)&&(d=null===(r=this._chart.getSeriesInIndex([v]))||void 0===r?void 0:r[0]),d?xF(d.valueToPosition(t[0],t[1]),d.getRegion().getLayoutStartPoint(),i):(Dk("Please check whether the `seriesId` or `seriesIndex` is set!"),null)},e.prototype.getFunction=function(t){return uY.instance().getFunction(t)},e.prototype.registerFunction=function(t,e){t&&e&&uY.instance().registerFunction(t,e)},e.prototype.unregisterFunction=function(t){t&&uY.instance().unregisterFunction(t)},e.prototype.getFunctionList=function(){return uY.instance().getFunctionNameList()},e.prototype.setRuntimeSpec=function(t){this._spec=t,this._updateSpecInfo()},e.prototype.updateIndicatorDataById=function(t,e){var i,n=null===(i=this._chart)||void 0===i?void 0:i.getComponentByUserId(t);n&&n.updateDatum(e)},e.prototype.updateIndicatorDataByIndex=function(t,e){var i;void 0===t&&(t=0);var n=null===(i=this._chart)||void 0===i?void 0:i.getComponentsByType(B.indicator);n&&n[t]&&n[t].updateDatum(e)},e.prototype.geoZoomByIndex=function(t,e,i){void 0===t&&(t=0),this._geoZoomByQuery({regionIndex:t},e,i)},e.prototype.geoZoomById=function(t,e,i){this._geoZoomByQuery({regionId:t},e,i)},e.prototype._geoZoomByQuery=function(t,e,i){var n,r,a=null===(n=this._chart)||void 0===n?void 0:n.getRegionsInQuerier(t)[0],o=null===(r=this._chart)||void 0===r?void 0:r.getComponentsByType(B.geoCoordinate),s=null==o?void 0:o.find((function(t){var e;return null===(e=t.getRegions())||void 0===e?void 0:e.includes(a)}));s&&s.dispatchZoom(e,i)},e.prototype._initChartPlugin=function(){var t=kz.getChartPlugins();t.length>0&&(this._chartPlugin=new pY(this),this._chartPlugin.load(t.map((function(t){return new t}))),this._chartPluginApply("onInit",this._spec))},e.prototype._chartPluginApply=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];this._chartPlugin&&this._chartPlugin[t]&&this._chartPlugin[t].apply(this._chartPlugin,e)},e.prototype._getMode=function(){return this._option.mode||t.RenderModeEnum["desktop-browser"]},e.prototype._getChartOption=function(t){var e=this;return{type:t,globalInstance:this,eventDispatcher:this._eventDispatcher,dataSet:this._dataSet,container:this._container,canvas:this._canvas,map:new Map,mode:this._getMode(),modeParams:this._option.modeParams,getCompiler:function(){return e._compiler},performanceHook:this._option.performanceHook,viewBox:this._viewBox,animation:this._option.animation,getTheme:function(){var t;return null!==(t=e._currentTheme)&&void 0!==t?t:{}},getSpecInfo:function(){var t;return null!==(t=e._specInfo)&&void 0!==t?t:{}},layout:this._option.layout,onError:this._onError,disableTriggerEvent:!0===this._option.disableTriggerEvent}},e.InstanceManager=zz,e.ThemeManager=Hz,e.globalConfig={uniqueTooltip:!0},e.Utils=lY,e.vglobal=ex,e}();kz.registerRegion("region",NU),kz.registerLayout("base",qU),sY(),WN.useRegisters([gG]),bt(Hj,Kj),xj.registerInteraction(Hj.type,Hj),bt(zj,Kj),xj.registerInteraction(zj.type,zj),Iz(gz.name,gz),Lt.getInstance(Rt.Error);var _Y=function(t,e){var i=e.beforeCall();return t&&t.forEach((function(t,n){return e.call(t,n,i)})),i.keyMap&&(i.keyMap.clear(),i.keyMap=null),t};function bY(t,e){return st(e,"component.".concat(t))}function xY(t,e,i,n){if(t)return{formatFunc:t,args:[i,n]};var r=kz.getFormatter();return e&&r?{formatFunc:r,args:[i,n,e]}:{}}var kY=function(t,e,i,n){if(!j(t[e])){var r=X(t[e]),a=r?t[e]:[t[e]],o=[];return a.forEach((function(t,a){!t||n&&!n(t)||o.push({spec:t,specPath:r?[e,a]:[e],specInfoPath:["component",e,a],type:i})})),o}},SY=function(t,e,i,n){var r;if(r=H(t)?t(e,i):G(t)&&N(t.field)?st(e,t.field):t,n){var a=xY(void 0,n,t,e),o=a.formatFunc,s=a.args;o&&s&&(r=o.apply(void 0,P([],E(s),!1)))}return r},AY=function(t,e,i){return j(t)?t:H(t)?t(e,i):t};var MY=function(t,e){return!e||!1!==e.visible&&((!e[t]||!1!==e[t].visible)&&!(e.activeType&&!(X(e.activeType)?e.activeType.includes(t):e.activeType===t)))};function wY(t,e,i,n,r,a){var o=function(e){if(e){var o={datum:r},s=j(e.key)&&j(e.value)&&!ot(e)?A(A(A({},n),i),e):A(A({},n),e),l=s.key,u=s.keyFormatter,c=s.keyTimeFormat,h=s.keyTimeFormatMode,d=s.value,p=s.valueFormatter,f=s.valueTimeFormat,v=s.valueTimeFormatMode,g=M(s,["key","keyFormatter","keyTimeFormat","keyTimeFormatMode","value","valueFormatter","valueTimeFormat","valueTimeFormatMode"]);o.key=EY(SY(l,r,a,u),c,h),o.value=EY(SY(d,r,a,p),f,v),Object.keys(g).forEach((function(t){o[t]=SY(s[t],r,a)})),!1!==o.visible&&(N(o.key)||N(o.value))&&t.push(o)}};X(e)?e.forEach((function(t){o(t)})):o(e)}function TY(t,e,i,n,r,a,o){H(e)?wY(t,e(r,o),i,n,a,o):e&&wY(t,e,i,n,a,o)}var CY,EY=function(t,e,i){if(!e&&!i)return"object"!=typeof t?null==t?void 0:t.toString():t;var n=Yi.getInstance();return e=e||"%Y%m%d",("local"===(i=i||"local")?n.timeFormat:n.timeUTCFormat)(e,t)},PY=function(){function t(t){var e=this;this.activeTriggerSet={mark:new Set,group:new Set},this.ignoreTriggerSet={mark:new Set},this._getSeriesCacheInfo=function(){var t,i,n,r=e.series,a=r.getSeriesField();return{seriesFields:N(a)?xt(a):null!==(t=r.getSeriesKeys())&&void 0!==t?t:[],dimensionFields:null!==(i=r.getDimensionField())&&void 0!==i?i:[],measureFields:null!==(n=r.getMeasureField())&&void 0!==n?n:[],type:r.type}},this._getDimensionData=function(t){var i=e._seriesCacheInfo.dimensionFields;return i[0]&&(null==t?void 0:t[i[0]])},this._getMeasureData=function(t){var i=e._seriesCacheInfo.measureFields;return i[0]&&(null==t?void 0:t[i[0]])},this._getSeriesFieldData=function(t){var i=e._seriesCacheInfo,n=i.dimensionFields,r=i.seriesFields;if(N(r[0])&&(null==t?void 0:t[r[0]]))return null==t?void 0:t[r[0]];var a=n[n.length-1];return n.length>1&&(0===r.length||e.series.getSeriesKeys().length),null==t?void 0:t[a]},this._getSeriesStyle=function(t,i,n){var r,a,o;try{for(var s=C(xt(i)),l=s.next();!l.done;l=s.next()){var u=l.value,c=null===(o=e.series.getSeriesStyle(t))||void 0===o?void 0:o(u);if(N(c))return c}}catch(t){r={error:t}}finally{try{l&&!l.done&&(a=s.return)&&a.call(s)}finally{if(r)throw r.error}}return n},this.markTooltipKeyCallback=function(t,i){return e._getSeriesFieldData(t)},this.markTooltipValueCallback=function(t,i){return e._getMeasureData(t)},this.shapeTypeCallback=function(t,i){var n;return null!==(n=e._getSeriesStyle(t,"shape",null))&&void 0!==n?n:e._getSeriesStyle(t,"symbolType",e.series.getDefaultShapeType())},this.shapeColorCallback=function(t,i){return e._getSeriesStyle(t,["fill","stroke"])},this.shapeStrokeCallback=function(t,i){return e._getSeriesStyle(t,["stroke","fill"])},this.dimensionTooltipTitleCallback=function(t,i){return e._getDimensionData(t)},this.groupTooltipTitleCallback=function(t,i){return e._getSeriesFieldData(t)},this.groupTooltipKeyCallback=function(t,i){var n=e._seriesCacheInfo.seriesFields,r=e._seriesCacheInfo.dimensionFields;return n[0]&&(r=r.filter((function(t){return t!==n[0]}))),r.map((function(e){return null==t?void 0:t[e]})).join("-")},this.getHasShape=function(t){return!!t},this.series=t,this.updateTooltipSpec()}return t.prototype.updateTooltipSpec=function(){var t,e=null===(t=this.series.getSpec())||void 0===t?void 0:t.tooltip;this.spec=e,this._seriesCacheInfo=this._getSeriesCacheInfo()},t.prototype.getShapeAttrs=function(t,e,i){var n,r,a,o,s,l,u,c,h,d,p,f,v=e?"content":"title",g=A(A(A(A(A({},null===(n=null==i?void 0:i.style)||void 0===n?void 0:n.shape),null==i?void 0:i[t]),null===(r=null==i?void 0:i[t])||void 0===r?void 0:r[v]),null===(a=this.spec)||void 0===a?void 0:a[t]),null===(s=null===(o=this.spec)||void 0===o?void 0:o[t])||void 0===s?void 0:s[v]);return{shapeType:null!==(l=g.shapeType)&&void 0!==l?l:this.shapeTypeCallback,shapeFill:null!==(c=null!==(u=g.shapeFill)&&void 0!==u?u:g.shapeColor)&&void 0!==c?c:this.shapeColorCallback,shapeStroke:null!==(h=g.shapeStroke)&&void 0!==h?h:this.shapeStrokeCallback,shapeHollow:null!==(d=g.shapeHollow)&&void 0!==d&&d,shapeLineWidth:g.shapeLineWidth,shapeSize:null!==(p=g.shapeSize)&&void 0!==p?p:g.size,hasShape:null!==(f=g.hasShape)&&void 0!==f?f:this.getHasShape(e)}},t.prototype.enableByType=function(t){return!0},t.prototype.getDefaultContentList=function(t){return[this.getDefaultContentPattern(t)]},t.prototype.getContentList=function(t,e,i,n,r,a){var o;return function(t,e,i,n,r,a){if(r&&r.length){var o=[];return r.forEach((function(r){X(t)?t.forEach((function(t){TY(o,t,e,i,n,r,a)})):H(t)?TY(o,t,e,i,n,r,a):t&&wY(o,t,e,i,r,a)})),o}return null}(null!==(o=null==e?void 0:e.content)&&void 0!==o?o:this.getDefaultContentList(t),this.getDefaultContentPattern(t),i,n,r,a)},t.prototype.getTitleResult=function(t,e,i,n,r){var a=H(e)?e(n,r):e;if(a?j(a.value)&&(a=A(A({},this.getDefaultTitlePattern(t)),a)):a=this.getDefaultTitlePattern(t),a&&!1!==a.visible){var o=function(t){var e,i,n,r,a,o,s,l=(null===(s=t[0])||void 0===s?void 0:s.series)?[{data:t,value:""}]:t;try{for(var u=C(l),c=u.next();!c.done;c=u.next()){var h=c.value.data;try{for(var d=(n=void 0,C(h)),p=d.next();!p.done;p=d.next()){var f=p.value.datum;try{for(var v=(a=void 0,C(null!=f?f:[])),g=v.next();!g.done;g=v.next()){var y=g.value;if(y)return y}}catch(t){a={error:t}}finally{try{g&&!g.done&&(o=v.return)&&o.call(v)}finally{if(a)throw a.error}}}}catch(t){n={error:t}}finally{try{p&&!p.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}}}catch(t){e={error:t}}finally{try{c&&!c.done&&(i=u.return)&&i.call(u)}finally{if(e)throw e.error}}}(n),s={visible:SY(a.visible,o,r),value:EY(SY(a.value,o,r,a.valueFormatter),a.valueTimeFormat,a.valueTimeFormatMode),valueStyle:SY(a.valueStyle,o,r),hasShape:a.hasShape};return Object.keys(i).forEach((function(t){s[t]=SY(i[t],o,r)})),s}return{hasShape:!1,visible:!1}},t.prototype.getTooltipData=function(t,e,i,n,r){var a,o;if(!(this.enableByType(t)&&MY(t,this.spec)&&("dimension"!==t||n&&n.length)))return null;var s,l=null!==(o=null===(a=this.spec)||void 0===a?void 0:a[t])&&void 0!==o?o:null==e?void 0:e[t],u=this.getShapeAttrs(t,!0,e),c=this.getShapeAttrs(t,!1,e);"dimension"===t?(s=[],this.getContentList(t,l,u,i,n,r).forEach((function(t){s.push(t)}))):s=this.getContentList(t,l,u,i,n,r);return{visible:!0,activeType:t,data:i,title:this.getTitleResult(t,null==l?void 0:l.title,c,i,r),content:s}},t.prototype.getDefaultTitlePattern=function(t){return{key:void 0,value:"group"===t?this.groupTooltipTitleCallback:this.dimensionTooltipTitleCallback}},t.prototype.getDefaultContentPattern=function(t){return{seriesId:this.series.id,key:"group"===t?this.groupTooltipKeyCallback:this.markTooltipKeyCallback,value:this.markTooltipValueCallback}},t}(),RY={min:function(t){return t.length?At(t.map((function(t){return 1*t}))):0},max:function(t){return t.length?St(t.map((function(t){return 1*t}))):0},"array-min":function(t){return t.length?At(t.map((function(t){return 1*t}))):0},"array-max":function(t){return t.length?St(t.map((function(t){return 1*t}))):0},values:function(t){var e,i,n={},r=[];try{for(var a=C(t),o=a.next();!o.done;o=a.next()){var s=o.value;n[s]||(r.push(s),n[s]=1)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(i=a.return)&&i.call(a)}finally{if(e)throw e.error}}return r}},BY=function(t,e){var i,n,r=e.fields;if(H(r)&&(r=r()),!(null==r?void 0:r.length)||!(null==t?void 0:t.length))return{};r=dH([],r);var a="parser"===e.target?"parserData":"latestData",o=t[0][a]?t[0][a]:t||[],s=null===(n=(i=t[0]).getFields)||void 0===n?void 0:n.call(i);return IY(o,r,s)},IY=function(t,e,i){var n={},r=[],a=[];return e.forEach((function(e){var o=e.key;n[o]={};var s=null==i?void 0:i[o],l=e.operations,u=l.some((function(t){return"min"===t||"max"===t||"allValid"===t})),c=!0;r.length=0,t&&t.forEach((function(t){t&&r.push(t[o])}));var h=r.length;if(u){a.length=0,r.forEach((function(t,e){Uk(t)&&a.push(t)}));var d=r;r=a,a=d,c=r.length===h}else r=l.some((function(t){return"array-min"===t||"array-max"===t}))?r.reduce((function(t,e){return e&&e.forEach((function(e){Uk(e)&&t.push(e)})),t}),[]):r.filter((function(t){return void 0!==t}));e.filter&&(r=r.filter(e.filter)),l.forEach((function(t){if(e.customize)n[o][t]=e.customize;else{if(s&&!0===s.lockStatisticsByDomain&&!j(s.domain)){if("values"===t)return void(n[o][t]=s.domain.slice())}else if("allValid"===t)return;n[o][t]=RY[t](r),"array-max"===t&&(n[o].max=n[o][t]),"array-min"===t&&(n[o].min=n[o][t])}})),u&&(n[o].allValid=c)})),n},LY=function(t,e){var i=e.config;if(!i)return t;var n=i(),r=n.invalidType,a=n.checkField;return"zero"!==r||a&&a.length&&t.forEach((function(t){a.forEach((function(e){Uk(t[e])||(t[e]=0)}))})),t},DY=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._compileProduct=function(){var t,e=null===(t=this._data)||void 0===t?void 0:t.latestData;j(e)||N(this.getProduct())||this._initProduct([])},e.prototype.generateProductId=function(){var t;return null===(t=this._data)||void 0===t?void 0:t.name},e}(iY),OY="".concat(BF,"_HIERARCHY_DEPTH"),FY="".concat(BF,"_HIERARCHY_ROOT"),zY="".concat(BF,"_HIERARCHY_ROOT_INDEX");function HY(){return{keyMap:new Map,needDefaultSeriesField:!this._seriesField,defaultSeriesField:this._seriesField?null:this.getSeriesKeys()[0],getKey:this.generateDefaultDataKey(this._spec.dataKey)}}function jY(t,e,i){t&&(i.needDefaultSeriesField&&(t[Xz]=i.defaultSeriesField),t[Uz]=e,t[Yz]=i.getKey(t,e,i))}function NY(){return{keyMap:new Map,needDefaultSeriesField:!0,defaultSeriesField:this.getSeriesKeys()[0],getKey:this.generateDefaultDataKey(this._spec.dataKey),categoryField:this.getCategoryField()}}function VY(t,e,i,n,r,a){void 0===n&&(n=0),void 0===a&&(a=e),jY(t,e,i),t[OY]=n,t[FY]=r||t[i.categoryField],t[zY]=a,t.children&&t.children.length&&t.children.forEach((function(e,n){return VY(e,n,i,t[OY]+1,t[FY],a)}))}var WY=((CY={}).label={name:"label",type:"text"},CY),GY="".concat(BF,"_rect_x"),UY="".concat(BF,"_rect_x1"),YY="".concat(BF,"_rect_y"),XY="".concat(BF,"_rect_y1"),KY={data:!0},qY={invalidType:!0,animation:!0,animationAppear:!0,animationEnter:!0,animationUpdate:!0,animationExit:!0,animationNormal:!0},ZY={type:"fadeIn"};function JY(t,e){switch(e){case"grow":return function(t){return{type:"horizontal"===t.direction?"growPointsXIn":"growPointsYIn",options:{orient:"horizontal"===t.direction?"positive":"negative"}}}(t);case"fadeIn":return ZY;default:return function(t){return{type:"clipIn",options:{clipDimension:"horizontal"===t.direction?"y":"x"}}}(t)}}var QY={appear:{duration:1e3,easing:"cubicOut"},update:{type:"update",duration:300,easing:"linear"},enter:{duration:300,easing:"linear"},exit:{duration:300,easing:"linear"},disappear:{duration:500,easing:"cubicIn"},state:{duration:300,easing:"linear"}},$Y={appear:{type:"scaleIn"},enter:{type:"scaleIn"},exit:{type:"scaleOut"},disappear:{type:"scaleOut"}},tX={appear:{type:"fadeIn"},enter:{type:"fadeIn"},exit:{type:"fadeOut"},disappear:{type:"fadeOut"}},eX=function(){kz.registerAnimation("scaleInOut",(function(){return $Y}))},iX=function(){kz.registerAnimation("fadeInOut",(function(){return tX}))},nX=function(t,e){return{appear:JY(t,e),enter:{type:"fadeIn"},exit:{type:"fadeOut"},update:[{type:"update",options:{excludeChannels:["points","defined","segments"]}},{channel:["points","segments"],custom:md,duration:QY.update.duration,easing:QY.update.easing,customParameters:{clipRangeByDimension:"horizontal"===t.direction?"y":"x"}}],disappear:{type:"clipOut"}}},rX=function(){kz.registerAnimation("line",nX)},aX=function(){WN.useRegisters([PW,RW,BW,IW,CW,EW])},oX=function(){WN.useRegisters([VW,WW,jW,NW])},sX=function(){WN.useRegisters([LW,DW,OW,FW,zW,HW,AW,MW])},lX=function(){WN.useRegisters([LW,DW])},uX=P(P([],E(Object.keys(QY)),!1),["normal"],!1);function cX(t,e,i){void 0===t&&(t={});for(var n={},r=function(r){var a,o=uX[r],s=e?e[o]:void 0;if(!1===s)return"continue";if("normal"===o)return s&&(n.normal=s),"continue";if("state"===o)return!1!==s&&(n.state=null!=s?s:QY.state),"continue";if("update"!==o&&!s&&!t[o])return"continue";if(a=X(t[o])?t[o]:[A(A({},QY[o]),t[o])],"exit"===o&&a.forEach((function(t){t.controlOptions={stopWhenStateChange:!0}})),!s)return n[o]=a,"continue";var l=void 0;l=X(s)?s.map((function(t,e){var n,r=t;return vX(r)&&delete r.type,r.oneByOne&&(r=dX(r,null!==(n=null==i?void 0:i.dataIndex)&&void 0!==n?n:pX,null==i?void 0:i.dataCount)),r})):a.map((function(t,e){var n,r=xz({},a[e],s);return vX(r)&&delete r.type,r.oneByOne&&(r=dX(r,null!==(n=null==i?void 0:i.dataIndex)&&void 0!==n?n:pX,null==i?void 0:i.dataCount)),r})),n[o]=l},a=0;a<uX.length;a++)r(a);return n}function hX(t,e,i){var n,r,a,o,s,l,u={};return N(e.animationAppear)&&(u.appear=null!==(n=e.animationAppear[t])&&void 0!==n?n:e.animationAppear),N(e.animationDisappear)&&(u.disappear=null!==(r=e.animationDisappear[t])&&void 0!==r?r:e.animationDisappear),N(e.animationEnter)&&(u.enter=null!==(a=e.animationEnter[t])&&void 0!==a?a:e.animationEnter),N(e.animationExit)&&(u.exit=null!==(o=e.animationExit[t])&&void 0!==o?o:e.animationExit),N(e.animationUpdate)&&(u.update=null!==(s=e.animationUpdate[t])&&void 0!==s?s:e.animationUpdate),N(e.animationState)&&(u.state=null!==(l=e.animationState[t])&&void 0!==l?l:e.animationState),e.animationNormal&&e.animationNormal[t]&&(u.normal=e.animationNormal[t]),function(t,e){if(!t)return t;var i=["custom","customParameters"];return t=ct(t,null,i),gX(t,(function(t){var i;if(H(t)&&(null===(i=t.prototype)||void 0===i?void 0:i.constructor)!==t){var n=function(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];return t.apply(void 0,P(P([],E(i),!1),[e],!1))};return n}return t}),i),t}(u,i)}function dX(t,e,i){var n=t.oneByOne,r=t.duration,a=t.delay,o=t.delayAfter;return t.delay=function(t,i,o){var s=e(t,o),l=H(r)?r(t,i,o):Q(r)?r:0,u=H(a)?a(t,i,o):Q(a)?a:0,c=H(n)?n(t,i,o):n;return!1===c?u:u+s*(l+(c=!0===c?0:c))},t.delayAfter=function(t,a,s){var l=e(t,s),u=H(r)?r(t,a,s):Q(r)?r:0,c=H(o)?o(t,a,s):Q(o)?o:0,h=H(n)?n(t,a,s):n;return!1===h?c:c+((i?i():a.mark.elements.length)-l)*(u+(h=!0===h?0:h))},delete t.oneByOne,t}function pX(t,e){var i,n;return null!==(i=null==t?void 0:t[Uz])&&void 0!==i?i:null===(n=null==e?void 0:e.VGRAMMAR_ANIMATION_PARAMETERS)||void 0===n?void 0:n.elementIndex}function fX(t,e){var i,n,r,a,o;if(!1===t.animation)return!1;if(!1===(null===(i=t.morph)||void 0===i?void 0:i.enable))return!1;var s=!1!==(null!==(r=null===(n=t.animationAppear)||void 0===n?void 0:n[e])&&void 0!==r?r:t.animationAppear),l=!1!==(null!==(o=null===(a=t.animationUpdate)||void 0===a?void 0:a[e])&&void 0!==o?o:t.animationUpdate);return!(!s||!l)}function vX(t){return!function(t){return N(t.timeSlices)}(t)&&N(t.channel)}function gX(t,e,i){if(void 0===i&&(i=[]),X(t))t.forEach((function(n,r){t[r]=e(t[r],r),gX(t[r],e,i)}));else if(V(t))for(var n in t)i.includes(n)||(t[n]=e(t[n],n),gX(t[n],e,i))}function yX(t){var e,i,n,r,a=t.getSpec();if(!1===a.animation)return!1;if(!N(t.getRegion().animate))return!1;var o=null!==(e=a.animationThreshold)&&void 0!==e?e:Number.MAX_SAFE_INTEGER;return null===(i=t.getMarks())||void 0===i||i.forEach((function(t){var e=t.getMarkConfig();e&&(e.large&&e.largeThreshold&&(o=Math.min(o,e.largeThreshold)),e.progressiveThreshold&&(o=Math.min(o,e.progressiveThreshold)))})),!((null===(r=null===(n=t.getRawData())||void 0===n?void 0:n.latestData)||void 0===r?void 0:r.length)>=o)}var mX=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.markLabelSpec={},e}return S(e,t),e.prototype.getLabelSpec=function(t){return this.markLabelSpec[t]},e.prototype.setLabelSpec=function(t,e){this.markLabelSpec[t]=xt(e)},e.prototype.addLabelSpec=function(t,e,i){void 0===i&&(i=!1),this.markLabelSpec[t]||(this.markLabelSpec[t]=[]),i?this.markLabelSpec[t].unshift(e):this.markLabelSpec[t].push(e)},e.prototype.getTheme=function(t,e){var i,n,r,a=tF(t),o=null===(i=this._option)||void 0===i?void 0:i.getTheme(),s=o.markByName,l=o.mark,u=this._option.type,c=kz.getSeriesMarkMap(u)?function(t,e,i,n){var r=kz.getSeriesMarkMap(e);if(!r)return t;var a={};return Object.values(r).forEach((function(e){var r=e.type,o=e.name;a[o]=xz({},null==i?void 0:i[xt(r)[0]],null==n?void 0:n[o],null==t?void 0:t[o])})),A(A({},t),a)}(st(o,"series.".concat(u)),u,l,s):{},h=st(o,"series.".concat(u,"_").concat(a));return xz({},c,h,(null!==(r=null!==(n=this.stack)&&void 0!==n?n:null==h?void 0:h.stack)&&void 0!==r?r:null==c?void 0:c.stack)?st(o,"series.".concat(u,"_stack")):void 0)},e.prototype.transformSpec=function(e,i,n){this._transformStack(e);var r=t.prototype.transformSpec.call(this,e,i,n);return this._transformLabelSpec(r.spec),A(A({},r),{markLabelSpec:this.markLabelSpec,stack:this.stack})},e.prototype._transformLabelSpec=function(t){},e.prototype._transformStack=function(t){z(t.stack)&&(this.stack=t.stack),z(t.percent)&&(this.stack=t.percent||this.stack),j(this.stack)&&this._supportStack&&t.seriesField&&(this.stack=!0)},e.prototype._addMarkLabelSpec=function(t,e,i,n,r,a){var o=this;(void 0===i&&(i="label"),void 0===n&&(n="initLabelMarkStyle"),void 0===r&&(r=!0),t)&&xt(t[i]).forEach((function(i){var s,l,u;if(i&&i.visible){var c=i.animation,h=void 0===c||c,d=i.animationUpdate,p=void 0===d||d,f=i.animationEnter,v=void 0===f||f,g=i.animationExit,y=void 0===g||g,m=t,_=m.animationUpdate,b=void 0===_||_,x=m.animationEnter,k=void 0===x||x,S=m.animationExit,M=void 0===S||S,w=!!(null!==(u=null!==(l=null===(s=o._option)||void 0===s?void 0:s.animation)&&void 0!==l?l:t.animation)&&void 0!==u?u:i.animation)&&!!r;o.addLabelSpec(H(e)?e(i):e,A(A({},i),{animation:!!w&&h,animationUpdate:!!(w&&b&&p)&&b,animationEnter:!!(w&&k&&v)&&k,animationExit:!!(w&&k&&y)&&M,getStyleHandler:function(t){var e;return null===(e=t[n])||void 0===e?void 0:e.bind(t)}}),a)}}))},e.prototype._getDefaultSpecFromChart=function(e){var i,n=null!==(i=t.prototype._getDefaultSpecFromChart.call(this,e))&&void 0!==i?i:{},r=e.outerRadius,a=e.innerRadius,o=e.direction;return N(r)&&(n.outerRadius=r),N(a)&&(n.innerRadius=a),N(o)&&(n.direction=o),Object.keys(n).length>0?n:void 0},e.prototype._mergeThemeToSpec=function(t,e){var i=this._theme;if(this._shouldMergeThemeToSpec()){var n=this._getDefaultSpecFromChart(e),r=function(t){var e=xz({},i,n,t),r=i.label;return r&&V(r)&&X(e.label)&&(e.label=e.label.map((function(t){return xz({},r,t)}))),e};return X(t)?{spec:t.map((function(t){return r(t)})),theme:i}:{spec:r(t),theme:i}}return{spec:t,theme:i}},e}(OU);var _X=function(e){function i(t,i){var n,r=this;return(r=e.call(this,t,i)||this).specKey="series",r.type="series",r.layoutType="absolute",r.modelType="series",r.name=void 0,r.transformerConstructor=mX,r.coordinate="none",r._region=null,r._layoutStartPoint={x:0,y:0},r._layoutRect={width:null,height:null},r.getLayoutRect=function(){var t,e;return{width:null!==(t=r._layoutRect.width)&&void 0!==t?t:r._region.getLayoutRect().width,height:null!==(e=r._layoutRect.height)&&void 0!==e?e:r._region.getLayoutRect().height}},r._rootMark=null,r._seriesMark=null,r._viewDataMap=new Map,r._viewDataFilter=null,r._data=null,r.layoutZIndex=wU.SeriesGroup,r._invalidType="break",r._region=i.region,r._dataSet=i.dataSet,(null===(n=r._spec)||void 0===n?void 0:n.name)&&(r.name=r._spec.name),r}return S(i,e),i.prototype.getRegion=function(){return this._region},i.prototype.getLayoutStartPoint=function(){return this._region.getLayoutStartPoint()},i.prototype.getRootMark=function(){return this._rootMark},i.prototype.getSeriesMark=function(){return this._seriesMark},i.prototype.getRawData=function(){return this._rawData},i.prototype.getViewDataFilter=function(){return this._viewDataFilter},i.prototype.getViewData=function(){var t;return null===(t=this._data)||void 0===t?void 0:t.getDataView()},i.prototype.getViewDataProductId=function(){var t;return null===(t=this._data)||void 0===t?void 0:t.getProductId()},i.prototype.getViewDataStatistics=function(){return this._viewDataStatistics},i.prototype.getViewStackData=function(){return this._viewStackData},i.prototype.getSeriesField=function(){return this._seriesField},i.prototype.setSeriesField=function(t){N(t)&&(this._seriesField=t)},i.prototype.getGroups=function(){return this._groups},i.prototype.getStack=function(){var t;return null===(t=this.getSpecInfo())||void 0===t?void 0:t.stack},i.prototype.getStackValue=function(){var t;return null!==(t=this._spec.stackValue)&&void 0!==t?t:"".concat(BF,"_series_").concat(this.type)},i.prototype.getPercent=function(){return this._spec.percent},i.prototype.getStackOffsetSilhouette=function(){return this._spec.stackOffsetSilhouette},Object.defineProperty(i.prototype,"tooltipHelper",{get:function(){return this._tooltipHelper||this.initTooltip(),this._tooltipHelper},enumerable:!1,configurable:!0}),i.prototype.getInvalidType=function(){return this._invalidType},i.prototype.setInvalidType=function(t){var e;this._invalidType=t,null===(e=this.getViewData())||void 0===e||e.reRunAllTransform()},i.prototype.getMarkAttributeContext=function(){return this._markAttributeContext},i.prototype.created=function(){e.prototype.created.call(this),this._buildMarkAttributeContext(),this.initData(),this.initGroups(),this.initStatisticalData(),this.event.emit(cG.afterInitData,{model:this}),this.initRootMark(),this.initMark();var t=yX(this);this._initExtensionMark({hasAnimation:t}),this.initMarkStyle(),this.initMarkState(),t&&this.initAnimation(),this._option.disableTriggerEvent||this.initInteraction(),this.afterInitMark(),this.initEvent(),this.event.emit(cG.afterInitEvent,{model:this})},i.prototype._buildMarkAttributeContext=function(){var t=this;this._markAttributeContext={vchart:this._option.globalInstance,globalScale:function(e,i){var n;return null===(n=t._option.globalScale.getScale(e))||void 0===n?void 0:n.scale(i)},seriesColor:function(e){var i;return j(e)&&(e=t.getSeriesKeys()[0]),null===(i=t._option.globalScale.getScale("color"))||void 0===i?void 0:i.scale(e)},getRegion:function(){return t._region}}},i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),this.setSeriesField(this._spec.seriesField),N(this._spec.invalidType)&&(this._invalidType=this._spec.invalidType)},i.prototype.getInvalidCheckFields=function(){return[this.getStackValueField()]},i.prototype.initInvalidDataTransform=function(){var t,e,i=this;"zero"===this._invalidType&&(null===(t=this._rawData)||void 0===t?void 0:t.dataSet)&&(qG(this._rawData.dataSet,"invalidTravel",LY),null===(e=this._rawData)||void 0===e||e.transform({type:"invalidTravel",options:{config:function(){return{invalidType:i._invalidType,checkField:i.getInvalidCheckFields()}}}},!1))},i.prototype.initData=function(){var t,e,i,n=null!==(t=this._spec.data)&&void 0!==t?t:this._option.getSeriesData(this._spec.dataId,this._spec.dataIndex);if(n&&(this._rawData=lU(n,this._dataSet,this._option.sourceDataList)),null===(i=null===(e=this._rawData)||void 0===e?void 0:e.target)||void 0===i||i.addListener("change",this.rawDataUpdate.bind(this)),this._addDataIndexAndKey(),this._rawData){this.getStack()&&(this._viewDataFilter=sU(this._rawData,this._dataSet,{name:"".concat(this.type,"_").concat(this.id,"_viewDataFilter")}));var r=sU(this.getStack()?this._viewDataFilter:this._rawData,this._dataSet,{name:"".concat(this.type,"_").concat(this.id,"_viewData")});this._data=new DY(this._option,r),this.getStack()&&this._viewDataFilter.target.removeListener("change",r.reRunAllTransform)}this.initInvalidDataTransform()},i.prototype.initGroups=function(){var t=this.getGroupFields();t&&t.length&&(this._groups={fields:t})},i.prototype.initStatisticalData=function(){this._data&&this._statisticViewData()},i.prototype.getRawDataStatisticsByField=function(t,e){var i,n,r;if(this._rawStatisticsCache||(this._rawStatisticsCache={}),!this._rawStatisticsCache[t]||e&&(j(this._rawStatisticsCache[t].min)||j(this._rawStatisticsCache[t].max))||!e&&j(this._rawStatisticsCache[t].values))if(this._viewDataStatistics&&(!this._viewDataFilter||this._viewDataFilter.transformsArr.length<=1)&&this.getViewData().transformsArr.length<=1&&(null===(i=this._viewDataStatistics.latestData)||void 0===i?void 0:i[t]))this._rawStatisticsCache[t]=this._viewDataStatistics.latestData[t];else if(this._rawData){var a=null===(n=this._rawData.getFields())||void 0===n?void 0:n[t];if(a&&a.lockStatisticsByDomain&&a.domain)this._rawStatisticsCache[t]={},e?(this._rawStatisticsCache[t].min=At(a.domain),this._rawStatisticsCache[t].max=St(a.domain)):this._rawStatisticsCache[t].values=a.domain;else{var o=IY(this._rawData.latestData,[{key:t,operations:e?["min","max"]:["values"]}])[t];this._rawStatisticsCache[t]=ft(null!==(r=this._rawStatisticsCache[t])&&void 0!==r?r:{},o)}}return this._rawStatisticsCache[t]},i.prototype._statisticViewData=function(){var t=this;qG(this._dataSet,"dimensionStatistics",BY);var e="".concat(this.type,"_").concat(this.id,"_viewDataStatic");this._viewDataStatistics=new Ms(this._dataSet,{name:e}),this._viewDataStatistics.parse([this._data.getDataView()],{type:"dataview"}),this._viewDataStatistics.transform({type:"dimensionStatistics",options:{fields:function(){var e=t.getStatisticFields();return t._seriesField&&dH(e,[{key:t._seriesField,operations:["values"]}]),e},target:"latest"}},!1),this._data.getDataView().target.removeListener("change",this._viewDataStatistics.reRunAllTransform),this.getStack()&&this.createdStackData()},i.prototype.createStatisticalData=function(t,e,i){var n=this;qG(this._dataSet,"dimensionStatistics",BY);var r=new Ms(this._dataSet,{name:t});return r.parse([e],{type:"dataview"}),r.transform({type:"dimensionStatistics",options:{operations:["max","min","values"],fields:function(){var t,r=dH(n.getStatisticFields(),null!==(t=null==i?void 0:i(e.name))&&void 0!==t?t:[]);return n._seriesField&&dH(r,[{key:n._seriesField,operations:["values"]}]),r},target:"latest"}},!1),r},i.prototype.createdStackData=function(){var t="".concat(this.type,"_").concat(this.id,"_viewStackData");this._viewStackData=new Ms(this._dataSet,{name:t}),this._viewStackData.parse([this._viewDataFilter],{type:"dataview"}),this._viewStackData.transform({type:"stackSplit",options:{fields:this.getStackGroupFields()}},!1)},i.prototype._noAnimationDataKey=function(t,e){return e},i.prototype.generateDefaultDataKey=function(t){var e,i=this;return j(t)?function(t,e,n){if(!1===i._spec.animation){var r=i._noAnimationDataKey(t,e);if(void 0!==r)return r}var a=n.keyMap,o=i._getSeriesDataKey(t);return void 0===a.get(o)?(a.set(o,0),o):(a.set(o,a.get(o)+1),"".concat(o,"_").concat(a.get(o)))}:Y(t)?function(e){return e[t]}:X(t)&&t.every((function(t){return Y(t)}))?function(e){return t.map((function(t){return e[t]})).join("-")}:H(t)?function(e,i){return t(e,i)}:(null===(e=this._option)||void 0===e||e.onError("invalid dataKey: ".concat(t)),function(t,e){})},i.prototype._addDataIndexAndKey=function(){var t;(null===(t=this._rawData)||void 0===t?void 0:t.dataSet)&&(qG(this._rawData.dataSet,"addVChartProperty",_Y),this._rawData.transform({type:"addVChartProperty",options:{beforeCall:HY.bind(this),call:jY}},!1))},i.prototype.updateRawData=function(t){this._rawData&&this._rawData.updateRawData(t)},i.prototype.rawDataUpdate=function(t){var e;null===(e=this._rawDataStatistics)||void 0===e||e.reRunAllTransform(),this._rawStatisticsCache=null,this.event.emit(cG.rawDataUpdate,{model:this})},i.prototype.viewDataFilterOver=function(t){this.event.emit(cG.viewDataFilterOver,{model:this})},i.prototype.viewDataUpdate=function(t){var e;this.event.emit(cG.viewDataUpdate,{model:this}),null===(e=this._data)||void 0===e||e.updateData(),this._viewDataStatistics&&this._viewDataStatistics.reRunAllTransform()},i.prototype.viewDataStatisticsUpdate=function(t){this.event.emit(cG.viewDataStatisticsUpdate,{model:this})},i.prototype.getDatumPositionValue=function(t,e){return!t||j(e)?null:t[e]},i.prototype.getDatumPositionValues=function(t,e){return!t||j(e)?[]:Y(e)?[t[e]]:e.map((function(e){return t[e]}))},i.prototype.setValueFieldToStack=function(){},i.prototype.setValueFieldToPercent=function(){},i.prototype.setValueFieldToStackOffsetSilhouette=function(){},i.prototype.initRootMark=function(){var t,e,i;this._rootMark=this._createMark({type:"group",name:"seriesGroup_".concat(this.type,"_").concat(this.id)},{parent:null===(e=(t=this._region).getGroupMark)||void 0===e?void 0:e.call(t),dataView:!1}),this._rootMark.setMarkConfig({zIndex:null!==(i=this._spec.zIndex)&&void 0!==i?i:this.layoutZIndex})},i.prototype._getExtensionMarkNamePrefix=function(){return"".concat(this.type,"_").concat(this.id,"_extensionMark")},i.prototype._initExtensionMark=function(t){var e,i=this;if(this._spec.extensionMark){var n=this.getMarksWithoutRoot();t.depend=n,null===(e=this._spec.extensionMark)||void 0===e||e.forEach((function(e,n){i._createExtensionMark(e,null,i._getExtensionMarkNamePrefix(),n,t)}))}},i.prototype._createExtensionMark=function(t,e,i,n,r){var a,o=this,s=this._createMark({type:t.type,name:N(t.name)?"".concat(t.name):"".concat(i,"_").concat(n)},{skipBeforeLayouted:!0,markSpec:t,parent:e,dataView:!1,componentType:t.componentType,depend:r.depend,key:t.dataKey},{setCustomizedShape:null==t?void 0:t.customShape});if(s){if(N(t.id)&&s.setUserId(t.id),r.hasAnimation){var l=cX({},hX(t.type,t,this._markAttributeContext));s.setAnimationConfig(l)}if("group"===t.type)i="".concat(i,"_").concat(n),null===(a=t.children)||void 0===a||a.forEach((function(t,e){o._createExtensionMark(t,s,i,e,r)}));else if(!(e||j(t.dataId)&&j(t.dataIndex))){var u=this._option.getSeriesData(t.dataId,t.dataIndex);u===this._rawData?s.setDataView(this.getViewData(),this.getViewDataProductId()):(s.setDataView(u),u.target.addListener("change",(function(){s.getData().updateData()})))}}},i.prototype._updateExtensionMarkSpec=function(){var t,e=this;null===(t=this._spec.extensionMark)||void 0===t||t.forEach((function(t,i){var n=e._marks.getMarkWithInfo({name:N(t.name)?"".concat(t.name):"".concat(e._getExtensionMarkNamePrefix(),"_").concat(i)});n&&(e.initMarkStyleWithSpec(n,t),n.updateStaticEncode(),n.updateLayoutState())}))},i.prototype.getStackData=function(){var t;return null===(t=this._viewStackData)||void 0===t?void 0:t.latestData},i.prototype._parseSelectorOfInteraction=function(t,e){if(!e||!e.length)return[];var i=[];return t.markIds?e.filter((function(e){t.markIds.includes(e.getProductId())&&i.push("#".concat(e.getProductId()))})):t.markNames?e.forEach((function(e){t.markNames.includes(e.name)&&i.push("#".concat(e.getProductId()))})):e.forEach((function(t){i.push("#".concat(t.getProductId()))})),i},i.prototype._parseDefaultInteractionConfig=function(e){if(!(null==e?void 0:e.length))return[];var i,n=(i=this._option.mode)===t.RenderModeEnum["desktop-browser"]||i===t.RenderModeEnum["desktop-miniApp"]?{hover:{enable:!0,trigger:"pointermove",triggerOff:"view:pointerleave"},select:{enable:!0,trigger:"pointertap"}}:Nk(i)||Vk(i)?{hover:{enable:!0,trigger:["pointerdown","pointermove"],triggerOff:"view:pointerleave"},select:{enable:!0,trigger:"tap"}}:null,r=A({},null==n?void 0:n.hover),a=A({},null==n?void 0:n.select),o=this._spec.hover;z(o)?r.enable=o:V(o)&&(r.enable=!0,r=xz(r,o));var s=this._spec.select;z(s)?a.enable=s:V(s)&&(a.enable=!0,a=xz(a,s));var l,u=[];r.enable&&((l=this._parseSelectorOfInteraction(r,e)).length&&u.push(this._defaultHoverConfig(l,r)));a.enable&&((l=this._parseSelectorOfInteraction(a,e)).length&&u.push(this._defaultSelectConfig(l,a)));return u},i.prototype._defaultHoverConfig=function(t,e){return{seriesId:this.id,regionId:this._region.id,selector:t,type:"element-highlight",trigger:e.trigger,triggerOff:e.triggerOff,blurState:hU.STATE_HOVER_REVERSE,highlightState:hU.STATE_HOVER}},i.prototype._defaultSelectConfig=function(t,e){var i="multiple"===e.mode,n=N(e.triggerOff)?e.triggerOff:i?["empty"]:["empty",e.trigger];return{type:"element-select",seriesId:this.id,regionId:this._region.id,selector:t,trigger:e.trigger,triggerOff:n,reverseState:hU.STATE_SELECTED_REVERSE,state:hU.STATE_SELECTED,isMultiple:i}},i.prototype._parseInteractionConfig=function(t){var e=this,i=this.getCompiler();if(i){var n=this._spec.interactions,r=this._parseDefaultInteractionConfig(t);r&&r.length&&r.forEach((function(t){i.addInteraction(t)})),n&&n.length&&n.forEach((function(t){var n=e._parseSelectorOfInteraction(t,e.getMarks());n.length&&i.addInteraction(A(A({},t),{selector:n,seriesId:e.id,regionId:e._region.id}))}))}},i.prototype.initInteraction=function(){var t=this.getMarksWithoutRoot();this._parseInteractionConfig(t)},i.prototype.initAnimation=function(){},i.prototype.initMarkState=function(){this.initSeriesStyleState()},i.prototype.initSeriesStyleState=function(){var t,e=this,i=this._spec.seriesStyle;if(i&&i.length){var n=null!==(t=this._seriesField)&&void 0!==t?t:Xz;this.getMarksWithoutRoot().forEach((function(t){var r={},a={},o={};i.forEach((function(e){var i,n=null===(i=e[t.name])||void 0===i?void 0:i.style;n&&(r[e.name]=!0,o[e.name]=o[e.name]||{},Object.keys(n).forEach((function(t){a[t]=!0,o[e.name][t]=n[t]})))})),t.state.addStateInfo({stateValue:Kz,level:-1,filter:function(t){return Array.isArray(t)?0!==t.length&&!0===r[t[0][n]]:!0===r[t[n]]}});var s={};Object.keys(a).forEach((function(e){s[e]=function(i){var r,a,s;if(Array.isArray(i)){if(0===i.length)return;s=null===(r=o[i[0][n]])||void 0===r?void 0:r[e]}return s=null===(a=o[i[n]])||void 0===a?void 0:a[e],N(s)?s:t.getAttribute(e,i)}})),e.setMarkStyle(t,s,Kz,CU.User_SeriesStyle)}))}},i.prototype.afterInitMark=function(){var t=this;this.event.emit(cG.afterInitMark,{model:this}),this.setSeriesField(this._spec.seriesField),this.getMarks().forEach((function(e){var i,n;(null===(n=null===(i=e.stateStyle)||void 0===i?void 0:i.normal)||void 0===n?void 0:n.lineWidth)&&e.setAttribute("stroke",t.getColorAttribute(),"normal",CU.Base_Series)}))},i.prototype.getMarksWithoutRoot=function(){return this.getMarks().filter((function(t){var e;return!(null===(e=t.name)||void 0===e?void 0:e.includes("seriesGroup"))}))},i.prototype.getMarksInType=function(t){return this._marks.getMarksInType(t)},i.prototype.getMarkInName=function(t){return this._marks.get(t)},i.prototype.getMarkInId=function(t){return this.getMarks().find((function(e){return e.id===t}))},i.prototype.initEvent=function(){var t,e,i;null===(e=null===(t=this._data)||void 0===t?void 0:t.getDataView())||void 0===e||e.target.addListener("change",this.viewDataUpdate.bind(this)),null===(i=this._viewDataStatistics)||void 0===i||i.target.addListener("change",this.viewDataStatisticsUpdate.bind(this))},i.prototype._releaseEvent=function(){e.prototype._releaseEvent.call(this),this.getCompiler().removeInteraction(this.id)},i.prototype.initTooltip=function(){this._tooltipHelper=new PY(this)},i.prototype._compareExtensionMarksSpec=function(t,e,i){t.length!==e.length||e.some((function(e,i){return e.type!==t[i].type||e.id!==t[i].id||e.name!==t[i].name}))?i.reMake=!0:e.some((function(e,i){return e.visible!==t[i].visible}))&&(i.reCompile=!0)},i.prototype._compareLabelSpec=function(t,e,i){t.length!==e.length||e.some((function(e,i){return e.labelLayout!==t[i].labelLayout||e.visible!==t[i].visible}))?i.reMake=!0:!i.reCompile&&e.some((function(e,i){return!mt(e,t[i])}))&&(i.reCompile=!0)},i.prototype._compareSpec=function(t,i,n){var r=e.prototype._compareSpec.call(this,t,i),a=Object.keys(i||{}).sort();if(!mt(a,Object.keys(t||{}).sort()))return r.reMake=!0,r;var o=A(A(A(A({},KY),qY),n),{extensionMark:!0,label:!0,totalLabel:!0});return this._compareExtensionMarksSpec(xt(t.extensionMark),xt(i.extensionMark),r),!r.reMake&&this._compareLabelSpec(xt(t.label),xt(i.label),r),!r.reMake&&this._compareLabelSpec(xt(t.totalLabel),xt(i.totalLabel),r),r.reMake?r:(!r.reCompile&&this._marks.getMarks().some((function(e){var n,r;return o[e.name]=!0,(null===(n=i[e.name])||void 0===n?void 0:n.visible)!==(null===(r=t[e.name])||void 0===r?void 0:r.visible)}))&&(r.reCompile=!0),!r.reCompile&&a.some((function(e){return qY[e]&&!mt(t[e],i[e])}))&&(r.reCompile=!0),a.some((function(e){return!o[e]&&!mt(t[e],i[e])}))?(r.reMake=!0,r):r)},i.prototype._updateSpecData=function(){!this._rawData||!this._spec.data||this._spec.data instanceof Ms||uU(this._rawData,this._spec.data,!0)},i.prototype.reInit=function(t){var i=this;e.prototype.reInit.call(this,t);var n=this.getMarksWithoutRoot();n.forEach((function(t){i._spec[t.name]&&i.initMarkStyleWithSpec(t,i._spec[t.name])})),this.initMarkStyle(),n.forEach((function(t){t.updateStaticEncode(),t.updateLayoutState(!0)})),this._updateExtensionMarkSpec(),this._updateSpecData(),this._tooltipHelper&&this._tooltipHelper.updateTooltipSpec(),yX(this)&&this.initAnimation()},i.prototype.onEvaluateEnd=function(t){this._data.updateData()},i.prototype.onRender=function(t){},i.prototype.release=function(){var t,i,n;e.prototype.release.call(this),this._viewDataMap.clear();var r=null===(i=null===(t=this._rawData)||void 0===t?void 0:t.transformsArr)||void 0===i?void 0:i.findIndex((function(t){return"addVChartProperty"===t.type}));r>=0&&this._rawData.transformsArr.splice(r,1),null===(n=this._data)||void 0===n||n.release(),this._dataSet=this._data=this._rawData=this._rawDataStatistics=this._spec=this._region=this._viewDataStatistics=this._viewStackData=null},i.prototype.setLayoutStartPosition=function(t){Q(t.x)&&(this._layoutStartPoint.x=t.x),Q(t.y)&&(this._layoutStartPoint.y=t.y)},i.prototype.setLayoutRect=function(t,e){var i=t.width,n=t.height;Q(i)&&(this._layoutRect.width=i),Q(n)&&(this._layoutRect.height=n)},i.prototype.getSeriesKeys=function(){var t,e;return this._seriesField?null!==(e=null===(t=this.getRawDataStatisticsByField(this._seriesField))||void 0===t?void 0:t.values)&&void 0!==e?e:[]:this.name?[this.name]:this.userId?["".concat(this.userId)]:["".concat(this.type,"_").concat(this.id)]},i.prototype.getSeriesStyle=function(t){var e=this;return function(i){var n,r;return null!==(r=null===(n=e._seriesMark)||void 0===n?void 0:n.getAttribute(i,t))&&void 0!==r?r:void 0}},i.prototype._getSeriesInfo=function(t,e){var i=this,n=this.getDefaultShapeType();return e.map((function(e){var r;return{key:e,originalKey:e,style:i.getSeriesStyle((r={},r[t]=e,r)),shapeType:n}}))},i.prototype.getSeriesInfoInField=function(t){var e,i;return this._getSeriesInfo(t,null!==(i=null===(e=this.getRawDataStatisticsByField(t))||void 0===e?void 0:e.values)&&void 0!==i?i:[])},i.prototype.getSeriesInfoList=function(){var t;return this._getSeriesInfo(null!==(t=this._seriesField)&&void 0!==t?t:Xz,this.getSeriesKeys())},i.prototype._getDefaultColorScale=function(){var t,e,i=this.getDefaultColorDomain(),n=this._getDataScheme();return null===(e=(t=(new hF).domain(i)).range)||void 0===e?void 0:e.call(t,n)},i.prototype._getDataScheme=function(){return nF(this.getColorScheme(),this.type)},i.prototype.getDefaultColorDomain=function(){var t,e;return this._seriesField?null===(e=null===(t=this.getViewDataStatistics())||void 0===t?void 0:t.latestData[this._seriesField])||void 0===e?void 0:e.values:[]},i.prototype.getColorAttribute=function(){var t,e;return{scale:null!==(t=this._option.globalScale.getScale("color"))&&void 0!==t?t:this._getDefaultColorScale(),field:null!==(e=this._seriesField)&&void 0!==e?e:Xz}},i.prototype.getDimensionField=function(){return[]},i.prototype.getMeasureField=function(){return[]},i.prototype.onMarkPositionUpdate=function(){this.onMarkTreePositionUpdate(this.getMarksWithoutRoot())},i.prototype.onMarkTreePositionUpdate=function(t){},i.prototype._createMark=function(t,i,n){var r,a,o,s,l,u;void 0===i&&(i={}),void 0===n&&(n={});var c,h=i.key,d=i.groupKey,p=i.skipBeforeLayouted,f=i.themeSpec,v=void 0===f?{}:f,g=i.markSpec,y=i.dataView,m=i.dataProductId,_=i.parent,b=i.isSeriesMark,x=i.depend,k=i.stateSort,S=i.noSeparateStyle,M=void 0!==S&&S,w=e.prototype._createMark.call(this,t,{key:null!=h?h:this._getDataIdKey(),seriesId:this.id,attributeContext:this._markAttributeContext,componentType:i.componentType,noSeparateStyle:M});if(N(w)){var T=this.getSpec()||{};this._marks.addMark(w,{name:t.name}),b&&(this._seriesMark=w),j(_)?null===(r=this._rootMark)||void 0===r||r.addMark(w):!1!==_&&_.addMark(w),j(y)?(w.setDataView(this.getViewData(),this.getViewDataProductId()),w.setSkipBeforeLayouted(!0)):!1!==y&&w.setDataView(y,m),z(p)&&w.setSkipBeforeLayouted(p),N(x)&&w.setDepend.apply(w,P([],E(xt(x)),!1)),j(d)||w.setGroupKey(d),k&&w.setStateSortCallback(k);var C=A(A({},n),{morph:null!==(a=n.morph)&&void 0!==a&&a,support3d:(c=t.type,["arc3d","rect3d","pyramid3d"].includes(c)||(null!==(o=n.support3d)&&void 0!==o?o:T.support3d||!!T.zField)),morphKey:(null===(s=T.morph)||void 0===s?void 0:s.morphKey)||"".concat(this.getSpecIndex(),"_").concat(this.getMarks().length),morphElementKey:null!==(u=null===(l=T.morph)||void 0===l?void 0:l.morphElementKey)&&void 0!==u?u:n.morphElementKey});w.setMarkConfig(C),this.initMarkStyleWithSpec(w,xz({},v,g||T[w.name]))}return w},i.prototype._getDataIdKey=function(){var t;return null!==(t=e.prototype._getDataIdKey.call(this))&&void 0!==t?t:Yz},i.prototype._getSeriesDataKey=function(t){var e="";if(!t)return e;var i=this.getDimensionField();e=i.map((function(e){return t[e]})).join("_");var n=this.getSeriesField();return n&&!i.includes(n)&&(e+="_".concat(t[n])),e},i.prototype.addViewDataFilter=function(t){var e,i;null===(i=null!==(e=this._viewDataFilter)&&void 0!==e?e:this.getViewData())||void 0===i||i.transform(t,!1)},i.prototype.reFilterViewData=function(){var t,e;null===(e=null!==(t=this._viewDataFilter)&&void 0!==t?t:this.getViewData())||void 0===e||e.reRunAllTransform()},i.prototype.reTransformViewData=function(){var t,e;null===(e=null===(t=this._data)||void 0===t?void 0:t.getDataView())||void 0===e||e.reRunAllTransform()},i.prototype.fillData=function(){var t;null===(t=this.getRawData())||void 0===t||t.reRunAllTransform()},i.prototype.compile=function(){this.compileData()},i.prototype.getDefaultShapeType=function(){return"circle"},i.prototype.getFieldAlias=function(t){var e;return t!==Jz&&t!==$z&&t!==Zz&&t!==Qz||(t=this.getStackValueField()),null!==(e=fH(this.getRawData(),t))&&void 0!==e?e:t},i.prototype._getInvalidConnectType=function(){return"zero"===this._invalidType?"zero":"link"===this._invalidType?"connect":"none"},i.prototype._getInvalidDefined=function(t){var e=this.getInvalidCheckFields();return!e.length||e.every((function(e){return Uk(t[e])}))},i.prototype._getRelatedComponentSpecInfo=function(t){var e,i=this.getSpecIndex(),n=null===(e=this._option.getSpecInfo().component[t])||void 0===e?void 0:e.filter((function(t){return t.seriesIndexes.includes(i)}));return null!=n?n:[]},i.prototype._forEachStackGroup=function(t,e){var i,n,r=this;(e=null!=e?e:null===(i=this._viewStackData)||void 0===i?void 0:i.latestData)&&((null===(n=e.values)||void 0===n?void 0:n.length)?t(e):e.nodes&&Object.values(e.nodes).forEach((function(e){r._forEachStackGroup(t,e)})))},i.prototype.isDatumInViewData=function(t){if(!t)return!1;var e=this.getViewData().latestData;return!!e&&(!!e.includes(t)||e.some((function(e){return Object.keys(t).every((function(i){return t[i]===e[i]}))})))},i.prototype.getSeriesFieldValue=function(t,e){var i;return t[null!==(i=null!=e?e:this.getSeriesField())&&void 0!==i?i:Xz]},i.mark=WY,i.transformerConstructor=mX,i}(FU);function bX(t,e,i){var n=t.getScale(0),r="isInverse"in t&&t.isInverse();NB(n.type)?i.sort((function(t,i){return(t[e]-i[e])*(r?-1:1)})):i.sort((function(t,i){return(n.index(t[e])-n.index(i[e]))*(r?-1:1)}))}function xX(t){return{dataIndex:function(e){var i,n,r="horizontal"===t.direction?t.fieldY[0]:t.fieldX[0],a=null==e?void 0:e[r],o="horizontal"===t.direction?t.scaleY:t.scaleX;return(null!==(n=null===(i=null==o?void 0:o.domain)||void 0===i?void 0:i.call(o))&&void 0!==n?n:[]).indexOf(a)||0},dataCount:function(){var e,i,n,r="horizontal"===t.direction?t.scaleY:t.scaleX;return null!==(n=(null!==(i=null===(e=null==r?void 0:r.domain)||void 0===e?void 0:e.call(r))&&void 0!==i?i:[]).length)&&void 0!==n?n:0}}}var kX,SX=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.coordinate="cartesian",e._bandPosition=.5,e._scaleConfig={bandPosition:e._bandPosition},e._direction="vertical",e._sortDataByAxis=!1,e._getPositionXEncoder=function(){var t;return null===(t=e._positionXEncoder)||void 0===t?void 0:t.bind(e)},e._setPositionXEncoder=function(t){e._positionXEncoder=t.bind(e)},e._getPositionYEncoder=function(){var t;return null===(t=e._positionYEncoder)||void 0===t?void 0:t.bind(e)},e._setPositionYEncoder=function(t){e._positionYEncoder=t.bind(e)},e}return S(e,t),e.prototype._buildScaleConfig=function(){this._scaleConfig={bandPosition:this._bandPosition}},Object.defineProperty(e.prototype,"fieldX",{get:function(){return this._fieldX},enumerable:!1,configurable:!0}),e.prototype.setFieldX=function(t){this._fieldX=xt(t)},Object.defineProperty(e.prototype,"fieldY",{get:function(){return this._fieldY},enumerable:!1,configurable:!0}),e.prototype.setFieldY=function(t){this._fieldY=xt(t)},Object.defineProperty(e.prototype,"fieldZ",{get:function(){return this._fieldZ},enumerable:!1,configurable:!0}),e.prototype.setFieldZ=function(t){this._fieldZ=t&&xt(t)},Object.defineProperty(e.prototype,"fieldX2",{get:function(){return this._fieldX2},enumerable:!1,configurable:!0}),e.prototype.setFieldX2=function(t){this._fieldX2=t},Object.defineProperty(e.prototype,"fieldY2",{get:function(){return this._fieldY2},enumerable:!1,configurable:!0}),e.prototype.setFieldY2=function(t){this._fieldY2=t},Object.defineProperty(e.prototype,"direction",{get:function(){return this._direction},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleX",{get:function(){return this._scaleX},enumerable:!1,configurable:!0}),e.prototype.setScaleX=function(t){this._scaleX=t},Object.defineProperty(e.prototype,"scaleY",{get:function(){return this._scaleY},enumerable:!1,configurable:!0}),e.prototype.setScaleY=function(t){this._scaleY=t},Object.defineProperty(e.prototype,"scaleZ",{get:function(){return this._scaleZ},enumerable:!1,configurable:!0}),e.prototype.setScaleZ=function(t){this._scaleZ=t},e.prototype.getXAxisHelper=function(){return this._xAxisHelper},e.prototype.setXAxisHelper=function(t){this._xAxisHelper=t,this.onXAxisHelperUpdate()},e.prototype.getYAxisHelper=function(){return this._yAxisHelper},e.prototype.setYAxisHelper=function(t){this._yAxisHelper=t,this.onYAxisHelperUpdate()},e.prototype.getZAxisHelper=function(){return this._zAxisHelper},e.prototype.setZAxisHelper=function(t){this._zAxisHelper=t,this.onYAxisHelperUpdate()},Object.defineProperty(e.prototype,"sortDataByAxis",{get:function(){return this._sortDataByAxis},enumerable:!1,configurable:!0}),e.prototype.getStatisticFields=function(){var t=[];return[{axisHelper:this.getXAxisHelper(),fields:this._fieldX2?P(P([],E(this._fieldX),!1),[this._fieldX2],!1):this._fieldX},{axisHelper:this.getYAxisHelper(),fields:this._fieldY2?P(P([],E(this._fieldY),!1),[this._fieldY2],!1):this._fieldY},{axisHelper:this.getZAxisHelper(),fields:this._fieldZ}].forEach((function(e){e.axisHelper&&e.axisHelper.getScale&&e.fields&&e.fields.forEach((function(i){var n={key:i,operations:[]},r=e.axisHelper.getScale(0);NB(r.type)?(n.operations=["max","min"],"log"===r.type&&(n.filter=function(t){return t>0})):n.operations=["values"],t.push(n)}))})),this.getStack()&&t.push({key:this.getStackValueField(),operations:["allValid"]}),t},e.prototype.getGroupFields=function(){return"vertical"===this.direction?this._fieldX:this._fieldY},e.prototype.getStackGroupFields=function(){return this.getGroupFields()},e.prototype.getStackValue=function(){var t,e,i=null===(t="horizontal"===this.direction?this.getXAxisHelper():this.getYAxisHelper())||void 0===t?void 0:t.getAxisId();return null!==(e=this._spec.stackValue)&&void 0!==e?e:"".concat(BF,"_series_").concat(this.type,"_").concat(i)},e.prototype.getStackValueField=function(){return"horizontal"===this.direction?xt(this._spec.xField)[0]:xt(this._spec.yField)[0]},e.prototype.setValueFieldToStack=function(){"horizontal"===this.direction?(this.setFieldX(Jz),this.setFieldX2(Zz)):(this.setFieldY(Jz),this.setFieldY2(Zz))},e.prototype.setValueFieldToPercent=function(){"horizontal"===this.direction?(this.setFieldX($z),this.setFieldX2(Qz)):(this.setFieldY($z),this.setFieldY2(Qz))},e.prototype.setValueFieldToStackOffsetSilhouette=function(){"horizontal"===this.direction?(this.setFieldX(eH),this.setFieldX2(tH)):(this.setFieldY(eH),this.setFieldY2(tH))},e.prototype.onXAxisHelperUpdate=function(){this.onMarkPositionUpdate()},e.prototype.onYAxisHelperUpdate=function(){this.onMarkPositionUpdate()},e.prototype.onZAxisHelperUpdate=function(){this.onMarkPositionUpdate()},e.prototype.setAttrFromSpec=function(){var e,i;t.prototype.setAttrFromSpec.call(this),this.setFieldX(this._spec.xField),this.setFieldY(this._spec.yField),this.setFieldZ(this._spec.zField),this._specXField=xt(this._spec.xField),this._specYField=xt(this._spec.yField),N(this._spec.direction)&&(this._direction=this._spec.direction),this.setFieldX2(null===(e=this._spec)||void 0===e?void 0:e.x2Field),this.setFieldY2(null===(i=this._spec)||void 0===i?void 0:i.y2Field),this.getStack()&&this.setValueFieldToStack(),this.getPercent()&&this.setValueFieldToPercent(),this.getStackOffsetSilhouette()&&this.setValueFieldToStackOffsetSilhouette(),N(this._spec.sortDataByAxis)&&(this._sortDataByAxis=!0===this._spec.sortDataByAxis)},e.prototype.dataToPosition=function(t,e){return t?e&&!this.isDatumInViewData(t)?null:{x:this.dataToPositionX(t),y:this.dataToPositionY(t)}:null},e.prototype._buildMarkAttributeContext=function(){var e=this;t.prototype._buildMarkAttributeContext.call(this),this._markAttributeContext.valueToX=this.valueToPositionX.bind(this),this._markAttributeContext.valueToY=this.valueToPositionY.bind(this),this._markAttributeContext.xBandwidth=function(t){var i,n,r;return void 0===t&&(t=0),null!==(r=null===(n=(i=e.getXAxisHelper()).getBandwidth)||void 0===n?void 0:n.call(i,t))&&void 0!==r?r:0},this._markAttributeContext.yBandwidth=function(t){var i,n,r;return void 0===t&&(t=0),null!==(r=null===(n=(i=e.getYAxisHelper()).getBandwidth)||void 0===n?void 0:n.call(i,t))&&void 0!==r?r:0},this._markAttributeContext.valueToPosition=this.valueToPosition.bind(this)},e.prototype.valueToPosition=function(t,e){return{x:this.valueToPositionX(t),y:this.valueToPositionY(e)}},e.prototype._axisPosition=function(t,e,i){return this._scaleConfig.datum=i,t.isContinuous?t.valueToPosition(e,this._scaleConfig):t.dataToPosition(xt(e),this._scaleConfig)},e.prototype.valueToPositionX=function(t,e){return this._axisPosition(this._xAxisHelper,t,e)},e.prototype.valueToPositionY=function(t,e){return this._axisPosition(this._yAxisHelper,t,e)},e.prototype._dataToPosition=function(t,e,i,n,r,a){var o=this,s=r();if(s)return s(t);if(!e)return a((function(t){return Number.NaN})),Number.NaN;var l=(e.getFields?e.getFields():i).slice(0,n);return l&&0!==l.length?(e.isContinuous?a((function(t){return o._scaleConfig.datum=t,e.valueToPosition(o.getDatumPositionValue(t,l[0]),o._scaleConfig)})):a((function(t){return o._scaleConfig.datum=t,e.dataToPosition(xt(o.getDatumPositionValues(t,l)),o._scaleConfig)})),r()(t)):(a((function(t){return null})),null)},e.prototype.dataToPositionX=function(t){return this._dataToPosition(t,this._xAxisHelper,this.fieldX,void 0,this._getPositionXEncoder,this._setPositionXEncoder)},e.prototype.dataToPositionY=function(t){return this._dataToPosition(t,this._yAxisHelper,this.fieldY,void 0,this._getPositionYEncoder,this._setPositionYEncoder)},e.prototype.dataToPositionZ=function(t){return this._zAxisHelper?(0,this._zAxisHelper.dataToPosition)(this.getDatumPositionValues(t,this._fieldZ),{bandPosition:this._bandPosition}):Number.NaN},e.prototype.dataToPositionX1=function(t){return this._xAxisHelper?this._fieldX2&&this._fieldX2 in t?this.valueToPositionX(this.getDatumPositionValues(t,this._fieldX2)):this.valueToPositionX(0):Number.NaN},e.prototype.dataToPositionY1=function(t){return this._yAxisHelper?this._fieldY2&&this._fieldY2 in t?this.valueToPositionY(this.getDatumPositionValues(t,this._fieldY2)):this.valueToPositionY(0):Number.NaN},e.prototype.positionToData=function(t){return t?{x:this.positionToDataX(t.x),y:this.positionToDataY(t.y)}:null},e.prototype.positionToDataX=function(t){return this._scaleX?this._scaleX.invert(t):null},e.prototype.positionToDataY=function(t){return this._scaleY?this._scaleY.invert(t):null},e.prototype.getRegionRectLeft=function(){return this._xAxisHelper?(0,this._xAxisHelper.getScale)(0).range()[0]:Number.NaN},e.prototype.getRegionRectRight=function(){return this._xAxisHelper?(0,this._xAxisHelper.getScale)(0).range()[1]:Number.NaN},e.prototype.afterInitMark=function(){t.prototype.afterInitMark.call(this),this.setFieldX(this._fieldX),this.setFieldY(this._fieldY),this._buildScaleConfig()},e.prototype.getDimensionField=function(){return"horizontal"===this._direction?this._specYField:this._specXField},e.prototype.getDimensionContinuousField=function(){return"horizontal"===this._direction?[this.fieldY[0],this.fieldY2]:[this.fieldX[0],this.fieldX2]},e.prototype.getMeasureField=function(){return"horizontal"===this._direction?this._specXField:this._specYField},e.prototype.initEvent=function(){var e=this;t.prototype.initEvent.call(this),this.sortDataByAxis&&this.event.on(cG.scaleDomainUpdate,{filter:function(t){var i;return t.model.id===(null===(i="horizontal"===e._direction?e._yAxisHelper:e._xAxisHelper)||void 0===i?void 0:i.getAxisId())}},(function(){e._sortDataInAxisDomain()}))},e.prototype._sortDataInAxisDomain=function(){var t,e,i;(null===(e=null===(t=this.getViewData())||void 0===t?void 0:t.latestData)||void 0===e?void 0:e.length)&&(bX("horizontal"===this._direction?this._yAxisHelper:this._xAxisHelper,"horizontal"===this._direction?this._fieldY[0]:this._fieldX[0],this.getViewData().latestData),null===(i=this._data)||void 0===i||i.updateData(!0))},e.prototype.getInvalidCheckFields=function(){var t=[];this._xAxisHelper&&this._xAxisHelper.isContinuous&&this._xAxisHelper.getAxisType()!==B.geoCoordinate&&(this._xAxisHelper.getFields?this._xAxisHelper.getFields():this._specXField).forEach((function(e){t.push(e)}));this._yAxisHelper&&this._yAxisHelper.isContinuous&&this._yAxisHelper.getAxisType()!==B.geoCoordinate&&(this._yAxisHelper.getFields?this._yAxisHelper.getFields():this._specYField).forEach((function(e){t.push(e)}));return t},e.prototype.reInit=function(e){this._positionXEncoder&&(this._positionXEncoder=null),this._positionYEncoder&&(this._positionYEncoder=null),t.prototype.reInit.call(this,e)},e}(_X),AX="monotone",MX="linear",wX=((kX={}).point={name:"point",type:"symbol"},kX.line={name:"line",type:"line"},kX),TX=function(){function e(){}return e.prototype.addSamplingCompile=function(){if(this._spec.sampling){var t=this._region.getLayoutRect(),e=t.width,i=t.height,n=[],r=this._fieldY,a=this._fieldX;n.push({type:"sampling",size:"horizontal"===this._direction?i:e,factor:this._spec.samplingFactor,yfield:"horizontal"===this._direction?a[0]:r[0],groupBy:this._seriesField,mode:this._spec.sampling}),this._data.getProduct().transform(n)}},e.prototype.addOverlapCompile=function(){var t;if(this._spec.markOverlap){var e=[];e.push({type:"markoverlap",direction:"horizontal"===this._direction&&"cartesian"===this.coordinate?2:1,delta:this._spec.pointDis,deltaMul:this._spec.pointDisMul,groupBy:this._seriesField}),null===(t=this._symbolMark)||void 0===t||t.getProduct().transform(e)}},e.prototype.reCompileSampling=function(){this._spec.sampling&&this.compile()},e.prototype.initLineMark=function(t,e){var i,n;return this._lineMark=this._createMark(wX.line,{groupKey:this._seriesField,isSeriesMark:null==e||e,stateSort:null===(i=this._spec.line)||void 0===i?void 0:i.stateSort},A(A({},t),{setCustomizedShape:null===(n=this._spec.line)||void 0===n?void 0:n.customShape,morphElementKey:this.getDimensionField()[0]})),this._lineMark},e.prototype.initLineMarkStyle=function(t,e){var i,n,r=this,a=this._lineMark;if(a){if(this.setMarkStyle(a,{stroke:this.getColorAttribute()},"normal",CU.Series),"zero"!==this._invalidType&&this.setMarkStyle(a,{defined:this._getInvalidDefined.bind(this),connectedType:this._getInvalidConnectType()},"normal",CU.Series),this.event.on(cG.viewDataStatisticsUpdate,{filter:function(t){return t.model===r}},(function(){r.encodeDefined(a,"defined")})),"polar"===this.coordinate)this.setMarkStyle(a,{lineJoin:"bevel",curveType:MX,closePath:!0},"normal",CU.Series);else{var o=null!=e?e:null===(n=null===(i=this.getSpec().line)||void 0===i?void 0:i.style)||void 0===n?void 0:n.curveType,s=o===AX?"horizontal"===t?"monotoneY":"monotoneX":o;this.setMarkStyle(a,{curveType:s},"normal",CU.Built_In)}this.setMarkStyle(a,{x:this.dataToPositionX.bind(this),y:this.dataToPositionY.bind(this),z:this._fieldZ?this.dataToPositionZ.bind(this):null},"normal",CU.Series)}return a},e.prototype._getEventElement=function(t,e){var i=this,n=[];return t.dimensionInfo.some((function(t){return t.data.some((function(t){return t.series===i&&(n=t.datum,!0)})),!n.length})),n},e.prototype._dimensionTrigger=function(t){var e=this._getEventElement(t);switch(t.action){case"enter":this._symbolActiveMark.getDataView().parse(e),this._symbolActiveMark.getData().updateData(!1);break;case"leave":this._symbolActiveMark.getDataView().parse([]),this._symbolActiveMark.getData().updateData(!1)}},e.prototype.initSymbolMark=function(t,e){var i=this._spec.point||{};if(!1!==i.visible&&(this._symbolMark=this._createMark(wX.point,{groupKey:this._seriesField,isSeriesMark:!!e,stateSort:i.stateSort},A(A({},t),{setCustomizedShape:i.customShape,morph:fX(this._spec,wX.point.name),morphElementKey:this.getDimensionField()[0]}))),!0===this._spec.activePoint){var n=new Ms(this._option.dataSet,{name:"".concat(BF,"_series_").concat(this.id,"_active_point")});n.parse([]),this._symbolActiveMark=this._createMark({name:"active_point_".concat(this.id),type:"symbol"},{groupKey:this._seriesField,isSeriesMark:!1,dataView:n,parent:this._region.getInteractionMark(),stateSort:i.stateSort},{setCustomizedShape:i.customShape,morph:!1}),this._symbolActiveMark.setVisible(!1)}return this._symbolMark},e.prototype.initSymbolMarkStyle=function(){var e=this._symbolMark;if(!e)return this._initSymbolActiveMarkAlone(),e;if(this._initSymbolMark(e),this._symbolActiveMark&&this._symbolMark.stateStyle.dimension_hover){for(var i in this._symbolActiveMark.setVisible(!0),this.event.on(t.DimensionEventEnum.dimensionHover,this._dimensionTrigger.bind(this)),this._symbolMark.stateStyle)for(var n in this._symbolActiveMark.stateStyle[i]={},this._symbolMark.stateStyle[i])"visible"!==n&&(this._symbolActiveMark.stateStyle[i][n]={style:null,level:CU.Series,referer:e});this._symbolActiveMark.state.changeStateInfo({stateValue:hU.STATE_DIMENSION_HOVER,filter:function(){return!0}})}return e},e.prototype._initSymbolMark=function(t){var e=this;t&&(this.setMarkStyle(t,{fill:this.getColorAttribute()},"normal",CU.Series),this.setMarkStyle(t,{x:function(t){return"zero"===e._invalidType||e._getInvalidDefined(t)?e.dataToPositionX(t):Number.NaN},y:function(t){return"zero"===e._invalidType||e._getInvalidDefined(t)?e.dataToPositionY(t):Number.NaN},z:this._fieldZ?this.dataToPositionZ.bind(this):null},"normal",CU.Series))},e.prototype._initSymbolActiveMarkAlone=function(){var e,i,n=this._symbolActiveMark;n&&(this._initSymbolMark(n),n&&(null===(i=null===(e=this._spec[wX.point.name])||void 0===e?void 0:e.state)||void 0===i?void 0:i.dimension_hover)&&(n.setVisible(!0),this.event.on(t.DimensionEventEnum.dimensionHover,this._dimensionTrigger.bind(this)),this.initMarkStyleWithSpec(n,xz({},this._spec[wX.point.name],{visible:!0})),this._symbolActiveMark.state.changeStateInfo({stateValue:hU.STATE_DIMENSION_HOVER,filter:function(){return!0}})))},e.prototype.initLabelMarkStyle=function(t){var e,i=this;t&&("symbol"!==(null===(e=t.getTarget())||void 0===e?void 0:e.type)&&t.setRule("line-data"),this.setMarkStyle(t,{fill:this.getColorAttribute(),text:function(t){return t[i.getStackValueField()]},z:this._fieldZ?this.dataToPositionZ.bind(this):null}),"zero"!==this._invalidType&&this.setMarkStyle(t,{visible:this._getInvalidDefined.bind(this)},"normal",CU.Series),this.event.on(cG.viewDataStatisticsUpdate,{filter:function(t){return t.model===i}},(function(){i.encodeDefined(t,"visible")})))},e.prototype.initLineLabelMarkStyle=function(t){var e=this;t&&this.setMarkStyle(t,{fill:this.getColorAttribute(),text:function(t){var i;return null!==(i=t[e.getSeriesField()])&&void 0!==i?i:e.getSeriesKeys()[0]},z:this._fieldZ?this.dataToPositionZ.bind(this):null})},e.prototype.encodeDefined=function(t,e){var i,n,r,a,o,s;if(t){var l=this._isFieldAllValid();if("zero"===this._invalidType||l){if(!0===(null===(a=null===(r=t.stateStyle.normal)||void 0===r?void 0:r[e])||void 0===a?void 0:a.style))return;this.setMarkStyle(t,((i={})[e]=!0,i),"normal",CU.Series)}else{if(!0!==(null===(s=null===(o=t.stateStyle.normal)||void 0===o?void 0:o[e])||void 0===s?void 0:s.style))return;this.setMarkStyle(t,((n={})[e]=this._getInvalidDefined.bind(this),n),"normal",CU.Series)}t.getProduct()&&t.compileEncode()}},e.prototype._isFieldAllValid=function(){var t=this.getViewDataStatistics(),e=this.getStackValueField();return!!(t&&t.latestData&&e)&&(t.latestData[e]&&t.latestData[e].allValid)},e}(),CX=A(A({},WY),wX),EX=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype.setStyle=function(t,e,i,n){var r=this;if(void 0===e&&(e="normal"),void 0===i&&(i=0),void 0===n&&(n=this.stateStyle),!j(t)){void 0===n[e]&&(n[e]={});var a=this._getIgnoreAttributes(),o=["strokeWidth","lineWidth","lineDash","strokeDash","lineJoin","stroke","strokeOpacity","opacity","fill","fillOpacity","texture","texturePadding","textureSize","textureColor"],s=this.isUserLevel(i),l=!1;Object.keys(t).forEach((function(u){var c=t[u];if(!j(c)&&!a.includes(u)){s&&o.includes(u)&&(VB(null==c?void 0:c.type)||(null==c?void 0:c.scale)||H(c))&&(l=!0);var h=r._filterAttribute(u,c,e,i,s,n);r.setAttribute(u,h,e,i,n)}})),l&&this.setMarkConfig({enableSegments:!0})}},e}(aY),PX=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=i.type,t}return S(i,e),i.prototype._getDefaultStyle=function(){return A(A({},e.prototype._getDefaultStyle.call(this)),{lineWidth:1})},i.prototype._getIgnoreAttributes=function(){var e,i;return(null===(e=this.model)||void 0===e?void 0:e.type)===t.SeriesTypeEnum.radar&&"polar"===(null===(i=this.model)||void 0===i?void 0:i.coordinate)?[]:["fill","fillOpacity"]},i.type="line",i}(EX),RX=function(){kz.registerMark(PX.type,PX),CP(),fP(),DL(),PL(),xj.registerGraphic(MH.line,Gg),sX()},BX=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._getDefaultStyle=function(){return A(A({},t.prototype._getDefaultStyle.call(this)),{size:1,symbolType:"circle",fill:void 0,lineWidth:0})},e}(aY),IX=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return S(e,t),e.type="symbol",e}(BX),LX=function(){kz.registerMark(IX.type,IX),tV()},DX=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._transformLabelSpec=function(t){var e,i,n;!1!==(null===(e=t.point)||void 0===e?void 0:e.visible)&&!1!==(null===(n=null===(i=t.point)||void 0===i?void 0:i.style)||void 0===n?void 0:n.visible)?this._addMarkLabelSpec(t,"point"):this._addMarkLabelSpec(t,"line"),this._addMarkLabelSpec(t,"line","lineLabel","initLineLabelMarkStyle",void 0,!0)},e}(mX);function OX(t){return t.length>=2&&Q(t[0])&&Q(kt(t))&&kt(t)>=t[0]}function FX(t,e){var i,n=kt(e)-e[0],r=kt(e)*e[0]<0,a=e[0]<=0?0-e[0]:0,o=kt(e)>0?kt(e)-0:0;0===n?e[0]<0?(a=1,o=0):e[0]>0&&(a=0,o=1):(a/=n,o/=n);var s=t.getDomainSpec(),l={total:n,negative:a,positive:o,includeZero:r,domain:e,extendable_min:!Q(s.min),extendable_max:!Q(s.max)};if(null===(i=t._break)||void 0===i?void 0:i.scope){var u=e.findIndex((function(t){return t>=0})),c=void 0,h=void 0;0===u?(c=t._break.scope[u],h=[e[0],e[1]],l.positive=1,l.negative=0):kt(e)<=0?(l.positive=0,l.negative=1,h=[e[e.length-2],e[e.length-1]]):(c=t._break.scope[u-1],h=[e[u-1],e[u]],l.negative=c[0]+(0-h[0])/(h[1]-h[0])*(c[1]-c[0]),l.positive=1-l.negative),l.break=!0,l.extendable_max=!1,l.extendable_min=!1,l.domain=h}return l}function zX(t,e){var i=t.positive,n=t.negative,r=t.extendable_min,a=t.extendable_max,o=t.domain,s=e.positive,l=e.negative,u=e.extendable_min,c=e.extendable_max,h=e.domain;if(s>0){if(!u)return!1;var d=n/i;a&&(d=n/Math.max(i,s),o[1]=-o[0]/d),h[0]=-h[1]*d}else if(l>0){if(!c)return!1;d=i/n;r&&(d=i/Math.max(n,n),o[0]=-o[1]/d),h[1]=-h[0]*d}return!0}function HX(t,e){var i=t.extendable_min,n=t.extendable_max,r=t.domain,a=e.positive,o=e.negative,s=e.domain;return(0!==a||0!==o)&&(!(a>0&&!n)&&(!(o>0&&!i)&&(r[0]=s[0],r[1]=s[1],!0)))}function jX(t,e){var i=t.positive,n=t.negative,r=t.extendable_max,a=t.domain,o=e.positive,s=e.negative,l=e.extendable_min,u=e.domain;if(r&&l){var c=Math.max(n,s)/Math.max(i,o);a[1]=-a[0]/c,u[0]=-u[1]*c}else if(l){c=n/i;u[0]=-u[1]*c}else{if(!r)return!1;c=s/o;a[1]=-a[0]/c}return!0}function NX(t,e){var i=t.extendable_min,n=t.domain,r=e.extendable_max,a=e.domain;return!(!i||!r)&&(n[0]=-n[1],a[1]=-a[0],!0)}var VX=function(t,e){var i,n,r,a,o;if(!t)return t;var s=null===(i=null==e?void 0:e.targetAxis)||void 0===i?void 0:i.call(e);if(!s)return t;var l=null===(n=null==e?void 0:e.currentAxis)||void 0===n?void 0:n.call(e);if(!l)return t;var u=null===(r=l.getTickData())||void 0===r?void 0:r.getDataView();if(!u)return t;if(!u.transformsArr.find((function(t){return t.type.includes("ticks")})))return t;var c=l.getScale();if(!c)return t;var h=null===(o=null===(a=s.getTickData())||void 0===a?void 0:a.getDataView())||void 0===o?void 0:o.latestData;if(!(null==h?void 0:h.length))return t;var d=s.getScale();if(!d)return t;var p=d.domain(),f=kt(p)-p[0];if(0===f)return t;var v=c.domain(),g=kt(v)-v[0];if(0===f)return t;var y=h.map((function(t){return function(t,e,i,n,r){var a=Se(t,e),o=Math.max(xe(i),xe(a));return r*(Math.round(a*Math.pow(10,o))/Math.round(i*Math.pow(10,o)))+n}(t.value,p[0],f,v[0],g)}));return OB(y)},WX=function(){function t(t){this.id=Gk(),this.name="".concat(t,"_").concat(this.id)}return t.prototype.onAdd=function(t){this.service=t},t.prototype.release=function(){this.service=null},t}(),GX=function(t){function e(){var i=t.call(this,e.type)||this;return i.type="AxisSyncPlugin",i}return S(e,t),e.prototype._checkEnableSync=function(t){if(!NB(t.getScale().type))return!1;var e=t.getSpec().sync;return!!(null==e?void 0:e.axisId)&&e},e.prototype._getTargetAxis=function(t,e){var i=t.getOption().getChart().getComponentByUserId(e.axisId);return(null==i?void 0:i.type.startsWith("cartesianAxis"))?i:null},e.prototype.onInit=function(t,e){var i=this._checkEnableSync(e);if(i&&i.zeroAlign){var n=this._getTargetAxis(e,i);n&&e.event.on(cG.scaleDomainUpdate,{filter:function(t){var i=t.model;return i.id===e.id||i.id===n.id}},(function(){!function(t,e){var i,n,r,a,o,s,l=t.getScale(),u=e.getScale();if(l&&u){var c=null!==(r=null===(n=(i=t).getDomainAfterSpec)||void 0===n?void 0:n.call(i))&&void 0!==r?r:[0,1],h=null!==(s=null===(o=(a=e).getDomainAfterSpec)||void 0===o?void 0:o.call(a))&&void 0!==s?s:[0,1];if(c&&h&&OX(c)&&OX(h)){var d=FX(t,c),p=FX(e,h);if(!0!==d.break||!0!==p.break){var f=d.positive,v=d.negative,g=d.extendable_min,y=d.extendable_max,m=d.includeZero,_=p.positive,b=p.negative,x=p.extendable_min,k=p.extendable_max,S=p.includeZero;if(0===f&&0===v){if(!HX(d,p))return}else if(0===_&&0===b){if(!HX(p,d))return}else if(m||S)if(m&&!S){if(!zX(d,p))return}else if(S&&!m){if(!zX(p,d))return}else{if(v===b)return;if(v>b){if(!jX(d,p))return}else if(!jX(p,d))return}else{if(0===v&&0===_){if(!NX(d,p))return}else if(0===b&&0===f&&!NX(p,d))return;if(0===v&&0===b)if(0===c[0]&&h[0]>0){if(!x)return;h[0]=0}else{if(!(0===h[0]&&c[0]>0))return;if(!g)return;c[0]=0}if(0===f&&0===_)if(0===c[1]&&h[1]>0){if(!k)return;h[1]=0}else{if(!(0===h[1]&&c[1]>0))return;if(!y)return;c[1]=0}}l.domain(c),u.domain(h)}}}}(n,e)}))}},e.prototype.onDidCompile=function(t,e){var i=this._checkEnableSync(e);if(i){var n=this._getTargetAxis(e,i);if(n&&i.tickAlign){qG(e.getOption().dataSet,"tickAlign",VX);var r={targetAxis:function(){return n},currentAxis:function(){return e}};e.addTransformToTickData({type:"tickAlign",options:r,level:Number.MAX_SAFE_INTEGER},!1)}}},e.pluginType="component",e.type="AxisSyncPlugin",e}(WX),UX={left:{textAlign:"center",textBaseline:"bottom"},right:{textAlign:"center",textBaseline:"bottom"},radius:{},angle:{}};function YX(t){var e=0;return st(t,"tick.visible")&&(e+=st(t,"tick.tickSize")),st(t,"label.visible")&&(e+=st(t,"label.space")),e}function XX(t,e){var i,n,r,a,o,s;return{min:null!==(r=null!==(i=t.min)&&void 0!==i?i:null===(n=t.range)||void 0===n?void 0:n.min)&&void 0!==r?r:null==e?void 0:e.min,max:null!==(s=null!==(a=t.max)&&void 0!==a?a:null===(o=t.range)||void 0===o?void 0:o.max)&&void 0!==s?s:null==e?void 0:e.max}}function KX(t){var e=null==t?void 0:t.orient;return"top"===e||"bottom"===e||"left"===e||"right"===e||"z"===e}var qX=function(t,e,i){var n,r=null!==(n="band"===e?bY("axisBand",i):["linear","log","symlog"].includes(e)?bY("axisLinear",i):{})&&void 0!==n?n:{},a=MG(t)?bY("axisX",i):wG(t)?bY("axisY",i):bY("axisZ",i);return xz({},bY("axis",i),r,a)},ZX=function(t,e,i){var n,r=null!==(n="band"===e?bY("axisBand",i):"linear"===e?bY("axisLinear",i):{})&&void 0!==n?n:{},a=bY("angle"===t?"axisAngle":"axisRadius",i);return xz({},bY("axis",i),r,a)},JX=function(t){return"band"===t||"ordinal"===t||"point"===t};function QX(t,e){return{id:t,label:t,value:e,rawValue:t}}function $X(t,e,i){return i||!t||t.getAxisId()===e.getAxisId()}var tK=function(t){function e(e){var i=t.call(this)||this;return i.component=e,i}return S(e,t),e.prototype.releaseAll=function(){t.prototype.releaseAll.call(this),this.component=null},e}(dY);function eK(t,e,i,n){switch(t){case B.cartesianBandAxis:return qX(CG(i,["z"]),"band",e);case B.cartesianLinearAxis:return qX(CG(i,["z"]),"linear",e);case B.cartesianLogAxis:return qX(CG(i,["z"]),"log",e);case B.cartesianSymlogAxis:return qX(CG(i,["z"]),"symlog",e);case B.cartesianAxis:case B.cartesianTimeAxis:return qX(CG(i),void 0,e);case B.polarBandAxis:return ZX(i.orient,"band",e);case B.polarLinearAxis:return ZX(i.orient,"linear",e);case B.polarAxis:return ZX(i.orient,void 0,e);case B.cartesianCrosshair:return function(t,e){var i,n,r,a=xt(null!==(i=e.axes)&&void 0!==i?i:[]),o=null!==(n=bY(B.crosshair,t))&&void 0!==n?n:{},s=o.bandField,l=o.linearField,u=o.xField,c=o.yField,h=a.find((function(t){return MG(t.orient)}));r=N(h)?xz({},JX(h.type)?s:l,u):u;var d=a.find((function(t){return wG(t.orient)}));return{xField:r,yField:N(d)?xz({},WB(d.type)?s:l,c):c}}(e,n);case B.polarCrosshair:return function(t,e){var i,n,r,a=xt(null!==(i=e.axes)&&void 0!==i?i:[]),o=null!==(n=bY(B.crosshair,t))&&void 0!==n?n:{},s=o.bandField,l=o.linearField,u=o.categoryField,c=o.valueField,h=a.find((function(t){return"angle"===t.orient}));r=N(h)?xz({},JX(h.type)?s:l,u):u;var d=a.find((function(t){return"radius"===t.orient}));return{categoryField:r,valueField:N(d)?xz({},WB(d.type)?s:l,c):c}}(e,n);case B.colorLegend:case B.sizeLegend:case B.discreteLegend:case B.dataZoom:case B.scrollBar:return iK(i,bY(t,e));default:return bY(t,e)}}var iK=function(t,e){var i,n=xz({},e,e[EG(null!==(i=t.orient)&&void 0!==i?i:e.orient)]);return delete n.horizontal,delete n.vertical,n},nK=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype.getTheme=function(t,e){return eK(this.type,this._option.getTheme(),t,e)},e.prototype._mergeThemeToSpec=function(e,i){var n=t.prototype._mergeThemeToSpec.call(this,e,i),r=n.spec,a=n.theme;return this._adjustPadding(r),{spec:r,theme:a}},e.prototype._adjustPadding=function(t){var e,i=t.padding,n=t.noOuterPadding,r=void 0===n||n,a=t.orient;r&&i&&a&&(t.padding=A(A({},bF(i)),((e={})[a]=0,e)))},e}(OU),rK=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.name="component",n.modelType="component",n.transformerConstructor=nK,n._delegateEvent=function(t,e,i,r,a){var o,s;void 0===r&&(r=null),void 0===a&&(a=null),e instanceof Ch||n.event.emit(i,{model:n,node:t,event:e,item:r,datum:a,source:hG.chart,chart:null===(s=null===(o=n._option)||void 0===o?void 0:o.globalInstance)||void 0===s?void 0:s.getChart()},"model")},n._option.animation&&(n.animate=new DU({getCompiler:i.getCompiler})),n}return S(e,t),e.createComponent=function(t,e){var i=t.spec,n=M(t,["spec"]);return new this(i,A(A({},e),n))},e.prototype.getRegions=function(){return this._regions},e.prototype.created=function(){t.prototype.created.call(this),this.initLayout(),this.pluginService=new tK(this)},e.prototype.initLayout=function(){var e;t.prototype.initLayout.call(this),this._regions=null!==(e=this._regions)&&void 0!==e?e:this._option.getRegionsInIndex(),this._layout&&(this._layout.layoutBindRegionID=this._regions.map((function(t){return null==t?void 0:t.id})))},e.prototype.changeRegions=function(t){throw new Error("Method not implemented.")},e.prototype._getNeedClearVRenderComponents=function(){throw new Error("Method not implemented.")},e.prototype.onRender=function(t){throw new Error("Method not implemented.")},e.prototype.getVRenderComponents=function(){return this._getNeedClearVRenderComponents()},e.prototype.callPlugin=function(t){this.pluginService&&this.pluginService.getAll().forEach((function(e){return t(e)}))},e.prototype.getContainer=function(){var t;return this._container||(this._container=null===(t=this._option)||void 0===t?void 0:t.globalInstance.getStage().find((function(t){return"root"===t.name}),!0)),this._container},e.prototype._compareSpec=function(e,i){var n=t.prototype._compareSpec.call(this,e,i);return n.reMake||(n.reMake=["seriesId","seriesIndex","regionId","regionIndex"].some((function(t){return!mt(null==i?void 0:i[t],e[t])}))),(null==i?void 0:i.visible)!==e.visible&&(n.reCompile=!0),n},e.prototype.release=function(){var e;t.prototype.release.call(this),this.clear(),null===(e=this.pluginService)||void 0===e||e.releaseAll(),this.pluginService=null},e.prototype.clear=function(){var t,e=this,i=this._getNeedClearVRenderComponents();i&&i.length&&i.forEach((function(t){var i;t&&(null===(i=e.getContainer())||void 0===i||i.removeChild(t),t=null)})),this._container=null,null===(t=this.pluginService)||void 0===t||t.clearAll()},e.prototype.compile=function(){this.compileMarks(),this.reAppendComponents()},e.prototype.compileMarks=function(t){var e=this;this.getMarks().forEach((function(i){i.compile({group:t,context:{model:e}})}))},e.prototype.reAppendComponents=function(){var t=this,e=this._getNeedClearVRenderComponents();e&&e.length&&e.forEach((function(e){var i;e&&!e.stage&&(null===(i=t.getContainer())||void 0===i||i.appendChild(e))}))},e.prototype.getBoundsInRect=function(t,e){return{x1:0,x2:0,y1:0,y2:0}},e.prototype.getDatum=function(t){},e.transformerConstructor=nK,e}(HU),aK=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.type="component",n._componentType=i.componentType,n._mode=i.mode,n}return S(e,t),e.prototype._initProduct=function(t){var e=this.getVGrammarView(),i=this.getProductId();this._product=e.mark(MH.component,null!=t?t:e.rootMark,{componentType:this._componentType,mode:this._mode}).id(i),this._compiledProductId=i},e.type="component",e}(aY),oK=function(){kz.registerMark(aK.type,aK)},sK=function(t){return t},lK=function(t){function e(e,i){var n,r=this;return(r=t.call(this,e,i)||this).specKey="axes",r._scales=[],r._tickData=[],r._visible=!0,r._tick=void 0,r._visible=null===(n=e.visible)||void 0===n||n,r._coordinateType="none",r}return S(e,t),e.prototype.getOrient=function(){return this._orient},e.prototype.getScale=function(){return this._scale},e.prototype.getScales=function(){return this._scales},e.prototype.getTickData=function(t){return void 0===t&&(t=0),this._tickData[t]},Object.defineProperty(e.prototype,"visible",{get:function(){return this._visible},enumerable:!1,configurable:!0}),e.prototype.getInverse=function(){return this._inverse},e.prototype.getCoordinateType=function(){return this._coordinateType},e.prototype._getNeedClearVRenderComponents=function(){return[]},e.prototype.getVRenderComponents=function(){var t,e,i,n;return[null===(e=null===(t=this._axisMark)||void 0===t?void 0:t.getProduct())||void 0===e?void 0:e.getGroupGraphicItem(),null===(n=null===(i=this._gridMark)||void 0===i?void 0:i.getProduct())||void 0===n?void 0:n.getGroupGraphicItem()].filter(N)},e.prototype.created=function(){var e,i,n,r,a,o,s,l,u,c,h,d,p,f,v,g,y,m;if(t.prototype.created.call(this),this.setSeriesAndRegionsFromSpec(),this.initEvent(),this.initScales(),this.updateSeriesScale(),this._shouldComputeTickData()&&this._initData(),this._visible){var _=this._createMark({type:"component",name:"axis-".concat(this.getOrient())},{componentType:"angle"===this.getOrient()?"circleAxis":"axis",mode:this._spec.mode,noSeparateStyle:!0},{skipTheme:!0});if(this._axisMark=_,_.setMarkConfig({zIndex:this.layoutZIndex}),N(this._spec.id)&&_.setUserId(this._spec.id),_.setMarkConfig({interactive:null!==(e=this._spec.interactive)&&void 0!==e?e:this.getDefaultInteractive()}),this._marks.addMark(_),null===(i=this._spec.grid)||void 0===i?void 0:i.visible){var b=this._createMark({type:"component",name:"axis-".concat(this.getOrient(),"-grid")},{componentType:"angle"===this.getOrient()?EH.circleAxisGrid:EH.lineAxisGrid,mode:this._spec.mode,noSeparateStyle:!0},{skipTheme:!0});b.setMarkConfig({zIndex:null!==(s=null!==(a=null===(r=null===(n=this._spec.grid)||void 0===n?void 0:n.style)||void 0===r?void 0:r.zIndex)&&void 0!==a?a:null===(o=this._spec.grid)||void 0===o?void 0:o.zIndex)&&void 0!==s?s:wU.Axis_Grid,interactive:!1}),this._marks.addMark(b),this._gridMark=b}if(!1!==this._option.animation&&!1!==st(this._option.getChart().getSpec(),"animation")&&!0===this._spec.animation){var x=cX(null===(l=kz.getAnimationInKey("axis"))||void 0===l?void 0:l(),{appear:null!==(c=null!==(u=this._spec.animationAppear)&&void 0!==u?u:st(this._option.getChart().getSpec(),"animationAppear.axis"))&&void 0!==c?c:st(this._option.getChart().getSpec(),"animationAppear"),disappear:null!==(d=null!==(h=this._spec.animationDisappear)&&void 0!==h?h:st(this._option.getChart().getSpec(),"animationDisappear.axis"))&&void 0!==d?d:st(this._option.getChart().getSpec(),"animationDisappear"),enter:null!==(f=null!==(p=this._spec.animationEnter)&&void 0!==p?p:st(this._option.getChart().getSpec(),"animationEnter.axis"))&&void 0!==f?f:st(this._option.getChart().getSpec(),"animationEnter"),exit:null!==(g=null!==(v=this._spec.animationExit)&&void 0!==v?v:st(this._option.getChart().getSpec(),"animationExit.axis"))&&void 0!==g?g:st(this._option.getChart().getSpec(),"animationExit"),update:null!==(m=null!==(y=this._spec.animationUpdate)&&void 0!==y?y:st(this._option.getChart().getSpec(),"animationUpdate.axis"))&&void 0!==m?m:st(this._option.getChart().getSpec(),"animationUpdate")});x.enter&&(x.update[0].customParameters={enter:x.enter[0]}),this._marks.forEach((function(t){return t.setAnimationConfig(x)}))}}},e.prototype._shouldComputeTickData=function(){return this.getVisible()||this._spec.forceInitTick},e.prototype._initData=function(){var t=this._initTickDataSet(this._tickTransformOption());t.target.addListener("change",this._forceLayout.bind(this)),this._tickData=[new iY(this._option,t)]},e.prototype.collectData=function(t,e){var i=this,n=[];return XO(this._regions,(function(r){var a,o=i.collectSeriesField(t,r);if(o=X(o)?NB(i._scale.type)?o:[o[0]]:[o],t||(i._dataFieldText=r.getFieldAlias(o[0])),o){var s=r.getViewData();if(e)o.forEach((function(t){n.push(r.getRawDataStatisticsByField(t,!1))}));else if(s&&s.latestData&&s.latestData.length){var l=null===(a=r.getViewDataStatistics)||void 0===a?void 0:a.call(r),u=i.type===B.cartesianLinearAxis&&i._spec.breaks&&i._spec.breaks.length;o.forEach((function(t){var e;(null===(e=null==l?void 0:l.latestData)||void 0===e?void 0:e[t])&&(u?n.push(A(A({},l.latestData[t]),{values:s.latestData.map((function(e){return e[t]}))})):n.push(l.latestData[t]))}))}}}),{userId:this._seriesUserId,specIndex:this._seriesIndex}),n},e.prototype.isSeriesDataEnable=function(){var t=!0;return XO(this._regions,(function(e){var i;X(null===(i=e.getViewDataStatistics())||void 0===i?void 0:i.latestData)&&(t=!1)}),{userId:this._seriesUserId,specIndex:this._seriesIndex}),t},e.prototype.setSeriesAndRegionsFromSpec=function(){var t=this._spec,e=t.seriesId,i=t.seriesIndex,n=t.regionId,r=t.regionIndex;N(e)&&(this._seriesUserId=xt(e)),N(n)&&(this._regionUserId=xt(n)),N(i)&&(this._seriesIndex=xt(i)),N(r)&&(this._regionIndex=xt(r)),this._regions=this._option.getRegionsInUserIdOrIndex(this._regionUserId,this._regionIndex),this.layout.layoutBindRegionID=this._regions.map((function(t){return t.id}))},e.prototype.getBindSeriesFilter=function(){return{userId:this._seriesUserId,specIndex:this._seriesIndex}},e.prototype.initEvent=function(){var t=this;this.event.on(cG.scaleUpdate,{filter:function(e){var i=e.model;return(null==i?void 0:i.id)===t.id}},this.effect.scaleUpdate.bind(this));var e=KO(this._regions,{userId:this._seriesUserId,specIndex:this._seriesIndex}).map((function(t){return t.getViewDataStatistics()})).filter((function(t){return!!t}));e.length>1?this._option.dataSet.multipleDataViewAddListener(e,"change",(function(){t.updateScaleDomain()})):1===e.length&&e[0].target.addListener("change",(function(){t.updateScaleDomain()})),XO(this._regions,(function(e){e.event.on(cG.rawDataUpdate,{filter:function(t){var i=t.model;return(null==i?void 0:i.id)===e.id}},(function(){t._clearRawDomain()}))}),{userId:this._seriesUserId,specIndex:this._seriesIndex})},e.prototype.updateScaleDomain=function(){},e.prototype._clearRawDomain=function(){},e.prototype.onLayoutEnd=function(e){this.updateScaleRange(),this.event.emit(cG.scaleUpdate,{model:this,value:"range"}),t.prototype.onLayoutEnd.call(this,e)},e.prototype.computeData=function(t){"force"!==t||this._tickData&&this._tickData.length?!this._tickData||!this._tickData.length||"force"!==t&&mt(this._scale.range(),[0,1])||this._tickData.forEach((function(t){t.getDataView().reRunAllTransform(),t.updateData()})):XO(this._regions,(function(t){var e;null===(e=t.getViewData())||void 0===e||e.reRunAllTransform()}),{userId:this._seriesUserId,specIndex:this._seriesIndex})},e.prototype.initScales=function(){this._scales=[this._scale];var t=[];if(XO(this._regions,(function(e){var i=e.getGroups();i&&t.push(i)}),{userId:this._seriesUserId,specIndex:this._seriesIndex}),0!==t.length)for(var e=St(t.map((function(t){return t.fields.length}))),i=1;i<e;i++){var n=this._scale.clone();this._scales.push(n)}},e.prototype._compareSpec=function(e,i){var n=t.prototype._compareSpec.call(this,e,i);return n.reMake?n:(n.reRender=!0,(null==i?void 0:i.type)!==(null==e?void 0:e.type)||(null==i?void 0:i.visible)!==(null==e?void 0:e.visible)?(n.reMake=!0,n):(n.reMake=["grid","subGrid","tick","subTick","label","domainLine","title"].some((function(t){var n,r;return(null===(n=null==i?void 0:i[t])||void 0===n?void 0:n.visible)!==(null===(r=null==e?void 0:e[t])||void 0===r?void 0:r.visible)})),n))},e.prototype._getAxisAttributes=function(){var t,e=this,i=this._spec,n={orient:this.getOrient(),select:!0!==this._option.disableTriggerEvent&&i.select,hover:!0!==this._option.disableTriggerEvent&&i.hover};if(i.domainLine&&i.domainLine.visible?n.line=((t=NH(t=i.domainLine)).startSymbol=NH(t.startSymbol),t.endSymbol=NH(t.endSymbol),t):n.line={visible:!1},i.label&&i.label.visible){var r=vt(i.label,["style","formatMethod","state"]);n.label=r,i.label.style&&(n.label.style=H(i.label.style)?function(t,n,r,a){var o,s=i.label.style(t.rawValue,n,t,r,a);return GH(xz({},null===(o=e._theme.label)||void 0===o?void 0:o.style,s))}:GH(i.label.style)),(i.label.formatMethod||i.label.formatter)&&(n.label.formatMethod=this._getLabelFormatMethod()),i.label.state&&(n.label.state=function(t){if(ot(t))return null;var e={};return Object.keys(t).forEach((function(i){H(t[i])?e[i]=function(e,n,r,a){return GH(t[i](e.rawValue,n,e,r,a))}:ot(t[i])||(e[i]=GH(t[i]))})),e}(i.label.state)),H(i.label.dataFilter)&&(n.label.dataFilter=function(t,n){return i.label.dataFilter(t,n,{vchart:e._option.globalInstance})})}else n.label={visible:!1};if(i.tick&&i.tick.visible?(n.tick={visible:i.tick.visible,length:i.tick.tickSize,inside:i.tick.inside,alignWithLabel:i.tick.alignWithLabel,dataFilter:H(i.tick.dataFilter)?function(t){return i.tick.dataFilter(t,{vchart:e._option.globalInstance})}:void 0},i.tick.style&&(n.tick.style=H(i.tick.style)?function(t,n,r,a){var o,s=i.tick.style(t,n,r,a);return GH(xz({},null===(o=e._theme.tick)||void 0===o?void 0:o.style,s))}:GH(i.tick.style)),i.tick.state&&(n.tick.state=VH(i.tick.state))):n.tick={visible:!1},i.subTick&&i.subTick.visible?(n.subTick={visible:i.subTick.visible,length:i.subTick.tickSize,inside:i.subTick.inside,count:i.subTick.tickCount},i.subTick.style&&(n.subTick.style=H(i.subTick.style)?function(t,n,r,a){var o,s=i.subTick.style(t,n,r,a);return GH(xz({},null===(o=e._theme.subTick)||void 0===o?void 0:o.style,s))}:GH(i.subTick.style)),i.subTick.state&&(n.subTick.state=VH(i.subTick.state))):n.subTick={visible:!1},i.title&&i.title.visible){var a=i.title,o=a.autoRotate,s=a.angle,l=a.style,u=void 0===l?{}:l,c=a.background,h=a.state,d=a.shape,p=M(a,["autoRotate","angle","style","background","state","shape"]),f=s,v=void 0;"left"!==i.orient&&"right"!==i.orient||o&&j(f)&&(f="left"===i.orient?-90:90,v=UX[i.orient]),n.title=A(A({},p),{autoRotate:!1,angle:f?we(f):null,textStyle:xz({},v,GH(u)),pickable:!1!==u.pickable,childrenPickable:!1!==u.pickable,state:{}}),d&&d.visible?(n.title.shape=A(A({},d),{style:GH(d.style)}),d.state&&(n.title.state.shape=VH(d.state))):n.title.shape={visible:!1},c&&c.visible?(n.title.background=A(A({},c),{style:GH(c.style)}),c.state&&(n.title.state.background=VH(c.state))):n.title.background={visible:!1},h&&(n.title.state.text=VH(h))}else n.title={visible:!1};return i.background&&i.background.visible?(n.panel={visible:!0},i.background.style&&(n.panel.style=GH(i.background.style)),i.background.state&&(n.panel.state=VH(i.background.state))):n.panel={visible:!1},n},e.prototype._getGridAttributes=function(){var t=this,e=this._spec;return{alternateColor:e.grid.alternateColor,alignWithLabel:e.grid.alignWithLabel,style:H(e.grid.style)?function(){return function(i,n){var r,a,o=e.grid.style(null===(r=i.datum)||void 0===r?void 0:r.rawValue,n,i.datum);return GH(xz({},null===(a=t._theme.grid)||void 0===a?void 0:a.style,o))}}:GH(e.grid.style),subGrid:!1===e.subGrid.visible?{visible:!1}:{type:"line",visible:e.subGrid.visible,alternateColor:e.subGrid.alternateColor,style:GH(e.subGrid.style)}}},e.prototype._getLabelFormatMethod=function(){var t=this._spec.label,e=t.formatMethod,i=t.formatter,n=xY(e,i).formatFunc;return n?function(t,e,r){return n(e.rawValue,e,i)}:null},e.prototype._initTickDataSet=function(t,e){void 0===e&&(e=0),ZG(this._option.dataSet,"scale",sK);var i=this.registerTicksTransform();return new Ms(this._option.dataSet,{name:"".concat(this.type,"_").concat(this.id,"_ticks_").concat(e)}).parse(this._scales[e],{type:"scale"}).transform({type:i,options:t},!1)},e.prototype._tickTransformOption=function(){var t=this._tick||{},e=this._spec.label||{},i=t.tickCount,n=t.forceTickCount,r=t.tickStep,a=t.tickMode,o=e.style,s=e.formatMethod,l=e.minGap;return{sampling:!1!==this._spec.sampling,tickCount:i,forceTickCount:n,tickStep:r,tickMode:a,axisOrientType:this._orient,coordinateType:this._coordinateType,labelStyle:o,labelFormatter:s,labelGap:l}},e.prototype.addTransformToTickData=function(t,e){this._tickData.forEach((function(i){var n;null===(n=null==i?void 0:i.getDataView())||void 0===n||n.transform(t,e)}))},e.prototype.dataToPosition=function(t){return this._scale.scale(t)},e.prototype.getDatum=function(t){var e,i;return t&&t.name===XR.label?t.data:this._axisMark?null===(i=null===(e=this._axisMark.getProduct())||void 0===e?void 0:e.getGroupGraphicItem())||void 0===i?void 0:i.attribute.items:void 0},e.specKey="axes",e}(rK),uK=function(){oK(),kz.registerAnimation("axis",(function(){return{appear:{custom:op},update:{custom:DB},exit:{custom:sp}}}))},cK=[GX],hK=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.type=B.cartesianAxis,n.name=B.cartesianAxis,n._defaultBandPosition=.5,n._defaultBandInnerPadding=.1,n._defaultBandOuterPadding=.3,n.layoutType="region-relative",n.layoutZIndex=wU.Axis,n.layoutLevel=TU.Axis,n._orient="left",n._autoIndentOnce=!1,n._hasAutoIndent=!1,n._scales=[],n._tick=void 0,n._layoutCache={width:0,height:0,_lastComputeOutBounds:{x1:0,x2:0,y1:0,y2:0}},n._innerOffset={top:0,bottom:0,left:0,right:0},n.effect={scaleUpdate:function(t){n.computeData(null==t?void 0:t.value),XO(n._regions,(function(t){var e=n.getOrient();MG(e)?$X(t.getXAxisHelper(),n.axisHelper(),N(n._seriesUserId)||N(n._seriesIndex))&&t.setXAxisHelper(n.axisHelper()):wG(e)?$X(t.getYAxisHelper(),n.axisHelper(),N(n._seriesUserId)||N(n._seriesIndex))&&t.setYAxisHelper(n.axisHelper()):TG(e)&&$X(t.getZAxisHelper(),n.axisHelper(),N(n._seriesUserId)||N(n._seriesIndex))&&t.setZAxisHelper(n.axisHelper())}),{userId:n._seriesUserId,specIndex:n._seriesIndex})}},n._transformLayoutPosition=function(t){var e=t.x,i=t.y;return Q(e)&&(e+=Number("left"===n._orient)*n.getLayoutRect().width),Q(i)&&(i+=Number("top"===n._orient)*n.getLayoutRect().height),{x:e,y:i}},n._transformLayoutRect=function(t){if(!n._visible)return t;var e=n._latestBounds.clone().translate(-n.getLayoutStartPoint().x,-n.getLayoutStartPoint().y);switch(n._layout.layoutOrient){case"left":0===n._layout.layoutRectLevelMap.width&&(t.width=e.x1<0?-e.x1:0);break;case"right":0===n._layout.layoutRectLevelMap.width&&(t.width=e.x2>0?e.x2:0);break;case"top":0===n._layout.layoutRectLevelMap.height&&(t.height=e.y1<0?-e.y1:0);break;case"bottom":0===n._layout.layoutRectLevelMap.height&&(t.height=e.y2>0?e.y2:0)}return t.width=Math.ceil(t.width),t.height=Math.ceil(t.height),n._layout.setRectInSpec(n._layoutCacheProcessing(t))},n._updateAxisLayout=function(){var t=n.getLayoutStartPoint(),e=n._getUpdateAttribute(!1),i=e.grid,r=M(e,["grid"]),a=n._axisMark.getProduct(),o=xz({x:t.x,y:t.y},n._axisStyle,r);(a.encode(o),n._gridMark)&&n._gridMark.getProduct().encode(xz({x:t.x,y:t.y},n._getGridAttributes(),i))},n._fixAxisOnZero=function(){var t=n._spec.domainLine,e=t.onZero,i=t.visible;if(n.visible&&e&&!1!==i){var r=n._spec.domainLine,a=r.onZeroAxisId,o=r.onZeroAxisIndex,s=n._option.getComponentsByKey("axes"),l=MG(n.getOrient()),u=function(t){var e;return(l?!MG(t.getOrient()):MG(t.getOrient()))&&NB(t.getScale().type)&&(t.getTickData()?null===(e=t.getTickData().getLatestData())||void 0===e?void 0:e.find((function(t){return 0===t.value})):t.getScale().domain()[0]<=0&&kt(t.getScale().domain())>=0)},c=s.filter((function(t){return u(t)}));if(c.length){var h=void 0;if(N(a))h=c.find((function(t){return t.id===a}));else if(N(o)){var d=s[o];u(d)&&(h=d)}else h=c[0];if(h){var p=n._axisMark.getProduct(),f=h.valueToPosition(0);l?p.encode({line:A(A({},n._axisStyle.line),{dy:"bottom"===n._orient?-((h.getInverse()?h.getScale().range()[1]:h.getScale().range()[0])-f):f})}):p.encode({line:A(A({},n._axisStyle.line),{dx:"left"===n._orient?f:-((h.getInverse()?h.getScale().range()[0]:h.getScale().range()[1])-f)})})}}}},n._orient=CG(e,["z"]),TG(n._orient)&&(n.layoutType="absolute"),n._dataSet=i.dataSet,n._coordinateType="cartesian",n}return S(e,t),e.prototype.getOrient=function(){return this._orient},e.prototype.getDefaultInteractive=function(){return!0},Object.defineProperty(e.prototype,"autoIndentOnce",{set:function(t){this._autoIndentOnce=t},enumerable:!1,configurable:!0}),e.prototype.getScales=function(){return this._scales},e.getSpecInfo=function(t){var e=this,i=t[this.specKey];if(!i)return null;var n="horizontal"===t.direction;if(!X(i)){if(!KX(i))return null;var r=PG(i,n),a=r.axisType,o=r.componentName;return i.type=a,[{spec:i,specPath:[this.specKey],specInfoPath:["component",this.specKey,0],type:o}]}var s=i.filter((function(t){return"z"===t.orient}))[0],l=!0;if(s){var u=i.filter((function(t){return"bottom"===t.orient}))[0],c=i.filter((function(t){return wG(t.orient)}))[0];l=3===i.length&&u&&c}var h=i.map((function(t,e){return{spec:t,index:e}}));l||(h=h.filter((function(t){return"z"!==t.spec.orient})));var d=[];return h.forEach((function(t){var i=t.spec,r=t.index;if(KX(i)){var a=PG(i,n),o=a.axisType,s=a.componentName;i.type=o,d.push({spec:i,specPath:[e.specKey,r],specInfoPath:["component",e.specKey,r],type:s})}})),d},e.createComponent=function(t,e){var i=t.spec,n=M(t,["spec"]),r=kz.getComponentInKey(n.type);return r?new r(i,A(A({},e),n)):(e.onError("Component ".concat(n.type," not found")),null)},e.prototype.initLayout=function(){t.prototype.initLayout.call(this),this._layout.autoIndent=!1!==this._spec.autoIndent,this._layout.layoutOrient=this._orient},e.prototype.setLayout3dBox=function(t){this.layout3dBox=t},e.prototype.getNewScaleRange=function(){var t=this.getLayoutRect(),e=t.width,i=t.height,n=this._innerOffset,r=n.left,a=n.right,o=n.top,s=n.bottom,l=[];return MG(this.getOrient())?Q(e)&&(l=this._inverse?[e-a,r]:[r,e-a]):TG(this.getOrient())?Q(e)&&(l=this._inverse?[e-a,r]:[r,e-a],this._scale.range(l)):Q(i)&&(l=this._inverse?[o,i-s]:[i-s,o]),l},e.prototype.updateScaleRange=function(){var t=!1,e=this.getNewScaleRange(),i=this._scale.range();return e.length===i.length&&e.every((function(t,e){return t===i[e]}))?t=!1:(t=!0,this._scale.range(e)),t},e.prototype.init=function(e){var i,n=this;t.prototype.init.call(this,e),null===(i=this.pluginService)||void 0===i||i.load(cK.map((function(t){return new t}))),this.callPlugin((function(t){n.pluginService&&t.onInit&&t.onInit(n.pluginService,n)}))},e.prototype.setAttrFromSpec=function(){var e;if(t.prototype.setAttrFromSpec.call(this),this.visible){MG(this.getOrient())?U(this._spec.maxHeight)&&(this._spec.maxHeight="30%"):U(this._spec.maxWidth)&&(this._spec.maxWidth="30%");var i=this._getAxisAttributes();i.label.formatMethod=this._getLabelFormatMethod(),i.verticalFactor="top"===this.getOrient()||"right"===this.getOrient()?-1:1,this._axisStyle=i}this._tick=this._spec.tick;var n=null===(e=this._option.getChart())||void 0===e?void 0:e.getSpec();this._inverse=function(t,e){var i=t.inverse;return e&&!MG(t.orient)&&(i=!N(t.inverse)||!t.inverse),i}(this._spec,"horizontal"===(null==n?void 0:n.direction))},e.prototype.onLayoutStart=function(e,i,n){var r=this;if(t.prototype.onLayoutStart.call(this,e,i,n),!TG(this.getOrient())&&this._spec.innerOffset){var a=this._spec;wG(this.getOrient())?["top","bottom"].forEach((function(t){r._innerOffset[t]=mF(a.innerOffset[t],i.height,i)})):["left","right"].forEach((function(t){r._innerOffset[t]=mF(a.innerOffset[t],i.width,i)}))}},e.prototype.getSeriesStatisticsField=function(t){var e;return e=MG(this.getOrient())?t.fieldX:TG(this.getOrient())?t.fieldZ:t.fieldY,NB(this._scale.type)?e:[e[0]]},e.prototype._tickTransformOption=function(){var e,i,n,r;return A(A({},t.prototype._tickTransformOption.call(this)),{noDecimals:null===(e=this._tick)||void 0===e?void 0:e.noDecimals,labelLastVisible:null===(i=this._spec.label)||void 0===i?void 0:i.lastVisible,labelFirstVisible:null===(n=this._spec.label)||void 0===n?void 0:n.firstVisible,labelFlush:null===(r=this._spec.label)||void 0===r?void 0:r.flush})},e.prototype.axisHelper=function(){var t=this;return{isContinuous:NB(this._scale.type),dataToPosition:this.dataToPosition.bind(this),getScale:function(e){return void 0===e&&(e=0),t._scales[e]},getAxisType:function(){return t.type},getAxisId:function(){return t.id},isInverse:function(){return!0===t._inverse},getSpec:function(){return t._spec}}},e.prototype.afterCompile=function(){var t,e=this,i=null===(t=this._axisMark)||void 0===t?void 0:t.getProduct();i&&i.addEventListener(DH.AFTER_ELEMENT_ENCODE,(function(){if(!1===e._isLayout&&(MG(e.getOrient())?e.callPlugin((function(t){e.pluginService&&t.onDidLayoutHorizontal&&t.onDidLayoutHorizontal(e.pluginService,e)})):e.callPlugin((function(t){e.pluginService&&t.onDidLayoutVertical&&t.onDidLayoutVertical(e.pluginService,e)})),e._unitText)){var t=e.getLayoutStartPoint(),i=t.x,n=t.y,r=MG(e._orient)?{x:St(e._scale.range())+i,y:n}:{x:i,y:At(e._scale.range())+n};e._unitText.setAttributes(r)}})),this.callPlugin((function(t){e.pluginService&&t.onDidCompile&&t.onDidCompile(e.pluginService,e)}))},e.prototype.onRender=function(t){},e.prototype.changeRegions=function(t){},e.prototype.update=function(t){},e.prototype.resize=function(t){},e.prototype.collectScale=function(){var t=this,e=[];return XO(this._regions,(function(i){e.push("left"===t.getOrient()||"right"===t.getOrient()?i.scaleY:i.scaleX)}),{userId:this._seriesUserId,specIndex:this._seriesIndex}),e},e.prototype.collectSeriesField=function(t,e){var i,n;return t>0?null===(n=null===(i=e.getGroups())||void 0===i?void 0:i.fields)||void 0===n?void 0:n[t]:MG(this.getOrient())?e.getSpec().x2Field?P(P([],E(e.fieldX),!1),[e.fieldX2],!1):e.fieldX:TG(this.getOrient())?e.fieldZ:e.getSpec().y2Field?P(P([],E(e.fieldY),!1),[e.fieldY2],!1):e.fieldY},e.prototype.updateSeriesScale=function(){var t=this,e=this.getOrient();XO(this._regions,(function(i){MG(e)?$X(i.getXAxisHelper(),t.axisHelper(),N(t._seriesUserId)||N(t._seriesIndex))&&(i.setScaleX(t._scale),i.setXAxisHelper(t.axisHelper())):wG(e)?$X(i.getYAxisHelper(),t.axisHelper(),N(t._seriesUserId)||N(t._seriesIndex))&&(i.setScaleY(t._scale),i.setYAxisHelper(t.axisHelper())):TG(e)&&$X(i.getZAxisHelper(),t.axisHelper(),N(t._seriesUserId)||N(t._seriesIndex))&&(i.setScaleZ(t._scale),i.setZAxisHelper(t.axisHelper()))}),{userId:this._seriesUserId,specIndex:this._seriesIndex})},e.prototype.getBoundsInRect=function(t){var e,i=this,n={x1:0,y1:0,x2:0,y2:0};if(!this._visible)return n;this._verticalLimitSize=MG(this.getOrient())?t.height:t.width,this.setLayoutRect(t),!this.updateScaleRange()&&X(null===(e=this.getTickData())||void 0===e?void 0:e.getLatestData())||this.computeData("range");var r={skipLayout:!1},a=MG(this.getOrient());this.pluginService&&(a?this.callPlugin((function(t){t.onWillLayoutHorizontal&&t.onWillLayoutHorizontal(i.pluginService,r,i)})):this.callPlugin((function(t){t.onWillLayoutVertical&&t.onWillLayoutVertical(i.pluginService,r,i)})));var o=this._axisMark.getProduct(),s=this._getUpdateAttribute(!0),l=o.getGroupGraphicItem(),u=xz(A({},this.getLayoutStartPoint()),this._axisStyle,s,{line:{visible:!1}}),c=l.getBoundsWithoutRender(u);return c.empty()&&(c=(new di).set(u.x,u.y,u.x,u.y)),!0,this._latestBounds=c,n=this._appendAxisUnit(c,a)},e.prototype.positionToData=function(t,e){var i=MG(this.getOrient());e&&(t-=i?this.getLayoutStartPoint().x:this.getLayoutStartPoint().y),this._innerOffset&&(t=i?Ut(t,this._innerOffset.left,this.getLayoutRect().width-this._innerOffset.right):Ut(t,this._innerOffset.top,this.getLayoutRect().height-this._innerOffset.bottom));var n=this._scale.range();return(t-n[0])*(t-kt(n))>0?null:this._scale.invert(t)},e.prototype._getTitleLimit=function(t){var e,i,n,r,a,o=this._spec.title;if(o.visible&&j(null===(e=o.style)||void 0===e?void 0:e.maxLineWidth)){var s=null!==(a=null!==(n=null===(i=this._axisStyle.title)||void 0===i?void 0:i.angle)&&void 0!==n?n:null===(r=o.style)||void 0===r?void 0:r.angle)&&void 0!==a?a:0;if(t){var l=this.getLayoutRect().width,u=Math.abs(Math.cos(s));return u<1e-6?1/0:l/u}var c=this.getLayoutRect().height,h=Math.abs(Math.sin(s));return h<1e-6?1/0:c/h}return null},e.prototype._getUpdateAttribute=function(t){var e,i=0,n=0;if(!t){for(var r=this.getRegions(),a=r[0].getLayoutStartPoint(),o=a.x,s=a.y,l=o+r[0].getLayoutRect().width,u=s+r[0].getLayoutRect().height,c=1;c<r.length;c++){var h=r[c],d=h.getLayoutStartPoint(),p=d.x,f=d.y,v=h.getLayoutRect(),g=v.width,y=v.height;o=Math.min(o,p),l=Math.max(l,g+p),s=Math.min(s,f),u=Math.max(u,y+f)}i=Math.abs(u-s),n=Math.abs(l-o)}var m=this.getLayoutRect(),_=m.width,b=m.height,x=MG(this._orient),k=wG(this._orient),S=TG(this._orient),A=this.layout3dBox?this.layout3dBox.length:0,M={x:0,y:0},w=i,T=_;x?M={x:_,y:0}:k?(M={x:0,y:b},w=n,T=b):S&&(M={x:A,y:0});var C=this.getLabelItems(T),E={start:{x:0,y:0},end:M,title:{text:this._spec.title.text||this._dataFieldText,maxWidth:this._getTitleLimit(x)},items:C};if(t||(E.grid={type:"line",start:{x:0,y:0},end:M,items:C[0],verticalFactor:this._axisStyle.verticalFactor,depth:A,length:w}),S){var P=null!==(e=this.directionStr)&&void 0!==e?e:"r2l",R=this.layout3dBox?this.layout3dBox.width:0,B=[0,0],I=-Math.PI/2,L=0;"l2r"===P&&(L=this.layout3dBox.length,B=[0,0,0],I=Math.PI/2),E.z=L,E.alpha=I,E.anchor3d=B,t||(E.grid.depth=R)}else{var D=x?this.layout.minHeight:this.layout.minWidth;(x&&9===this._layout.layoutRectLevelMap.height||k&&9===this._layout.layoutRectLevelMap.width)&&(D=this._verticalLimitSize),E.verticalLimitSize=this._verticalLimitSize,E.verticalMinSize=D,E.label={overflowLimitLength:this._getLabelOverflowLimit(x)}}return E},e.prototype.getLabelItems=function(t){var e,i=this,n=null===(e=this.getTickData())||void 0===e?void 0:e.getLatestData();return n&&n.length?[n.map((function(e){var n=i._getNormalizedValue([e.value],t);return QX(e.value,n)})).filter((function(t){var e=t.value,n=t.rawValue,r=i._scale.domain();return"log"===i.getSpec().type?e>=0&&e<=1:NB(i._scale.type)?n>=r[0]&&n<=kt(r):r.includes(n)}))]:[]},e.prototype.initEvent=function(){var e=this;t.prototype.initEvent.call(this),this.visible&&(this.event.on(cG.layoutEnd,this._updateAxisLayout),this.event.on(cG.layoutEnd,this._fixAxisOnZero),this.event.on(cG.layoutRectUpdate,(function(){e._clearLayoutCache()})))},e.prototype._getNormalizedValue=function(t,e){return 0===e?0:this.dataToPosition(t)/e},e.prototype._layoutCacheProcessing=function(t){var e=this;return["width","height"].forEach((function(i){t[i]<e._layoutCache[i]?t[i]=e._layoutCache[i]:e._layoutCache[i]=t[i]})),this._autoIndentOnce&&this._hasAutoIndent?["x1","x2","y1","y2"].forEach((function(t){e.layout.getLastComputeOutBounds()[t]=e._layoutCache._lastComputeOutBounds[t]})):(this._hasAutoIndent=!0,["x1","x2","y1","y2"].forEach((function(t){e.layout.getLastComputeOutBounds()[t]<e._layoutCache._lastComputeOutBounds[t]?e.layout.getLastComputeOutBounds()[t]=e._layoutCache._lastComputeOutBounds[t]:e._layoutCache._lastComputeOutBounds[t]=e.layout.getLastComputeOutBounds()[t]}))),t},e.prototype._clearLayoutCache=function(){this._hasAutoIndent=!1,this._layoutCache.width=0,this._layoutCache.height=0,this._layoutCache._lastComputeOutBounds={x1:0,x2:0,y1:0,y2:0}},e.prototype.onDataUpdate=function(){this._clearLayoutCache()},e.prototype._appendAxisUnit=function(t,e){var i;if(this._spec.unit&&this._spec.unit.visible){var n=this._spec.unit,r=n.text,a=n.style,o=void 0,s=void 0,l=this.getLayoutStartPoint(),u=l.x,c=l.y;e?(o={x:St(this._scale.range())+u,y:c},s={textAlign:"left",textBaseline:"middle"}):(o={x:u,y:At(this._scale.range())+c},s={textAlign:"left"===this._orient?"left":"right",textBaseline:"bottom"}),s=A(A(A({},s),a),{x:o.x,y:o.y,text:r}),this._unitText?this._unitText.setAttributes(s):(this._unitText=zg(s),this._unitText.name="axis-unit",null===(i=this.getContainer())||void 0===i||i.add(this._unitText));var h=this._unitText.AABBBounds;e?(t.x2+=h.x2>t.x2?h.x2-t.x2:0,t.y2+=h.y2>t.y2?h.y2-t.y2:0):(t.x1+=h.x1<t.x1?h.x1-t.x1:0,t.y1+=h.y1<t.y1?h.y1-t.y1:0)}return t},e.prototype._getNeedClearVRenderComponents=function(){return this._unitText?[this._unitText]:[]},e.prototype._getLabelOverflowLimit=function(t){var e,i;if(t&&!1!==(null===(e=this._spec.label)||void 0===e?void 0:e.visible)&&!0===(null===(i=this._spec.label)||void 0===i?void 0:i.autoLimit)){var n=this._option.getComponentsByKey("axes"),r=this.getRegions(),a=n.filter((function(t){var e=t.getOrient();return("left"===e||"right"===e)&&t.getRegions().some((function(t){return r.includes(t)}))})),o=0,s=0,l=this.getLayoutStartPoint().x,u=l+this.getLayoutRect().width;return a.forEach((function(t){var e=t.getLayoutStartPoint().x;if("left"===t.getOrient()&&e===l){var i=t.getLayoutRect().width;o=Math.max(o,i)}else if(e===u){var n=t.getLayoutRect().width;s=Math.max(s,n)}})),{left:o,right:s}}},e.type=B.cartesianAxis,e.specKey="axes",e}(lK),dK=function(t,e,i){return i.reduce((function(t,n,r){return t.push([n,i.length===r+1?e:i[r+1]]),t}),[[t,i[0]]])};function pK(t,e){var i=t[0],n=t[t.length-1],r=e.filter((function(t){return t>i&&t<n}));return 0===r.length?[[i,n]]:dK(i,n,r)}var fK=function(t,e){return t-e},vK=function(t,e){for(var i=[{count:0,sub:[],max:e[0],min:e[0]}],n=0,r=0;n<e.length;)t[r]<=e[n]?(i[n].count+=1,i[n].sub.push(t[r]),r+=1):i[n+=1]={count:0,sub:[],max:e[n],min:e[n]};i.forEach((function(t){t.count&&(t.min=Math.min.apply(null,t.sub))}));var a=t.slice(r);return i[n]={count:a.length,sub:a,min:e[e.length-1],max:Math.max.apply(null,a)},i};function gK(t,e,i){void 0===i&&(i="count");var n=vK(t,e),r="count"===i?t.length:n.reduce((function(t,e,i){return e.count>0?t+e.max-e.min:t}),0),a=[],o=0,s=0;return n.forEach((function(t,e){if(0===r)a.push([0,e/n.length-1]);else{var l="count"===i?t.count:t.max-t.min,u=a[s-1]?a[s-1][1]:0,c=e===n.length-1?1:Math.min((o+l)/r,1);(u!==c||0!==u&&1!==u)&&(s+=1,a.push([u,c]),o+=l)}})),a}var yK=Math.sqrt(50),mK=Math.sqrt(10),_K=Math.sqrt(2),bK=function(){function t(){this._extend={},this.niceLabelFormatter=null}return t.prototype.setExtraAttrFromSpec=function(){N(this._spec.nice)&&(this._nice=this._spec.nice),N(this._spec.zero)&&(this._zero=this._spec.zero),this._expand=this._spec.expand,this._domain=XX(this._spec)},t.prototype.transformScaleDomain=function(){this.setScaleNice()},t.prototype.setLinearScaleNice=function(){var t;if(!this._nice)return!1;var e=5,i=this._spec.tick||{};if(Q(i.forceTickCount))e=i.forceTickCount;else if(H(i.tickCount)){var n=this._scale.range(),r=Math.abs(kt(n)-n[0]);if(1===r&&this._option)r=MG(this._orient)?this._option.getChartViewRect().width:this._option.getChartViewRect().height;e=i.tickCount({axisLength:r,labelStyle:this._spec.label&&this._spec.label.style})}else e=Q(i.tickCount)?i.tickCount:5;"accurateFirst"===this._spec.niceType&&(e=Math.max(5,e));var a=null!==(t=this._domain)&&void 0!==t?t:{},o=a.min,s=a.max;return j(o)&&j(s)&&j(this._softMaxValue)&&j(this._softMinValue)?this._scale.nice(e):(N(o)||N(this._softMinValue))&&j(s)&&j(this._softMaxValue)?this._scale.niceMax(e):!(!j(o)||!j(this._softMinValue)||!N(s)&&!N(this._softMaxValue))&&this._scale.niceMin(e)},t.prototype.setLogScaleNice=function(){var t;if(!this._nice)return!1;var e=null!==(t=this._domain)&&void 0!==t?t:{},i=e.min,n=e.max;return j(i)&&j(n)&&j(this._softMaxValue)&&j(this._softMinValue)?this._scale.nice():(N(i)||N(this._softMinValue))&&j(n)&&j(this._softMaxValue)?this._scale.niceMax():!(!j(i)||!j(this._softMinValue)||!N(n)&&!N(this._softMaxValue))&&this._scale.niceMin()},t.prototype.setScaleNice=function(){return"log"===this._spec.type?this.setLogScaleNice():this.setLinearScaleNice()},t.prototype.dataToPosition=function(t,e){return this.valueToPosition(t[0])},t.prototype.valueToPosition=function(t){return this._scale.scale(t)},t.prototype.computeLinearDomain=function(t){var e=[];if(t.length){var i,n,r=this._spec.breaks&&this._spec.breaks.length,a=[];if(t.forEach((function(t){var e=t.min,o=t.max;i=void 0===i?e:Math.min(i,e),n=void 0===n?o:Math.max(n,o),r&&(a=a.concat(t.values))})),r){for(var o=[],s=[],l=j(this._domain.max)?n:this._domain.max,u=0;u<this._spec.breaks.length;u++){var c=this._spec.breaks[u].range;c[0]<=c[1]&&c[1]<=l&&(o.push(c),s.push(this._spec.breaks[u]))}if(o.sort((function(t,e){return t[0]-e[0]})),o.length){var h=function(t,e,i){return t.sort(fK),e.sort(fK),{domain:pK(t,e),scope:gK(t,e,i)}}(a,Lk(o),this._spec.breaks[0].scopeType),d=h.domain,p=h.scope;e=Lk(d),this._break={domain:d,scope:p,breakDomains:o,breaks:s}}else e=[i,n]}else e=[i,n]}else e[0]=0,e[1]=0;return this.setSoftDomainMinMax(e),this.expandDomain(e),this.includeZero(e),this.setDomainMinMax(e),e},t.prototype.expandDomain=function(t){if(this._expand){var e=t[0],i=kt(t);e===i&&(0===i?i=1:i>0?e=0:i<0&&(i=0)),N(this._expand.min)&&(t[0]=e-(i-e)*this._expand.min),N(this._expand.max)&&(t[t.length-1]=i+(i-e)*this._expand.max)}},t.prototype.niceDomain=function(t){var e=XX(this._spec),i=e.min,n=e.max;if(N(i)||N(n)||"linear"!==this._spec.type)return t;if(Math.abs(At(t)-St(t))<=1e-12){var r=t[0],a=r>=0?1:-1;if((r=Math.abs(r))<1)t[0]=0,t[t.length-1]=1;else{var o=r/5,s=Math.floor(Math.log(o)/Math.LN10),l=o/Math.pow(10,s);o=(l>=yK?10:l>=mK?5:l>=_K?2:1)*Math.pow(10,s),t[0]=0,t[t.length-1]=10*o}a<0&&(t.reverse(),t[0]*=-1,t[t.length-1]*=-1)}return t},t.prototype.includeZero=function(t){this._zero&&(t[0]=Math.min(t[0],0),t[t.length-1]=Math.max(kt(t),0))},t.prototype.setExtendDomain=function(t,e){if(void 0!==e){this._extend[t]=e;var i=this._scale.domain();if(this.extendDomain(i),this.includeZero(i),this.setDomainMinMax(i),this.niceDomain(i),this._scale.domain(i,this._nice),this._nice)!this.setScaleNice()&&this._scale.rescale();this.event.emit(cG.scaleUpdate,{model:this,value:"domain"})}else delete this._extend[t]},t.prototype.extendDomain=function(t){var e,i=t.length-1,n=t[0]-t[i]>0,r=n?i:0,a=n?0:i;for(var o in this._extend)(e=this._extend[o])>t[a]&&(t[a]=e),e<t[r]&&(t[r]=e)},t.prototype.getDomainSpec=function(){return this._domain},t.prototype.setDomainMinMax=function(t){if(this._domain){var e=this._domain,i=e.min,n=e.max;N(i)&&(t[0]=i),N(n)&&(t[t.length-1]=n)}},t.prototype.setSoftDomainMinMax=function(t){var e=this._spec,i=e.softMin,n=e.softMax;if(N(i)){var r=H(i)?i(t):i;j(r)&&(r=t[0]),r<=t[0]&&(t[0]=r,this._softMinValue=r)}if(N(n)){var a=H(n)?n(t):n;j(a)&&(a=kt(t)),a>=kt(t)&&(t[t.length-1]=a),this._softMaxValue=a}},t.prototype.setZero=function(t){this._zero!==t&&(this._zero=t,this.updateScaleDomain())},t.prototype.updateScaleDomain=function(){if(this.isSeriesDataEnable()){var t=this.collectData(),e=this.computeLinearDomain(t);this.updateScaleDomainByModel(e)}},t.prototype.updateScaleDomainByModel=function(t){(t=null!=t?t:this._scale.domain(),this.extendDomain(t),this.includeZero(t),this.setDomainMinMax(t),this.niceDomain(t),this._scale.domain(t,this._nice),this._nice)&&(!this.setScaleNice()&&this._scale.rescale());this._updateNiceLabelFormatter(t),this._domainAfterSpec=this._scale.domain(),this.event.emit(cG.scaleDomainUpdate,{model:this}),this.event.emit(cG.scaleUpdate,{model:this,value:"domain"})},t.prototype.getDomainAfterSpec=function(){return this._domainAfterSpec},t.prototype._updateNiceLabelFormatter=function(t){var e=Math.abs(kt(t)-t[0]),i=Math.max(-Math.floor(Math.log10(e)),0)+2,n=Math.pow(10,i);this.niceLabelFormatter=function(t){return Q(+t)?Math.round(+t*n)/n:t}},t}(),xK=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=B.cartesianLinearAxis,e._zero=!0,e._nice=!0,e._extend={},e._scale=new II,e}return S(e,t),e.prototype.setAttrFromSpec=function(){var e,i,n=this;t.prototype.setAttrFromSpec.call(this),this.setExtraAttrFromSpec();var r=null===(i=null===(e=this._tickData)||void 0===e?void 0:e[0])||void 0===i?void 0:i.getDataView().transformsArr.find((function(t){return t.type===n.registerTicksTransform()}));r&&(r.options=this._tickTransformOption())},e.prototype.initScales=function(){var e,i;t.prototype.initScales.call(this);var n=[0,1];N(null===(e=this._domain)||void 0===e?void 0:e.min)&&(n[0]=this._domain.min),N(null===(i=this._domain)||void 0===i?void 0:i.max)&&(n[1]=this._domain.max),this._scale.domain(n)},e.prototype._tickTransformOption=function(){var e,i=this;return A(A({},t.prototype._tickTransformOption.call(this)),{breakData:(null===(e=this._spec.breaks)||void 0===e?void 0:e.length)?function(){return i._break}:null})},e.prototype._getUpdateAttribute=function(e){var i,n,r=this,a=t.prototype._getUpdateAttribute.call(this,e);if(!TG(this._orient)&&(null===(n=null===(i=this._break)||void 0===i?void 0:i.breaks)||void 0===n?void 0:n.length)){var o=this.getLayoutRect(),s=o.width,l=o.height,u=MG(this._orient),c=u?s:l;a.breaks=this._break.breaks.map((function(t){var e,i=t.range,n=t.breakSymbol,a=t.gap,o=void 0===a?6:a,s=r.valueToPosition((i[0]+i[1])/2)/c;e=yF(o)?Number(o.substring(0,o.length-1))/100:o/c;var l=Q(null==n?void 0:n.angle)?n.angle:u?60:15;return{range:[s-e/2,s+e/2],breakSymbol:A(A({visible:!0},n),{angle:l*Math.PI/180}),rawRange:i}}))}return a},e.prototype.getNewScaleRange=function(){var e,i,n=t.prototype.getNewScaleRange.call(this);return(null===(e=this._spec.breaks)||void 0===e?void 0:e.length)&&(null===(i=this._break)||void 0===i?void 0:i.scope)&&(n=Lk(this._break.scope).map((function(t){return n[0]+(kt(n)-n[0])*t}))),n},e.prototype.computeDomain=function(t){return this.computeLinearDomain(t)},e.prototype.axisHelper=function(){var e=t.prototype.axisHelper.call(this);return e.setExtendDomain=this.setExtendDomain.bind(this),e.valueToPosition=this.valueToPosition.bind(this),e},e.prototype.registerTicksTransform=function(){var t="".concat(this.type,"-ticks");return qG(this._option.dataSet,t,GI),t},e.type=B.cartesianLinearAxis,e.specKey="axes",e}(hK);bt(xK,bK);var kK=function(){MV(),RV(),uK(),kz.registerComponent(xK.type,xK)},SK=function(){function t(){this._rawDomainIndex=[]}return t.prototype._initData=function(){var t;if(this._spec.showAllGroupLayers&&this._scales.length>1)for(var e=0;e<this._scales.length;e++){var i=(null!==(t=this._spec.layers)&&void 0!==t?t:[])[this._scales.length-1-e]||{};if(!1!==i.visible&&0!==i.tickCount&&0!==i.forceTickCount){(r=this._initTickDataSet(A(A({},this._tickTransformOption()),i),e)).target.addListener("change",this._forceLayout.bind(this));var n=new iY(this._option,r);this._tickData.push(n),this._tickDataMap||(this._tickDataMap={}),this._tickDataMap[e]=n}}else{var r;(r=this._initTickDataSet(this._tickTransformOption())).target.addListener("change",this._forceLayout.bind(this));n=new iY(this._option,r);this._tickData=[n],this._tickDataMap={0:n}}},t.prototype.dataToPosition=function(t,e){var i,n;if(void 0===e&&(e={}),0===t.length||0===this._scales.length)return 0;var r=this.getPosition(t);return r.position+r.bandScale.bandwidth()*(null!==(n=null!==(i=e.bandPosition)&&void 0!==i?i:this._spec.bandPosition)&&void 0!==n?n:this._defaultBandPosition)},t.prototype.valueToPosition=function(t){return this._scale.scale(t)},t.prototype.updateGroupScaleRange=function(){var t=this._scale;this._scales.forEach((function(e,i){i>0&&(e.range([0,t.bandwidth()]),t=e)}))},t.prototype.getPosition=function(t){var e=0,i=this._scale;if(1===this._scales.length||1===t.length)e=this.valueToPosition(t[0]);else{for(var n=Math.min(t.length,this._scales.length),r=0;r<n;r++)e+=this._scales[r].scale(t[r]);i=this._scales[n-1]}return{position:e,bandScale:i}},t.prototype.calcScales=function(t,e){for(var i,n,r=this._spec,a=r.bandPadding,o=r.paddingInner,s=r.paddingOuter,l=X(a),u=X(o),c=X(s),h=0;h<this._scales.length;h++){var d=l?a[h]:a,p=u?o[h]:o,f=c?s[h]:s;this._scales[h].paddingInner(null!==(i=null!=p?p:d)&&void 0!==i?i:t,!0).paddingOuter(null!==(n=null!=f?f:d)&&void 0!==n?n:e,!0)}},t.prototype.computeBandDomain=function(t){if(!t.length)return[];if(1===t.length)return t[0].values;for(var e=new Set,i=0;i<t.length;i++)for(var n=0;n<t[i].values.length;n++)e.add(t[i].values[n]);return Array.from(e)},t.prototype.updateScaleDomain=function(){var t,e=this;if(this.isSeriesDataEnable()){!(null===(t=this._rawDomainIndex)||void 0===t?void 0:t.length)&&this._scales.length&&this._updateRawDomain();for(var i=this._spec.domain,n=function(t){if(i&&i.length&&0===t)r._scales[t].domain(i);else{var n=r.collectData(t),a=r.computeBandDomain(n);r._scales[t].domain(a.sort((function(i,n){return e._rawDomainIndex[t][i]-e._rawDomainIndex[t][n]})))}},r=this,a=0;a<this._scales.length;a++)n(a);this.transformScaleDomain(),this.event.emit(cG.scaleDomainUpdate,{model:this}),this.event.emit(cG.scaleUpdate,{model:this,value:"domain"})}},t.prototype.getLabelItems=function(t){var e=this,i=[],n=[];return this._scales.forEach((function(r,a){var o,s=e._tickDataMap[a],l=null===(o=null==s?void 0:s.getLatestData())||void 0===o?void 0:o.length,u=l?s.getLatestData().map((function(t){return t.value})):r.domain();if(u&&u.length)if(n&&n.length){var c=[],h=[];n.forEach((function(i){u.forEach((function(n){var r=xt(i).concat(n);if(h.push(r),l){var a=QX(n,e._getNormalizedValue(r,t));c.push(a)}}))})),l&&i.push(c.filter((function(t){return t.value>=0&&t.value<=1}))),n=h}else u.forEach((function(t){n.push(t)})),l&&i.push(s.getLatestData().map((function(i){return QX(i.value,e._getNormalizedValue([i.value],t))})).filter((function(t){return t.value>=0&&t.value<=1})))})),i.reverse()},t.prototype._updateRawDomain=function(){var t=this;this._rawDomainIndex=[];for(var e=this._spec.domain,i=function(i){if(e&&e.length&&0===i)n._scales[i].domain(e);else{var r=n.collectData(i,!0),a=n.computeBandDomain(r);n._rawDomainIndex[i]={},a.forEach((function(e,n){return t._rawDomainIndex[i][e]=n}))}},n=this,r=0;r<this._scales.length;r++)i(r)},t.prototype._clearRawDomain=function(){this._rawDomainIndex=[]},t}(),AK=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=B.cartesianBandAxis,e._scale=new dI,e}return S(e,t),e.prototype.computeDomain=function(t){return this.computeBandDomain(t)},e.prototype.updateScaleRange=function(){var e=t.prototype.updateScaleRange.call(this);return this.updateGroupScaleRange(),e},e.prototype.initScales=function(){t.prototype.initScales.call(this),this.calcScales(this._defaultBandInnerPadding,this._defaultBandOuterPadding)},e.prototype.axisHelper=function(){var t=this,e=function(e){return void 0===e&&(e=0),t._scales[e]};return{isContinuous:!1,dataToPosition:this.dataToPosition.bind(this),getScale:e,getBandwidth:function(t){return void 0===t&&(t=0),e(t).bandwidth()},getAxisType:function(){return t.type},getAxisId:function(){return t.id},isInverse:function(){return t._inverse},getSpec:function(){return t._spec}}},e.prototype.registerTicksTransform=function(){var t="".concat(this.type,"-ticks");return qG(this._option.dataSet,t,qI),t},e.prototype.transformScaleDomain=function(){this.updateFixedWholeLength()},e.prototype.updateFixedWholeLength=function(){if(this._scale){var t=this._getOuterBandSizeFromSpec(),e=t.bandSize,i=t.maxBandSize,n=t.minBandSize;if(e&&this._scale.bandwidth(e),i&&this._scale.maxBandwidth(i),n&&this._scale.minBandwidth(n),this._scale.isBandwidthFixed()&&this._spec.autoRegionSize&&(e||i)){var r=nI(this._scale.domain().length,null!=e?e:i,this._scale.paddingInner(),this._scale.paddingOuter());["bottom","top"].includes(this._orient)?this._regions.forEach((function(t){return t.setMaxWidth(r)})):["left","right"].includes(this._orient)&&this._regions.forEach((function(t){return t.setMaxHeight(r)}))}}},e.prototype._getOuterBandSizeFromSpec=function(){var t,e=this,i=this._spec,n=i.bandSize,r=i.maxBandSize,a=i.minBandSize,o=i.bandSizeLevel,s=void 0===o?0:o,l=null!==(t=this._spec.bandSizeExtend)&&void 0!==t?t:{},u=l.gap,c=l.extend,h=void 0===c?0:c;s=Math.min(s,this._scales.length-1);for(var d=function(t){var i=p._scales[t],o=i.domain(),l=i.paddingInner(),c=i.paddingOuter(),d=function(i){var n=t===s?h:0;return j(u)||t<s?nI(o.length,i,l,c)+n:(i+(Y(u)?i*(Number(u.substring(0,u.length-1))/100):u))*o.length/(e._scales[t-1].paddingInner()+1)+n};N(n)&&(n=d(n)),N(r)&&(r=d(r)),N(a)&&(a=d(a))},p=this,f=s;f>0;f--)d(f);return{bandSize:n,maxBandSize:r,minBandSize:a}},e.type=B.cartesianBandAxis,e.specKey="axes",e}(hK);bt(AK,SK);var MK=function(){MV(),RV(),uK(),kz.registerComponent(AK.type,AK)},wK=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=B.cartesianTimeAxis,e._zero=!1,e.effect={scaleUpdate:function(t){e.computeData(null==t?void 0:t.value),XO(e._regions,(function(t){MG(e.getOrient())?$X(t.getXAxisHelper(),e.axisHelper(),N(e._seriesUserId)||N(e._seriesIndex))&&t.setXAxisHelper(e.axisHelper()):$X(t.getYAxisHelper(),e.axisHelper(),N(e._seriesUserId)||N(e._seriesIndex))&&t.setYAxisHelper(e.axisHelper())}),{userId:e._seriesUserId,specIndex:e._seriesIndex})}},e}return S(e,t),e.prototype.setAttrFromSpec=function(){var e;t.prototype.setAttrFromSpec.call(this),this._tick=xz({},this._spec.tick,null===(e=this._spec.layers)||void 0===e?void 0:e[0])},e.prototype._initData=function(){var e;if(t.prototype._initData.call(this),null===(e=this._spec.layers)||void 0===e?void 0:e[1]){var i=new Ms(this._option.dataSet,{name:"".concat(this.type,"_").concat(this.id,"_layer_1_ticks")}).parse(this._scale,{type:"scale"}).transform({type:"".concat(this.type,"-ticks"),options:A(A({},this._tickTransformOption()),{tickCount:this._spec.layers[1].tickCount,forceTickCount:this._spec.layers[1].forceTickCount,tickStep:this._spec.layers[1].tickStep})},!1);this._layerTickData=new iY(this._option,i)}},e.prototype.computeData=function(e){t.prototype.computeData.call(this,e),this._layerTickData&&(this._layerTickData.getDataView().reRunAllTransform(),this._layerTickData.updateData())},e.prototype._getLabelFormatMethod=function(){var t,e,i,n,r,a,o,s,l=this,u=Yi.getInstance(),c=(null===(e=null===(t=this._spec.layers)||void 0===t?void 0:t[1])||void 0===e?void 0:e.timeFormat)||"%Y%m%d",h="local"===((null===(n=null===(i=this._spec.layers)||void 0===i?void 0:i[1])||void 0===n?void 0:n.timeFormatMode)||"local")?u.timeFormat:u.timeUTCFormat,d=(null===(a=null===(r=this._spec.layers)||void 0===r?void 0:r[0])||void 0===a?void 0:a.timeFormat)||"%Y%m%d",p="local"===((null===(s=null===(o=this._spec.layers)||void 0===o?void 0:o[0])||void 0===s?void 0:s.timeFormatMode)||"local")?u.timeFormat:u.timeUTCFormat;return function(t,e,i,n,r){var a,o;return o=0===r?p(d,t):h(c,t),(null===(a=l._spec.label)||void 0===a?void 0:a.formatMethod)?l._spec.label.formatMethod(o,e):o}},e.prototype.getLabelItems=function(t){var e,i,n=this,r=[],a=null===(e=this.getTickData())||void 0===e?void 0:e.getLatestData();a&&a.length&&r.push(a.map((function(e){return QX(e.value,n._getNormalizedValue([e.value],t))})));var o=null===(i=this._layerTickData)||void 0===i?void 0:i.getLatestData();return o&&o.length&&r.push(o.map((function(e){return QX(e.value,n._getNormalizedValue([e.value],t))}))),r},e.prototype.registerTicksTransform=function(){var t="".concat(this.type,"-ticks");return qG(this._option.dataSet,t,GI),t},e.prototype.transformScaleDomain=function(){},e.type=B.cartesianTimeAxis,e.specKey="axes",e}(xK),TK=function(){MV(),RV(),uK(),kz.registerComponent(wK.type,wK)},CK=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=B.cartesianLogAxis,e._zero=!1,e._scale=new FI,e}return S(e,t),e.prototype.initScales=function(){var e;t.prototype.initScales.call(this),this._scale.base(null!==(e=this._spec.base)&&void 0!==e?e:10),this._scale.clamp(!0,null,!1)},e.prototype.registerTicksTransform=function(){var t="".concat(this.type,"-ticks");return qG(this._option.dataSet,t,GI),t},e.prototype.transformScaleDomain=function(){},e.type=B.cartesianLogAxis,e.specKey="axes",e}(xK);bt(CK,bK);var EK=function(){MV(),RV(),uK(),kz.registerComponent(CK.type,CK)},PK=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=B.cartesianSymlogAxis,e._zero=!1,e._scale=new jI,e}return S(e,t),e.prototype.initScales=function(){var e;t.prototype.initScales.call(this),this._scale.constant(null!==(e=this._spec.constant)&&void 0!==e?e:10)},e.prototype.registerTicksTransform=function(){var t="".concat(this.type,"-ticks");return qG(this._option.dataSet,t,GI),t},e.prototype.transformScaleDomain=function(){},e.type=B.cartesianSymlogAxis,e.specKey="axes",e}(xK);bt(PK,bK);var RK=function(){MV(),RV(),uK(),kz.registerComponent(PK.type,PK)},BK=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.line,i.transformerConstructor=DX,i._sortDataByAxis=!1,i}return S(i,e),i.prototype.compile=function(){e.prototype.compile.call(this),this.addSamplingCompile(),this.addOverlapCompile()},i.prototype.initMark=function(){var t,e={progressiveStep:this._spec.progressiveStep,progressiveThreshold:this._spec.progressiveThreshold,large:this._spec.large,largeThreshold:this._spec.largeThreshold},i=null!==(t=this._spec.seriesMark)&&void 0!==t?t:"line";this.initLineMark(e,"line"===i),this.initSymbolMark(e,"point"===i)},i.prototype.initTooltip=function(){e.prototype.initTooltip.call(this);var t=this._tooltipHelper.activeTriggerSet,i=t.group,n=t.mark;this._lineMark&&i.add(this._lineMark),this._symbolMark&&(n.add(this._symbolMark),i.add(this._symbolMark))},i.prototype.initMarkStyle=function(){this.initLineMarkStyle(this._direction),this.initSymbolMarkStyle()},i.prototype.initAnimation=function(){var t,e,i,n,r={direction:this.direction},a=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;if(this._lineMark.setAnimationConfig(cX(null===(i=kz.getAnimationInKey("line"))||void 0===i?void 0:i(r,a),hX("line",this._spec,this._markAttributeContext))),this._symbolMark){var o=xX(this);this._symbolMark.setAnimationConfig(cX(null===(n=kz.getAnimationInKey("scaleInOut"))||void 0===n?void 0:n(),hX("point",this._spec,this._markAttributeContext),o))}},i.prototype.onLayoutEnd=function(t){e.prototype.onLayoutEnd.call(this,t),this.reCompileSampling()},i.prototype.getSeriesStyle=function(t){var e,i=this,n="point"!==(null===(e=this._spec)||void 0===e?void 0:e.seriesMark);return function(e){var r,a;return n&&"fill"===e&&(e="stroke"),null!==(a=null===(r=i._seriesMark)||void 0===r?void 0:r.getAttribute(e,t))&&void 0!==a?a:void 0}},i.prototype.getDefaultShapeType=function(){return"circle"},i.prototype.getActiveMarks=function(){return[this._lineMark,this._symbolMark]},i.type=t.SeriesTypeEnum.line,i.mark=CX,i.transformerConstructor=DX,i}(SX);bt(BK,TX);var IK=function(){UV(),YV(),RX(),LX(),rX(),eX(),MK(),kK(),kz.registerSeries(BK.type,BK)},LK=function(){function t(t){this._dataArr=[],this._dataSet=t}return Object.defineProperty(t.prototype,"dataList",{get:function(){return this._dataArr},enumerable:!1,configurable:!0}),t.prototype.parseData=function(t){this._dataArr=[];for(var e=xt(t),i=0;i<e.length;i++)this._dataArr.push(lU(e[i],this._dataSet,this._dataArr))},t.prototype.updateData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!0);var n=xt(t);return(!e||n.length===this._dataArr.length)&&(this._dataValueForEach(n,(function(t,e){e.markRunning()})),this._dataValueForEach(n,(function(t,e){uU(e,t,i)})),!0)},t.prototype._dataValueForEach=function(t,e){var i=this;t.forEach((function(t,n){if(!(t instanceof Ms)){var r=i.getSeriesData(t.id,n);r&&e(t,r,n)}}))},t.prototype.getSeriesData=function(t,e){if(!this._dataArr.length)return null;if("string"==typeof t){var i=this._dataArr.filter((function(e){return e.name===t}));if(i[0])return i[0];Dk("no data matches dataId ".concat(t,"!"))}if("number"==typeof e){if(this._dataArr[e])return this._dataArr[e];Dk("no data matches dataIndex ".concat(e,"!"))}return this._dataArr[0]},t}(),DK=function(){function t(t,e){var i=this;this._scaleSpecMap=new Map,this._scaleMap=new Map,this._modelScaleSpecMap=new Map,this._markAttributeScaleMap=new Map,this._spec=null,this._chart=null,this.getStatisticalFields=function(t){var e=[];return i._scaleSpecMap.forEach((function(i,n){Yk(i.domain)&&i.domain.forEach((function(n){n.dataId===t&&n.fields.forEach((function(t){dH(e,[{key:t,operations:NB(i.type)?["max","min"]:["values"]}])}))}))})),i._markAttributeScaleMap.forEach((function(n,r){var a=i.getScale(r);n.forEach((function(n){i._getSeriesBySeriesId(n.seriesId).getRawData().name===t&&n.field&&dH(e,[{key:n.field,operations:NB(a.type)?["max","min"]:["values"]}])}))})),e},this._spec=t,this._chart=e,this._setAttrFromSpec()}return t.prototype._createFromSpec=function(t){if(!t.id)return null;var e=this._scaleMap.get(t.id);return e||(e="ordinal"===t.type&&"color"===t.id?pF("colorOrdinal"):pF(t.type)),e?(X(t.range)&&e.range(t.range),X(t.domain)&&(Yk(t.domain)||e.domain(t.domain)),t.specified&&e.specified&&e.specified(t.specified),t.clamp&&e.clamp&&e.clamp(t.clamp),e):null},t.prototype._setAttrFromSpec=function(){var t,e=this;if(null===(t=this._spec)||void 0===t?void 0:t.length){var i=new Map,n=new Map;this._spec.forEach((function(t){var r=e._createFromSpec(t);r&&(i.set(t.id,r),n.set(t.id,t))})),this._modelScaleSpecMap.forEach((function(t){var r=e._createFromSpec(t);r&&(i.set(t.id,r),n.set(t.id,t))})),this._scaleSpecMap=n,this._scaleMap=i}},t.prototype.updateSpec=function(t){var e={change:!1,reMake:!1,reRender:!1,reSize:!1,reCompile:!1};if(mt(t,this._spec))return e;e.change=!0;for(var i=function(i){var r=t[i],a=n._scaleMap.get(r.id);if(!a)return e.reMake=!0,{value:e};var o=n._spec.find((function(t){return t.id===r.id}));return o.id?o.type!==r.type?(e.reMake=!0,{value:e}):mt(o.specified,r.specified)?(r.range&&!mt(r.range,a.range())&&(a.range(r.range),e.reRender=!0),Yk(r.domain)?e.reRender=!0:mt(r.domain,a.domain())||(a.domain(r.domain),e.reRender=!0),void n._scaleSpecMap.set(r.id,r)):(e.reMake=!0,{value:e}):(e.reMake=!0,{value:e})},n=this,r=0;r<t.length;r++){var a=i(r);if("object"==typeof a)return a.value}return this._spec=t,e},t.prototype.registerModelScale=function(t){var e=this._createFromSpec(t);e&&(this._modelScaleSpecMap.set(t.id,t),this._scaleSpecMap.set(t.id,t),this._scaleMap.set(t.id,e))},t.prototype.removeModelScale=function(t){var e=this;this._modelScaleSpecMap.forEach((function(i){t(i)&&(e._modelScaleSpecMap.delete(i.id),e._scaleSpecMap.delete(i.id),e._scaleMap.delete(i.id))}))},t.prototype.getScale=function(t){return this._scaleMap.get(t)},t.prototype.getScaleSpec=function(t){return this._scaleSpecMap.get(t)},t.prototype._getSeriesByRawDataId=function(t){for(var e=this._chart.getAllSeries(),i=0;i<e.length;i++){var n=e[i];if(n.getRawData().name===t)return n}return null},t.prototype._getSeriesBySeriesId=function(t){for(var e=this._chart.getAllSeries(),i=0;i<e.length;i++){var n=e[i];if(n.id===t)return n}return null},t.prototype.updateScaleDomain=function(t){var e=this;this._scaleSpecMap.forEach((function(i,n){var r=e._scaleMap.get(n);if(r){if(!Yk(i.domain))return i.domain&&0!==i.domain.length||r.domain(t),void e._updateMarkScale(n,r,r.domain().slice());var a;a=NB(i.type)?[null,null]:new Set,i.domain.forEach((function(t){var n=e._getSeriesByRawDataId(t.dataId);if(n){var r=NB(i.type);t.fields.forEach((function(t){var e=n.getRawDataStatisticsByField(t,r);e&&(r?(j(a[0])?a[0]=e.min:a[0]=Math.min(e.min,a[0]),j(a[1])?a[1]=e.max:a[1]=Math.max(e.max,a[1])):e.values.forEach((function(t){a.add(t)})))}))}}));var o=a;NB(i.type)||(a=Array.from(a)),r.domain(a),e._updateMarkScale(n,r,o)}}))},t.prototype._updateMarkScale=function(t,e,i){var n=this,r=this._markAttributeScaleMap.get(t);r&&0!==r.length&&r.forEach((function(t){if(t.field&&t.markScale&&t.markScale!==e)if(j(t.changeDomain)||"none"===t.changeDomain||j(t.seriesId))NB(e.type)?t.markScale.domain(i):e.domain(Array.from(i));else{var r=n._getSeriesBySeriesId(t.seriesId),a=NB(e.type),o=r.getRawDataStatisticsByField(t.field,a);if(!ot(o))return"expand"===t.changeDomain?(a?(i[0]=Math.min(i[0],o.min),i[1]=Math.max(i[1],o.max)):(o.values.forEach((function(t){i.add(t)})),i=Array.from(i)),void t.markScale.domain(i)):void("replace"!==t.changeDomain||(a?t.markScale.domain([o.min,o.max]):t.markScale.domain(o.values)));NB(e.type)?t.markScale.domain(i):e.domain(Array.from(i))}}))},t.prototype.registerMarkAttributeScale=function(t,e){var i=this._scaleMap.get(t.scale),n=this._markAttributeScaleMap.get(t.scale);n||(n=[],this._markAttributeScaleMap.set(t.scale,n));var r=i;return(j(t.field)||!j(t.changeDomain)&&"none"!==t.changeDomain&&!j(e))&&(r=i.clone()),n.push(A(A({},t),{seriesId:e,markScale:r})),r},t}(),OK=function(e){function i(t,i){var n,r,a,o=this;return(o=e.call(this,i)||this).type="chart",o.id=Gk(),o._regions=[],o._series=[],o._components=[],o._layoutRect={x:0,y:0,width:IF,height:LF},o._viewRect={width:IF,height:LF},o._viewBox={x1:0,y1:0,x2:IF,y2:LF},o._layoutTag=!0,o._idMap=new Map,o.state={layoutUpdateRank:1},o.padding={top:0,left:0,right:0,bottom:0},o.getAllSeries=function(){var t;return null!==(t=o._series)&&void 0!==t?t:[]},o.getRegionsInIndex=function(t){return t&&0!==t.length?o._regions.filter((function(e,i){return t.includes(i)})):[o._regions[0]]},o.getAllRegions=function(){return o._regions},o.getRegionsInIds=function(t){return t?o._regions.filter((function(e){return t.includes(e.id)})):[]},o.getRegionsInQuerier=function(t){return t?o._regions.filter((function(e,i){return xt(t).some((function(t){return N(t.regionId)&&t.regionId===e.userId||t.regionIndex===i}))})):o._regions},o.getRegionsInUserId=function(t){if(t)return o._regions.find((function(e){return e.userId===t}))},o.getRegionsInUserIdOrIndex=function(t,e){return o.getAllRegions().filter((function(i){return(null==t?void 0:t.length)?i.userId&&t.includes(i.userId):!(null==e?void 0:e.length)||e.includes(i.getSpecIndex())}))},o.getComponents=function(){return o._components},o.getSeriesInIndex=function(t){return t&&0!==t.length?o._series.filter((function(e,i){return t.includes(i)})):[o._series[0]]},o.getSeriesInIds=function(t){return t?o._series.filter((function(e){return t.includes(e.id)})):[]},o.getSeriesInUserId=function(t){if(t)return o._series.find((function(e){return e.userId===t}))},o.getSeriesInUserIdOrIndex=function(t,e){return o.getAllSeries().filter((function(i){return(null==t?void 0:t.length)?i.userId&&t.includes(i.userId):!(null==e?void 0:e.length)||e.includes(i.getSpecIndex())}))},o.getComponentByIndex=function(t,e){var i=o._components.filter((function(e){return(e.specKey||e.type)===t}));if(i&&0!==i.length)return i[e]},o.getComponentsByKey=function(t){return o._components.filter((function(e){return(e.specKey||e.type)===t}))},o.getComponentByUserId=function(t){var e=o._components.find((function(e){return e.userId===t}));if(e)return e},o.getComponentsByType=function(t){return o._components.filter((function(e){return e.type===t}))},o._paddingSpec=bF(null!==(n=t.padding)&&void 0!==n?n:i.getTheme().padding),o._event=new UG(i.eventDispatcher,i.mode),o._dataSet=i.dataSet,o._chartData=new LK(o._dataSet),o._modelOption=A(A({},i),{mode:o._option.mode,map:o._idMap,getChartLayoutRect:function(){return o._layoutRect},getChartViewRect:function(){return o._viewRect},getChart:function(){return o},globalScale:o._globalScale,onError:null===(r=o._option)||void 0===r?void 0:r.onError,disableTriggerEvent:!0===(null===(a=o._option)||void 0===a?void 0:a.disableTriggerEvent),getSeriesData:o._chartData.getSeriesData.bind(o._chartData)}),o._spec=t,o}return S(i,e),i.prototype.getSpec=function(){return this._spec},i.prototype.setSpec=function(t){this._spec=t},i.prototype.getOption=function(){return this._option},i.prototype.getLayoutRect=function(){return this._layoutRect},i.prototype.getViewRect=function(){return this._viewRect},i.prototype.getLayoutTag=function(){return this._layoutTag},i.prototype.setLayoutTag=function(t,e,i){void 0===i&&(i=!0),this._layoutTag=t;var n=this.getCompiler();return(null==n?void 0:n.getVGrammarView())&&(n.getVGrammarView().updateLayoutTag(),t&&i&&n.renderNextTick(e)),this._layoutTag},i.prototype.getGlobalScale=function(){return this._globalScale},i.prototype.getEvent=function(){return this._event},Object.defineProperty(i.prototype,"chartData",{get:function(){return this._chartData},enumerable:!1,configurable:!0}),i.prototype.created=function(t){this._chartData.parseData(this._spec.data),this._createGlobalScale(),this._createBackground(),this._createLayout(),t.forEachRegionInSpec(this._spec,this._createRegion.bind(this)),t.forEachSeriesInSpec(this._spec,this._createSeries.bind(this)),t.forEachComponentInSpec(this._spec,this._createComponent.bind(this),this._option.getSpecInfo())},i.prototype.init=function(){var t,e,i=this;null===(t=this._beforeInit)||void 0===t||t.call(this),this._regions.forEach((function(t){return t.init({})})),this._series.forEach((function(t){return t.init({})})),this._components.forEach((function(t){return t.init({dataSet:i._dataSet})})),this._initEvent(),null===(e=this._initStack)||void 0===e||e.call(this),this.reDataFlow()},i.prototype.reDataFlow=function(){this._series.forEach((function(t){var e;return null===(e=t.getRawData())||void 0===e?void 0:e.markRunning()})),this._series.forEach((function(t){return t.fillData()})),this.updateGlobalScaleDomain()},i.prototype.onResize=function(t,e,i){void 0===i&&(i=!0);var n={width:t,height:e};this._canvasRect=n,this._updateLayoutRect(this._option.viewBox),this.setLayoutTag(!0,null,i)},i.prototype.updateViewBox=function(t,e){this._option.viewBox=t,this._updateLayoutRect(t),this.setLayoutTag(!0,null,e)},i.prototype._createBackground=function(){var t=this,e=this._spec.background;if(e&&"object"==typeof e&&!N(e.gradient)){var i=vt(e,["x","y","width","height","x1","y1","image"]);i.background=e.image,this._backgroundMark=kz.createMark("group","chart-background",{model:this,map:this._option.map,getCompiler:this.getCompiler,globalScale:this._globalScale}),this._backgroundMark.created(),this._backgroundMark.setStyle(A(A({},i),{x:function(){return t._viewBox.x1},y:function(){return t._viewBox.y1},width:function(){return t._viewBox.x2-t._viewBox.x1},height:function(){return t._viewBox.y2-t._viewBox.y1}})),this._backgroundMark.setMarkConfig({zIndex:wU.SeriesGroup-2})}},i.prototype._createRegion=function(t,e){if(t){var i=e.spec,n=M(e,["spec"]),r=new t(i,A(A({},this._modelOption),n));r&&(r.created(),this._regions.push(r))}},i.prototype._createSeries=function(t,e){if(t){var i,n=e.spec,r=M(e,["spec"]);if(N(n.regionId)?i=this.getRegionsInUserId(n.regionId):N(n.regionIndex)&&(i=this.getRegionsInIndex([n.regionIndex])[0]),i||(i=this._regions[0])){var a=new t(n,A(A(A({},this._modelOption),r),{type:n.type,region:i,globalScale:this._globalScale,sourceDataList:this._chartData.dataList}));a&&(a.created(),this._series.push(a),i.addSeries(a))}}},i.prototype.getSeriesById=function(t){return this._series.find((function(e){return e.id===t}))},i.prototype._createComponent=function(t,e){var i=t.createComponent(e,A(A({},this._modelOption),{type:t.type,getAllRegions:this.getAllRegions,getRegionsInIndex:this.getRegionsInIndex,getRegionsInIds:this.getRegionsInIds,getRegionsInUserIdOrIndex:this.getRegionsInUserIdOrIndex,getAllSeries:this.getAllSeries,getSeriesInIndex:this.getSeriesInIndex,getSeriesInIds:this.getSeriesInIds,getSeriesInUserIdOrIndex:this.getSeriesInUserIdOrIndex,getAllComponents:this.getComponents,getComponentByIndex:this.getComponentByIndex,getComponentByUserId:this.getComponentByUserId,getComponentsByKey:this.getComponentsByKey,getComponentsByType:this.getComponentsByType}));i&&(i.created(),this._components.push(i))},i.prototype.getAllComponents=function(){return this._components},i.prototype.getAllModels=function(){return[].concat(this.getAllSeries(),this.getAllComponents(),this.getAllRegions())},i.prototype.getModelInFilter=function(t){if(Y(t))return this.getAllModels().find((function(e){return e.userId===t}));if(H(t))return this.getAllModels().find((function(e){return t(e)}));var e=0;return this.getAllModels().find((function(i){var n;if((null!==(n=i.specKey)&&void 0!==n?n:i.type)===t.type){if(e===t.index)return!0;e++}return!1}))},i.prototype._createLayout=function(){this._updateLayoutRect(this._option.viewBox),this._initLayoutFunc()},i.prototype.setLayout=function(t){this._option.layout=t,this._initLayoutFunc()},i.prototype._initLayoutFunc=function(){var t,e,i;if(this._layoutFunc=this._option.layout,!this._layoutFunc){var n=!1;(this._spec.zField||this._spec.series&&this._spec.series.some((function(t){return t.zField})))&&(n=!0);var r=kz.getLayoutInKey(null!==(e=null===(t=this._spec.layout)||void 0===t?void 0:t.type)&&void 0!==e?e:n?"layout3d":"base");if(r){var a=new r(this._spec.layout,{onError:null===(i=this._option)||void 0===i?void 0:i.onError});this._layoutFunc=a.layoutItems.bind(a)}}},i.prototype.layout=function(t){var e,i,n,r;if(null===(i=null===(e=this._option.performanceHook)||void 0===e?void 0:e.beforeLayoutWithSceneGraph)||void 0===i||i.call(e),this.getLayoutTag()){this._event.emit(cG.layoutStart,{chart:this,vchart:this._option.globalInstance}),this.onLayoutStart(t);var a=this.getLayoutElements();this._layoutFunc(this,a,this._layoutRect,this._viewBox),this._event.emit(cG.afterLayout,{elements:a,chart:this}),this.setLayoutTag(!1),this.onLayoutEnd(t),this._event.emit(cG.layoutEnd,{chart:this,vchart:this._option.globalInstance})}null===(r=null===(n=this._option.performanceHook)||void 0===n?void 0:n.afterLayoutWithSceneGraph)||void 0===r||r.call(n)},i.prototype.onLayoutStart=function(t){var e=this;this.getAllModels().forEach((function(i){return i.onLayoutStart(e._layoutRect,e._viewRect,t)}))},i.prototype.onLayoutEnd=function(t){this.getAllModels().forEach((function(e){"series"!==e.modelType&&e.onLayoutEnd(t)}))},i.prototype.onEvaluateEnd=function(t){P(P(P([],E(this._components),!1),E(this._regions),!1),E(this._series),!1).forEach((function(e){return e.onEvaluateEnd(t)}))},i.prototype.getLayoutElements=function(){return this.getAllModels().map((function(t){return t.layout})).filter((function(t){return!!t}))},i.prototype.getModelById=function(t){var e=this._idMap.get(t);if(e&&e instanceof FU)return e},i.prototype.getModelByUserId=function(t){var e=this.getSeriesInUserId(t);if(e)return e;var i=this.getRegionsInUserId(t);if(i)return i;var n=this.getComponentByUserId(t);return n||void 0},i.prototype.getAllMarks=function(){return Array.from(this._idMap.values()).filter((function(t){return t&&t instanceof aY}))},i.prototype.getMarkById=function(t){var e=this._idMap.get(t);if(e&&e instanceof aY)return e},i.prototype.getMarkByUserName=function(t){return this.getAllMarks().filter((function(e){return e.name&&e.name===t}))},i.prototype.updateData=function(t,e,i,n){void 0===i&&(i=!0);var r=this._dataSet.getDataView(t);r&&(r.markRunning(),r.parseNewData(e,n)),i&&this.updateGlobalScaleDomain(),this.getAllModels().forEach((function(t){return t.onDataUpdate()}))},i.prototype.updateFullData=function(t,e){var i=this;void 0===e&&(e=!0),xt(t).forEach((function(t){var e=i._dataSet.getDataView(t.id);e&&e.markRunning()})),xt(t).forEach((function(t){var e=i._dataSet.getDataView(t.id);e&&uU(e,t,!0)})),e&&this.updateGlobalScaleDomain(),this.getAllModels().forEach((function(t){return t.onDataUpdate()}))},i.prototype.onRender=function(t){},i.prototype.setCanvasRect=function(t,e){this._canvasRect={width:t,height:e}},i.prototype.getCanvasRect=function(){return this._canvasRect||(this._canvasRect=yU(this._spec,this._option,{width:IF,height:LF})),this._canvasRect},i.prototype.getSeriesData=function(t,e){return this._chartData.getSeriesData(t,e)},i.prototype._transformSpecScale=function(){var t,e=this._spec.scales?P([],E(this._spec.scales),!1):[],i=e.find((function(t){return"color"===t.id})),n=this.getColorScheme();if(!i&&(i={type:"ordinal",id:"color",domain:null,range:null},e.push(i),this._spec.color)){var r=this._spec.color;if(X(r))i.range=r;else{var a=r;Object.prototype.hasOwnProperty.call(a,"type")&&(i.type=a.type),Object.prototype.hasOwnProperty.call(a,"domain")&&(i.domain=a.domain),Object.prototype.hasOwnProperty.call(a,"range")&&(i.range=a.range),Object.prototype.hasOwnProperty.call(a,"specified")&&(i.specified=a.specified),Object.prototype.hasOwnProperty.call(a,"clamp")&&(i.clamp=a.clamp)}}return(null===(t=i.range)||void 0===t?void 0:t.length)||(i.range=nF(n),i.rangeTheme=!0),e},i.prototype._createGlobalScale=function(){this._globalScale=new DK(this._transformSpecScale(),this),this._modelOption.globalScale=this._globalScale},i.prototype.updateGlobalScaleDomain=function(){var t=new Set;this._series.forEach((function(e){var i=e.getSeriesKeys();i&&i.forEach((function(e){return t.add(e)}))}));var e=Array.from(t);this._globalScale.updateScaleDomain(e)},i.prototype.updateGlobalScale=function(t){mU(t,this._globalScale.updateSpec(this._transformSpecScale()))},i.prototype.updateGlobalScaleTheme=function(){var t=this._globalScale.getScaleSpec("color"),e=this.getColorScheme();t.rangeTheme&&(t.range=nF(e),this._globalScale.getScale("color").range(t.range))},i.prototype._getSpecKeys=function(t){var e={width:!0,height:!0};return Object.keys(t).filter((function(t){return!e[t]})).sort()},i.prototype.updateSpec=function(t){var e={change:!1,reMake:!1,reRender:!1,reSize:!1,reCompile:!1};if(this.setLayoutTag(!0,null,!1),t.type!==this.type)return e.reMake=!0,e;var i=this._getSpecKeys(this._spec);if(!mt(i,this._getSpecKeys(t)))return e.reMake=!0,e;for(var n=0;n<i.length;n++){var r=i[n];if(X(this._spec[r])&&this._spec[r].length!==xt(t[r]).length)return e.reMake=!0,e}var a=this._spec;return this._spec=t,this.updateChartConfig(e,a),e.reMake?e:(this.updateGlobalScale(e),e.reMake?e:(this.updateRegionSpec(e),e.reMake?e:(this.updateComponentSpec(e),e.reMake?e:(this.updateSeriesSpec(e),e.reMake||(this.reInit(),this.updateDataSpec(),this.updateGlobalScaleDomain()),e))))},i.prototype.updateChartConfig=function(t,e){var i,n;this._paddingSpec=bF(null!==(i=this._spec.padding)&&void 0!==i?i:null===(n=this._option)||void 0===n?void 0:n.getTheme().padding),this._updateLayoutRect(this._viewBox)},i.prototype.updateDataSpec=function(){this._spec.data&&this._chartData.updateData(this._spec.data,!1,!0)},i.prototype.updateRegionSpec=function(t){var e,i=this;(null===(e=this._spec)||void 0===e?void 0:e.region)&&(this._spec.region.length===this._regions.length?this._regions.forEach((function(e){mU(t,e.updateSpec(i._spec.region[e.getSpecIndex()]))})):t.reMake=!0)},i.prototype.updateComponentSpec=function(t){var e,i=this,n={},r=((e={})[B.title]=!0,e[B.brush]=!0,e[B.mapLabel]=!0,e[B.indicator]=!0,e);for(var a in this._components.forEach((function(e){var a,o;if(e.type!==B.label&&e.type!==B.totalLabel){r[e.type]&&(r[e.type]=!1);var s=e.specKey||e.type,l=null!==(a=i._spec[s])&&void 0!==a?a:{};X(l)?(n[s]=n[s]||{specCount:l.length,componentCount:0},n[s].componentCount++,mU(t,e.updateSpec(null!==(o=l[e.getSpecIndex()])&&void 0!==o?o:{},l))):mU(t,e.updateSpec(l))}})),n)if(Object.prototype.hasOwnProperty.call(n,a)){var o=n[a];o.componentCount!==o.specCount&&(t.reMake=!0)}var s=function(t){return t&&!1!==t.visible};Object.keys(r).forEach((function(e){if(r[e]){var n=i._spec[e];(X(n)?n.some(s):s(n))&&(t.reMake=!0)}}))},i.prototype.updateSeriesSpec=function(t){var e=this;this._spec.series.length===this._series.length?this._series.forEach((function(i){var n=e._spec.series[i.getSpecIndex()];mU(t,i.updateSpec(n))})):t.reMake=!0},i.prototype.getCanvas=function(){var t,e;return null!==(e=null===(t=this.getCompiler())||void 0===t?void 0:t.getCanvas())&&void 0!==e?e:null},i.prototype._updateLayoutRect=function(t){var e=this.getCanvasRect();if(t){this._viewBox=t;var i=t.x1,n=void 0===i?0:i,r=t.y1,a=void 0===r?0:r;e={width:t.x2-n,height:t.y2-a}}else this._viewBox={x1:0,y1:0,x2:e.width,y2:e.height};this._viewRect=e,this.padding=_F(this._paddingSpec,e,e),this._layoutRect.width=e.width-this.padding.left-this.padding.right,this._layoutRect.height=e.height-this.padding.top-this.padding.bottom,this._layoutRect.x=this.padding.left,this._layoutRect.y=this.padding.top,this._event.emit(cG.layoutRectUpdate,{chart:this})},i.prototype.setCurrentTheme=function(){this.updateChartConfig({change:!0,reMake:!1},this._spec),this.setLayoutTag(!0,null,!1),this.updateGlobalScaleTheme(),this.reInit()},i.prototype.reInit=function(){P(P(P([],E(this._regions),!1),E(this._series),!1),E(this._components),!1).forEach((function(t){var e=t.getSpecInfo();e&&e.spec&&t.reInit(e.spec)}))},i.prototype.clear=function(){this.getAllModels().forEach((function(t){var e;return null===(e=t.clear)||void 0===e?void 0:e.call(t)}))},i.prototype.compile=function(){this.compileBackground(),this.compileLayout(),this.compileRegions(),this.compileSeries(),this.compileComponents()},i.prototype.afterCompile=function(){this.getAllRegions().forEach((function(t){var e;null===(e=t.afterCompile)||void 0===e||e.call(t)})),this.getAllSeries().forEach((function(t){var e;null===(e=t.afterCompile)||void 0===e||e.call(t)})),this.getAllComponents().forEach((function(t){var e;null===(e=t.afterCompile)||void 0===e||e.call(t)}))},i.prototype.compileLayout=function(){var t=this.getCanvasRect(),e=t.width,i=t.height;this.getCompiler().setSize(e,i)},i.prototype.compileBackground=function(){var t;this._backgroundMark&&(this._backgroundMark.compile({context:{model:this}}),null===(t=this._backgroundMark.getProduct())||void 0===t||t.layout((function(){})))},i.prototype.compileRegions=function(){var t,e,i,n;null===(e=null===(t=this._option.performanceHook)||void 0===t?void 0:t.beforeRegionCompile)||void 0===e||e.call(t),this.getAllRegions().forEach((function(t){t.compile()})),null===(n=null===(i=this._option.performanceHook)||void 0===i?void 0:i.afterRegionCompile)||void 0===n||n.call(i)},i.prototype.compileSeries=function(){var t,e,i,n;null===(e=null===(t=this._option.performanceHook)||void 0===t?void 0:t.beforeSeriesCompile)||void 0===e||e.call(t),this.getAllSeries().forEach((function(t){t.compile()})),null===(n=null===(i=this._option.performanceHook)||void 0===i?void 0:i.afterSeriesCompile)||void 0===n||n.call(i)},i.prototype.compileComponents=function(){var t,e,i,n;null===(e=null===(t=this._option.performanceHook)||void 0===t?void 0:t.beforeComponentCompile)||void 0===e||e.call(t),this.getAllComponents().forEach((function(t){t.compile()})),null===(n=null===(i=this._option.performanceHook)||void 0===i?void 0:i.afterComponentCompile)||void 0===n||n.call(i)},i.prototype.release=function(){P(P(P([],E(this._components),!1),E(this._regions),!1),E(this._series),!1).forEach((function(t){t.beforeRelease()})),e.prototype.release.call(this),this.clear(),P(P(P([],E(this._components),!1),E(this._regions),!1),E(this._series),!1).forEach((function(t){t.release()})),this._components=this._regions=this._series=[],this._spec={},this._dataSet=this._globalScale=this._layoutFunc=null,this._layoutTag=!1,this._idMap.clear()},i.prototype.onLayout=function(t){var e=t.rootMark;this.layout({group:e,srView:t})},i.prototype.updateState=function(t,e){var i=this.getAllSeries(),n=function(n){if(ot(t[n]))return"continue";var r=t[n],a={stateValue:n};a=H(r.filter)?A({filter:r.filter},a):A(A({},r.filter),a),r.level&&(a.level=r.level),i.forEach((function(t){t.getMarks().forEach((function(i){i.stateStyle[n]&&(e&&!e(t,i,n)||(i.state.changeStateInfo(a),i.updateMarkState(n)))}))}))};for(var r in t)n(r)},i.prototype.setSelected=function(t,e,i){this._setStateInDatum(hU.STATE_SELECTED,!0,t,e,i)},i.prototype.setHovered=function(t,e,i){this._setStateInDatum(hU.STATE_HOVER,!0,t,e,i)},i.prototype.clearState=function(t){this.getAllRegions().forEach((function(e){e.interaction.clearEventElement(t,!0),e.interaction.resetInteraction(t,null)}))},i.prototype.clearAllStates=function(){this.getAllRegions().forEach((function(t){t.interaction.clearAllEventElement(),t.interaction.resetAllInteraction()}))},i.prototype.clearSelected=function(){this.clearState(hU.STATE_SELECTED)},i.prototype.clearHovered=function(){this.clearState(hU.STATE_HOVER)},i.prototype._initEvent=function(){var t=this;[cG.dataZoomChange,cG.scrollBarChange].forEach((function(e){t._event.on(e,(function(e){e.value,t._disableMarkAnimation(["exit","update"]);var i=function(){t._enableMarkAnimation(["exit","update"]),t._event.off(DH.AFTER_MARK_RENDER_END,i)};t._event.on(DH.AFTER_MARK_RENDER_END,i)}))}))},i.prototype._enableMarkAnimation=function(t){this.getAllMarks().forEach((function(e){var i=e.getProduct();i&&i.animate&&i.animate.enableAnimationState(t)}))},i.prototype._disableMarkAnimation=function(t){this.getAllMarks().forEach((function(e){var i=e.getProduct();i&&i.animate&&i.animate.disableAnimationState(t)}))},i.prototype.filterGraphicsByDatum=function(t,e){var i;void 0===e&&(e={});var n=(t=t?xt(t):null)?Object.keys(t[0]):null,r=[],a=null!==(i=e.getDatum)&&void 0!==i?i:function(t){return t.getDatum()};return this.getRegionsInQuerier(e.region).forEach((function(i){var o=[];t&&i.getSeries().forEach((function(s){s.getMarks().forEach((function(l){if(l.getProduct()&&(!e.filter||H(e.filter)&&e.filter(s,l))){var u=l.getProduct().isCollectionMark(),c=l.getProduct().elements;if(u)c.filter((function(u){var c=a(u,l,s,i),h=c&&t.every((function(t,e){return n.every((function(i){return t[i]==c[e][i]}))}));h&&(o.push(u),r.push(u),e.callback&&e.callback(u,l,s,i))}));else if(t.length>1){var h=t.slice();c.forEach((function(t){var u=a(t,l,s,i),c=u&&h.findIndex((function(t){return n.every((function(e){return t[e]==u[e]}))}));c>=0&&(h.splice(c,1),o.push(t),r.push(t),e.callback&&e.callback(t,l,s,i))}))}else{var d=c.find((function(e){var r=a(e,l,s,i);return r&&n.every((function(e){return t[0][e]==r[e]}))}));d&&(o.push(d),r.push(d),e.callback&&e.callback(d,l,s,i))}}}))})),e.regionCallback&&e.regionCallback(o,i)})),r},i.prototype._setStateInDatum=function(t,e,i,n,r){this.filterGraphicsByDatum(i,{filter:n,region:r,regionCallback:function(n,r){i?n.length&&(n.forEach((function(e){r.interaction.startInteraction(t,e)})),e&&r.interaction.reverseEventElement(t)):r.interaction.clearEventElement(t,!0)}})},i.prototype.setDimensionIndex=function(e,i){var n,r,a=null;Array.from(this._event.getComposedEventMap().values()).forEach((function(n){var r=n.eventType,o=n.event;if(r===t.DimensionEventEnum.dimensionHover||r===t.DimensionEventEnum.dimensionClick){var s=o.dispatch(e,i);(null==s?void 0:s.length)&&(a=s)}}));var o=j(e)||!a||a.every((function(t){return WB(t.axis.getScale().type)&&j(t.index)}));if(!1!==i.tooltip){var s=this.getComponentsByType(B.tooltip)[0];if(null==s?void 0:s.getVisible())if(o)null===(r=(n=s).hideTooltip)||void 0===r||r.call(n);else{var l={};a.forEach((function(t){var e=t.axis,i=t.value,n=t.data,r="left"===e.getOrient()||"right"===e.getOrient();n.forEach((function(t){var e,n,a,o=r?t.series.fieldY[0]:t.series.fieldX[0];l[o]=null!==(a=null===(n=null===(e=t.datum)||void 0===e?void 0:e[0])||void 0===n?void 0:n[o])&&void 0!==a?a:i}))})),s.showTooltip(l,i.showTooltipOption)}}if(!1!==i.crosshair){var u=this.getComponentsByType(B.cartesianCrosshair)[0];u&&u.clearAxisValue&&u.setAxisValue&&(o?u.hideCrosshair():u.showCrosshair(a))}},i.prototype.getColorScheme=function(){var t,e;return null===(e=(t=this._option).getTheme)||void 0===e?void 0:e.call(t).colorScheme},i}(PU),FK=function(t,e){var i,n=t.spec,r=n.regionId,a=n.regionIndex;if(N(r)){var o=xt(r);return null===(i=e.region)||void 0===i?void 0:i.filter((function(t){var e=t.spec;return o.includes(e.id)}))}if(N(a))return xt(a).map((function(t){var i;return null===(i=e.region)||void 0===i?void 0:i[t]})).filter(N)},zK=function(){function t(t){this._option=t,this.type=t.type,this.seriesType=t.seriesType}return t.prototype.initChartSpec=function(t){return this.transformSpec(t),this.transformModelSpec(t)},t.prototype.transformSpec=function(t){t.region&&0!==t.region.length||(t.region=[{}]),void 0===t.tooltip&&(t.tooltip={}),N(t.stackInverse)&&t.region.forEach((function(e){!N(e.stackInverse)&&(e.stackInverse=t.stackInverse)})),N(t.stackSort)&&t.region.forEach((function(e){!N(e.stackSort)&&(e.stackSort=t.stackSort)}))},t.prototype.generateTransform=function(t,e){var i=this;return function(n,r,a){var o=r.spec,s=r.specPath,l=r.specInfoPath,u=r.type,c=new n.transformerConstructor(A(A({},i._option),{type:u})),h=c.transformSpec(o,t,a),d=A(A({},r),h);e?d.theme=c.getTheme(o,t):mz(t,s,h.spec),mz(a,null!=l?l:s,d)}},t.prototype.transformModelSpec=function(t){return this.createSpecInfo(t,this.generateTransform(t,!1))},t.prototype.createSpecInfo=function(t,e){var i,n;e||(e=this.generateTransform(t,!0));var r={};return this.forEachRegionInSpec(t,e,r),this.forEachSeriesInSpec(t,e,r),null===(i=r.series)||void 0===i||i.forEach((function(t,e){var i,n,a=(null!==(n=null!==(i=FK(t,r))&&void 0!==i?i:r.region)&&void 0!==n?n:[])[0];a&&(a.seriesIndexes||(a.seriesIndexes=[]),a.seriesIndexes.push(e),t.regionIndexes=a.regionIndexes.slice())})),this.forEachComponentInSpec(t,e,r),Object.values(null!==(n=r.component)&&void 0!==n?n:{}).forEach((function(t){return t.forEach((function(t,e){var i,n,a;if(t){if(!t.regionIndexes){var o=null!==(n=null!==(i=FK(t,r))&&void 0!==i?i:r.region)&&void 0!==n?n:[];t.regionIndexes=o.map((function(t){return t.regionIndexes[0]}))}if(!t.seriesIndexes){var s=function(t,e){var i,n=t.spec,r=n.seriesId,a=n.seriesIndex;if(N(r)){var o=xt(r);return null===(i=e.series)||void 0===i?void 0:i.filter((function(t){var e=t.spec;return o.includes(e.id)}))}if(N(a))return xt(a).map((function(t){var i;return null===(i=e.series)||void 0===i?void 0:i[t]})).filter(N)}(t,r);if(s)t.seriesIndexes=s.map((function(t){return t.seriesIndexes[0]}));else{var l=new Set;(null!==(a=t.regionIndexes)&&void 0!==a?a:[]).forEach((function(t){var e,i,n=null===(e=r.region)||void 0===e?void 0:e[t];null===(i=null==n?void 0:n.seriesIndexes)||void 0===i||i.forEach((function(t){return l.add(t)}))})),t.seriesIndexes=Array.from(l)}}}}))})),r},t.prototype._isValidSeries=function(t){return!0},t.prototype._getDefaultSeriesSpec=function(t,e,i){var n,r,a,o,s={dataKey:t.dataKey,hover:t.hover,select:t.select,label:t.label,seriesStyle:t.seriesStyle,animation:null!==(n=t.animation)&&void 0!==n?n:this._option.animation,animationThreshold:null!==(r=t.animationThreshold)&&void 0!==r?r:null===(o=(a=this._option).getTheme)||void 0===o?void 0:o.call(a).animationThreshold,animationAppear:t.animationAppear,animationDisappear:t.animationDisappear,animationEnter:t.animationEnter,animationUpdate:t.animationUpdate,animationExit:t.animationExit,animationNormal:t.animationNormal,animationState:t.animationState,extensionMark:t.extensionMark,large:t.large,largeThreshold:t.largeThreshold,progressiveStep:t.progressiveStep,progressiveThreshold:t.progressiveThreshold,background:t.seriesBackground,invalidType:t.invalidType,seriesField:t.seriesField,morph:t.morph,interactions:t.interactions},l=this.seriesType;return l&&(s.type=l,s[l]=t[l]),e&&e.length&&e.forEach((function(e){s[e]=t[e]})),i&&i.length&&i.forEach((function(e){s[e]=t[e]})),s},t.prototype.forEachRegionInSpec=function(t,e,i){var n;return(null!==(n=t.region)&&void 0!==n?n:[]).map((function(t,n){return e(kz.getRegionInType("region"),{spec:t,specPath:["region",n],type:"region",regionIndexes:[n]},i)}))},t.prototype.forEachSeriesInSpec=function(t,e,i){var n;return(null!==(n=t.series)&&void 0!==n?n:[]).map((function(t,n){return e(kz.getSeriesInType(t.type),{spec:t,specPath:["series",n],type:t.type,seriesIndexes:[n]},i)}))},t.prototype.forEachComponentInSpec=function(t,e,i){for(var n,r,a,o,s,l,u,c=[],h=kz.getComponents(),d=[],p=0;p<h.length;p++){var f=h[p],v=f.cmp,g=f.alwaysCheck;v.type.startsWith(B.cartesianAxis)?o=v:v.type.startsWith(B.polarAxis)?s=v:v.type===B.geoCoordinate?l=v:(g||t[null!==(n=v.specKey)&&void 0!==n?n:v.type])&&(v.type===B.tooltip?u=v:d.push(v))}var y,m=!1;o&&((null==(y=o.getSpecInfo(t,i))?void 0:y.length)>0&&(m=!0,y.forEach((function(t){var n=kz.getComponentInKey(t.type);c.push(e(n,t,i))}))));s&&!m&&((null==(y=s.getSpecInfo(t,i))?void 0:y.length)>0&&(m=!0,y.forEach((function(t){var n=kz.getComponentInKey(t.type);c.push(e(n,t,i))}))));return l&&!m&&(null===(r=l.getSpecInfo(t,i))||void 0===r||r.forEach((function(t){c.push(e(l,t,i))}))),d.forEach((function(n){var r;null===(r=n.getSpecInfo?n.getSpecInfo(t,i):kY(t,n.specKey,n.type))||void 0===r||r.forEach((function(t){c.push(e(n,t,i))}))})),u&&(null===(a=kY(t,u.specKey,u.type))||void 0===a||a.forEach((function(t){c.push(e(u,t,i))}))),c},t.prototype.transformSeriesSpec=function(t){var e=this,i=this._getDefaultSeriesSpec(t);t.series&&0!==t.series.length?t.series.forEach((function(t){e._isValidSeries(t.type)&&Object.keys(i).forEach((function(e){e in t||(t[e]=i[e])}))})):t.series=[i]},t.prototype._findBandAxisBySeries=function(t,e,i){var n="horizontal"===(null==t?void 0:t.direction)?["left","right"]:["top","bottom"],r=i.find((function(i){if(!n.includes(i.orient))return!1;if(N(i.seriesId)){if(xt(i.seriesId).includes(null==t?void 0:t.id))return!0}else if(N(i.seriesIndex)){if(xt(i.seriesIndex).includes(e))return!0}else if("band"===i.type)return!0;return!0}));return r},t.prototype._applyAxisBandSize=function(t,e,i){var n=i.barMaxWidth,r=i.barMinWidth,a=i.barWidth,o=i.barGapInGroup,s=!1;Z(r)?(t.minBandSize=r,s=!0):Z(a)?(t.minBandSize=a,s=!0):Z(n)&&(t.minBandSize=n,s=!0),s&&(t.bandSizeLevel=Number.MAX_VALUE,t.bandSizeExtend={extend:e,gap:X(o)?o[o.length-1]:o})},t}(),HK=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype.needAxes=function(){return!0},e.prototype._isValidSeries=function(t){return!this.seriesType||t===this.seriesType},e.prototype._getDefaultSeriesSpec=function(e,i){return t.prototype._getDefaultSeriesSpec.call(this,e,["xField","yField","zField","direction","stack","percent","stackOffsetSilhouette","totalLabel","sortDataByAxis"],i)},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),t.prototype.transformSeriesSpec.call(this,e),this._transformAxisSpec(e)},e.prototype._setDefaultXAxisSpec=function(t){return{orient:"bottom"}},e.prototype._setDefaultYAxisSpec=function(t){return{orient:"left"}},e.prototype._setDefaultZAxisSpec=function(t){return{orient:"z"}},e.prototype._transformAxisSpec=function(t){var e=this;if(this.needAxes()){t.axes||(t.axes=[]);var i={x:!1,y:!1,z:!1};t.axes.forEach((function(n){var r=n.orient,a=null;"top"!==r&&"bottom"!==r||(i.x=!0,a=e._setDefaultXAxisSpec(t)),"left"!==r&&"right"!==r||(i.y=!0,a=e._setDefaultYAxisSpec(t)),"z"===r&&(i.z=!0,a=e._setDefaultZAxisSpec(t)),a&&Object.keys(a).forEach((function(t){j(n[t])&&(n[t]=a[t])})),st(n,"trimPadding")&&xz(n,_U(e.type,t))})),i.x||t.axes.push(this._setDefaultXAxisSpec(t)),i.y||t.axes.push(this._setDefaultYAxisSpec(t)),t.zField&&!i.z&&t.axes.push(this._setDefaultZAxisSpec(t))}},e}(zK),jK=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i,n=t.prototype._getDefaultSeriesSpec.call(this,e,["point","line","activePoint","sampling","samplingFactor","pointDis","pointDisMul","markOverlap","lineLabel"]);return n.seriesMark=null!==(i=e.seriesMark)&&void 0!==i?i:"line",n},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),gU(e)},e}(HK),NK=function(t,e){var i={nodes:{}},n=e.fields;if(!(null==n?void 0:n.length))return i;var r,a=n.length-1,o=i;return t.forEach((function(t){t.latestData&&t.latestData.forEach((function(t){o=i;for(var e=0;e<n.length;e++){var s=n[e],l=t[s];if(j(l))break;o.groupField=s,o.nodes[l]||(e===a?o.nodes[l]={values:[]}:(r={nodes:{}},o.nodes[l]=r)),e===a?o.nodes[l].values.push(t):o=o.nodes[l]}}))})),i},VK=function(){function t(t,e){var i=this;this.stackRegion=function(t){var e,n=t.model,r=n.getSeries(),a=r.some((function(t){return t.getStack()}));if(a){var o=r.some((function(t){var e,i,n,r;return!!(null===(i=null===(e=t.getSpec())||void 0===e?void 0:e.totalLabel)||void 0===i?void 0:i.alwayCalculateTotal)||(null===(r=null===(n=t.getSpec())||void 0===n?void 0:n.totalLabel)||void 0===r?void 0:r.visible)})),s=o||r.some((function(t){return t.getPercent()})),l=r.some((function(t){return t.getStackOffsetSilhouette()})),u=vH(n,!0);for(var c in u)for(var h in u[c].nodes)xH(u[c].nodes[h],n.getStackInverse(),s,o);if(l)for(var c in u)for(var h in u[c].nodes)bH(u[c].nodes[h]);o&&n.getSeries().forEach((function(t){var e=t.getStackData(),i=t.getStackValue(),n=t.getStackValueField();e&&n&&yH(u[i],n)})),(null===(e=i._options)||void 0===e?void 0:e.afterStackRegion)&&i._options.afterStackRegion(n,u)}},this._chart=t,this._options=e}return t.prototype.init=function(){var t=this;this._chart.getAllRegions().forEach((function(e){e.event.on(cG.regionSeriesDataFilterOver,{filter:function(t){var i=t.model;return(null==i?void 0:i.id)===e.id}},t.stackRegion)}))},t.prototype.stackAll=function(){var t=this;this._chart.getAllRegions().forEach((function(e){t.stackRegion({model:e})}))},t}(),WK=function(){function t(){}return t.prototype._beforeInit=function(){this._dataSet&&qG(this._dataSet,"stackSplit",NK)},t.prototype._initStack=function(){this._stack=new VK(this),this._stack.init()},t}(),GK=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=jK,i.type="line",i.seriesType=t.SeriesTypeEnum.line,i}return S(i,e),i.type="line",i.seriesType=t.SeriesTypeEnum.line,i.transformerConstructor=jK,i}(OK);bt(GK,WK);var UK,YK=function(){IK(),kz.registerChart(GK.type,GK)},XK=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return S(e,t),e.prototype._getDefaultStyle=function(){return A(A({},t.prototype._getDefaultStyle.call(this)),{lineWidth:0})},e.prototype._getIgnoreAttributes=function(){return[]},e.type="area",e}(EX),KK=function(){kz.registerMark(XK.type,XK),ZN(),sX()},qK=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._getSeriesStyle=function(t,i,n){var r,a,o,s,l,u;try{for(var c=C(xt(i)),h=c.next();!h.done;h=c.next()){var d=h.value,p=null===(o=e.series.getSeriesStyle(t))||void 0===o?void 0:o(d);if(!1!==p||"fill"!==d&&"stroke"!==d||(p="fill"===d?null===(l=null===(s=e.series.getSeriesStyle(t))||void 0===s?void 0:s("stroke"))||void 0===l?void 0:l[0]:null===(u=e.series.getSeriesStyle(t))||void 0===u?void 0:u("fill")),N(p))return p}}catch(t){r={error:t}}finally{try{h&&!h.done&&(a=c.return)&&a.call(c)}finally{if(r)throw r.error}}return n},e}return S(e,t),e}(PY),ZK=A(A(A({},WY),wX),((UK={}).area={name:"area",type:"area"},UK)),JK=function(){kz.registerAnimation("area",nX),rX(),eX()},QK=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._supportStack=!0,e}return S(e,t),e.prototype._transformLabelSpec=function(t){var e,i,n,r=!1!==(null===(e=t.point)||void 0===e?void 0:e.visible)&&!1!==(null===(n=null===(i=t.point)||void 0===i?void 0:i.style)||void 0===n?void 0:n.visible);this._addMarkLabelSpec(t,(function(t){var e="inside-middle"===t.position;return!r||e?"area":"point"})),this._addMarkLabelSpec(t,"area","areaLabel","initLineLabelMarkStyle",void 0,!0)},e.prototype._transformSpecAfterMergingTheme=function(e,i,n){var r,a,o,s,l;t.prototype._transformSpecAfterMergingTheme.call(this,e,i,n);var u=e.area,c=void 0===u?{}:u,h=e.line,d=void 0===h?{}:h,p=e.seriesMark,f=!1!==c.visible&&!1!==(null===(r=c.style)||void 0===r?void 0:r.visible),v=!1!==d.visible&&!1!==(null===(a=d.style)||void 0===a?void 0:a.visible);c.support3d=!(!c.support3d&&!d.support3d),c.zIndex=N(c.zIndex)||N(d.zIndex)?Math.max(null!==(o=c.zIndex)&&void 0!==o?o:0,null!==(s=d.zIndex)&&void 0!==s?s:0):void 0,c.style&&delete c.style.stroke,c.state&&Object.keys(c.state).forEach((function(t){"style"in c.state[t]?delete c.state[t].style.stroke:delete c.state[t].stroke}));var g=c,y=d;("line"===p||v&&!f)&&(g=d,y=c),c.style=xz({},y.style,g.style),c.state=xz({},y.state,g.state),!1===c.interactive&&(c.style.fillPickable=!1),!1===d.interactive&&(d.style.strokePickable=!1),c.interactive=!(!c.interactive&&null!==(l=d.interactive)&&void 0!==l&&!l),e.area=c,e.line=d},e}(DX),$K=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.area,i.transformerConstructor=QK,i._sortDataByAxis=!1,i}return S(i,e),i.prototype.initMark=function(){var t,e={progressiveStep:this._spec.progressiveStep,progressiveThreshold:this._spec.progressiveThreshold,large:this._spec.large,largeThreshold:this._spec.largeThreshold},n=this._spec.area||{},r=null!==(t=this._spec.seriesMark)&&void 0!==t?t:"area",a=this._isAreaVisible()||this._isLineVisible();this._areaMark=this._createMark(i.mark.area,{groupKey:this._seriesField,isSeriesMark:a&&"point"!==r,stateSort:n.stateSort},A(A({},e),{morphElementKey:this.getDimensionField()[0],setCustomizedShape:n.customShape})),this.initSymbolMark(e,"point"===r)},i.prototype.initMarkStyle=function(){this.initAreaMarkStyle(),this.initSymbolMarkStyle()},i.prototype.initAreaMarkStyle=function(){var t,e,i,n,r,a=this,o=null!==(i=null===(e=null===(t=this.getSpec().area)||void 0===t?void 0:t.style)||void 0===e?void 0:e.curveType)&&void 0!==i?i:null===(r=null===(n=this.getSpec().line)||void 0===n?void 0:n.style)||void 0===r?void 0:r.curveType,s=o===AX?"horizontal"===this._direction?"monotoneY":"monotoneX":o,l=this._areaMark;if(l){var u=this._isAreaVisible(),c=this._isLineVisible();u||c?l.setVisible(!0):l.setVisible(!1),"horizontal"===this._direction?this.setMarkStyle(this._areaMark,{x:this.dataToPositionX.bind(this),x1:function(t){var e,i;return fF(a.dataToPositionX1(t),null===(i=null===(e=a._xAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0))},y:this.dataToPositionY.bind(this),y1:this.dataToPositionY.bind(this),z:this._fieldZ?this.dataToPositionZ.bind(this):null,orient:this._direction},"normal",CU.Series):this.setMarkStyle(this._areaMark,{x:this.dataToPositionX.bind(this),x1:this.dataToPositionX.bind(this),y1:function(t){var e,i;return fF(a.dataToPositionY1(t),null===(i=null===(e=a._yAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0))},y:this.dataToPositionY.bind(this),z:this._fieldZ?this.dataToPositionZ.bind(this):null},"normal",CU.Series),this.setMarkStyle(l,{fill:!!u&&this.getColorAttribute(),stroke:!!c&&this.getColorAttribute()},"normal",CU.Series),"zero"!==this._invalidType&&this.setMarkStyle(l,{defined:this._getInvalidDefined.bind(this),connectedType:this._getInvalidConnectType()},"normal",CU.Series),this.getStack()&&this.setMarkStyle(l,{zIndex:function(t){return-t[Jz]}},"normal",CU.Series),this.setMarkStyle(l,{curveType:s},"normal",CU.Built_In),Object.keys(l.stateStyle).forEach((function(t){l.stateStyle[t].stroke&&l.setPostProcess("stroke",(function(t){return[t,!1,!1,!1]}),t)}))}},i.prototype.initAnimation=function(){var t,e,i,n,r={direction:this.direction},a=null===(t=this._spec.animationAppear)||void 0===t?void 0:t.preset;if(this._lineMark&&this._lineMark.setAnimationConfig(cX(null===(e=kz.getAnimationInKey("line"))||void 0===e?void 0:e(r,a),hX("line",this._spec,this._markAttributeContext))),this._areaMark&&this._areaMark.setAnimationConfig(cX(null===(i=kz.getAnimationInKey("area"))||void 0===i?void 0:i(r,a),hX("area",this._spec,this._markAttributeContext))),this._symbolMark){var o=xX(this);this._symbolMark.setAnimationConfig(cX(null===(n=kz.getAnimationInKey("scaleInOut"))||void 0===n?void 0:n(),hX("point",this._spec,this._markAttributeContext),o))}},i.prototype._isAreaVisible=function(){var t,e=this._spec.area||{};return!1!==e.visible&&!1!==(null===(t=e.style)||void 0===t?void 0:t.visible)},i.prototype._isLineVisible=function(){var t,e=this._spec.line||{};return!1!==e.visible&&!1!==(null===(t=e.style)||void 0===t?void 0:t.visible)},i.prototype.initTooltip=function(){this._tooltipHelper=new qK(this);var t=this._tooltipHelper.activeTriggerSet,e=t.group,i=t.mark;this._areaMark&&e.add(this._areaMark),this._lineMark&&e.add(this._lineMark),this._symbolMark&&(i.add(this._symbolMark),e.add(this._symbolMark))},i.prototype.viewDataStatisticsUpdate=function(t){e.prototype.viewDataStatisticsUpdate.call(this,t),this.encodeDefined(this._areaMark,"defined")},i.prototype.compile=function(){e.prototype.compile.call(this),this.addSamplingCompile(),this.addOverlapCompile()},i.prototype.getDefaultShapeType=function(){return"square"},i.prototype.getActiveMarks=function(){return[this._areaMark,this._symbolMark,this._lineMark]},i.prototype.onLayoutEnd=function(t){e.prototype.onLayoutEnd.call(this,t),this.reCompileSampling()},i.prototype.getSeriesStyle=function(t){var e=this;return function(i){var n,r,a,o,s,l=null!==(n=e._spec.seriesMark)&&void 0!==n?n:"area",u=null!==(a=null===(r=e._seriesMark)||void 0===r?void 0:r.getAttribute(i,t))&&void 0!==a?a:void 0;return"fill"!==i||u&&"line"!==l||(i="stroke",u=null!==(s=null===(o=e._seriesMark)||void 0===o?void 0:o.getAttribute(i,t))&&void 0!==s?s:void 0),"stroke"===i&&X(u)?u[0]:u}},i.type=t.SeriesTypeEnum.area,i.mark=ZK,i.transformerConstructor=QK,i}(SX);bt($K,TX);var tq=function(){UV(),YV(),RX(),KK(),LX(),JK(),MK(),kK(),kz.registerSeries($K.type,$K)},eq=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["point","line","area","seriesMark","activePoint","sampling","samplingFactor","pointDis","pointDisMul","markOverlap","areaLabel"])},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),gU(e)},e}(HK),iq=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=eq,i.type="area",i.seriesType=t.SeriesTypeEnum.area,i}return S(i,e),i.type="area",i.seriesType=t.SeriesTypeEnum.area,i.transformerConstructor=eq,i}(OK);bt(iq,WK);var nq=function(){tq(),kz.registerChart(iq.type,iq)};function rq(t,e){return void 0===e&&(e=!0),function(i,n,r){var a="vertical"===t.direction?t.yField:t.xField,o=null==i?void 0:i[a];return"vertical"===t.direction?{overall:e?t.growFrom():e,orient:o>0?"negative":"positive"}:{overall:!!e&&t.growFrom(),orient:o>0?"positive":"negative"}}}var aq=function(t,e){return void 0===e&&(e=!0),{type:"horizontal"===t.direction?"growWidthIn":"growHeightIn",options:rq(t,e)}},oq=function(t,e){return void 0===e&&(e=!0),{type:"horizontal"===t.direction?"growWidthOut":"growHeightOut",options:rq(t,e)}},sq={type:"fadeIn"},lq={type:"growCenterIn"};function uq(t,e){if(!1===e)return{};switch(e){case"fadeIn":return sq;case"scaleIn":return lq;default:return aq(t)}}var cq,hq,dq=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return S(e,t),e.prototype._getDefaultStyle=function(){return A(A({},t.prototype._getDefaultStyle.call(this)),{width:void 0,height:void 0,lineWidth:0})},e.type="rect",e}(aY),pq=function(){kz.registerMark(dq.type,dq),QN(),aX()},fq=A(A({},WY),((cq={}).bar={name:"bar",type:"rect"},cq.barBackground={name:"barBackground",type:"rect"},cq)),vq=A(A({},WY),((hq={}).bar3d={name:"bar3d",type:"rect3d"},hq));function gq(t,e,i){var n,r,a;if(t.values.length>0)if(t.sortDatums.length){var o=t.sortDatums;e&&(o=t.sortDatums.slice().reverse());for(var s=0;s<o.length;s++)a=yq(o[s].datum,a,o[s].series,i,null===(r=(n=o[s].series[i.axisHelper]).getScale)||void 0===r?void 0:r.call(n,0),0===s)}else{var l=t.series;e&&(l=l.slice().reverse()),l.forEach((function(t,n){for(var r,o,s=t.s,l=t.values,u=null===(o=(r=s[i.axisHelper]).getScale)||void 0===o?void 0:o.call(r,0),c=0;c<l.length;c++){var h=l[e?l.length-1-c:c];a=yq(h,a,s,i,u,0===c&&0===n)}}))}for(var u in t.nodes)gq(t.nodes[u],e,i)}function yq(t,e,i,n,r,a){var o=i.getSpec().barMinHeight,s=i[n.axisHelper].isInverse(),l=fF(i[n.startMethod](t),r),u=fF(i[n.endMethod](t),r);a&&(e=l);var c=Math.abs(l-u);c<o&&(c=o);var h=1;return u<l?h=-1:u===l&&(h=n.isVertical?s?1:-1:s?-1:1),u=e+h*c,t[n.start]=e,t[n.end]=u,u}var mq=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._supportStack=!0,e}return S(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"bar")},e}(mX),_q=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.bar,i._barMarkName="bar",i._barMarkType="rect",i.transformerConstructor=mq,i._bandPosition=0,i._getBarXStart=function(t,e,n){return i._shouldDoPreCalculate()?(i._calculateStackRectPosition(!1),t[GY]):i._spec.barMinHeight?i._calculateRectPosition(t,!1,n):fF(i._dataToPosX(t),e,n)},i._getBarXEnd=function(t,e,n){return i._shouldDoPreCalculate()?(i._calculateStackRectPosition(!1),t[UY]):fF(i._dataToPosX1(t),e,n)},i._getBarYStart=function(t,e){return i._shouldDoPreCalculate()?(i._calculateStackRectPosition(!0),t[YY]):i._spec.barMinHeight?i._calculateRectPosition(t,!0):fF(i._dataToPosY(t),e)},i._getBarYEnd=function(t,e){return i._shouldDoPreCalculate()?(i._calculateStackRectPosition(!0),t[XY]):fF(i._dataToPosY1(t),e)},i._getBarBackgroundXStart=function(t){var e=t.range();return Math.min(e[0],e[e.length-1])},i._getBarBackgroundXEnd=function(t){var e=t.range();return Math.max(e[0],e[e.length-1])},i._getBarBackgroundYStart=function(t){var e=t.range();return Math.min(e[0],e[e.length-1])},i._getBarBackgroundYEnd=function(t){var e=t.range();return Math.max(e[0],e[e.length-1])},i._getBarBackgroundPositionXEncoder=function(){var t;return null===(t=i._barBackgroundPositionXEncoder)||void 0===t?void 0:t.bind(i)},i._setBarBackgroundPositionXEncoder=function(t){i._barBackgroundPositionXEncoder=t.bind(i)},i._getBarBackgroundPositionYEncoder=function(){var t;return null===(t=i._barBackgroundPositionYEncoder)||void 0===t?void 0:t.bind(i)},i._setBarBackgroundPositionYEncoder=function(t){i._barBackgroundPositionYEncoder=t.bind(i)},i}return S(i,e),i.prototype.initMark=function(){var t,e;this._initBarBackgroundMark(),this._barMark=this._createMark(A(A({},i.mark.bar),{name:this._barMarkName,type:this._barMarkType}),{groupKey:this._seriesField,isSeriesMark:!0,stateSort:null===(t=this._spec.bar)||void 0===t?void 0:t.stateSort},{progressiveStep:this._spec.progressiveStep,progressiveThreshold:this._spec.progressiveThreshold,large:this._spec.large,largeThreshold:this._spec.largeThreshold,morphElementKey:this.getDimensionField()[0],morph:fX(this._spec,this._barMarkName),setCustomizedShape:null===(e=this._spec.bar)||void 0===e?void 0:e.customShape})},i.prototype._initBarBackgroundMark=function(){this._spec.barBackground&&this._spec.barBackground.visible&&(this._barBackgroundMark=this._createMark(i.mark.barBackground,{dataView:this._barBackgroundViewData.getDataView(),dataProductId:this._barBackgroundViewData.getProductId(),stateSort:this._spec.barBackground.stateSort},{setCustomizedShape:this._spec.barBackground.customShape,progressiveStep:this._spec.progressiveStep,progressiveThreshold:this._spec.progressiveThreshold,large:this._spec.large,largeThreshold:this._spec.largeThreshold}))},i.prototype.initMarkStyle=function(){this._barMark&&this.setMarkStyle(this._barMark,{fill:this.getColorAttribute()},"normal",CU.Series)},i.prototype.initLabelMarkStyle=function(t){var e=this;t&&this.setMarkStyle(t,{fill:this.getColorAttribute(),text:function(t){return t[e.getStackValueField()]},z:this._fieldZ?this.dataToPositionZ.bind(this):null})},i.prototype.initTooltip=function(){e.prototype.initTooltip.call(this);var t=this._tooltipHelper.activeTriggerSet,i=t.mark,n=t.group;this._barMark&&(i.add(this._barMark),n.add(this._barMark))},i.prototype._statisticViewData=function(){var t,i,n=this;e.prototype._statisticViewData.call(this);var r=null!==(t=this._spec.barBackground)&&void 0!==t?t:{};if(r.visible){var a,o=this._getRelatedComponentSpecInfo("axes").some((function(t){return t.type===B.cartesianBandAxis}));if(qG(this._option.dataSet,"addVChartProperty",_Y),o){var s=function(t,e){for(var i,r,a,o=E(t,1)[0],s=e.scaleDepth,l=[{}],u=n.getDimensionField(),c=j(s)?u.length:Math.min(u.length,s),h=0;h<c;h++){var d=u[h],p=null===(r=o.latestData[d])||void 0===r?void 0:r.values;if(null==p?void 0:p.length){for(var f=[],v=null!==(a=n._spec.dataKey)&&void 0!==a?a:Yz,g=0;g<p.length;g++)for(var y=0;y<l.length;y++)f.push(A(A({},l[y]),((i={})[d]=p[g],i[v]=p[g],i)));l=f}}return l};qG(this._option.dataSet,"dimensionItems",s),a=new Ms(this._option.dataSet).parse([this._viewDataStatistics],{type:"dataview"}).transform({type:"dimensionItems",options:{scaleDepth:j(r.fieldLevel)?void 0:r.fieldLevel+1}},!1).transform({type:"addVChartProperty",options:{beforeCall:HY.bind(this),call:jY}},!1),null===(i=this._viewDataStatistics)||void 0===i||i.target.addListener("change",a.reRunAllTransform)}else{s=function(t){E(t,1)[0];var e=[],i=E(n.getDimensionContinuousField(),2),r=i[0],a=i[1],o={};return l.latestData.forEach((function(t){var i,n="".concat(t[r],"-").concat(t[a]);o[n]||(o[n]=((i={})[r]=t[r],i[a]=t[a],i),e.push(o[n]))})),e};qG(this._option.dataSet,"dimensionItems",s);var l=this.getViewData();a=new Ms(this._option.dataSet).parse([l],{type:"dataview"}).transform({type:"dimensionItems"},!1).transform({type:"addVChartProperty",options:{beforeCall:HY.bind(this),call:jY}},!1),null==l||l.target.addListener("change",a.reRunAllTransform)}this._barBackgroundViewData=new DY(this._option,a)}},i.prototype.init=function(t){var i,n;e.prototype.init.call(this,t),"vertical"===this.direction?"band"===(null===(i=this._xAxisHelper)||void 0===i?void 0:i.getScale(0).type)?this.initBandRectMarkStyle():this.initLinearRectMarkStyle():"band"===(null===(n=this._yAxisHelper)||void 0===n?void 0:n.getScale(0).type)?this.initBandRectMarkStyle():this.initLinearRectMarkStyle()},i.prototype._shouldDoPreCalculate=function(){var t=this,e=this.getRegion();return this.getStack()&&e.getSeries().filter((function(e){return e.type===t.type&&e.getSpec().barMinHeight})).length},i.prototype._calculateStackRectPosition=function(t){var e=this,i=this.getRegion();if(!i._bar_series_position_calculated){var n,r,a,o,s;i._bar_series_position_calculated=!0,t?(n=XY,r=YY,a="_dataToPosY1",o="_dataToPosY",s="_yAxisHelper"):(n=UY,r=GY,a="_dataToPosX1",o="_dataToPosX",s="_xAxisHelper");var l=vH(i,!1,(function(t){return t.type===e.type}));for(var u in l)for(var c in l[u].nodes)gq(l[u].nodes[c],i.getStackInverse(),{isVertical:t,start:n,end:r,startMethod:a,endMethod:o,axisHelper:s})}},i.prototype._calculateRectPosition=function(t,e,i){var n,r,a,o,s;e?(a="_dataToPosY1",o="_dataToPosY",s="_yAxisHelper"):(a="_dataToPosX1",o="_dataToPosX",s="_xAxisHelper");var l=null===(r=(n=this[s]).getScale)||void 0===r?void 0:r.call(n,0),u=this[s].isInverse(),c=this._spec.barMinHeight,h=fF(this[a](t),l,i),d=fF(this[o](t),l,i),p=Math.abs(h-d);p<c&&(p=c);var f=1;return d<h?f=-1:d===h&&(f=e?u?1:-1:u?-1:1),h+f*p},i.prototype._dataToPosX=function(t){return this.dataToPositionX(t)},i.prototype._dataToPosX1=function(t){return this.dataToPositionX1(t)},i.prototype._dataToPosY=function(t){return this.dataToPositionY(t)},i.prototype._dataToPosY1=function(t){return this.dataToPositionY1(t)},i.prototype.initBandRectMarkStyle=function(){var t,e,i,n,r=this,a=null===(e=null===(t=this._xAxisHelper)||void 0===t?void 0:t.getScale)||void 0===e?void 0:e.call(t,0),o=null===(n=null===(i=this._yAxisHelper)||void 0===i?void 0:i.getScale)||void 0===n?void 0:n.call(i,0);"horizontal"===this.direction?this.setMarkStyle(this._barMark,{x:function(t){return r._getBarXStart(t,a)},x1:function(t){return r._getBarXEnd(t,a)},y:function(t){return r._getPosition(r.direction,t)},height:function(){return r._getBarWidth(r._yAxisHelper)},width:function(){},y1:function(){}},"normal",CU.Series):this.setMarkStyle(this._barMark,{y:function(t){return r._getBarYStart(t,o)},y1:function(t){return r._getBarYEnd(t,o)},x:function(t){return r._getPosition(r.direction,t)},width:function(){return r._getBarWidth(r._xAxisHelper)},x1:function(){},height:function(){}},"normal",CU.Series),this._initStackBarMarkStyle(),this._initBandBarBackgroundMarkStyle()},i.prototype._initStackBarMarkStyle=function(){var t,e,i,n,r=this;if(this._spec.stackCornerRadius){var a=null===(e=null===(t=this._xAxisHelper)||void 0===t?void 0:t.getScale)||void 0===e?void 0:e.call(t,0),o=null===(n=null===(i=this._yAxisHelper)||void 0===i?void 0:i.getScale)||void 0===n?void 0:n.call(i,0);this._barMark.setMarkConfig({clip:!0,clipPath:function(){var t=[];return r._forEachStackGroup((function(e){var i,n,s=1/0,l=-1/0,u=!1,c=1/0,h=-1/0;e.values.forEach((function(t){var e=t[Zz],i=t[Jz],n=t[Qz],r=t[$z];s=Math.min(s,e,i),l=Math.max(l,e,i),N(n)&&N(r)&&(u=!0,c=Math.min(c,n,r),h=Math.max(h,n,r))}));var d=A(A(A({},e.values[0]),((i={})[Zz]=s,i[Jz]=l,i)),u?((n={})[Qz]=c,n[$z]=h,n):void 0),p="horizontal"===r.direction?{x:r._getBarXStart(d,a),x1:r._getBarXEnd(d,a),y:r._getPosition(r.direction,d),height:r._getBarWidth(r._yAxisHelper)}:{y:r._getBarYStart(d,o),y1:r._getBarYEnd(d,o),x:r._getPosition(r.direction,d),width:r._getBarWidth(r._xAxisHelper)};t.push(Xg(A(A({},p),{cornerRadius:H(r._spec.stackCornerRadius)?r._spec.stackCornerRadius(p,d,r._markAttributeContext):r._spec.stackCornerRadius,fill:!0})))})),t}})}},i.prototype.initLinearRectMarkStyle=function(){var t,e,i,n,r=this,a=null===(e=null===(t=this._xAxisHelper)||void 0===t?void 0:t.getScale)||void 0===e?void 0:e.call(t,0),o=null===(n=null===(i=this._yAxisHelper)||void 0===i?void 0:i.getScale)||void 0===n?void 0:n.call(i,0);if("horizontal"===this.direction){var s=N(this._fieldY2)?{y:function(t){return fF(r._dataToPosY(t),o,!0)},y1:function(t){return fF(r._dataToPosY1(t),o,!0)}}:{y:function(t){return fF(r._dataToPosY(t)-r._getBarWidth(r._yAxisHelper)/2,o,!0)},height:function(t){return r._getBarWidth(r._yAxisHelper)}};this.setMarkStyle(this._barMark,A({x:function(t){return r._getBarXStart(t,a,!0)},x1:function(t){return r._getBarXEnd(t,a,!0)}},s),"normal",CU.Series),this.setMarkStyle(this._barBackgroundMark,A({x:function(){return r._getBarBackgroundXStart(a)},x1:function(){return r._getBarBackgroundXEnd(a)}},s),"normal",CU.Series)}else{var l=N(this._fieldX2)?{x:function(t){return fF(r._dataToPosX(t),a,!0)},x1:function(t){return fF(r._dataToPosX1(t),a,!0)}}:{x:function(t){return fF(r._dataToPosX(t)-r._getBarWidth(r._xAxisHelper)/2,a,!0)},width:function(t){return r._getBarWidth(r._xAxisHelper)}};this.setMarkStyle(this._barMark,A(A({},l),{y:function(t){return r._getBarYStart(t,o)},y1:function(t){return r._getBarYEnd(t,o)}}),"normal",CU.Series),this.setMarkStyle(this._barBackgroundMark,A(A({},l),{y:function(){return r._getBarBackgroundYStart(o)},y1:function(){return r._getBarBackgroundYEnd(o)}}),"normal",CU.Series)}},i.prototype._initBandBarBackgroundMarkStyle=function(){var t,e,i,n,r,a=this;if(this._barBackgroundMark){var o=null===(e=null===(t=this._xAxisHelper)||void 0===t?void 0:t.getScale)||void 0===e?void 0:e.call(t,0),s=null===(n=null===(i=this._yAxisHelper)||void 0===i?void 0:i.getScale)||void 0===n?void 0:n.call(i,0),l=null!==(r=this._spec.barBackground)&&void 0!==r?r:{},u=j(l.fieldLevel)?void 0:l.fieldLevel+1;"horizontal"===this.direction?this.setMarkStyle(this._barBackgroundMark,{x:function(){return a._getBarBackgroundXStart(o)},x1:function(){return a._getBarBackgroundXEnd(o)},y:function(t){return a._getPosition(a.direction,t,u,"barBackground")},height:function(){return a._getBarWidth(a._yAxisHelper,u)},width:function(){},y1:function(){}},"normal",CU.Series):this.setMarkStyle(this._barBackgroundMark,{x:function(t){return a._getPosition(a.direction,t,u,"barBackground")},y:function(){return a._getBarBackgroundYStart(s)},y1:function(){return a._getBarBackgroundYEnd(s)},width:function(){return a._getBarWidth(a._xAxisHelper,u)},x1:function(){},height:function(){}},"normal",CU.Series)}},i.prototype.initAnimation=function(){var t,e,i=this,n={yField:this._fieldY[0],xField:this._fieldX[0],direction:this.direction,growFrom:function(){var t,e="horizontal"===i.direction?null===(t=i._xAxisHelper)||void 0===t?void 0:t.getScale(0):i._yAxisHelper.getScale(0);if(e){var n=e.domain(),r=At(n),a=St(n);return a<0?e.scale(a):r>0?e.scale(r):e.scale(0)}}},r=null===(t=this._spec.animationAppear)||void 0===t?void 0:t.preset,a=xX(this);this._barMark.setAnimationConfig(cX(null===(e=kz.getAnimationInKey("bar"))||void 0===e?void 0:e(n,r),hX(this._barMarkName,this._spec,this._markAttributeContext),a))},i.prototype._getBarWidth=function(t,e){var i,n,r=this._groups?this._groups.fields.length:1,a=j(e)?r:Math.min(r,e),o=null!==(n=null===(i=t.getBandwidth)||void 0===i?void 0:i.call(t,a-1))&&void 0!==n?n:6,s=N(this._spec.barWidth)&&a===r,l=N(this._spec.barMinWidth),u=N(this._spec.barMaxWidth),c=o;return s&&(c=kF(this._spec.barWidth,o)),l&&(c=Math.max(c,kF(this._spec.barMinWidth,o))),u&&(c=Math.min(c,kF(this._spec.barMaxWidth,o))),c},i.prototype._getPosition=function(t,e,i,n){var r,a,o,s,l,u,c,h;"horizontal"===t?(u=this.getYAxisHelper(),c="height",h="barBackground"===n?this.dataToBarBackgroundPositionY.bind(this):this.dataToPositionY.bind(this)):(u=this.getXAxisHelper(),c="width",h="barBackground"===n?this.dataToBarBackgroundPositionX.bind(this):this.dataToPositionX.bind(this));var d=u.getScale(0),p=this._groups?this._groups.fields.length:1,f=j(i)?p:Math.min(p,i),v=null!==(a=null===(r=u.getBandwidth)||void 0===r?void 0:r.call(u,f-1))&&void 0!==a?a:6,g=f===p?this._barMark.getAttribute(c,e):v;if(f>1&&N(this._spec.barGapInGroup)){for(var y=this._groups.fields,m=xt(this._spec.barGapInGroup),_=0,b=0,x=y.length-1;x>=1;x--){var k=y[x],S=null!==(s=null===(o=u.getScale(x))||void 0===o?void 0:o.domain())&&void 0!==s?s:[],A=S.length,M=kF(null!==(l=m[x-1])&&void 0!==l?l:kt(m),v),w=S.indexOf(e[k]);x===y.length-1?(_+=A*g+(A-1)*M,b+=w*(g+M)):(b+=w*(_+M),_+=_+(A-1)*M)}return d.scale(e[y[0]])+u.getBandwidth(0)/2-_/2+b}var T=NB(d.type||"band");return h(e,f)+.5*(v-g)+(T?-v/2:0)},i.prototype.dataToBarBackgroundPositionX=function(t,e){return this._dataToPosition(t,this._xAxisHelper,this.fieldX,e,this._getBarBackgroundPositionXEncoder,this._setBarBackgroundPositionXEncoder)},i.prototype.dataToBarBackgroundPositionY=function(t,e){return this._dataToPosition(t,this._yAxisHelper,this.fieldY,e,this._getBarBackgroundPositionYEncoder,this._setBarBackgroundPositionYEncoder)},i.prototype.onLayoutEnd=function(t){e.prototype.onLayoutEnd.call(this,t),this.getRegion()._bar_series_position_calculated=!1,this._spec.sampling&&this.compile()},i.prototype.compile=function(){if(e.prototype.compile.call(this),this._spec.sampling){var t=this._region.getLayoutRect(),i=t.width,n=t.height,r=[],a=this._fieldY,o=this._fieldX;r.push({type:"sampling",size:"horizontal"===this._direction?n:i,factor:this._spec.samplingFactor,yfield:"horizontal"===this._direction?o[0]:a[0],groupBy:this._seriesField,mode:this._spec.sampling}),this._data.getProduct().transform(r)}},i.prototype.getDefaultShapeType=function(){return"square"},i.prototype.getActiveMarks=function(){return[this._barMark]},i.prototype.compileData=function(){var t;e.prototype.compileData.call(this),null===(t=this._barBackgroundViewData)||void 0===t||t.compile()},i.prototype.fillData=function(){var t,i;e.prototype.fillData.call(this),null===(i=null===(t=this._barBackgroundViewData)||void 0===t?void 0:t.getDataView())||void 0===i||i.reRunAllTransform()},i.prototype.viewDataUpdate=function(t){var i,n,r;e.prototype.viewDataUpdate.call(this,t),null===(n=null===(i=this._barBackgroundViewData)||void 0===i?void 0:i.getDataView())||void 0===n||n.reRunAllTransform(),null===(r=this._barBackgroundViewData)||void 0===r||r.updateData()},i.prototype.release=function(){var t;e.prototype.release.call(this),null===(t=this._barBackgroundViewData)||void 0===t||t.release(),this._barBackgroundViewData=null},i.type=t.SeriesTypeEnum.bar,i.mark=fq,i.transformerConstructor=mq,i}(SX),bq=function(){UV(),pq(),kz.registerAnimation("bar",(function(t,e){return{appear:uq(t,e),enter:aq(t,!1),exit:oq(t,!1),disappear:oq(t)}})),MK(),kK(),kz.registerSeries(_q.type,_q)},xq=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["barWidth","barMaxWidth","barMinWidth","barGapInGroup","barMinHeight","sampling","samplingFactor","barBackground","stackCornerRadius"])},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),gU(e)},e.prototype._transformAxisSpec=function(e){var i,n;if(t.prototype._transformAxisSpec.call(this,e),e.axes){var r=e.series.some((function(t){return"horizontal"===t.direction})),a=null!==(i=e.axes.find((function(t){return"band"===t.type})))&&void 0!==i?i:e.axes.find((function(t){return(r?["left","right"]:["top","bottom"]).includes(t.orient)}));if(a&&!a.bandSize&&!a.maxBandSize&&!a.minBandSize&&e.autoBandSize){var o=V(e.autoBandSize)&&null!==(n=e.autoBandSize.extend)&&void 0!==n?n:0,s=e.series.find((function(t){return"bar"===t.type})),l=s.barMaxWidth,u=s.barMinWidth,c=s.barWidth,h=s.barGapInGroup;this._applyAxisBandSize(a,o,{barMaxWidth:l,barMinWidth:u,barWidth:c,barGapInGroup:h})}}},e}(HK),kq=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=xq,i.type="bar",i.seriesType=t.SeriesTypeEnum.bar,i}return S(i,e),i.type="bar",i.seriesType=t.SeriesTypeEnum.bar,i.transformerConstructor=xq,i}(OK);bt(kq,WK);var Sq,Aq=function(){bq(),kz.registerChart(kq.type,kq)},Mq=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return S(e,t),e.prototype._getDefaultStyle=function(){return A(A({},t.prototype._getDefaultStyle.call(this)),{width:void 0,height:void 0,length:3})},e.type="rect3d",e}(aY),wq=function(){kz.registerMark(Mq.type,Mq),CP(),AP(),xj.registerGraphic(MH.rect3d,Zg),aX()},Tq=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"bar3d")},e}(mq),Cq=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.bar3d,i._barMarkName="bar3d",i._barMarkType="rect3d",i.transformerConstructor=Tq,i}return S(i,e),i.type=t.SeriesTypeEnum.bar3d,i.mark=vq,i.transformerConstructor=Tq,i}(_q),Eq=function(){kz.registerAnimation("bar3d",(function(t,e){return{appear:uq(t,e),enter:aq(t,!1),exit:oq(t,!1),disappear:oq(t)}})),wq(),MK(),kK(),kz.registerSeries(Cq.type,Cq)},Pq=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i=t.prototype._getDefaultSeriesSpec.call(this,e);return i.barWidth=e.barWidth,i.barMaxWidth=e.barMaxWidth,i.barMinWidth=e.barMinWidth,i.barGapInGroup=e.barGapInGroup,i},e}(xq),Rq=function(){Lx(),Ox(),fx.registerPlugin("ViewTransform3dPlugin",Ik)},Bq=function(){yG(),WN.useRegisters([YW,XW,wW,TW,GW,UW,KW,qW,ZW])},Iq=function(){bt(WN,KN)},Lq=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=Pq,i.type="bar3d",i.seriesType=t.SeriesTypeEnum.bar3d,i}return S(i,e),i.type="bar3d",i.seriesType=t.SeriesTypeEnum.bar3d,i.transformerConstructor=Pq,i}(kq),Dq=function(){Rq(),Eq(),kz.registerChart(Lq.type,Lq)},Oq=[10,20],Fq=LB.Linear,zq="circle",Hq=LB.Ordinal,jq=["circle","square","triangle","diamond","star"],Nq=function(t,e){return"fadeIn"===e?{type:"fadeIn"}:{type:"scaleIn"}},Vq=A(A({},WY),((Sq={}).point={name:"point",type:"symbol"},Sq)),Wq=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"point")},e}(mX),Gq=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.scatter,i.transformerConstructor=Wq,i._invalidType="zero",i}return S(i,e),i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),this._size=this._spec.size,this._sizeField=this._spec.sizeField,this._shape=this._spec.shape,this._shapeField=this._spec.shapeField},i.prototype._getSeriesAttribute=function(t,e,i,n){var r,a,o,s,l=i.defaultScaleType,u=i.defaultRange;if(H(e))return e;if(X(e)){if(j(t))return null===(r=this._option)||void 0===r||r.onError("".concat(n,"Field is required.")),e;if("ordinal"!==l&&e.length>2)return null===(a=this._option)||void 0===a||a.onError("".concat(n," length is invalid, specify up to 2 ").concat(n,"s.")),e;var c="".concat(BF,"_series_scatter_").concat(this.id,"_scale_").concat(n);return this._option.globalScale.registerModelScale({id:c,type:l,domain:[{dataId:this._rawData.name,fields:[t]}],range:e}),{scale:c,field:t}}if(V(e)){if(j(t))return null===(o=this._option)||void 0===o||o.onError("".concat(n,"Field is required.")),e;c="".concat(BF,"_series_scatter_").concat(this.id,"_scale_").concat(n);var h=A({id:c,type:l,domain:[{dataId:this._rawData.name,fields:[t]}],range:u},e);return this._option.globalScale.registerModelScale(h),{scale:h.id,field:t}}return null===(s=this._option)||void 0===s||s.onError("".concat(n," attribute is invalid.")),e},i.prototype.getSizeAttribute=function(t,e){return j(e)?10:Z(e)?e:Y(e)&&J(e)?parseFloat(e):this._getSeriesAttribute(t,e,{defaultScaleType:Fq,defaultRange:Oq},"size")},i.prototype.getShapeAttribute=function(t,e){return j(e)?zq:Y(e)?e:this._getSeriesAttribute(t,e,{defaultScaleType:Hq,defaultRange:jq},"shape")},i.prototype.initMark=function(){var t,e;this._symbolMark=this._createMark(i.mark.point,{groupKey:this._seriesField,isSeriesMark:!0,stateSort:null===(t=this._spec.point)||void 0===t?void 0:t.stateSort},{progressiveStep:this._spec.progressiveStep,progressiveThreshold:this._spec.progressiveThreshold,large:this._spec.large,largeThreshold:this._spec.largeThreshold,morph:fX(this._spec,i.mark.point.name),morphElementKey:this.getDimensionField()[0],setCustomizedShape:null===(e=this._spec.point)||void 0===e?void 0:e.customShape})},i.prototype.initMarkStyle=function(){this.initSymbolMarkStyle()},i.prototype.initAnimation=function(){var t,e,i,n=xX(this),r=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this._symbolMark.setAnimationConfig(cX(null===(i=kz.getAnimationInKey("scatter"))||void 0===i?void 0:i({},r),hX("point",this._spec,this._markAttributeContext),n))},i.prototype.initSymbolMarkStyle=function(){var t=this._symbolMark;t&&("zero"!==this._invalidType&&this.setMarkStyle(t,{visible:this._getInvalidDefined.bind(this)}),this.setMarkStyle(t,{x:this.dataToPositionX.bind(this),y:this.dataToPositionY.bind(this),z:this._fieldZ?this.dataToPositionZ.bind(this):null,fill:this.getColorAttribute(),size:Z(this._size)||H(this._size)?this._size:10,symbolType:Y(this._shape)||H(this._shape)?this._shape:zq},hU.STATE_NORMAL,CU.Series),(N(this._sizeField)||N(this._size))&&this.setMarkStyle(t,{size:this.getSizeAttribute(this._sizeField,this._size)},hU.STATE_NORMAL,CU.User_Mark),(N(this._shapeField)||N(this._shape))&&this.setMarkStyle(t,{symbolType:this.getShapeAttribute(this._shapeField,this._shape)},hU.STATE_NORMAL,CU.User_Mark))},i.prototype.initTooltip=function(){e.prototype.initTooltip.call(this),this._symbolMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._symbolMark)},i.prototype.viewDataStatisticsUpdate=function(t){var i=this;e.prototype.viewDataStatisticsUpdate.call(this,t);var n=[this.getDimensionField()[0],this.getStackValueField()].every((function(t){var e,n,r;return t&&(null===(r=null===(n=null===(e=i.getViewDataStatistics())||void 0===e?void 0:e.latestData)||void 0===n?void 0:n[t])||void 0===r?void 0:r.allValid)}));"zero"===this._invalidType||n?this.setMarkStyle(this._symbolMark,{visible:!0},"normal",CU.Series):this.setMarkStyle(this._symbolMark,{visible:this._getInvalidDefined.bind(this)},"normal",CU.Series),this._symbolMark.getProduct()&&this._symbolMark.compileEncode()},i.prototype.initLabelMarkStyle=function(t){var e=this;t&&(this._labelMark=t,this.setMarkStyle(t,{fill:this.getColorAttribute(),text:function(t){return t[e.getStackValueField()]},z:this._fieldZ?this.dataToPositionZ.bind(this):null},hU.STATE_NORMAL,CU.Series),"zero"!==this._invalidType&&this.setMarkStyle(t,{visible:this._getInvalidDefined.bind(this)},hU.STATE_NORMAL,CU.Series))},i.prototype.handleZoom=function(t){var e,i,n=this;this.getMarksWithoutRoot().forEach((function(t){var e=t.getProduct();e&&e.elements&&e.elements.length&&e.elements.forEach((function(t,e){var i=t.getGraphicItem(),r=t.getDatum(),a=n.dataToPosition(r);a&&i&&i.translateTo(a.x,a.y)}))}));var r=null===(i=null===(e=this._labelMark)||void 0===e?void 0:e.getComponent())||void 0===i?void 0:i.getProduct();r&&r.evaluate(null,null)},i.prototype.handlePan=function(t){this.handleZoom(t)},i.prototype.getDefaultShapeType=function(){return"circle"},i.prototype.getActiveMarks=function(){return[this._symbolMark]},i.type=t.SeriesTypeEnum.scatter,i.mark=Vq,i.transformerConstructor=Wq,i}(SX),Uq=function(){LX(),kz.registerAnimation("scatter",(function(t,e){return A({appear:Nq(0,e)},$Y)})),MK(),kK(),kz.registerSeries(Gq.type,Gq)},Yq=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["point","size","shape","shapeField","sizeField"])},e}(HK),Xq=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=Yq,i.type="scatter",i.seriesType=t.SeriesTypeEnum.scatter,i}return S(i,e),i.type="scatter",i.seriesType=t.SeriesTypeEnum.scatter,i.transformerConstructor=Yq,i}(OK);bt(Xq,WK);var Kq=function(){Uq(),kz.registerChart(Xq.type,Xq)};ka();var qq={},Zq=["clipAngle","clipExtent","scale","translate","center","rotate","precision","reflectX","reflectY","parallels","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function Jq(t,e){t&&Y(t)||Zk("Projection type must be a name string.");var i=t.toLowerCase();return arguments.length>1&&(qq[i]=function(t,e){return function i(){var n=e();return n.type=t,n.path=ka().projection(n),n.copy=n.copy||function(){var t=i();return Zq.forEach((function(e){n[e]&&t[e](n[e]())})),t.path.pointRadius(n.path.pointRadius()),t},n}}(i,e)),qq[i]||null}var Qq={albers:Na,albersusa:function(){var t,e,i,n,r,a,o=Na(),s=ja().rotate([154,0]).center([-2,58.5]).parallels([55,65]),l=ja().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u={point:function(t,e){a=[t,e]}};function c(t){var e=t[0],o=t[1];return a=null,i.point(e,o),a||(n.point(e,o),a)||(r.point(e,o),a)}function h(){return t=e=null,c}return c.invert=function(t){var e=o.scale(),i=o.translate(),n=(t[0]-i[0])/e,r=(t[1]-i[1])/e;return(r>=.12&&r<.234&&n>=-.425&&n<-.214?s:r>=.166&&r<.234&&n>=-.214&&n<-.115?l:o).invert(t)},c.stream=function(i){return t&&e===i?t:(n=[o.stream(e=i),s.stream(i),l.stream(i)],r=n.length,t={point:function(t,e){for(var i=-1;++i<r;)n[i].point(t,e)},sphere:function(){for(var t=-1;++t<r;)n[t].sphere()},lineStart:function(){for(var t=-1;++t<r;)n[t].lineStart()},lineEnd:function(){for(var t=-1;++t<r;)n[t].lineEnd()},polygonStart:function(){for(var t=-1;++t<r;)n[t].polygonStart()},polygonEnd:function(){for(var t=-1;++t<r;)n[t].polygonEnd()}});var n,r},c.precision=function(t){return arguments.length?(o.precision(t),s.precision(t),l.precision(t),h()):o.precision()},c.scale=function(t){return arguments.length?(o.scale(t),s.scale(.35*t),l.scale(t),c.translate(o.translate())):o.scale()},c.translate=function(t){if(!arguments.length)return o.translate();var e=o.scale(),a=+t[0],c=+t[1];return i=o.translate(t).clipExtent([[a-.455*e,c-.238*e],[a+.455*e,c+.238*e]]).stream(u),n=s.translate([a-.307*e,c+.201*e]).clipExtent([[a-.425*e+vn,c+.12*e+vn],[a-.214*e-vn,c+.234*e-vn]]).stream(u),r=l.translate([a-.205*e,c+.212*e]).clipExtent([[a-.214*e+vn,c+.166*e+vn],[a-.115*e-vn,c+.234*e-vn]]).stream(u),h()},c.fitExtent=function(t,e){return wa(c,t,e)},c.fitSize=function(t,e){return Ta(c,t,e)},c.fitWidth=function(t,e){return Ca(c,t,e)},c.fitHeight=function(t,e){return Ea(c,t,e)},c.scale(1070)},azimuthalequalarea:function(){return Oa(Ga).scale(124.75).clipAngle(179.999)},azimuthalequidistant:function(){return Oa(Ua).scale(79.4188).clipAngle(179.999)},conicconformal:function(){return za(qa).scale(109.5).parallels([30,30])},conicequalarea:ja,conicequidistant:function(){return za(Ja).scale(131.154).center([0,13.9389])},equalEarth:function(){return Oa(no).scale(177.158)},equirectangular:function(){return Oa(Za).scale(152.63)},gnomonic:function(){return Oa(ro).scale(144.049).clipAngle(60)},identity:function(){var t,e,i,n,r,a,o,s=1,l=0,u=0,c=1,h=1,d=0,p=null,f=1,v=1,g=Sa({point:function(t,e){var i=_([t,e]);this.stream.point(i[0],i[1])}}),y=xr;function m(){return f=s*c,v=s*h,a=o=null,_}function _(i){var n=i[0]*f,r=i[1]*v;if(d){var a=r*t-n*e;n=n*t+r*e,r=a}return[n+l,r+u]}return _.invert=function(i){var n=i[0]-l,r=i[1]-u;if(d){var a=r*t+n*e;n=n*t-r*e,r=a}return[n/f,r/v]},_.stream=function(t){return a&&o===t?a:a=g(y(o=t))},_.postclip=function(t){return arguments.length?(y=t,p=i=n=r=null,m()):y},_.clipExtent=function(t){return arguments.length?(y=null==t?(p=i=n=r=null,xr):br(p=+t[0][0],i=+t[0][1],n=+t[1][0],r=+t[1][1]),m()):null==p?null:[[p,i],[n,r]]},_.scale=function(t){return arguments.length?(s=+t,m()):s},_.translate=function(t){return arguments.length?(l=+t[0],u=+t[1],m()):[l,u]},_.angle=function(i){return arguments.length?(e=En(d=i%360*xn),t=Mn(d),m()):d*bn},_.reflectX=function(t){return arguments.length?(c=t?-1:1,m()):c<0},_.reflectY=function(t){return arguments.length?(h=t?-1:1,m()):h<0},_.fitExtent=function(t,e){return wa(_,t,e)},_.fitSize=function(t,e){return Ta(_,t,e)},_.fitWidth=function(t,e){return Ca(_,t,e)},_.fitHeight=function(t,e){return Ea(_,t,e)},_},mercator:function(){return Xa(Ya).scale(961/_n)},naturalEarth1:function(){return Oa(ao).scale(175.295)},orthographic:function(){return Oa(oo).scale(249.5).clipAngle(90+vn)},stereographic:function(){return Oa(so).scale(250).clipAngle(142)},transversemercator:function(){var t=Xa(lo),e=t.center,i=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?i([t[0],t[1],t.length>2?t[2]+90:90]):[(t=i())[0],t[1],t[2]-90]},i([0,0,90]).scale(159.155)}};Object.keys(Qq).forEach((function(t){Jq(t,Qq[t])}));var $q="Feature",tZ="FeatureCollection";function eZ(t){var e=xt(t);return 1===e.length?e[0]:{type:tZ,features:e.reduce((function(t,e){return t.concat(function(t){return t.type===tZ?t.features:xt(t).filter((function(t){return!j(t)})).map((function(t){return t.type===$q?t:{type:$q,geometry:t}}))}(e))}),[])}}var iZ=Zq.concat(["pointRadius","fit","extent","size"]);function nZ(t,e){var i=[];return t?(Object.keys(t).forEach((function(n){iZ.includes(n)&&(i=i.concat(lj(t[n],e)))})),i):i}var rZ,aZ=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[t])).grammarType="projection",i}return h(e,t),o(e,[{key:"parse",value:function(t){return y(e,"parse",this,3)([t]),this.pointRadius(t.pointRadius),this.size(t.size),this.extent(t.extent),this.fit(t.fit),this.configure(t),this.commit(),this}},{key:"pointRadius",value:function(t){return j(this.spec.pointRadius)||this.detach(lj(this.spec.pointRadius,this.view)),this.spec.pointRadius=t,this.attach(lj(t,this.view)),this.commit(),this}},{key:"size",value:function(t){return j(this.spec.size)||this.detach(lj(this.spec.size,this.view)),this.spec.size=t,this.attach(lj(t,this.view)),this.commit(),this}},{key:"extent",value:function(t){return j(this.spec.extent)||this.detach(lj(this.spec.extent,this.view)),this.spec.extent=t,this.attach(lj(t,this.view)),this.commit(),this}},{key:"fit",value:function(t){return j(this.spec.fit)||this.detach(lj(this.spec.fit,this.view)),this.spec.fit=t,this.attach(lj(t,this.view)),this.commit(),this}},{key:"configure",value:function(t){return this.detach(nZ(this.spec,this.view)),j(t)?this.spec={type:this.spec.type,fit:this.spec.fit,extent:this.spec.extent,size:this.spec.size,pointRadius:this.spec.pointRadius}:(Object.assign(this.spec,t),this.attach(nZ(this.spec,this.view))),this.commit(),this}},{key:"evaluate",value:function(t,e){var i,n,r=this;if(this.projection&&this.projection.type===this.spec.type||(this.projection=(i=this.spec.type,(n=Jq((i||"mercator").toLowerCase()))||Zk("Unrecognized projection type: "+i),n()),this.projection.type=this.spec.type),Zq.forEach((function(t){j(r.spec[t])||function(t,e,i){H(t[e])&&t[e](i)}(r.projection,t,cj(r.spec[t],e,Jq))})),j(this.spec.pointRadius)||this.projection.path.pointRadius(cj(this.spec.pointRadius,e,Jq)),!(j(this.spec.fit)||j(this.spec.extent)&&j(this.spec.size))){var a=eZ(cj(this.spec.fit,e,Jq));this.spec.extent?this.projection.fitExtent(cj(this.spec.extent,e,Jq),a):this.spec.size&&this.projection.fitSize(cj(this.spec.size,e,Jq),a)}return this.projection}},{key:"output",value:function(){return this.projection}}])}(Qj),oZ=function(t,e){if(!e.from||!e.from())return t;var i,n=e.fields,r=e.key,a=e.values,o=e.default,s=e.as||[n],l=e.from().reduce((function(t,e){return e[n]&&t.set(e[n],e),t}),new Map);if(H(e.set))i=function(t){var i=l.get(t[r]);e.set(t,i)};else if(a){var u=a.length;i=function(t){var e=l.get(t[r]);if(j(e))for(var i=0;i<u;++i)t[s[i]]=o;else for(i=0;i<u;++i)t[s[i]]=e[a[i]]}}else i=function(t){var e=l.get(t[r]);t[s[0]]=N(e)?e:o};return 0===t.length?[]:t.map((function(t){return i(t),t}))},sZ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.geo,i.coordinate="geo",i._nameProperty="name",i}return S(i,e),i.prototype.getMapViewData=function(){var t;return null===(t=this._mapViewData)||void 0===t?void 0:t.getDataView()},Object.defineProperty(i.prototype,"nameField",{get:function(){return this._nameField},set:function(t){this._nameField=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"valueField",{get:function(){return this._valueField},set:function(t){this._valueField=t},enumerable:!1,configurable:!0}),i.prototype.getNameProperty=function(){return this._nameProperty},i.prototype.getCentroidProperty=function(){return this._centroidProperty},i.prototype.getCoordinateHelper=function(){return this._coordinateHelper},i.prototype.setCoordinateHelper=function(t){this._coordinateHelper=t},i.prototype.getStatisticFields=function(){var t=[];return t.push({key:this._nameField,operations:["values"]}),t.push({key:this._valueField,operations:["max","min"]}),t},i.prototype.getGroupFields=function(){return null},i.prototype.dataToPosition=function(t,e){var i,n=null;if(!t)return n;if(e&&!this.isDatumInViewData(t))return n;var r=this._coordinateHelper,a=r.dataToPosition,o=r.latitudeField,s=r.longitudeField;if(null===(n=this.nameToPosition(t))){var l=s?null==t?void 0:t[s]:Number.NaN,u=o?null==t?void 0:t[o]:Number.NaN;n=null!==(i=null==a?void 0:a([l,u]))&&void 0!==i?i:null}return n},i.prototype.nameToPosition=function(t){var e=this.getDatumName(t);return j(e)?null:this.nameValueToPosition(e)},i.prototype.nameValueToPosition=function(t){var e,i,n=this,r=null===(i=null===(e=this.getMapViewData())||void 0===e?void 0:e.latestData)||void 0===i?void 0:i.filter((function(e){return n.getDatumName(e)===t}))[0];if(j(r))return null;var a=this._coordinateHelper.dataToPosition,o=this.getDatumCenter(r),s=null==a?void 0:a(o);return j(s)||isNaN(s.x)||isNaN(s.y)?null:s},i.prototype.dataToLatitude=function(t){return this._coordinateHelper?(0,this._coordinateHelper.dataToLatitude)(t):Number.NaN},i.prototype.dataToLongitude=function(t){return this._coordinateHelper?(0,this._coordinateHelper.dataToLatitude)(t):Number.NaN},i.prototype.valueToPosition=function(t,e){return{x:this.dataToLongitude(t),y:this.dataToLatitude(e)}},i.prototype.positionToData=function(t){},i.prototype.latitudeToData=function(t){},i.prototype.longitudeToData=function(t){},i.prototype.dataToPositionX=function(t){var e;return null===(e=this._option)||void 0===e||e.onError("Method not implemented."),0},i.prototype.dataToPositionY=function(t){var e;return null===(e=this._option)||void 0===e||e.onError("Method not implemented."),0},i.prototype.dataToPositionZ=function(t){var e;return null===(e=this._option)||void 0===e||e.onError("Method not implemented."),0},i.prototype.release=function(){e.prototype.release.call(this),this._mapViewData.release(),this._mapViewData=this._mapViewDataStatistics=null},i.prototype.getStackGroupFields=function(){return[this._nameField]},i.prototype.getStackValueField=function(){return this._spec.valueField},i.prototype.compileData=function(){var t;null===(t=this._mapViewData)||void 0===t||t.compile()},i.prototype.initStatisticalData=function(){if(e.prototype.initStatisticalData.call(this),this._mapViewData){var t="".concat(BF,"_series_").concat(this.id,"_mapViewDataStatic");this._mapViewDataStatistics=this.createStatisticalData(t,this._mapViewData.getDataView()),this._mapViewData.getDataView().target.removeListener("change",this._mapViewDataStatistics.reRunAllTransform)}},i.prototype.getSeriesKeys=function(){var t,e,i,n,r;return this._seriesField?null!==(r=null!==(e=null===(t=this.getRawDataStatisticsByField(this._seriesField))||void 0===t?void 0:t.values)&&void 0!==e?e:null===(n=null===(i=this._mapViewDataStatistics)||void 0===i?void 0:i.latestData[this._seriesField])||void 0===n?void 0:n.values)&&void 0!==r?r:[]:this.name?[this.name]:this.userId?["".concat(this.userId)]:["".concat(this.type,"_").concat(this.id)]},i.prototype.fillData=function(){var t,i;e.prototype.fillData.call(this),null===(t=this._mapViewData.getDataView())||void 0===t||t.reRunAllTransform(),null===(i=this._mapViewDataStatistics)||void 0===i||i.reRunAllTransform()},i.prototype.getActiveMarks=function(){return[]},i}(_X),lZ="".concat(BF,"_MAP_LOOK_UP_KEY"),uZ=function(t,e){return t.features&&t.features.forEach((function(t,i){var n;t[Uz]=i;var r=null===(n=t.properties)||void 0===n?void 0:n[e.nameProperty];e.nameMap&&e.nameMap[r]?t[lZ]=e.nameMap[r]:t[lZ]=r})),t.features},cZ=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dimensionTooltipTitleCallback=function(t){var i,n=e.series;return null!==(i=e._getDimensionData(t))&&void 0!==i?i:n.getDatumName(t)},e}return S(e,t),e}(PY),hZ=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return S(e,t),e.prototype._getDefaultStyle=function(){return A(A({},t.prototype._getDefaultStyle.call(this)),{lineWidth:0,path:""})},e.type="path",e}(aY),dZ=function(){kz.registerMark(hZ.type,hZ),JN()},pZ=A(A({},WY),((rZ={}).area={name:"area",type:"path"},rZ)),fZ=function(){function t(t){this.projection=Jq(t.type)()}return t.prototype.fit=function(t,e,i){var n={type:"FeatureCollection",features:i};this.projection.fitExtent([t,e],n)},t.prototype.center=function(t){var e,i;null===(i=null===(e=this.projection)||void 0===e?void 0:e.center)||void 0===i||i.call(e,t)},t.prototype.project=function(t){var e;return null===(e=this.projection)||void 0===e?void 0:e.call(this,t)},t.prototype.shape=function(t){var e,i;return null===(i=null===(e=this.projection)||void 0===e?void 0:e.path)||void 0===i?void 0:i.call(e,t)},t.prototype.invert=function(t){var e,i;return null===(i=null===(e=this.projection)||void 0===e?void 0:e.invert)||void 0===i?void 0:i.call(e,t)},t.prototype.scale=function(t){var e;if(null===(e=this.projection)||void 0===e?void 0:e.scale){if(void 0===t)return this.projection.scale();this.projection.scale(t)}},t.prototype.translate=function(t){var e;if(null===(e=this.projection)||void 0===e?void 0:e.scale){if(void 0===t)return this.projection.translate();this.projection.translate(t)}},t.prototype.evaluate=function(t,e,i){var n=this.projection.copy();return null==n?void 0:n.fitExtent([t,e],{type:"FeatureCollection",features:i})},t}(),vZ=function(){function t(){}return t.prototype.parserScrollEvent=function(t){return t?!(t.ctrlKey||0===t.deltaY&&0===t.deltaX)&&(t.scrollX=t.deltaX,t.scrollY=t.deltaY,t):t},t.prototype.parserZoomEvent=function(t){if(!t)return t;var e=Math.pow(1.0005,-t.deltaY*Math.pow(16,t.deltaMode));return t.zoomDelta=e,t.zoomX=t.canvasX,t.zoomY=t.canvasY,t},t.prototype.clearZoom=function(){},t.prototype.clearScroll=function(){},t.prototype.clearDrag=function(){},t}(),gZ=function(){function t(){this._lastScale=0}return t.prototype.clearZoom=function(){this._lastScale=0},t.prototype.parserZoomEvent=function(t){var e=t.scale;if(0===this._lastScale)return this._lastScale=e,t;t.zoomDelta=e/this._lastScale;var i=t.center;return t.zoomX=i.x,t.zoomY=i.y,this._lastScale=e,t},t.prototype.parserScrollEvent=function(t){return t},t.prototype.clearScroll=function(){},t.prototype.clearDrag=function(){},t}();function yZ(e){return e===t.RenderModeEnum["desktop-browser"]||e===t.RenderModeEnum["desktop-miniApp"]?{start:"pointerdown",move:"pointermove",end:["pointerup","pointerupoutside"],zoom:"wheel",zoomEnd:"pointerup",scroll:"wheel",trigger:vZ}:Nk(e)||Vk(e)?{start:"pointerdown",move:"pointermove",end:["pointerup","pointerupoutside","pointerleave"],zoom:"pinch",zoomEnd:"pinchend",scroll:"pan",scrollEnd:"panend",trigger:gZ}:null}var mZ={debounce:qt,throttle:Zt},_Z=function(){function e(){this._isGestureListener=!1}return e.prototype.initZoomable=function(e,i){void 0===i&&(i=t.RenderModeEnum["desktop-browser"]),this._eventObj=e,this._renderMode=i,this._gestureController=this._option.getChart().getVGrammarView().renderer._gestureController,this._isGestureListener=Nk(this._renderMode)||Vk(this._renderMode),yZ(this._renderMode)&&(this._clickEnable=!0,this._zoomableTrigger=new(this._getZoomTriggerEvent("trigger")))},e.prototype._getZoomTriggerEvent=function(t){return yZ(this._renderMode)[t]},e.prototype._zoomEventDispatch=function(t,e,i,n){if(this._isGestureListener||t.event){var r=this._isGestureListener?t:t.event.clone();this._zoomableTrigger.parserZoomEvent(r);var a=r,o=a.zoomDelta,s=a.zoomX,l=a.zoomY,u=a.path;if((n||u.some((function(t){return t.name&&t.name.includes("region")})))&&!j(o)&&Xe({x:s,y:l},this._getRegionOrSeriesLayout(e),!1)){this._clearDragEvent(),this._zoomableTrigger.clearScroll();var c={};i&&(c=i({zoomDelta:o,zoomX:s,zoomY:l},r)),this._eventObj.emit("zoom",A(A({scale:r.zoomDelta,scaleCenter:{x:r.zoomX,y:r.zoomY}},c),{model:this}))}}},e.prototype._getRegionOrSeriesLayout=function(t){"region"!==t.type&&(t=t.getRegion());var e=t.layout.getLayout(),i=e.x,n=e.y;return{x1:i,y1:n,x2:i+e.width,y2:n+e.height}},e.prototype._bindZoomEventAsRegion=function(t,e,i,n){var r,a,o,s,l=this,u=null!==(o=null==n?void 0:n.delayType)&&void 0!==o?o:"throttle",c=null!==(s=null==n?void 0:n.delayTime)&&void 0!==s?s:0,h=this._isGestureListener?this._gestureController:t,d=this._isGestureListener?[this._getZoomTriggerEvent("zoom")]:[this._getZoomTriggerEvent("zoom"),{level:dG.chart,consume:!0}],p=this._isGestureListener?[this._getZoomTriggerEvent("zoomEnd")]:[this._getZoomTriggerEvent("zoomEnd"),{level:dG.chart,consume:!1}];(r=h).on.apply(r,P(P([],E(p),!1),[mZ[u]((function(t){l._zoomableTrigger.clearZoom()}),c)],!1)),(a=h).on.apply(a,P(P([],E(d),!1),[mZ[u]((function(t){var r;l._zoomEventDispatch(t,e,i,null!==(r=null==n?void 0:n.allowComponentZoom)&&void 0!==r&&r)}),c)],!1))},e.prototype.initZoomEventOfSeries=function(t,e,i){this._option.disableTriggerEvent||yZ(this._renderMode)&&this._bindZoomEventAsRegion(t.event,t,e,i)},e.prototype.initZoomEventOfRegions=function(t,e,i,n){var r=this;this._option.disableTriggerEvent||yZ(this._renderMode)&&t.forEach((function(t){e?t.getSeries().forEach((function(t){e(t)&&r._bindZoomEventAsRegion(t.event,t,i,n)})):r._bindZoomEventAsRegion(r._eventObj,t,i,n)}))},e.prototype._scrollEventDispatch=function(t,e,i){var n=!1;if(!this._isGestureListener&&(!t.event||this._option.disableTriggerEvent))return n;var r=this._isGestureListener?t:t.event;this._zoomableTrigger.parserScrollEvent(r);var a=r,o=a.scrollX,s=a.scrollY,l=a.canvasX,u=a.canvasY;return j(o)&&j(s)?n:Xe({x:l,y:u},this._getRegionOrSeriesLayout(e),!1)?(this._clearDragEvent(),this._zoomableTrigger.clearZoom(),i&&(n=i({scrollX:o,scrollY:s},r)),this._eventObj.emit("scroll",{scrollX:o,scrollY:s,model:this}),n):n},e.prototype._bindScrollEventAsRegion=function(t,e,i,n){var r,a,o,s,l=this,u=null!==(o=null==n?void 0:n.delayType)&&void 0!==o?o:"throttle",c=null!==(s=null==n?void 0:n.delayTime)&&void 0!==s?s:0,h=this._isGestureListener?this._gestureController:t,d=this._isGestureListener?[this._getZoomTriggerEvent("scroll")]:[this._getZoomTriggerEvent("scroll"),{level:dG.chart,consume:!0}],p=this._isGestureListener?[this._getZoomTriggerEvent("scrollEnd")]:[this._getZoomTriggerEvent("scrollEnd"),{level:dG.chart,consume:!1}];(r=h).on.apply(r,P(P([],E(p),!1),[mZ[u]((function(t){l._zoomableTrigger.clearScroll()}),c)],!1)),(a=h).on.apply(a,P(P([],E(d),!1),[mZ[u]((function(t){return l._scrollEventDispatch(t,e,i)}),c)],!1))},e.prototype.initScrollEventOfSeries=function(t,e,i){yZ(this._renderMode)&&this._bindScrollEventAsRegion(t.event,t,e,i)},e.prototype.initScrollEventOfRegions=function(t,e,i,n){var r=this;this._option.disableTriggerEvent||yZ(this._renderMode)&&t.forEach((function(t){e?t.getSeries().forEach((function(t){e(t)&&r._bindScrollEventAsRegion(t.event,t,i,n)})):r._bindScrollEventAsRegion(r._eventObj,t,i,n)}))},e.prototype._bindDragEventAsRegion=function(t,e,i,n){var r=this;t.on(this._getZoomTriggerEvent("start"),{level:dG.chart},(function(t){if(t.event){var a=t.event;Xe({x:a.canvasX,y:a.canvasY},r._getRegionOrSeriesLayout(e),!1)&&r._handleDrag(t,i,n)}})),t.on("click",{level:dG.chart},(function(){return!r._clickEnable}))},e.prototype.initDragEventOfSeries=function(t,e,i){var n=this;this._option.disableTriggerEvent||yZ(this._renderMode)&&t.event.on(this._getZoomTriggerEvent("start"),{level:dG.model,filter:function(e){var i=e.model;return(null==i?void 0:i.id)===t.id}},(function(t){n._handleDrag(t,e,i)}))},e.prototype.initDragEventOfRegions=function(t,e,i,n){var r=this;this._option.disableTriggerEvent||yZ(this._renderMode)&&t.forEach((function(t){e?t.getSeries().forEach((function(t){e(t)&&(t.event.on(r._getZoomTriggerEvent("start"),{level:dG.model,filter:function(e){var i=e.model;return(null==i?void 0:i.id)===t.id}},(function(t){r._handleDrag(t,i)})),t.event.on("click",{level:dG.model,filter:function(e){var i=e.model;return(null==i?void 0:i.id)===t.id}},(function(){return!r._clickEnable})))})):r._bindDragEventAsRegion(r._eventObj,t,i,n)}))},e.prototype._clearDragEvent=function(){var t=this,e=this._getZoomTriggerEvent("move"),i=this._getZoomTriggerEvent("end");this._handleDragMouseMove&&(this._eventObj.off(e,{level:dG.chart,source:hG.chart},this._handleDragMouseMove),this._handleDragMouseMove=void 0),this._handleDragMouseUp&&(i.forEach((function(e){t._eventObj.off(e,{level:dG.chart,source:hG.chart},t._handleDragMouseUp),t._eventObj.allow(e)})),this._handleDragMouseUp=void 0)},e.prototype.isDragEnable=function(t){if(this._isGestureListener&&this._gestureController){var e=this._gestureController.cachedEvents;return!e||e.length<2}return!0},e.prototype._handleDrag=function(t,e,i){var n,r,a,o=this;if(this._clearDragEvent(),!this._option.disableTriggerEvent&&(this._clickEnable=!1,this.isDragEnable(t.event))){this._zoomableTrigger.clearZoom(),this._zoomableTrigger.clearScroll();var s=null!==(n=null==i?void 0:i.delayType)&&void 0!==n?n:"throttle",l=null!==(r=null==i?void 0:i.delayTime)&&void 0!==r?r:0,u=null===(a=null==i?void 0:i.realTime)||void 0===a||a,c=this._getZoomTriggerEvent("move"),h=this._getZoomTriggerEvent("end"),d=t.event,p=d.canvasX,f=d.canvasY,v=d.canvasX,g=d.canvasY;this._handleDragMouseUp=mZ[s]((function(t){o._clickEnable=!0;var i=t.event,n=[i.canvasX-v,i.canvasY-g];v=i.canvasX,g=i.canvasY,!u&&e&&e(n,t.event),o._eventObj.emit("panend",{delta:n,model:o}),o._clearDragEvent()}),l),this._handleDragMouseMove=mZ[s]((function(t){if(o.isDragEnable(t.event)){o._clickEnable=!1,h.forEach((function(t){o._eventObj.prevent(t,{handler:o._handleDragMouseUp,level:dG.chart})}));var i=t.event,n=[i.canvasX-p,i.canvasY-f];p=i.canvasX,f=i.canvasY,u&&e&&e(n,t.event),o._eventObj.emit("panmove",{delta:n,model:o})}}),l),this._eventObj.on(c,{level:dG.chart,source:hG.chart},this._handleDragMouseMove),h.forEach((function(t){o._eventObj.on(t,{level:dG.chart,source:hG.chart},o._handleDragMouseUp)}))}},e}();function bZ(t,e){return"".concat(BF,"_").concat(e,"_").concat(t)}var xZ=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=B.geoCoordinate,t.name=B.geoCoordinate,t.layoutType="none",t.layoutZIndex=wU.Mark,t._projectionSpec={name:bZ(t.type,t.id),type:"mercator"},t._actualScale=1,t._initialScale=1,t.effect={scaleUpdate:function(){t.coordinateHelper()}},t._handleChartZoom=function(e,i){var n,r,a,o,s,l,u=e.zoomDelta,c=t._actualScale;return t._actualScale*=u,t._actualScale<(null===(n=t._spec.zoomLimit)||void 0===n?void 0:n.min)?(t._actualScale=null===(r=t._spec.zoomLimit)||void 0===r?void 0:r.min,u=(null===(a=t._spec.zoomLimit)||void 0===a?void 0:a.min)/c):t._actualScale>(null===(o=t._spec.zoomLimit)||void 0===o?void 0:o.max)&&(t._actualScale=null===(s=t._spec.zoomLimit)||void 0===s?void 0:s.max,u=(null===(l=t._spec.zoomLimit)||void 0===l?void 0:l.max)/c),t.zoom(u,[e.zoomX,e.zoomY]),{scale:u,totalScale:t._actualScale}},t.pan=function(e){var i,n,r;void 0===e&&(e=[0,0]);var a=null!==(n=null===(i=t._projection)||void 0===i?void 0:i.translate())&&void 0!==n?n:[0,0],o=a[0],s=a[1];o+=e[0],s+=e[1],null===(r=t._projection)||void 0===r||r.translate([o,s])},t}return S(i,e),Object.defineProperty(i.prototype,"longitudeField",{get:function(){return this._longitudeField},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"latitudeField",{get:function(){return this._latitudeField},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"projectionSpec",{get:function(){return this._projectionSpec},enumerable:!1,configurable:!0}),i.prototype.setProjection=function(t){this._projectionSpec=A(A({},t),{name:this._projectionSpec.name})},i.prototype.getZoom=function(){return this._actualScale},i.getSpecInfo=function(t){if(j(t))return null;var e=[];return t.region.forEach((function(t,i){if("geo"===t.coordinate){var n=A(A({},t),{padding:0});e.push({spec:n,regionIndex:i,type:B.geoCoordinate,specInfoPath:["component","geoCoordinate",i]})}})),e},i.prototype.setAttrFromSpec=function(){var t,i,n;e.prototype.setAttrFromSpec.call(this),this._spec.roam&&this.initZoomable(this.event,this._option.mode),this._projectionSpec=xz(this._projectionSpec,this._spec.projection),this._projectionSpec.zoom>(null===(t=this._spec.zoomLimit)||void 0===t?void 0:t.max)&&(this._projectionSpec.zoom=this._spec.zoomLimit.max),this._projectionSpec.zoom<(null===(i=this._spec.zoomLimit)||void 0===i?void 0:i.min)&&(this._projectionSpec.zoom=this._spec.zoomLimit.min),this._actualScale=null!==(n=this._projectionSpec.zoom)&&void 0!==n?n:1,this._initialScale=this._actualScale,this._longitudeField=this._spec.longitudeField,this._latitudeField=this._spec.latitudeField},i.prototype.created=function(){e.prototype.created.call(this),this._regions=this._option.getRegionsInIndex([this._option.regionIndex]),this.initProjection(),this.coordinateHelper(),this.initEvent(),this._initCenterCache()},i.prototype.dispatchZoom=function(t,e){var i=e||{x:this.getLayoutStartPoint().x+this.getLayoutRect().width/2,y:this.getLayoutStartPoint().y+this.getLayoutRect().height/2},n=this._handleChartZoom({zoomDelta:t,zoomX:i.x,zoomY:i.y}),r=n.scale,a=n.totalScale;1!==r&&this.event.emit("zoom",{scale:r,scaleCenter:i,totalScale:a,model:this})},i.prototype.initEvent=function(){var t=this;this.event.on(cG.scaleUpdate,{filter:function(e){var i=e.model;return(null==i?void 0:i.id)===t.id}},this.effect.scaleUpdate.bind(this));var e=this._spec.roam;e&&(this.initZoomEventOfRegions(this._regions,null,this._handleChartZoom),this.initDragEventOfRegions(this._regions,e.blank?null:function(){return!0},this.pan),this._regions.forEach((function(t){t.getSeries().forEach((function(t){t.event.on("zoom",(function(e){return t.handleZoom(e),!0})),t.event.on("panmove",(function(e){return t.handlePan(e),!0}))}))})))},i.prototype.initProjection=function(){var t;this._projection=new fZ(this._projectionSpec),null!==this._projection.projection||null===(t=this._option)||void 0===t||t.onError("unsupported projection type!")},i.prototype.coordinateHelper=function(){var e=this,i={longitudeField:this._longitudeField,latitudeField:this._latitudeField,dataToPosition:this.dataToPosition.bind(this),dataToLongitude:this.dataToLongitude.bind(this),dataToLatitude:this.dataToLatitude.bind(this),shape:this.shape.bind(this),getCoordinateId:function(){return e.id}};this._regions.forEach((function(n){n.getSeries().forEach((function(n){n.type===t.SeriesTypeEnum.map||n.type===t.SeriesTypeEnum.pictogram?n.setCoordinateHelper(i):(n.setXAxisHelper(A(A({},i),{isContinuous:!0,dataToPosition:function(t,i){var r,a=t[0];if(j(a)&&(null==i?void 0:i.datum)){var o=i.datum[n.getDimensionField()[0]];a=null===(r=e._centerCache.get(o))||void 0===r?void 0:r.x}return e.dataToLongitude(a)},valueToPosition:function(t,i){var r;if(j(t)&&(null==i?void 0:i.datum)){var a=i.datum[n.getDimensionField()[0]];t=null===(r=e._centerCache.get(a))||void 0===r?void 0:r.x}return e.dataToLongitude(t)},getFields:function(){return[e._longitudeField]},getAxisType:function(){return e.type},getAxisId:function(){return e.id},isInverse:function(){return!1}})),n.setYAxisHelper(A(A({},i),{isContinuous:!0,dataToPosition:function(t,i){var r,a=t[0];if(j(a)&&(null==i?void 0:i.datum)){var o=i.datum[n.getDimensionField()[0]];a=null===(r=e._centerCache.get(o))||void 0===r?void 0:r.y}return e.dataToLatitude(a)},valueToPosition:function(t,i){var r;if(j(t)&&(null==i?void 0:i.datum)){var a=i.datum[n.getDimensionField()[0]];t=null===(r=e._centerCache.get(a))||void 0===r?void 0:r.y}return e.dataToLatitude(t)},getFields:function(){return[e._latitudeField]},getAxisType:function(){return e.type},getAxisId:function(){return e.id},isInverse:function(){return!1}})))}))}))},i.prototype.onLayoutEnd=function(i){this.setLayoutRect(this._regions[0].getLayoutRect()),this.setLayoutStartPosition(this._regions[0].getLayoutStartPoint());var n=this.getLayoutRect(),r=n.width,a=n.height,o=this.evaluateProjection([0,0],[r,a]),s=o.translate,l=o.scale,u=o.center;s&&this._projection.translate(s),l&&this._projection.scale(l),u&&this._projection.center(u),XO(this._regions,(function(e){var i,n;if(e.type===t.SeriesTypeEnum.map||e.type===t.SeriesTypeEnum.pictogram){null===(i=e.areaPath)||void 0===i||i.clear();var r=null===(n=e.getRootMark().getProduct())||void 0===n?void 0:n.getGroupGraphicItem();r&&r.attribute.postMatrix&&r.setAttributes({postMatrix:new vi})}})),this._actualScale=this._initialScale,e.prototype.onLayoutEnd.call(this,i)},i.prototype.onRender=function(t){},i.prototype.changeRegions=function(t){},i.prototype._getNeedClearVRenderComponents=function(){return[]},i.prototype.collectFeatures=function(){var e=[];return this._regions.forEach((function(i){i.getSeries().forEach((function(i){var n,r;i.type!==t.SeriesTypeEnum.map&&i.type!==t.SeriesTypeEnum.pictogram||e.push.apply(e,P([],E(null!==(r=null===(n=i.getMapViewData())||void 0===n?void 0:n.latestData)&&void 0!==r?r:[]),!1))}))})),e},i.prototype.dataToPosition=function(t){var e;void 0===t&&(t=[]);var i=null===(e=this._projection)||void 0===e?void 0:e.project([t[0],t[1]]);return{x:null==i?void 0:i[0],y:null==i?void 0:i[1]}},i.prototype.dataToLatitude=function(t){var e,i=null===(e=this._projection)||void 0===e?void 0:e.project([0,t]);return null==i?void 0:i[1]},i.prototype.dataToLongitude=function(t){var e,i=null===(e=this._projection)||void 0===e?void 0:e.project([t,0]);return null==i?void 0:i[0]},i.prototype.zoom=function(t,e){var i,n,r,a,o,s;void 0===e&&(e=[0,0]);var l=null!==(n=null===(i=this._projection)||void 0===i?void 0:i.scale())&&void 0!==n?n:0,u=null!==(a=null===(r=this._projection)||void 0===r?void 0:r.translate())&&void 0!==a?a:[0,0],c=u[0],h=u[1];l*=t,c-=(e[0]-c)*(t-1),h-=(e[1]-h)*(t-1),null===(o=this._projection)||void 0===o||o.scale(l),null===(s=this._projection)||void 0===s||s.translate([c,h])},i.prototype.shape=function(t){return this._projection.shape(t)},i.prototype.invert=function(t){return this._projection.invert(t)},i.prototype.evaluateProjection=function(t,e){var i,n=this._projection.evaluate(t,e,this.collectFeatures()),r=n.translate(),a=n.scale()*this._initialScale,o=null!==(i=this._projectionSpec.center)&&void 0!==i?i:n.invert([e[0]/2,e[1]/2]);return o&&(r=[e[0]/2,e[1]/2]),{translate:r,scale:a,center:o}},i.prototype._initCenterCache=function(){var t=this;this._centerCache||(this._centerCache=new Map),this._regions.forEach((function(e){e.getSeries().forEach((function(e){var i,n;"map"===e.type&&(null!==(n=null===(i=e.getMapViewData())||void 0===i?void 0:i.latestData)&&void 0!==n?n:[]).forEach((function(i){void 0===i&&(i={});var n=i[e.getDimensionField()[0]]||i[lZ],r=e.getDatumCenter(i);n&&N(r)&&t._centerCache.set(n,{x:r[0],y:r[1]})}))}))}))},i.prototype._compareSpec=function(t,i){var n=e.prototype._compareSpec.call(this,t,i);return n.reMake||(n.reMake=["roam","longitudeField","latitudeField","projection","zoomLimit"].some((function(e){return!mt(null==i?void 0:i[e],t[e])}))),n},i.prototype.release=function(){e.prototype.release.call(this),this._centerCache&&this._centerCache.clear(),this._centerCache=null},i.type=B.geoCoordinate,i}(rK);bt(xZ,_Z);var kZ=function(){kz.registerComponent(xZ.type,xZ)},SZ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"area",void 0,void 0,!1)},e}(mX),AZ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.map,i.transformerConstructor=SZ,i._areaCache=new Map,i}return S(i,e),i.prototype.getNameMap=function(){return this._nameMap},Object.defineProperty(i.prototype,"areaPath",{get:function(){return this._areaCache},enumerable:!1,configurable:!0}),i.prototype.setAttrFromSpec=function(){var t,i;e.prototype.setAttrFromSpec.call(this),this.map=this._spec.map,this._nameMap=this._spec.nameMap,this._nameField=this._spec.nameField,this._valueField=this._spec.valueField,this._spec.nameProperty&&(this._nameProperty=this._spec.nameProperty),this._spec.centroidProperty&&(this._centroidProperty=this._spec.centroidProperty),this.map||null===(t=this._option)||void 0===t||t.onError("map type '".concat(this.map,"' is not specified !")),QG.get(this.map)||null===(i=this._option)||void 0===i||i.onError("'".concat(this.map,"' data is not registered !"))},i.prototype.initData=function(){var t,i,n=this;e.prototype.initData.call(this),qG(this._dataSet,"copyDataView",oU),qG(this._dataSet,"map",uZ),qG(this._dataSet,"lookup",oZ);var r=QG.get(this.map);r||null===(t=this._option)||void 0===t||t.onError("no valid map data found!");var a=new Ms(this._dataSet,{name:"map_".concat(this.id,"_data")});a.parse([r],{type:"dataview"}).transform({type:"copyDataView",options:{deep:!0},level:nU.copyDataView}).transform({type:"map",options:{nameMap:this._nameMap,nameProperty:this._nameProperty}}).transform({type:"lookup",options:{from:function(){var t;return null===(t=n._data)||void 0===t?void 0:t.getLatestData()},key:lZ,fields:this._nameField,set:function(t,e){e&&Object.keys(e).forEach((function(i){i in t||(t[i]=e[i])}))}}}),null===(i=this._data)||void 0===i||i.getDataView().target.addListener("change",a.reRunAllTransform),this._mapViewData=new DY(this._option,a)},i.prototype.compileData=function(){var t;e.prototype.compileData.call(this),null===(t=this._mapViewData)||void 0===t||t.compile()},i.prototype.initMark=function(){this._pathMark=this._createMark(i.mark.area,{groupKey:this.getDimensionField()[0],isSeriesMark:!0,skipBeforeLayouted:!0,dataView:this._mapViewData.getDataView(),dataProductId:this._mapViewData.getProductId()},{morph:fX(this._spec,i.mark.area.name),morphElementKey:this.getDimensionField()[0]})},i.prototype.initMarkStyle=function(){var t=this,e=this._pathMark;e&&(this.setMarkStyle(e,{fill:function(e){var i,n,r,a;return N(e[null!==(i=t._seriesField)&&void 0!==i?i:Xz])?(null!==(n=t._option.globalScale.getScale("color"))&&void 0!==n?n:t._getDefaultColorScale()).scale(e[null!==(r=t._seriesField)&&void 0!==r?r:Xz]):null===(a=t._spec)||void 0===a?void 0:a.defaultFillColor},path:this.getPath.bind(this)},"normal",CU.Series),e.setPostProcess("fill",(function(e){return N(e)?e:t._spec.defaultFillColor})),this.setMarkStyle(e,{smoothScale:!0},"normal",CU.Built_In))},i.prototype.initLabelMarkStyle=function(t){var e=this;t&&(this._labelMark=t,this.setMarkStyle(t,{text:function(t){return e.getDatumName(t)},x:function(t){var i;return null===(i=e.dataToPosition(t))||void 0===i?void 0:i.x},y:function(t){var i;return null===(i=e.dataToPosition(t))||void 0===i?void 0:i.y}}))},i.prototype.initAnimation=function(){var t;this._pathMark.setAnimationConfig(cX(null===(t=kz.getAnimationInKey("fadeInOut"))||void 0===t?void 0:t(),hX("area",this._spec,this._markAttributeContext)))},i.prototype.initTooltip=function(){this._tooltipHelper=new cZ(this),this._pathMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._pathMark)},i.prototype.getPath=function(t){var e,i=this._areaCache.get(t[Uz]);if(i)return i.shape;var n=null===(e=this._coordinateHelper)||void 0===e?void 0:e.shape(t);return this._areaCache.set(t[Uz],{shape:n}),n},i.prototype.onEvaluateEnd=function(){this._mapViewData.updateData()},i.prototype.getDimensionField=function(){return[this.nameField]},i.prototype.getMeasureField=function(){return[this.valueField]},i.prototype.release=function(){e.prototype.release.call(this),this._areaCache.clear(),this._nameMap={},this._mapViewData=null},i.prototype.handleZoom=function(t){var e,i,n,r=t.scale,a=t.scaleCenter;if(1!==r){var o=null===(e=this.getRootMark().getProduct())||void 0===e?void 0:e.getGroupGraphicItem();o&&(o.attribute.postMatrix||o.setAttributes({postMatrix:new vi}),o.scale(r,r,a));var s=null===(n=null===(i=this._labelMark)||void 0===i?void 0:i.getComponent())||void 0===n?void 0:n.getProduct();s&&s.evaluate(null,null)}},i.prototype.handlePan=function(t){var e,i,n,r=t.delta;if(0!==r[0]||0!==r[1]){var a=null===(e=this.getRootMark().getProduct())||void 0===e?void 0:e.getGroupGraphicItem();a&&(a.attribute.postMatrix||a.setAttributes({postMatrix:new vi}),a.translate(r[0],r[1]));var o=null===(n=null===(i=this._labelMark)||void 0===i?void 0:i.getComponent())||void 0===n?void 0:n.getProduct();o&&o.evaluate(null,null)}},i.prototype.getDatumCenter=function(t){var e,i,n,r;return this._centroidProperty&&(null===(e=t.properties)||void 0===e?void 0:e[this._centroidProperty])?null===(i=t.properties)||void 0===i?void 0:i[this._centroidProperty]:Q(t.centroidX*t.centroidY)?[t.centroidX,t.centroidY]:(null===(n=t.properties)||void 0===n?void 0:n.center)?t.properties.center:(null===(r=t.properties)||void 0===r?void 0:r.centroid)?t.properties.centroid:[Number.NaN,Number.NaN]},i.prototype.getDatumName=function(t){var e;if(t[this.nameField])return t[this.nameField];var i=null===(e=t.properties)||void 0===e?void 0:e[this._nameProperty];if(i){if(this._spec.nameMap&&this._spec.nameMap[i])return this._spec.nameMap[i];if(this._spec.showDefaultName||!this._spec.nameMap)return i}return""},i.prototype.dataToPositionX=function(t){var e;return null===(e=this._option)||void 0===e||e.onError("Method not implemented."),0},i.prototype.dataToPositionY=function(t){var e;return null===(e=this._option)||void 0===e||e.onError("Method not implemented."),0},i.prototype.viewDataUpdate=function(t){var i,n,r;e.prototype.viewDataUpdate.call(this,t),null===(n=null===(i=this._mapViewData)||void 0===i?void 0:i.getDataView())||void 0===n||n.reRunAllTransform(),null===(r=this._mapViewData)||void 0===r||r.updateData()},i.prototype._getDataIdKey=function(){return Uz},i.prototype.getActiveMarks=function(){return[this._pathMark]},i.type=t.SeriesTypeEnum.map,i.mark=pZ,i.transformerConstructor=SZ,i}(sZ),MZ=function(){xj.registerGrammar("projection",aZ,"projections"),kZ(),dZ(),kz.registerSeries(AZ.type,AZ),kz.registerImplement("registerMap",tU),kz.registerImplement("unregisterMap",eU),iX()},wZ="".concat(BF,"_waterfall_default_seriesField"),TZ=function(t,e){if(!t||0===t.length)return t;var i=e.indexField,n=e.total,r=e.groupData,a=[],o=r().latestData,s=o.dimensionValues,l=o.dimensionData,u=Array.from(s[i]),c={start:0,end:0,positive:0,negative:0,lastIndex:null};return u.forEach((function(t,i){var r={start:c.end,end:c.end,lastIndex:c.lastIndex,lastEnd:c.end,index:t,isTotal:!1,positive:c.end,negative:c.end},o=!0===e.stackInverse?l[t].reverse():l[t];if(null==o||o.forEach((function(t,e){e===o.length-1?t[rH]=!0:delete t[rH]})),o.length>1){var s=function(t){if(n&&"end"!==n.type){if("field"===n.type||"custom"===n.type){return!!t[n.tagField]}}else if(i===u.length-1)return!0;return!1};if(o.some((function(t){return s(t)})))return c=function(t,e,i,n,r,a,o,s,l){i.isTotal=!0;var u=s.valueField,c=s.startAs,h=s.endAs,d=s.total,p=[],f=[];if(t.forEach((function(t){l(t)?f.push(t):p.push(t)})),f.length===t.length){var v=CZ([t[0]],e,i,n,r,a,o,s);return f.forEach((function(e){e[c]=t[0][c],e[h]=t[0][h],e[u]=t[0][u]})),v}var g=EZ(f[0],i,n,r,d),y=g.start,m=g.end;i.start=y,i.end=m;var _=y,b=y,x=m-y;return p.forEach((function(t){var e=+t[u];e>=0?(t[c]=+_,_=ke(_,e)):(t[c]=+b,b=ke(b,e)),t[h]=ke(t[c],e),y=ke(y,e),x=Se(x,e)})),f.forEach((function(t){t[c]=+y,t[h]=ke(t[c],x),t[u]=x})),A(A({},i),{lastIndex:e})}(o,t,r,a,c,u,i,e,s),void a.push(r)}c=CZ(o,t,r,a,c,u,i,e),a.push(r)})),a};function CZ(t,e,i,n,r,a,o,s){var l=s.valueField,u=s.startAs,c=s.endAs,h=s.total,d=s.seriesField,p=s.seriesFieldName;return t.forEach((function(t){var e=!1;if(h&&"end"!==h.type){if("field"===h.type||"custom"===h.type){if(t[h.tagField]){e=!0;var s=EZ(t,i,n,r,h),f=s.start,v=s.end;t[u]=f,t[c]=v,t[l]=v-f,i.start=f,i.end=v}}}else o===a.length-1&&(i.start=0,t[u]=i.start,t[c]=i.end,e=!0);if(!e){var g=+t[l];g>=0?(t[u]=+i.positive,i.positive=ke(i.positive,g)):(t[u]=+i.negative,i.negative=ke(i.negative,g)),t[c]=ke(t[u],g),i.end=ke(i.end,g)}i.isTotal=e,(j(d)||d===wZ)&&(t[wZ]=e?p.total:+t[l]>=0?p.increase:p.decrease)})),A(A({},i),{lastIndex:e})}function EZ(t,e,i,n,r){return r&&"end"!==r.type?"field"===r.type||"custom"===r.type?"custom"===r.type?function(t,e,i){return i.product(t,e)}(t,n,r):r.collectCountField&&!j(t[r.collectCountField])?function(t,e,i,n){var r=0,a=i.end,o=e.length-+t[n.collectCountField],s=e.length-1;o<0?Dk("total.collectCountField error"):r=e[o].start;s<0?Dk("total.collectCountField error"):a=e[s].end;return{start:r,end:a}}(t,i,e,r):function(t,e,i){var n=0,r=e.end;i.startField&&!j(t[i.startField])&&(n=+t[i.startField]);i.valueField&&!j(t[i.valueField])&&(r=ke(n,+t[i.valueField]));return{start:n,end:r}}(t,e,r):{start:0,end:0}:function(t){return{start:0,end:t.end}}(e)}var PZ=function(t,e){var i;if(!t)return t;var n=e.indexField,r=e.valueField,a=e.total,o=e.seriesField,s=((i={})[n]=(null==a?void 0:a.text)||"total",i[r]=t.reduce((function(t,e){return ke(t,+e[r])}),0),i);return o&&(s[o]="total"),t.push(s),t},RZ={type:"fadeIn"},BZ={type:"growCenterIn"};function IZ(t,e){switch(e){case"fadeIn":return RZ;case"scaleIn":return BZ;default:return aq(t,!1)}}var LZ,DZ=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return S(e,t),e.prototype._getDefaultStyle=function(){return A(A({},t.prototype._getDefaultStyle.call(this)),{x1:0,y1:0})},e.type="rule",e}(aY),OZ=function(){kz.registerMark(DZ.type,DZ),$N()},FZ=A(A({},fq),((LZ={}).leaderLine={name:"leaderLine",type:"rule"},LZ.stackLabel={name:"stackLabel",type:"text"},LZ)),zZ=function(t,e){if(!e.fields)return t;var i={};return{dimensionValues:i,dimensionData:HZ(t.map((function(t){return t.latestData})).flat(),e.fields,i)}};function HZ(t,e,i){if(0===e.length)return t;var n=e[0],r=e.slice(1);i[n]=new Set;var a,o,s=function(t,e,i){var n={};return t.forEach((function(t){var r=t[e];n[r]||(n[r]=[],i.add(r)),n[r].push(t)})),n}(t,n,i[n]);return r.length?(a=s,o=function(t,e){return HZ(t,r,i)},Object.keys(a).reduce((function(t,e){return t[e]=o(a[e],e),t}),{})):s}var jZ=function(){function t(t){this._fields=[],this._fields=t}return Object.defineProperty(t.prototype,"fields",{get:function(){return this._fields},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"groupData",{get:function(){return this._groupData},enumerable:!1,configurable:!0}),t.prototype.initData=function(t,e){var i=t.name,n=new Ms(e instanceof Ss?e:t.dataSet);n.name=i,n.parse([t],{type:"dataview"}),qG(e,"dimensionTree",zZ),n.transform({type:"dimensionTree",options:{fields:this._fields}},!1),n.target.addListener("change",this.groupDataUpdate.bind(this)),this._groupData=n},t.prototype.groupDataUpdate=function(){},t.prototype.getGroupValueInField=function(t){var e,i,n,r=null===(n=null===(i=null===(e=this.groupData)||void 0===e?void 0:e.latestData)||void 0===i?void 0:i.dimensionValues)||void 0===n?void 0:n[t];return r?Array.from(r):[]},t}(),NZ=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._supportStack=!1,e}return S(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"bar"),this._addMarkLabelSpec(t,"bar","stackLabel","initStackLabelMarkStyle")},e}(mq),VZ={rect:XZ,symbol:YZ,arc:qZ,point:function(t){var e;e=!1!==t.labelSpec.overlap&&{avoidBaseMark:!1};return{position:"center",overlap:e}},"line-data":function(t){var e=YZ(t);z(e.overlap)||(e.overlap.avoidBaseMark=!1);return e},stackLabel:ZZ,line:JZ,area:JZ,rect3d:XZ,arc3d:qZ,treemap:function(t){return{customLayoutFunc:function(t,e){return e},overlap:!1}},venn:function(t){return{customLayoutFunc:function(t,e){return e},smartInvert:!0}}};function WZ(e,i){var n,r=i.labelSpec;r.overlap&&!V(r.overlap)&&(r.overlap={});var a=null!==(n=VZ[e])&&void 0!==n?n:VZ.point;return i.series.type===t.SeriesTypeEnum.sankey?function(t){var e,i,n,r,a=t.series,o=t.labelSpec,s=void 0===o?{}:o,l=null!==(e=UZ(s.position))&&void 0!==e?e:"outside",u=a.direction,c=l;Y(l)&&("vertical"===u?c="inside-start"===l?function(t){return"inside-left"}:"inside-middle"===l?function(t){return"center"}:"inside-end"===l?function(t){return"inside-right"}:function(t){return"bottom"}:"inside-start"===l?c=function(t){return"inside-left"}:"inside-middle"===l?c=function(t){return"center"}:"inside-end"===l?c=function(t){return"inside-right"}:"outside"===l&&(c=function(t){return"right"}));r=!1!==s.overlap&&((!Y(l)||!l.includes("inside"))&&{strategy:null!==(n=null===(i=s.overlap)||void 0===i?void 0:i.strategy)&&void 0!==n?n:QZ(a)});return{position:c,overlap:r,smartInvert:!1,offset:0,syncState:!0}}(i):a(i)}function GZ(e,i,n,r){var a,o,s,l=e.labelMark,u=e.series,c={text:i[u.getMeasureField()[0]],data:i,textType:null!==(s=e.labelSpec.textType)&&void 0!==s?s:"text"},h=Object.keys(l.stateStyle.normal);try{for(var d=C(h),p=d.next();!p.done;p=d.next()){var f=p.value,v=l.getAttribute(f,i);c[f]=v}}catch(t){a={error:t}}finally{try{p&&!p.done&&(o=d.return)&&o.call(d)}finally{if(a)throw a.error}}if(u.type!==t.SeriesTypeEnum.sankey){var g=xY(n,r,c.text,i),y=g.formatFunc,m=g.args;y&&(c._originText=c.text,c.text=y.apply(void 0,P(P([],E(m),!1),[{series:u}],!1)))}return c}function UZ(t){return H(t)?function(e){return t(e.data)}:t}function YZ(t){var e,i,n,r=t.series,a=t.labelSpec,o="horizontal"===r.direction?"right":"top",s=null!==(e=UZ(a.position))&&void 0!==e?e:o;return{position:s,overlap:!1!==a.overlap&&{strategy:null!==(n=null===(i=a.overlap)||void 0===i?void 0:i.strategy)&&void 0!==n?n:([{type:"position",position:["top","bottom","right","left","top-right","top-left","bottom-left","bottom-right"]}],[{type:"position",position:["top","bottom","right","left","top-right","top-left","bottom-left","bottom-right"]}]),avoidBaseMark:"center"!==s}}}function XZ(t){var e,i,n,r,a,o,s,l,u=t.series,c=t.labelSpec,h=void 0===c?{}:c,d=null!==(e=UZ(h.position))&&void 0!==e?e:"outside",p=null!==(i=u.direction)&&void 0!==i?i:"vertical",f="horizontal"===u.direction?null===(n=u.getXAxisHelper())||void 0===n?void 0:n.isInverse():null===(r=u.getYAxisHelper())||void 0===r?void 0:r.isInverse();s=function(t){var e,i=t.data,n=null!==(e="function"==typeof h.position?h.position(i):h.position)&&void 0!==e?e:"outside";if("outside"===n){var r=u.getMeasureField()[0],a=(null==i?void 0:i[r])>=0&&f||(null==i?void 0:i[r])<0&&!f?1:0;return{vertical:["top","bottom"],horizontal:["right","left"]}[p][a]}return n},l=!1!==h.overlap&&{strategy:null!==(o=null===(a=h.overlap)||void 0===a?void 0:a.strategy)&&void 0!==o?o:KZ(u)};var v=!1;return Y(d)&&d.includes("inside")&&(v=!0),{position:s,overlap:l,smartInvert:v}}function KZ(t){var e=[{type:"position",position:function(e){var i,n,r=e.data,a=t.getMeasureField()[0];return("horizontal"===t.direction?null===(i=t.getXAxisHelper())||void 0===i?void 0:i.isInverse():null===(n=t.getYAxisHelper())||void 0===n?void 0:n.isInverse())?(null==r?void 0:r[a])>=0?"horizontal"===t.direction?["left","inside-left"]:["bottom","inside-bottom"]:"horizontal"===t.direction?["right","inside-right"]:["top","inside-top"]:(null==r?void 0:r[a])>=0?"horizontal"===t.direction?["right","inside-right"]:["top","inside-top"]:"horizontal"===t.direction?["left","inside-left"]:["bottom","inside-bottom"]}}];return e}function qZ(t){var e,i=t.labelSpec,n=null!==(e=UZ(i.position))&&void 0!==e?e:"outside";return{position:n,smartInvert:i.smartInvert?i.smartInvert:Y(n)&&n.includes("inside")}}function ZZ(t,e,i){var n=t.series,r=t.labelSpec||{},a=n.getTotalData();return{customLayoutFunc:function(a){return a.map((function(a){var o=r.position||"withChange",s=r.offset||0,l=e?e(a.data):a.data,u=GZ(t,l,r.formatMethod);return u.x=function(t,e,i,n){return"horizontal"===e.direction?"middle"===i?.5*(e.totalPositionX(t,"end")+e.totalPositionY(t,"start")):"max"===i?e.totalPositionX(t,t.end>=t.start?"end":"start")+n:"min"===i?e.totalPositionX(t,t.end>=t.start?"start":"end")-n:e.totalPositionX(t,"end")+(t.end>=t.start?n:-n):e.totalPositionX(t,"index",.5)}(l,n,o,s),u.y=function(t,e,i,n){return"horizontal"===e.direction?e.totalPositionY(t,"index",.5):"middle"===i?.5*(e.totalPositionY(t,"end")+e.totalPositionY(t,"start")):"max"===i?e.totalPositionY(t,t.end>=t.start?"end":"start")-n:"min"===i?e.totalPositionY(t,t.end>=t.start?"start":"end")+n:e.totalPositionY(t,"end")+(t.end>=t.start?-n:n)}(l,n,o,s),"horizontal"===n.direction?u.textAlign="middle"===o?"center":"withChange"===o&&l.end-l.start>=0||"max"===o?"left":"right":u.textBaseline="middle"===o?o:"withChange"===o&&l.end-l.start>=0||"max"===o?"bottom":"top",null==i||i(a,l,u),zg(A(A({},u),{id:a.id}))}))},dataFilter:function(t){var e=[];return a.forEach((function(i){var r=t.find((function(t){var e;return i.index===(null===(e=t.data)||void 0===e?void 0:e[n.getDimensionField()[0]])}));r&&(r.data=i,e.push(r))})),e},overlap:{strategy:[]}}}function JZ(t){var e,i,n,r,a,o=t.labelSpec,s=t.series,l=null===(r=null===(n=null===(i=s.getViewDataStatistics)||void 0===i?void 0:i.call(s).latestData)||void 0===n?void 0:n[s.getSeriesField()])||void 0===r?void 0:r.values,u=l?l.map((function(t,e){var i;return(i={})[s.getSeriesField()]=t,i.index=e,i})):[(e={index:0},e[Xz]=s.getSeriesKeys()[0],e)];return{position:null!==(a=o.position)&&void 0!==a?a:"end",data:u}}function QZ(t){return[{type:"position",position:function(e){return"horizontal"===t.direction?["right","left"]:["bottom","top"]}}]}var $Z,tJ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.waterfall,i.transformerConstructor=NZ,i._leaderLineMark=null,i._stackLabelMark=null,i._labelMark=null,i}return S(i,e),i.prototype.getTotalData=function(){var t;return null===(t=this._totalData)||void 0===t?void 0:t.getLatestData()},i.prototype.initGroups=function(){var t=this.getGroupFields();t&&t.length&&(this._groups=new jZ(t),this._data&&this._groups.initData(this._data.getDataView(),this._dataSet))},i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),this.setValueFieldToStack(),this._fieldX=[this._fieldX[0]],this._fieldY=[this._fieldY[0]],j(this._seriesField)&&(this._seriesField=wZ)},i.prototype.getSeriesKeys=function(){return this._seriesField===wZ?[this._theme.seriesFieldName.increase,this._theme.seriesFieldName.decrease,this._theme.seriesFieldName.total]:e.prototype.getSeriesKeys.call(this)},i.prototype.initData=function(){var t,i=this;e.prototype.initData.call(this),qG(this._dataSet,"waterfallFillTotal",PZ),qG(this._dataSet,"waterfall",TZ),(j(this._spec.total)||"end"===this._spec.total.type)&&(null===(t=this._rawData)||void 0===t||t.transform({type:"waterfallFillTotal",options:{indexField:this.getGroupFields()[0],valueField:this.getStackValueField(),seriesField:this.getSeriesField(),seriesFieldName:this._theme.seriesFieldName,total:this._spec.total,stackInverse:this.getRegion().getStackInverse()}},!1));var n=sU(this.getViewData(),this._dataSet,{name:"".concat(BF,"_series_").concat(this.id,"_totalData")});this.getViewData().target.removeListener("change",n.reRunAllTransform),this._totalData=new DY(this._option,n),n.transform({type:"waterfall",options:{indexField:this.getGroupFields()[0],valueField:this.getStackValueField(),seriesField:this.getSeriesField(),seriesFieldName:this._theme.seriesFieldName,startAs:Zz,endAs:Jz,total:this._spec.total,groupData:function(){return i.getGroups().groupData},stackInverse:this.getRegion().getStackInverse()}},!1)},i.prototype.compileData=function(){var t;e.prototype.compileData.call(this),null===(t=this._totalData)||void 0===t||t.compile()},i.prototype.initAnimation=function(){var t,e,i,n,r=this,a={yField:"horizontal"===this.direction?this._fieldY[0]:this.getStackValueField(),xField:"horizontal"===this.direction?this.getStackValueField():this._fieldX[0],direction:this.direction,growFrom:function(){var t,e;return"horizontal"===r.direction?null===(t=r._xAxisHelper)||void 0===t?void 0:t.getScale(0).scale(0):null===(e=r._yAxisHelper)||void 0===e?void 0:e.getScale(0).scale(0)}},o=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset,s=xX(this);this._barMark.setAnimationConfig(cX(null===(i=kz.getAnimationInKey("waterfall"))||void 0===i?void 0:i(a,o),hX("bar",this._spec,this._markAttributeContext),s)),this._leaderLineMark&&this._leaderLineMark.setAnimationConfig(cX(null===(n=kz.getAnimationInKey("fadeInOut"))||void 0===n?void 0:n(),hX("leaderLine",this._spec,this._markAttributeContext)))},i.prototype.viewDataUpdate=function(t){this._totalData.getDataView().reRunAllTransform(),this._totalData.updateData(),e.prototype.viewDataUpdate.call(this,t)},i.prototype.addViewDataFilter=function(t){},i.prototype.reFilterViewData=function(){},i.prototype.onEvaluateEnd=function(t){e.prototype.onEvaluateEnd.call(this,t),this._totalData.updateData()},i.prototype.initMark=function(){var t,n;e.prototype.initMark.call(this);var r=this._createMark(i.mark.leaderLine,{key:"index",stateSort:null===(t=this._spec.leaderLine)||void 0===t?void 0:t.stateSort},{setCustomizedShape:null===(n=this._spec.leaderLine)||void 0===n?void 0:n.customShape});r&&(this._leaderLineMark=r,r.setDataView(this._totalData.getDataView(),this._totalData.getProductId()))},i.prototype.initLabelMarkStyle=function(t){var i;if(t)return!this._labelMark&&(null===(i=this._spec.label)||void 0===i?void 0:i.visible)?(e.prototype.initLabelMarkStyle.call(this,t),void(this._labelMark=t)):void 0},i.prototype.initStackLabelMarkStyle=function(t){var e=this;t&&(this._stackLabelMark=t,t.skipEncode=!0,t.setRule("stackLabel"),t.setDataView(this._totalData.getDataView(),this._totalData.getProductId()),this.setMarkStyle(t,{text:function(t){var i;return"absolute"===(null===(i=e._spec.stackLabel)||void 0===i?void 0:i.valueType)?t.end:Se(t.end,t.start)}}))},i.prototype.initTotalLabelMarkStyle=function(t){var e=this;this.setMarkStyle(t,{text:function(t){var i;return"end"in t?"absolute"===(null===(i=e._spec.totalLabel)||void 0===i?void 0:i.valueType)?t.end:Se(t.end,t.start):"horizontal"===e.direction?t[e._fieldX[0]]:t[e._fieldY[0]]}})},i.prototype.getTotalLabelComponentStyle=function(t){var e=this;return ZZ(A(A({},t),{series:this,labelSpec:this._spec.totalLabel}),(function(t){var i="vertical"===e.direction?t[e._fieldX[0]]:t[e._fieldY[0]];return e._totalData.getLatestData().find((function(t){return t.index===i}))}))},i.prototype.totalPositionX=function(t,e,i){void 0===i&&(i=.5);var n=this._xAxisHelper,r=n.dataToPosition,a=n.getBandwidth;return"horizontal"===this._direction?fF(r([t[e]],{bandPosition:this._bandPosition})):r([t[e]],{bandPosition:this._bandPosition})+.5*a(0)-this._barMark.getAttribute("width",t)*(.5-i)},i.prototype.totalPositionY=function(t,e,i){void 0===i&&(i=.5);var n=this._yAxisHelper,r=n.dataToPosition,a=n.getBandwidth;return"horizontal"===this._direction?r([t[e]],{bandPosition:this._bandPosition})+.5*a(0)-this._barMark.getAttribute("height",t)*(.5-i):fF(r([t[e]],{bandPosition:this._bandPosition}))},i.prototype.initMarkStyle=function(){var t=this;e.prototype.initMarkStyle.call(this),this._leaderLineMark&&("horizontal"===this._direction?this.setMarkStyle(this._leaderLineMark,{visible:function(e){return t.isVisibleLeaderLine(e)},x:function(e){return t.totalPositionX(e,"lastEnd",0)},x1:function(e){return t.totalPositionX(e,e.isTotal?"end":"start",0)},y:function(e){return e.lastIndex?t.totalPositionY(e,"lastIndex",1):0},y1:function(e){return t.totalPositionY(e,"index",0)}},"normal",CU.Series):this.setMarkStyle(this._leaderLineMark,{visible:function(e){return t.isVisibleLeaderLine(e)},x:function(e){return e.lastIndex?t.totalPositionX(e,"lastIndex",1):0},x1:function(e){return t.totalPositionX(e,"index",0)},y:function(e){return t.totalPositionY(e,"lastEnd",0)},y1:function(e){return t.totalPositionY(e,e.isTotal?"end":"start",0)}},"normal",CU.Series))},i.prototype.isVisibleLeaderLine=function(t){return!j(t.lastIndex)&&function(t,e,i){if(!e)return!0;var n=e.range(),r=(i&&e._calculateWholeRange?e._calculateWholeRange(n):e.range()).map((function(t){return e.invert(t)})),a=Math.min(r[0],r[r.length-1]),o=Math.max(r[0],r[r.length-1]);return Array.isArray(t)?t.every((function(t){return t>=a&&t<=o})):t>=a&&t<=o}([t.lastEnd,t[t.isTotal?"end":"start"]],"horizontal"===this.direction?this._xAxisHelper.getScale(0):this._yAxisHelper.getScale(0))},i.type=t.SeriesTypeEnum.waterfall,i.mark=FZ,i.transformerConstructor=NZ,i}(_q),eJ=function(){OZ(),pq(),kz.registerAnimation("waterfall",(function(t,e){return{appear:IZ(t,e),enter:aq(t,!1),exit:oq(t,!1),disappear:oq(t,!1)}})),iX(),MK(),kK(),kz.registerSeries(tJ.type,tJ)},iJ="".concat(BF,"_BOX_PLOT_OUTLIER_VALUE");!function(t){t.OUTLIER="outlier",t.MAX="max",t.MIN="min",t.MEDIAN="median",t.Q1="q1",t.Q3="q3",t.SERIES_FIELD="seriesField"}($Z||($Z={}));var nJ,rJ=function(t,e){var i=[],n=e.outliersField,r=e.dimensionField;return(t[0].latestData||[]).forEach((function(t){var e=t[n];X(e)||(e=[e]),i.push.apply(i,P([],E(e.map((function(e){var i,n=((i={})[iJ]=e,i);return r.forEach((function(e){n[e]=t[e]})),n}))),!1))})),i},aJ=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.getContentKey=function(t){return function(i){if(e.isOutlierMark(i))return t===$Z.OUTLIER?e.series.getOutliersField():t===$Z.SERIES_FIELD?e.series.getSeriesField():null;switch(t){case $Z.MIN:return e.series.getMinField();case $Z.MAX:return e.series.getMaxField();case $Z.MEDIAN:return e.series.getMedianField();case $Z.Q1:return e.series.getQ1Field();case $Z.Q3:return e.series.getQ3Field();case $Z.SERIES_FIELD:return e.series.getSeriesField()}return null}},e.getContentValue=function(t){return function(i){if(e.isOutlierMark(i))return t===$Z.OUTLIER?i[iJ]:t===$Z.SERIES_FIELD?i[e.series.getSeriesField()]:null;switch(t){case $Z.MIN:return i[e.series.getMinField()];case $Z.MAX:return i[e.series.getMaxField()];case $Z.MEDIAN:return i[e.series.getMedianField()];case $Z.Q1:return i[e.series.getQ1Field()];case $Z.Q3:return i[e.series.getQ3Field()];case $Z.SERIES_FIELD:return i[e.series.getSeriesField()]}return null}},e.shapeColorCallback=function(t){return"line"===e.series.getShaftShape()?e.series.getMarkInName("boxPlot").getAttribute("stroke",t):e.series.getMarkInName("boxPlot").getAttribute("fill",t)},e.getOutlierFillColor=function(t){var i,n=e.series.getOutliersStyle();return null!==(i=null==n?void 0:n.fill)&&void 0!==i?i:e.series.getMarkInName("outlier").getAttribute("fill",t)},e.isOutlierMark=function(t){return N(t[iJ])},e}return S(e,t),e.prototype.getDefaultContentList=function(t){return[{key:this.getContentKey($Z.OUTLIER),value:this.getContentValue($Z.OUTLIER),shapeType:this.shapeTypeCallback,shapeColor:this.getOutlierFillColor,shapeStroke:this.getOutlierFillColor},{key:this.getContentKey($Z.MAX),value:this.getContentValue($Z.MAX)},{key:this.getContentKey($Z.Q3),value:this.getContentValue($Z.Q3)},{key:this.getContentKey($Z.MEDIAN),value:this.getContentValue($Z.MEDIAN)},{key:this.getContentKey($Z.Q1),value:this.getContentValue($Z.Q1)},{key:this.getContentKey($Z.MIN),value:this.getContentValue($Z.MIN)},{key:this.getContentKey($Z.SERIES_FIELD),value:this.getContentValue($Z.SERIES_FIELD)}]},e}(PY),oJ=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return S(e,t),e.prototype._getDefaultStyle=function(){return A(A({},t.prototype._getDefaultStyle.call(this)),{lineWidth:2,boxWidth:30,shaftWidth:20,shaftShape:"line"})},e.prototype._initProduct=function(t){var e=this.getStyle("shaftShape"),i=this.getVGrammarView(),n=this.getProductId(),r="bar"===e?"barBoxplot":"boxplot",a=this.getStyle("direction");this._product=i.glyph(r,null!=t?t:i.rootMark).id(n).configureGlyph({direction:a}),this._compiledProductId=n},e.type="boxPlot",e}(aY),sJ=function(){kz.registerMark(oJ.type,oJ),xj.registerGlyph("boxplot",{shaft:"rule",box:"rect",max:"rule",min:"rule",median:"rule"}).registerProgressiveChannels(["x","y","q1","q3","min","max","median","angle","width","height","boxWidth","boxHeight","ruleWidth","ruleHeight"]).registerFunctionEncoder(uV).registerChannelEncoder("x",(function(t,e,i,n,r,a){return a&&rS(a.direction)?null:{shaft:{x:e,x1:e}}})).registerChannelEncoder("y",(function(t,e,i,n,r,a){return a&&rS(a.direction)?{shaft:{y:e,y1:e}}:null})).registerChannelEncoder("q1",(function(t,e,i,n,r,a){return a&&rS(a.direction)?{box:{x:e}}:{box:{y:e}}})).registerChannelEncoder("q3",(function(t,e,i,n,r,a){return a&&rS(a.direction)?{box:{x1:e}}:{box:{y1:e}}})).registerChannelEncoder("min",(function(t,e,i,n,r,a){return a&&rS(a.direction)?{shaft:{x:e},min:{x:e,x1:e,visible:!0}}:{shaft:{y:e},min:{y:e,y1:e,visible:!0}}})).registerChannelEncoder("max",(function(t,e,i,n,r,a){return a&&rS(a.direction)?{shaft:{x1:e},max:{x:e,x1:e,visible:!0}}:{shaft:{y1:e},max:{y:e,y1:e,visible:!0}}})).registerChannelEncoder("median",(function(t,e,i,n,r,a){return a&&rS(a.direction)?{median:{x:e,x1:e,visible:!0}}:{median:{y:e,y1:e,visible:!0}}})).registerChannelEncoder("angle",(function(t,e,i,n,r,a){var o,s=a&&rS(a.direction)?[(i.min+i.max)/2,i.y]:[i.x,(i.min+i.max)/2],l=null!==(o=i.anchor)&&void 0!==o?o:s;return{shaft:{angle:e,anchor:l},box:{angle:e,anchor:l},max:{angle:e,anchor:l},min:{angle:e,anchor:l},median:{angle:e,anchor:l}}})).registerDefaultEncoder((function(){return{max:{visible:!1},min:{visible:!1},median:{visible:!1}}})),xj.registerAnimationType("boxplotScaleIn",cV),xj.registerAnimationType("boxplotScaleOut",hV),aV(),iV(),QN(),$N(),xj.registerGlyph("barBoxplot",{minMaxBox:"rect",q1q3Box:"rect",median:"rule"}).registerProgressiveChannels(["x","y","q1","q3","min","max","median","angle","width","height","minMaxWidth","q1q3Width","minMaxHeight","q1q3Height"]).registerFunctionEncoder(pV).registerChannelEncoder("q1",(function(t,e,i,n,r,a){return a&&rS(a.direction)?{q1q3Box:{x:e}}:{q1q3Box:{y:e}}})).registerChannelEncoder("q3",(function(t,e,i,n,r,a){return a&&rS(a.direction)?{q1q3Box:{x1:e}}:{q1q3Box:{y1:e}}})).registerChannelEncoder("min",(function(t,e,i,n,r,a){return a&&rS(a.direction)?{minMaxBox:{x:e}}:{minMaxBox:{y:e}}})).registerChannelEncoder("max",(function(t,e,i,n,r,a){return a&&rS(a.direction)?{minMaxBox:{x1:e}}:{minMaxBox:{y1:e}}})).registerChannelEncoder("median",(function(t,e,i,n,r,a){return a&&rS(a.direction)?{median:{x:e,x1:e,visible:!0}}:{median:{y:e,y1:e,visible:!0}}})).registerChannelEncoder("angle",(function(t,e,i,n,r,a){var o,s=null!==(o=i.anchor)&&void 0!==o?o:[i.x,(i.min+i.max)/2];return{minMaxBox:{angle:e,anchor:s},q1q3Box:{angle:e,anchor:s},median:{angle:e,anchor:s}}})).registerChannelEncoder("lineWidth",(function(t,e,i,n,r,a){return{minMaxBox:{lineWidth:0},q1q3Box:{lineWidth:0}}})).registerChannelEncoder("minMaxFillOpacity",(function(t,e,i,n,r,a){return{minMaxBox:{fillOpacity:e}}})).registerChannelEncoder("stroke",(function(t,e,i,n,r,a){return{minMaxBox:{stroke:!1},q1q3Box:{stroke:!1}}})).registerDefaultEncoder((function(){return{minMaxBox:{lineWidth:0},q1q3Box:{lineWidth:0},median:{visible:!1}}})),xj.registerAnimationType("barBoxplotScaleIn",fV),xj.registerAnimationType("barBoxplotScaleOut",vV),aV(),iV(),QN(),$N()},lJ=A(A({},WY),((nJ={}).boxPlot={name:"boxPlot",type:"boxPlot"},nJ.outlier={name:"outlier",type:"symbol"},nJ)),uJ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.boxPlot,i}return S(i,e),i.prototype.getMinField=function(){return this._minField},i.prototype.getMaxField=function(){return this._maxField},i.prototype.getQ1Field=function(){return this._q1Field},i.prototype.getMedianField=function(){return this._medianField},i.prototype.getQ3Field=function(){return this._q3Field},i.prototype.getOutliersField=function(){return this._outliersField},i.prototype.getShaftShape=function(){return this._shaftShape},i.prototype.getBoxFillColor=function(){return this._boxFillColor},i.prototype.getStrokeColor=function(){return this._strokeColor},i.prototype.getOutliersStyle=function(){return this._outliersStyle},i.prototype.setAttrFromSpec=function(){var t,i,n,r,a;e.prototype.setAttrFromSpec.call(this);var o=null!==(i=null===(t=this._spec.boxPlot)||void 0===t?void 0:t.style)&&void 0!==i?i:{};this._minField=this._spec.minField,this._maxField=this._spec.maxField,this._q1Field=this._spec.q1Field,this._medianField=this._spec.medianField,this._q3Field=this._spec.q3Field,this._outliersField=this._spec.outliersField,this._lineWidth=null!==(n=o.lineWidth)&&void 0!==n?n:2,this._boxWidth=o.boxWidth,this._shaftShape=null!==(r=o.shaftShape)&&void 0!==r?r:"line",this._shaftWidth=o.shaftWidth,this._boxFillColor=o.boxFill,this._strokeColor=o.stroke,this._shaftFillOpacity="bar"===this._shaftShape?null!==(a=o.shaftFillOpacity)&&void 0!==a?a:.5:void 0,this._outliersStyle=this._spec.outliersStyle},i.prototype.initMark=function(){var t={progressiveStep:this._spec.progressiveStep,progressiveThreshold:this._spec.progressiveThreshold,large:this._spec.large,largeThreshold:this._spec.largeThreshold};this._boxPlotMark=this._createMark(i.mark.boxPlot,{groupKey:this._seriesField,isSeriesMark:!0},t),this._outlierMark=this._createMark(i.mark.outlier,{key:Uz,groupKey:this._seriesField,dataView:this._outlierDataView.getDataView(),dataProductId:this._outlierDataView.getProductId()},t)},i.prototype.initMarkStyle=function(){var t,e,i,n,r,a=this,o=this._boxPlotMark;if(o){var s={direction:this._direction,lineWidth:this._lineWidth,shaftShape:this._shaftShape,fill:null!==(t=this._boxFillColor)&&void 0!==t?t:"line"===this._shaftShape?"#FFF":this.getColorAttribute(),minMaxFillOpacity:this._shaftFillOpacity,stroke:null!==(e=this._strokeColor)&&void 0!==e?e:"line"===this._shaftShape?this.getColorAttribute():"#000"},l="horizontal"===this._direction?A(A({y:this.dataToPositionY.bind(this)},s),{boxHeight:function(){var t;return null!==(t=a._boxWidth)&&void 0!==t?t:a._getMarkWidth()},ruleHeight:function(){var t;return null!==(t=a._shaftWidth)&&void 0!==t?t:a._getMarkWidth()},q1q3Height:function(){var t;return null!==(t=a._boxWidth)&&void 0!==t?t:a._getMarkWidth()},minMaxHeight:function(){var t;return null!==(t=a._shaftWidth)&&void 0!==t?t:a._getMarkWidth()}}):A(A({x:this.dataToPositionX.bind(this)},s),{boxWidth:function(){var t;return null!==(t=a._boxWidth)&&void 0!==t?t:a._getMarkWidth()},ruleWidth:function(){var t;return null!==(t=a._shaftWidth)&&void 0!==t?t:a._getMarkWidth()},q1q3Width:function(){var t;return null!==(t=a._boxWidth)&&void 0!==t?t:a._getMarkWidth()},minMaxWidth:function(){var t;return null!==(t=a._shaftWidth)&&void 0!==t?t:a._getMarkWidth()}});this.setMarkStyle(o,l,hU.STATE_NORMAL,CU.Series)}var u=this._outlierMark;u&&this.setMarkStyle(u,{fill:null!==(n=null===(i=this._outliersStyle)||void 0===i?void 0:i.fill)&&void 0!==n?n:this.getColorAttribute(),size:Z(null===(r=this._outliersStyle)||void 0===r?void 0:r.size)?this._outliersStyle.size:10,symbolType:"circle"},hU.STATE_NORMAL,CU.Series)},i.prototype.initBoxPlotMarkStyle=function(){var t,e,i=this,n=this._boxPlotMark,r="horizontal"===this._direction?this._xAxisHelper:this._yAxisHelper;if(n&&r){var a=r.dataToPosition,o=null===(t=null==r?void 0:r.getScale)||void 0===t?void 0:t.call(r,0);this.setMarkStyle(n,{min:function(t){return fF(a(i.getDatumPositionValues(t,i._minField),{bandPosition:i._bandPosition}),o)},q1:function(t){return fF(a(i.getDatumPositionValues(t,i._q1Field),{bandPosition:i._bandPosition}),o)},median:function(t){return fF(a(i.getDatumPositionValues(t,i._medianField),{bandPosition:i._bandPosition}),o)},q3:function(t){return fF(a(i.getDatumPositionValues(t,i._q3Field),{bandPosition:i._bandPosition}),o)},max:function(t){return fF(a(i.getDatumPositionValues(t,i._maxField),{bandPosition:i._bandPosition}),o)}},hU.STATE_NORMAL,CU.Series)}var s=this._outlierMark;if(s&&r){var l=r.dataToPosition,u=null===(e=null==r?void 0:r.getScale)||void 0===e?void 0:e.call(r,0),c="horizontal"===this._direction?{y:this.dataToPositionY.bind(this),x:function(t){return fF(l(i.getDatumPositionValues(t,iJ),{bandPosition:i._bandPosition}),u)}}:{x:this.dataToPositionX.bind(this),y:function(t){return fF(l(i.getDatumPositionValues(t,iJ),{bandPosition:i._bandPosition}),u)}};this.setMarkStyle(s,c,hU.STATE_NORMAL,CU.Series)}},i.prototype.initData=function(){if(e.prototype.initData.call(this),this._data){qG(this._dataSet,"foldOutlierData",rJ),qG(this._dataSet,"addVChartProperty",_Y);var t=new Ms(this._dataSet,{name:"".concat(this.type,"_outlier_").concat(this.id,"_data")});t.parse([this.getViewData()],{type:"dataview"}),t.name="".concat(BF,"_series_").concat(this.id,"_outlierData"),t.transform({type:"foldOutlierData",options:{dimensionField:"horizontal"===this._direction?this._fieldY:this._fieldX,outliersField:this._outliersField}}),t.transform({type:"addVChartProperty",options:{beforeCall:HY.bind(this),call:jY}},!1),this._outlierDataView=new DY(this._option,t)}},i.prototype.compileData=function(){var t;e.prototype.compileData.call(this),null===(t=this._outlierDataView)||void 0===t||t.compile()},i.prototype.init=function(t){e.prototype.init.call(this,t),this.initBoxPlotMarkStyle()},i.prototype._getMarkWidth=function(){if(this._autoBoxWidth)return this._autoBoxWidth;var t="horizontal"===this._direction?this._yAxisHelper:this._xAxisHelper,e="horizontal"===this._direction?this._fieldY:this._fieldX,i=t.getBandwidth(e.length-1)/e.length;return this._autoBoxWidth=i,this._autoBoxWidth},i.prototype.onLayoutEnd=function(t){e.prototype.onLayoutEnd.call(this,t),this._autoBoxWidth=null},i.prototype._initAnimationSpec=function(t){var e=this;void 0===t&&(t={});var i=ft({},t);return["appear","enter","update","exit","disappear"].forEach((function(t){i[t]&&"scaleIn"===i[t].type?i[t].type="line"===e._shaftShape?"boxplotScaleIn":"barBoxplotScaleIn":i[t]&&"scaleOut"===i[t].type&&(i[t].type="line"===e._shaftShape?"boxplotScaleOut":"barBoxplotScaleOut")})),i},i.prototype.initAnimation=function(){var t,e,i,n,r,a,o,s=xX(this);if(this._boxPlotMark){var l=this._initAnimationSpec(null===(t=kz.getAnimationInKey("scaleInOut"))||void 0===t?void 0:t()),u=this._initAnimationSpec(hX("boxPlot",this._spec,this._markAttributeContext));this._boxPlotMark.setAnimationConfig(cX(l,u,s))}if(this._outlierMark){var c={appear:null===(e=this._spec.animationAppear)||void 0===e?void 0:e.symbol,disappear:null===(i=this._spec.animationDisappear)||void 0===i?void 0:i.symbol,enter:null===(n=this._spec.animationEnter)||void 0===n?void 0:n.symbol,exit:null===(r=this._spec.animationExit)||void 0===r?void 0:r.symbol,update:null===(a=this._spec.animationUpdate)||void 0===a?void 0:a.symbol};this._outlierMark.setAnimationConfig(cX(null===(o=kz.getAnimationInKey("scaleInOut"))||void 0===o?void 0:o(),c,s))}},i.prototype.initTooltip=function(){this._tooltipHelper=new aJ(this),this._boxPlotMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._boxPlotMark),this._outlierMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._outlierMark)},i.prototype.getStatisticFields=function(){var t=this,i=e.prototype.getStatisticFields.call(this),n=i.find((function(e){return e.key===t._outliersField}));return n&&(n.operations=["array-min","array-max"]),i},i.prototype.onEvaluateEnd=function(t){e.prototype.onEvaluateEnd.call(this,t),this._outlierDataView.updateData()},i.prototype.getDefaultShapeType=function(){return"square"},i.prototype.getActiveMarks=function(){return[this._boxPlotMark]},i.type=t.SeriesTypeEnum.boxPlot,i.mark=lJ,i}(SX),cJ=function(){sJ(),LX(),eX(),MK(),kK(),kz.registerSeries(uJ.type,uJ)},hJ=function(t){function e(i,n){var r=t.call(this,i,n)||this;return r.type=e.type,r._textType="text",r}return S(e,t),e.prototype.getTextType=function(){return this._textType},e.prototype._getDefaultStyle=function(){return A(A({},t.prototype._getDefaultStyle.call(this)),{angle:0,textAlign:"center",lineWidth:0,textConfig:[]})},e.prototype.initStyleWithSpec=function(e,i){t.prototype.initStyleWithSpec.call(this,e,i),e.textType&&(this._textType=e.textType)},e.prototype.compileEncode=function(){t.prototype.compileEncode.call(this),"rich"===this._textType&&this._product.encodeState("group",{textType:this._textType})},e.type="text",e}(aY),dJ=function(){kz.registerMark(hJ.type,hJ),eV(),CP(),wP(),xj.registerGraphic(MH.richtext,hy)};var pJ=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._getMeasureData=function(t){return"horizontal"===e.series.getSpec().direction?t[e.series.getSpec().xField[0]]+"-"+t[e.series.getSpec().xField[1]]:t[e.series.getSpec().yField[0]]+"-"+t[e.series.getSpec().yField[1]]},e}return S(e,t),e}(PY),fJ=function(t){return{type:"growCenterIn",options:{direction:"horizontal"===t.direction?"x":"y"}}},vJ={type:"fadeIn"},gJ=function(t){return{type:"growCenterOut",options:{direction:"horizontal"===t.direction?"x":"y"}}};function yJ(t,e){return"fadeIn"===e?vJ:fJ(t)}var mJ,_J,bJ=A(A({},fq),((mJ={}).minLabel={name:"minLabel",type:"text"},mJ.maxLabel={name:"maxLabel",type:"text"},mJ)),xJ=A(A({},vq),((_J={}).minLabel={name:"minLabel",type:"text"},_J.maxLabel={name:"maxLabel",type:"text"},_J)),kJ=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._supportStack=!1,e}return S(e,t),e.prototype._transformLabelSpec=function(t){var e;"bothEnd"!==(null===(e=t.label)||void 0===e?void 0:e.position)&&this._addMarkLabelSpec(t,"bar")},e}(mq),SJ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.rangeColumn,i._barMarkType="rect",i._barName=t.SeriesTypeEnum.bar,i.transformerConstructor=kJ,i}return S(i,e),i.prototype.initMark=function(){var t,e,n,r,a,o,s,l,u,c;this._initBarBackgroundMark();var h=null===(t=this._spec.label)||void 0===t?void 0:t.position;this._barMark=this._createMark(i.mark.bar,{groupKey:this._seriesField,isSeriesMark:!0,stateSort:null===(e=this._spec.bar)||void 0===e?void 0:e.stateSort},{setCustomizedShape:null===(n=this._spec.bar)||void 0===n?void 0:n.customShape,morph:fX(this._spec,i.mark.bar.name),morphElementKey:this.getDimensionField()[0]}),!1!==(null===(r=this._spec.label)||void 0===r?void 0:r.visible)&&"bothEnd"===h&&(!1!==(null===(o=null===(a=this._spec.label)||void 0===a?void 0:a.minLabel)||void 0===o?void 0:o.visible)&&(this._minLabelMark=this._createMark(i.mark.minLabel,{markSpec:null===(s=this._spec.label)||void 0===s?void 0:s.minLabel})),!1!==(null===(u=null===(l=this._spec.label)||void 0===l?void 0:l.maxLabel)||void 0===u?void 0:u.visible)&&(this._maxLabelMark=this._createMark(i.mark.maxLabel,{markSpec:null===(c=this._spec.label)||void 0===c?void 0:c.maxLabel})))},i.prototype.initMarkStyle=function(){var t,i;e.prototype.initMarkStyle.call(this),this._initLabelMarkPos(this._minLabelMark,null===(t=this._spec.label)||void 0===t?void 0:t.minLabel,0,"end"),this._initLabelMarkPos(this._maxLabelMark,null===(i=this._spec.label)||void 0===i?void 0:i.maxLabel,1,"start")},i.prototype._initLabelMarkPos=function(t,e,i,n){var r,a,o,s,l=this;t&&(this.setMarkStyle(t,{fill:null!==(a=null===(r=null==e?void 0:e.style)||void 0===r?void 0:r.fill)&&void 0!==a?a:this.getColorAttribute(),text:function(t){var n="horizontal"===l._spec.direction?t[l._spec.xField[i]]:t[l._spec.yField[i]];return(null==e?void 0:e.formatMethod)?e.formatMethod(n,t):n}}),function(t,e,i,n,r,a,o,s,l){t.setMarkStyle(e,{textAlign:function(t){if("vertical"===l())return"center";var e=r(t),n=a(t);if("middle"===i)return"center";if(e>=n){if("start"===i)return"left";if("end"===i)return"right";if("outside"===i)return"left"}else{if("start"===i)return"right";if("end"===i)return"left";if("outside"===i)return"right"}return"center"},textBaseline:function(t){if("horizontal"===l())return"middle";var e=o(t),n=s(t);if("middle"===i)return"middle";if(n>=e){if("start"===i)return"bottom";if("end"===i)return"top";if("outside"===i)return"bottom"}else{if("start"===i)return"top";if("end"===i)return"bottom";if("outside"===i)return"top"}return"middle"}}),t.setMarkStyle(e,{x:function(t){var e=l(),o=r(t),s=a(t);if("vertical"===e)return(o+s)/2;if("middle"===i)return(o+s)/2;if(o>=s){if("start"===i)return s+n;if("end"===i)return o-n;if("outside"===i)return o+n}else{if("start"===i)return s-n;if("end"===i)return o+n;if("outside"===i)return o-n}return(o+s)/2},y:function(t){var e=l(),r=o(t),a=s(t);if("horizontal"===e)return(r+a)/2;if("middle"===i)return(r+a)/2;if(r>=a){if("start"===i)return a+n;if("end"===i)return r-n;if("outside"===i)return r+n}else{if("start"===i)return a-n;if("end"===i)return r+n;if("outside"===i)return r-n}return(r+a)/2}},"normal",CU.Series)}(this,t,null!==(o=null==e?void 0:e.position)&&void 0!==o?o:n,null!==(s=null==e?void 0:e.offset)&&void 0!==s?s:"vertical"===this._direction?-20:-25,(function(t){return l._barMark.getAttribute("x",t)}),(function(t){return"vertical"===l._direction?l._barMark.getAttribute("x",t)+l._barMark.getAttribute("width",t):l._barMark.getAttribute("x1",t)}),(function(t){return l._barMark.getAttribute("y",t)}),(function(t){return"vertical"===l._direction?l._barMark.getAttribute("y1",t):l._barMark.getAttribute("y",t)+l._barMark.getAttribute("height",t)}),(function(){return l._direction})))},i.prototype.initLabelMarkStyle=function(t){var e=this;t&&(this.setMarkStyle(t,{text:function(t){var i,n;return"horizontal"===e._spec.direction?(i=t[e._spec.xField[0]],n=t[e._spec.xField[1]]):(i=t[e._spec.yField[0]],n=t[e._spec.yField[1]]),i+"-"+n},z:this._fieldZ?this.dataToPositionZ.bind(this):null}),this._labelMark=t)},i.prototype._dataToPosX=function(t){return this._xAxisHelper.dataToPosition(this.getDatumPositionValues(t,this._spec.xField[0]),{bandPosition:this._bandPosition})},i.prototype._dataToPosX1=function(t){return this._xAxisHelper.dataToPosition(this.getDatumPositionValues(t,this._spec.xField[1]),{bandPosition:this._bandPosition})},i.prototype._dataToPosY=function(t){return this._yAxisHelper.dataToPosition(this.getDatumPositionValues(t,this._spec.yField[0]),{bandPosition:this._bandPosition})},i.prototype._dataToPosY1=function(t){return this._yAxisHelper.dataToPosition(this.getDatumPositionValues(t,this._spec.yField[1]),{bandPosition:this._bandPosition})},i.prototype.initAnimation=function(){var t,e,i,n,r,a=xX(this),o=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this._barMark.setAnimationConfig(cX(null===(i=kz.getAnimationInKey("rangeColumn"))||void 0===i?void 0:i({direction:this.direction},o),hX("bar",this._spec,this._markAttributeContext),a)),this._minLabelMark&&this._minLabelMark.setAnimationConfig(cX(null===(n=kz.getAnimationInKey("fadeInOut"))||void 0===n?void 0:n(),hX("label",this._spec,this._markAttributeContext),a)),this._maxLabelMark&&this._maxLabelMark.setAnimationConfig(cX(null===(r=kz.getAnimationInKey("fadeInOut"))||void 0===r?void 0:r(),hX("label",this._spec,this._markAttributeContext),a))},i.prototype.initTooltip=function(){this._tooltipHelper=new pJ(this),this._barMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._barMark),this._minLabelMark&&this._tooltipHelper.ignoreTriggerSet.mark.add(this._minLabelMark),this._maxLabelMark&&this._tooltipHelper.ignoreTriggerSet.mark.add(this._maxLabelMark),this._labelMark&&this._tooltipHelper.ignoreTriggerSet.mark.add(this._labelMark)},i.type=t.SeriesTypeEnum.rangeColumn,i.mark=bJ,i.transformerConstructor=kJ,i}(_q),AJ=function(){pq(),dJ(),kz.registerAnimation("rangeColumn",(function(t,e){return{appear:yJ(t,e),enter:fJ(t),exit:gJ(t),disappear:gJ(t)}})),iX(),MK(),kK(),kz.registerSeries(SJ.type,SJ)},MJ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.rangeColumn3d,i._barMarkType="rect3d",i._barName=t.SeriesTypeEnum.bar3d,i}return S(i,e),i.type=t.SeriesTypeEnum.rangeColumn3d,i.mark=xJ,i}(SJ),wJ=function(){wq(),MK(),kK(),kz.registerSeries(MJ.type,MJ)},TJ=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._getMeasureData=function(t){return"horizontal"===e.series.getSpec().direction?t[e.series.getSpec().xField[0]]+"-"+t[e.series.getSpec().xField[1]]:t[e.series.getSpec().yField[0]]+"-"+t[e.series.getSpec().yField[1]]},e}return S(e,t),e}(PY),CJ=A({},ZK),EJ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.rangeArea,i}return S(i,e),i.prototype.initMark=function(){var t,e=null!==(t=this._spec.area)&&void 0!==t?t:{},n=e.customShape,r=e.stateSort;this._areaMark=this._createMark(i.mark.area,{groupKey:this._seriesField,isSeriesMark:!0,stateSort:r},{setCustomizedShape:n,morphElementKey:this.getDimensionField()[0]})},i.prototype.initMarkStyle=function(){this.initAreaMarkStyle()},i.prototype.initAreaMarkStyle=function(){var t=this,i=this._areaMark;i&&(e.prototype.initAreaMarkStyle.call(this),"horizontal"===this._direction?this.setMarkStyle(this._areaMark,{x1:function(e){return t._xAxisHelper?(0,t._xAxisHelper.dataToPosition)(t.getDatumPositionValues(e,t._spec.xField[1]),{bandPosition:t._bandPosition}):Number.NaN}},"normal",CU.Series):this.setMarkStyle(this._areaMark,{y1:function(e){return t._yAxisHelper?(0,t._yAxisHelper.dataToPosition)(t.getDatumPositionValues(e,t._spec.yField[1]),{bandPosition:t._bandPosition}):Number.NaN}},"normal",CU.Series),this.setMarkStyle(i,{stroke:!1},"normal",CU.Series))},i.prototype.initTooltip=function(){this._tooltipHelper=new TJ(this)},i.prototype._isFieldAllValid=function(){var t=this.getViewDataStatistics(),e=this.fieldY;return!!(t&&t.latestData&&e.length)&&e.every((function(e){return t.latestData[e]&&t.latestData[e].allValid}))},i.type=t.SeriesTypeEnum.rangeArea,i.mark=CJ,i}($K),PJ=function(){KK(),MK(),kK(),kz.registerSeries(EJ.type,EJ)},RJ=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.coordinate="polar",e._outerRadius=UF,e._innerRadius=0,e._angleField=[],e._radiusField=[],e._sortDataByAxis=!1,e}return S(e,t),Object.defineProperty(e.prototype,"outerRadius",{get:function(){return this._outerRadius},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"innerRadius",{get:function(){return this._innerRadius},enumerable:!1,configurable:!0}),e.prototype.getAngleField=function(){return this._angleField},e.prototype.setAngleField=function(t){return this._angleField=N(t)?xt(t):[],this._angleField},e.prototype.getRadiusField=function(){return this._radiusField},e.prototype.setRadiusField=function(t){return this._radiusField=N(t)?xt(t):[],this._radiusField},Object.defineProperty(e.prototype,"innerRadiusField",{get:function(){return this._innerRadiusField},enumerable:!1,configurable:!0}),e.prototype.setInnerRadiusField=function(t){return this._innerRadiusField=xt(t),this._innerRadiusField},Object.defineProperty(e.prototype,"radiusScale",{get:function(){return this._radiusScale},enumerable:!1,configurable:!0}),e.prototype.setRadiusScale=function(t){return this._radiusScale=t,t},Object.defineProperty(e.prototype,"angleScale",{get:function(){return this._angleScale},enumerable:!1,configurable:!0}),e.prototype.setAngleScale=function(t){return this._angleScale=t,t},Object.defineProperty(e.prototype,"angleAxisHelper",{get:function(){return this._angleAxisHelper},set:function(t){this._angleAxisHelper=t,this.onAngleAxisHelperUpdate()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"radiusAxisHelper",{get:function(){return this._radiusAxisHelper},set:function(t){this._radiusAxisHelper=t,this.onRadiusAxisHelperUpdate()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sortDataByAxis",{get:function(){return this._sortDataByAxis},enumerable:!1,configurable:!0}),e.prototype._buildMarkAttributeContext=function(){var e=this;t.prototype._buildMarkAttributeContext.call(this),this._markAttributeContext.valueToPosition=this.valueToPosition.bind(this),this._markAttributeContext.getCenter=function(){return e.angleAxisHelper.center()},this._markAttributeContext.getLayoutRadius=function(){return e._computeLayoutRadius()}},e.prototype.valueToPosition=function(t,e){if(j(t)||j(e)||!this.angleAxisHelper||!this.radiusAxisHelper)return{x:Number.NaN,y:Number.NaN};var i=this.radiusAxisHelper.dataToPosition(xt(e));if(i<0){if("break"===this._invalidType||"link"===this._invalidType)return{x:Number.NaN,y:Number.NaN};if("zero"===this._invalidType)return this.angleAxisHelper.center()}var n=this.angleAxisHelper.dataToPosition(xt(t));return this.angleAxisHelper.coordToPoint({angle:n,radius:i})},e.prototype.dataToPosition=function(t,e){return t&&this.angleAxisHelper&&this.radiusAxisHelper?e&&!this.isDatumInViewData(t)?null:this.valueToPosition(this.getDatumPositionValues(t,this._angleField),this.getDatumPositionValues(t,this._radiusField)):null},e.prototype.dataToPositionX=function(t){var e;return null===(e=this.dataToPosition(t))||void 0===e?void 0:e.x},e.prototype.dataToPositionY=function(t){var e;return null===(e=this.dataToPosition(t))||void 0===e?void 0:e.y},e.prototype.dataToPositionZ=function(t){return 0},e.prototype.positionToData=function(t){},e.prototype.radiusToData=function(t){},e.prototype.angleToData=function(t){},e.prototype.getStatisticFields=function(){var t,e,i=this,n=[];return(null===(t=this.radiusAxisHelper)||void 0===t?void 0:t.getScale)&&this._radiusField.forEach((function(t){var e={key:t,operations:[]};NB(i.radiusAxisHelper.getScale(0).type)?e.operations=["max","min"]:e.operations=["values"],n.push(e)})),(null===(e=this.angleAxisHelper)||void 0===e?void 0:e.getScale)&&this._angleField.forEach((function(t){var e={key:t,operations:[]};NB(i.angleAxisHelper.getScale(0).type)?e.operations=["max","min"]:e.operations=["values"],n.push(e)})),n},e.prototype.setAttrFromSpec=function(){t.prototype.setAttrFromSpec.call(this),N(this._spec.outerRadius)&&(this._outerRadius=this._spec.outerRadius),N(this._spec.radius)&&(this._outerRadius=this._spec.radius),N(this._spec.innerRadius)&&(this._innerRadius=this._spec.innerRadius),N(this._spec.sortDataByAxis)&&(this._sortDataByAxis=!0===this._spec.sortDataByAxis)},e.prototype.onRadiusAxisHelperUpdate=function(){this.onMarkPositionUpdate()},e.prototype.onAngleAxisHelperUpdate=function(){this.onMarkPositionUpdate()},e.prototype.afterInitMark=function(){t.prototype.afterInitMark.call(this)},e.prototype._computeLayoutRadius=function(){var t=this._angleAxisHelper||this._radiusAxisHelper;if(t)return t.layoutRadius();var e=this._region.getLayoutRect(),i=e.width,n=e.height;return Math.min(i/2,n/2)},e.prototype.initEvent=function(){var e=this;t.prototype.initEvent.call(this),this.sortDataByAxis&&this.event.on(cG.scaleDomainUpdate,{filter:function(t){var i;return t.model.id===(null===(i=e._angleAxisHelper)||void 0===i?void 0:i.getAxisId())}},(function(){e._sortDataInAxisDomain()}))},e.prototype._sortDataInAxisDomain=function(){var t,e;(null===(e=null===(t=this.getViewData())||void 0===t?void 0:t.latestData)||void 0===e?void 0:e.length)&&bX(this.angleAxisHelper,this._angleField[0],this.getViewData().latestData)},e.prototype.getInvalidCheckFields=function(){var t=[];return this.angleAxisHelper.isContinuous&&this._angleField.forEach((function(e){t.push(e)})),this.radiusAxisHelper.isContinuous&&this._radiusField.forEach((function(e){t.push(e)})),t},e}(_X);function BJ(t){return Uk(t)?Number.parseFloat(t):0}var IJ=function(t,e){var i=e.asStartAngle,n=e.asEndAngle,r=e.asMiddleAngle,a=e.asRadian,o=e.asRatio,s=e.asQuadrant,l=e.asK,u=e.showAllZero,c=e.supportNegative,h=e.showEmptyCircle,d=e.angleField(),p=e.startAngle(),f=e.endAngle(),v=e.minAngle(),g=t.map((function(t){return A({},t)}));if(!g||0===g.length)return g;if(!u&&h&&LJ(g,d,c))return[];for(var y=function(t,e,o){t[i]=e,t[n]=e+o,t[r]=e+o/2,t[a]=o,t[s]=De(e+o/2)},m=0,_=-1/0,b=!0,x=0;x<g.length;x++){var k=c?Math.abs(BJ(g[x][d])):BJ(g[x][d]);m+=k,_=Math.max(k,_),b&&0!==k&&(b=!1),g[x][DF]=k}var S=g.map((function(t){return Number(t[d])})),M=f-p,w=p,T=M,C=0,E=function(t,e){void 0===e&&(e=2);var i=t.reduce((function(t,e){return t+(isNaN(e)?0:e)}),0);if(0===i)return 0;for(var n=Math.pow(10,e),r=t.map((function(t){return(isNaN(t)?0:t)/i*n*100})),a=100*n,o=r.map((function(t){return Math.floor(t)})),s=o.reduce((function(t,e){return t+e}),0),l=r.map((function(t,e){return t-o[e]}));s<a;){for(var u=Number.NEGATIVE_INFINITY,c=null,h=0;h<l.length;h++)l[h]>u&&(u=l[h],c=h);++o[c],l[c]=0,++s}return o.map((function(t){return t/n}))}(S);if(g.forEach((function(t,e){var i=t[DF],n=m?i/m:0,r=n*M;r<v?(r=v,T-=v):C+=i;var a=w,s=w+r;t[o]=n,t[l]=_?i/_:0,t._percent_=E[e],y(t,a,r),w=s})),T<M)if(T<=.001){var P=M/g.length;g.forEach((function(t,e){y(t,p+e*P,P)}))}else{var R=T/C;w=p,g.forEach((function(t){var e=t[a]===v?v:t[DF]*R;y(t,w,e),w+=e}))}if(0!==m&&(g[g.length-1][n]=f),b&&u){var B=M/g.length;g.forEach((function(t,e){y(t,p+e*B,B)}))}return g},LJ=function(t,e,i){return!!j(t)||(0===t.length||(!!t.every((function(t){return 0===BJ(t[e])}))||!i&&0===t.reduce((function(t,i){return t+BJ(i[e])}),0)))};function DJ(t,e,i){return function(n,r,a){return e?"radius"===t.growField?{overall:0}:{overall:t.growFrom(n,r,i)}:{overall:!1}}}var OJ=function(t){return{type:"radius"===t.growField?"growRadiusIn":"growAngleIn",options:DJ(t,!0,rU.appear)}},FJ={type:"fadeIn"},zJ=function(t){return{type:"radius"===t.growField?"growRadiusIn":"growAngleIn",easing:"linear",options:DJ(t,!0,rU.enter)}},HJ=function(t){return{type:"radius"===t.growField?"growRadiusOut":"growAngleOut",easing:"linear",options:DJ(t,!0,rU.exit)}},jJ=function(t){return{type:"radius"===t.growField?"growRadiusOut":"growAngleOut",options:DJ(t,!0,rU.exit)}};function NJ(t,e){if(!1===e)return{};switch(e){case"fadeIn":return FJ;case"growRadius":return OJ(A(A({},t),{growField:"radius"}));default:return OJ(A(A({},t),{growField:"angle"}))}}var VJ,WJ,GJ=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.type=UJ.type,n._unCompileChannel={centerOffset:!0,radiusOffset:!0},n.computeOuterRadius=function(t,e,i,r,a){var o;return void 0===i&&(i="normal"),a+(null!==(o=n.getAttribute("radiusOffset",e,i,r))&&void 0!==o?o:0)},n.computeCenter=function(t,e,i,r,a){return void 0===i&&(i="normal"),Pe({x:0,y:0},n.getAttribute("centerOffset",e,i,r),e[jF])[t]+a},n._computeExChannel.x=n.computeCenter,n._computeExChannel.y=n.computeCenter,n._computeExChannel.outerRadius=n.computeOuterRadius,n._extensionChannel.centerOffset=["x","y"],n._extensionChannel.radiusOffset=["outerRadius"],n}return S(e,t),e.prototype._getDefaultStyle=function(){return A(A({},t.prototype._getDefaultStyle.call(this)),{startAngle:0,endAngle:0,outerRadius:0,innerRadius:0,cornerRadius:0,lineWidth:0,innerPadding:0,outerPadding:0})},e}(aY),UJ=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return S(e,t),e.type="arc",e}(GJ),YJ=function(){qN(),oX(),kz.registerMark(UJ.type,UJ)},XJ=A(A({},WY),((VJ={}).pie={name:"pie",type:"arc"},VJ.labelLine={name:"labelLine",type:"path"},VJ)),KJ=A(A({},WY),((WJ={}).pie3d={name:"pie3d",type:"arc3d"},WJ.labelLine={name:"labelLine",type:"path"},WJ)),qJ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"pie")},e.prototype._mergeThemeToSpec=function(t,e){var i=this,n=this._theme,r=t;if(this._shouldMergeThemeToSpec()){var a=this._getDefaultSpecFromChart(e);r=xz({},this._theme,a,t);var o=function(t,e){return xz({},"inside"===t||"inside-center"===t?i._theme.innerLabel:i._theme.outerLabel,e)};X(r.label)?r.label=r.label.map((function(t){return o(t.position,t)})):r.label=o(r.label.position,r.label)}return{spec:r,theme:n}},e.prototype._getDefaultSpecFromChart=function(e){var i,n=null!==(i=t.prototype._getDefaultSpecFromChart.call(this,e))&&void 0!==i?i:{},r=e.centerX,a=e.centerY;return N(r)&&(n.centerX=r),N(a)&&(n.centerY=a),Object.keys(n).length>0?n:void 0},e}(mX),ZJ="".concat(BF,"_LABEL_VISIBLE"),JJ=function(t,e,i,n){var r=t();if(Z(r))return r;if(H(r))return r(e(),i());var a=e();if("auto"===r&&a.width>0&&a.height>0){var o=n(),s=o.startAngle,l=void 0===s?0:s,u=o.endAngle,c=void 0===u?2*Math.PI:u;return Le(a,i(),l,c)}return Math.min(a.width/2,a.height/2)},QJ=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.transformerConstructor=qJ,e._pieMarkName="pie",e._pieMarkType="arc",e.getCenter=function(){var t,i,n=e._region.getLayoutRect();return{x:mF(null===(t=e._spec)||void 0===t?void 0:t.centerX,n.width,n,n.width/2),y:mF(null===(i=e._spec)||void 0===i?void 0:i.centerY,n.height,n,n.height/2)}},e._startAngle=WF,e._endAngle=GF,e._pieMark=null,e._labelMark=null,e._labelLineMark=null,e._emptyArcMark=null,e.dataToCentralPosition=function(t){var i=t[jF];if(j(i))return null;var n=e.computeDatumRadius(t),r=e.computeDatumInnerRadius(t);return Pe(e.computeCenter(t),(n+r)/2,i)},e}return S(e,t),e.prototype._buildMarkAttributeContext=function(){var e=this;t.prototype._buildMarkAttributeContext.call(this),this._markAttributeContext.getCenter=function(){return{x:function(){return e.getCenter().x},y:function(){return e.getCenter().y}}},this._markAttributeContext.startAngleScale=function(t){return e.startAngleScale(t)},this._markAttributeContext.endAngleScale=function(t){return e.endAngleScale(t)}},e.prototype.setAttrFromSpec=function(){var e,i,n,r,a,o;t.prototype.setAttrFromSpec.call(this),this._centerOffset=null!==(e=this._spec.centerOffset)&&void 0!==e?e:0,this._cornerRadius=null!==(i=this._spec.cornerRadius)&&void 0!==i?i:0;var s=function(t,e){var i=0,n=2*Math.PI,r=N(t),a=N(e);for(r||a?a?r?(i=t,n=e):(i=e-2*Math.PI,n=e):(i=t,n=t+2*Math.PI):(i=0,n=2*Math.PI);n<=i;)n+=2*Math.PI;for(;i>2*Math.PI;)i-=2*Math.PI,n-=2*Math.PI;for(;n<0;)i+=2*Math.PI,n+=2*Math.PI;return{startAngle:i,endAngle:n}}(N(this._spec.startAngle)?we(this._spec.startAngle):this._startAngle,N(this._spec.endAngle)?we(this._spec.endAngle):this._endAngle);this._startAngle=s.startAngle,this._endAngle=s.endAngle,this._padAngle=N(this._spec.padAngle)?we(this._spec.padAngle):0,this.setAngleField(this._spec.valueField||this._spec.angleField),this._spec.categoryField&&this.setSeriesField(this._spec.categoryField),this._radiusField=[],this._specAngleField=this._angleField.slice(),this._specRadiusField=[],this._showEmptyCircle=null!==(r=null===(n=this._spec.emptyPlaceholder)||void 0===n?void 0:n.showEmptyCircle)&&void 0!==r&&r,this._showAllZero=null!==(a=this._spec.showAllZero)&&void 0!==a&&a,this._supportNegative=null!==(o=this._spec.supportNegative)&&void 0!==o&&o},e.prototype.initData=function(){var e=this;t.prototype.initData.call(this);var i=this.getViewData();if(i){qG(this._dataSet,"pie",IJ),i.transform({type:"pie",options:{angleField:function(){return e._angleField[0]},startAngle:function(){return e._startAngle},endAngle:function(){return e._endAngle},minAngle:function(){return N(e._spec.minAngle)?we(e._spec.minAngle):0},asStartAngle:FF,asEndAngle:zF,asRatio:OF,asMiddleAngle:jF,asRadian:VF,asQuadrant:NF,asK:HF,showAllZero:this._showAllZero,supportNegative:this._supportNegative,showEmptyCircle:this._showEmptyCircle}},!1);var n=new Ms(this._dataSet,{name:"".concat(BF,"_series_").concat(this.id,"_viewDataLabel")});n.parse([this.getViewData()],{type:"dataview"}),this._viewDataLabel=new DY(this._option,n)}},e.prototype.compileData=function(){var e;t.prototype.compileData.call(this),null===(e=this._viewDataLabel)||void 0===e||e.compile()},e.prototype.initMark=function(){var t,i;this._pieMark=this._createMark(A(A({},e.mark.pie),{name:this._pieMarkName,type:this._pieMarkType}),{key:Yz,groupKey:this._seriesField,skipBeforeLayouted:!0,isSeriesMark:!0,stateSort:null===(t=this._spec.pie)||void 0===t?void 0:t.stateSort},{setCustomizedShape:null===(i=this._spec.pie)||void 0===i?void 0:i.customShape,morph:fX(this._spec,this._pieMarkName),morphElementKey:this._seriesField}),this._showEmptyCircle&&(this._emptyArcMark=this._createMark({name:"emptyCircle",type:"arc"},{dataView:!1}),this._emptyArcMark.setDepend(this._pieMark))},e.prototype.startAngleScale=function(t){return $O(FF)(t)},e.prototype.endAngleScale=function(t){return $O(zF)(t)},e.prototype._computeLayoutRadius=function(){var t=this;return JJ((function(){return t._spec.layoutRadius}),this.getLayoutRect,this.getCenter,(function(){return{startAngle:t._startAngle,endAngle:t._endAngle}}))},e.prototype.initMarkStyle=function(){var t=this,e={x:function(){return t.getCenter().x},y:function(){return t.getCenter().y},fill:this.getColorAttribute(),outerRadius:vF(this._outerRadius)?this._outerRadius:function(){return t._computeLayoutRadius()*t._outerRadius},innerRadius:vF(this._innerRadius)?this._innerRadius:function(){return t._computeLayoutRadius()*t._innerRadius},cornerRadius:function(){return t._computeLayoutRadius()*t._cornerRadius},startAngle:function(e){return t.startAngleScale(e)},endAngle:function(e){return t.endAngleScale(e)},padAngle:this._padAngle,centerOffset:this._centerOffset},i=this._pieMark;i&&this.setMarkStyle(i,e,"normal",CU.Series);var n=this._emptyArcMark;n&&this.setMarkStyle(n,A(A({},e),{visible:function(){var e=t.getViewData().latestData;return!e||!e.length}}),"normal",CU.Series)},e.prototype.initInteraction=function(){this._parseInteractionConfig(this._pieMark?[this._pieMark]:[])},e.prototype.initTooltip=function(){t.prototype.initTooltip.call(this),this._pieMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._pieMark)},e.prototype.initMarkStyleWithSpec=function(e,i,n){if(t.prototype.initMarkStyleWithSpec.call(this,e,i,n),e.name===this._pieMarkName){var r=this.getSpec()[e.name];if(r)for(var a in r.state||{})this.setMarkStyle(e,this.generateRadiusStyle(r.state[a]),a,CU.User_Mark)}"emptyCircle"===e.name&&this.setMarkStyle(e,this.generateRadiusStyle(i.style),"normal",CU.User_Mark)},e.prototype.initLabelMarkStyle=function(t){var e=this;t&&this.setMarkStyle(t,{visible:$O(ZJ).bind(this),text:function(t){return t[e.getDimensionField()[0]]},fill:this.getColorAttribute(),z:this.dataToPositionZ.bind(this)})},e.prototype.afterInitMark=function(){t.prototype.afterInitMark.call(this)},e.prototype.initEvent=function(){var e;t.prototype.initEvent.call(this),null===(e=this._viewDataLabel.getDataView())||void 0===e||e.target.addListener("change",this.viewDataLabelUpdate.bind(this))},e.prototype.initGroups=function(){},e.prototype.onLayoutEnd=function(e){this._viewDataLabel.getDataView().reRunAllTransform(),this.onMarkPositionUpdate(),t.prototype.onLayoutEnd.call(this,e)},e.prototype.getDimensionField=function(){return this._seriesField?[this._seriesField]:[]},e.prototype.getMeasureField=function(){return this._specAngleField},e.prototype.viewDataLabelUpdate=function(){this.event.emit(cG.viewDataLabelUpdate,{model:this}),this._viewDataLabel.updateData()},e.prototype.generateRadiusStyle=function(t){var e=this;if(t){var i={};return t.outerRadius&&(i.outerRadius=function(){return e._computeLayoutRadius()*t.outerRadius}),t.innerRadius&&(i.innerRadius=function(){return e._computeLayoutRadius()*t.innerRadius}),t.cornerRadius&&(i.cornerRadius=function(){return e._computeLayoutRadius()*t.cornerRadius}),i}},e.prototype.computeCenter=function(t){return{x:this._pieMark.getAttribute("x",t,"normal"),y:this._pieMark.getAttribute("y",t,"normal")}},e.prototype.getRadius=function(t){var e,i,n,r,a,o,s;void 0===t&&(t="normal");var l="normal"===t?null===(n=null===(i=this.getSpec()[(null===(e=this._pieMark)||void 0===e?void 0:e.name)||"pie"])||void 0===i?void 0:i.style)||void 0===n?void 0:n.outerRadius:null===(s=null===(o=null===(a=this.getSpec()[(null===(r=this._pieMark)||void 0===r?void 0:r.name)||"pie"])||void 0===a?void 0:a.state)||void 0===o?void 0:o[t])||void 0===s?void 0:s.outerRadius;return null!=l?l:this._outerRadius},e.prototype.getInnerRadius=function(t){var e,i,n,r,a,o,s;void 0===t&&(t="normal");var l="normal"===t?null===(n=null===(i=this.getSpec()[(null===(e=this._pieMark)||void 0===e?void 0:e.name)||"pie"])||void 0===i?void 0:i.style)||void 0===n?void 0:n.innerRadius:null===(s=null===(o=null===(a=this.getSpec()[(null===(r=this._pieMark)||void 0===r?void 0:r.name)||"pie"])||void 0===a?void 0:a.state)||void 0===o?void 0:o[t])||void 0===s?void 0:s.innerRadius;return null!=l?l:this._innerRadius},e.prototype.computeRadius=function(t,e){return this._computeLayoutRadius()*t*(j(e)?1:e)+this._centerOffset},e.prototype.computeDatumRadius=function(t,e){return this._computeLayoutRadius()*this.getRadius(e)+this._centerOffset},e.prototype._compareSpec=function(e,i,n){n=null!=n?n:{data:!0};var r=["centerX","centerY","centerOffset","radius","innerRadius","cornerRadius","startAngle","endAngle","padAngle"];r.forEach((function(t){n[t]=!0}));var a=t.prototype._compareSpec.call(this,e,i,n);return e=null!=e?e:{},r.some((function(t){return e[t]!==i[t]}))&&(a.reRender=!0,a.change=!0),a},e.prototype.computeDatumInnerRadius=function(t,e){return this._computeLayoutRadius()*this.getInnerRadius(e)+this._centerOffset},e.prototype.dataToPosition=function(t,e){var i=t[jF];if(j(i))return null;if(e&&!this.isDatumInViewData(t))return null;var n=this.computeDatumRadius(t);return Pe(this.computeCenter(t),n,i)},e.prototype.initAnimation=function(){var t,e,i,n=this,r={growFrom:function(t,e,i){var r;if(i===rU.appear)return n._startAngle;if(i===rU.disappear)return n._endAngle;var a=[rU.disappear,rU.exit],o=e.mark.elements,s=t,l=null==s?void 0:s[Uz];if(void 0===o.find((function(t){var e;return(null===(e=t.data[0])||void 0===e?void 0:e[Uz])<l})))return n._startAngle;if(void 0===o.find((function(t){var e;return(null===(e=t.data[0])||void 0===e?void 0:e[Uz])>l})))return n._endAngle;var u=P([],E(o),!1).reverse().find((function(t){var e;return(null===(e=t.data[0])||void 0===e?void 0:e[Uz])<l}));return a.includes(i)?null===(r=null==u?void 0:u.getNextGraphicAttributes())||void 0===r?void 0:r.endAngle:null==u?void 0:u.getGraphicAttribute("endAngle",!0)}},a=null===(t=this._spec.animationAppear)||void 0===t?void 0:t.preset;this._pieMark&&((o=cX(null===(e=kz.getAnimationInKey("pie"))||void 0===e?void 0:e(r,a),hX("pie",this._spec,this._markAttributeContext))).normal&&o.normal.type&&(o.normal=function(t,e){var i,n,r,a,o=null!==(n=null===(i=e.options)||void 0===i?void 0:i.distance)&&void 0!==n?n:10,s=Q(e.duration)?e.duration/2:1e3,l=null!==(r=e.options.easing)&&void 0!==r?r:"cubicOut";return{oneByOne:e.oneByOne,loop:null!==(a=e.loop)&&void 0!==a&&a,timeSlices:[{duration:s,effects:{easing:l,channel:{x:{from:function(e){return t.getAttribute("x",e)},to:function(e){return t.getAttribute("x",e)+Pe({x:0,y:0},o,e[jF]).x}},y:{from:function(e){return t.getAttribute("y",e)},to:function(e){return t.getAttribute("y",e)+Pe({x:0,y:0},o,e[jF]).y}}}}},{duration:s,effects:{easing:l,channel:{x:{to:function(e){return t.getAttribute("x",e)},from:function(e){return t.getAttribute("x",e)+Pe({x:0,y:0},o,e[jF]).x}},y:{to:function(e){return t.getAttribute("y",e)},from:function(e){return t.getAttribute("y",e)+Pe({x:0,y:0},o,e[jF]).y}}}}}]}}(this._pieMark,o.normal)),this._pieMark.setAnimationConfig(o));if(this._emptyArcMark){var o=cX(null===(i=kz.getAnimationInKey("emptyCircle"))||void 0===i?void 0:i(r,null!=a?a:"fadeIn"));this._emptyArcMark.setAnimationConfig(o)}},e.prototype.getDefaultShapeType=function(){return"circle"},e.prototype.getGroupFields=function(){return[]},e.prototype.getStackGroupFields=function(){return[]},e.prototype.getStackValueField=function(){return""},e.prototype._noAnimationDataKey=function(t,e){return e},e.prototype.getActiveMarks=function(){return[this._pieMark]},e.transformerConstructor=qJ,e.mark=XJ,e}(RJ),$J=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.pie,i}return S(i,e),i.type=t.SeriesTypeEnum.pie,i}(QJ),tQ=function(){YJ(),kz.registerAnimation("pie",(function(t,e){return{appear:NJ(t,e),enter:zJ(t),exit:HJ(t),disappear:jJ(t)}})),kz.registerAnimation("emptyCircle",(function(t,e){return{appear:NJ(t,e)}})),kz.registerSeries($J.type,$J)},eQ=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i._support3d=!0,i}return S(e,t),e.type="arc3d",e}(GJ),iQ=function(){oX(),CP(),iP(),xj.registerGraphic(MH.arc3d,ky),kz.registerMark(eQ.type,eQ)},nQ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"pie3d")},e}(qJ),rQ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.pie3d,i._pieMarkName="pie3d",i._pieMarkType="arc3d",i.transformerConstructor=nQ,i}return S(i,e),i.prototype.setAttrFromSpec=function(){var t,i;e.prototype.setAttrFromSpec.call(this),this._angle3d=null!==(i=null===(t=this._spec)||void 0===t?void 0:t.angle3d)&&void 0!==i?i:-Math.PI/3},i.prototype.initMarkStyle=function(){var t=this;e.prototype.initMarkStyle.call(this);var i=this._pieMark;i&&this.setMarkStyle(i,{beta:function(){return t._angle3d}},"normal",CU.Series)},i.prototype.initLabelMarkStyle=function(t,i){t&&(e.prototype.initLabelMarkStyle.call(this,t),this.setMarkStyle(t,{support3d:!0},void 0,CU.Mark))},i.type=t.SeriesTypeEnum.pie3d,i.mark=KJ,i.transformerConstructor=nQ,i}(QJ),aQ=function(){kz.registerAnimation("pie3d",(function(t,e){return{appear:NJ(t,e),enter:zJ(t),exit:HJ(t),disappear:jJ(t)}})),iQ(),kz.registerSeries(rQ.type,rQ)},oQ=function(t){var e="angle"===t.growField?0:t.innerRadius;return"angle"===t.growField?{type:"angle"===t.growField?"growAngleIn":"growRadiusIn"}:{channel:{innerRadius:{from:e,to:function(t,e){var i;return null===(i=e.getFinalGraphicAttributes())||void 0===i?void 0:i.innerRadius}},outerRadius:{from:e,to:function(t,e){var i;return null===(i=e.getFinalGraphicAttributes())||void 0===i?void 0:i.outerRadius}}}}},sQ={type:"fadeIn"},lQ=function(t){return{type:"angle"===t.growField?"growAngleIn":"growRadiusIn"}},uQ=function(t){return{type:"angle"===t.growField?"growAngleOut":"growRadiusOut"}},cQ=function(t){return{type:"angle"===t.growField?"growAngleOut":"growRadiusOut"}};function hQ(t,e){if(!1===e)return{};switch(e){case"fadeIn":return sQ;case"growAngle":return oQ(A(A({},t),{growField:"angle"}));default:return oQ(A(A({},t),{growField:"radius"}))}}var dQ,pQ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype.getStackGroupFields=function(){return this._angleField},e.prototype.getStackValueField=function(){return xt(this._spec.valueField)[0]||xt(this._spec.radiusField)[0]},e.prototype.getGroupFields=function(){return this._angleField},e.prototype.setAttrFromSpec=function(){t.prototype.setAttrFromSpec.call(this),this.setAngleField(this._spec.categoryField||this._spec.angleField),this.setRadiusField(this._spec.valueField||this._spec.radiusField),this._specAngleField=this._angleField.slice(),this._specRadiusField=this._radiusField.slice(),this.setInnerRadiusField(this._spec.valueField||this._spec.radiusField),this.getStack()&&this.setValueFieldToStack(),this.getPercent()&&this.setValueFieldToPercent()},e.prototype.setValueFieldToStack=function(){this.setRadiusField(Jz),this.setInnerRadiusField(Zz)},e.prototype.setValueFieldToPercent=function(){this.setRadiusField($z),this.setInnerRadiusField(Qz)},e.prototype.getDimensionField=function(){return this._specAngleField},e.prototype.getMeasureField=function(){return this._specRadiusField},e.prototype.getDefaultShapeType=function(){return"square"},e}(RJ),fQ=A(A({},WY),((dQ={}).rose={name:"rose",type:"arc"},dQ)),vQ=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._supportStack=!0,e}return S(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"rose")},e}(mX),gQ=function(e){function i(t,i){var n=e.call(this,t,i)||this;return n.type=B.polarAxis,n.name=B.polarAxis,n._defaultBandPosition=0,n._defaultBandInnerPadding=0,n._defaultBandOuterPadding=0,n.layoutType="absolute",n.layoutZIndex=wU.Axis,n._tick=void 0,n._center=null,n._startAngle=WF,n._endAngle=GF,n._orient="radius",n._groupScales=[],n.effect={scaleUpdate:function(t){n.computeData(null==t?void 0:t.value),XO(n._regions,(function(t){"radius"===n.getOrient()?$X(t.radiusAxisHelper,n.axisHelper(),N(n._seriesUserId)||N(n._seriesIndex))&&(t.radiusAxisHelper=n.axisHelper()):$X(t.angleAxisHelper,n.axisHelper(),N(n._seriesUserId)||N(n._seriesIndex))&&(t.angleAxisHelper=n.axisHelper())}),{userId:n._seriesUserId,specIndex:n._seriesIndex})}},n._transformLayoutPosition=function(t){var e,i=null===(e=n.getRegions())||void 0===e?void 0:e[0];return i?i.getLayoutStartPoint():t},n.getCenter=function(){var t,e,i=n.getRefLayoutRect(),r=i.width,a=i.height;return{x:mF(null===(t=n._center)||void 0===t?void 0:t.x,r,i,r/2),y:mF(null===(e=n._center)||void 0===e?void 0:e.y,a,i,a/2)}},n.getRefLayoutRect=function(){return n.getRegions()[0].getLayoutRect()},n._coordinateType="polar",n}return S(i,e),Object.defineProperty(i.prototype,"center",{get:function(){return this._center},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"startAngle",{get:function(){return this._startAngle},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"endAngle",{get:function(){return this._endAngle},enumerable:!1,configurable:!0}),i.prototype.getOrient=function(){return this._orient},i.prototype.getDefaultInteractive=function(){return"angle"!==this._orient},i.prototype.getGroupScales=function(){return this._groupScales},i.getSpecInfo=function(t){var e=this;if(!t[this.specKey])return null;var i,n,r=X(t[this.specKey]),a=r?t[this.specKey]:[t[this.specKey]],o=[],s=[],l=[];return a.forEach((function(a,u){if("angle"===(h=null==(c=a)?void 0:c.orient)||"radius"===h){var c,h,d=function(t,e){var i,n,r,a,o,s,l=null!==(i=t.type)&&void 0!==i?i:"angle"===t.orient?"band":"linear",u="".concat(B.polarAxis,"-").concat(l),c=null!==(n=t.startAngle)&&void 0!==n?n:e.startAngle,h=null!==(r=t.endAngle)&&void 0!==r?r:e.endAngle;return{axisType:l,componentName:u,startAngle:null!=c?c:-90,endAngle:null!=h?h:N(c)?c+360:270,center:N(e.center)?e.center:N(null==e?void 0:e.centerX)||N(null==e?void 0:e.centerY)?{x:null==e?void 0:e.centerX,y:null==e?void 0:e.centerY}:void 0,outerRadius:null!==(s=null!==(o=null!==(a=t.outerRadius)&&void 0!==a?a:t.radius)&&void 0!==o?o:e.outerRadius)&&void 0!==s?s:e.radius,layoutRadius:e.layoutRadius}}(a,t),p=d.axisType,f=d.componentName,v=d.startAngle,g=d.endAngle,y=d.center,m=d.outerRadius,_=d.layoutRadius;a.center=y,a.startAngle=v,a.endAngle=g,a.outerRadius=m,a.type=p,a.layoutRadius=_;var b={spec:a,specPath:r?[e.specKey,u]:[e.specKey],specInfoPath:["component",e.specKey,u],type:f};o.push(b),"radius"===a.orient?(s.push(b),n=u):(l.push(b),i=u)}})),s.forEach((function(t){t.angleAxisIndex=i})),l.forEach((function(t){t.radiusAxisIndex=n})),o},i.createComponent=function(t,e){var i=t.spec,n=M(t,["spec"]),r=kz.getComponentInKey(n.type);return r?new r(i,A(A({},e),n)):(e.onError("Component ".concat(n.type," not found")),null)},i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),this.visible&&(this._axisStyle=this._getAxisAttributes(),this._gridStyle=this._getGridAttributes()),this._tick=this._spec.tick,this._orient="angle"===this._spec.orient?"angle":"radius",this._center=this._spec.center,this._startAngle=we(this._spec.startAngle),this._endAngle=we(this._spec.endAngle),this._inverse=this._spec.inverse},i.prototype.onRender=function(t){},i.prototype.changeRegions=function(){},i.prototype._tickTransformOption=function(){var t,i=this;return A(A({},e.prototype._tickTransformOption.call(this)),{noDecimal:null===(t=this._tick)||void 0===t?void 0:t.noDecimals,startAngle:this.startAngle,labelOffset:YX(this._spec),getRadius:function(){return i.getOuterRadius()},inside:this._spec.inside})},i.prototype.updateScaleRange=function(){var t,e=this._scale.range();return t="radius"===this.getOrient()?this._inverse?[this.computeLayoutOuterRadius(),this.computeLayoutInnerRadius()]:[this.computeLayoutInnerRadius(),this.computeLayoutOuterRadius()]:this._inverse?[this._endAngle,this._startAngle]:[this._startAngle,this._endAngle],(!e||!t||e[0]!==t[0]||e[1]!==t[1])&&(this._scale.range(t),!0)},i.prototype.collectSeriesField=function(t,e){var i,n;return t>0?null===(n=null===(i=e.getGroups())||void 0===i?void 0:i.fields)||void 0===n?void 0:n[t]:"radius"===this.getOrient()?e.getRadiusField():e.getAngleField()},i.prototype.updateSeriesScale=function(){var t=this;XO(this._regions,(function(e){"radius"===t.getOrient()?$X(e.radiusAxisHelper,t.axisHelper(),N(t._seriesUserId)||N(t._seriesIndex))&&(e.setRadiusScale(t._scale),e.radiusAxisHelper=t.axisHelper()):$X(e.angleAxisHelper,t.axisHelper(),N(t._seriesUserId)||N(t._seriesIndex))&&(e.setAngleScale(t._scale),e.angleAxisHelper=t.axisHelper())}),{userId:this._seriesUserId,specIndex:this._seriesIndex})},i.prototype.getSeriesStatisticsField=function(t){var e="radius"===this.getOrient()?t.getRadiusField():t.getAngleField();return NB(this._scale.type)?e:[e[0]]},i.prototype.initGroupScales=function(){},i.prototype.axisHelper=function(){var t=this;return{isContinuous:NB(this._scale.type),dataToPosition:this.dataToPosition.bind(this),coordToPoint:this.coordToPoint.bind(this),pointToCoord:this.pointToCoord.bind(this),center:this.getCenter.bind(this),layoutRadius:this._computeLayoutRadius.bind(this),getScale:function(e){return void 0===e&&(e=0),t._scales[e]},getAxisId:function(){return t.id},getSpec:function(){return t._spec}}},i.prototype.positionToData=function(t){var e=this.pointToCoord(t);return"radius"===this.getOrient()?this.invert(e.radius):this.invert(e.angle)},i.prototype.coordToPoint=function(t){return Pe(this.getCenter(),t.radius,t.angle)},i.prototype.pointToCoord=function(t){return Re(t,this.getCenter(),this._startAngle,this._endAngle)},i.prototype.getOuterRadius=function(){return this.computeLayoutOuterRadius()},i.prototype.getInnerRadius=function(){return this.computeLayoutInnerRadius()},i.prototype.updateLayoutAttribute=function(){this._visible&&("radius"===this.getOrient()?this._layoutRadiusAxis():this._layoutAngleAxis()),e.prototype.updateLayoutAttribute.call(this)},i.prototype._getNormalizedValue=function(t,e){return 0===e?0:(this.dataToPosition(t)-this._getStartValue())/e},i.prototype.getLabelItems=function(t){var e,i=this,n=null===(e=this.getTickData())||void 0===e?void 0:e.getLatestData();return n&&n.length?[n.map((function(e){return QX(e.value,i._getNormalizedValue([e.value],t))}))]:[]},i.prototype._getStartValue=function(){return"radius"===this.getOrient()?this.computeLayoutInnerRadius():this._startAngle},i.prototype._layoutAngleAxis=function(){var t,e,i,n=this.getCenter(),r=this.computeLayoutOuterRadius(),a=this.computeLayoutInnerRadius(),o=this._endAngle-this._startAngle,s=this.getLabelItems(o),l=A(A({},this.getLayoutStartPoint()),{inside:this._spec.inside,center:n,radius:r,innerRadius:a,startAngle:this._startAngle,endAngle:this._endAngle,sides:(null===(i=null===(e=null===(t=this._getRelatedAxis(this._option.radiusAxisIndex))||void 0===t?void 0:t.getSpec())||void 0===e?void 0:e.grid)||void 0===i?void 0:i.smooth)?void 0:this.getScale().domain().length}),u=A(A({},l),{size:this.getRefLayoutRect(),title:{text:this._spec.title.text||this._dataFieldText},items:s,orient:"angle"});this._spec.grid.visible&&(u.grid=A({type:"line",smoothLink:!0,items:s[0]},l)),this._update(u)},i.prototype._layoutRadiusAxis=function(){var t,e,i,n=this.getCenter(),r=this.computeLayoutOuterRadius(),a=this.computeLayoutInnerRadius(),o=this.coordToPoint({angle:this._startAngle,radius:r}),s=this.coordToPoint({angle:this._startAngle,radius:a}),l=Me.distancePP(s,o),u=this.getLabelItems(l),c=A(A({},this.getLayoutStartPoint()),{start:s,end:o,verticalFactor:-1}),h=A(A({},c),{title:{text:this._spec.title.text||this._dataFieldText},items:u,orient:"radius"});(null===(t=this._spec.grid)||void 0===t?void 0:t.visible)&&(h.grid=A({items:u[0],type:(null===(e=this._spec.grid)||void 0===e?void 0:e.smooth)?"circle":"polygon",center:n,closed:!0,sides:null===(i=this._getRelatedAxis(this._option.angleAxisIndex))||void 0===i?void 0:i.getScale().domain().length,startAngle:this._startAngle,endAngle:this._endAngle},c)),this._update(h)},i.prototype._getRelatedAxis=function(t){if(N(t))return this._option.getComponentByIndex(this.specKey,t)},i.prototype._computeLayoutRadius=function(){var t=this;return JJ((function(){return t._spec.layoutRadius}),this.getRefLayoutRect,this.getCenter,(function(){return{startAngle:t._startAngle,endAngle:t._endAngle}}))},i.prototype.computeLayoutOuterRadius=function(){var t,e=null!==(t=this._spec.outerRadius)&&void 0!==t?t:this._spec.radius,i=null!=e?e:this.getRefSeriesRadius().outerRadius;return this._computeLayoutRadius()*i},i.prototype.computeLayoutInnerRadius=function(){var t,e=null!==(t=this._spec.innerRadius)&&void 0!==t?t:this.getRefSeriesRadius().innerRadius;return this._computeLayoutRadius()*e},i.prototype.getRefSeriesRadius=function(){var e=UF,i=0,n=this.getChart().getSpec();return XO(this.getRegions(),(function(r){var a,o=r;if(a=o.type,[t.SeriesTypeEnum.rose,t.SeriesTypeEnum.radar,t.SeriesTypeEnum.circularProgress].includes(a)){var s=o.outerRadius,l=void 0===s?n.outerRadius:s,u=o.innerRadius,c=void 0===u?n.innerRadius:u;Q(l)&&(e=l),Q(c)&&(i=c)}}),{userId:this._seriesUserId,specIndex:this._seriesIndex}),{outerRadius:e,innerRadius:i}},i.prototype._update=function(t){var e=t.grid,i=M(t,["grid"]);(this._axisMark.getProduct().encode(xz({},this._axisStyle,i)),this._gridMark)&&this._gridMark.getProduct().encode(xz({},this._gridStyle,e))},i.prototype.invert=function(t){var e;if("angle"===this.getOrient()&&"band"===this._scale.type){var i=this._scale.range(),n=i[i.length-1]-i[0],r=.5===(null!==(e=this.getSpec().bandPosition)&&void 0!==e?e:this._defaultBandPosition)?0:this._scale.bandwidth()/2;if(i[0]<0){var a=(t+r+Math.abs(i[0]))%n-Math.abs(i[0]);return this._scale.invert(a)}return this._scale.invert((t+r)%n)}return this._scale.invert(t)},i.type=B.polarAxis,i.specKey="axes",i}(lK),yQ=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=B.polarLinearAxis,e._zero=!0,e._nice=!0,e._extend={},e._scale=new II,e}return S(e,t),e.prototype.setAttrFromSpec=function(){t.prototype.setAttrFromSpec.call(this),this.setExtraAttrFromSpec()},e.prototype.initScales=function(){t.prototype.initScales.call(this),this.setScaleNice()},e.prototype.computeDomain=function(t){return this.computeLinearDomain(t)},e.prototype.axisHelper=function(){var e=t.prototype.axisHelper.call(this);return e.setExtendDomain=this.setExtendDomain.bind(this),e},e.prototype.registerTicksTransform=function(){var t="".concat(this.type,"-ticks");return qG(this._option.dataSet,t,GI),t},e.type=B.polarLinearAxis,e.specKey="axes",e}(gQ);bt(yQ,bK);var mQ=function(){MV(),RV(),wV(),BV(),uK(),kz.registerComponent(yQ.type,yQ)},_Q=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=B.polarBandAxis,e._scale=new dI,e}return S(e,t),e.prototype.computeDomain=function(t){return this.computeBandDomain(t)},e.prototype.updateScaleRange=function(){var e=t.prototype.updateScaleRange.call(this);return this.updateGroupScaleRange(),e},e.prototype.axisHelper=function(){var e=t.prototype.axisHelper.call(this);return A(A({},e),{getBandwidth:function(t){return e.getScale(t).bandwidth()}})},e.prototype.initScales=function(){t.prototype.initScales.call(this),this.calcScales(this._defaultBandInnerPadding,this._defaultBandOuterPadding)},e.prototype.registerTicksTransform=function(){var t="".concat(this.type,"-ticks");return qG(this._option.dataSet,t,QI),t},e.prototype.transformScaleDomain=function(){},e.type=B.polarBandAxis,e.specKey="axes",e}(gQ);bt(_Q,SK);var bQ=function(){MV(),RV(),wV(),BV(),uK(),kz.registerComponent(_Q.type,_Q)},xQ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.rose,i.transformerConstructor=vQ,i._roseMark=null,i._labelMark=null,i}return S(i,e),i.prototype.initMark=function(){this.initRoseMark()},i.prototype.initMarkStyle=function(){this.initRoseMarkStyle()},i.prototype._buildMarkAttributeContext=function(){var t=this;e.prototype._buildMarkAttributeContext.call(this),this._markAttributeContext.getCenter=function(){return{x:function(){return t.angleAxisHelper.center().x},y:function(){return t.angleAxisHelper.center().y}}},this._markAttributeContext.startAngleScale=function(e){return t.startAngleScale(e)},this._markAttributeContext.endAngleScale=function(e){return t.endAngleScale(e)}},i.prototype.initRoseMark=function(){var t,e;this._roseMark=this._createMark(i.mark.rose,{groupKey:this._seriesField,isSeriesMark:!0,stateSort:null===(t=this._spec.rose)||void 0===t?void 0:t.stateSort},{setCustomizedShape:null===(e=this._spec.rose)||void 0===e?void 0:e.customShape,morph:fX(this._spec,i.mark.rose.name),morphElementKey:this.getDimensionField()[0]})},i.prototype.getRoseAngle=function(){var t,e,i;return null!==(i=null===(e=(t=this.angleAxisHelper).getBandwidth)||void 0===e?void 0:e.call(t,this._groups?this._groups.fields.length-1:0))&&void 0!==i?i:.5},i.prototype.startAngleScale=function(t){return this.angleAxisHelper.dataToPosition(this.getDatumPositionValues(t,this.getGroupFields()))-.5*this.angleAxisHelper.getBandwidth(this.getGroupFields().length-1)},i.prototype.endAngleScale=function(t){return this.angleAxisHelper.dataToPosition(this.getDatumPositionValues(t,this.getGroupFields()))+this.getRoseAngle()-.5*this.angleAxisHelper.getBandwidth(this.getGroupFields().length-1)},i.prototype.initRoseMarkStyle=function(){var t=this,e=this._roseMark;e&&this.setMarkStyle(e,{x:function(){return t.angleAxisHelper.center().x},y:function(){return t.angleAxisHelper.center().y},startAngle:function(e){return t.startAngleScale(e)},endAngle:function(e){return t.endAngleScale(e)},fill:this.getColorAttribute(),outerRadius:function(e){return fF(t.radiusAxisHelper.dataToPosition([e[t._radiusField[0]]]),t.radiusAxisHelper.getScale(0))},innerRadius:function(e){var i;if(!t.getStack())return 0;var n=fF(t.radiusAxisHelper.dataToPosition([e[t._innerRadiusField[0]]]),t.radiusAxisHelper.getScale(0));return n<=Number.MIN_VALUE?t._computeLayoutRadius()*(null!==(i=t._spec.innerRadius)&&void 0!==i?i:0):n}})},i.prototype.initTooltip=function(){e.prototype.initTooltip.call(this),this._roseMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._roseMark)},i.prototype.initLabelMarkStyle=function(t){var e=this;t&&this.setMarkStyle(t,{text:function(t){return t[e.getDimensionField()[0]]},fill:this.getColorAttribute(),z:0})},i.prototype.initAnimation=function(){var t,e,i,n=this,r=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;if(this._roseMark){var a={innerRadius:function(){var t;return n._computeLayoutRadius()*(null!==(t=n._spec.innerRadius)&&void 0!==t?t:0)}};this._roseMark.setAnimationConfig(cX(null===(i=kz.getAnimationInKey("rose"))||void 0===i?void 0:i(a,r),hX("rose",this._spec,this._markAttributeContext)))}},i.prototype.getDefaultShapeType=function(){return"circle"},i.prototype.getActiveMarks=function(){return[this._roseMark]},i.type=t.SeriesTypeEnum.rose,i.mark=fQ,i.transformerConstructor=vQ,i}(pQ),kQ=function(){kz.registerSeries(xQ.type,xQ),YJ(),kz.registerAnimation("rose",(function(t,e){return{appear:hQ(t,e),enter:lQ(t),exit:uQ(t),disappear:cQ(t)}})),bQ(),mQ()},SQ=function(t){function e(e,i,n,r,a){var o=t.call(this,e,i,n,r,a)||this;return o._center=i.center,o._prevCenter=e.center,o._center&&o._prevCenter||(o.valid=!1),o}return S(e,t),e.prototype.getEndProps=function(){return!1===this.valid?{}:Pe(this._center,this._toRadius,this._toAngle)},e.prototype.onBind=function(){var t=Re(this.from,this._prevCenter),e=t.angle,i=t.radius,n=Re(this.to,this._center),r=n.angle,a=n.radius;Q(r*a)||(this.valid=!1),this._fromAngle=Q(e)?e:r,this._fromRadius=Q(i)?i:a,this._toAngle=r,this._toRadius=a,zO(this._fromAngle,this._toAngle)&&zO(this._fromRadius,this._toRadius)&&(this.valid=!1)},e.prototype.onUpdate=function(t,e,i){if(!1===this.valid)return i.x=this.to.x,void(i.y=this.to.y);if(t){var n=this.getEndProps(),r=n.x,a=n.y;i.x=r,i.y=a,i.center=this._center}else{var o=Pe({x:this._prevCenter.x+(this._center.x-this._prevCenter.x)*e,y:this._prevCenter.y+(this._center.y-this._prevCenter.y)*e},this._fromRadius+(this._toRadius-this._fromRadius)*e,this._fromAngle+(this._toAngle-this._fromAngle)*e);r=o.x,a=o.y;i.x=r,i.y=a}},e}(Yh),AQ=function(t){function e(e,i,n,r,a){var o=t.call(this,e,i,n,r,a)||this;return o._center=i.center,o._prevCenter=e.center,o}return S(e,t),e.prototype.onUpdate=function(t,e,i){var n=this;this.points=this.points.map((function(r,a){var o=n.polarPointInterpolation(n.interpolatePoints[a][0],n.interpolatePoints[a][1],e);return t&&(i.center=n._center),o.context=r.context,o})),i.points=this.points},e.prototype._interpolationSinglePoint=function(t,e,i){if(!YO(t)&&!YO(e))return e;var n=Re(t,this._prevCenter),r=Re(e,this._center),a=Ie(n.angle),o=Ie(r.angle);!Q(a)&&Q(o)&&(a=o),Q(a)&&!Q(o)&&(o=a);var s=a+(o-a)*i,l=n.radius+(r.radius-n.radius)*i;return Pe({x:this._prevCenter.x+(this._center.x-this._prevCenter.x)*i,y:this._prevCenter.y+(this._center.y-this._prevCenter.y)*i},l,s)},e.prototype.polarPointInterpolation=function(t,e,i){var n=this._interpolationSinglePoint(t,e,i),r=n.x,a=n.y,o=this._interpolationSinglePoint({x:t.x1,y:t.y1},{x:e.x1,y:e.y1},i),s=o.x,l=o.y,u=new Ae(r,a,s,l);return u.defined=e.defined,u},e}(md),MQ=function(t){return{type:"in"===t?"fadeIn":"fadeOut"}};function wQ(t,e,i){return"fadeIn"===e?MQ(i):function(t,e){return{type:"in"===e?"growPointsIn":"growPointsOut",options:function(){return{center:t.center()}}}}(t,i)}function TQ(t,e,i){return"fadeIn"===e?MQ(i):function(t,e){var i=function(){var e;return null===(e=t.center())||void 0===e?void 0:e.x},n=function(t,e){return e.getGraphicAttribute("x")},r=function(){var e;return null===(e=t.center())||void 0===e?void 0:e.y},a=function(t,e){return e.getGraphicAttribute("y")};return"in"===e?{channel:{x:{from:i,to:n},y:{from:r,to:a}}}:{channel:{x:{from:n,to:i},y:{from:a,to:r}}}}(t,i)}var CQ,EQ=function(t,e){return{custom:bd,customParameters:function(i,n){var r;return{group:n.getGraphicItem(),startAngle:null!==(r=t.startAngle)&&void 0!==r?r:Math.PI/2,orient:"clockwise",center:t.center(),radius:t.radius(),animationType:e}}}},PQ=A(A(A({},WY),wX),((CQ={}).area={name:"area",type:"area"},CQ)),RQ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.radar,i.transformerConstructor=DX,i._sortDataByAxis=!1,i}return S(i,e),i.prototype.initGroups=function(){},i.prototype.compile=function(){e.prototype.compile.call(this),this.addOverlapCompile()},i.prototype.initMark=function(){var t,e,i,n,r={progressiveStep:this._spec.progressiveStep,progressiveThreshold:this._spec.progressiveThreshold,large:this._spec.large,largeThreshold:this._spec.largeThreshold},a=!1!==(null===(t=this._spec.area)||void 0===t?void 0:t.visible)&&!1!==(null===(i=null===(e=this._spec.area)||void 0===e?void 0:e.style)||void 0===i?void 0:i.visible),o=null!==(n=this._spec.seriesMark)&&void 0!==n?n:"area";this.initAreaMark(r,a&&"area"===o),this.initLineMark(r,"line"===o||"area"===o&&!a),this.initSymbolMark(r,"point"===o)},i.prototype.initMarkStyle=function(){var t=this;this.initAreaMarkStyle(),this.initLineMarkStyle(),this.initSymbolMarkStyle(),[this._lineMark,this._symbolMark,this._areaMark].forEach((function(e){e&&t.setMarkStyle(e,{center:function(){var e;return null===(e=t.angleAxisHelper)||void 0===e?void 0:e.center()}})}))},i.prototype.initAreaMark=function(t,e){var n,r;this._areaMark=this._createMark(i.mark.area,{groupKey:this._seriesField,isSeriesMark:e,stateSort:null===(n=this._spec.area)||void 0===n?void 0:n.stateSort},A(A({},t),{setCustomizedShape:null===(r=this._spec.area)||void 0===r?void 0:r.customShape}))},i.prototype.initAreaMarkStyle=function(){var t=this,e=this._areaMark;e&&(this.setMarkStyle(e,{x:this.dataToPositionX.bind(this),y:this.dataToPositionY.bind(this),x1:function(e){return e&&t.angleAxisHelper&&t.radiusAxisHelper?t.valueToPosition(t.getDatumPositionValues(e,t._angleField),t.getStack()?t.getDatumPositionValues(e,t._innerRadiusField):t.radiusScale.domain()[0]).x:Number.NaN},y1:function(e){return e&&t.angleAxisHelper&&t.radiusAxisHelper?t.valueToPosition(t.getDatumPositionValues(e,t._angleField),t.getStack()?t.getDatumPositionValues(e,t._innerRadiusField):t.radiusScale.domain()[0]).y:Number.NaN},fill:this.getColorAttribute(),curveType:MX,closePath:!0},"normal",CU.Series),"zero"!==this._invalidType&&this.setMarkStyle(e,{defined:this._getInvalidDefined.bind(this),connectedType:this._getInvalidConnectType()},"normal",CU.Series),this.event.on(cG.viewDataStatisticsUpdate,{filter:function(e){return e.model===t}},(function(){t.encodeDefined(e,"defined")})))},i.prototype.initTooltip=function(){e.prototype.initTooltip.call(this);var t=this._tooltipHelper.activeTriggerSet,i=t.group,n=t.mark;this._lineMark&&i.add(this._lineMark),this._areaMark&&i.add(this._areaMark),this._symbolMark&&(n.add(this._symbolMark),i.add(this._symbolMark))},i.prototype.initAnimation=function(){var t,e,i,n,r=this,a={center:function(){var t;return null===(t=r.angleAxisHelper)||void 0===t?void 0:t.center()},radius:function(){var t=r.getLayoutRect();return Math.min(t.width,t.height)},startAngle:N(this._spec.startAngle)?we(this._spec.startAngle):WF},o=null!==(i=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset)&&void 0!==i?i:"clipIn";"clipIn"===o&&this._rootMark&&this._rootMark.setAnimationConfig(cX(null===(n=kz.getAnimationInKey("radarGroup"))||void 0===n?void 0:n(a,o),hX("group",this._spec,this._markAttributeContext))),[[this._areaMark,"radar"],[this._lineMark,"radar"],[this._symbolMark,"radarSymbol"]].forEach((function(t){var e=E(t,2),i=e[0],n=e[1];if(N(i)){var s=kz.getAnimationInKey(n);i.setAnimationConfig(cX(null==s?void 0:s(a,o),hX(i.name,r._spec,r._markAttributeContext)))}}))},i.prototype.getDefaultShapeType=function(){return"square"},i.prototype.getActiveMarks=function(){return[this._areaMark,this._symbolMark,this._lineMark]},i.prototype.getSeriesStyle=function(t){var e=this;return function(i){var n,r,a,o,s=null!==(r=null===(n=e._seriesMark)||void 0===n?void 0:n.getAttribute(i,t))&&void 0!==r?r:void 0;return"fill"!==i||s||(i="stroke",s=null!==(o=null===(a=e._seriesMark)||void 0===a?void 0:a.getAttribute(i,t))&&void 0!==o?o:void 0),"stroke"===i&&X(s)?s[0]:s}},i.type=t.SeriesTypeEnum.radar,i.mark=PQ,i.transformerConstructor=DX,i}(pQ);bt(RQ,TX);var BQ,IQ,LQ,DQ,OQ=function(){kz.registerSeries(RQ.type,RQ),KK(),RX(),LX(),kz.registerAnimation("radar",(function(t,e){return{appear:"clipIn"===e?void 0:wQ(t,e,"in"),enter:wQ(t,e,"in"),exit:wQ(t,e,"out"),disappear:"clipIn"===e?void 0:wQ(t,e,"out"),update:[{options:{excludeChannels:["points","defined","center"]}},{channel:["points","center"],custom:AQ,customParameters:t,duration:QY.update.duration,easing:QY.update.easing}]}})),kz.registerAnimation("radarSymbol",(function(t,e){return{appear:"clipIn"===e?void 0:TQ(t,e,"in"),enter:{type:"scaleIn"},exit:{type:"scaleOut"},disappear:"clipIn"===e?void 0:TQ(t,e,"out"),update:[{options:{excludeChannels:["x","y","center"]}},{channel:["x","y","center"],custom:SQ,customParameters:t,duration:QY.update.duration,easing:QY.update.easing}]}})),kz.registerAnimation("radarGroup",(function(t,e){return{appear:EQ(t,"in"),disappear:EQ(t,"out")}})),tP(),bQ(),mQ()},FQ=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.shapeTypeCallback=function(){return"square"},e}return S(e,t),e.prototype.enableByType=function(t){return"mark"===t},e.prototype.getDefaultTitlePattern=function(t){return{key:"event info",value:"event info"}},e.prototype.getDefaultContentList=function(){return[{key:function(t){return t.type},value:function(t){return t.id}},{key:"event_time",value:function(t){return Yi.getInstance().timeFormat("%Y%m%d",t.event_time)}},{key:"action_type",value:function(t){return t.action_type}},{key:"children",value:function(t){return t.children}}]},e.prototype.getTooltipData=function(e,i,n,r,a){var o,s,l,u,c=t.prototype.getTooltipData.call(this,e,i,n,r,a),h=null!==(l=null===(s=null===(o=this.spec)||void 0===o?void 0:o[e])||void 0===s?void 0:s.updateContent)&&void 0!==l?l:null===(u=null==i?void 0:i[e])||void 0===u?void 0:u.updateContent;return c&&!h&&(c.updateContent=function(t,e,i){var n=[],r=t.filter((function(t){return"children"===t.key}));return r.length>0&&r[0].value.forEach((function(t){var e=!0;for(var i in t)n.push(A(A({},r[0]),{shapeType:"circle",hasShape:e,key:i,value:t[i]+""})),e=!1})),t.concat(n)}),c},e}(PY),zQ=function(t,e){var i,n=(null===(i=t[0])||void 0===i?void 0:i.latestData)?t[0].latestData:t||[],r=[];return n.forEach((function(t){var i={};for(var n in t)n!==e&&(i[n]=t[n]);var a=t[e];null==a||a.forEach((function(t){r.push(Object.assign({},i,t))}))})),r},HQ={fill:"#bbb",fillOpacity:.2},jQ=A(A({},WY),((BQ={}).group={name:"group",type:"group"},BQ.grid={name:"grid",type:"rule"},BQ.gridBackground={name:"gridBackground",type:"rect"},BQ.dot={name:"dot",type:"symbol"},BQ.title={name:"title",type:"text"},BQ.subTitle={name:"subTitle",type:"text"},BQ.symbol={name:"symbol",type:"symbol"},BQ)),NQ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.dot,i}return S(i,e),i.prototype.getSeriesGroupField=function(){return this._seriesField},i.prototype.setSeriesGroupField=function(t){N(t)&&(this._seriesGroupField=t)},i.prototype.getTitleField=function(){return this._titleField},i.prototype.setTitleField=function(t){N(t)&&(this._titleField=t)},i.prototype.getSubTitleField=function(){return this._subTitleField},i.prototype.setSubTitleField=function(t){N(t)&&(this._subTitleField=t)},i.prototype.getDotTypeField=function(){return this._dotTypeField},i.prototype.setDotTypeField=function(t){N(t)&&(this._dotTypeField=t)},i.prototype.getHighLightSeriesGroup=function(){return this._highLightSeriesGroup},i.prototype.setHighLightSeriesGroup=function(t){N(t)&&(this._highLightSeriesGroup=t)},i.prototype.setGridBackground=function(t){N(t)&&(this._gridBackground=t)},i.prototype.initData=function(){var t,i=this;e.prototype.initData.call(this),this._xDimensionStatisticsDomain=this.getRawData().latestData.map((function(t){return t[i._fieldY[0]]})),qG(this._option.dataSet,"objFlat",zQ),qG(this._option.dataSet,"copyDataView",oU),ZG(this._option.dataSet,"dataview",os),null===(t=this.getViewData())||void 0===t||t.transform({type:"objFlat",options:"dots",level:nU.dotObjFlat},!1)},i.prototype.getStatisticFields=function(){return[{key:this._fieldY[0],operations:["values"],customize:this._xDimensionStatisticsDomain}]},i.prototype.setAttrFromSpec=function(){var t;e.prototype.setAttrFromSpec.call(this),this.setSeriesGroupField(this._spec.seriesGroupField),this.setTitleField(this._spec.titleField),this.setSubTitleField(this._spec.subTitleField),this.setDotTypeField(this._spec.dotTypeField),this.setHighLightSeriesGroup(this._spec.highLightSeriesGroup),this.setGridBackground(xz(HQ,(null===(t=this._spec.grid)||void 0===t?void 0:t.background)||{}))},i.prototype.initMark=function(){this._clipMark=this._createMark(i.mark.group),this._containerMark=this._createMark(i.mark.group,{parent:this._clipMark,dataView:this.getRawData()}),this._gridBackgroundMark=this._createMark(i.mark.gridBackground,{parent:this._containerMark,dataView:this.getRawData()}),this._gridMark=this._createMark(i.mark.grid,{parent:this._containerMark,dataView:this.getRawData()}),this._dotMark=this._createMark(i.mark.dot,{skipBeforeLayouted:!1,isSeriesMark:!0,parent:this._containerMark}),this._titleMark=this._createMark(i.mark.title,{parent:this._containerMark,dataView:this.getRawData()}),this._subTitleMark=this._createMark(i.mark.subTitle,{parent:this._containerMark,dataView:this.getRawData()}),this._symbolMark=this._createMark(i.mark.symbol,{parent:this._containerMark,dataView:this.getRawData()})},i.prototype.initMarkStyle=function(){var t=this,e=this._clipMark;e&&(this.setMarkStyle(e,{x:-this._spec.leftAppendPadding,y:0,width:1e4,height:this._spec.clipHeight},"normal",CU.Series),e.setMarkConfig({interactive:!1,clip:!0}));var i=this._containerMark;i&&(this.setMarkStyle(i,{x:this._spec.leftAppendPadding},"normal",CU.Series),i.setMarkConfig({interactive:!1}));var n=this._gridBackgroundMark;n&&this.setMarkStyle(n,{x:this.getRegionRectLeft.bind(this),x1:this.getRegionRectRight.bind(this),y:this.dataToGridBackgroundPositionY.bind(this),y1:this.dataToGridBackgroundPositionY1.bind(this),fill:this._gridBackground.fill,fillOpacity:this.dataToGridBackgroundOpacity.bind(this)},"normal",CU.Series);var r=this._gridMark;r&&this.setMarkStyle(r,{stroke:this.getColorAttribute(),x:this.getRegionRectLeft.bind(this),y:this.dataToPositionY.bind(this),x1:this.getRegionRectRight.bind(this),y1:this.dataToPositionY.bind(this)},"normal",CU.Series);var a=this._dotMark;a&&this.setMarkStyle(a,{x:this.dataToPositionX.bind(this),y:this.dataToPositionY.bind(this),fill:this.getDotColorAttribute(),fillOpacity:this.dataToOpacity.bind(this)},"normal",CU.Series);var o=this._titleMark;o&&this.setMarkStyle(o,{fill:this.getColorAttribute(),text:function(e){return e[t.getTitleField()]},x:this.getRegionRectLeft.bind(this),y:this.dataToPositionY.bind(this)},"normal",CU.Series);var s=this._subTitleMark;s&&this.setMarkStyle(s,{fill:this.getColorAttribute(),text:function(e){return e[t.getSubTitleField()]},x:this.getRegionRectLeft.bind(this),y:this.dataToPositionY.bind(this)},"normal",CU.Series);var l=this._symbolMark;l&&this.setMarkStyle(l,{x:this.getRegionRectLeft.bind(this),y:this.dataToPositionY.bind(this),fill:this.getColorAttribute()},"normal",CU.Series)},i.prototype.dataToGridBackgroundPositionY=function(t){if(!this._yAxisHelper)return Number.NaN;var e=this._yAxisHelper,i=e.dataToPosition,n=e.getBandwidth;return i(this.getDatumPositionValues(t,this._fieldY),{bandPosition:this._bandPosition})-n(0)/2},i.prototype.dataToGridBackgroundPositionY1=function(t){if(!this._yAxisHelper)return Number.NaN;var e=this._yAxisHelper,i=e.dataToPosition,n=e.getBandwidth;return i(this.getDatumPositionValues(t,this._fieldY),{bandPosition:this._bandPosition})+n(0)/2},i.prototype.dataToOpacity=function(t){var e,i,n,r;if(!this._xAxisHelper)return Number.NaN;var a=this._xAxisHelper,o=a.dataToPosition,s=a.getScale;return o(this.getDatumPositionValues(t,this._fieldX),{bandPosition:this._bandPosition})<s(0).range()[0]||o(this.getDatumPositionValues(t,this._fieldX),{bandPosition:this._bandPosition})>s(0).range()[1]?0:null!==(r=null===(n=null===(i=null===(e=this._theme)||void 0===e?void 0:e.dot)||void 0===i?void 0:i.style)||void 0===n?void 0:n.fillOpacity)&&void 0!==r?r:1},i.prototype.dataToGridBackgroundOpacity=function(t){return t[this._seriesGroupField]===this._highLightSeriesGroup?this._gridBackground.fillOpacity:0},i.prototype.onLayoutEnd=function(t){var i,n;e.prototype.onLayoutEnd.call(this,t);var r=null!==(n=null===(i=this._spec)||void 0===i?void 0:i.leftAppendPadding)&&void 0!==n?n:0;this.setMarkStyle(this._clipMark,{width:this.getLayoutRect().width+r},"normal",CU.Series)},i.prototype.getDefaultColorDomain=function(){var t,e;return this._seriesGroupField?null===(t=this.getViewDataStatistics())||void 0===t?void 0:t.latestData[this._seriesGroupField].values:this._seriesField?null===(e=this.getViewDataStatistics())||void 0===e?void 0:e.latestData[this._seriesField].values:[]},i.prototype.getColorAttribute=function(){var t,e,i;return{scale:null!==(t=this._option.globalScale.getScale("color"))&&void 0!==t?t:this._getDefaultColorScale(),field:null!==(i=null!==(e=this._seriesGroupField)&&void 0!==e?e:this._seriesField)&&void 0!==i?i:Xz}},i.prototype.getDotColorScale=function(){var t,e,i,n=this._dotTypeField?null===(t=this.getViewDataStatistics())||void 0===t?void 0:t.latestData[this._dotTypeField].values:this._seriesGroupField?null===(e=this.getViewDataStatistics())||void 0===e?void 0:e.latestData[this._seriesGroupField].values:this._seriesField?null===(i=this.getViewDataStatistics())||void 0===i?void 0:i.latestData[this._seriesField].values:[],r=this._getDataScheme();return(new hF).domain(n).range(r)},i.prototype.getDotColorAttribute=function(){var t,e,i,n;return{scale:null!==(t=this._option.globalScale.getScale("color"))&&void 0!==t?t:this.getDotColorScale(),field:null!==(n=null!==(i=null!==(e=this._dotTypeField)&&void 0!==e?e:this._seriesGroupField)&&void 0!==i?i:this._seriesField)&&void 0!==n?n:Xz}},i.prototype.initTooltip=function(){this._tooltipHelper=new FQ(this),this._dotMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._dotMark)},i.prototype.onEvaluateEnd=function(t){e.prototype.onEvaluateEnd.call(this,t)},i.prototype.onMarkTreePositionUpdate=function(t){var e=this;t.forEach((function(t){"group"===t.type?e.onMarkTreePositionUpdate(t.getMarks()):t.updateLayoutState()}))},i.prototype.getDotData=function(){var t;return null===(t=this._dotMark)||void 0===t?void 0:t.getData()},i.prototype._getDataIdKey=function(){},i.prototype.getStackValueField=function(){return null},i.prototype.getActiveMarks=function(){return[this._dotMark]},i.type=t.SeriesTypeEnum.dot,i.mark=jQ,i}(SX),VQ=function(){LX(),OZ(),pq(),dJ(),kz.registerSeries(NQ.type,NQ)},WQ=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.shapeTypeCallback=function(){return"square"},e}return S(e,t),e.prototype.enableByType=function(t){return"mark"===t},e.prototype.getDefaultTitlePattern=function(t){return{key:"link info",value:"link info"}},e.prototype.getDefaultContentList=function(){return[{key:"time",value:function(t){return Yi.getInstance().timeFormat("%Y%m%d %H:%M",t.from.split("_")[1])}},{key:"type",value:function(t){return t.action_type}},{key:"from",value:function(t){return t.from}},{key:"to",value:function(t){return t.to}}]},e}(PY),GQ=A(A({},WY),((IQ={}).group={name:"group",type:"group"},IQ.link={name:"link",type:"rule"},IQ.arrow={name:"arrow",type:"symbol"},IQ)),UQ=function(t,e){var i=e.infoKey,n=e.fields,r=e.linkData,a=e.dotData,o=n(),s=o.fromField,l=o.toField,u=o.xField,c=o.yField,h=r(),d=a(),p={};return d.forEach((function(t){var e={};for(var n in t)n!==i&&(e[n]=t[n]);var r=t[i];null==r||r.forEach((function(t){p[t.node_name]=Object.assign({},e,t)}))})),h.forEach((function(t){var e,i,n,r;t[s+"_xField"]=null===(e=null==p?void 0:p[t[s]])||void 0===e?void 0:e[u],t[s+"_yField"]=null===(i=null==p?void 0:p[t[s]])||void 0===i?void 0:i[c],t[l+"_xField"]=null===(n=null==p?void 0:p[t[l]])||void 0===n?void 0:n[u],t[l+"_yField"]=null===(r=null==p?void 0:p[t[l]])||void 0===r?void 0:r[c]})),h},YQ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.link,i}return S(i,e),i.prototype.getFromField=function(){return this._fromField},i.prototype.setFromField=function(t){N(t)&&(this._fromField=t)},i.prototype.getToField=function(){return this._toField},i.prototype.setToField=function(t){N(t)&&(this._toField=t)},i.prototype.getDotTypeField=function(){return this._dotTypeField},i.prototype.setDotTypeField=function(t){N(t)&&(this._dotTypeField=t)},i.prototype.getDotSeriesSpec=function(){return this._dotSeriesSpec},i.prototype.setDotSeriesSpec=function(t){N(t)&&(this._dotSeriesSpec=t)},i.prototype._getDotData=function(){var t=this._option.getChart().getSeriesInIndex([this._spec.dotSeriesIndex])[0];return t?t.getRawData().latestData:[]},i.prototype.initData=function(){var t,i=this;e.prototype.initData.call(this),qG(this._option.dataSet,"linkDotInfo",UQ),null===(t=this.getViewData())||void 0===t||t.transform({type:"linkDotInfo",options:{infoKey:"dots",fields:function(){return{fromField:i._fromField,toField:i._toField,xField:i._dotSeriesSpec.xField,yField:i._dotSeriesSpec.yField}},linkData:function(){return i._rawData.latestData},dotData:function(){return i._getDotData()}},level:nU.linkDotInfo},!1)},i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),this.setFromField(this._spec.fromField),this.setToField(this._spec.toField),this.setDotTypeField(this._spec.dotTypeField),this.setDotSeriesSpec(this._spec.dotSeriesSpec)},i.prototype.initMark=function(){this._clipMark=this._createMark(i.mark.group),this._containerMark=this._createMark(i.mark.group,{parent:this._clipMark}),this._linkMark=this._createMark(i.mark.link,{skipBeforeLayouted:!1,parent:this._containerMark}),this._arrowMark=this._createMark(i.mark.arrow,{skipBeforeLayouted:!1,isSeriesMark:!0,parent:this._containerMark})},i.prototype.initMarkStyle=function(){var t,e,i,n,r=this,a=this._clipMark;a&&(this.setMarkStyle(a,{x:-this._spec.leftAppendPadding,y:0,width:1e4,height:this._spec.clipHeight},"normal",CU.Series),a.setMarkConfig({interactive:!1,clip:!0}));var o=this._containerMark;o&&(this.setMarkStyle(o,{x:this._spec.leftAppendPadding,width:this.getLayoutRect().width},"normal",CU.Series),o.setMarkConfig({interactive:!1}));var s=this._linkMark;s&&this.setMarkStyle(s,{stroke:this.getColorAttribute(),strokeOpacity:this.dataToOpacity.bind(this),x:this.dataToPositionXFrom.bind(this),y:this.dataToPositionYFrom.bind(this),x1:this.dataToPositionXTo.bind(this),y1:this.dataToPositionYTo.bind(this)},"normal",CU.Series);var l=this._arrowMark;if(l){var u=null!==(n=null===(i=null===(e=null===(t=this._theme)||void 0===t?void 0:t.arrow)||void 0===e?void 0:e.style)||void 0===i?void 0:i.size)&&void 0!==n?n:10;this.setMarkStyle(l,{x:this.dataToPositionXTo.bind(this),y:function(t){return r.dataToPositionArrowYTo(t,u)},fill:this.getColorAttribute(),fillOpacity:this.dataToOpacity.bind(this),size:u,symbolType:function(t){return r.isPositionYFromHigher(t)?"triangleDown":"triangleUp"}},"normal",CU.Series)}},i.prototype.afterInitMark=function(){e.prototype.afterInitMark.call(this)},i.prototype.dataToPositionXFrom=function(t){return this._xAxisHelper?(0,this._xAxisHelper.dataToPosition)(this.getDatumPositionValues(t,this._fromField+"_xField"),{bandPosition:this._bandPosition}):Number.NaN},i.prototype.dataToPositionYFrom=function(t){return this._yAxisHelper?(0,this._yAxisHelper.dataToPosition)(this.getDatumPositionValues(t,this._fromField+"_yField")):Number.NaN},i.prototype.dataToPositionXTo=function(t){return this._xAxisHelper?(0,this._xAxisHelper.dataToPosition)(this.getDatumPositionValues(t,this._toField+"_xField"),{bandPosition:this._bandPosition}):Number.NaN},i.prototype.dataToPositionYTo=function(t){return this._yAxisHelper?(0,this._yAxisHelper.dataToPosition)(this.getDatumPositionValues(t,this._toField+"_yField"),{bandPosition:this._bandPosition}):Number.NaN},i.prototype.dataToPositionArrowYTo=function(t,e){if(!this._yAxisHelper)return Number.NaN;var i=this._yAxisHelper.dataToPosition,n=this.isPositionYFromHigher(t)?-e/2:e/2;return i(this.getDatumPositionValues(t,this._toField+"_yField"),{bandPosition:this._bandPosition})+n},i.prototype.dataToOpacity=function(t){return this.isPositionXOuterRange(t,this._fromField+"_xField")||this.isPositionXOuterRange(t,this._toField+"_xField")||t[this._fromField]===t[this._toField]?0:1},i.prototype.isPositionYFromHigher=function(t){return this.dataToPositionYFrom(t)<this.dataToPositionYTo(t)},i.prototype.isPositionXOuterRange=function(t,e){if(!this._xAxisHelper)return!1;var i=this._xAxisHelper,n=i.dataToPosition,r=i.getScale;return n(this.getDatumPositionValues(t,e),{bandPosition:this._bandPosition})<r(0).range()[0]||n(this.getDatumPositionValues(t,e),{bandPosition:this._bandPosition})>r(0).range()[1]},i.prototype.getDefaultColorDomain=function(){var t,e;return this._dotTypeField?null===(t=this.getViewDataStatistics())||void 0===t?void 0:t.latestData[this._dotTypeField].values:this._seriesField?null===(e=this.getViewDataStatistics())||void 0===e?void 0:e.latestData[this._seriesField].values:[]},i.prototype.getColorAttribute=function(){var t,e,i;return{scale:null!==(t=this._option.globalScale.getScale("color"))&&void 0!==t?t:this._getDefaultColorScale(),field:null!==(i=null!==(e=this._dotTypeField)&&void 0!==e?e:this._seriesField)&&void 0!==i?i:Xz}},i.prototype.initInteraction=function(){var t=[];this._linkMark&&t.push(this._linkMark),this._arrowMark&&t.push(this._arrowMark),this._parseInteractionConfig(t)},i.prototype.initTooltip=function(){this._tooltipHelper=new WQ(this),this._linkMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._linkMark),this._arrowMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._arrowMark)},i.prototype.onMarkTreePositionUpdate=function(t){var e=this;t.forEach((function(t){"group"===t.type?e.onMarkTreePositionUpdate(t.getMarks()):t.updateLayoutState()}))},i.prototype.getDotInfoData=function(){var t,e;return null===(e=null!==(t=this._linkMark)&&void 0!==t?t:this._arrowMark)||void 0===e?void 0:e.getData()},i.prototype.getActiveMarks=function(){return[this._linkMark,this._arrowMark]},i.type=t.SeriesTypeEnum.link,i.mark=GQ,i}(SX),XQ=function(){OZ(),LX(),MK(),kK(),kz.registerSeries(YQ.type,YQ)},KQ=A(A({},WY),((LQ={}).group={name:"group",type:"group"},LQ)),qQ=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._arcGroupMark=null,e._getAngleValueStart=function(t){var i=e._getAngleAxis(),n=e._spec.tickMask;if((null==n?void 0:n.forceAlign)&&e._isTickMaskVisible(i)){var r=t[e.getStack()?Zz:cH],a=e._getAngleAxisSubTickData(i),o=a[1].value-a[0].value,s=we(n.offsetAngle),l=void 0;if(N(r)){var u=Ot(a,(function(t){return t.value-r})),c=u>=a.length||r>a[u].value-o/2?Math.min(u,a.length-1):u>0?u-1:void 0;void 0!==c&&(l=e.angleAxisHelper.dataToPosition([a[c].value-o/2]))}return j(l)&&(l=e.angleAxisHelper.dataToPosition([a[0].value-o/2])),l+s}return e._getAngleValueStartWithoutMask(t)},e._getAngleValueEnd=function(t){var i=e._getAngleAxis(),n=e._spec.tickMask;if((null==n?void 0:n.forceAlign)&&e._isTickMaskVisible(i)){var r=t[e.getStack()?Jz:e._angleField[0]],a=e._getAngleAxisSubTickData(i),o=a[1].value-a[0].value,s=we(n.offsetAngle),l=Ot(a,(function(t){return t.value-r})),u=l>=a.length||r>a[l].value-o/2?Math.min(l,a.length-1):l>0?l-1:void 0;return(void 0!==u?e.angleAxisHelper.dataToPosition([a[u].value+o/2]):e.angleAxisHelper.dataToPosition([a[0].value-o/2]))+s}return e._getAngleValueEndWithoutMask(t)},e}return S(e,t),e.prototype.setAttrFromSpec=function(){var e,i,n;t.prototype.setAttrFromSpec.call(this);var r=null===(e=this._option.globalInstance.getChart())||void 0===e?void 0:e.getSpec(),a=null!==(i=this._spec.startAngle)&&void 0!==i?i:null==r?void 0:r.startAngle;this._startAngle=N(a)?we(a):WF;var o=null!==(n=this._spec.endAngle)&&void 0!==n?n:null==r?void 0:r.endAngle;this._endAngle=N(o)?we(o):GF,this.setAngleField(this._spec.valueField||this._spec.angleField),this.setRadiusField(this._spec.categoryField||this._spec.radiusField),this._specAngleField=this._angleField.slice(),this._specRadiusField=this._radiusField.slice()},e.prototype.getStackGroupFields=function(){return this._radiusField},e.prototype.getStackValueField=function(){var t;return null===(t=this._angleField)||void 0===t?void 0:t[0]},e.prototype.getGroupFields=function(){return this._angleField},e.prototype._convertMarkStyle=function(e){var i=t.prototype._convertMarkStyle.call(this,e),n="fill";if(i[n]){var r=e[n];"conical"!==(null==r?void 0:r.gradient)||N(null==r?void 0:r.startAngle)||N(null==r?void 0:r.endAngle)||(i[n]=A(A({},r),{startAngle:this._startAngle,endAngle:this._endAngle}))}return i},e.prototype._getAngleValueStartWithoutMask=function(t){if(this.getStack()){var e=fF(this.angleAxisHelper.dataToPosition([t[Zz]]),this.angleAxisHelper.getScale(0));if(Q(e))return e}return this._startAngle},e.prototype._getAngleValueEndWithoutMask=function(t){if(this.getStack()){var e=fF(this.angleAxisHelper.dataToPosition([t[Jz]]),this.angleAxisHelper.getScale(0));if(Q(e))return e}var i=this.angleAxisHelper.dataToPosition([t[this._angleField[0]]]);return this._spec.clamp?fF(i,this.angleAxisHelper.getScale(0)):i},e.prototype.getDimensionField=function(){return this._specRadiusField},e.prototype.getMeasureField=function(){return this._specAngleField},e.prototype.initMark=function(){this._initArcGroupMark()},e.prototype.initMarkStyle=function(){this._initArcGroupMarkStyle()},e.prototype._initArcGroupMark=function(){return this._arcGroupMark=this._createMark(e.mark.group,{skipBeforeLayouted:!1}),this._arcGroupMark},e.prototype._initArcGroupMarkStyle=function(){var t=this,e=this._arcGroupMark;e.created(),this.setMarkStyle(e,{x:0,y:0},"normal",CU.Series),this._arcGroupMark.setMarkConfig({interactive:!1,zIndex:this.layoutZIndex,clip:!0,clipPath:function(){var e=t._getAngleAxis(),i=t.angleAxisHelper.center(),n=i.x,r=i.y,a=t._computeLayoutRadius();if(t._isTickMaskVisible(e)){var o=t._spec.tickMask,s=o.angle,l=o.offsetAngle,u=o.style,c=void 0===u?{}:u,h=t._getAngleAxisSubTickData(e),d=c;return h.map((function(e){var i=e.value,o=t.angleAxisHelper.dataToPosition([i])+we(l),u=we(s)/2;return by(A(A({},d),{x:n,y:r,startAngle:o-u,endAngle:o+u,innerRadius:a*t._innerRadius,outerRadius:a*t._outerRadius,fill:!0}))}))}var p=t.getLayoutRect();return[Xg({width:p.width,height:p.height,fill:!0})]}})},e.prototype._getAngleAxis=function(){if(this.angleAxisHelper){var t=this.angleAxisHelper.getAxisId(),e=this._option.getChart().getAllComponents().find((function(e){return e.id===t}));return e}},e.prototype._getAngleAxisTickData=function(t){var e;return null===(e=null==t?void 0:t.getTickData())||void 0===e?void 0:e.getLatestData()},e.prototype._isTickMaskVisible=function(t){var e=this._getAngleAxisTickData(t),i=this._spec.tickMask;return i&&!1!==i.visible&&(null==e?void 0:e.length)>1},e.prototype._getAngleAxisSubTickData=function(t){var e,i=this._getAngleAxisTickData(t),n=[],r=null!==(e=null==t?void 0:t.getSpec())&&void 0!==e?e:{},a=r.subTick,o=void 0===a?{}:a,s=r.tick,l=void 0===s?{}:s,u=o.tickCount,c=void 0===u?4:u,h=l.alignWithLabel;if((null==i?void 0:i.length)>=2){for(var d=i[1].value-i[0].value,p=0;p<i.length-1;p++){var f=i[p],v=i[p+1];n.push(f);for(var g=0;g<c;g++){var y=(g+1)/(c+1),m=(1-y)*f.value+y*(v?v.value:h?1:f.value+d);n.push({value:m})}}return n.push(i[i.length-1]),n}return i},e.mark=KQ,e}(RJ),ZQ=A(A({},KQ),((DQ={}).track={name:"track",type:"arc"},DQ.progress={name:"progress",type:"arc"},DQ)),JQ={type:"fadeIn"};function QQ(t,e){return"fadeIn"===e?JQ:function(t){return{type:"growAngleIn",options:{overall:t.startAngle}}}(t)}var $Q=function(){kz.registerAnimation("circularProgress",(function(t,e){return{appear:QQ(t,e),enter:{type:"growAngleIn"},disappear:{type:"growAngleOut"}}}))},t$=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._supportStack=!0,e}return S(e,t),e}(mX),e$=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.circularProgress,i.transformerConstructor=t$,i._progressMark=null,i._trackMark=null,i._getRadiusValueStart=function(t){if(i.getGroupFields().length>1){var e=i.radiusAxisHelper.dataToPosition(i.getDatumPositionValues(t,i.getGroupFields()));if(Q(e))return e}return i.radiusAxisHelper.dataToPosition([t[i._radiusField[0]]])},i._getRadiusValueEnd=function(t){var e,n;if(i.getGroupFields().length>1){var r=i.radiusAxisHelper.dataToPosition(i.getDatumPositionValues(t,i.getGroupFields()))+(null===(n=(e=i.radiusAxisHelper).getBandwidth)||void 0===n?void 0:n.call(e,i._groups?i._groups.fields.length-1:0));if(Q(r))return r}return i.radiusAxisHelper.dataToPosition([t[i._radiusField[0]]])+i.radiusAxisHelper.getScale(0).step()},i}return S(i,e),i.prototype.getStackGroupFields=function(){return this.getGroupFields()},i.prototype.getGroupFields=function(){return this._radiusField},i.prototype.initMark=function(){e.prototype.initMark.call(this),this._initTrackMark(),this._initProgressMark()},i.prototype.initMarkStyle=function(){e.prototype.initMarkStyle.call(this),this._initTrackMarkStyle(),this._initProgressMarkStyle()},i.prototype._initProgressMark=function(){var t,e;return this._progressMark=this._createMark(i.mark.progress,{parent:this._arcGroupMark,isSeriesMark:!0,stateSort:null===(t=this._spec.progress)||void 0===t?void 0:t.stateSort},{morph:fX(this._spec,"progress"),setCustomizedShape:null===(e=this._spec.progress)||void 0===e?void 0:e.customShape}),this._progressMark},i.prototype._initProgressMarkStyle=function(){var t,e=this,i=this._progressMark;i&&this.setMarkStyle(i,{x:function(){return e.angleAxisHelper.center().x},y:function(){return e.angleAxisHelper.center().y},startAngle:this._getAngleValueStart,endAngle:this._getAngleValueEnd,innerRadius:this._getRadiusValueStart,outerRadius:this._getRadiusValueEnd,cap:null!==(t=this._spec.roundCap)&&void 0!==t&&t,boundsMode:"imprecise",cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute(),zIndex:200,forceShowCap:!0},"normal",CU.Series)},i.prototype.initInteraction=function(){var t=[];this._trackMark&&t.push(this._trackMark),this._progressMark&&t.push(this._progressMark),this._parseInteractionConfig(t)},i.prototype.initTooltip=function(){e.prototype.initTooltip.call(this),this._progressMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._progressMark)},i.prototype._initTrackMark=function(){var t,e;return this._trackMark=this._createMark(i.mark.track,{parent:this._arcGroupMark,stateSort:null===(t=this._spec.track)||void 0===t?void 0:t.stateSort},{setCustomizedShape:null===(e=this._spec.track)||void 0===e?void 0:e.customShape}),this._trackMark.setMarkConfig({morph:!1,morphKey:null,morphElementKey:null}),this._trackMark},i.prototype._initTrackMarkStyle=function(){var t=this,e=this._trackMark;e&&this.setMarkStyle(e,{visible:function(e){var i=t.angleAxisHelper.getScale(0).range(),n=Math.min(i[0],i[i.length-1]),r=t._getAngleValueStartWithoutMask(e);return Math.abs(r-n)<=1e-14},x:function(){return t.angleAxisHelper.center().x},y:function(){return t.angleAxisHelper.center().y},startAngle:function(){var e,i=t.getStack()?Zz:t._angleField[0],n=t.angleAxisHelper.getScale(0).domain();return t._getAngleValueStart(((e={})[i]=n[0],e))},endAngle:function(){var e,i=t.getStack()?Jz:t._angleField[0],n=t.angleAxisHelper.getScale(0).domain();return t._getAngleValueEnd(((e={})[i]=n[n.length-1],e))},innerRadius:this._getRadiusValueStart,outerRadius:this._getRadiusValueEnd,cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute(),zIndex:100},"normal",CU.Series)},i.prototype.initAnimation=function(){var t,e,i,n,r=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this._progressMark.setAnimationConfig(cX(null===(i=kz.getAnimationInKey("circularProgress"))||void 0===i?void 0:i({startAngle:this._startAngle},r),hX("progress",this._spec,this._markAttributeContext))),this._trackMark.setAnimationConfig(cX(null===(n=kz.getAnimationInKey("fadeInOut"))||void 0===n?void 0:n(),hX("track",this._spec,this._markAttributeContext)))},i.prototype.getActiveMarks=function(){return[this._progressMark]},i.type=t.SeriesTypeEnum.circularProgress,i.mark=ZQ,i.transformerConstructor=t$,i}(qQ),i$=function(){kz.registerSeries(e$.type,e$),YJ(),$Q(),iX(),bQ(),mQ()};function n$(t){return function(){return"vertical"===t.direction?{orient:"negative"}:{orient:"positive"}}}var r$=function(t){return{type:"horizontal"===t.direction?"growWidthOut":"growHeightOut",options:n$(t)}},a$={type:"fadeIn"};function o$(t,e){return!1===e?{}:"fadeIn"===e?a$:function(t){return{type:"horizontal"===t.direction?"growWidthIn":"growHeightIn",options:n$(t)}}(t)}var s$,l$,u$=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype.enableByType=function(t){return"dimension"!==t},e}(PY),c$=A(A({},WY),((s$={}).track={name:"track",type:"rect"},s$.progress={name:"progress",type:"rect"},s$.group={name:"group",type:"group"},s$)),h$=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.linearProgress,i._progressMark=null,i._trackMark=null,i._defaultProgressCustomShape=function(t,e,n){var r,a,o=null===(r=i._spec)||void 0===r?void 0:r.cornerRadius,s=N(e.width)?e.width:e.x1-e.x,l=N(e.height)?e.height:e.y1-e.y,u=Math.min(0,s),c=Math.max(0,s),h=Math.min(0,l),d=Math.max(0,l);if(o>0){var p=o;if("vertical"===(null===(a=i._spec)||void 0===a?void 0:a.direction)){if(2*(p=Math.min(Math.abs(s/2),o))>Math.abs(l)){var f=Math.acos((p-Math.abs(l)/2)/p);return n.moveTo(u+p,h),n.arc(u+p,h+p,p,1.5*Math.PI,1.5*Math.PI-f,!0),n.arc(u+p,d-p,p,f+Math.PI/2,Math.PI/2,!0),n.lineTo(c-o,d),n.arc(c-p,d-p,p,Math.PI/2,Math.PI/2-f,!0),n.arc(c-p,h+p,p,-Math.PI/2+f,-Math.PI/2,!0),n.lineTo(u+p,h),n.closePath(),n}}else if(2*(p=Math.min(Math.abs(l/2),o))>Math.abs(s)){f=Math.acos((p-Math.abs(s)/2)/p);return n.moveTo(u,h+p),n.arc(u+p,h+p,p,Math.PI,Math.PI+f),n.arc(c-p,h+p,p,-f,0),n.lineTo(c,d-p),n.arc(c-p,d-p,p,0,f),n.arc(u+p,d-p,p,Math.PI-f,Math.PI),n.closePath(),n}n.moveTo(u,h+p),n.arc(u+p,h+p,p,Math.PI,1.5*Math.PI),n.lineTo(c-p,h),n.arc(c-p,h+p,p,-Math.PI/2,0),n.lineTo(c,d-p),n.arc(c-p,d-p,p,0,Math.PI/2),n.lineTo(u+p,d),n.arc(u+p,d-p,p,Math.PI/2,Math.PI),n.closePath()}else n.moveTo(u,h),n.lineTo(c,h),n.lineTo(c,d),n.lineTo(u,d),n.closePath();return n},i}return S(i,e),i.prototype.initMark=function(){this._initTrackMark(),this._initProgressMark()},i.prototype.initMarkStyle=function(){this._initTrackMarkStyle(),this._initProgressMarkStyle()},i.prototype._initProgressMark=function(){var t,e,n;return this._progressMark=this._createMark(i.mark.progress,{isSeriesMark:!0,stateSort:null===(t=this._spec.progress)||void 0===t?void 0:t.stateSort},{setCustomizedShape:null!==(n=null===(e=this._spec.progress)||void 0===e?void 0:e.customShape)&&void 0!==n?n:this._defaultProgressCustomShape}),this._progressMark},i.prototype._initProgressMarkStyle=function(){var t,e,i,n,r=this,a=this._progressMark;if(a)if("vertical"===this._spec.direction){var o=null!==(t=(l=this._spec.progress||{}).leftPadding)&&void 0!==t?t:0,s=null!==(e=l.rightPadding)&&void 0!==e?e:0;this.setMarkStyle(a,{x:function(t){var e,i;return fF(r.dataToPositionX(t),null===(i=null===(e=r._xAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0),!0)-r._spec.bandWidth/2+o},y1:function(t){var e,i;return fF(r.dataToPositionY(t),null===(i=null===(e=r._yAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0))},y:function(){var t,e,i,n=null===(t=r._yAxisHelper)||void 0===t?void 0:t.dataToPosition([0],{bandPosition:r._bandPosition});return r._spec.clamp?fF(n,null===(i=null===(e=r._yAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0)):n},width:this._spec.bandWidth-o-s,cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute()},"normal",CU.Series)}else{var l,u=null!==(i=(l=this._spec.progress||{}).topPadding)&&void 0!==i?i:0,c=null!==(n=l.bottomPadding)&&void 0!==n?n:0;this.setMarkStyle(a,{x1:function(t){var e,i;return fF(r.dataToPositionX(t),null===(i=null===(e=r._xAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0))},y:function(t){var e,i;return fF(r.dataToPositionY(t),null===(i=null===(e=r._yAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0),!0)-r._spec.bandWidth/2+u},height:this._spec.bandWidth-u-c,x:function(){var t,e,i,n=null===(t=r._xAxisHelper)||void 0===t?void 0:t.dataToPosition([0],{bandPosition:r._bandPosition});return r._spec.clamp?fF(n,null===(i=null===(e=r._xAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0)):n},cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute()},"normal",CU.Series)}},i.prototype._initTrackMark=function(){var t,e;return this._trackMark=this._createMark(i.mark.track,{stateSort:null===(t=this._spec.track)||void 0===t?void 0:t.stateSort},{setCustomizedShape:null===(e=this._spec.track)||void 0===e?void 0:e.customShape}),this._trackMark},i.prototype._initTrackMarkStyle=function(){var t=this,e=this._trackMark;e&&("vertical"===this._spec.direction?this.setMarkStyle(e,{x:function(e){var i,n;return fF(t.dataToPositionX(e),null===(n=null===(i=t._xAxisHelper)||void 0===i?void 0:i.getScale)||void 0===n?void 0:n.call(i,0),!0)-t._spec.bandWidth/2},y:0,width:this._spec.bandWidth,height:function(){return t._scaleY.range()[0]},cornerRadius:this._spec.cornerRadius},"normal",CU.Series):this.setMarkStyle(e,{x:0,y:function(e){var i,n;return fF(t.dataToPositionY(e),null===(n=null===(i=t._yAxisHelper)||void 0===i?void 0:i.getScale)||void 0===n?void 0:n.call(i,0),!0)-t._spec.bandWidth/2},height:this._spec.bandWidth,width:function(){return t._scaleX.range()[1]},cornerRadius:this._spec.cornerRadius},"normal",CU.Series))},i.prototype.initInteraction=function(){var t=[];this._trackMark&&t.push(this._trackMark),this._progressMark&&t.push(this._progressMark),this._parseInteractionConfig(t)},i.prototype.initAnimation=function(){var t,e,i,n,r={direction:this.direction},a=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this._progressMark.setAnimationConfig(cX(null===(i=kz.getAnimationInKey("linearProgress"))||void 0===i?void 0:i(r,a),hX("progress",this._spec,this._markAttributeContext))),this._trackMark.setAnimationConfig(cX(null===(n=kz.getAnimationInKey("fadeInOut"))||void 0===n?void 0:n(),hX("track",this._spec,this._markAttributeContext)))},i.prototype.initTooltip=function(){this._tooltipHelper=new u$(this),this._progressMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._progressMark),this._trackMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._trackMark)},i.prototype.getActiveMarks=function(){return[this._progressMark]},i.type=t.SeriesTypeEnum.linearProgress,i.mark=c$,i}(SX),d$=function(){pq(),kz.registerAnimation("linearProgress",(function(t,e){return{appear:o$(t,e),enter:{type:"grow"},disappear:r$(t)}})),iX(),kz.registerSeries(h$.type,h$)},p$=[0],f$=[20,40],v$=[200,500],g$={shrink:!1,enlarge:!1,fontSizeLimitMin:0},y$=["triangleForward","triangle","diamond","square","star","cardioid","circle","pentagon","rect"],m$="".concat(BF,"_WORD_CLOUD_TEXT"),_$=A(A({},WY),((l$={}).word={name:"word",type:"text"},l$.fillingWord={name:"fillingWord",type:"text"},l$.wordMask={name:"wordMask",type:"rect"},l$)),b$=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._fontSizeRange=[20,20],e._isWordCloudShape=!1,e._dataChange=!0,e.handleMaskCanvasUpdate=function(t,i){e._maskCanvas=t},e.getWordColor=function(t){return t.isFillingWord?(e._fillingColorCallback&&!e._dataChange||(e._fillingColorCallback=e._wordCloudShapeConfig.fillingColorHexField?function(t){return t[e._wordCloudShapeConfig.fillingColorHexField]}:e.initColorCallback(e._wordCloudShapeConfig.fillingSeriesField,!0)),e._fillingColorCallback(t)):(e._keyWordColorCallback&&!e._dataChange||(e._keyWordColorCallback=e._spec.colorHexField?function(t){return t[e._spec.colorHexField]}:e.initColorCallback(e._seriesField,!1)),e._keyWordColorCallback(t))},e._calculateFontWeight=function(t){var i=e.getRawDataStatisticsByField(e._valueField,!0);return i.min===i.max?e._fontWeightRange[0]:e._fontWeightRange[0]+(e._fontWeightRange[e._fontWeightRange.length-1]-e._fontWeightRange[0])*(t[e._valueField]-i.min)/(i.max-i.min)},e}return S(e,t),e.prototype.setValueField=function(t){N(t)&&(this._valueField=t)},e.prototype.setFontSizeRange=function(t){N(t)?this._fontSizeRange=t:this._fontSizeRange=f$},e.prototype.setAttrFromSpec=function(){var e,i,n,r,a;t.prototype.setAttrFromSpec.call(this),this._padding=this._option.getChart().padding,this._nameField=this._spec.nameField,this._colorMode=null!==(e=this._spec.colorMode)&&void 0!==e?e:"ordinal",this._colorList=this._spec.colorList,this.setValueField(this._spec.valueField),this._fontWeightRange=null!==(i=this._spec.fontWeightRange)&&void 0!==i?i:v$,this._rotateAngles=null!==(n=this._spec.rotateAngles)&&void 0!==n?n:p$,this.setFontSizeRange(this._spec.fontSizeRange),this._maskShape=null!==(r=this._spec.maskShape)&&void 0!==r?r:"circle",this._textField=(null===(a=this._spec.word)||void 0===a?void 0:a.formatMethod)?m$:this._nameField;var o=this._spec.wordCloudConfig;this._wordCloudConfig=A({drawOutOfBound:"hidden",layoutMode:"default",zoomToFit:g$},this._spec.wordCloudConfig),o&&!j(o.layoutMode)||jk(this._option.mode)||(this._wordCloudConfig.layoutMode="fast"),this._wordCloudShapeConfig=A({fillingSeriesField:this.getSeriesField(),fillingRotateAngles:p$,layoutMode:"default"},this._spec.wordCloudShapeConfig),this._isWordCloudShape=!y$.includes(this._maskShape)&&!["fast","grid","cloud"].includes(this._wordCloudConfig.layoutMode),this._defaultFontFamily=this._option.getTheme().fontFamily},e.prototype.initData=function(){var e,i,n=this;t.prototype.initData.call(this),null===(i=null===(e=this.getViewData())||void 0===e?void 0:e.target)||void 0===i||i.addListener("change",(function(){n._dataChange=!0,n.compile()}))},e.prototype.initMark=function(){var t;(null===(t=this._spec.wordMask)||void 0===t?void 0:t.visible)&&(this._maskMark=this._createMark(e.mark.wordMask,{dataView:!1})),this._wordMark=this._createMark(e.mark.word,{key:Yz,groupKey:this._seriesField,isSeriesMark:!0},{morphElementKey:this._seriesField})},e.prototype.initMarkStyle=function(){var t=this;this.initMarkStyleOfWord(this._wordMark,this._spec.word,this._spec.colorHexField,this._seriesField),this._maskMark&&this.setMarkStyle(this._maskMark,{width:function(){return t._region.getLayoutRect().width},height:function(){return t._region.getLayoutRect().height},background:function(){return t._maskCanvas}},"normal",CU.Series)},e.prototype.initMarkStyleOfWord=function(t,e,i,n,r){var a,o,s=this;t&&(this.setMarkStyle(t,{text:(null==e?void 0:e.formatMethod)?function(t){return e.formatMethod(t)}:function(t){return t[s._textField]},x:function(t){return t.x},y:function(t){return t.y},fontSize:function(t){return t.fontSize},fontStyle:function(t){return t.fontStyle},angle:function(t){return t.angle},visible:function(t){return t.visible}},"normal",CU.Series),this.setMarkStyle(t,{fill:null!==(o=null===(a=null==e?void 0:e.style)||void 0===a?void 0:a.fill)&&void 0!==o?o:this.getWordColor,fontWeight:function(t){return t.fontWeight},fontFamily:function(t){return t.fontFamily}},"normal",CU.User_Mark))},e.prototype.initTooltip=function(){t.prototype.initTooltip.call(this),this._wordMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._wordMark)},e.prototype.initAnimation=function(){var t=this;[this._wordMark].forEach((function(e){var i,n;if(e){var r=null===(n=null===(i=t._spec)||void 0===i?void 0:i.animationAppear)||void 0===n?void 0:n.preset,a={animationConfig:function(){var t,i;return null===(i=null===(t=e.getAnimationConfig())||void 0===t?void 0:t.appear)||void 0===i?void 0:i[0]}};e.setAnimationConfig(cX(kz.getAnimationInKey("wordCloud")(a,r),hX("word",t._spec,t._markAttributeContext)))}}))},e.prototype.getWordOrdinalColorScale=function(t,e){var i,n,r,a,o,s=e?this._wordCloudShapeConfig.fillingColorList:this._colorList,l=t?null===(i=this.getViewData())||void 0===i?void 0:i.latestData.map((function(e){return e[t]})):[],u=null!==(r=null!=s?s:null===(n=this._option.globalScale.getScale("color"))||void 0===n?void 0:n.range())&&void 0!==r?r:this._getDataScheme();return null===(o=(a=(new hF).domain(l)).range)||void 0===o?void 0:o.call(a,u)},e.prototype.initColorCallback=function(t,e){var i,n,r,a,o=this;if("ordinal"===this._colorMode){var s=this.getWordOrdinalColorScale(t,e);return function(e){return s.scale(e[null!=t?t:Xz])}}var l=null!==(i=e?this._colorList:this._wordCloudShapeConfig.fillingColorList)&&void 0!==i?i:this._option.globalScale.getScale("color").range();if(1===l.length)return function(t){return l[0]};if(this._valueField){var u=this.getRawDataStatisticsByField(this._valueField,!0);if(u.min===u.max)return l[0];var c=(new II).domain([u.min,u.max]).range(l);return function(t){return c.scale(t[o._valueField])}}var h=(new II).domain([0,null!==(a=null===(r=null===(n=this.getViewData())||void 0===n?void 0:n.latestData)||void 0===r?void 0:r.length)&&void 0!==a?a:1]).range(l);return function(t){return h.scale(t[Uz])}},e.prototype.compile=function(){t.prototype.compile.call(this);var e=this._region.getLayoutRect(),i=e.width,n=e.height;if(Q(i)&&Q(n)&&n>0&&i>0){var r=this._wordMark.getProduct();if(r){var a=[];this._isWordCloudShape?a.push(A({type:"wordcloudShape"},this._wordCloudShapeTransformOption())):a.push(A({type:"wordcloud"},this._wordCloudTransformOption())),r.transform(a)}}},e.prototype._getCommonTransformOptions=function(){var t,e,i,n,r,a,o=this._region.getLayoutRect(),s=o.width,l=o.height,u=null!==(t=this._spec.word)&&void 0!==t?t:{},c=null!==(e=u.style)&&void 0!==e?e:{};return{size:[s,l],shape:V(this._maskShape)&&"text"===this._maskShape.type&&j(this._maskShape.fontFamily)?A({fontFamily:null===(i=this._option.getTheme())||void 0===i?void 0:i.fontFamily},this._maskShape):this._maskShape,onUpdateMaskCanvas:this.handleMaskCanvasUpdate,dataIndexKey:Yz,text:u.formatMethod?function(t){return u.formatMethod(t)}:{field:this._textField},fontSize:this._valueField?{field:this._valueField}:this._fontSizeRange[0],fontSizeRange:"auto"===this._fontSizeRange?null:this._fontSizeRange,padding:null!==(r=null===(n=this._spec.word)||void 0===n?void 0:n.padding)&&void 0!==r?r:1,fontFamily:N(this._spec.fontFamilyField)?{field:this._spec.fontFamilyField}:null!==(a=c.fontFamily)&&void 0!==a?a:this._defaultFontFamily,fontWeight:N(this._spec.fontWeightField)?{field:this._spec.fontWeightField}:N(c.fontWeight)?c.fontWeight:N(this._valueField)?this._calculateFontWeight:"normal",fontStyle:N(this._spec.fontStyleField)?{field:this._spec.fontStyleField}:c.fontStyle}},e.prototype._wordCloudTransformOption=function(){var t,e,i=null!==(t=this._wordCloudConfig)&&void 0!==t?t:{};return A(A(A({},i),this._getCommonTransformOptions()),{layoutType:this._wordCloudConfig.layoutMode,rotate:this._rotateAngles,randomVisible:null===(e=this._spec.random)||void 0===e||e,clip:"clip"===this._wordCloudConfig.drawOutOfBound,shrink:this._wordCloudConfig.zoomToFit.shrink,enlarge:this._wordCloudConfig.zoomToFit.enlarge,minFontSize:this._wordCloudConfig.zoomToFit.fontSizeLimitMin,progressiveTime:this._wordCloudConfig.progressiveTime,progressiveStep:this._wordCloudConfig.progressiveStep,repeatFill:this._wordCloudConfig.zoomToFit.repeat})},e.prototype._wordCloudShapeTransformOption=function(){var t,e,i,n,r,a,o=null!==(e=null===(t=this._spec.fillingWord)||void 0===t?void 0:t.style)&&void 0!==e?e:{},s=null!==(i=this._wordCloudShapeConfig)&&void 0!==i?i:{};return A(A(A({},s),this._getCommonTransformOptions()),{rotateList:this._rotateAngles,fillingRotateList:s.fillingRotateAngles,fillingFontFamily:N(s.fillingFontFamilyField)?{field:s.fillingFontFamilyField}:null!==(n=o.fontFamily)&&void 0!==n?n:this._defaultFontFamily,fillingPadding:null!==(a=null===(r=this._spec.fillingWord)||void 0===r?void 0:r.padding)&&void 0!==a?a:1,fillingFontStyle:N(s.fillingFontStyleField)?{field:s.fillingFontStyleField}:o.fontStyle,fillingFontWeight:N(s.fillingFontWeightField)?{field:s.fillingFontWeightField}:o.fontWeight})},e.prototype.getStatisticFields=function(){var t=[];return t.push({key:this._nameField,operations:["values"]}),t.push({key:this._valueField,operations:["max","min"]}),t},e.prototype.dataToPosition=function(t){return null},e.prototype.dataToPositionX=function(t){return null},e.prototype.dataToPositionY=function(t){return null},e.prototype.dataToPositionZ=function(t){return null},e.prototype.valueToPosition=function(t,e){return null},e.prototype.getGroupFields=function(){return[]},e.prototype.getStackGroupFields=function(){return[]},e.prototype.getStackValueField=function(){return""},e.prototype.onLayoutEnd=function(e){t.prototype.onLayoutEnd.call(this,e),this.compile(),this._dataChange=!1},e.prototype.getActiveMarks=function(){return[this._wordMark]},e.prototype.reInit=function(){t.prototype.reInit.call(this),this._keyWordColorCallback&&(this._keyWordColorCallback=null),this._fillingColorCallback&&(this._fillingColorCallback=null)},e.mark=_$,e}(_X),x$=function(t){return{custom:kd,customParameters:function(e,i){return t},easing:"linear",loop:1/0,duration:6e3}};function k$(t,e){return!1===e?{}:"fadeIn"===e?{type:"fadeIn"}:function(t){return{channel:{fontSize:{from:0}},duration:200,delay:function(e,i,n){var r=t.animationConfig(),a=(null==r?void 0:r.duration)||200,o=(null==r?void 0:r.totalTime)||QY.appear.duration,s=n.VGRAMMAR_ANIMATION_PARAMETERS.elementCount;return n.VGRAMMAR_ANIMATION_PARAMETERS.elementIndex*function(t,e,i){return t*i<e?t+(e-i*t)/(i-1):(e-t)/(i-1)}(a,o,s)}}}(t)}var S$=function(t,e){return"hsl("+(360*Math.random()).toFixed()+","+(30*Math.random()+70).toFixed()+"%,"+(Math.random()*(e-t)+t).toFixed()+"%)"};function A$(t){return H(t)?t:function(){return t}}var M$=function(){return o((function t(e){var i,n,a=this;switch(r(this,t),this.options=ft({},t.defaultOptions,e),H(this.options.shape)?this.shape=this.options.shape:this.shape=uS(this.options.shape),this.getText=null!==(i=A$(this.options.text))&&void 0!==i?i:function(t){return t},this.getTextFontWeight=A$(this.options.fontWeight),this.getTextFontSize=A$(this.options.fontSize),this.getTextFontStyle=A$(this.options.fontStyle),this.getTextFontFamily=A$(this.options.fontFamily),this.outputCallback=null!==(n=this.options.outputCallback)&&void 0!==n?n:function(t){return t},this.options.color){case"random-dark":this.getTextColor=function(){return S$(10,50)};break;case"random-light":this.getTextColor=function(){return S$(50,90)};break;default:this.getTextColor=A$(this.options.color)}if(j(this.options.rotate))if(this.options.useRandomRotate){var o=Math.abs(this.options.maxRotation-this.options.minRotation),s=Math.abs(Math.floor(this.options.rotationSteps)),l=Math.min(this.options.maxRotation,this.options.minRotation);this.getTextRotate=function(){return 0===a.options.rotateRatio||Math.random()>a.options.rotateRatio?0:0===o?l:s>0?l+Math.floor(Math.random()*s)*o/(s-1):l+Math.random()*o}}else this.getTextRotate=function(){return 0};else this.getTextRotate=H(this.options.rotate)?function(t){var e;return we(null!==(e=a.options.rotate(t))&&void 0!==e?e:0)}:function(t,e){var i=xt(a.options.rotate),n=a.options.random?Math.random():ie(e);return we(i[Math.floor(n*i.length)])}}),[{key:"canRepeat",value:function(){return!1}},{key:"exceedTime",value:function(){var t;return this.options.progressiveStep>0?this.progressiveIndex>=((null!==(t=this.currentStepIndex)&&void 0!==t?t:-1)+1)*this.options.progressiveStep:this.options.progressiveTime>0&&(new Date).getTime()-this.escapeTime>this.options.progressiveTime}},{key:"progressiveRun",value:function(){var t;if(this.options.progressiveStep>0?this.currentStepIndex=(null!==(t=this.currentStepIndex)&&void 0!==t?t:-1)+1:this.options.progressiveTime>0&&(this.escapeTime=Date.now()),this.data&&this.progressiveIndex<this.data.length){this.progressiveResult=[];for(var e=this.progressiveIndex,i=0,n=this.options.maxSingleWordTryCount,r=Math.min(this.options.maxFailCount,this.originalData.length);e<this.data.length&&this.failCount<r;){var a=this.layoutWord(e);if(i++,(a||i>n)&&(e++,i=0,this.failCount=a?0:this.failCount+1),this.progressiveIndex=e,this.exceedTime())break;e===this.data.length&&this.failCount<r&&this.options.repeatFill&&this.canRepeat()&&(this.data=[].concat(m(this.data),m(this.originalData.map((function(t){return Object.assign(Object.assign({},t),{isFill:!0})})))),this.isTryRepeatFill=!0)}return this.progressiveResult}return this.result}},{key:"initProgressive",value:function(){this.failCount=0,this.progressiveIndex=0,this.options.progressiveStep>0?this.currentStepIndex=-1:this.options.progressiveTime>0&&(this.escapeTime=Date.now()),this.progressiveResult=[]}},{key:"output",value:function(){return this.result?this.outputCallback(this.result):null}},{key:"progressiveOutput",value:function(){return this.progressiveResult?this.outputCallback(this.progressiveResult):null}},{key:"unfinished",value:function(){return this.data&&this.data.length&&!j(this.progressiveIndex)&&this.progressiveIndex<this.data.length}},{key:"release",value:function(){this.data=null,this.result=null,this.progressiveIndex=null,this.progressiveResult=null}}])}();M$.defaultOptions={fontFamily:'"Trebuchet MS", "Heiti TC", "微軟正黑體", "Arial Unicode MS", "Droid Fallback Sans", sans-serif',fontWeight:"normal",color:"random-dark",fontStyle:"normal",minFontSize:12,drawOutOfBound:!1,shrink:!1,minRotation:-Math.PI/2,maxRotation:Math.PI/2,rotationSteps:0,rotateRatio:.1,random:!1,shape:"circle",progressiveTime:0,progressiveStep:0,repeatFill:!1,fillTextFontSize:12,maxFailCount:20};var w$={archimedean:function(t){var e=t[0]/t[1];return function(t){return[e*(t*=.1)*Math.cos(t),t*Math.sin(t)]}},rectangular:function(t){var e=4*t[0]/t[1],i=0,n=0;return function(t){var r=t<0?-1:1;switch(Math.sqrt(1+4*r*t)-r&3){case 0:i+=e;break;case 1:n+=4;break;case 2:i-=e;break;default:n-=4}return[i,n]}}};var T$=function(t){function e(t){var i,a;return r(this,e),(i=n(this,e,[ft({},e.defaultOptions,t)])).cw=64,i.ch=2048,i._size=[256,256],i._isBoardExpandCompleted=!1,i._placeStatus=0,i._tTemp=null,i._dtTemp=null,i._dy=0,i.cacheMap=new Map,i.options.minFontSize<=e.defaultOptions.minFontSize&&(i.options.minFontSize=e.defaultOptions.minFontSize),i.spiral=Y(i.options.spiral)?null!==(a=w$[i.options.spiral])&&void 0!==a?a:w$.archimedean:i.options.spiral,i.random=i.options.random?Math.random:function(){return 1},i.getTextPadding=A$(i.options.padding),i}return h(e,t),o(e,[{key:"zoomRatio",value:function(){return this._originSize[0]/this._size[0]}},{key:"dy",value:function(){return this._dy}},{key:"layoutWord",value:function(t){var e=this.data[t];if(""===(""+e.text).trim())return!0;var i=lS(this.options.shape,this._size),n=i.maxRadius,r=i.center;if(e.x=r[0],e.y=r[1],function(t,e,i,n,r,a){if(e.sprite)return;var o=t.context,s=t.ratio;o.setTransform(s,0,0,s,0,0),o.clearRect(0,0,(r<<5)/s,a/s);var l,u,c,h,d,p=0,f=0,v=0,g=i.length;for(--n;++n<g;){if(e=i[n],o.save(),o.font=e.fontStyle+" "+e.fontWeight+" "+~~((e.fontSize+1)/s)+"px "+e.fontFamily,l=o.measureText(e.text+"m").width*s,c=e.fontSize<<1,e.angle){var y=Math.sin(e.angle),m=Math.cos(e.angle),_=l*m,b=l*y,x=c*m,k=c*y;l=Math.max(Math.abs(_+k),Math.abs(_-k))+31>>5<<5,c=~~Math.max(Math.abs(b+x),Math.abs(b-x))}else l=l+31>>5<<5;if(c>v&&(v=c),p+l>=r<<5&&(p=0,f+=v,v=0),f+c>=a)break;o.translate((p+(l>>1))/s,(f+(c>>1))/s),e.angle&&o.rotate(e.angle),o.fillText(e.text,0,0),e.padding&&(o.lineWidth=2*e.padding,o.strokeText(e.text,0,0)),o.restore(),e.width=l,e.height=c,e.xoff=p,e.yoff=f,e.x1=l>>1,e.y1=c>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,p+=l}for(var S=o.getImageData(0,0,(r<<5)/s,a/s).data,A=[];--n>=0;)if((e=i[n]).hasText){for(u=(l=e.width)>>5,c=e.y1-e.y0,h=0;h<c*u;h++)A[h]=0;if(null==(p=e.xoff))return;f=e.yoff;var M=0,w=-1;for(d=0;d<c;d++){for(h=0;h<l;h++){var T=u*d+(h>>5),C=S[(f+d)*(r<<5)+(p+h)<<2]?1<<31-h%32:0;A[T]|=C,M|=C}M?w=d:(e.y0++,c--,d--,f++)}e.y1=e.y0+w,e.sprite=A.slice(0,(e.y1-e.y0)*u)}}(this.contextAndRatio,e,this.data,t,this.cw,this.ch),this._placeStatus=0,e.hasText&&this.place(this._board,e,this._bounds,n))return this.result.push(e),this._bounds?function(t,e){var i=t[0],n=t[1];e.x+e.x0<i.x&&(i.x=e.x+e.x0),e.y+e.y0<i.y&&(i.y=e.y+e.y0),e.x+e.x1>n.x&&(n.x=e.x+e.x1),e.y+e.y1>n.y&&(n.y=e.y+e.y1)}(this._bounds,e):this._bounds=[{x:e.x+e.x0,y:e.y+e.y0},{x:e.x+e.x1,y:e.y+e.y1}],e.x-=this._size[0]>>1,e.y-=this._size[1]>>1,this._tTemp=null,this._dtTemp=null,!0;if(this.updateBoardExpandStatus(e.fontSize),e.hasText&&this.shouldShrinkContinue()){if(1===this._placeStatus){var a=e.fontSize*this._originSize[0]/this.options.minFontSize,o=Math.max(e.width,e.height);if(o<=a)this.expandBoard(this._board,this._bounds,o/this._size[0]);else{if(!this.options.clip)return!0;this.expandBoard(this._board,this._bounds,a/this._size[0])}}else this._placeStatus,this.expandBoard(this._board,this._bounds);return this.updateBoardExpandStatus(e.fontSize),!1}return this._tTemp=null,this._dtTemp=null,!0}},{key:"layout",value:function(t,e){var i=this;this.initProgressive(),this.result=[],this._size=[e.width,e.height],this.clearCache(),this._originSize=m(this._size);var n=this.getContext(ex.createCanvas({width:1,height:1}));this.contextAndRatio=n,this._board=new Array((this._size[0]>>5)*this._size[1]).fill(0),this._bounds=null,t.length,this.result=[];var r=t.map((function(t,e){return{text:i.getText(t),fontFamily:i.getTextFontFamily(t),fontStyle:i.getTextFontStyle(t),fontWeight:i.getTextFontWeight(t),angle:i.getTextRotate(t,e),fontSize:~~i.getTextFontSize(t),padding:i.getTextPadding(t),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:t,x:0,y:0,width:0,height:0}})).sort((function(t,e){return e.fontSize-t.fontSize}));if(this.originalData=r,this.data=r,this.progressiveRun(),!this.options.clip&&this.options.enlarge&&this._bounds&&this.shrinkBoard(this._bounds),this._bounds&&["cardioid","triangle","triangle-upright"].includes(this.options.shape)){var a=(this._bounds[0].y+this._bounds[1].y)/2;this._dy=-(a-this._originSize[1]/2)}return this.result}},{key:"formatTagItem",value:function(t){for(var e,i,n=this._size,r=this.zoomRatio(),a=this.dy(),o=n[0]>>1,s=n[1]>>1,l=t.length,u=[],c=0;c<l;++c)e=t[c],(i={}).datum=e.datum,i.x=(e.x+o)*r,i.y=(e.y+s+a)*r,i.fontFamily=e.fontFamily,i.fontSize=e.fontSize*r,i.fontStyle=e.fontStyle,i.fontWeight=e.fontWeight,i.angle=e.angle,u.push(i);return u}},{key:"output",value:function(){return this.outputCallback?this.outputCallback(this.formatTagItem(this.result)):this.formatTagItem(this.result)}},{key:"progressiveOutput",value:function(){return this.outputCallback?this.outputCallback(this.formatTagItem(this.progressiveResult)):this.formatTagItem(this.progressiveResult)}},{key:"updateBoardExpandStatus",value:function(t){this._isBoardExpandCompleted=t*(this._originSize[0]/this._size[0])<this.options.minFontSize}},{key:"shouldShrinkContinue",value:function(){return!this.options.clip&&this.options.shrink&&!this._isBoardExpandCompleted}},{key:"shrinkBoard",value:function(t){var e=t[0],i=t[1];if(!(i.x>=this._size[0]||i.y>=this._size[1])){var n=Math.min(e.x,this._size[0]-i.x),r=Math.min(e.y,this._size[1]-i.y),a=2*Math.min(n/this._size[0],r/this._size[1]);this._size=this._size.map((function(t){return t*(1-a)}))}}},{key:"expandBoard",value:function(t,e,i){var n=this._size[0]*(i||1.1)-this._size[0]>>5,r=2*n>2?n:2;r%2!=0&&r++;var a=Math.ceil(this._size[1]*(r<<5)/this._size[0]);a%2!=0&&a++;var o=this._size[0],s=this._size[1],l=new Array(r).fill(0),u=new Array(a/2*(r+(o>>5))).fill(0);this.insertZerosToArray(t,s*(o>>5),u.length+r/2);for(var c=s-1;c>0;c--)this.insertZerosToArray(t,c*(o>>5),l.length);this.insertZerosToArray(t,0,u.length+r/2),this._size=[o+(r<<5),s+a],e&&(e[0].x+=(r<<5)/2,e[0].y+=a/2,e[1].x+=(r<<5)/2,e[1].y+=a/2)}},{key:"insertZerosToArray",value:function(t,e,i){if(this.options.customInsertZerosToArray)return this.options.customInsertZerosToArray(t,e,i);for(var n=Math.floor(i/6e4),r=i%6e4,a=0;a<n;a++)t.splice.apply(t,[e+6e4*a,0].concat(m(new Array(6e4).fill(0))));t.splice.apply(t,[e+6e4*n,0].concat(m(new Array(r).fill(0))))}},{key:"getContext",value:function(t){t.width=1,t.height=1;var e=t.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,1,1),i=Math.sqrt(e.data.length>>2);t.width=(this.cw<<5)/i,t.height=this.ch/i;var n=t.getContext("2d",{willReadFrequently:!0});return n.fillStyle=n.strokeStyle="red",n.textAlign="center",{context:n,ratio:i,canvas:t}}},{key:"place",value:function(t,e,i,n){var r=!1;if(this.shouldShrinkContinue()&&(e.width>this._size[0]||e.height>this._size[1]))return this._placeStatus=1,!1;var a=this.random()<.5?1:-1;if(!this.shouldShrinkContinue()&&this.isSizeLargerThanMax(e,a))return null;var o,s,l,u,c=e.x,h=e.y,d=Math.sqrt(this._size[0]*this._size[0]+this._size[1]*this._size[1]),p=this.spiral(this._size),f=-a;for(this._tTemp=null,this._dtTemp=null;o=p(f+=a);){s=o[0],l=o[1];var v=Math.sqrt(Math.pow(s,2)+Math.pow(l,2)),g=Math.atan(l/s);s<0?g+=Math.PI:l<0&&(g=2*Math.PI+g);var y=this.shape(g);if(Math.min(Math.abs(s),Math.abs(l))>=d)break;if(v>=n)r&&null===this._tTemp&&(this._tTemp=f,this._dtTemp=a);else{if(e.x=c+~~(v*y*Math.cos(-g)),e.y=h+~~(v*y*Math.sin(-g)),u=e,this.options.clip)if(this.shouldShrinkContinue()){if(R$(u,this._size)){r&&null===this._tTemp&&(this._tTemp=f,this._dtTemp=a);continue}}else{if(P$(u,this._size)){r&&null===this._tTemp&&(this._tTemp=f,this._dtTemp=a);continue}R$(u,this._size)&&(u=B$(u,this._size))}else if(R$(u,this._size)){r&&null===this._tTemp&&(this._tTemp=f,this._dtTemp=a);continue}if(r=!0,(!i||E$(u,i))&&(!i||!C$(u,t,this._size))){for(var m=u.sprite,_=u.width>>5,b=this._size[0]>>5,x=u.x-(_<<4),k=127&x,S=32-k,A=u.y1-u.y0,M=void 0,w=(u.y+u.y0)*b+(x>>5),T=0;T<A;T++){M=0;for(var C=0;C<=_;C++)t[w+C]|=M<<S|(C<_?(M=m[T*_+C])>>>k:0);w+=b}return e.sprite=null,u.sprite=null,!0}}}return null!==this._tTemp&&(this._placeStatus=3),!this.shouldShrinkContinue()&&this.setCache(u,a),!1}},{key:"clearCache",value:function(){this.cacheMap.clear()}},{key:"setCache",value:function(t,e){var i="".concat(t.angle,"-").concat(e),n=t.x1-t.x0,r=t.y1-t.y0;if(this.cacheMap.has(i)){var a=this.cacheMap.get(i),o=a.width,s=a.height;(n<o&&r<s||n<=o&&r<s)&&this.cacheMap.set(i,{width:n,height:r})}else this.cacheMap.set(i,{width:n,height:r})}},{key:"isSizeLargerThanMax",value:function(t,e){var i="".concat(t.angle,"-").concat(e);if(!this.cacheMap.has(i))return!1;var n=this.cacheMap.get(i),r=n.width,a=n.height,o=t.x1-t.x0,s=t.y1-t.y0;return o>=r&&s>=a}}])}(M$);function C$(t,e,i){for(var n,r=i[0]>>5,a=t.sprite,o=t.width>>5,s=t.x-(o<<4),l=127&s,u=32-l,c=t.y1-t.y0,h=(t.y+t.y0)*r+(s>>5),d=0;d<c;d++){n=0;for(var p=0;p<=o;p++)if((n<<u|(p<o?(n=a[d*o+p])>>>l:0))&e[h+p])return!0;h+=r}return!1}function E$(t,e){return t.x+t.x1>e[0].x&&t.x+t.x0<e[1].x&&t.y+t.y1>e[0].y&&t.y+t.y0<e[1].y}T$.defaultOptions={enlarge:!1,minFontSize:2,maxSingleWordTryCount:2};var P$=function(t,e){return t.x+t.x0>e[0]||t.y+t.y0>e[0]||t.x+t.x1<0||t.y+t.y1<0},R$=function(t,e){return t.x+t.x0<0||t.y+t.y0<0||t.x+t.x1>e[0]||t.y+t.y1>e[1]};function B$(t,e){for(var i=t.sprite,n=t.y1-t.y0,r=t.width>>5,a=0,o=[],s=Math.max(-(t.y0+t.y),0),l=Math.min(n+(e[1]-(t.y1+t.y)),n),u=Math.max(-(t.x0+t.x),0)>>5,c=Math.min(r+(e[0]-(t.x1+t.x)>>5)+1,r),h=0;h<n;h++){for(var d=0;d<r;d++)h<s||l<=h||d<u||c<=d||o.push(i[a+d]);a+=r}var p=u<<5,f=r-c<<5,v=s,g=n-l;return Object.assign(Object.assign({},t),{width:t.width-p-f,height:t.height-v-g,x0:t.x0+p,x1:t.x1-f,y0:t.y0+v,y1:t.y1-g,x:t.x+p/2-f/2,sprite:o})}var I$=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[ft({},e.defaultOptions,t)])).fillGridAt=function(t,e){t>=i.ngx||e>=i.ngy||t<0||e<0||(i.grid[t][e]=!1)},i.updateGrid=function(t,e,n,r,a){for(var o=a.occupied,s=o.length;s--;){var l=t+o[s][0],u=e+o[s][1];l>=i.ngx||u>=i.ngy||l<0||u<0||i.fillGridAt(l,u)}},i.gridSize=Math.max(Math.floor(i.options.gridSize),4),i}return h(e,t),o(e,[{key:"getPointsAtRadius",value:function(t){if(this.pointsAtRadius[t])return this.pointsAtRadius[t];var e=8*t,i=e,n=[];for(0===t&&n.push([this.center[0],this.center[1],0]);i--;){var r=this.shape(i/e*2*Math.PI);n.push([this.center[0]+t*r*Math.cos(-i/e*2*Math.PI),this.center[1]+t*r*Math.sin(-i/e*2*Math.PI)*this.options.ellipticity,i/e*2*Math.PI])}return this.pointsAtRadius[t]=n,n}},{key:"getTextInfo",value:function(t){var e,i=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,a=this.options.clip?1:n,o=Math.max(Math.floor((this.isTryRepeatFill?this.options.fillTextFontSize:this.getTextFontSize(t))*a),this.options.minFontSize),s=this.getText(t)+"";if(this.options.clip&&(s=s.slice(0,Math.ceil(s.length*n))),!s)return null;var l=this.getTextFontWeight(t),u=this.getTextFontStyle(t),c=this.getTextRotate&&null!==(e=this.getTextRotate(t,r))&&void 0!==e?e:0,h=this.getTextFontFamily(t),d=document.createElement("canvas"),p=d.getContext("2d",{willReadFrequently:!0});p.font=u+" "+l+" "+o.toString(10)+"px "+h;var f=p.measureText(s).width,v=Math.max(o,p.measureText("m").width,p.measureText("Ｗ").width),g=f+2*v,y=3*v,m=Math.ceil(g/this.gridSize),_=Math.ceil(y/this.gridSize);g=m*this.gridSize,y=_*this.gridSize;var b=-f/2,x=.4*-v,k=Math.ceil((g*Math.abs(Math.sin(c))+y*Math.abs(Math.cos(c)))/this.gridSize),S=Math.ceil((g*Math.abs(Math.cos(c))+y*Math.abs(Math.sin(c)))/this.gridSize),A=S*this.gridSize,M=k*this.gridSize;d.setAttribute("width",""+A),d.setAttribute("height",""+M),p.scale(1,1),p.translate(A/2,M/2),p.rotate(-c),p.font=u+" "+l+" "+o.toString(10)+"px "+h,p.fillStyle="#000",p.textBaseline="middle",p.fillText(s,b,x);var w=p.getImageData(0,0,A,M).data;if(this.exceedTime())return null;for(var T,C=[],E=S,P=[k/2,S/2,k/2,S/2],R=function(t,e,n){for(var r=i.gridSize;r--;)for(var a=i.gridSize;a--;)if(w[4*((e*i.gridSize+r)*A+(t*i.gridSize+a))+3])return n.push([t,e]),t<P[3]&&(P[3]=t),t>P[1]&&(P[1]=t),e<P[0]&&(P[0]=e),void(e>P[2]&&(P[2]=e))};E--;)for(T=k;T--;)R(E,T,C);return{datum:t,occupied:C,bounds:P,gw:S,gh:k,fillTextOffsetX:b,fillTextOffsetY:x,fillTextWidth:f,fillTextHeight:v,fontSize:o,fontStyle:u,fontWeight:l,fontFamily:h,angle:c,text:s}}},{key:"calculateEmptyRate",value:function(){for(var t=this.ngx*this.ngy,e=0,i=0;i<this.ngx;i++)for(var n=0;n<this.ngy;n++)this.grid[i][n]&&e++;return e/t}},{key:"canFitText",value:function(t,e,i,n,r){for(var a=r.length;a--;){var o=t+r[a][0],s=e+r[a][1];if(o>=this.ngx||s>=this.ngy||o<0||s<0){if(!this.options.drawOutOfBound)return!1}else if(!this.grid[o][s])return!1}return!0}},{key:"layoutWord",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this.data[t],r=this.getTextInfo(n,i,t);if(!r)return!1;if(this.exceedTime())return!1;if(!this.options.drawOutOfBound&&(!this.options.shrink||r.fontSize<=this.options.minFontSize)&&!this.options.clip){var a=r.bounds;if(a[1]-a[3]+1>this.ngx||a[2]-a[0]+1>this.ngy)return!1}for(var o=this.maxRadius+1,s=function(t){var i=Math.floor(t[0]-r.gw/2),n=Math.floor(t[1]-r.gh/2),a=r.gw,s=r.gh;return!!e.canFitText(i,n,a,s,r.occupied)&&(r.distance=e.maxRadius-o,r.theta=t[2],e.outputText(i,n,r),e.updateGrid(i,n,a,s,r),!0)};o--;){var l=this.getPointsAtRadius(this.maxRadius-o);if(this.options.random&&wt(l=[].concat(l)),l.some(s))return!0}return(this.options.clip||!!(this.options.shrink&&r.fontSize>this.options.minFontSize))&&this.layoutWord(t,.75*i)}},{key:"outputText",value:function(t,e,i){var n=this.getTextColor(i),r={text:i.text,datum:i.datum,color:n,fontStyle:i.fontStyle,fontWeight:i.fontWeight,fontFamily:i.fontFamily,angle:i.angle,width:i.fillTextWidth,height:i.fillTextHeight,x:(t+i.gw/2)*this.gridSize,y:(e+i.gh/2)*this.gridSize+i.fillTextOffsetY+.5*i.fontSize,fontSize:i.fontSize};this.result.push(r),this.progressiveResult&&this.progressiveResult.push(r)}},{key:"initGrid",value:function(t){var e=this;this.grid=[];var i=this.options.shape;if(V(i)){var n=hS(i,t.width,t.height),r=n.getContext("2d").getImageData(0,0,this.ngx*this.gridSize,this.ngy*this.gridSize);this.options.onUpdateMaskCanvas&&this.options.onUpdateMaskCanvas(n);for(var a=cS(i.backgroundColor),o=function(t,i){for(var n=e.gridSize;n--;)for(var o=e.gridSize;o--;)if(!a(r,i*e.gridSize+n,t*e.gridSize+o))return void(e.grid[t][i]=!0);e.grid[t][i]=!1},s=this.ngx;s--;){this.grid[s]=[];for(var l=this.ngy;l--;)o(s,l),!1!==this.grid[s][l]&&(this.grid[s][l]=!0)}r=a=void 0}else for(var u=this.ngx;u--;){this.grid[u]=[];for(var c=this.ngy;c--;)this.grid[u][c]=!0}}},{key:"canRepeat",value:function(){return this.calculateEmptyRate()>.001}},{key:"layout",value:function(t,e){this.initProgressive(),this.drawnCount=0,this.isTryRepeatFill=!1,this.originalData=t,this.data=t,this.pointsAtRadius=[],this.ngx=Math.floor(e.width/this.gridSize),this.ngy=Math.floor(e.height/this.gridSize);var i=lS(this.options.shape,[e.width,e.height]),n=i.center,r=i.maxRadius;return this.center=e.origin?[e.origin[0]/this.gridSize,e.origin[1]/this.gridSize]:[n[0]/this.gridSize,n[1]/this.gridSize],this.maxRadius=Math.floor(r/this.gridSize),this.initGrid(e),this.result=[],this.progressiveRun()}}])}(M$);I$.defaultOptions={gridSize:8,ellipticity:1,maxSingleWordTryCount:1};var L$=function(t){function e(t){var i;return r(this,e),(i=n(this,e,[ft({},e.defaultOptions,t)])).random=i.options.random?Math.random:function(){return 0},i.aspectRatio=1,i}return h(e,t),o(e,[{key:"fit",value:function(t){for(var e=0,i=this.result.length;e<i;e++)if(D$(t,this.result[e]))return!1;return!0}},{key:"getTextInfo",value:function(t,e){var i={datum:t,fontSize:this.getTextFontSize(t),fontWeight:this.getTextFontWeight(t),fontStyle:this.getTextFontStyle(t),fontFamily:this.getTextFontFamily(t),angle:this.getTextRotate(t,e),text:this.getText(t)+"",x:this.center[0],y:this.center[1]},n=Iy(i);return i.width=n.width(),i.height=n.height(),i.top=this.center[1]-i.height+.21*i.height,i.left=this.center[0]-i.width/2,i}},{key:"layoutWord",value:function(t){for(var e=this.getTextInfo(this.data[t],t),i=2*Math.PI,n=0,r=e.left,a=e.top,o=e.width,s=e.height,l=1,u=this.fit(e);!u&&n<this.maxRadius;)n+=.5,l=this.shape(n/this.maxRadius*2*Math.PI),i+=.5*(this.options.random?this.random()>.5?1:-1:t%2==0?1:-1),r=this.center[0]-o/2+n*l*Math.cos(i)*this.aspectRatio,a=this.center[1]-s/2+n*l*Math.sin(i),e.left=r,e.top=a,e.x=r+o/2,e.y=a+s/2,u=this.fit(e);return!!u&&!!(this.options.clip||e.left>=0&&e.left+e.width<=this.width&&e.top>=0&&e.top+e.height<=this.height)&&(this.result.push(e),!0)}},{key:"layout",value:function(t,e){var i=this;if(!(null==t?void 0:t.length))return[];this.initProgressive(),this.result=[],this.maxRadius=Math.sqrt(e.width*e.width+e.height*e.height)/2,this.center=[e.width/2,e.height/2],this.width=e.width,this.height=e.height,this.data=t.sort((function(t,e){return i.getTextFontSize(e)-i.getTextFontSize(t)}));for(var n=0;n<t.length&&(this.layoutWord(n),n++,this.progressiveIndex=n,!this.exceedTime()););return this.result}}])}(M$);function D$(t,e){return!(t.left+t.width<e.left||t.top+t.height<e.top||t.left>e.left+e.width||t.top>e.top+e.height)}L$.defaultOptions={enlarge:!1};var O$={x:"x",y:"y",z:"z",fontFamily:"fontFamily",fontSize:"fontSize",fontStyle:"fontStyle",fontWeight:"fontWeight",angle:"angle"},F$=function(t,e){var i,n,r,a,o,s;if(t.size&&(t.size[0]<=0||t.size[1]<=0))return Lt.getInstance().info("Wordcloud size dimensions must be greater than 0"),[];var l=e,u=(null!==(i=t.size)&&void 0!==i?i:[500,500]).slice();u[0]=Math.floor(u[0]),u[1]=Math.floor(u[1]);var c=t.fontFamily?z$(t.fontFamily):"sans-serif",h=t.fontStyle?z$(t.fontStyle):"normal",d=t.fontWeight?z$(t.fontWeight):"normal",p=t.rotate?z$(t.rotate):0,f=z$(t.text),v=null!==(n=t.spiral)&&void 0!==n?n:"archimedean",g=t.padding?z$(t.padding):1,y=null!==(r=t.shape)&&void 0!==r?r:"square",m=null!==(a=t.shrink)&&void 0!==a&&a,_=null!==(o=t.enlarge)&&void 0!==o&&o,b=null!==(s=t.clip)&&void 0!==s&&s,x=t.minFontSize,k=t.randomVisible,S=t.as?Object.assign(Object.assign({},O$),t.as):O$,A=t.depth_3d,M=t.postProjection,w=t.fontSize?z$(t.fontSize):14,T=t.fontSizeRange;if(T&&!Z(w)){var C=w,E=j$(N$(C,l),T);w=function(t){return E(C(t))}}var P=T$;"fast"===t.layoutType?P=L$:"grid"===t.layoutType&&(P=I$);var R=new P(Object.assign(Object.assign({},t),{text:f,padding:g,spiral:v,shape:y,rotate:p,fontFamily:c,fontStyle:h,fontWeight:d,fontSize:w,shrink:m,clip:b,enlarge:_,minFontSize:x,random:k,outputCallback:function(e){for(var i,n,r=[],a=0,o=e.length;a<o;a++)(i=(n=e[a]).datum)[S.x]=n.x,i[S.y]=n.y,i[S.fontFamily]=n.fontFamily,i[S.fontSize]=n.fontSize,i[S.fontStyle]=n.fontStyle,i[S.fontWeight]=n.fontWeight,i[S.angle]=n.angle,"StereographicProjection"===M&&V$(u,n,i,S,A),t.dataIndexKey&&(i[t.dataIndexKey]="".concat(a)),r.push(i);return r}}));return R.layout(l,{width:u[0],height:u[1]}),t.progressiveStep>0||t.progressiveTime>0?{progressive:R}:R.output()},z$=function(t){return Y(t)||Z(t)||H(t)||X(t)?t:function(e){return e[t.field]}},H$=function(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)},j$=function(t,e,i){if(t[0]===t[1])return function(t){return e[0]};var n=H$(t[0]),r=H$(t[1]),a=Math.min(n,r),o=Math.max(n,r);return function(t){return(H$(t)-a)/(o-a)*(e[1]-e[0])+e[0]}},N$=function(t,e){for(var i,n=1/0,r=-1/0,a=e.length,o=0;o<a;++o)(i=Pt(t(e[o])))<n&&(n=i),i>r&&(r=i);return 1===e.length&&n===r&&(n-=1e4),[n,r]};function V$(t,e,i,n,r){var a=Math.max(t[0],t[1])/2,o=function(t,e,i,n,r){var a=r.x,o=r.y,s=a/t*Math.PI*2,l=Math.PI-o/e*Math.PI;return l+=(l<Math.PI/2?1:-1)*Math.pow(Math.min(l-Math.PI/2,1),2)/5,{x:i*Math.sin(l)*Math.cos(s)+n.x,y:i*Math.cos(l)+n.y,z:i*Math.sin(l)*Math.sin(s)+n.z}}(t[0],t[1],a,{x:a,y:a,z:null!=r?r:a},e);i[n.x]=o.x,i[n.y]=o.y,i[n.z]=o.z}var W$,G$=function(){xj.registerTransform("wordcloud",{transform:F$,markPhase:"beforeJoin"},!0)};!function(t){t.BEFORE_WORDCLOUD_SHAPE_LAYOUT="beforeWordcloudShapeLayout",t.AFTER_WORDCLOUD_SHAPE_LAYOUT="afterWordcloudShapeLayout",t.AFTER_WORDCLOUD_SHAPE_DRAW="afterWordcloudShapeDraw"}(W$||(W$={}));var U$=function(t){return/^[\u4e00-\u9fa5]+$/.test(t)},Y$=function(t,e){if(j(t))return 0;var i,n=0,r=s(t);try{for(r.s();!(i=r.n()).done;){var a=i.value;U$(a)?n+=1:n+=.53}}catch(t){r.e(t)}finally{r.f()}return n};function X$(t,e,i){var n=e.stepFactor,r=e.importantWordCount,a=e.globalShinkLimit,o=i.size,s=i.segmentation.regions,l=i.tempCanvas,u=i.boardSize,c=i.shapeCenter,h=i.shapeMaxR,d=i.shapeRatio,p=l.getContext("2d",{willReadFrequently:!0}),f=Q$(i),v=f.slice(0),g=e.fontSizeShrinkFactor,y=null,m=1,_=1,b=r,x=0;t.length>b&&(x=t.sort((function(t,e){return e.weight-t.weight}))[b].weight);for(var k=0;k<s.length;k++){for(var S=s[k],A=S.words,M=S.center,w=S.maxR,T=S.ratio,C=!1,E=0;E<A.length;E++){J$(l,p,t,E);var P=A[E];if(P.x=M[0],P.y=M[1],!P.skip&&P.hasText&&P.sprite&&K$(v,P,w,T,o,u,n))P.hasPlaced=!0;else{if(!P.skip&&P.weight>x&&_>a){var R=P.datum[Symbol.for("vGrammar_id")];R!==y&&(y=R,m=_),_*=g,t.forEach((function(t){t.hasText=!1,t.sprite=null,t.fontSize=t.fontSize*g})),v=f.slice(0),C=!0;break}if(!P.skip&&P.datum[Symbol.for("vGrammar_id")]===y){t.forEach((function(t){t.hasText=!1,t.sprite=null,t.fontSize=t.fontSize/_})),P.skip=!0,_=m,y=null,v=f.slice(0),C=!0;break}}}C&&(k=-1)}for(var B=0;B<e.textLayoutTimes;B++){var I=t.filter((function(t){return t.hasPlaced||(t.hasText=!1,t.sprite=null,t.fontSize=Math.max(~~(t.fontSize*e.fontSizeShrinkFactor),e.minFontSize)),!t.hasPlaced}));if(0===I.length)break;for(var L=0;L<I.length;L++){var D=I[L];J$(l,p,I,L),D.x=c[0],D.y=c[1],D.hasText&&K$(v,D,h,d,o,u,n)&&(D.hasPlaced=!0)}}e.board=v}function K$(t,e,i,n,r,a,o){for(var s,l,u,c=e.x,h=e.y,d=function(t){return function(e){return[t*(e*=.1)*Math.cos(e),e*Math.sin(e)]}}(n),p=1*o,f=-p;s=d(f+=p);){e.wordSize;var v=e.bounds,g=v.dTop,y=v.dBottom,m=v.dLeft,_=v.dRight;if(l=s[0],u=s[1],Math.min(Math.abs(l),Math.abs(u))>=i)break;if(e.x=~~(c+l),e.y=~~(h+u),!(e.x-m<0||e.x+_>r[0]||e.y-g<0||e.y+y>r[1]||Z$(e,t,a)))return q$(e,t,a),!0}return!1}function q$(t,e,i){var n,r=t.wordSize,a=t.sprite,o=r[0]>>5,s=i[0]>>5,l=t.x-(o<<4),u=l%32,c=32-u,h=r[1],d=(t.y-(r[1]>>1))*s+(l>>5);if(0===u)for(var p=0;p<h;p++){for(var f=0;f<o;f++)e[d+f]|=a[p*o+f];d+=s}else for(var v=0;v<h;v++){n=0;for(var g=0;g<=o;g++)e[d+g]|=n<<c|(g<o?(n=a[v*o+g])>>>u:0);d+=s}}function Z$(t,e,i){var n,r=t.sprite,a=t.wordSize,o=i[0]>>5,s=a[0]>>5,l=t.x-(s<<4),u=l%32,c=32-u,h=a[1],d=(t.y-(a[1]>>1))*o+(l>>5);if(0===u)for(var p=0;p<h;p++){for(var f=0;f<s;f++)if(e[d+f]&r[p*s+f])return!0;d+=o}else for(var v=0;v<h;v++){n=0;for(var g=0;g<=s;g++)if((n<<c|(g<s?(n=r[v*s+g])>>>u:0))&e[d+g])return!0;d+=o}return!1}function J$(t,e,i,n){if(!i[n].sprite&&0!==i[n].fontSize){var r=2048,a=Math.PI/180,o=i.length;t.width=r,t.height=2048,e.clearRect(0,0,r,2048),e.textAlign="center";var s,l,u=0,c=0,h=0,d=0,p=n;for(--n;++n<o;){var f=i[n],v=Math.max(f.fontSize,2);if(e.save(),e.font=f.fontStyle+" "+f.fontWeight+" "+v+"px "+f.fontFamily,s=e.measureText(f.text+"m").width+2*f.padding,l=2*v+2*f.padding,0!==f.rotate){var y=Math.sin(f.rotate*a),m=Math.cos(f.rotate*a),_=s*m,b=s*y,x=l*m,k=l*y;s=Math.max(Math.abs(_+k),Math.abs(_-k)),l=~~Math.max(Math.abs(b+x),Math.abs(b-x))}if(s=s+31>>5<<5,(l=Math.ceil(l))>h&&(h=l),u+s>=r&&(u=0,c+=h,h=l),c+l>=2048){if(0===c){f.hasText=!1;continue}break}c+l>=d&&(d=c+l),e.translate(u+(s>>1),c+(l>>1)),0!==f.rotate&&e.rotate(f.rotate*a),e.fillText(f.text,0,0),f.padding&&(e.lineWidth=2*f.padding,e.strokeText(f.text,0,0)),e.restore(),f.LT=[u,c],f.wordSize=[s,l],f.hasText=!0,u+=s}if(0!==d)for(var S,A,M=e.getImageData(0,0,r,d).data;--n>=p;){var w=i[n];if(!w.hasText){w.bounds={dTop:1/0,dBottom:-1/0,dLeft:1/0,dRight:-1/0};break}var T=w.LT,C=void 0===T?[0,0]:T,E=w.wordSize,P=g(C,2);u=P[0],c=P[1];var R=E[0]>>5,B=new Array(R*E[1]).fill(0),I=1/0,L=-1/0,D=1/0,O=-1/0;for(A=0;A<E[1];A++){var F=void 0;for(S=0;S<E[0];S++)if(M[4*((c+A)*r+(u+S))+3]>0){var z=1<<31-S%32;B[R*A+(S>>5)]|=z,S<D&&(D=S),S>O&&(O=S),F|=z}F&&(A<I&&(I=A),A>L&&(L=A))}w.bounds={dTop:(E[1]>>1)-I,dBottom:L-(E[1]>>1),dLeft:(E[0]>>1)-D,dRight:O-(E[0]>>1)},w.sprite=B,delete w.LT}}}function Q$(t){for(var e=t.segmentation.labels,i=t.boardSize,n=t.size,r=i[0]>>5,a=new Array(r*n[1]).fill(0),o=0;o<n[1];o++)for(var s=0;s<n[0];s++)if(0===e[o*n[0]+s]){var l=1<<31-s%32;a[r*o+(s>>5)]|=l}if(i[0]>n[0])for(var u=(1<<i[0]-n[0])-1,c=0;c<n[1];c++)a[r*c+r-1]|=u;return a}function $$(t,e,i){(function(t,e){var i=e.segmentation.regions,n=-1/0,r=0,a=0;i.forEach((function(t,e){var i=t.area;i>n&&(n=i,a=e),r+=i}));var o=0;i.forEach((function(e){var i=e.area,a=Math.ceil(i/r*t.length),s=i/n;e.words=[],e.regionNum=a,e.regionWeight=s,o+=a})),o<t.length&&(i[a].wordsNum+=t.length-o);var s=a,l=i.map((function(t){return t.regionNum}));t.forEach((function(t){var e=0,n=0;t.regionIndex=-1;do{if(l[s]>0&&t.weight<=i[s].regionWeight){t.regionIndex=s,i[s].words.push(t),l[s]--,s=(s+1)%i.length;break}s=(s+1)%i.length,e++,++n>i.length+1&&(i.forEach((function(t){t.regionWeight+=.15})),n=0)}while(-1===t.regionIndex&&e<3*i.length);-1===t.regionIndex&&(t.regionIndex=a,i[a].words.push(t),l[a]--)})),i.forEach((function(t){t.words.sort((function(t,e){return e.weight-t.weight}))}))})(t,i),"ensureMapping"===e.layoutMode?X$(t,e,i):"ensureMappingEnlarge"===e.layoutMode?function(t,e,i){var n=e.size,r=e.stepFactor,a=e.importantWordCount,o=i.segmentation.regions,s=i.tempCanvas,l=i.boardSize,u=i.shapeCenter,c=i.shapeMaxR,h=i.shapeRatio,d=s.getContext("2d",{willReadFrequently:!0}),p=Q$(i),f=p.slice(0),v=e.fontSizeEnlargeFactor,g=Math.min(a,t.length),y=0;t.length>g&&(y=t.sort((function(t,e){return e.weight-t.weight}))[g-1].weight);for(var m=0,_=1,b=!1,x=0;x<o.length;x++){for(var k=o[x],S=k.words,A=k.center,M=k.maxR,w=k.ratio,T=!1,C=0;C<S.length;C++){J$(s,d,t,C);var E=S[C];if(E.x=A[0],E.y=A[1],E.hasText&&E.sprite&&K$(f,E,M,w,n,l,r)){if(E.hasPlaced=!0,E.weight>=y&&m++,m>=g&&!b){_*=v,t.forEach((function(t){t.hasText=!1,t.sprite=null,t.fontSize=t.fontSize*v})),f=p.slice(0),T=!0,m=0;break}}else{if(E.weight>=y&&_>1){t.forEach((function(t){t.hasText=!1,t.sprite=null,t.fontSize=t.fontSize/v})),_/=v,b=!0,f=p.slice(0),T=!0;break}if(E.weight>=y)return X$(t,e,i)}}T&&(x=-1)}for(var P=0;P<e.textLayoutTimes;P++){var R=t.filter((function(t){return t.hasPlaced||(t.hasText=!1,t.sprite=null,t.fontSize=Math.max(~~(t.fontSize*e.fontSizeShrinkFactor),e.minFontSize)),!t.hasPlaced}));if(0===R.length)break;for(var B=0;B<R.length;B++){var I=R[B];J$(s,d,R,B),I.x=u[0],I.y=u[1],I.hasText&&K$(f,I,c,h,n,l,r)&&(I.hasPlaced=!0)}}e.board=f}(t,e,i):function(t,e,i){var n,r=e.size,a=e.stepFactor,o=i.segmentation.regions,l=i.tempCanvas,u=i.boardSize,c=i.shapeCenter,h=i.shapeMaxR,d=i.shapeRatio,p=Q$(i),f=l.getContext("2d",{willReadFrequently:!0}),v=s(o);try{for(v.s();!(n=v.n()).done;)for(var g=n.value,y=g.words,m=g.center,_=g.maxR,b=g.ratio,x=0;x<y.length;x++){J$(l,f,t,x);var k=y[x];k.x=m[0],k.y=m[1],k.hasText&&k.sprite&&K$(p,k,_,b,r,u,a)&&(k.hasPlaced=!0)}}catch(t){v.e(t)}finally{v.f()}for(var S=0;S<e.textLayoutTimes;S++){var A=t.filter((function(t){return t.hasPlaced||(t.hasText=!1,t.sprite=null,t.fontSize=Math.max(~~(t.fontSize*e.fontSizeShrinkFactor),e.minFontSize)),!t.hasPlaced}));if(0===A.length)break;for(var M=0;M<A.length;M++){var w=A[M];J$(l,f,A,M),w.x=c[0],w.y=c[1],w.hasText&&K$(p,w,h,d,r,u,a)&&(w.hasPlaced=!0)}}e.board=p}(t,e,i);for(var n=function(t,e,i){for(var n=e.size,r=e.fillingTimes,a=e.fillingXStep,o=e.fillingYStep,s=e.getFillingFontStyle,l=e.getFillingFontWeight,u=e.getFillingFontFamily,c=e.fillingInitialFontSize,h=e.fillingDeltaFontSize,d=e.fillingInitialOpacity,p=e.fillingDeltaOpacity,f=e.fillingRotateList,v=e.getFillingPadding,g=e.random,y=e.board,m=e.minFillFontSize,_=i.boardSize,b=i.shapeBounds,x=i.tempCanvas,k=i.randomGenerator,S=x.getContext("2d",{willReadFrequently:!0}),A=c,M=d,w=[],T=0;T<r;T++)C(A,M),A=Math.max(A>h?A-h:h,m),M=M>p?M-p:p;return w;function C(e,i){var r=t.map((function(t){var n=t.text,r=t.color,a=t.fillingColor,o=t.hasPlaced,c=t.datum;return{x:0,y:0,weight:0,text:n,fontFamily:u(c),fontStyle:s(c),fontWeight:l(c),fontSize:e,rotate:f[~~(k()*f.length)],padding:v(c),opacity:i,visible:!0,color:r,fillingColor:a,hasPlaced:o,datum:c}}));E(r);for(var c=0,h=b.x1,d=b.y1,p=b.x2,m=b.y2,A=h+~~(k()*a*2),M=d+~~(k()*o*2);M<=m;M+=o)for(var T=A;T<=p;T+=a){J$(x,S,r,c);var C=r[c];C.x=T,C.y=M,C.wordSize;var P=C.bounds;if(C.hasPlaced&&P){var R=P.dTop,B=P.dBottom,I=P.dLeft,L=P.dRight;C.x-I<0||C.x+L>n[0]||C.y-R<0||C.y+B>n[1]||C.hasText&&C.sprite&&!Z$(C,y,_)&&(q$(C,y,_),w.push(Object.assign({},C)),++c===r.length&&(c=0,g&&E(r)))}else++c===r.length&&(c=0,g&&E(r))}}function E(t){return t.sort((function(){return k()-.5}))}}(t,e,i),r=[],a=[],o=0;o<t.length;o++)t[o].hasPlaced?a.push(t[o]):r.push(t[o]);return r.forEach((function(t){return t.visible=!1})),{fillingWords:n,successedWords:a,failedWords:r}}var t0={x:"x",y:"y",fontFamily:"fontFamily",fontSize:"fontSize",fontStyle:"fontStyle",fontWeight:"fontWeight",angle:"angle",opacity:"opacity",visible:"visible",isFillingWord:"isFillingWord",color:"color"},e0=function(){return o((function t(e,i){r(this,t),this.progressiveResult=[],this.options=e,this.view=i}),[{key:"layout",value:function(t){var e=this;this.data=t;var i=this.options,n={shapeUrl:i.shape,size:i.size,ratio:i.ratio||.8,tempCanvas:void 0,boardSize:[0,0],random:!1,randomGenerator:void 0},r=ex.createCanvas({width:i.size[0],height:i.size[1]}),a=r.getContext("2d",{willReadFrequently:!0});a.textAlign="center",a.textBaseline="middle",n.tempCanvas=r;var o,s=i.size[0]+31>>5<<5;if(n.boardSize=[s,i.size[1]],n.random?n.randomGenerator=Math.random:n.randomGenerator=function(){var t=-1,e=[0,.1,.2,.3,.4,.5,.6,.7,.8,.9];return function(){return e[t=(t+1)%e.length]}}(),this.segmentationInput=n,Y(n.shapeUrl)){n.isEmptyPixel=cS();var l=(o=n.shapeUrl)&&($(o)||et(o)||o.startsWith("<svg"))?new Promise((function(t,e){var i,n=ry({image:o}),r=null===(i=n.resources)||void 0===i?void 0:i.get(o);r&&"success"===r.state&&r.data?t(r.data):(n.successCallback=function(){var i;if(n){var r=null===(i=n.resources)||void 0===i?void 0:i.get(o);r&&"success"===r.state&&r.data?t(r.data):e(new Error("image load failed"+o))}else e(new Error("image load failed"+o))},n.failCallback=function(){Lt.getInstance().error("image 加载失败！",o)})})):null;l?(this.isImageFinished=!1,this.isLayoutFinished=!1,l.then((function(t){e.isImageFinished=!0;var r=ex.createCanvas({width:i.size[0],height:i.size[1],dpr:1});n.maskCanvas=r;var a=r.getContext("2d");i.removeWhiteBorder&&function(t,e,i){e.width=t.width,e.height=t.height;var n=e.getContext("2d",{willReadFrequently:!0});n.clearRect(0,0,e.width,e.height),n.drawImage(t,0,0);for(var r=e.width,a=n.getImageData(0,0,e.width,e.height),o=0,s=a.height,l=0,u=a.width,c=function(t,e){for(var n=0;n<t;++n)if(!i(a,e,n))return!1;return!0},h=function(t,e,n){for(var r=e;r<n;++r)if(!i(a,r,t))return!1;return!0};o<s&&c(r,o);)++o;for(;s-1>o&&c(r,s-1);)--s;for(;l<u&&h(l,o,s);)++l;for(;u-1>l&&h(u-1,o,s);)--u;var d=n.getImageData(l,o,u-l,s-o);e.width=d.width,e.height=d.height,n.clearRect(0,0,e.width,e.height),n.putImageData(d,0,0)}(t,r,n.isEmptyPixel);var o=function(t,e){var i=t.width,n=t.height,r=e[0]/i;n*r>e[1]&&(r=e[1]/n);var a=Math.floor(r*i),o=Math.floor(r*n);return{x:(e[0]-a)/2,y:(e[1]-o)/2,width:a,height:o,scale:r}}(t,i.size);a.clearRect(0,0,i.size[0],i.size[1]),a.drawImage(t,o.x,o.y,o.width,o.height),e.options.onUpdateMaskCanvas&&e.options.onUpdateMaskCanvas(n.maskCanvas)})).catch((function(t){e.isImageFinished=!0}))):(this.isImageFinished=!0,this.isLayoutFinished=!0)}else if(n.shapeUrl&&("text"===n.shapeUrl.type||"geometric"===n.shapeUrl.type)){n.isEmptyPixel=cS(n.shapeUrl.backgroundColor);var u=hS(n.shapeUrl,i.size[0],i.size[1]);n.maskCanvas=u,this.options.onUpdateMaskCanvas&&this.options.onUpdateMaskCanvas(u),this.doLayout(),this.isImageFinished=!0,this.isLayoutFinished=!0}}},{key:"canAnimate",value:function(){return!0}},{key:"unfinished",value:function(){return!this.isLayoutFinished}},{key:"output",value:function(){return this.progressiveResult}},{key:"progressiveRun",value:function(){this.isImageFinished&&!this.isLayoutFinished&&(this.segmentationInput.maskCanvas&&this.doLayout(),this.isLayoutFinished=!0)}},{key:"progressiveOutput",value:function(){return this.progressiveResult}},{key:"doLayout",value:function(){var t,e,i,n,r,a,o,s,l,u,c,h,d,p,f,v,y,_,b,x,k,S,A=this,M=this.segmentationInput,w=function(t){for(var e=t.size,i=t.maskCanvas,n=i.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,i.width,i.height),r=new Array(e[0]*e[1]).fill(0),a=1,o=[[0,1],[1,0],[-1,0],[0,-1]],s=[],l=0;l<e[1];l++)for(var u=0;u<e[0];u++)if(0===r[l*e[0]+u]&&!t.isEmptyPixel(n,l,u)){r[l*e[0]+u]=a,s.push([l,u]);for(var c=0;c<s.length;c++)for(var h=0;h<4;h++){var d=s[c][0]+o[h][0],p=s[c][1]+o[h][1];d=d<0?0:d>=e[1]?e[1]-1:d,p=p<0?0:p>=e[0]?e[0]-1:p,0!==r[d*e[0]+p]||t.isEmptyPixel(n,d,p)||(r[d*e[0]+p]=a,s.push([d,p]))}a++,s=[]}for(var f={},v={},y={},_={},b={},x={},k={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0,width:0,height:0},S=0;S<e[1];S++)for(var A=0;A<e[0];A++){var M=r[S*e[0]+A];0!==M&&(W(S,A)&&(f[M]=f[M]||[],f[M].push([A,S]),_[M]||(_[M]=[1/0,-1/0,1/0,-1/0]),S<_[M][0]&&(_[M][0]=S),S>_[M][1]&&(_[M][1]=S),A<_[M][2]&&(_[M][2]=A),A>_[M][3]&&(_[M][3]=A),A<k.x1&&(k.x1=A),A>k.x2&&(k.x2=A),S<k.y1&&(k.y1=S),S>k.y2&&(k.y2=S)),v[M]=v[M]||0,v[M]++)}var w=[];for(var T in f){var C=f[T],E=~~(C.reduce((function(t,e){return t+e[0]}),0)/C.length),P=~~(C.reduce((function(t,e){return t+e[1]}),0)/C.length);y[T]=[E,P],w.push.apply(w,m(C));var R=g(_[T],4),B=R[0],I=R[1],L=R[2],D=R[3];b[T]=~~Math.max(Math.sqrt(Math.pow(E-L,2)+Math.pow(P-B,2)),Math.sqrt(Math.pow(E-D,2)+Math.pow(P-I,2)),Math.sqrt(Math.pow(E-L,2)+Math.pow(P-I,2)),Math.sqrt(Math.pow(E-D,2)+Math.pow(P-B,2))),x[T]=(D-L)/(I-B)}var O=Object.keys(y).map((function(t){return{label:t-1,boundary:f[t],area:v[t],center:y[t],maxPoint:_[t],maxR:b[t],ratio:x[t]}}));k.width=k.x2-k.x1+1,k.height=k.y2-k.y1+1;var F=~~(w.reduce((function(t,e){return t+e[0]}),0)/w.length),z=~~(w.reduce((function(t,e){return t+e[1]}),0)/w.length),H=~~Math.max(Math.sqrt(Math.pow(F-k.x1,2)+Math.pow(z-k.y1,2)),Math.sqrt(Math.pow(F-k.x2,2)+Math.pow(z-k.y2,2)),Math.sqrt(Math.pow(F-k.x1,2)+Math.pow(z-k.y2,2)),Math.sqrt(Math.pow(F-k.x2,2)+Math.pow(z-k.y1,2))),j=k.width/k.height,N=Object.keys(v).reduce((function(t,e){return t+v[e]}),0),V={regions:O,labels:r,labelNumber:a-1};return Object.assign(t,{segmentation:V,shapeBounds:k,shapeMaxR:H,shapeRatio:j,shapeCenter:[F,z],shapeArea:N});function W(t,i){var n=[[0,1],[1,0],[-1,0],[0,-1]];if(0===t||0===i||t===e[1]-1||i===e[0]-1)return!0;for(var a=0;a<4;a++){var o=t+n[a][0],s=i+n[a][1];if(o=o<0?0:o>=e[1]?e[1]-1:o,s=s<0?0:s>=e[0]?e[0]-1:s,0===r[o*e[0]+s])return!0}return!1}}(M);if(w.segmentation.regions.length){var T=this.options,C=this.data,E=T.colorMode||"ordinal",P={getText:l0(T.text),getFontSize:l0(T.fontSize),fontSizeRange:T.fontSizeRange,colorMode:E,getColor:T.colorField?l0(T.colorField):l0(T.text),getFillingColor:l0(T.fillingColorField),colorList:T.colorList||("ordinal"===E?["#2E62F1"]:["#537EF5","#2E62F1","#2358D8","#184FBF","#0C45A6","#013B8E"]),getColorHex:l0(T.colorHexField),getFontFamily:l0(T.fontFamily||"sans-serif"),rotateList:T.rotateList||[0],getPadding:l0(T.padding||1),getFontStyle:l0(T.fontStyle||"normal"),getFontWeight:l0(T.fontWeight||"normal"),getFontOpacity:T.fontOpacity?l0(T.fontOpacity):function(){return 1}};n0(C,P,w);var R={size:T.size,ratio:T.ratio||.8,shapeUrl:T.shape,random:void 0===T.random||T.random,textLayoutTimes:null!==(t=T.textLayoutTimes)&&void 0!==t?t:3,removeWhiteBorder:T.removeWhiteBorder,layoutMode:null!==(e=T.layoutMode)&&void 0!==e?e:"default",fontSizeShrinkFactor:null!==(i=T.fontSizeShrinkFactor)&&void 0!==i?i:.8,stepFactor:null!==(n=T.stepFactor)&&void 0!==n?n:1,importantWordCount:null!==(r=T.importantWordCount)&&void 0!==r?r:10,globalShinkLimit:T.globalShinkLimit||.2,fontSizeEnlargeFactor:null!==(a=T.fontSizeEnlargeFactor)&&void 0!==a?a:1.5,fillingRatio:null!==(o=T.fillingRatio)&&void 0!==o?o:.7,fillingTimes:null!==(s=T.fillingTimes)&&void 0!==s?s:4,fillingXStep:T.fillingXRatioStep?Math.max(Math.floor(T.size[0]*T.fillingXRatioStep),1):null!==(l=T.fillingXStep)&&void 0!==l?l:4,fillingYStep:T.fillingYRatioStep?Math.max(Math.floor(T.size[1]*T.fillingYRatioStep),1):null!==(u=T.fillingYStep)&&void 0!==u?u:4,fillingInitialFontSize:T.fillingInitialFontSize,fillingDeltaFontSize:T.fillingDeltaFontSize,fillingInitialOpacity:null!==(c=T.fillingInitialOpacity)&&void 0!==c?c:.8,fillingDeltaOpacity:null!==(h=T.fillingDeltaOpacity)&&void 0!==h?h:.05,getFillingFontFamily:l0(T.fillingFontFamily||"sans-serif"),getFillingFontStyle:l0(T.fillingFontStyle||"normal"),getFillingFontWeight:l0(T.fillingFontWeight||"normal"),getFillingPadding:l0(null!==(d=T.fillingPadding)&&void 0!==d?d:.4),fillingRotateList:null!==(p=T.fillingRotateList)&&void 0!==p?p:[0,90],fillingDeltaFontSizeFactor:null!==(f=T.fillingDeltaFontSizeFactor)&&void 0!==f?f:.2,fillingColorList:T.fillingColorList||["#537EF5"],sameColorList:!1,minInitFontSize:null!==(v=T.minInitFontSize)&&void 0!==v?v:10,minFontSize:null!==(y=T.minFontSize)&&void 0!==y?y:4,minFillFontSize:null!==(_=T.minFillFontSize)&&void 0!==_?_:2},B=function(t,e){if(1===e.length&&"#537EF5"===e[0])return!0;if(!Array.isArray(t)||!Array.isArray(e)||t.length!==e.length)return!1;for(var i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}(P.colorList,R.fillingColorList);R.sameColorList=B,i0(C,P,R,T),function(t,e,i,n){var r=e.getText,a=i.fillingInitialFontSize,o=i.fillingDeltaFontSize,s=i.fillingRatio,l=Math.ceil(Math.sqrt(n.shapeArea)/4);if(!a||!o){var u,c=s/100,h=t.reduce((function(t,e){var i=Y$(r(e));return i>l?t:t+i}),0)/t.length;if(0===h)u=8;else{var d=.2*n.shapeArea;u=Math.sqrt(c*(d/h))}a=~~u,o=u*i.fillingDeltaFontSizeFactor,Object.assign(i,{fillingInitialFontSize:a,fillingDeltaFontSize:o})}}(C,P,R,w);var I=P.getText,L=P.getFontFamily,D=P.getFontStyle,O=P.getFontWeight,F=P.getPadding,z=P.getColor,H=P.getFillingColor,j=P.getColorHex,N=P.fontSizeScale,V=P.colorScale,W=P.fillingColorScale,G=P.getFontOpacity,U=P.rotateList,Y=C.map((function(t){var e,i;return{x:0,y:0,weight:0,text:I(t),fontFamily:L(t),fontWeight:O(t),fontStyle:D(t),rotate:U[~~(M.randomGenerator()*U.length)],fontSize:Math.max(R.minInitFontSize,~~N(t)),opacity:G(t),padding:F(t),color:j&&j(t)||V&&V(z(t))||"black",fillingColor:!H||(null===(e=T.colorField)||void 0===e?void 0:e.field)===(null===(i=T.fillingColorField)||void 0===i?void 0:i.field)&&B?void 0:j&&j(t)||W&&W(H(t))||"black",datum:t,visible:!0,hasPlaced:!1}})),X=St(Y.map((function(t){return t.fontSize})));Y.forEach((function(t){return t.weight=t.fontSize/X})),Y.sort((function(t,e){return e.weight-t.weight}));for(var K,q,Z=$$(Y,R,w),J=Z.fillingWords,Q=Z.successedWords,$=Z.failedWords,tt=null!==(x=null===(b=T.text)||void 0===b?void 0:b.field)&&void 0!==x?x:"textKey",et=null!==(k=T.dataIndexKey)&&void 0!==k?k:"defaultDataIndexKey",it=T.as?Object.assign(Object.assign({},t0),T.as):t0,nt=[],rt=0;rt<Y.length;++rt)(q=(K=Y[rt]).datum)[it.x]=K.x,q[it.y]=K.y,q[it.fontFamily]=K.fontFamily,q[it.fontSize]=K.fontSize,q[it.fontStyle]=K.fontStyle,q[it.fontWeight]=K.fontWeight,q[it.angle]=we(K.rotate),q[it.opacity]=K.opacity,q[it.visible]=K.visible,q[it.isFillingWord]=!1,q[it.color]=K.color,q[et]="".concat(K.text,"_").concat(rt,"_keyword"),nt.push(q);var at=[];if(J.forEach((function(t,e){var i,n,r=Object.assign({},t.datum);r[it.x]=t.x,r[it.y]=t.y,r[it.fontFamily]=t.fontFamily,r[it.fontSize]=t.fontSize,r[it.fontStyle]=t.fontStyle,r[it.fontWeight]=t.fontWeight,r[it.angle]=we(t.rotate),r[it.opacity]=t.opacity,r[it.visible]=t.visible,r[it.isFillingWord]=!0,r[it.color]=H?(null===(i=T.colorField)||void 0===i?void 0:i.field)===(null===(n=T.fillingColorField)||void 0===n?void 0:n.field)&&B?t.color:t.fillingColor:R.fillingColorList[~~(M.randomGenerator()*R.fillingColorList.length)],r[tt]=t.text,r[et]="".concat(t.text,"_").concat(e,"_fillingWords"),at.push(r)})),this.view&&this.view.emit){this.view.emit(W$.AFTER_WORDCLOUD_SHAPE_LAYOUT,{successedWords:Q,failedWords:$});var ot=null===(S=this.view.renderer)||void 0===S?void 0:S.stage();ot&&ot.hooks.afterRender.tap(W$.AFTER_WORDCLOUD_SHAPE_DRAW,(function(){A.view.emit(W$.AFTER_WORDCLOUD_SHAPE_DRAW,{successedWords:Q,failedWords:$}),ot.hooks.afterRender.unTap(W$.AFTER_WORDCLOUD_SHAPE_DRAW)}))}this.progressiveResult=nt.concat(at)}}},{key:"release",value:function(){this.segmentationInput=null,this.data=null,this.progressiveResult=null,this.options=null}}])}(),i0=function(t,e,i,n){var r,a,o,s,l,u,c=e.colorMode,h=e.getColor,d=e.getFillingColor,p=i.sameColorList,f=e.colorList,v=i.fillingColorList;if("ordinal"===c){var g=t.map((function(t){return h(t)}));if(l=function(t){return(new uI).domain(g).range(f).scale(t)},d&&((null===(r=n.colorField)||void 0===r?void 0:r.field)!==(null===(a=n.fillingColorField)||void 0===a?void 0:a.field)||!p)){var y=t.map((function(t){return d(t)}));u=function(t){return(new uI).domain(y).range(v).scale(t)}}}else{1===f.length&&(f=[f[0],f[0]]);var m=(new II).domain(s0(h,t)).range(f);if(l=function(t){return m.scale(t)},d&&((null===(o=n.colorField)||void 0===o?void 0:o.field)!==(null===(s=n.fillingColorField)||void 0===s?void 0:s.field)||!p)){1===v.length&&(v=[v[0],v[0]]);var _=(new II).domain(s0(d,t)).range(v);u=function(t){return _.scale(t)}}}Object.assign(e,{colorScale:l,fillingColorScale:u})},n0=function(t,e,i){var n,r,a=e.fontSizeRange,o=e.getFontSize,s=e.getText;if(o){if(o&&a){var l=(new HI).domain(s0(o,t)).range(a);n=function(t){return l.scale(o(t))}}else if(o&&H(o)&&!a){var u=g(s0(o,t),2),c=u[0],h=u[1],d=t.map((function(t){return{text:s(t),value:o(t),weight:h===c?1:(o(t)-c)/(h-c)}})),p=r0(d,i,!0);a=[~~(.5*p),~~p];var f=(new HI).domain(s0(o,t)).range(a);n=function(t){return f.scale(o(t))}}}else{var v=t.map((function(t){return{text:s(t)}})),y=r0(v,i,!1);n="function"==typeof(r=y)?r:function(){return r}}Object.assign(e,{getFontSize:o,fontSizeRange:a,fontSizeScale:n})},r0=function(t,e,i){var n=e.shapeArea,r=e.ratio,a=e.segmentation.regions,o=Math.ceil(Math.sqrt(n)/12),s=t.reduce((function(t,e){var n=Y$(e.text);return n<o?t+n*(i?Math.pow(.5+.5*e.weight,2):1):t}),0);if(0===s)return 12;var l=20;if(1===a.length)l=Math.sqrt(r*(n/(1.7*s)));else{for(var u=[],c=0;c<a.length;c++){var h=a[c].area,d=a[c].ratio,p=h/n;if(!(p<.1)){var f=p*(s*(d<1?2.7-d:1.7)),v=Math.sqrt(r*(h/f));u.push(v)}}l=u.length?Math.min.apply(Math,u):Math.sqrt(r*(n/(1.7*s)))}return l};var a0,o0,s0=function(t,e){for(var i,n=1/0,r=-1/0,a=e.length,o=0;o<a;++o)(i=Pt(t(e[o])))<n&&(n=i),i>r&&(r=i);return 1===e.length&&n===r&&(n-=1e4),[n,r]},l0=function(t){return t?"string"==typeof t||"number"==typeof t?function(){return t}:H(t)?t:function(e){return e[t.field]}:null},u0=function(t,e,i,n){if(!t.size||j(t.size[0])||j(t.size[1])||t.size[0]<=0||t.size[1]<=0)return Lt.getInstance().info("Wordcloud size dimensions must be greater than 0"),[];if(t.size=[Math.ceil(t.size[0]),Math.ceil(t.size[1])],t.shape||Zk("WordcloudShape shape must be specified."),t.text||Zk("WordcloudShape text must be specified."),(null==n?void 0:n.emit)&&n.emit(W$.BEFORE_WORDCLOUD_SHAPE_LAYOUT),!e||0===e.length)return[];var r=new e0(t,n);return r.layout(e),r.unfinished()?{progressive:r}:r.output()},c0=function(){xj.registerTransform("wordcloudShape",{transform:u0,markPhase:"beforeJoin"},!0)},h0=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.wordCloud,i}return S(i,e),i.type=t.SeriesTypeEnum.wordCloud,i}(b$),d0=function(){G$(),dJ(),kz.registerAnimation("wordCloud",(function(t,e){return{appear:k$(t,e),enter:{type:"fadeIn"},exit:{type:"fadeOut"},disappear:{type:"fadeOut"}}})),kz.registerSeries(h0.type,h0)},p0=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.wordCloud3d,i}return S(i,e),i.prototype._wordCloudTransformOption=function(){var t;return A(A({},e.prototype._wordCloudTransformOption.call(this)),{postProjection:null!==(t=this._spec.postProjection)&&void 0!==t?t:"StereographicProjection",depth_3d:this._spec.depth_3d})},i.prototype._wordCloudShapeTransformOption=function(){var t;return A(A({},e.prototype._wordCloudShapeTransformOption.call(this)),{postProjection:null!==(t=this._spec.postProjection)&&void 0!==t?t:"StereographicProjection",depth_3d:this._spec.depth_3d})},i.prototype.initMark=function(){this._wordMark=this._createMark(b$.mark.word,{groupKey:this._seriesField,isSeriesMark:!0},{support3d:!0})},i.prototype.initMarkStyle=function(){e.prototype.initMarkStyle.call(this);var t=this._wordMark;t&&this.setMarkStyle(t,{z:function(t){var e;return null!==(e=t.z)&&void 0!==e?e:0}},"normal",CU.Series)},i.prototype.initAnimation=function(){var t,e,i=this,n=null!==(t=this._padding)&&void 0!==t?t:{};this._wordMark&&this._wordMark.setAnimationConfig(cX(null===(e=kz.getAnimationInKey("wordCloud3d"))||void 0===e?void 0:e((function(){var t,e=i.getCompiler().getVGrammarView(),r=e.width()-n.left||0-n.right||0,a=e.height()-n.top||0-n.bottom||0,o=Math.max(r,a)/2;return{center:{x:o,y:o,z:null!==(t=i._spec.depth_3d)&&void 0!==t?t:o},r:o}})),hX("word",this._spec,this._markAttributeContext)))},i.type=t.SeriesTypeEnum.wordCloud3d,i}(b$),f0=function(){G$(),dJ(),kz.registerAnimation("wordCloud3d",(function(t){return{enter:x$(t)}})),kz.registerSeries(p0.type,p0)},v0=function(t,e){var i,n,r=t.map((function(t){return A({},t)}));if(!r||0===r.length)return r;var a=e.valueField,o=e.asTransformRatio,s=e.asReachRatio,l=e.asHeightRatio,u=e.asValueRatio,c=e.asNextValueRatio,h=e.asLastValueRatio,d=e.asLastValue,p=e.asCurrentValue,f=e.asNextValue,v=e.heightVisual,g=void 0!==v&&v,y=e.isCone,m=void 0===y||y,_=e.range,b=r.reduce((function(t,e){return Math.max(t,Number.parseFloat(e[a])||-1/0)}),-1/0),x=r.reduce((function(t,e){return Math.min(t,Number.parseFloat(e[a])||1/0)}),1/0),k=[null!==(i=null==_?void 0:_.min)&&void 0!==i?i:x,null!==(n=null==_?void 0:_.max)&&void 0!==n?n:b];return r.forEach((function(t,e){var i,n,v=Number.parseFloat(t[a]),y=Number.parseFloat(null===(i=r[e-1])||void 0===i?void 0:i[a]),_=Number.parseFloat(null===(n=r[e+1])||void 0===n?void 0:n[a]),b=Q(_*v)&&0!==v?_/v:0,x=Q(v*y)&&0!==y?v/y:0;d&&(t[d]=y),f&&(t[f]=_),o&&(t[o]=b),s&&(t[s]=0===e?1:x),l&&(t[l]=!0===g?b:1/r.length),u&&(t[u]=v/k[1]),c&&(t[c]=e===r.length-1?m?0:t[u]:_/k[1]),h&&(t[h]=0===e?1:y/k[1]),p&&(t[p]=v)})),r},g0=function(t,e){var i,n,r=null===(n=null===(i=t[0])||void 0===i?void 0:i.latestData)||void 0===n?void 0:n.map((function(t){return A({},t)}));return r&&0!==r.length?(r.shift(),r.forEach((function(t){t[e.asIsTransformLevel]=!0})),r):r},y0="".concat(BF,"_FUNNEL_TRANSFORM_RATIO"),m0="".concat(BF,"_FUNNEL_REACH_RATIO"),_0="".concat(BF,"_FUNNEL_HEIGHT_RATIO"),b0="".concat(BF,"_FUNNEL_VALUE_RATIO"),x0="".concat(BF,"_FUNNEL_LAST_VALUE_RATIO"),k0="".concat(BF,"_FUNNEL_NEXT_VALUE_RATIO"),S0="".concat(BF,"_FUNNEL_LAST_VALUE"),A0="".concat(BF,"_FUNNEL_CURRENT_VALUE"),M0="".concat(BF,"_FUNNEL_NEXT_VALUE"),w0="".concat(BF,"_FUNNEL_TRANSFORM_LEVEL"),T0=function(t){function e(e){var i,n,r=this;return(r=t.call(this,e)||this).dimensionTooltipTitleCallback=function(t,e){var i,n,a,o=r.series;return"transform"===(null===(i=null==e?void 0:e.mark)||void 0===i?void 0:i.name)?r._transformRatioText:null!==(n=r._getDimensionData(t))&&void 0!==n?n:null===(a=t.properties)||void 0===a?void 0:a["".concat(o.getCategoryField())]},r.markTooltipValueCallback=function(t,e){var i;if("transform"===(null===(i=null==e?void 0:e.mark)||void 0===i?void 0:i.name)){var n=null==t?void 0:t[m0];return"".concat((100*n).toFixed(1),"%")}return r._getMeasureData(t)},r.markTooltipKeyCallback=function(t,e){var i;if("transform"===(null===(i=null==e?void 0:e.mark)||void 0===i?void 0:i.name))return r._transformRatioText;var n=r._seriesCacheInfo,a=n.dimensionFields,o=n.seriesFields,s=a[a.length-1];return N(o[0])?null==t?void 0:t[o[0]]:null==t?void 0:t[s]},r._transformRatioText=null!==(n=null===(i=e.getSpec())||void 0===i?void 0:i.transformRatioText)&&void 0!==n?n:"转化率",r}return S(e,t),e}(PY),C0=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._getDefaultStyle=function(){return A(A({},t.prototype._getDefaultStyle.call(this)),{points:[]})},e}(aY),E0=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return S(e,t),e.prototype._getDefaultStyle=function(){return A(A({},t.prototype._getDefaultStyle.call(this)),{lineWidth:0})},e.type="polygon",e}(C0),P0=function(){kz.registerMark(E0.type,E0),CP(),mP(),xj.registerGraphic(MH.polygon,My),lX()},R0=A(A({},WY),((a0={}).funnel={name:"funnel",type:"polygon"},a0.transform={name:"transform",type:"polygon"},a0.transformLabel={name:"transformLabel",type:"text"},a0.outerLabel={name:"outerLabel",type:"text"},a0.outerLabelLine={name:"outerLabelLine",type:"rule"},a0)),B0=A(A({},WY),((o0={}).funnel3d={name:"funnel3d",type:"pyramid3d"},o0.transform3d={name:"transform3d",type:"pyramid3d"},o0.transformLabel={name:"transformLabel",type:"text"},o0.outerLabel={name:"outerLabel",type:"text"},o0.outerLabelLine={name:"outerLabelLine",type:"rule"},o0)),I0=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"funnel"),t.isTransform&&this._addMarkLabelSpec(t,"transform","transformLabel")},e}(mX),L0=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.funnel,i._funnelMarkName="funnel",i._funnelMarkType="polygon",i._transformMarkName="transform",i._transformMarkType="polygon",i.transformerConstructor=I0,i._funnelMark=null,i._funnelTransformMark=null,i._labelMark=null,i._transformLabelMark=null,i._funnelOuterLabelMark={},i}return S(i,e),i.prototype.getCategoryField=function(){return this._categoryField},i.prototype.setCategoryField=function(t){return this._categoryField=t,this._categoryField},i.prototype.getValueField=function(){return this._valueField},i.prototype.setValueField=function(t){return this._valueField=t,this._valueField},i.prototype.setAttrFromSpec=function(){var t,i,n,r,a;e.prototype.setAttrFromSpec.call(this),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this._funnelOrient=null!==(t=this._spec.funnelOrient)&&void 0!==t?t:"top",this._shape=null!==(i=this._spec.shape)&&void 0!==i?i:"trapezoid",this._minLabelLineWidth=null!==(a=null===(r=null===(n=this._spec.outerLabel)||void 0===n?void 0:n.line)||void 0===r?void 0:r.minLength)&&void 0!==a?a:20,this._isHorizontal()?this._funnelAlign=["top","bottom"].includes(this._spec.funnelAlign)?this._spec.funnelAlign:"center":this._funnelAlign=["left","right"].includes(this._spec.funnelAlign)?this._spec.funnelAlign:"center",!this._seriesField&&this._spec.categoryField&&this.setSeriesField(this._spec.categoryField)},i.prototype.initData=function(){if(e.prototype.initData.call(this),this._data){qG(this._dataSet,"funnel",v0),qG(this._dataSet,"funnelTransform",g0);var t=new Ms(this._dataSet,{name:"".concat(BF,"_series_").concat(this.id,"_viewDataTransform")});t.parse([this.getViewData()],{type:"dataview"}),this._viewDataTransform=new DY(this._option,t)}},i.prototype.compileData=function(){var t;e.prototype.compileData.call(this),null===(t=this._viewDataTransform)||void 0===t||t.compile()},i.prototype.getStatisticFields=function(){var t=[];return t.push({key:this._categoryField,operations:["values"]}),t.push({key:this._valueField,operations:["max","min"]}),t},i.prototype._statisticViewData=function(){var t,i,n,r,a,o,s,l,u;e.prototype._statisticViewData.call(this),this._data.getDataView().transform({type:"funnel",options:{valueField:this.getValueField(),isCone:this._spec.isCone,asCurrentValue:A0,asTransformRatio:y0,asReachRatio:m0,asHeightRatio:_0,asValueRatio:b0,asNextValueRatio:k0,asLastValueRatio:x0,asLastValue:S0,asNextValue:M0,range:{min:null!==(i=null===(t=this._spec.range)||void 0===t?void 0:t.min)&&void 0!==i?i:null===(r=null===(n=this.getViewDataStatistics().latestData)||void 0===n?void 0:n[this.getValueField()])||void 0===r?void 0:r.min,max:null!==(o=null===(a=this._spec.range)||void 0===a?void 0:a.max)&&void 0!==o?o:null===(l=null===(s=this.getViewDataStatistics().latestData)||void 0===s?void 0:s[this.getValueField()])||void 0===l?void 0:l.max}}}),null===(u=this._viewDataTransform.getDataView())||void 0===u||u.transform({type:"funnelTransform",options:{asIsTransformLevel:w0}})},i.prototype.initMark=function(){var t,e,n,r,a,o,s,l,u,c,h,d;if(this._funnelMark=this._createMark(A(A({},i.mark.funnel),{name:this._funnelMarkName,type:this._funnelMarkType}),{themeSpec:null===(t=this._theme)||void 0===t?void 0:t.funnel,groupKey:this._seriesField,isSeriesMark:!0,stateSort:null===(e=this._spec.funnel)||void 0===e?void 0:e.stateSort,noSeparateStyle:!0},{setCustomizedShape:null===(n=this._spec.funnel)||void 0===n?void 0:n.customShape,morph:fX(this._spec,this._funnelMarkName),morphElementKey:this._seriesField}),this._spec.isTransform&&(this._funnelTransformMark=this._createMark(A(A({},i.mark.transform),{name:this._transformMarkName,type:this._transformMarkType}),{themeSpec:null===(r=this._theme)||void 0===r?void 0:r.transform,skipBeforeLayouted:!0,dataView:this._viewDataTransform.getDataView(),dataProductId:this._viewDataTransform.getProductId(),stateSort:null===(a=this._spec.transform)||void 0===a?void 0:a.stateSort,noSeparateStyle:!0},{setCustomizedShape:null===(o=this._spec.transform)||void 0===o?void 0:o.customShape})),null===(l=null===(s=this._spec)||void 0===s?void 0:s.outerLabel)||void 0===l?void 0:l.visible){var p=(null!==(u=this._spec.outerLabel)&&void 0!==u?u:{}).line,f=(null!==(h=null===(c=this._theme)||void 0===c?void 0:c.outerLabel)&&void 0!==h?h:{}).line;this._funnelOuterLabelMark.label=this._createMark(i.mark.outerLabel,{themeSpec:null===(d=this._theme)||void 0===d?void 0:d.outerLabel,markSpec:this._spec.outerLabel,skipBeforeLayouted:!0,noSeparateStyle:!0}),this._funnelOuterLabelMark.line=this._createMark(i.mark.outerLabelLine,{themeSpec:f,markSpec:p,depend:[this._funnelOuterLabelMark.label],noSeparateStyle:!0})}},i.prototype.initTooltip=function(){this._tooltipHelper=new T0(this),this._funnelMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._funnelMark),this._funnelTransformMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._funnelTransformMark)},i.prototype.getDimensionField=function(){return this._seriesField?[this._seriesField]:[]},i.prototype.getMeasureField=function(){return[this._valueField]},i.prototype.getGroupFields=function(){return null},i.prototype.initMarkStyle=function(){var t=this,e=this._funnelMark;e&&this.setMarkStyle(e,{points:function(e){return t.getPoints(e)},visible:function(e){return N(e[t._valueField])},fill:this.getColorAttribute()},"normal",CU.Series);var i=this._funnelTransformMark;i&&this.setMarkStyle(i,{points:function(e){return t.getPoints(e)}},"normal",CU.Series);var n=this._funnelOuterLabelMark.label;n&&(this.setMarkStyle(n,{text:function(e){return"".concat(e[t.getCategoryField()])},x:function(e){return t._computeOuterLabelPosition(e).x},y:function(e){return t._computeOuterLabelPosition(e).y},textAlign:function(e){return t._computeOuterLabelPosition(e).align},textBaseline:function(e){return t._computeOuterLabelPosition(e).textBaseline},maxLineWidth:function(e){return t._computeOuterLabelLimit(e)},width:0,height:0},"normal",CU.Series),H(this._spec.outerLabel.formatMethod)&&this.setMarkStyle(n,{text:function(e){return t._spec.outerLabel.formatMethod("".concat(e[t.getCategoryField()]),e)}},"normal",CU.User_Mark));var r=this._funnelOuterLabelMark.line;r&&n&&this.setMarkStyle(r,{x:function(e){return t._computeOuterLabelLinePosition(e).x1},y:function(e){return t._computeOuterLabelLinePosition(e).y1},x1:function(e){return t._computeOuterLabelLinePosition(e).x2},y1:function(e){return t._computeOuterLabelLinePosition(e).y2}},"normal",CU.Series)},i.prototype.initLabelMarkStyle=function(t){var e,i,n,r=this;if(t){var a=t.getTarget(),o=t.getComponent();a===this._funnelMark?(this._labelMark=t,this.setMarkStyle(t,{text:function(t){return"".concat(t[r.getCategoryField()]," ").concat(t[r.getValueField()])},x:function(t){return r._computeLabelPosition(t).x},y:function(t){return r._computeLabelPosition(t).y},maxLineWidth:function(t){return r._computeLabelLimit(t,r._spec.label)},stroke:this.getColorAttribute()},"normal",CU.Series),(null===(i=this._funnelOuterLabelMark)||void 0===i?void 0:i.label)&&this._funnelOuterLabelMark.label.setDepend(o),(null===(n=this._funnelOuterLabelMark)||void 0===n?void 0:n.line)&&(e=this._funnelOuterLabelMark.line).setDepend.apply(e,P([],E(this._funnelOuterLabelMark.line.getDepend()),!1))):this._funnelTransformMark&&a===this._funnelTransformMark&&(this._transformLabelMark=t,this.setMarkStyle(t,{text:function(t){var e=$O(m0).bind(r)(t);return"".concat((100*e).toFixed(1),"%")},x:function(t){return r._computeLabelPosition(t).x},y:function(t){return r._computeLabelPosition(t).y},maxLineWidth:function(t){return r._computeLabelLimit(t,r._spec.transformLabel)}},"normal",CU.Series))}},i.prototype.initAnimation=function(){var t,e,i,n,r,a,o,s=this,l=null!==(i=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset)&&void 0!==i?i:"clipIn";"clipIn"===l&&this._rootMark&&this._rootMark.setAnimationConfig(cX(null===(n=kz.getAnimationInKey("cartesianGroupClip"))||void 0===n?void 0:n({direction:function(){return s._isHorizontal()?"x":"y"},width:function(){var t=s.getRootMark().getProduct();if(t){var e=t.getBounds(),i=e.x1,n=e.x2;return Math.max(i,n)}return s.getLayoutRect().width},height:function(){var t=s.getRootMark().getProduct();if(t){var e=t.getBounds(),i=e.y1,n=e.y2;return Math.max(i,n)}return s.getLayoutRect().height},orient:function(){return s._isReverse()?"negative":"positive"}},l),hX("group",this._spec,this._markAttributeContext))),[null===(r=this._funnelOuterLabelMark)||void 0===r?void 0:r.label].forEach((function(t){t&&t.setAnimationConfig(cX(kz.getAnimationInKey("fadeInOut")(),hX(t.name,s._spec,s._markAttributeContext)))})),[this._funnelMark,this._funnelTransformMark].forEach((function(t){t&&t.setAnimationConfig(cX(kz.getAnimationInKey("funnel")({},l),hX(t.name,s._spec,s._markAttributeContext)))})),(null===(a=this._funnelOuterLabelMark)||void 0===a?void 0:a.line)&&this._funnelOuterLabelMark.line.setAnimationConfig(cX(null===(o=kz.getAnimationInKey("fadeInOut"))||void 0===o?void 0:o(),hX("outerLabelLine",this._spec,this._markAttributeContext)))},i.prototype.initGroups=function(){},i.prototype.getStackGroupFields=function(){return[]},i.prototype.getStackValueField=function(){return null},i.prototype.initEvent=function(){var t,i=this;e.prototype.initEvent.call(this),null===(t=this._viewDataTransform.getDataView())||void 0===t||t.target.addListener("change",(function(t){i._viewDataTransform.updateData()}))},i.prototype.getPoints=function(t){var e,i,n=this.isTransformLevel(t),r=this._getMainAxisLength(n)/2;n?(e="rect"===this._shape?this._getSecondaryAxisLength(t[x0])/2:this._getSecondaryAxisLength(t[b0])/2,i=this._getSecondaryAxisLength(t[b0])/2):(e=this._getSecondaryAxisLength(t[b0])/2,i="rect"===this._shape?e:this._getSecondaryAxisLength(t[k0])/2);var a=this._getPositionByData(t),o=a.x,s=a.y,l=this._getPolygonPoints([o,s],e,i,e,i,r);return"center"!==this._funnelAlign&&this._adjustPoints(l),l},i.prototype.isTransformLevel=function(t){return!!(null==t?void 0:t[w0])},i.prototype._buildMarkAttributeContext=function(){e.prototype._buildMarkAttributeContext.call(this),this._markAttributeContext.valueToPosition=this.valueToPosition.bind(this),this._markAttributeContext.getPoints=this.getPoints.bind(this),this._markAttributeContext.isTransformLevel=this.isTransformLevel.bind(this)},i.prototype.valueToPosition=function(t){var e,i,n,r=this,a=null===(n=null===(i=null===(e=this.getViewData())||void 0===e?void 0:e.latestData)||void 0===i?void 0:i.find)||void 0===n?void 0:n.call(i,(function(e){return e[r._categoryField]===t}));return N(a)?this._getPolygonCenter(this.getPoints(a)):null},i.prototype.dataToPosition=function(t,e){return e&&!this.isDatumInViewData(t)?null:this.valueToPosition(t[this._categoryField])},i.prototype.dataToPositionX=function(t){var e;return null===(e=this.dataToPosition(t))||void 0===e?void 0:e.x},i.prototype.dataToPositionY=function(t){var e;return null===(e=this.dataToPosition(t))||void 0===e?void 0:e.y},i.prototype.dataToPositionZ=function(t){return 0},i.prototype._getMainAxisLength=function(t){var e;void 0===t&&(t=!1);var i=this.getViewData().latestData.length,n=this._isHorizontal()?this.getLayoutRect().width:this.getLayoutRect().height,r=!!this._spec.isTransform,a=r?0:null!==(e=this._spec.gap)&&void 0!==e?e:0,o=r?Math.max(0,i-1):0,s=this._spec.heightRatio||.5,l=(n-a*Math.max(0,i-1))/(i+s*o);return t?r?l*s:0:l},i.prototype._getSecondaryAxisLength=function(t){var e=Number.isNaN(t)||!Number.isFinite(t)?0:t,i=this._computeMaxSize(),n=this._computeMinSize();return n+(i-n)*e},i.prototype._getPositionByData=function(t){var e,i=this,n=null===(e=this.getViewData().latestData)||void 0===e?void 0:e.findIndex((function(e){return e[i._categoryField]===t[i._categoryField]&&e[Yz]===t[Yz]}));if(!N(n)||n<0)return{};var r=this.isTransformLevel(t),a=this._isHorizontal(),o=a?this.getLayoutRect().height:this.getLayoutRect().width,s=a?this.getLayoutRect().width:this.getLayoutRect().height,l=o/2,u=0,c=this._getMainAxisLength(),h=this._getMainAxisLength(!0);return u+=n*(c+h),u+=r?-h/2:c/2,!this._spec.isTransform&&this._spec.gap&&(u+=this._spec.gap*n),this._isReverse()&&(u=s-u),this._isHorizontal()?{x:u,y:l}:{x:l,y:u}},i.prototype._getPolygonPoints=function(t,e,i,n,r,a){var o=t[0],s=t[1];switch(this._funnelOrient){case"left":return[{x:o-a,y:s+e},{x:o-a,y:s-n},{x:o+a,y:s-r},{x:o+a,y:s+i}];case"right":return[{x:o+a,y:s-n},{x:o+a,y:s+n},{x:o-a,y:s+i},{x:o-a,y:s-i}];case"bottom":return[{x:o+e,y:s+a},{x:o-n,y:s+a},{x:o-r,y:s-a},{x:o+i,y:s-a}];default:return[{x:o-e,y:s-a},{x:o+n,y:s-a},{x:o+r,y:s+a},{x:o-i,y:s+a}]}},i.prototype._getPolygonCenter=function(t){if(this._isHorizontal()){var e=(t[0].x+t[3].x)/2,i=(t[0].y+t[3].y)/2;return{x:(e+(t[1].x+t[2].x)/2)/2,y:(i+(t[1].y+t[2].y)/2)/2}}var n=(t[0].x+t[3].x)/2,r=(t[0].y+t[3].y)/2;return{x:(n+(t[1].x+t[2].x)/2)/2,y:(r+(t[1].y+t[2].y)/2)/2}},i.prototype._adjustPoints=function(t){var e,i,n;return this._isHorizontal()?(n="y","left"===this._funnelOrient?(e="bottom"===this._funnelAlign?-t[1].y:t[1].y,i="bottom"===this._funnelAlign?-t[2].y:t[2].y):(e="bottom"===this._funnelAlign?-t[0].y:t[0].y,i="bottom"===this._funnelAlign?-t[3].y:t[3].y)):(n="x","top"===this._funnelOrient?(e="left"===this._funnelAlign?t[0].x:-t[0].x,i="left"===this._funnelAlign?t[3].x:-t[3].x):(e="left"===this._funnelAlign?t[1].x:-t[1].x,i="left"===this._funnelAlign?t[2].x:-t[2].x)),t[0][n]-=e,t[1][n]-=e,t[2][n]-=i,t[3][n]-=i,t},i.prototype._computeLabelPosition=function(t){var e=this.getPoints(t);return this._getPolygonCenter(e)},i.prototype._computeLabelLimit=function(t,e){var i=null==e?void 0:e.limit;if(Z(i))return i;var n=this.getPoints(t);return"shapeSize"===i?this._isHorizontal()?Math.abs(n[3].x-n[0].x):(Math.abs(n[0].x-n[1].x)+Math.abs(n[2].x-n[3].x))/2:this._isHorizontal()?Math.abs(n[3].x-n[0].x):void 0},i.prototype._computeOuterLabelPosition=function(t){var e,i,n,r,a,o=null===(i=this._spec.outerLabel)||void 0===i?void 0:i.position,s="center",l="middle";if(o=this._isHorizontal()?["top","bottom"].includes(o)?o:"bottom"===this._funnelAlign?"top":"bottom":["left","right"].includes(o)?o:"left"===this._funnelAlign?"right":"left",!1!==(null===(n=this._spec.outerLabel)||void 0===n?void 0:n.alignLabel))r=(e=this._getPositionByData(t)).x,a=e.y,"left"===o?(r=0,s="left"):"right"===o?(r=this.getLayoutRect().width,s="right"):"top"===o?(a=0,l="top"):"bottom"===o&&(a=this.getLayoutRect().height,l="bottom");else{var u=this._computeOuterLabelLinePosition(t);r=u.x2,a=u.y2,"left"===o?(r-=5,s="right"):"right"===o?(r+=5,s="left"):"top"===o?(a-=5,l="bottom"):"bottom"===o&&(a+=5,l="top")}return{x:r,y:a,align:s,textBaseline:l}},i.prototype._computeOuterLabelLimit=function(t){var e,i,n,r,a,o,s;if(this._isHorizontal())return this._getMainAxisLength(this.isTransformLevel(t));var l=this.getPoints(t),u=(Math.abs(l[0].x-l[1].x)+Math.abs(l[2].x-l[3].x))/2,c=this.getCategoryField(),h=null===(a=null===(r=null===(n=null===(i=null===(e=this._labelMark)||void 0===e?void 0:e.getComponent())||void 0===i?void 0:i.getProduct())||void 0===n?void 0:n.getGroupGraphicItem())||void 0===r?void 0:r.find((function(e){var i,n=e.attribute;return"text"===e.type&&(null===(i=n.data)||void 0===i?void 0:i[c])===t[c]}),!0))||void 0===a?void 0:a.AABBBounds,d=h?h.x2-h.x1:0,p=this._funnelOuterLabelMark.line?this._minLabelLineWidth:0,f=this.getLayoutRect().width-Math.max(u,d);return"center"===this._funnelAlign&&(f/=2),f-p-(null!==(s=null===(o=this._spec.outerLabel)||void 0===o?void 0:o.spaceWidth)&&void 0!==s?s:5)},i.prototype._computeOuterLabelLinePosition=function(t){var e,i,n,r,a,o,s,l,u,c,h,d,p,f,v,g,y,m=this.getCategoryField(),_=null===(a=null===(r=null===(n=null===(i=null===(e=this._funnelOuterLabelMark)||void 0===e?void 0:e.label)||void 0===i?void 0:i.getProduct())||void 0===n?void 0:n.elements)||void 0===r?void 0:r.find((function(e){var i;return(null===(i=e.data[0])||void 0===i?void 0:i[m])===t[m]})))||void 0===a?void 0:a.getBounds(),b=null===(c=null===(u=null===(l=null===(s=null===(o=this._labelMark)||void 0===o?void 0:o.getComponent())||void 0===s?void 0:s.getProduct())||void 0===l?void 0:l.getGroupGraphicItem())||void 0===u?void 0:u.find((function(e){var i,n=e.attribute;return"text"===e.type&&(null===(i=n.data)||void 0===i?void 0:i[m])===t[m]}),!0))||void 0===c?void 0:c.AABBBounds,x=null!==(h=this._spec.outerLabel)&&void 0!==h?h:{};if(this._isHorizontal()){var k=null!==(d=x.spaceWidth)&&void 0!==d?d:5,S=this.getPoints(t),A=(Math.abs(S[0].y-S[1].y)+Math.abs(S[2].y-S[3].y))/2;return"top"===this._spec.outerLabel.position||"bottom"===this._funnelAlign?(g=this._getPolygonCenter(S).y-A/2-k,y=!1!==x.alignLabel?(null==_?void 0:_.y2)+k:g-k,f=this._getPolygonCenter(S).x,g-y<this._minLabelLineWidth&&(y=g-this._minLabelLineWidth),v=f):(g=this._getPolygonCenter(S).y+A/2+k,y=!1!==x.alignLabel?(null==_?void 0:_.y1)-k:g+k,f=this._getPolygonCenter(S).x,y-g<this._minLabelLineWidth&&(y=g+this._minLabelLineWidth),v=f),{x1:f,x2:v,y1:g,y2:y}}var M=this.getPoints(t),w=(Math.abs(M[0].x-M[1].x)+Math.abs(M[2].x-M[3].x))/2,T=(null==b?void 0:b.x2)-(null==b?void 0:b.x1)||0,C=null!==(p=x.spaceWidth)&&void 0!==p?p:5;return"right"===this._spec.outerLabel.position||"left"===this._funnelAlign?(f=this._getPolygonCenter(M).x+Math.max(T/2,w/2)+C,v=!1!==x.alignLabel?(null==_?void 0:_.x1)-C:f+C,g=this._getPolygonCenter(M).y,v-f<this._minLabelLineWidth&&(v=f+this._minLabelLineWidth),y=g):(f=this._getPolygonCenter(M).x-Math.max(T/2,w/2)-C,v=!1!==x.alignLabel?(null==_?void 0:_.x2)+C:f-C,g=this._getPolygonCenter(M).y,f-v<this._minLabelLineWidth&&(v=f-this._minLabelLineWidth),y=g),{x1:f,x2:v,y1:g,y2:y}},i.prototype._computeMaxSize=function(){var t,e=this._isHorizontal()?this.getLayoutRect().height:this.getLayoutRect().width;return mF(null!==(t=this._spec.maxSize)&&void 0!==t?t:"80%",e)},i.prototype._computeMinSize=function(){var t,e=this._isHorizontal()?this.getLayoutRect().height:this.getLayoutRect().width;return mF(null!==(t=this._spec.minSize)&&void 0!==t?t:0,e)},i.prototype._isHorizontal=function(){return"left"===this._funnelOrient||"right"===this._funnelOrient},i.prototype._isReverse=function(){return"bottom"===this._funnelOrient||"right"===this._funnelOrient},i.prototype.getDefaultShapeType=function(){return"square"},i.prototype.getActiveMarks=function(){return[this._funnelMark]},i.type=t.SeriesTypeEnum.funnel,i.mark=R0,i.transformerConstructor=I0,i}(_X),D0=function(){P0(),dJ(),OZ(),kz.registerSeries(L0.type,L0),kz.registerAnimation("funnel",(function(t,e){return A({appear:"clipIn"===e?void 0:{type:"fadeIn"}},tX)})),kz.registerAnimation("cartesianGroupClip",(function(t){return{appear:{custom:xd,customParameters:function(e,i){return{animationType:"in",group:i.getGraphicItem(),direction:t.direction(),width:t.width(),height:t.height(),orient:t.orient()}}},disappear:{custom:xd,customParameters:function(e,i){return{animationType:"out",group:i.getGraphicItem(),direction:t.direction(),width:t.width(),height:t.height(),orient:t.orient()}}}}})),iX()},O0=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return S(e,t),e.type="pyramid3d",e}(C0),F0=function(){kz.registerMark(O0.type,O0),CP(),bP(),xj.registerGraphic(MH.pyramid3d,Ty),lX()},z0=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"funnel3d"),t.isTransform&&this._addMarkLabelSpec(t,"transform3d","transformLabel")},e}(I0),H0=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.funnel3d,i._funnelMarkName="funnel3d",i._funnelMarkType="pyramid3d",i._transformMarkName="transform3d",i._transformMarkType="pyramid3d",i.transformerConstructor=z0,i}return S(i,e),i.prototype.initMark=function(){var t,e,n,r,a,o,s,l;if(this._funnelMark=this._createMark(A(A({},i.mark.funnel3d),{name:this._funnelMarkName,type:this._funnelMarkType}),{themeSpec:null===(t=this._theme)||void 0===t?void 0:t.funnel3d,key:this._seriesField,isSeriesMark:!0},{support3d:!0}),this._spec.isTransform&&(this._funnelTransformMark=this._createMark(A(A({},i.mark.transform3d),{name:this._transformMarkName,type:this._transformMarkType}),{themeSpec:null===(e=this._theme)||void 0===e?void 0:e.transform3d,key:this._seriesField,skipBeforeLayouted:!1,dataView:this._viewDataTransform.getDataView(),dataProductId:this._viewDataTransform.getProductId()})),null===(r=null===(n=this._spec)||void 0===n?void 0:n.outerLabel)||void 0===r?void 0:r.visible){var u=(null!==(a=this._spec.outerLabel)&&void 0!==a?a:{}).line,c=(null!==(s=null===(o=this._theme)||void 0===o?void 0:o.outerLabel)&&void 0!==s?s:{}).line;this._funnelOuterLabelMark.label=this._createMark(i.mark.outerLabel,{themeSpec:null===(l=this._theme)||void 0===l?void 0:l.outerLabel,key:this._seriesField,markSpec:this._spec.outerLabel}),this._funnelOuterLabelMark.line=this._createMark(i.mark.outerLabelLine,{themeSpec:c,key:this._seriesField,markSpec:u,depend:[this._funnelOuterLabelMark.label]})}},i.prototype.initMarkStyle=function(){var t=this;e.prototype.initMarkStyle.call(this);var i=this._funnelMark;i&&this.setMarkStyle(i,{z:function(e){if(t._isHorizontal())return 0;var i=t.getPoints(e),n=Math.max(Math.abs(i[0].x-i[1].x),Math.abs(i[2].x-i[3].x));return(t._computeMaxSize()-n)/2}},"normal",CU.Series)},i.prototype.initLabelMarkStyle=function(t){var i,n,r,a=this;e.prototype.initLabelMarkStyle.call(this,t),this.setMarkStyle(t,{z:function(t){if(a._isHorizontal())return 0;var e=a.getPoints(t),i=Math.max(Math.abs(e[0].x-e[1].x),Math.abs(e[2].x-e[3].x));return(a._computeMaxSize()-i)/2}},"normal",CU.Series),this._labelMark=t,(null===(n=this._funnelOuterLabelMark)||void 0===n?void 0:n.label)&&this._funnelOuterLabelMark.label.setDepend(t.getComponent()),(null===(r=this._funnelOuterLabelMark)||void 0===r?void 0:r.line)&&(i=this._funnelOuterLabelMark.line).setDepend.apply(i,P([],E(this._funnelOuterLabelMark.line.getDepend()),!1))},i.type=t.SeriesTypeEnum.funnel3d,i.mark=B0,i.transformerConstructor=z0,i}(L0),j0=function(){F0(),dJ(),OZ(),kz.registerSeries(H0.type,H0)},N0=function(t,e){var i=(t-e[0])/(e[1]-e[0]||1);return Math.max(0,Math.min(1,i))},V0=function(t){var e=t.mark.elements.filter((function(t){return t.diffState===AH.update})),i=At(e.map((function(t){var e;return null===(e=null==t?void 0:t.data)||void 0===e?void 0:e[0].depth})));return e.filter((function(t){var e;return(null===(e=null==t?void 0:t.data)||void 0===e?void 0:e[0].depth)===i}))},W0=function(t,e,i){if(ot(t))return[e,i];var n=At(t.map((function(t){return 1*t.getGraphicAttribute("startAngle",!1)}))),r=St(t.map((function(t){return 1*t.getGraphicAttribute("endAngle",!1)})));return[n,r]},G0=function(t){return{channel:{startAngle:{from:function(e,i){var n=t.animationInfo(),r=n.startAngle,a=n.endAngle,o=V0(i),s=W0(o,r,a);return N0(e.startAngle,s)*(a-r)+r},to:function(t){return t.startAngle}},endAngle:{from:function(e,i){var n=t.animationInfo(),r=n.startAngle,a=n.endAngle,o=V0(i),s=W0(o,r,a);return N0(e.endAngle,s)*(a-r)+r},to:function(t){return t.endAngle}},outerRadius:{from:function(t){return t.innerRadius},to:function(t){return t.outerRadius}},innerRadius:{from:function(t){return t.innerRadius},to:function(t){return t.innerRadius}}}}},U0=function(t){var e=At(t.map((function(t){return 1*t.getGraphicAttribute("startAngle",!1)}))),i=St(t.map((function(t){return 1*t.getGraphicAttribute("endAngle",!1)})));return[e,i]},Y0=function(t){return{channel:{startAngle:{from:function(t,e){return e.getGraphicAttribute("startAngle",!1)},to:function(e,i){var n=t.animationInfo(),r=n.startAngle,a=n.endAngle,o=V0(i),s=U0(o);return N0(i.getGraphicAttribute("startAngle",!1),s)*(a-r)+r}},endAngle:{from:function(t,e){return e.getGraphicAttribute("endAngle",!1)},to:function(e,i){var n=t.animationInfo(),r=n.startAngle,a=n.endAngle,o=V0(i),s=U0(o);return N0(i.getGraphicAttribute("endAngle",!1),s)*(a-r)+r}},outerRadius:{from:function(t,e){return e.getGraphicAttribute("outerRadius",!1)},to:function(){return t.animationInfo().innerRadius}},innerRadius:{from:function(t,e){return e.getGraphicAttribute("innerRadius",!1)},to:function(){return t.animationInfo().innerRadius}}}}},X0=function(t,e){switch(e){case"fadeIn":return{type:"fadeIn"};case"growAngle":return{type:"growAngleIn"};default:return{type:"growRadiusIn"}}},K0=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0,n=(null==i?void 0:i.maxDepth)>=0;return t.forEach((function(t){(!n||t.depth<=i.maxDepth)&&(e.push((null==i?void 0:i.callback)?i.callback(t):t),t.children&&(n&&t.depth===i.maxDepth?(t.children=null,t.isLeaf=!0):K0(t.children,e,i)))})),e};function q0(t,e,i,n,r){for(var a,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{x0:"x0",x1:"x1",y0:"y0",y1:"y1"},s=t.children,l=-1,u=s.length,c=t.value&&(n-e)/t.value;++l<u;)(a=s[l])[o.y0]=i,a[o.y1]=r,a[o.x0]=e,a[o.x1]=e+=a.value*c}function Z0(t,e,i,n,r){for(var a,o=t.children,s=-1,l=o.length,u=t.value&&(r-i)/t.value;++s<l;)(a=o[s]).x0=e,a.x1=n,a.y0=i,i+=a.value*u,a.y1=i}var J0=function(t){return function(e,i,n,r,a){!function(t,e,i,n,r,a){for(var o,s,l,u,c,h,d,p,f,v,g,y=[],m=e.children,_=0,b=0,x=m.length,k=e.value;_<x;){l=r-i,u=a-n;do{c=m[b++].value}while(!c&&b<x);for(h=c,d=c,g=c*c*(v=Math.max(u/l,l/u)/(k*t)),f=Math.max(d/g,g/h);b<x;++b){if((s=m[b].value)<h&&(h=s),s>d&&(d=s),g=(c+=s)*c*v,(p=Math.max(d/g,g/h))>f){c-=s;break}f=p}o=Object.assign({},e,{value:c,children:m.slice(_,b)}),y.push(o),l<u?q0(o,i,n,r,k?n+=u*c/k:a):Z0(o,i,n,k?i+=l*c/k:r,a),k-=c,_=b}}(t,e,i,n,r,a)}},Q0=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,r=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"value",s=0,l=null!=n?n:-1,u=i;return t.forEach((function(t,n){var c,h,d={flattenIndex:++l,key:a?a(t):"".concat(null!==(c=null==r?void 0:r.key)&&void 0!==c?c:"","-").concat(n),maxDepth:-1,depth:i,index:n,value:t[o],isLeaf:!0,datum:r?r.datum.concat(t):[t],parentKey:null==r?void 0:r.key};if(null===(h=t.children)||void 0===h?void 0:h.length){d.children=[],d.isLeaf=!1;var p=Q0(t.children,d.children,i+1,l,d,a,o);d.value=j(t[o])?p.sum:Math.max(p.sum,ee(t[o])),l=p.flattenIndex,u=Math.max(p.maxDepth,u)}else d.isLeaf=!0,d.value=ee(t[o]);s+=Math.abs(d.value),e.push(d)})),{sum:s,maxDepth:u,flattenIndex:l}},$0=function(t,e,i,n){var r=n;return t.forEach((function(t,n){var a;r=e(t,n,i,r),(null===(a=t.children)||void 0===a?void 0:a.length)&&(r=$0(t.children,e,t,r))})),n},t1=function(t,e,i,n){var r=n;return t.forEach((function(t,n){var a;(null===(a=t.children)||void 0===a?void 0:a.length)&&(r=t1(t.children,e,t,r)),r=e(t,n,i,r)})),r},e1={binary:function(t,e,i,n,r){var a=t.children,o=a.length,s=0,l=new Array(o+1);l[0]=0;for(var u=0;u<o;++u)s+=a[u].value,l[u+1]=s;var c=function(t,e,i,n,r,o,s){if(t>=e-1){var u=a[t];return u.x0=n,u.y0=r,u.x1=o,void(u.y1=s)}for(var h=l[t],d=i/2+h,p=t+1,f=e-1;p<f;){var v=p+f>>>1;l[v]<d?p=v+1:f=v}d-l[p-1]<l[p]-d&&t+1<p&&--p;var g=l[p]-h,y=i-g;if(o-n>s-r){var m=i?(n*y+o*g)/i:o;c(t,p,g,n,r,m,s),c(p,e,y,m,r,o,s)}else{var _=i?(r*y+s*g)/i:s;c(t,p,g,n,r,o,_),c(p,e,y,n,_,o,s)}};c(0,o,t.value,e,i,n,r)},dice:q0,slice:Z0,sliceDice:function(t,e,i,n,r){(t.depth%2==1?Z0:q0)(t,e,i,n,r)}},i1=function(){return o((function t(e){var i,n=this;r(this,t),this._filterByArea=function(t,e){var i,r=n._getMinAreaByDepth(t.depth);if(r>0&&t.value*e<r)return!1;if(null===(i=t.children)||void 0===i?void 0:i.length){var a=t.children.filter((function(t){return n._filterByArea(t,e)}));a.length?a.length!==t.children.length&&(t.children=a):(t.isLeaf=!0,t.children=null)}return!0},this._getMinAreaByDepth=function(t){var e;return t<0?0:null!==(e=X(n.options.minVisibleArea)?n.options.minVisibleArea[t]:n.options.minVisibleArea)&&void 0!==e?e:0},this._getGapWidthByDepth=function(t){var e;return t<0?0:null!==(e=X(n.options.gapWidth)?n.options.gapWidth[t]:n.options.gapWidth)&&void 0!==e?e:0},this._getPaddingByDepth=function(t){var e;return t<0?0:null!==(e=X(n.options.padding)?n.options.padding[t]:n.options.padding)&&void 0!==e?e:0},this._getLabelPaddingByDepth=function(t){var e;return t<0?0:null!==(e=X(n.options.labelPadding)?n.options.labelPadding[t]:n.options.labelPadding)&&void 0!==e?e:0},this._layoutNode=function(t){var e=n._getGapWidthByDepth(t.depth),i=t.x0,r=t.y0,a=t.x1,o=t.y1;if(t.maxDepth=n._maxDepth,e>0&&((i+=e/2)>(a-=e/2)&&(a=i=(i+a)/2),(r+=e/2)>(o-=e/2)&&(o=r=(r+o)/2),t.x0=i,t.x1=a,t.y0=r,t.y1=o),t.children){var s=n._getLabelPaddingByDepth(t.depth),l=n._getPaddingByDepth(t.depth);l>0&&l<Math.min(a-i,o-r)/2&&(r+=l,o-=l,i+=l,a-=l),s>0&&("top"===n.options.labelPosition&&r+s<o?(t.labelRect={x0:i,y0:r,x1:a,y1:r+s},r+=s):"bottom"===n.options.labelPosition&&o-s>r?(t.labelRect={x0:i,y0:o-s,x1:a,y1:o},o-=s):"left"===n.options.labelPosition&&i+s<a?(t.labelRect={x0:i,y0:r,x1:i+s,y1:o},i+=s):"right"===n.options.labelPosition&&a-s>i&&(t.labelRect={x0:a-s,y0:r,x1:a,y1:o},a-=s));var u=n._getGapWidthByDepth(t.depth+1);u>0&&(i-=u/2,a+=u/2,r-=u/2,o+=u/2),n._splitNode(t,i,r,a,o)}},this.options=Object.assign({},t.defaultOpionts,e);var a=this.options.nodeKey,o=H(a)?a:a?Qk(a):null;this._getNodeKey=o,this._splitNode="squarify"===this.options.splitType?J0(this.options.aspectRatio):null!==(i=e1[this.options.splitType])&&void 0!==i?i:e1.binary,this._maxDepth=-1}),[{key:"layout",value:function(t,e){var i;if(!t||!t.length)return[];var n="width"in e?{x0:0,x1:e.width,y0:0,y1:e.height,width:e.width,height:e.height}:{x0:Math.min(e.x0,e.x1),x1:Math.max(e.x0,e.x1),y0:Math.min(e.y0,e.y1),y1:Math.max(e.y0,e.y1),width:Math.abs(e.x1-e.x0),height:Math.abs(e.y1-e.y0)},r=[],a=Q0(t,r,0,-1,null,this._getNodeKey,this.options.valueField);if(this._maxDepth=a.maxDepth,a.sum<=0)return[];var o={flattenIndex:-1,maxDepth:-1,key:"-1",depth:-1,index:-1,value:a.sum,datum:null,x0:n.x0,x1:n.x1,y0:n.y0,y1:n.y1,children:r},s=n.width*n.height/a.sum;return this._filterByArea(o,s),this._layout(o),null!==(i=o.children)&&void 0!==i?i:[]}},{key:"_filterChildren",value:function(t){var e=this.options.maxDepth;if(Z(e)&&e>=0&&t.depth>=e)return!1;var i=this.options.minChildrenVisibleArea;if(Z(i)&&Math.abs((t.x1-t.x0)*(t.y1-t.y0))<i)return!1;var n=this.options.minChildrenVisibleSize;return!Z(n)||!(Math.abs(t.x1-t.x0)<n||Math.abs(t.y1-t.y0)<n)}},{key:"_layout",value:function(t){var e,i=this;this._filterChildren(t)||(t.children=null,t.isLeaf=!0),this._layoutNode(t),(null===(e=t.children)||void 0===e?void 0:e.length)&&t.children.forEach((function(t){var e;(null===(e=null==t?void 0:t.children)||void 0===e?void 0:e.length)?i._layout(t):i._layoutNode(t)}))}}])}();i1.defaultOpionts={aspectRatio:(1+Math.sqrt(5))/2,gapWidth:0,labelPadding:0,labelPosition:"top",splitType:"binary",minVisibleArea:10};var n1=function(t,e){var i=new i1(t).layout(e,"width"in t?{width:t.width,height:t.height}:{x0:t.x0,x1:t.x1,y0:t.y0,y1:t.y1});if(t.flatten){var n=[];return K0(i,n,{maxDepth:null==t?void 0:t.maxDepth}),n}return i},r1={x0:"startAngle",x1:"endAngle",y0:"innerRadius",y1:"outerRadius"},a1=function(){return o((function t(e){var i=this;r(this,t),this._layoutNode=function(t){if(t.maxDepth=i._maxDepth,t.children){var e=i._parsedInnerRadius[t.depth+1],n=i._parsedOutterRadius[t.depth+1];q0(t,t.startAngle,Math.min(e,n),t.endAngle,Math.max(e,n),r1);var r=X(i.options.label)?i.options.label[t.depth+1]:i.options.label;t.children.forEach((function(t){if(t.x=i._parsedCenter[0],t.y=i._parsedCenter[1],r)return i._layoutLabel(t,z(r)?{align:"center",rotate:"radial"}:r)}))}},this.options=e?Object.assign({},t.defaultOpionts,e):Object.assign({},t.defaultOpionts);var n=this.options.nodeKey,a=H(n)?n:n?Qk(n):null;this._getNodeKey=a,this._maxDepth=-1}),[{key:"_parseRadius",value:function(t,e){var i=this,n=t.x0+tS(this.options.center[0],t.width),r=t.y0+tS(this.options.center[1],t.height),a=Math.min(t.width/2,t.height/2),o=this.options.innerRadius,s=this.options.outerRadius,l=X(o),u=l?o.map((function(t){return tS(t,a)})):tS(o,a),c=X(s),h=this.options.gapRadius,d=c?s.map((function(t){return tS(t,a)})):tS(s,a),p=Ct(0,e+1);if(l)this._parsedInnerRadius=p.map((function(t,e){var i=u[e];return j(i)?a:i})),this._parsedOutterRadius=p.map((function(t,n){var r,o;return c?null!==(r=d[n])&&void 0!==r?r:a:n<e?i._parsedInnerRadius[n+1]-(X(h)?null!==(o=h[n])&&void 0!==o?o:0:h):d}));else if(c)this._parsedOutterRadius=p.map((function(t,e){return j(d[e])?a:d[e]})),this._parsedInnerRadius=p.map((function(t,e){var n;return 0===e?u:i._parsedOutterRadius[e-1]-(X(h)?null!==(n=h[e])&&void 0!==n?n:0:h)}));else{var f=tS(o,a),v=(d-f)/(e+1);this._parsedInnerRadius=p.map((function(t,e){return f+e*v})),this._parsedOutterRadius=p.map((function(t,e){var n;return i._parsedInnerRadius[e]+v-(X(h)?null!==(n=h[e])&&void 0!==n?n:0:h)}))}this._parsedCenter=[n,r],this._maxRadius=a}},{key:"layout",value:function(t,e){var i="width"in e?{x0:0,x1:e.width,y0:0,y1:e.height,width:e.width,height:e.height}:{x0:Math.min(e.x0,e.x1),x1:Math.max(e.x0,e.x1),y0:Math.min(e.y0,e.y1),y1:Math.max(e.y0,e.y1),width:Math.abs(e.x1-e.x0),height:Math.abs(e.y1-e.y0)};if(!t||!t.length)return[];var n=[],r=Q0(t,n,0,-1,null,this._getNodeKey);return this._parseRadius(i,r.maxDepth),this._maxDepth=r.maxDepth,this._layout(n,{flattenIndex:-1,maxDepth:-1,key:"-1",depth:-1,index:-1,value:r.sum,datum:null,children:n,startAngle:this.options.startAngle,endAngle:this.options.endAngle}),n}},{key:"_layout",value:function(t,e){var i=this;this._layoutNode(e),t.forEach((function(t){var e;(null===(e=null==t?void 0:t.children)||void 0===e?void 0:e.length)?i._layout(t.children,t):i._layoutNode(t)}))}},{key:"_layoutLabel",value:function(t,e){var i,n=(t.startAngle+t.endAngle)/2,r=("start"===e.align?t.innerRadius:"end"===e.align?t.outerRadius:(t.innerRadius+t.outerRadius)/2)+(null!==(i=e.offset)&&void 0!==i?i:0),a=Pe({x:this._parsedCenter[0],y:this._parsedCenter[1]},r,n);if(t.label={x:a.x,y:a.y,textBaseline:"middle"},"tangential"===e.rotate)t.label.angle=n-Math.PI/2,t.label.textAlign="center",t.label.maxLineWidth=Math.abs(t.endAngle-t.startAngle)*r;else{var o=n%(2*Math.PI),s=o<0?o+2*Math.PI:o;s>Math.PI/2&&s<1.5*Math.PI?(t.label.angle=s+Math.PI,t.label.textAlign="start"===e.align?"end":"end"===e.align?"start":"center"):(t.label.angle=s,t.label.textAlign=e.align),t.label.maxLineWidth=t.isLeaf?void 0:Math.abs(t.outerRadius-t.innerRadius)}}}])}();a1.defaultOpionts={startAngle:Math.PI/2,endAngle:-3*Math.PI/2,center:["50%","50%"],gapRadius:0,innerRadius:0,outerRadius:"70%"};var o1=4294967296;function s1(t,e){var i,n;if(c1(e,t))return[e];for(i=0;i<t.length;++i)if(l1(e,t[i])&&c1(d1(t[i],e),t))return[t[i],e];for(i=0;i<t.length-1;++i)for(n=i+1;n<t.length;++n)if(l1(d1(t[i],t[n]),e)&&l1(d1(t[i],e),t[n])&&l1(d1(t[n],e),t[i])&&c1(p1(t[i],t[n],e),t))return[t[i],t[n],e];Lt.getInstance().error("error when packEncloseRandom")}function l1(t,e){var i=t.radius-e.radius,n=e.x-t.x,r=e.y-t.y;return i<0||i*i<n*n+r*r}function u1(t,e){var i=t.radius-e.radius+1e-9*Math.max(t.radius,e.radius,1),n=e.x-t.x,r=e.y-t.y;return i>0&&i*i>n*n+r*r}function c1(t,e){for(var i=0;i<e.length;++i)if(!u1(t,e[i]))return!1;return!0}function h1(t){switch(t.length){case 1:return function(t){return{x:t.x,y:t.y,radius:t.radius}}(t[0]);case 2:return d1(t[0],t[1]);case 3:return p1(t[0],t[1],t[2])}}function d1(t,e){var i=t.x,n=t.y,r=t.radius,a=e.x,o=e.y,s=e.radius,l=a-i,u=o-n,c=s-r,h=Math.sqrt(l*l+u*u);return{x:(i+a+l/h*c)/2,y:(n+o+u/h*c)/2,radius:(h+r+s)/2}}function p1(t,e,i){var n=t.x,r=t.y,a=t.radius,o=e.x,s=e.y,l=e.radius,u=i.x,c=i.y,h=i.radius,d=n-o,p=n-u,f=r-s,v=r-c,g=l-a,y=h-a,m=n*n+r*r-a*a,_=m-o*o-s*s+l*l,b=m-u*u-c*c+h*h,x=p*f-d*v,k=(f*b-v*_)/(2*x)-n,S=(v*g-f*y)/x,A=(p*_-d*b)/(2*x)-r,M=(d*y-p*g)/x,w=S*S+M*M-1,T=2*(a+k*S+A*M),C=k*k+A*A-a*a,E=-(Math.abs(w)>1e-6?(T+Math.sqrt(T*T-4*w*C))/(2*w):C/T);return{x:n+k+S*E,y:r+A+M*E,radius:E}}function f1(t,e,i){var n,r,a,o,s=t.x-e.x,l=t.y-e.y,u=s*s+l*l;u?(r=e.radius+i.radius,r*=r,o=t.radius+i.radius,r>(o*=o)?(n=(u+o-r)/(2*u),a=Math.sqrt(Math.max(0,o/u-n*n)),i.x=t.x-n*s-a*l,i.y=t.y-n*l+a*s):(n=(u+r-o)/(2*u),a=Math.sqrt(Math.max(0,r/u-n*n)),i.x=e.x+n*s-a*l,i.y=e.y+n*l+a*s)):(i.x=e.x+i.radius,i.y=e.y)}function v1(t,e){var i=t.radius+e.radius-1e-6,n=e.x-t.x,r=e.y-t.y;return i>0&&i*i>n*n+r*r}function g1(t){var e=t._,i=t.next._,n=e.radius+i.radius,r=(e.x*i.radius+i.x*e.radius)/n,a=(e.y*i.radius+i.y*e.radius)/n;return r*r+a*a}function y1(t){return{_:t,next:null,prev:null}}function m1(t,e){var i=(t=xt(t)).length;if(!i)return 0;var n=t[0];if(n.x=0,n.y=0,1===i)return n.radius;var r=t[1];if(n.x=-r.radius,r.x=n.radius,r.y=0,2===i)return n.radius+r.radius;var a=t[2];f1(r,n,a);var o,s,l,u,c,h,d,p=y1(n),f=y1(r),v=y1(a);p.next=f,v.prev=f,f.next=v,p.prev=v,v.next=p,f.prev=p;for(var g=3;g<i;++g){d=!1,a=t[g],f1(p._,f._,a),v=y1(a),o=f.next,s=p.prev,l=f._.radius,u=p._.radius;do{if(l<=u){if(v1(o._,v._)){f=o,p.next=f,f.prev=p,--g,d=!0;break}l+=o._.radius,o=o.next}else{if(v1(s._,v._)){(p=s).next=f,f.prev=p,--g,d=!0;break}u+=s._.radius,s=s.prev}}while(o!==s.next);if(!d){for(v.prev=p,v.next=f,p.next=f.prev=f=v,c=g1(p),v=v.next;v!==f;)(h=g1(v))<c&&(p=v,c=h),v=v.next;f=p.next}}var y=[f._];for(v=f.next;v!==f;)y.push(v._),v=v.next;a=function(t,e){for(var i,n,r=0,a=wt(Array.from(t),e),o=a.length,s=[];r<o;)i=a[r],n&&u1(n,i)?++r:(n=h1(s=s1(s,i)),r=0);return n}(y,e);for(var m=0;m<i;++m)(n=t[m]).x-=a.x,n.y-=a.y;return a.radius}function _1(t){return function(e){e.children||(e.radius=Math.max(0,+t(e)||0))}}function b1(t,e,i){return function(n){var r=null==n?void 0:n.children;if(r){var a,o=r.length,s=t(n)*e||0;if(s)for(a=0;a<o;++a)r[a].radius+=s;var l=m1(r,i);if(s)for(a=0;a<o;++a)r[a].radius-=s;n.radius=l+s}}}function x1(t,e){return function(i,n,r){i.radius*=t,i.maxDepth=e,r&&(i.x=r.x+t*i.x,i.y=r.y+t*i.y)}}var k1=function(){function t(e){r(this,t),this.options=e;var i=null==e?void 0:e.nodeKey,n=H(i)?i:i?Qk(i):null;this._getNodeKey=n,this._getPadding=Z(null==e?void 0:e.padding)?function(t){return e.padding}:X(null==e?void 0:e.padding)?function(t){var i;return null!==(i=e.padding[t.depth+1])&&void 0!==i?i:0}:function(){return 0},this._maxDepth=-1}return o(t,[{key:"layout",value:function(e,i){var n,r="width"in i?{x0:0,x1:i.width,y0:0,y1:i.height,width:i.width,height:i.height}:{x0:Math.min(i.x0,i.x1),x1:Math.max(i.x0,i.x1),y0:Math.min(i.y0,i.y1),y1:Math.max(i.y0,i.y1),width:Math.abs(i.x1-i.x0),height:Math.abs(i.y1-i.y0)};if(!e||!e.length)return[];var a=[],o=Q0(e,a,0,-1,null,this._getNodeKey);this._maxDepth=o.maxDepth;var s=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return function(){return(t=(1664525*t+1013904223)%o1)/o1}}(),l={flattenIndex:-1,maxDepth:-1,key:"root",depth:-1,index:-1,value:o.sum,datum:null,children:a,x:r.x0+r.width/2,y:r.y0+r.height/2},u=null!==(n=this.options)&&void 0!==n?n:{},c=u.nodeSort,h=u.setRadius,d=u.padding,p=u.includeRoot;if(!1!==c){var f=H(c)?this.options.nodeKey:t.defaultOpionts.nodeSort;$0([l],(function(t){t.children&&t.children.length&&t.children.sort(f)}))}if(h)$0([l],_1(h)),t1([l],b1(this._getPadding,.5,s)),$0([l],x1(1,this._maxDepth));else{var v=Math.min(r.width,r.height);$0([l],_1(t.defaultOpionts.setRadius)),t1([l],b1(qk,1,s)),d&&t1([l],b1(this._getPadding,l.radius/v,s)),$0([l],x1(v/(2*l.radius),this._maxDepth))}return p?[l]:a}}])}();k1.defaultOpionts={setRadius:function(t){return Math.sqrt(t.value)},padding:0,nodeSort:function(t,e){return e.value-t.value}};var S1,A1=function(t,e){if(void 0===e&&(e={}),!t)return[];var i=[];return K0(t,i,e),i},M1=function(t,e){if(!t)return t;var i=e(),n=i.width,r=i.height;return new a1(i).layout(t,{width:n,height:r})},w1=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.markTooltipKeyCallback=function(t){return null==t?void 0:t[e.series.getDimensionField()[0]]},e}return S(e,t),e}(PY);!function(t){t.DrillDown="drillDown",t.DrillUp="drillUp"}(S1||(S1={}));var T1,C1=function(t,e){var i,n=e.info(),r=e.keyField(),a=null==n?void 0:n.key;if(j(a))return t;if(n.type===S1.DrillDown)return xt(i=zH(t,a,r,"children"));if(n.type===S1.DrillUp&&(i=HH(t,a,r,"children")))return xt(i);return t},E1=function(){function t(){}return t.prototype._getDrillTriggerEvent=function(t){var e;return null===(e=yZ(this._drillParams.mode))||void 0===e?void 0:e[t]},t.prototype._hideTooltip=function(){var t=this.getChart().getComponentsByType(B.tooltip)[0];t&&t.hideTooltip()},t.prototype.initDrillable=function(t){this._drillParams=t},t.prototype.initDrillableData=function(t){var e=this,i=this._drillParams.getRawData;qG(t,"drillFilter",C1),i().transform({type:"drillFilter",options:{info:function(){return e._drillInfo},keyField:function(){return e._drillParams.drillField()}}})},t.prototype.bindDrillEvent=function(){var t=this,e=this._drillParams,i=e.event,n=e.getRawData,r=(0,e.drillField)();this._getDrillTriggerEvent("start")&&i.on(this._getDrillTriggerEvent("start"),(function(e){var i,a,o;if(j(e.datum)||j(null===(i=e.datum)||void 0===i?void 0:i[r]))t.drillUp();else{t._hideTooltip();var s=e.datum[r],l=null!==(o=null===(a=t._drillInfo)||void 0===a?void 0:a.path)&&void 0!==o?o:[],u=function(t,e,i,n){void 0===i&&(i="key"),void 0===n&&(n="children");var r=[],a=function(t,o){var s,l;try{for(var u=C(t),c=u.next();!c.done;c=u.next()){var h=c.value;if(h[i]===e)return r.push.apply(r,P(P([],E(o),!1),[h[i].toString()],!1)),!0;if(h[n]){var d=a(h[n],P(P([],E(o),!1),[h[i]],!1));if(!0===d)return d}}}catch(t){s={error:t}}finally{try{c&&!c.done&&(l=u.return)&&l.call(u)}finally{if(s)throw s.error}}return!1};return a(t,[]),r}(n().rawData,s,r,"children");l[l.length-1]===u[u.length-1]?t.drillUp():t.drillDown(u)}}))},t.prototype.drillDown=function(t){void 0===t&&(t=[]);var e=this._drillParams,i=e.getRawData,n=e.event;if(!X(t)||ot(t))return t;var r=t[t.length-1];return this._drillInfo={key:r,path:t,type:S1.DrillDown},i().reRunAllTransform(),n.emit(cG.drill,{value:{path:t,type:S1.DrillDown},model:this}),t},t.prototype.drillUp=function(){var t,e,i=this._drillParams,n=i.getRawData,r=i.event,a=null!==(e=null===(t=this._drillInfo)||void 0===t?void 0:t.path)&&void 0!==e?e:[];if(!X(a)||ot(a))return a;var o=a.pop();return this._drillInfo={key:o,path:a,type:S1.DrillUp},n().reRunAllTransform(),r.emit(cG.drill,{value:{path:a,type:S1.DrillUp},model:this}),a},t}(),P1=A(A({},WY),((T1={}).sunburst={name:"sunburst",type:"arc"},T1)),R1=function(t,e,i){return t.push({key:e,operations:["values"]}),t.push({key:i,operations:["max","min"]}),t.push({key:OY,operations:["max","min","values"]}),t.push({key:FY,operations:["values"]}),t},B1=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.sunburst,i}return S(i,e),i.prototype.setCategoryField=function(t){return this._categoryField=t,this._categoryField},i.prototype.getCategoryField=function(){return this._categoryField},i.prototype.setValueField=function(t){return this._valueField=t,this._valueField},i.prototype.getValueField=function(){return this._valueField},i.prototype.getDimensionField=function(){return[this._categoryField]},i.prototype.getMeasureField=function(){return[this._valueField]},i.prototype.setAttrFromSpec=function(){var t,i=this;e.prototype.setAttrFromSpec.call(this),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(null!==(t=this._spec.seriesField)&&void 0!==t?t:FY),this._spec.drill&&this.initDrillable({event:this.event,mode:this._option.mode,drillField:function(){var t;return null!==(t=i._spec.drillField)&&void 0!==t?t:Yz},getRawData:function(){return i.getRawData()}}),this._startAngle=we(this._spec.startAngle),this._endAngle=we(this._spec.endAngle),this._centerX=this._spec.centerX,this._centerY=this._spec.centerY,this._offsetX=this._spec.offsetX,this._offsetY=this._spec.offsetY,this.__innerRadius=this._spec.innerRadius,this.__outerRadius=this._spec.outerRadius,this._gap=this._spec.gap,this._labelLayout=this._spec.labelLayout,this._sunburst=this._spec.sunburst,this._label=this._spec.label,this._labelAutoVisible=this._spec.labelAutoVisible},i.prototype.initData=function(){var t=this;e.prototype.initData.call(this);var i=this.getRawData();i&&(this._spec.drill&&this.initDrillableData(this._dataSet),qG(this._dataSet,"sunburstLayout",M1),qG(this._dataSet,"flatten",A1),i.transform({type:"sunburstLayout",options:function(){var e=t._computeLevel(),i=e.innerRadius,n=e.outerRadius,r=e.gap,a=e.label;return{nodeKey:t._categoryField,width:t.getLayoutRect().width,height:t.getLayoutRect().height,center:[N(t._centerX)?t._centerX:t.getLayoutRect().width/2,N(t._centerY)?t._centerY:t.getLayoutRect().height/2],startAngle:t._startAngle,endAngle:t._endAngle,innerRadius:i,outerRadius:n,gapRadius:r,label:a}}}),i.transform({type:"flatten",options:{callback:function(t){if(t.datum){var e=t.datum[t.depth];return A(A({},t),e)}return t}}}))},i.prototype.getStatisticFields=function(){return R1(e.prototype.getStatisticFields.call(this),this._categoryField,this._valueField)},i.prototype._addDataIndexAndKey=function(){var t=this.getRawData();j(null==t?void 0:t.dataSet)||(qG(t.dataSet,"addVChartProperty",_Y),t.transform({type:"addVChartProperty",options:{beforeCall:NY.bind(this),call:VY}}))},i.prototype.initMark=function(){this._initArcMark(),this._initLabelMark()},i.prototype.initMarkStyle=function(){this._initArcMarkStyle(),this._initLabelMarkStyle()},i.prototype._initArcMark=function(){var t,e;if(!1!==this._sunburst.visible){var n=this._createMark(i.mark.sunburst,{isSeriesMark:!0,stateSort:null===(t=this._spec.sunburst)||void 0===t?void 0:t.stateSort},{setCustomizedShape:null===(e=this._spec.sunburst)||void 0===e?void 0:e.customShape});this._sunburstMark=n}},i.prototype._initArcMarkStyle=function(){var t=this;j(this._sunburstMark)||this.setMarkStyle(this._sunburstMark,{x:function(e){return e.x+(N(t._offsetX)?t._offsetX:0)},y:function(e){return e.y+(N(t._offsetY)?t._offsetY:0)},outerRadius:function(t){return t.outerRadius},innerRadius:function(t){return t.innerRadius},startAngle:function(t){return t.startAngle},endAngle:function(t){return t.endAngle},fill:this.getColorAttribute()},hU.STATE_NORMAL,CU.Series)},i.prototype._initLabelMark=function(){if(!0===this._label.visible){var t=this._createMark(i.mark.label,{isSeriesMark:!1});this._labelMark=t}},i.prototype._initLabelMarkStyle=function(){var t=this;j(this._labelMark)||this.setMarkStyle(this._labelMark,{visible:function(e){var i,n=t._labelAutoVisible;return V(n)&&!0===n.enable?(e.endAngle-e.startAngle)*(e.outerRadius-e.innerRadius)>(null!==(i=null==n?void 0:n.circumference)&&void 0!==i?i:10):t._spec.label.visible},x:function(e){var i;return(null===(i=e.label)||void 0===i?void 0:i.x)+(N(t._offsetX)?t._offsetX:0)},y:function(e){var i;return(null===(i=e.label)||void 0===i?void 0:i.y)+(N(t._offsetY)?t._offsetY:0)},textBaseline:function(t){var e;return null===(e=t.label)||void 0===e?void 0:e.textBaseline},textAlign:function(t){var e;return null===(e=t.label)||void 0===e?void 0:e.textAlign},angle:function(t){var e,i;return null!==(i=null===(e=t.label)||void 0===e?void 0:e.angle)&&void 0!==i?i:0},fontSize:10,text:function(t){return t.name}},hU.STATE_NORMAL,CU.Series)},i.prototype.initTooltip=function(){this._tooltipHelper=new w1(this),this._sunburstMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._sunburstMark),this._labelMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._labelMark)},i.prototype.initAnimation=function(){var t,e,i=this,n={animationInfo:function(){return{innerRadius:i._computeRadius(xt(i.__innerRadius))[0],outerRadius:i._computeRadius(xt(i.__outerRadius))[0],startAngle:xt(i._startAngle)[0],endAngle:xt(i._endAngle)[0]}}},r=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this.getMarksInType("arc").forEach((function(t){var e;t.setAnimationConfig(cX(null===(e=kz.getAnimationInKey("sunburst"))||void 0===e?void 0:e(n,r),hX(t.name,i._spec,i._markAttributeContext)))})),this.getMarksInType("text").forEach((function(t){var e;t.setAnimationConfig(cX(null===(e=kz.getAnimationInKey("fadeInOut"))||void 0===e?void 0:e(),hX(t.name,i._spec,i._markAttributeContext)))}))},i.prototype.initEvent=function(){e.prototype.initEvent.call(this),this._spec.drill&&this.bindDrillEvent()},i.prototype.onLayoutEnd=function(t){e.prototype.onLayoutEnd.call(this,t),this._rawData.reRunAllTransform()},i.prototype._computeRadius=function(t){var e=this;return X(t)?t.map((function(t){return e._computeLayoutRadius()*t})):this._computeLayoutRadius()*t},i.prototype._computeLevel=function(){return{innerRadius:this._computeRadius(this.__innerRadius),outerRadius:this._computeRadius(this.__outerRadius),gap:this._gap,label:this._labelLayout}},i.prototype.getGroupFields=function(){return[]},i.prototype.getStackGroupFields=function(){return[]},i.prototype.getStackValueField=function(){return""},i.prototype._noAnimationDataKey=function(t,e){},i.prototype.getActiveMarks=function(){return[this._sunburstMark]},i.prototype.getMarkData=function(t){return(null==t?void 0:t.datum)?t.datum[t.datum.length-1]:t},i.type=t.SeriesTypeEnum.sunburst,i.mark=P1,i}(RJ);bt(B1,E1);var I1,L1=function(){kz.registerSeries(B1.type,B1),YJ(),dJ(),iX(),kz.registerAnimation("sunburst",(function(t,e){return{appear:X0(0,e),enter:G0(t),exit:Y0(t),disappear:Y0(t)}}))},D1=function(t,e){if(!t)return t;var i=e(),n=i.width,r=i.height;return 0===n||0===r?t:new k1(i).layout(t,{width:n,height:r})},O1=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.markTooltipKeyCallback=function(t){return null==t?void 0:t[e.series.getDimensionField()[0]]},e}return S(e,t),e}(PY),F1=function(t){return"fadeIn"===t?{type:"fadeIn"}:{type:"growRadiusIn"}},z1=A(A({},WY),((I1={}).circlePacking={name:"circlePacking",type:"arc"},I1)),H1=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.circlePacking,i}return S(i,e),i.prototype.setCategoryField=function(t){return this._categoryField=t,this._categoryField},i.prototype.getCategoryField=function(){return this._categoryField},i.prototype.setValueField=function(t){return this._valueField=t,this._valueField},i.prototype.getValueField=function(){return this._valueField},i.prototype.getDimensionField=function(){return[this._categoryField]},i.prototype.getMeasureField=function(){return[this._valueField]},i.prototype.setAttrFromSpec=function(){var t,i=this;e.prototype.setAttrFromSpec.call(this),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(null!==(t=this._spec.seriesField)&&void 0!==t?t:FY),this._spec.drill&&this.initDrillable({event:this.event,mode:this._option.mode,drillField:function(){var t;return null!==(t=i._spec.drillField)&&void 0!==t?t:Yz},getRawData:function(){return i.getRawData()}}),this._circlePacking=this._spec.circlePacking,this._label=this._spec.label,this._layoutPadding=this._spec.layoutPadding},i.prototype.initData=function(){var t=this;e.prototype.initData.call(this);var i=this.getRawData();j(i)||(this._spec.drill&&this.initDrillableData(this._dataSet),qG(this._dataSet,"circlePackingLayout",D1),qG(this._dataSet,"flatten",A1),i.transform({type:"circlePackingLayout",options:function(){return{nodeKey:t._categoryField,padding:t._layoutPadding,includeRoot:!1,width:t.getLayoutRect().width||1,height:t.getLayoutRect().height||1}}}),i.transform({type:"flatten",options:{callback:function(t){if(t.datum){var e=t.datum[t.depth];return A(A({},t),e)}return t}}}))},i.prototype._addDataIndexAndKey=function(){var t=this.getRawData();j(null==t?void 0:t.dataSet)||(qG(t.dataSet,"addVChartProperty",_Y),t.transform({type:"addVChartProperty",options:{beforeCall:NY.bind(this),call:VY}}))},i.prototype.initMark=function(){this._initCirclePackingMark(),this._initLabelMark()},i.prototype.initMarkStyle=function(){this._initCirclePackingMarkStyle(),this._initLabelMarkStyle()},i.prototype._initCirclePackingMark=function(){var t,e;if(!1!==(null===(t=this._circlePacking)||void 0===t?void 0:t.visible)){var n=this._createMark(i.mark.circlePacking,{isSeriesMark:!0},{setCustomizedShape:null===(e=this._spec.circlePacking)||void 0===e?void 0:e.customShape});this._circlePackingMark=n}},i.prototype._initCirclePackingMarkStyle=function(){j(this._circlePackingMark)||this.setMarkStyle(this._circlePackingMark,{x:function(t){return t.x},y:function(t){return t.y},outerRadius:function(t){return t.radius},innerRadius:0,startAngle:0,endAngle:2*Math.PI,fill:this.getColorAttribute(),zIndex:function(t){return t.depth}},hU.STATE_NORMAL,CU.Series)},i.prototype._initLabelMark=function(){var t;if(!1!==(null===(t=this._label)||void 0===t?void 0:t.visible)){var e=this._createMark(i.mark.label,{isSeriesMark:!1});this._labelMark=e}},i.prototype._initLabelMarkStyle=function(){j(this._labelMark)||this.setMarkStyle(this._labelMark,{x:function(t){return t.x},y:function(t){return t.y},text:function(t){return t.key},cursor:"pointer"},hU.STATE_NORMAL,CU.Series)},i.prototype.getStatisticFields=function(){return R1(e.prototype.getStatisticFields.call(this),this._categoryField,this._valueField)},i.prototype.initTooltip=function(){this._tooltipHelper=new O1(this),this._circlePackingMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._circlePackingMark),this._labelMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._labelMark)},i.prototype.initAnimation=function(){var t,e=this,i=null===(t=this._spec.animationAppear)||void 0===t?void 0:t.preset;this.getMarksInType("arc").forEach((function(t){var n;t.setAnimationConfig(cX(null===(n=kz.getAnimationInKey("circlePacking"))||void 0===n?void 0:n(void 0,i),hX(t.name,e._spec,e._markAttributeContext)))})),this.getMarksInType("text").forEach((function(t){var i;t.setAnimationConfig(cX(null===(i=kz.getAnimationInKey("scaleInOut"))||void 0===i?void 0:i(),hX(t.name,e._spec,e._markAttributeContext)))}))},i.prototype.initEvent=function(){e.prototype.initEvent.call(this),this._spec.drill&&this.bindDrillEvent()},i.prototype.onLayoutEnd=function(t){e.prototype.onLayoutEnd.call(this,t),this._rawData.reRunAllTransform()},i.prototype._noAnimationDataKey=function(t,e){},i.prototype.getActiveMarks=function(){return[this._circlePackingMark]},i.prototype.getMarkData=function(t){return(null==t?void 0:t.datum)?t.datum[t.datum.length-1]:t},i.type=t.SeriesTypeEnum.circlePacking,i.mark=z1,i}(SX);bt(H1,E1);var j1=function(){kz.registerSeries(H1.type,H1),YJ(),dJ(),eX(),kz.registerAnimation("circlePacking",(function(t,e){return{appear:F1(e),enter:{type:"growRadiusIn"},exit:{type:"growRadiusOut"},disappear:{type:"growRadiusOut"}}}))},N1=function(t){var e=0;return t.forEach((function(t,i){var n;j(t.value)&&((null===(n=t.children)||void 0===n?void 0:n.length)?t.value=N1(t.children):t.value=0),e+=Math.abs(t.value)})),e};function V1(t){return t.depth}function W1(t,e){return e-1-t.endDepth}var G1=function(t,e){return(null==t?void 0:t.y0)-(null==e?void 0:e.y0)},U1=function(t,e){if(j(t.value))return null;var i=(e?t.targetLinks:t.sourceLinks).reduce((function(t,e){return j(e.value)?t.count+=1:t.sum+=e.value,t}),{sum:0,count:0});return i.count>0?(t.value-i.sum)/i.count:null},Y1={left:V1,right:W1,justify:function(t,e){return t.sourceLinks.length?t.depth:e-1},center:function(t,e,i){return t.targetLinks.length?t.depth:t.sourceLinks.length?At(t.sourceLinks.map((function(t){return i[t.target].depth})))-1:0},start:V1,end:W1},X1=Xt(0,1),K1=function(){return o((function t(e){var i=this;r(this,t),this._ascendingSourceBreadth=function(t,e){return G1(i._nodeMap[t.source],i._nodeMap[e.source])||t.index-e.index},this._ascendingTargetBreadth=function(t,e){return G1(i._nodeMap[t.target],i._nodeMap[e.target])||t.index-e.index},this.options=Object.assign({},t.defaultOptions,e);var n=this.options.nodeKey,a=H(n)?n:n?Qk(n):null;this._getNodeKey=a,this._logger=Lt.getInstance(),this._alignFunc=H(this.options.setNodeLayer)?function(t){return i.options.setNodeLayer(t.datum)}:Y1[this.options.nodeAlign]}),[{key:"layout",value:function(t,e){var i=this;if(!t)return null;var n="width"in e?{x0:0,x1:e.width,y0:0,y1:e.height,width:e.width,height:e.height}:{x0:Math.min(e.x0,e.x1),x1:Math.max(e.x0,e.x1),y0:Math.min(e.y0,e.y1),y1:Math.max(e.y0,e.y1),width:Math.abs(e.x1-e.x0),height:Math.abs(e.y1-e.y0)};aS(this.options.direction)?this._viewBox={x0:n.y0,x1:n.y1,y0:n.x0,y1:n.x1,width:n.height,height:n.width}:this._viewBox=n;var r=this.computeNodeLinks(t),a=r.nodes,o=r.links;if(this._nodeMap=r.nodeMap,this.computeNodeValues(a),this.computeNodeDepths(a),["right","end","justify"].includes(this.options.nodeAlign)&&this.computeNodeEndDepths(a),this._maxDepth<=0)return null;var s=this.computeNodeBreadths(a);if(this.computeLinkBreadths(a),a.forEach((function(t){t.sourceLinks=t.sourceLinks.filter((function(t){return!j(t.source)&&!j(t.target)})),t.targetLinks=t.targetLinks.filter((function(t){return!j(t.source)&&!j(t.target)}))})),o=o.filter((function(t){return!j(t.source)&&!j(t.target)})),aS(this.options.direction))if(this.options.inverse){var l=this._viewBox.x1;a.forEach((function(t){var e=t.y0,i=t.y1,n=t.x0,r=t.x1;t.y0=l-r,t.y1=l-n,t.x0=e,t.x1=i})),o.forEach((function(t){t.vertical=!0;var e=t.x0,i=t.x1,n=t.y0,r=t.y1;t.x0=n,t.x1=r,t.y0=l-e,t.y1=l-i}))}else a.forEach((function(t){var e=t.y0,i=t.y1;t.y0=t.x0,t.y1=t.x1,t.x0=e,t.x1=i})),o.forEach((function(t){t.vertical=!0;var e=t.x0,i=t.x1;t.x0=t.y0,t.x1=t.y1,t.y0=e,t.y1=i}));else this.options.inverse&&(a.forEach((function(t){var e=t.x0,i=t.x1;t.x0=n.x1-i,t.x1=n.x1-e})),o.forEach((function(t){t.x0=n.x1-t.x0,t.x1=n.x1-t.x1})));return o.forEach((function(t){var e=i._nodeMap[t.source],n=i._nodeMap[t.target];t.sourceRect={x0:e.x0,x1:e.x1,y0:e.y0,y1:e.y1},t.targetRect={x0:n.x0,x1:n.x1,y1:n.y1,y0:n.y0}})),{nodes:a,links:o,columns:s}}},{key:"computeHierarchicNodeLinks",value:function(t){var e=this,i=[],n=[],r={},a={},o=[];N1(t);var s=function(t,n,a){t.forEach((function(t,l){var u=e._getNodeKey?e._getNodeKey(t):a?"".concat(a[a.length-1].key,"-").concat(l):"".concat(n,"-").concat(l),c=j(t.value)?0:ee(t.value);if(r[u])r[u].value=void 0;else{var h={depth:n,datum:t,index:l,key:u,value:c,sourceLinks:[],targetLinks:[]};r[u]=h,i.push(h)}a&&o.push({source:a[a.length-1].key,target:u,value:c,parents:a}),t.children&&t.children.length&&s(t.children,n+1,a?a.concat([r[u]]):[r[u]])}))};return s(t,0,null),o.forEach((function(t,e){var i="".concat(t.source,"-").concat(t.target),o=vt(t,["parents"]);if(o.parents=t.parents.map((function(t){return vt(t,["sourceLinks","targetLinks"])})),a[i])return a[i].value+=ee(t.value),void a[i].datum.push(o);var s={index:e,key:"".concat(t.source,"-").concat(t.target),source:t.source,target:t.target,datum:[o],value:t.value,parents:t.parents.map((function(t){return t.key}))};n.push(s),r[t.source].sourceLinks.push(s),r[t.target].targetLinks.push(s),a[i]=s})),{nodes:i,links:n,nodeMap:r}}},{key:"computeSourceTargetNodeLinks",value:function(t){var e=this,i=[],n=[],r={};t.nodes&&t.nodes.forEach((function(t,n){var a={depth:-1,datum:t,index:n,key:e._getNodeKey?e._getNodeKey(t):n,value:t.value,sourceLinks:[],targetLinks:[]};r[a.key]=a,i.push(a)}));var a=[];return t.links.forEach((function(o,s){var l=!j(o.source),u=!j(o.target);if(!t.nodes||r[o.source]&&r[o.target]){t.nodes||!l||r[o.source]||(r[o.source]={value:void 0,depth:-1,index:i.length,key:o.source,datum:null,sourceLinks:[],targetLinks:[]},i.push(r[o.source])),t.nodes||!u||r[o.target]||(r[o.target]={value:void 0,depth:-1,index:i.length,key:o.target,datum:null,sourceLinks:[],targetLinks:[]},i.push(r[o.target]));var c={index:s,source:o.source,target:o.target,datum:o,value:o.value};e.options.divideNodeValueToLink&&j(o.value)&&a.push(c),n.push(c),l&&r[o.source].sourceLinks.push(c),u&&r[o.target].targetLinks.push(c)}})),this.options.divideNodeValueToLink&&a.length&&a.forEach((function(t){var e=[U1(r[t.source]),U1(r[t.target],!0)].filter((function(t){return!j(t)}));e.length&&(t.value=At(e))})),{nodeMap:r,nodes:i,links:n}}},{key:"computeNodeLinks",value:function(t){var e;"links"in t?e=this.computeSourceTargetNodeLinks(t):(this._isHierarchic=!0,e=this.computeHierarchicNodeLinks(t.nodes));var i=e.nodes,n=e.links;if(this.options.linkSortBy)for(var r=0,a=i.length;r<a;r++)i[r].sourceLinks.sort(this.options.linkSortBy),i[r].targetLinks.sort(this.options.linkSortBy);return this.options.dropIsolatedNode&&(i=i.filter((function(t){return t.targetLinks.length||t.sourceLinks.length}))),{nodes:i,links:n,nodeMap:e.nodeMap}}},{key:"computeNodeValues",value:function(t){for(var e=0,i=t.length;e<i;e++){var n=t[e];n.value=Math.max(j(n.value)?0:ee(n.value),n.sourceLinks.reduce((function(t,e){var i;return t+(null!==(i=ee(e.value))&&void 0!==i?i:0)}),0),n.targetLinks.reduce((function(t,e){var i;return t+(null!==(i=ee(e.value))&&void 0!==i?i:0)}),0))}}},{key:"computeNodeDepths",value:function(t){for(var e,i,n,r=t.length,a=t,o=0,s=-1,l=H(this.options.setNodeLayer)?this.options.setNodeLayer:null;a.length&&o<r;){i=[],n={};for(var u=0,c=a.length;u<c;u++){var h=a[u];if(h&&(h.depth=l&&null!==(e=l(h.datum))&&void 0!==e?e:o,l&&(s=Math.max(h.depth,s)),h.sourceLinks&&h.sourceLinks.length))for(var d=0,p=h.sourceLinks.length;d<p;d++){var f=h.sourceLinks[d];n[f.target]||(i.push(this._nodeMap[f.target]),n[f.target]=!0)}}a=i,o+=1}o>r&&this._logger.warn("Error: there is a circular link"),this._maxDepth=l?s+1:o}},{key:"computeNodeEndDepths",value:function(t){for(var e,i,n=t.length,r=t,a=0;r.length&&a<n;){e=[],i={};for(var o=0,s=r.length;o<s;o++){var l=r[o];if(l){l.endDepth=a;for(var u=0,c=l.targetLinks.length;u<c;u++){var h=l.targetLinks[u];i[h.source]||(e.push(this._nodeMap[h.source]),i[h.source]=!0)}}}r=e,a+=1}a>n&&this._logger.warn("Error: there is a circular link")}},{key:"computeNodeLayers",value:function(t){var e=this.options.nodeWidth,i=this.options.linkWidth,n=this.options.minStepWidth,r=this._viewBox.width,a=null,o=null,s=!1;if(Y(e)){var l=Ut(parseFloat(e.replace("%",""))/100,0,1),u=r/(this._maxDepth-1+l);n>0&&(u=Math.max(n,u)),a=u*l,o=u*(1-l),s=!0}else if(Z(e)){if(a=e,Z(i))o=i;else if(j(i)){var c=(r-e)/(this._maxDepth-1);n>0&&(c=Math.max(n,c)),o=c-e}s=!0}else H(e)&&Z(i)&&(o=i);for(var h=[],d=0,p=t.length;d<p;d++){var f=t[d];f.layer=this._isHierarchic?f.depth:Ut(Math.floor(this._alignFunc(f,this._maxDepth,this._nodeMap)),0,this._maxDepth-1);var v=f.layer;v===this._maxDepth-1&&(f.isLastLayer=!0),s&&(f.x0=this._viewBox.x0+v*(a+o),f.x1=f.x0+a),h[v]?h[v].push(f):h[v]=[f]}if(this.options.nodeSortBy)for(var g=0,y=h.length;g<y;g++)h[g].sort(this.options.nodeSortBy);if(!s&&H(e))for(var m=this._viewBox.x0,_=0;_<this._maxDepth;_++){for(var b=h[_],x=0,k=0,S=0,A=b&&b.length;S<A;S++){var M=b[S],w=e(M);M.x0=m,M.x1=m+w,x=Math.max(a,w);for(var T=M.sourceLinks,C=0,E=T.length;C<E;C++){var P=T[C],R=H(i)?i(P,this._viewBox):o;k=Math.max(k,R)}}m+=x+k}return h}},{key:"initializeNodeBreadths",value:function(t){var e,i,n,r=this,a=null!==(e=this.options.minLinkHeight)&&void 0!==e?e:0,o=null!==(i=this.options.minNodeHeight)&&void 0!==i?i:0,s=null!==(n=this.options.maxNodeHeight)&&void 0!==n?n:1/0,l=this.options.maxLinkHeight;(j(o)||o<a)&&(o=a),(j(l)||l>s)&&(l=s);var u=0,c=null,h=null;if(H(this.options.nodeGap))c=this.options.nodeGap,u=t.reduce((function(t,e){var i=e.reduce((function(t,e){return t+e.value}),0),n=e.reduce((function(t,e){return t+r.options.nodeGap(e)}),0);return Math.min(t,(r._viewBox.height-n)/i)}),1/0);else{var d=t.reduce((function(t,e){return Math.max(t,e.length)}),0),p=this._viewBox.height/d,f=Math.min(this.options.nodeGap,p);if(o+f>p&&(f=o>=p?p/2:(p-o)/2,o=Math.min(p-f,o)),c=function(){return f},this._gapY=f,this.options.equalNodeHeight)h=this._viewBox.height/d-f;else{var v=o>0?Math.max(f,o):f;u=t.reduce((function(t,e){var i=e.reduce((function(t,e){return t+e.value}),0);return Math.min(t,(r._viewBox.height-((e.length-1)*v+o))/i)}),1/0)}}for(var g="start"===this.options.gapPosition,y=!g&&"end"!==this.options.gapPosition,m=Z(this.options.nodeHeight)?function(t){return r.options.nodeHeight}:H(this.options.nodeHeight)?this.options.nodeHeight:h>0?function(t){return h}:function(t){return Math.max(t.value*u,0)},_=Z(this.options.linkHeight)?function(){return r.options.linkHeight}:H(this.options.linkHeight)?this.options.linkHeight:function(t,e,i){return Math.min(Math.max(e.value?i*X1(t.value/e.value):0,a,0),l)},b=function(){var e=t[x];if(!e||!e.length)return 1;for(var i=r._viewBox.y0,n=0,a=0,l=0,u=0,h=e.length;u<h;u++){var d=e[u];n=c(d),g&&(i+=n),l=m(d),a=Math.min(Math.max(l,o),s),d.y0=i,d.y1=i+a,i=g?d.y1:d.y1+n;for(var p=0,f=d.sourceLinks.length;p<f;p++){var v=d.sourceLinks[p];v.thickness=_(v,d,l)}}var b=r._viewBox.y1-i+(y?n:0);if(b>0)if("start"===r.options.crossNodeAlign);else if("end"===r.options.crossNodeAlign)for(var k=0,S=e.length;k<S;++k){var A=e[k];A.y0+=b,A.y1+=b}else if("parent"===r.options.crossNodeAlign){var M=e.reduce((function(t,e){return e.targetLinks&&e.targetLinks.length&&e.targetLinks.forEach((function(e){t[e.source]=!0})),t}),{});if(Object.keys(M).length&&t[x-1]&&t[x-1].length){var w=t[x-1].filter((function(t){return M[t.key]}));if(w&&w.length&&w[0].y0!==e[0].y0)for(var T=w[0].y0-e[0].y0,C=0,E=e.length;C<E;++C){var P=e[C];P.y0+=T,P.y1+=T}}}else{b/=e.length+1;for(var R=0,B=e.length;R<B;++R){var I=e[R];I.y0+=b*(R+1),I.y1+=b*(R+1)}}else if(b<0&&e.length>1&&n+(b/=e.length-1)>=0){n+=b,r._gapY=Math.min(n);for(var L=1,D=e.length;L<D;++L){var O=e[L];O.y0+=b*L,O.y1+=b*L}}r.reorderLinks(e)},x=0,k=t.length;x<k;x++)b()}},{key:"computeNodeBreadths",value:function(t){var e=this.computeNodeLayers(t);this.initializeNodeBreadths(e);var i=this.options.iterations;if(!this._isHierarchic&&!H(this.options.setNodeLayer)&&!H(this.options.nodeGap))for(var n=0;n<i;++n){var r=Math.pow(.99,n),a=Math.max(1-r,(n+1)/i);this.relaxRightToLeft(e,r,a),this.relaxLeftToRight(e,r,a)}return e}},{key:"relaxLeftToRight",value:function(t,e,i){for(var n=1,r=t.length;n<r;++n){for(var a=t[n],o=0,s=a.length;o<s;o++){for(var l=a[o],u=0,c=0,h=0,d=l.targetLinks.length;h<d;h++){var p=l.targetLinks[h],f=p.value*(l.layer-this._nodeMap[p.source].layer);u+=this.targetTop(this._nodeMap[p.source],l)*f,c+=f}if(c>0){var v=(u/c-l.y0)*e;l.y0+=v,l.y1+=v,this.reorderNodeLinks(l)}}j(this.options.nodeSortBy)&&a.sort(G1),this.resolveCollisions(a,i)}}},{key:"relaxRightToLeft",value:function(t,e,i){for(var n=t.length-2;n>=0;--n){for(var r=t[n],a=0,o=r.length;a<o;a++){for(var s=r[a],l=0,u=0,c=0,h=s.sourceLinks.length;c<h;c++){var d=s.sourceLinks[c],p=d.value*(this._nodeMap[d.target].layer-s.layer);l+=this.sourceTop(s,this._nodeMap[d.target])*p,u+=p}if(u>0){var f=(l/u-s.y0)*e;s.y0+=f,s.y1+=f,this.reorderNodeLinks(s)}}void 0===this.options.nodeSortBy&&r.sort(G1),this.resolveCollisions(r,i)}}},{key:"resolveCollisions",value:function(t,e){var i=t.length>>1,n=t[i];this.resolveCollisionsBottomToTop(t,n.y0-this._gapY,i-1,e),this.resolveCollisionsTopToBottom(t,n.y1+this._gapY,i+1,e),this.resolveCollisionsBottomToTop(t,this._viewBox.y1,t.length-1,e),this.resolveCollisionsTopToBottom(t,this._viewBox.y0,0,e)}},{key:"resolveCollisionsTopToBottom",value:function(t,e,i,n){for(;i<t.length;++i){var r=t[i],a=(e-r.y0)*n;a>1e-6&&(r.y0+=a,r.y1+=a),e=r.y1+this._gapY}}},{key:"resolveCollisionsBottomToTop",value:function(t,e,i,n){for(;i>=0;--i){var r=t[i],a=(r.y1-e)*n;a>1e-6&&(r.y0-=a,r.y1-=a),e=r.y0-this._gapY}}},{key:"targetTop",value:function(t,e){var i,n,r,a=t.y0-(t.sourceLinks.length-1)*this._gapY/2;for(i=0,n=t.sourceLinks.length;i<n&&(r=t.sourceLinks[i]).target!==e.key;i++)a+=r.thickness+this._gapY;for(i=0,n=e.targetLinks.length;i<n&&(r=e.targetLinks[i]).source!==t.key;i++)a-=r.thickness;return a}},{key:"sourceTop",value:function(t,e){var i,n,r,a=e.y0-(e.targetLinks.length-1)*this._gapY/2;for(i=0,n=e.targetLinks.length;i<n&&(r=e.targetLinks[i]).source!==t.key;i++)a+=r.thickness+this._gapY;for(i=0,n=t.sourceLinks.length;i<n&&(r=t.sourceLinks[i]).target!==e.key;i++)a-=r.thickness;return a}},{key:"computeLinkBreadthsNoOverlap",value:function(t){for(var e=0,i=t.length;e<i;e++){for(var n=t[e],r=n.y0,a=!1,o=0,s=n.sourceLinks.length;o<s;o++){var l=n.sourceLinks[o];a||(l.y0=r+l.thickness/2),l.x0=n.x1,r+l.thickness>n.y1||a?(l.y0=n.y1-l.thickness/2,a=!0):r+=l.thickness}var u=n.y0;a=!1;for(var c=0,h=n.targetLinks.length;c<h;c++){var d=n.targetLinks[c];a||(d.y1=u+d.thickness/2),d.x1=n.x0,u+d.thickness>n.y1||a?(d.y1=n.y1-d.thickness/2,a=!0):u+=d.thickness}}}},{key:"computeLinkBreadthsOverlap",value:function(t){for(var e=this.options.linkOverlap,i=0,n=t.length;i<n;i++){for(var r=t[i],a="start"===e?r.y0:"end"===e?r.y1:(r.y0+r.y1)/2,o="start"===e?.5:"end"===e?-.5:0,s=0,l=r.sourceLinks.length;s<l;s++){var u=r.sourceLinks[s];u.y0=a+o*u.thickness,u.x0=r.x1}for(var c=0,h=r.targetLinks.length;c<h;c++){var d=r.targetLinks[c];d.y1=a+o*d.thickness,d.x1=r.x0}}}},{key:"computeLinkBreadths",value:function(t){this.options.linkOverlap?this.computeLinkBreadthsOverlap(t):this.computeLinkBreadthsNoOverlap(t)}},{key:"reorderNodeLinks",value:function(t){if(j(this.options.linkSortBy)){for(var e=t.targetLinks,i=t.sourceLinks,n=0,r=e.length;n<r;n++){var a=e[n];this._nodeMap[a.source].sourceLinks.sort(this._ascendingTargetBreadth)}for(var o=0,s=i.length;o<s;o++){var l=i[o];this._nodeMap[l.target].targetLinks.sort(this._ascendingSourceBreadth)}}}},{key:"reorderLinks",value:function(t){if(j(this.options.linkSortBy))for(var e=0,i=t.length;e<i;e++){var n=t[e];n.sourceLinks.sort(this._ascendingTargetBreadth),n.targetLinks.sort(this._ascendingSourceBreadth)}}}])}();K1.defaultOptions={iterations:6,nodeAlign:"justify",direction:"horizontal",nodeWidth:24,nodeGap:8,crossNodeAlign:"middle",dropIsolatedNode:!0};var q1,Z1,J1=function(t,e){var i=new K1(t).layout(Array.isArray(e)?e[0]:e,"width"in t?{width:t.width,height:t.height}:{x0:t.x0,x1:t.x1,y0:t.y0,y1:t.y1});return i?[i]:[]},Q1=function(t,e,i){e.forEach((function(e){j(e[i])||t.add(e[i]),e.children&&e.children.length>0&&Q1(t,e.children,i)}))},$1=function(t){var e;if(!t||!X(t))return[];if(t.length>1){var i={links:[],nodes:[]};return t.forEach((function(t){"links"!==t.id&&"nodes"!==t.id||(i[t.id]=t.values)})),[i]}return(null===(e=t[0])||void 0===e?void 0:e.latestData)?t[0].latestData:t},t2=function(t,e){if(!t||!(null==e?void 0:e.view)||!t.length)return[];var i=e.view();if(i.x1-i.x0==0||i.y1-i.y0==0||i.x1-i.x0==-1/0||i.x1-i.x0==1/0||i.y1-i.y0==-1/0||i.y1-i.y0==1/0)return[];var n=t[0];if(("source"!==e.sourceField||"target"!==e.targetField||"value"!==e.valueField)&&n.links){var r=[];n.links.forEach((function(t){var i={};for(var n in t)n===e.sourceField?i.source=t[e.sourceField]:n===e.targetField?i.target=t[e.targetField]:n===e.valueField?i.value=t[e.valueField]:i[n]=t[n];r.push(i)})),n.links=r}var a=new K1(e),o=[];return o.push(a.layout(n,i)),o},e2=function(t){var e,i;return t&&X(t)&&(null===(e=t[0])||void 0===e?void 0:e.latestData)&&t[0].latestData.length&&t[0].latestData[0]&&null!==(i=t[0].latestData[0].nodes)&&void 0!==i?i:[]},i2=function(t){var e,i;return t&&X(t)&&(null===(e=t[0])||void 0===e?void 0:e.latestData)&&t[0].latestData.length&&t[0].latestData[0]&&null!==(i=t[0].latestData[0].links)&&void 0!==i?i:[]},n2=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._getDimensionData=function(t){if(t.source){if(Z(t.source)){var i=e.series.getSeriesKeys();return i[t.source]+" => "+i[t.target]}return t.source+" => "+t.target}return t.datum?t.datum[e.series.getSpec().categoryField]:t.key},e.markTooltipValueCallback=function(t){return t.value},e}return S(e,t),e}(PY),r2=function(t,e){return void 0===e&&(e=!0),{type:"horizontal"===t.direction?"growWidthIn":"growHeightIn",options:{overall:e?t.growFrom():e,orient:"positive"}}},a2=function(t,e){return"fadeIn"===e?{type:"fadeIn"}:r2(t)},o2=function(t){return"fadeIn"===t?{type:"fadeIn"}:{type:"linkPathGrowIn"}},s2=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return S(e,t),e.prototype._getDefaultStyle=function(){return A(A({},t.prototype._getDefaultStyle.call(this)),{x:0,y:0,x0:0,y0:0,x1:100,y1:100,thickness:1,round:!0})},e.prototype._initProduct=function(t){var e=this.getVGrammarView(),i=this.getProductId(),n=this.getStyle("direction");this._product=e.glyph("linkPath",null!=t?t:e.rootMark).id(i).configureGlyph({direction:n}),this._compiledProductId=i},e.type="linkPath",e}(aY),l2=function(){xj.registerGlyph("linkPath",{back:"path",front:"path"}).registerFunctionEncoder(mV).registerChannelEncoder("backgroundStyle",(function(t,e){return{back:e}})).registerDefaultEncoder((function(){return{back:{zIndex:0},front:{zIndex:1}}})),xj.registerAnimationType("linkPathGrowIn",_V),xj.registerAnimationType("linkPathGrowOut",bV),xj.registerAnimationType("linkPathUpdate",xV),aV(),iV(),JN(),kz.registerMark(s2.type,s2)},u2=A(A({},WY),((q1={}).node={name:"node",type:"rect"},q1.link={name:"link",type:"linkPath"},q1)),c2=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"node")},e}(mX),h2=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.sankey,i.transformerConstructor=c2,i._nodeLayoutZIndex=wU.Node,i._labelLayoutZIndex=wU.Label,i._viewBox=new di,i._fillByNode=function(t){var e,n,r,a,o;if(t&&t.sourceRect&&t.targetRect)return i._fillByLink(t);var s=null===(n=null===(e=i._spec.node)||void 0===e?void 0:e.style)||void 0===n?void 0:n.fill;if(N(s))return s;if(N(i._spec.seriesField)){var l=null===(a=null===(r=i._option)||void 0===r?void 0:r.globalScale)||void 0===a?void 0:a.getScale("color"),u=(null==t?void 0:t.datum)?t.datum:t;return null==l?void 0:l.scale(null==u?void 0:u[i._spec.seriesField])}return null===(o=i._colorScale)||void 0===o?void 0:o.scale(i._getNodeNameFromData(t))},i._fillByLink=function(t){var e,n,r,a,o,s,l,u=null===(n=null===(e=i._spec.link)||void 0===e?void 0:e.style)||void 0===n?void 0:n.fill;if(u)return u;if(N(i._spec.seriesField)){var c=null===(a=null===(r=i._nodesSeriesData)||void 0===r?void 0:r.getLatestData())||void 0===a?void 0:a.find((function(e){return t.source===e.key})),h=null==c?void 0:c.datum,d=null===(s=null===(o=i._option)||void 0===o?void 0:o.globalScale)||void 0===s?void 0:s.getScale("color");return null==d?void 0:d.scale(null==h?void 0:h[i._spec.seriesField])}var p=Z(t.source)?i.getNodeList()[t.source]:t.source;return null===(l=i._colorScale)||void 0===l?void 0:l.scale(p)},i._handleEmphasisElement=function(t){var e,n,r,a,o,s=null!==(e=i._spec.emphasis)&&void 0!==e?e:{},l=t.item;"adjacency"===s.effect?l&&l.mark===(null===(n=i._nodeMark)||void 0===n?void 0:n.getProduct())?i._handleNodeAdjacencyClick(l):l&&l.mark===(null===(r=i._linkMark)||void 0===r?void 0:r.getProduct())?i._handleLinkAdjacencyClick(l):i._handleClearEmpty():"related"===s.effect&&(l&&l.mark===(null===(a=i._nodeMark)||void 0===a?void 0:a.getProduct())?i._handleNodeRelatedClick(l):l&&l.mark===(null===(o=i._linkMark)||void 0===o?void 0:o.getProduct())?i._handleLinkRelatedClick(l):i._handleClearEmpty())},i._handleClearEmpty=function(){var t,e;if(i._needClear){var n=null===(t=i._nodeMark)||void 0===t?void 0:t.getProductElements();if(n&&n.length){var r=null===(e=i._linkMark)||void 0===e?void 0:e.getProductElements();if(r&&r.length){var a=[hU.STATE_SANKEY_EMPHASIS,hU.STATE_SANKEY_EMPHASIS_REVERSE];n.forEach((function(t){t.removeState(a)})),r.forEach((function(t){t.removeState(a)})),i._needClear=!1}}}},i._handleNodeAdjacencyClick=function(t){var e=t.getDatum(),n=[e.key];if(i._linkMark){var r=i._linkMark.getProductElements();if(!r||!r.length)return;r.forEach((function(t,i){var r=t.getDatum();r.source===e.key?(n.includes(r.target)||n.push(r.target),t.removeState(hU.STATE_SANKEY_EMPHASIS_REVERSE),t.addState(hU.STATE_SANKEY_EMPHASIS)):r.target===e.key?(n.includes(r.source)||n.push(r.source),t.removeState(hU.STATE_SANKEY_EMPHASIS_REVERSE),t.addState(hU.STATE_SANKEY_EMPHASIS)):(t.removeState(hU.STATE_SANKEY_EMPHASIS),t.addState(hU.STATE_SANKEY_EMPHASIS_REVERSE))}))}i._nodeMark&&i._highLightElements(i._nodeMark.getProductElements(),n),i._needClear=!0},i._handleLinkAdjacencyClick=function(t){var e=t.getDatum(),n=[e.source,e.target];if(i._linkMark){var r=i._linkMark.getProductElements();if(!r||!r.length)return;r.forEach((function(e){e===t?(e.removeState(hU.STATE_SANKEY_EMPHASIS_REVERSE),e.addState(hU.STATE_SANKEY_EMPHASIS,{ratio:1})):(e.removeState(hU.STATE_SANKEY_EMPHASIS),e.addState(hU.STATE_SANKEY_EMPHASIS_REVERSE))}))}i._nodeMark&&i._highLightElements(i._nodeMark.getProductElements(),n),i._needClear=!0},i._handleNodeRelatedClick=function(t){var e,n=t.getDatum(),r=i._nodeMark.getProductElements();if(r&&r.length){var a=i._linkMark.getProductElements();if(a&&a.length){var o=(null===(e=a[0].getDatum())||void 0===e?void 0:e.parents)?"parents":"source";if("source"===o){var s=[n.key],l=[];if(a.forEach((function(t,e){var i,a,o,u,c=t.getDatum(),h=(null==c?void 0:c.parents)?"parents":"source";if(xt(c[h]).includes(n.key)){if(l.includes(null!==(i=c.key)&&void 0!==i?i:c.index)||l.push(null!==(a=c.key)&&void 0!==a?a:c.index),s.includes(c.source)||s.push(c.source),!s.includes(c.target)){s.push(c.target);for(var d=r.find((function(t){return t.data[0].key===c.target})).data[0].sourceLinks,p=function(){var t=[];return d.forEach((function(e){var i,n;if(!l.includes(null!==(i=e.key)&&void 0!==i?i:e.index)&&(l.push(null!==(n=e.key)&&void 0!==n?n:e.index),!s.includes(e.target))){s.push(e.target);var a=r.find((function(t){return t.data[0].key===e.target}));t.push(a.data[0].targetLinks)}})),d=t,{value:void 0}};(null==d?void 0:d.length)>0;){var f=p();if("object"==typeof f)return f.value}}}else if(c.target===n.key&&(l.includes(null!==(o=c.key)&&void 0!==o?o:c.index)||l.push(null!==(u=c.key)&&void 0!==u?u:c.index),!s.includes(c.source))){s.push(c.source);for(var v=r.find((function(t){return t.data[0].key===c.source})).data[0].targetLinks,g=function(){var t=[];return v.forEach((function(e){var i,n;if(!l.includes(null!==(i=e.key)&&void 0!==i?i:e.index)&&(l.push(null!==(n=e.key)&&void 0!==n?n:e.index),!s.includes(e.source))){s.push(e.source);var a=r.find((function(t){return t.data[0].key===e.source}));t.push(a.data[0].targetLinks)}})),v=t,{value:void 0}};(null==v?void 0:v.length)>0;){var y=g();if("object"==typeof y)return y.value}}})),i._linkMark){var u=i._linkMark.getProductElements();if(!u||!u.length)return;u.forEach((function(t,e){var i;l.includes(null!==(i=t.getDatum().key)&&void 0!==i?i:t.getDatum().index)?(t.removeState(hU.STATE_SANKEY_EMPHASIS_REVERSE),t.addState(hU.STATE_SANKEY_EMPHASIS)):(t.removeState(hU.STATE_SANKEY_EMPHASIS),t.addState(hU.STATE_SANKEY_EMPHASIS_REVERSE))}))}i._nodeMark&&i._highLightElements(i._nodeMark.getProductElements(),s)}else{var c=[n.key],h=n.targetLinks.reduce((function(t,e){return xt(e.datum).forEach((function(e){for(var i=e.parents,r=i.length,a=function(r){var a=i[r].key,o=i[r+1]?i[r+1].key:n.key,s=e.value,l=t.find((function(t){return t.source===a&&t.target===o}));l?l.value+=s:t.push({source:a,target:o,value:s})},o=0;o<r;o++)a(o)})),t}),[]);a.forEach((function(t,e){var i=t.getDatum(),r=i.datum,a=r?r.filter((function(t){return t[o].some((function(t){return t.key===n.key}))})):null,s=h.find((function(t){return t.source===i.source&&t.target===i.target}));if(a&&a.length){c.includes(i.source)||c.push(i.source),c.includes(i.target)||c.push(i.target);var l=a.reduce((function(t,e){return t+e.value}),0),u=l/i.value;return t.removeState(hU.STATE_SANKEY_EMPHASIS_REVERSE),void t.addState(hU.STATE_SANKEY_EMPHASIS,{ratio:u})}if(s)return c.includes(i.source)||c.push(i.source),c.includes(i.target)||c.push(i.target),t.removeState(hU.STATE_SANKEY_EMPHASIS_REVERSE),void t.addState(hU.STATE_SANKEY_EMPHASIS,{ratio:s.value/i.value});t.removeState(hU.STATE_SANKEY_EMPHASIS),t.addState(hU.STATE_SANKEY_EMPHASIS_REVERSE)})),i._nodeMark&&i._highLightElements(i._nodeMark.getProductElements(),c)}i._needClear=!0}}},i._handleLinkRelatedClick=function(t){var e,n=i._nodeMark.getProductElements();if(n&&n.length){var r=i._linkMark.getProductElements();if(r&&r.length){if("source"===((null===(e=t.getDatum())||void 0===e?void 0:e.parents)?"parents":"source")){var a=[hU.STATE_SANKEY_EMPHASIS,hU.STATE_SANKEY_EMPHASIS_REVERSE];i._linkMark&&r.forEach((function(t){t.removeState(a)})),i._nodeMark&&n.forEach((function(t){t.removeState(a)}))}else{var o=t.getDatum(),s=[o.source,o.target],l=[];xt(o.datum).forEach((function(t){for(var e=t.parents,i=e.length,n=function(i){var n=e[i].key,r=e[i+1].key,a=t.value,o=l.find((function(t){return t.source===n&&t.target===r}));l.push({source:e[i].key,target:e[i+1].key,value:t.value}),o?o.value+=a:l.push({source:n,target:r,value:a})},r=0;r<i-1;r++)n(r)})),r.forEach((function(t){var e=t.getDatum(),i=e.datum;if(e.source===o.source&&e.target===o.target)return t.removeState(hU.STATE_SANKEY_EMPHASIS_REVERSE),void t.addState(hU.STATE_SANKEY_EMPHASIS,{ratio:1});var n=i?i.filter((function(t){var e=t.parents.map((function(t){return t.key}));return e.includes(o.source)&&e.includes(o.target)})):null;if(n&&n.length){s.includes(e.source)||s.push(e.source),s.includes(e.target)||s.push(e.target);var r=n.filter((function(t){return t.parents.some((function(e,i){var n;return e.key===o.source&&(null===(n=t.parents[i+1])||void 0===n?void 0:n.key)===o.target}))})).reduce((function(t,e){return t+e.value}),0),a=r/e.value;return t.removeState(hU.STATE_SANKEY_EMPHASIS_REVERSE),void t.addState(hU.STATE_SANKEY_EMPHASIS,{ratio:a})}var u=l.find((function(t){return t.source===e.source&&t.target===e.target}));if(u)return s.includes(e.source)||s.push(e.source),s.includes(e.target)||s.push(e.target),t.removeState(hU.STATE_SANKEY_EMPHASIS_REVERSE),void t.addState(hU.STATE_SANKEY_EMPHASIS,{ratio:u.value/e.value});t.removeState(hU.STATE_SANKEY_EMPHASIS),t.addState(hU.STATE_SANKEY_EMPHASIS_REVERSE)})),i._highLightElements(n,s)}i._needClear=!0}}},i}return S(i,e),Object.defineProperty(i.prototype,"direction",{get:function(){var t;return null!==(t=this._spec.direction)&&void 0!==t?t:"horizontal"},enumerable:!1,configurable:!0}),i.prototype.getCategoryField=function(){return this._categoryField},i.prototype.setCategoryField=function(t){return this._categoryField=t,this._categoryField},i.prototype.getValueField=function(){return this._valueField},i.prototype.setValueField=function(t){return this._valueField=t,this._valueField},i.prototype.setAttrFromSpec=function(){var t;e.prototype.setAttrFromSpec.call(this),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(null!==(t=this._spec.seriesField)&&void 0!==t?t:this._spec.categoryField)},i.prototype.initData=function(){var t,i,n,r,a=this;e.prototype.initData.call(this);var o=this.getViewData(),s=this.getRawData();if(s&&o){qG(this._dataSet,"sankeyLayout",t2),qG(this._dataSet,"sankeyFormat",$1),s.transform({type:"sankeyFormat"},!1),o.transform({type:"sankeyLayout",options:{view:function(){return{x0:a._viewBox.x1,x1:a._viewBox.x2,y0:a._viewBox.y1,y1:a._viewBox.y2}},sourceField:this._spec.sourceField,targetField:this._spec.targetField,valueField:this._spec.valueField,direction:this.direction,crossNodeAlign:this._spec.crossNodeAlign,nodeAlign:null!==(t=this._spec.nodeAlign)&&void 0!==t?t:"justify",nodeGap:null!==(i=this._spec.nodeGap)&&void 0!==i?i:8,nodeWidth:null!==(n=this._spec.nodeWidth)&&void 0!==n?n:10,linkWidth:this._spec.linkWidth,minStepWidth:this._spec.minStepWidth,minNodeHeight:null!==(r=this._spec.minNodeHeight)&&void 0!==r?r:4,maxNodeHeight:this._spec.maxNodeHeight,minLinkHeight:this._spec.minLinkHeight,maxLinkHeight:this._spec.maxLinkHeight,iterations:this._spec.iterations,nodeKey:this._spec.nodeKey,linkSortBy:this._spec.linkSortBy,nodeSortBy:this._spec.nodeSortBy,setNodeLayer:this._spec.setNodeLayer,dropIsolatedNode:this._spec.dropIsolatedNode,nodeHeight:this._spec.nodeHeight,linkHeight:this._spec.linkHeight,equalNodeHeight:this._spec.equalNodeHeight,linkOverlap:this._spec.linkOverlap,inverse:this._spec.inverse},level:nU.sankeyLayout});var l=this._option.dataSet;qG(l,"sankeyNodes",e2),qG(l,"flatten",A1);var u=new Ms(l,{name:"sankey-node-".concat(this.id,"-data")});u.parse([this.getViewData()],{type:"dataview"}),u.transform({type:"sankeyNodes"}),u.transform({type:"flatten",options:{callback:function(t){if(t.datum){var e=t.datum[t.depth];return A(A({},t),e)}return t}}},!1),u.transform({type:"addVChartProperty",options:{beforeCall:HY.bind(this),call:jY}},!1),this._nodesSeriesData=new DY(this._option,u),qG(l,"sankeyLinks",i2);var c=new Ms(l,{name:"sankey-link-".concat(this.id,"-data")});c.parse([this.getViewData()],{type:"dataview"}),c.transform({type:"sankeyLinks"}),c.transform({type:"addVChartProperty",options:{beforeCall:HY.bind(this),call:jY}},!1),this._linksSeriesData=new DY(this._option,c)}},i.prototype.compileData=function(){var t,i;e.prototype.compileData.call(this),null===(t=this._linksSeriesData)||void 0===t||t.compile(),null===(i=this._nodesSeriesData)||void 0===i||i.compile()},i.prototype.initMark=function(){var t,e,n,r;this._rootMark.setMarkConfig({overflow:this._spec.overflow,interactive:!!this._spec.overflow});var a=this._createMark(i.mark.node,{isSeriesMark:!0,dataView:this._nodesSeriesData.getDataView(),dataProductId:this._nodesSeriesData.getProductId(),stateSort:null===(t=this._spec.node)||void 0===t?void 0:t.stateSort},{setCustomizedShape:null===(e=this._spec.node)||void 0===e?void 0:e.customShape});a&&(a.setMarkConfig({zIndex:this._nodeLayoutZIndex}),this._nodeMark=a);var o=this._createMark(i.mark.link,{dataView:this._linksSeriesData.getDataView(),dataProductId:this._linksSeriesData.getProductId(),stateSort:null===(n=this._spec.link)||void 0===n?void 0:n.stateSort},{setCustomizedShape:null===(r=this._spec.link)||void 0===r?void 0:r.customShape});o&&(this._linkMark=o)},i.prototype._buildMarkAttributeContext=function(){e.prototype._buildMarkAttributeContext.call(this),this._markAttributeContext.valueToNode=this.valueToNode.bind(this),this._markAttributeContext.valueToLink=this.valueToLink.bind(this)},i.prototype.valueToNode=function(t){var e=this._nodesSeriesData.getLatestData(),i=xt(t)[0];return e&&e.find((function(t){return t.key===i}))},i.prototype.valueToLink=function(t){var e=this._linksSeriesData.getLatestData(),i=xt(t);return e&&e.find((function(t){return t&&t.source===i[0]&&t.target===i[1]}))},i.prototype.valueToPositionX=function(t){var e=this.valueToNode(t);return null==e?void 0:e.x0},i.prototype.valueToPositionY=function(t){var e=this.valueToNode(t);return null==e?void 0:e.y0},i.prototype.initMarkStyle=function(){this._initNodeMarkStyle(),this._initLinkMarkStyle()},i.prototype._initNodeMarkStyle=function(){var t,e,i=this._nodeMark;i&&(this.setMarkStyle(i,{x:function(t){return t.x0},x1:function(t){return t.x1},y:function(t){return t.y0},y1:function(t){return t.y1}},hU.STATE_NORMAL,CU.Mark),this.setMarkStyle(i,{fill:null!==(e=null===(t=this._spec.node.style)||void 0===t?void 0:t.fill)&&void 0!==e?e:this._fillByNode},"normal",CU.User_Mark))},i.prototype._initLinkMarkStyle=function(){var t,e,i=this._linkMark;i&&(this.setMarkStyle(i,{x0:function(t){return t.x0},x1:function(t){return t.x1},y0:function(t){return t.y0},y1:function(t){return t.y1},thickness:function(t){return t.thickness},direction:this.direction},hU.STATE_NORMAL,CU.Series),this.setMarkStyle(i,{fill:null!==(e=null===(t=this._spec.link.style)||void 0===t?void 0:t.fill)&&void 0!==e?e:this._fillByLink},"normal",CU.User_Mark))},i.prototype.initLabelMarkStyle=function(t,e){var i=this;if(t){var n=e.position;n&&n.includes("inside")?this.setMarkStyle(t,{fill:"#ffffff",text:function(t){return i._createText(t,e)},maxLineWidth:function(t){var i;return null!==(i=e.limit)&&void 0!==i?i:t.x1-t.x0}}):this.setMarkStyle(t,{fill:this._fillByNode,text:function(t){return i._createText(t,e)},maxLineWidth:e.limit}),t.setMarkConfig({zIndex:this._labelLayoutZIndex})}},i.prototype._createText=function(t,e){if(j(t)||j(t.datum))return"";var i=t.datum[this._spec.categoryField]||"",n=e||{},r=xY(n.formatMethod,n.formatter,i,t.datum),a=r.formatFunc,o=r.args;return a&&(i=a.apply(void 0,P(P([],E(o),!1),[{series:this}],!1))),i},i.prototype.initAnimation=function(){var t,e,i,n,r=this,a={direction:this.direction,growFrom:function(){var t,e;return"horizontal"===r.direction?null===(t=r._xAxisHelper)||void 0===t?void 0:t.getScale(0).scale(0):null===(e=r._yAxisHelper)||void 0===e?void 0:e.getScale(0).scale(0)}},o=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this._nodeMark&&this._nodeMark.setAnimationConfig(cX(null===(i=kz.getAnimationInKey("sankeyNode"))||void 0===i?void 0:i(a,o),hX("node",this._spec,this._markAttributeContext))),this._linkMark&&this._linkMark.setAnimationConfig(cX(null===(n=kz.getAnimationInKey("sankeyLinkPath"))||void 0===n?void 0:n(a,o),hX("link",this._spec,this._markAttributeContext)))},i.prototype.initEvent=function(){var t,i,n;e.prototype.initEvent.call(this),null===(t=this._nodesSeriesData.getDataView())||void 0===t||t.target.addListener("change",this.nodesSeriesDataUpdate.bind(this)),null===(i=this._linksSeriesData.getDataView())||void 0===i||i.target.addListener("change",this.linksSeriesDataUpdate.bind(this));var r=null!==(n=this._spec.emphasis)&&void 0!==n?n:{};if(!0!==this._option.disableTriggerEvent&&r.enable&&("adjacency"===r.effect||"related"===r.effect)){var a="hover"===r.trigger?"pointerover":"pointerdown";this.event.on(a,{level:dG.chart},this._handleEmphasisElement)}},i.prototype.nodesSeriesDataUpdate=function(){this._nodesSeriesData.updateData(),this._nodeList=null,this._setNodeOrdinalColorScale()},i.prototype.linksSeriesDataUpdate=function(){this._linksSeriesData.updateData()},i.prototype._highLightElements=function(t,e){t&&t.length&&t.forEach((function(t){t.removeState([hU.STATE_SANKEY_EMPHASIS_REVERSE,hU.STATE_SANKEY_EMPHASIS]),e.includes(t.getDatum().key)?t.addState(hU.STATE_SANKEY_EMPHASIS):t.addState(hU.STATE_SANKEY_EMPHASIS_REVERSE)}))},i.prototype.initTooltip=function(){this._tooltipHelper=new n2(this),this._nodeMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._nodeMark),this._linkMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._linkMark)},i.prototype._setNodeOrdinalColorScale=function(){var t,e,i,n,r,a=null===(e=null===(t=this._option)||void 0===t?void 0:t.globalScale)||void 0===e?void 0:e.getScale("color");if(null==a?void 0:a._specified)this._colorScale=a;else{var o,s;a&&(o=a.domain(),s=a.range()),s||(s=this._getDataScheme()),o&&!j(o[0])||(o=this.getNodeList()).length>10&&(s=null===(i=this._getDataScheme()[1])||void 0===i?void 0:i.scheme);var l=new hF;null===(r=(n=l.domain(o)).range)||void 0===r||r.call(n,s),this._colorScale=l}},i.prototype.getNodeList=function(){var t,e,i=this;if(this._nodeList)return this._nodeList;var n=this._rawData.latestData[0],r=(null==n?void 0:n.nodes)?(null===(t=n.nodes[0])||void 0===t?void 0:t.children)?Array.from(this.extractNamesFromTree(n.nodes,this._spec.categoryField)):n.nodes.map((function(t,e){return t[i._spec.categoryField]})):(null==n?void 0:n.links)?Array.from(this.extractNamesFromLink(n.links)):null===(e=null==n?void 0:n.values)||void 0===e?void 0:e.map((function(t,e){return t[i._spec.categoryField]}));return this._nodeList=r,r},i.prototype._getNodeNameFromData=function(t){var e;return(null==t?void 0:t.datum)?t.datum[this._spec.categoryField]:null!==(e=t.key)&&void 0!==e?e:t[this._spec.categoryField]},i.prototype.extractNamesFromTree=function(t,e){var i=this,n=new Set;return t.forEach((function(t){(n.add(t[e]),t.children)&&i.extractNamesFromTree(t.children,e).forEach((function(t){return n.add(t)}))})),n},i.prototype.extractNamesFromLink=function(t){var e=new Set,i=this._spec,n=i.sourceField,r=i.targetField;return t.forEach((function(t){N(t[n])&&e.add(t[n]),N(t[r])&&e.add(t[r])})),e},i.prototype.getDimensionField=function(){return[this._spec.categoryField]},i.prototype.getMeasureField=function(){return[this._valueField]},i.prototype.getRawDataStatisticsByField=function(t,e){var i;(this._rawStatisticsCache||(this._rawStatisticsCache={}),this._rawStatisticsCache[t])||(this._viewDataStatistics&&this.getViewData().transformsArr.length<=1&&(null===(i=this._viewDataStatistics.latestData)||void 0===i?void 0:i[t])?this._rawStatisticsCache[t]=this._viewDataStatistics.latestData[t]:this._rawData&&(this._rawStatisticsCache[t]={values:this._collectByField(t)}));return this._rawStatisticsCache[t]},i.prototype._collectByField=function(t){var e,i,n,r=this,a=[],o=null===(i=null===(e=this.getRawData())||void 0===e?void 0:e.latestData)||void 0===i?void 0:i[0];if(!o)return[];if(o.links)(null===(n=o.nodes)||void 0===n?void 0:n.length)&&o.nodes.forEach((function(t){t[r._seriesField]&&a.push(t[r._seriesField])}));else if(o.nodes){var s=new Set;return Q1(s,o.nodes,this._seriesField),Array.from(s)}return a},i.prototype.onLayoutEnd=function(t){e.prototype.onLayoutEnd.call(this,t),this._viewBox.set(0,0,this._region.getLayoutRect().width,this._region.getLayoutRect().height),this.getViewData().reRunAllTransform()},i.prototype.getDefaultShapeType=function(){return"square"},i.prototype._noAnimationDataKey=function(t,e){},i.prototype.getActiveMarks=function(){return[this._nodeMark,this._linkMark]},i.prototype.getMarkData=function(t){return t.datum?X(t.datum)?t.datum[t.datum.length-1]:t.datum:t},i.type=t.SeriesTypeEnum.sankey,i.transformerConstructor=c2,i.mark=u2,i}(SX),d2=function(){xj.registerTransform("sankey",{transform:J1,markPhase:"beforeJoin"},!0),pq(),l2(),dJ(),kz.registerAnimation("sankeyNode",(function(t,e){return A({appear:a2(t,e)},tX)})),kz.registerAnimation("sankeyLinkPath",(function(t,e){return{appear:o2(e),enter:{type:"linkPathGrowIn"},exit:{type:"linkPathGrowOut"},disappear:{type:"linkPathGrowOut"}}})),iX(),kz.registerSeries(h2.type,h2)},p2=function(t,e){var i={},n=e.fields;if(H(n)&&(n=n()),!(null==n?void 0:n.length)||!(null==t?void 0:t.length))return i;if(!t[0].latestData)return i;var r=t[0].latestData,a=A1(r);return i=BY([{latestData:a}],e)},f2=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.markTooltipKeyCallback=function(t){var i,n;return null===(n=null===(i=e.series)||void 0===i?void 0:i.getMarkData(t))||void 0===n?void 0:n[e.series.getDimensionField()[0]]},e.markTooltipValueCallback=function(t){var i,n,r=e._seriesCacheInfo.measureFields,a=null===(i=e.series)||void 0===i?void 0:i.getMarkData(t);if(r[0]&&a)return null!==(n=a[r[0]])&&void 0!==n?n:t.value},e.dimensionTooltipTitleCallback=function(t){var i,n=e._seriesCacheInfo.dimensionFields,r=null===(i=e.series)||void 0===i?void 0:i.getMarkData(t);if(n[0]&&r)return r[n[0]]},e}return S(e,t),Object.defineProperty(e.prototype,"defaultShapeType",{get:function(){return"square"},enumerable:!1,configurable:!0}),e}(PY),v2=A(A({},WY),((Z1={}).nonLeaf={name:"nonLeaf",type:"rect"},Z1.leaf={name:"leaf",type:"rect"},Z1.nonLeafLabel={name:"nonLeafLabel",type:"text"},Z1)),g2=function(t){return"fadeIn"===t?{type:"fadeIn"}:{type:"growCenterIn"}},y2=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"nonLeaf","nonLeafLabel","initNonLeafLabelMarkStyle"),this._addMarkLabelSpec(t,"leaf")},e}(mX),m2=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.treemap,i.transformerConstructor=y2,i._categoryField="name",i._valueField="value",i._viewBox=new di,i._enableAnimationHook=i.enableMarkAnimation.bind(i),i.isHierarchyData=function(){return!0},i}return S(i,e),i.prototype.getCategoryField=function(){return this._categoryField},i.prototype.setCategoryField=function(t){return this._categoryField=t,this._categoryField},i.prototype.getValueField=function(){return this._valueField},i.prototype.setValueField=function(t){return this._valueField=t,this._valueField},i.prototype.setAttrFromSpec=function(){var t,i=this;e.prototype.setAttrFromSpec.call(this),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(null!==(t=this._spec.seriesField)&&void 0!==t?t:FY),this._spec.roam&&(this.initZoomable(this.event,this._option.mode),this._matrix=new vi),this._spec.drill&&this.initDrillable({event:this.event,mode:this._option.mode,drillField:function(){var t,e;return null!==(e=null!==(t=i._spec.drillField)&&void 0!==t?t:i._categoryField)&&void 0!==e?e:Yz},getRawData:function(){return i.getRawData()}}),Q(this._spec.maxDepth)&&(this._maxDepth=this._spec.maxDepth-1)},i.prototype.initData=function(){e.prototype.initData.call(this),this.getViewData()&&this._spec.drill&&this.initDrillableData(this._dataSet)},i.prototype.compile=function(){e.prototype.compile.call(this),this._runTreemapTransform()},i.prototype._runTreemapTransform=function(t){var e,i,n,r,a=this;void 0===t&&(t=!1);var o=this._data.getProduct();o&&o.transform([{type:"treemap",nameField:this._categoryField,valueField:this._valueField,x0:this._viewBox.x1,x1:this._viewBox.x2,y0:this._viewBox.y1,y1:this._viewBox.y2,maxDepth:this._maxDepth,gapWidth:this._spec.gapWidth,padding:this._spec.nodePadding,splitType:this._spec.splitType,aspectRatio:this._spec.aspectRatio,labelPadding:(null===(e=this._spec.nonLeafLabel)||void 0===e?void 0:e.visible)?null===(i=this._spec.nonLeafLabel)||void 0===i?void 0:i.padding:0,labelPosition:null===(n=this._spec.nonLeafLabel)||void 0===n?void 0:n.position,minVisibleArea:null!==(r=this._spec.minVisibleArea)&&void 0!==r?r:10,minChildrenVisibleArea:this._spec.minChildrenVisibleArea,minChildrenVisibleSize:this._spec.minChildrenVisibleSize,flatten:!0},{type:"map",callback:function(t){return t&&[FY,"name"].forEach((function(e){t[e]=t.datum[t.depth][a._categoryField]})),t}}]),t&&this.getCompiler().renderNextTick()},i.prototype._addDataIndexAndKey=function(){var t;(null===(t=this._rawData)||void 0===t?void 0:t.dataSet)&&(qG(this._rawData.dataSet,"addVChartProperty",_Y),this._rawData.transform({type:"addVChartProperty",options:{beforeCall:NY.bind(this),call:VY}}))},i.prototype.getRawDataStatisticsByField=function(t,e){var i;if(this._rawStatisticsCache||(this._rawStatisticsCache={}),!this._rawStatisticsCache[t]&&this._rawData){var n=p2([this._rawData],{fields:[{key:t,operations:e?["min","max"]:["values"]}]})[t];this._rawStatisticsCache[t]=ft(null!==(i=this._rawStatisticsCache[t])&&void 0!==i?i:{},n)}return this._rawStatisticsCache[t]},i.prototype._createHierarchyDataStatistics=function(t,e){var i=this;qG(this._dataSet,"hierarchyDimensionStatistics",p2),qG(this._dataSet,"flatten",A1);var n=new Ms(this._dataSet,{name:t});return n.parse(e,{type:"dataview"}),n.transform({type:"hierarchyDimensionStatistics",options:{fields:function(){var t=i.getStatisticFields();return i._seriesField&&i._seriesField!==i._categoryField&&t.push({key:i._seriesField,operations:["values"]}),t}}},!1),n},i.prototype.getStatisticFields=function(){return R1(e.prototype.getStatisticFields.call(this),this._categoryField,this._valueField)},i.prototype.initMark=function(){var t,e,n,r,a=this,o=this._createMark(i.mark.nonLeaf,{isSeriesMark:!0,stateSort:null===(t=this._spec.nonLeaf)||void 0===t?void 0:t.stateSort},{setCustomizedShape:null===(e=this._spec.nonLeaf)||void 0===e?void 0:e.customShape});o&&(o.setTransform([{type:"filter",callback:function(t){return!a._shouldFilterElement(t,"nonLeaf")}}]),this._nonLeafMark=o);var s=this._createMark(i.mark.leaf,{isSeriesMark:!0,stateSort:null===(n=this._spec.leaf)||void 0===n?void 0:n.stateSort},{setCustomizedShape:null===(r=this._spec.leaf)||void 0===r?void 0:r.customShape});s&&(s.setTransform([{type:"filter",callback:function(t){return!a._shouldFilterElement(t,"leaf")}}]),this._leafMark=s)},i.prototype.initMarkStyle=function(){this._initLeafMarkStyle(),this._initNonLeafMarkStyle()},i.prototype._initLeafMarkStyle=function(){this._leafMark&&this.setMarkStyle(this._leafMark,{x:function(t){return t.x0},y:function(t){return t.y0},x1:function(t){return t.x1},y1:function(t){return t.y1},fill:this.getColorAttribute()},hU.STATE_NORMAL,CU.Series)},i.prototype._initNonLeafMarkStyle=function(){this._nonLeafMark&&this.setMarkStyle(this._nonLeafMark,{x:function(t){return t.x0},y:function(t){return t.y0},x1:function(t){return t.x1},y1:function(t){return t.y1},fill:this.getColorAttribute()},hU.STATE_NORMAL,CU.Series)},i.prototype._initRichStyleOfLabelMark=function(t){"rich"===t.getTextType()&&this.setMarkStyle(t,{maxWidth:function(t){return Math.abs(t.x0-t.x1)},maxHeight:function(t){return Math.abs(t.y0-t.y1)},ellipsis:!0},hU.STATE_NORMAL,CU.Series)},i.prototype.initLabelMarkStyle=function(t){var e=this;t&&(this._labelMark=t,t.setRule("treemap"),this.setMarkStyle(t,{x:function(t){return(t.x0+t.x1)/2},y:function(t){return(t.y0+t.y1)/2},text:function(t){var i;return null===(i=t.datum[t.depth])||void 0===i?void 0:i[e.getDimensionField()[0]]},maxLineWidth:function(t){return t.x1===t.x0?Number.MIN_VALUE:t.x1-t.x0}},hU.STATE_NORMAL,CU.Series),this._initRichStyleOfLabelMark(t))},i.prototype.initNonLeafLabelMarkStyle=function(t){var e=this;t&&(this._nonLeafLabelMark=t,t.setRule("treemap"),this.setMarkStyle(t,{x:function(t){return t.labelRect?(t.labelRect.x0+t.labelRect.x1)/2:(t.x0+t.x1)/2},y:function(t){return t.labelRect?(t.labelRect.y0+t.labelRect.y1)/2:(t.y0+t.y1)/2},text:function(t){var i;return null===(i=t.datum[t.depth])||void 0===i?void 0:i[e.getDimensionField()[0]]},maxLineWidth:function(t){return t.x1===t.x0?Number.MIN_VALUE:t.x1-t.x0}},hU.STATE_NORMAL,CU.Series),this._initRichStyleOfLabelMark(t))},i.prototype.initAnimation=function(){var t=this;this.getMarksInType("rect").forEach((function(e){var i;e.setAnimationConfig(cX(null===(i=kz.getAnimationInKey("treemap"))||void 0===i?void 0:i(),hX(e.name,t._spec,t._markAttributeContext)))}))},i.prototype.initEvent=function(){var t=this;e.prototype.initEvent.call(this),this._spec.roam&&(this.initDragEventOfSeries(this),this.event.on("panmove",(function(e){t.handlePan(e)})),this.initZoomEventOfSeries(this),this.event.on("zoom",(function(e){t.handleZoom(e)}))),this._spec.drill&&this.bindDrillEvent()},i.prototype._getDataIdKey=function(){return"key"},i.prototype.initTooltip=function(){this._tooltipHelper=new f2(this),this._leafMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._leafMark),this._nonLeafMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._nonLeafMark)},i.prototype._shouldFilterElement=function(t,e){var i=t.isLeaf;return"leaf"===e?!i:i},i.prototype.handlePan=function(t){var e=t.delta;if(0!==e[0]||0!==e[1]){this._matrix.reset(),this._matrix.translate(e[0],e[1]);var i=this._matrix,n=i.a,r=i.b,a=i.c,o=i.d,s=i.e,l=i.f;this._matrix.multiply(n,r,a,o,s,l),this._viewBox.transformWithMatrix(this._matrix),this._runTreemapTransform(!0)}},i.prototype.handleZoom=function(t){var e=t.scale,i=t.scaleCenter;if(1!==e){this._matrix.reset();var n=i.x,r=i.y;this._matrix.translate(n,r),this._matrix.scale(e,e),this._matrix.translate(-n,-r);var a=this._matrix,o=a.a,s=a.b,l=a.c,u=a.d,c=a.e,h=a.f;this._matrix.multiply(o,s,l,u,c,h),this.disableMarkAnimation(),this.event.on(DH.AFTER_DO_RENDER,this._enableAnimationHook),this._viewBox.transformWithMatrix(this._matrix),this._runTreemapTransform(!0)}},i.prototype.getDimensionField=function(){return[this._categoryField]},i.prototype.getMeasureField=function(){return[this._valueField]},i.prototype.onLayoutEnd=function(t){e.prototype.onLayoutEnd.call(this,t),this._viewBox.set(0,0,this.getLayoutRect().width,this.getLayoutRect().height),this._runTreemapTransform()},i.prototype.enableMarkAnimation=function(){this.getMarks().forEach((function(t){var e;null===(e=t.getProduct().animate)||void 0===e||e.enable()})),[this._labelMark,this._nonLeafLabelMark].forEach((function(t){t&&t.getComponent()&&t.getComponent().getProduct().getGroupGraphicItem().enableAnimation()})),this.event.off(DH.AFTER_DO_RENDER,this._enableAnimationHook)},i.prototype.disableMarkAnimation=function(){this.getMarks().forEach((function(t){var e;null===(e=t.getProduct().animate)||void 0===e||e.disable()})),[this._labelMark,this._nonLeafLabelMark].forEach((function(t){t&&t.getComponent()&&t.getComponent().getProduct().getGroupGraphicItem().disableAnimation()}))},i.prototype.getDefaultShapeType=function(){return"square"},i.prototype.getActiveMarks=function(){return[this._nonLeafMark,this._leafMark]},i.prototype.getMarkData=function(t){return(null==t?void 0:t.datum)?t.datum[t.datum.length-1]:t},i.type=t.SeriesTypeEnum.treemap,i.mark=v2,i.transformerConstructor=y2,i}(SX);bt(m2,E1),bt(m2,_Z);var _2,b2,x2=function(){xj.registerTransform("filter",{transform:IV,markPhase:"beforeJoin"},!0),xj.registerTransform("map",{transform:LV,markPhase:"beforeJoin"},!0),pq(),dJ(),kz.registerAnimation("treemap",(function(t,e){return{appear:g2(e),enter:{type:"growCenterIn"},exit:{type:"growCenterOut"},disappear:{type:"growCenterOut"}}})),iX(),xj.registerTransform("treemap",{transform:n1,markPhase:"beforeJoin"},!0),kz.registerSeries(m2.type,m2)},k2=A(A({},KQ),((_2={}).segment={name:"segment",type:"arc"},_2.track={name:"track",type:"arc"},_2)),S2=A(A({},WY),((b2={}).pin={name:"pin",type:"path"},b2.pinBackground={name:"pinBackground",type:"path"},b2.pointer={name:"pointer",type:["path","rect"]},b2)),A2={type:"fadeIn"};function M2(t,e){return"fadeIn"===e?A2:function(t){return{channel:{angle:{from:t.startAngle+Math.PI/2}}}}(t)}var w2=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._supportStack=!1,e}return S(e,t),e}(mX),T2=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype.enableByType=function(t){return"dimension"!==t},e}(PY),C2=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.gaugePointer,i.transformerConstructor=w2,i._pinMark=null,i._pointerMark=null,i._pinBackgroundMark=null,i}return S(i,e),i.prototype.setAttrFromSpec=function(){var t;e.prototype.setAttrFromSpec.call(this),this.setRadiusField(this._spec.radiusField),this._pointerType="rect"===(null===(t=this._spec.pointer)||void 0===t?void 0:t.type)?"rect":"path"},i.prototype.initMark=function(){this._pinBackgroundMark=this._createMark(i.mark.pinBackground),this._pointerMark=this._createMark(A(A({},i.mark.pointer),{type:this._pointerType}),{isSeriesMark:!0}),this._pinMark=this._createMark(i.mark.pin)},i.prototype.initMarkStyle=function(){this.initPinBackgroundMarkStyle(),this.initPointerMarkStyle(),this.initPinMarkStyle()},i.prototype.initGroups=function(){},i.prototype.initPointerMarkStyle=function(){var t=this,e=this._pointerMark,i=this._spec.pointer;e&&(this.setMarkStyle(e,{x:function(e){var n,r;return t._getPointerAnchor(e,i).x-t._getPointerWidth()*(null!==(r=null===(n=null==i?void 0:i.center)||void 0===n?void 0:n[0])&&void 0!==r?r:0)},y:function(e){var n,r;return t._getPointerAnchor(e,i).y-t._getPointerHeight(e)*(null!==(r=null===(n=null==i?void 0:i.center)||void 0===n?void 0:n[1])&&void 0!==r?r:0)},anchor:function(e){var n=t._getPointerAnchor(e,i);return[n.x,n.y]},fill:this.getColorAttribute(),zIndex:200}),"path"===this._pointerType?this.setMarkStyle(e,{scaleX:this._getPointerWidth.bind(this),scaleY:this._getPointerHeight.bind(this),angle:function(e){return t._getPointerAngle(e)+Math.PI/2}}):this.setMarkStyle(e,{width:this._getPointerWidth.bind(this),height:this._getPointerHeight.bind(this),angle:function(e){return t._getPointerAngle(e)-Math.PI/2}}))},i.prototype.initTooltip=function(){this._tooltipHelper=new T2(this),this._pointerMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._pointerMark)},i.prototype._getPointerAnchor=function(t,e){var i;return null===(i=e.isOnCenter)||void 0===i||i?this.angleAxisHelper.center():this.radiusAxisHelper.coordToPoint({radius:this._innerRadius*this._computeLayoutRadius(),angle:this.angleAxisHelper.dataToPosition([t[this._angleField[0]]])})},i.prototype._getPointerWidth=function(){return this._spec.pointer.width*this._computeLayoutRadius()},i.prototype._getPointerHeight=function(t){var e,i,n=this._spec.pointer,r=this._radiusField[0];return N(this.radiusAxisHelper)&&N(r)?this.radiusAxisHelper.dataToPosition([t[r]])-(null!==(e=null==n?void 0:n.innerPadding)&&void 0!==e?e:0)-(null!==(i=null==n?void 0:n.outerPadding)&&void 0!==i?i:10):n.height*this._computeLayoutRadius()},i.prototype._getPointerAngle=function(t){var e=this.angleAxisHelper.getScale().domain(),i=St(e),n=At(e),r=Ut(t[this._angleField[0]],n,i);return this.angleAxisHelper.dataToPosition([r])},i.prototype._getRotatedPointerCenterOffset=function(t){var e,i,n,r,a=this._spec.pointer,o=this._getPointerWidth()*(null!==(i=null===(e=null==a?void 0:a.center)||void 0===e?void 0:e[0])&&void 0!==i?i:0),s=-this._getPointerHeight(t)*(null!==(r=null===(n=null==a?void 0:a.center)||void 0===n?void 0:n[1])&&void 0!==r?r:0),l=this._getPointerAngle(t)-Math.PI/2,u=Math.cos(l),c=Math.sin(l);return{x:o*u+s*c,y:-(s*u-o*c)}},i.prototype.initPinBackgroundMarkStyle=function(){var t=this,e=this._pinBackgroundMark,i=this._spec.pinBackground;e&&this.setMarkStyle(e,{x:function(e){return t._getPointerAnchor(e,i).x},y:function(e){return t._getPointerAnchor(e,i).y},scaleX:function(){return i.width*t._computeLayoutRadius()},scaleY:function(){return i.height*t._computeLayoutRadius()},fill:this.getColorAttribute(),zIndex:100})},i.prototype.initPinMarkStyle=function(){var t=this,e=this._pinMark,i=this._spec.pin;e&&this.setMarkStyle(e,{x:function(e){return t._getPointerAnchor(e,i).x},y:function(e){return t._getPointerAnchor(e,i).y},scaleX:function(){return i.width*t._computeLayoutRadius()},scaleY:function(){return i.height*t._computeLayoutRadius()},fill:this.getColorAttribute(),zIndex:300})},i.prototype.initInteraction=function(){this._parseInteractionConfig(this._pointerMark?[this._pointerMark]:[])},i.prototype.initAnimation=function(){var t,e,i,n=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this._pointerMark.setAnimationConfig(cX(null===(i=kz.getAnimationInKey("gaugePointer"))||void 0===i?void 0:i({startAngle:this._startAngle},n),hX("pointer",this._spec,this._markAttributeContext)))},i.prototype.getDefaultShapeType=function(){return"circle"},i.prototype.getActiveMarks=function(){return[]},i.type=t.SeriesTypeEnum.gaugePointer,i.mark=S2,i.transformerConstructor=w2,i}(qQ),E2=function(){kz.registerSeries(C2.type,C2),dZ(),pq(),kz.registerAnimation("gaugePointer",(function(t,e){var i=M2(t,e);return{appear:i,enter:i,disappear:{type:"fadeOut"}}})),bQ(),mQ()},P2=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._supportStack=!1,e}return S(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"segment")},e}(mX),R2=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.gauge,i.transformerConstructor=P2,i._segmentMark=null,i._trackMark=null,i._padAngle=0,i}return S(i,e),i.prototype.setAttrFromSpec=function(){var t;e.prototype.setAttrFromSpec.call(this),this._padAngle=we(null!==(t=this._spec.padAngle)&&void 0!==t?t:0)},i.prototype.initData=function(){var t,i=this;e.prototype.initData.call(this);qG(this._option.dataSet,"spiltSegment",(function(t,e){var n=t.slice();return n.sort((function(t,e){return t[i._angleField[0]]-e[i._angleField[0]]})),n.forEach((function(t,e){t[hH]=t[i._angleField[0]],t[cH]=e>0?n[e-1][hH]:void 0})),n})),null===(t=this.getViewData())||void 0===t||t.transform({type:"spiltSegment"},!1)},i.prototype.initMark=function(){e.prototype.initMark.call(this),this._trackMark=this._createMark(i.mark.track,{parent:this._arcGroupMark,dataView:!1}),this._segmentMark=this._createMark(i.mark.segment,{parent:this._arcGroupMark,isSeriesMark:!0})},i.prototype.initMarkStyle=function(){e.prototype.initMarkStyle.call(this),this.initTrackMarkStyle(),this.initSegmentMarkStyle()},i.prototype.initSegmentMarkStyle=function(){var t,e=this,i=this._segmentMark;i&&this.setMarkStyle(i,{x:function(){return e.angleAxisHelper.center().x},y:function(){return e.angleAxisHelper.center().y},startAngle:this._getAngleValueStart.bind(this),endAngle:this._getAngleValueEnd.bind(this),innerRadius:function(){var t;return e._computeLayoutRadius()*(null!==(t=e._spec.innerRadius)&&void 0!==t?t:0)},outerRadius:function(){var t,i;return e._computeLayoutRadius()*(null!==(i=null!==(t=e._spec.radius)&&void 0!==t?t:e._spec.outerRadius)&&void 0!==i?i:1)},cap:null!==(t=this._spec.roundCap)&&void 0!==t&&t,boundsMode:"imprecise",cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute(),zIndex:200,forceShowCap:!0})},i.prototype.generateRadiusStyle=function(t){var e=this;if(t){var i={};return t.outerRadius&&(i.outerRadius=function(){return e._computeLayoutRadius()*t.outerRadius}),t.innerRadius&&(i.innerRadius=function(){return e._computeLayoutRadius()*t.innerRadius}),i}},i.prototype.initMarkStyleWithSpec=function(t,i,n){if(e.prototype.initMarkStyleWithSpec.call(this,t,i,n),t&&"segment"===t.name){var r=this.getSpec().segment;if(r)for(var a in r.state||{})this.setMarkStyle(t,this.generateRadiusStyle(r.state[a]),a,CU.User_Mark)}},i.prototype.initTooltip=function(){e.prototype.initTooltip.call(this),this._segmentMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._segmentMark)},i.prototype.initTrackMarkStyle=function(){var t,e=this,i=this._trackMark;i&&this.setMarkStyle(i,{x:function(){return e.angleAxisHelper.center().x},y:function(){return e.angleAxisHelper.center().y},startAngle:this._startAngle,endAngle:this._endAngle,innerRadius:function(){var t;return e._computeLayoutRadius()*(null!==(t=e._spec.innerRadius)&&void 0!==t?t:0)},outerRadius:function(){var t,i;return e._computeLayoutRadius()*(null!==(i=null!==(t=e._spec.radius)&&void 0!==t?t:e._spec.outerRadius)&&void 0!==i?i:1)},cap:null!==(t=this._spec.roundCap)&&void 0!==t&&t,boundsMode:"imprecise",cornerRadius:this._spec.cornerRadius,zIndex:100})},i.prototype._getAngleValueStartWithoutMask=function(t){var e=this._getAngleValueStartWithoutPadAngle(t),i=this._getAngleValueEndWithoutPadAngle(t),n=Xt(e,(e+i)/2)(e+(i>e?1:-1)*Math.abs(this._padAngle/2));return this._spec.clamp?fF(n,this.angleAxisHelper.getScale(0)):n},i.prototype._getAngleValueEndWithoutMask=function(t){var e=this._getAngleValueStartWithoutPadAngle(t),i=this._getAngleValueEndWithoutPadAngle(t),n=Xt(i,(e+i)/2)(i-(i>e?1:-1)*Math.abs(this._padAngle/2));return this._spec.clamp?fF(n,this.angleAxisHelper.getScale(0)):n},i.prototype._getAngleValueStartWithoutPadAngle=function(t){return N(t[cH])?this.angleAxisHelper.dataToPosition([t[cH]]):this._startAngle},i.prototype._getAngleValueEndWithoutPadAngle=function(t){return this.angleAxisHelper.dataToPosition([t[hH]])},i.prototype.initAnimation=function(){var t,e,i,n=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this._segmentMark.setAnimationConfig(cX(null===(i=kz.getAnimationInKey("circularProgress"))||void 0===i?void 0:i({startAngle:this._startAngle},n),hX("segment",this._spec,this._markAttributeContext)))},i.prototype.getDefaultShapeType=function(){return"circle"},i.prototype.getActiveMarks=function(){return[]},i.type=t.SeriesTypeEnum.gauge,i.mark=k2,i.transformerConstructor=P2,i}(qQ),B2=function(){kz.registerSeries(R2.type,R2),YJ(),$Q(),mQ()},I2=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return S(e,t),e.prototype._getDefaultStyle=function(){return A(A({},t.prototype._getDefaultStyle.call(this)),{padding:0})},e.type="cell",e}(BX),L2=function(){kz.registerMark(I2.type,I2),CP(),PP(),PL(),xj.registerGraphic(MH.cell,Ng),xj.registerMark(MH.cell,JW)};function D2(t){return!1===t?{}:{type:"fadeIn"}}var O2,F2,z2=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype.enableByType=function(t){return"dimension"!==t},e}(PY),H2=A(A({},WY),((O2={}).cell={name:"cell",type:"cell"},O2.cellBackground={name:"cellBackground",type:"cell"},O2)),j2=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"cell")},e}(mX),N2=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.heatmap,i.transformerConstructor=j2,i}return S(i,e),i.prototype.getFieldValue=function(){return this._fieldValue},i.prototype.setFieldValue=function(t){this._fieldValue=xt(t)},i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),this.setFieldValue(this._spec.valueField)},i.prototype.initMark=function(){var t,e,n,r,a={progressiveStep:this._spec.progressiveStep,progressiveThreshold:this._spec.progressiveThreshold,large:this._spec.large,largeThreshold:this._spec.largeThreshold};this._cellMark=this._createMark(i.mark.cell,{isSeriesMark:!0,stateSort:null===(t=this._spec.cell)||void 0===t?void 0:t.stateSort},A(A({},a),{setCustomizedShape:null===(e=this._spec.cell)||void 0===e?void 0:e.customShape,morph:fX(this._spec,i.mark.cell.name),morphElementKey:this.getDimensionField()[0]})),this._backgroundMark=this._createMark(i.mark.cellBackground,{stateSort:null===(n=this._spec.cellBackground)||void 0===n?void 0:n.stateSort},A(A({},a),{setCustomizedShape:null===(r=this._spec.cellBackground)||void 0===r?void 0:r.customShape}))},i.prototype.initMarkStyle=function(){this.initCellMarkStyle(),this.initCellBackgroundMarkStyle()},i.prototype.initLabelMarkStyle=function(t){var e=this;t&&this.setMarkStyle(t,{fill:this.getColorAttribute(),text:function(t){return t[e.getMeasureField()[0]]}})},i.prototype.initCellMarkStyle=function(){var t=this;this.setMarkStyle(this._cellMark,{x:function(e){return t.dataToPositionX(e)},y:function(e){return t.dataToPositionY(e)},size:function(){return[t.getCellSize(t._xAxisHelper),t.getCellSize(t._yAxisHelper)]},fill:this.getColorAttribute()},"normal",CU.Series)},i.prototype.initCellBackgroundMarkStyle=function(){var t,e,i,n=this,r=Ei(null!==(i=null===(e=null===(t=this._spec.cellBackground)||void 0===t?void 0:t.style)||void 0===e?void 0:e.padding)&&void 0!==i?i:0);this.setMarkStyle(this._backgroundMark,{x:function(t){var e=n.getCellSize(n._xAxisHelper);return n.dataToPositionX(t)-e/2+r[3]},y:function(t){var e=n.getCellSize(n._yAxisHelper);return n.dataToPositionY(t)-e/2+r[0]},width:function(){return n.getCellSize(n._xAxisHelper)-r[1]-r[3]},height:function(){return n.getCellSize(n._yAxisHelper)-r[0]-r[2]}},"normal",CU.Series)},i.prototype.getColorAttribute=function(){var t;return{scale:null!==(t=this._option.globalScale.getScale("color"))&&void 0!==t?t:this._getDefaultColorScale(),field:this.getFieldValue[0]}},i.prototype.initInteraction=function(){this._parseInteractionConfig(this._cellMark?[this._cellMark]:[])},i.prototype.initAnimation=function(){var t,e,i,n=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset,r=xX(this);this._cellMark.setAnimationConfig(cX(null===(i=kz.getAnimationInKey("heatmap"))||void 0===i?void 0:i(n),hX("cell",this._spec,this._markAttributeContext),r))},i.prototype.getCellSize=function(t){var e,i;return null!==(i=null===(e=t.getBandwidth)||void 0===e?void 0:e.call(t,0))&&void 0!==i?i:6},i.prototype.initTooltip=function(){this._tooltipHelper=new z2(this),this._cellMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._cellMark)},i.prototype.getDefaultShapeType=function(){return"square"},i.prototype.getDimensionField=function(){return[].concat(this.fieldX,this.fieldY)},i.prototype.getMeasureField=function(){return this.getFieldValue()},i.prototype.getActiveMarks=function(){return[this._cellMark]},i.type=t.SeriesTypeEnum.heatmap,i.mark=H2,i.transformerConstructor=j2,i}(SX),V2=function(){dJ(),L2(),kz.registerAnimation("heatmap",(function(t,e){return A(A({},tX),{appear:D2(e)})})),MK(),kK(),kz.registerSeries(N2.type,N2)},W2=A(A({},WY),((F2={}).nodePoint={name:"nodePoint",type:"symbol"},F2.ripplePoint={name:"ripplePoint",type:"ripple"},F2.centerPoint={name:"centerPoint",type:"symbol"},F2.centerLabel={name:"centerLabel",type:"text"},F2)),G2="".concat(BF,"_CORRELATION_X"),U2="".concat(BF,"_CORRELATION_Y"),Y2="".concat(BF,"_CORRELATION_SIZE"),X2=function(t,e){var i,n,r,a,o,s,l,u,c,h,d,p,f,v,g;if(!t||!(null==e?void 0:e.view)||!X(t))return t;var y=e.view();if(y.x1-y.x0==0||y.y1-y.y0==0||y.x1-y.x0==-1/0||y.x1-y.x0==1/0||y.y1-y.y0==-1/0||y.y1-y.y0==1/0)return t;var m=we(null!==(i=e.startAngle)&&void 0!==i?i:-90),_=we(null!==(n=e.endAngle)&&void 0!==n?n:270),b=Math.max((y.x1-y.x0)/2,(y.y1-y.y0)/2),x=tS(null!==(r=e.innerRadius)&&void 0!==r?r:0,b),k=tS(e.outerRadius,b),S=[Z(null===(a=e.center)||void 0===a?void 0:a[0])?e.center[0]:y.x0+tS(null!==(s=null===(o=e.center)||void 0===o?void 0:o[0])&&void 0!==s?s:"50%",y.x1-y.x0),Z(null===(l=e.center)||void 0===l?void 0:l[1])?e.center[1]:y.y0+tS(null!==(c=null===(u=e.center)||void 0===u?void 0:u[1])&&void 0!==c?c:"50%",y.y1-y.y0)],M=Qk(e.field),w=t.map(M),T=E($k(w),2),C=T[0],P=T[1],R=C===P?function(t){return(x+k)/2}:function(t){return x+(k-x)*(t-C)/(P-C)},B=j(e.radiusField)?M:Qk(e.radiusField),I=null!==(d=null===(h=null==e?void 0:e.radiusRange)||void 0===h?void 0:h[1])&&void 0!==d?d:5,L=function(t){return I};if(B){var D=E(B!==M?$k(t.map(B)):[C,P],2),O=D[0],F=D[1],z=null!==(f=null===(p=e.radiusRange)||void 0===p?void 0:p[0])&&void 0!==f?f:5,H=null!==(g=null===(v=e.radiusRange)||void 0===v?void 0:v[1])&&void 0!==g?g:5;O!==F&&(L=function(t){return z+(H-z)*(B(t)-O)/(F-O)})}var N=Math.min(m,_),V=Math.max(m,_),W=K2(N,V,t.length),G=[],U=(V-N)/60;return t.forEach((function(t,e){for(var i,n,r,a=R(w[e]),o=L(t),s=W[e],l=0;l<60&&(n=S[0]+a*Math.cos(s),r=S[1]+a*Math.sin(s),q2({x:n,y:r,size:o},G)||n-o<y.x0||n+o>y.x1||r-o<y.y0||r+o>y.y1);l++)l<59&&((s+=U)>V?s=N:s<N&&(s=V));G.push(A(((i={})[G2]=n,i[U2]=r,i[Y2]=o,i),t))})),G},K2=function(t,e,i){for(var n=0,r=Math.max(Math.ceil(2*(e-t)/Math.PI),2),a=(e-t)/r,o=0,s=1,l=0,u=0,c=[],h=t;l<i;)u<r&&(c.push(h+(u%2?Math.floor(u/2)+Math.floor(r/2):u/2)*a*s),u++),l++,u===r&&(u=0,0===n?n=a/2:n/=2,h=-1===(s*=-1)?e-n:t+n,(o+=1)>=2&&(a/=2,r*=2));return c},q2=function(t,e){return!(!e||!e.length)&&e.some((function(e){return Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)<Math.pow(t.size+e.size,2)}))},Z2=function(t,e){var i;if(!t||!X(t))return[];var n=e.keyword,r=e.categoryField,a=t[0].latestData[0];return(i={})[r]=n,i[Uz]=null==a?void 0:a[Uz],i[Xz]=null==a?void 0:a[Xz],i},J2=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return S(e,t),e.prototype._getDefaultStyle=function(){return A(A({},t.prototype._getDefaultStyle.call(this)),{x:0,y:0,ripple:0})},e.prototype._initProduct=function(t){var e=this.getVGrammarView(),i=this.getProductId();this._product=e.glyph("ripplePoint",null!=t?t:e.rootMark).id(i),this._compiledProductId=i},e.type="ripple",e}(aY),Q2=function(){kz.registerMark(J2.type,J2),xj.registerGlyph("ripplePoint",{symbol:"symbol",ripple0:"symbol",ripple1:"symbol",ripple2:"symbol"}).registerFunctionEncoder((function(t,e,i,n){var r,a=Math.max(0,Math.min(t.ripple,1)),o=null!==(r=t.size)&&void 0!==r?r:i.getGraphicAttribute("size"),s=.5*o;return{ripple0:{size:o+s*a,fillOpacity:.75-.25*a},ripple1:{size:o+s*(1+a),fillOpacity:.5-.25*a},ripple2:{size:o+s*(2+a),fillOpacity:.25-.25*a}}})).registerDefaultEncoder((function(){return{ripple0:{fillOpacity:.75},ripple1:{fillOpacity:.5},ripple2:{fillOpacity:.25}}})),aV(),iV(),tV()},$2=function(t,e){return"fadeIn"===e?{type:"fadeIn"}:{type:"scaleIn"}},t3=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"nodePoint"),this._addMarkLabelSpec(t,"centerPoint","centerLabel")},e}(mX),e3=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.correlation,i.transformerConstructor=t3,i._viewBox=new di,i}return S(i,e),i.prototype.getCategoryField=function(){return this._categoryField},i.prototype.setCategoryField=function(t){return this._categoryField=t,this._categoryField},i.prototype.getValueField=function(){return this._valueField},i.prototype.setValueField=function(t){return this._valueField=t,this._valueField},i.prototype.getSeriesField=function(){return this._seriesField},i.prototype.setSeriesField=function(t){N(t)&&(this._seriesField=t)},i.prototype.getSizeField=function(){return this._sizeField},i.prototype.setSizeField=function(t){N(t)&&(this._sizeField=t)},i.prototype.getSizeRange=function(){return this._sizeRange},i.prototype.setSizeRange=function(t){N(t)&&(this._sizeRange=t)},i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(this._spec.seriesField),this.setSizeField(this._spec.sizeField),this.setSizeRange(this._spec.sizeRange)},i.prototype.initData=function(){var t,i,n;if(e.prototype.initData.call(this),this._data){qG(this._dataSet,"correlation",X2);var r=new Ss;ZG(r,"dataview",os),qG(r,"correlationCenter",Z2);var a=new Ms(r,{name:"".concat(this.type,"_").concat(this.id,"_center")});a.parse([this.getViewData()],{type:"dataview"}),a.transform({type:"correlationCenter",options:{keyword:null!==(n=null===(i=null===(t=this._spec.centerLabel)||void 0===t?void 0:t.style)||void 0===i?void 0:i.text)&&void 0!==n?n:"",categoryField:this._spec.categoryField}}),this._centerSeriesData=new DY(this._option,a)}},i.prototype.compileData=function(){var t;e.prototype.compileData.call(this),null===(t=this._centerSeriesData)||void 0===t||t.compile()},i.prototype._statisticViewData=function(){var t=this;e.prototype._statisticViewData.call(this),this._data.getDataView().transform({type:"correlation",options:{view:function(){return{x0:t._viewBox.x1,x1:t._viewBox.x2,y0:t._viewBox.y1,y1:t._viewBox.y2}},field:this._spec.valueField,radiusRange:this._spec.sizeRange,radiusField:this._spec.sizeField,center:[this._spec.centerX,this._spec.centerY],innerRadius:this._spec.innerRadius,outerRadius:this._spec.outerRadius,startAngle:this._spec.startAngle,endAngle:this._spec.endAngle}})},i.prototype.initMark=function(){var t,e,n,r,a=this._createMark(i.mark.nodePoint,{groupKey:this._seriesField,isSeriesMark:!0,key:Uz,stateSort:null===(t=this._spec.nodePoint)||void 0===t?void 0:t.stateSort},{setCustomizedShape:null===(e=this._spec.nodePoint)||void 0===e?void 0:e.customShape});a&&(a.setMarkConfig({zIndex:wU.Node}),this._nodePointMark=a);var o=this._createMark(i.mark.ripplePoint,{key:Uz,dataView:this._centerSeriesData.getDataView(),dataProductId:this._centerSeriesData.getProductId()});o&&(this._ripplePointMark=o);var s=this._createMark(i.mark.centerPoint,{key:Uz,dataView:this._centerSeriesData.getDataView(),dataProductId:this._centerSeriesData.getProductId(),stateSort:null===(n=this._spec.centerPoint)||void 0===n?void 0:n.stateSort},{setCustomizedShape:null===(r=this._spec.centerPoint)||void 0===r?void 0:r.customShape});s&&(s.setMarkConfig({zIndex:wU.Node}),this._centerPointMark=s)},i.prototype.initMarkStyle=function(){this._initNodePointMarkStyle(),this._initRipplePointMarkStyle(),this._initCenterPointMarkStyle()},i.prototype._initNodePointMarkStyle=function(){var t,e,i,n,r=this._nodePointMark;if(r){var a=null!==(e=null===(t=this._spec.nodePoint)||void 0===t?void 0:t.style)&&void 0!==e?e:{};this.setMarkStyle(r,{x:function(t){return t[G2]},y:function(t){return t[U2]},size:function(t){return t[Y2]},fill:null!==(i=a.fill)&&void 0!==i?i:this.getColorAttribute(),fillOpacity:null!==(n=a.fillOpacity)&&void 0!==n?n:1,lineWidth:0},hU.STATE_NORMAL,CU.Series)}},i.prototype._initRipplePointMarkStyle=function(){var t,e,i,n,r,a=this,o=this._ripplePointMark;if(o){var s=null!==(e=null===(t=this._spec.ripplePoint)||void 0===t?void 0:t.style)&&void 0!==e?e:{};this.setMarkStyle(o,{x:function(){var t;return null!==(t=a._spec.centerX)&&void 0!==t?t:(a._viewBox.x1+a._viewBox.x2)/2},y:function(){var t;return null!==(t=a._spec.centerY)&&void 0!==t?t:(a._viewBox.y1+a._viewBox.y2)/2},size:function(){return Math.max(a._viewBox.x2-a._viewBox.x1,a._viewBox.y2-a._viewBox.y1)/2},fill:null!==(i=s.fill)&&void 0!==i?i:this.getColorAttribute(),opacity:null!==(n=s.fillOpacity)&&void 0!==n?n:.2,ripple:null!==(r=s.ripple)&&void 0!==r?r:0},hU.STATE_NORMAL,CU.Series)}},i.prototype._initCenterPointMarkStyle=function(){var t,e,i,n,r,a,o=this,s=this._centerPointMark;s&&this.setMarkStyle(s,{x:function(){var t;return null!==(t=o._spec.centerX)&&void 0!==t?t:(o._viewBox.x1+o._viewBox.x2)/2},y:function(){var t;return null!==(t=o._spec.centerY)&&void 0!==t?t:(o._viewBox.y1+o._viewBox.y2)/2},size:function(){return.2*Math.max(o._viewBox.x2-o._viewBox.x1,o._viewBox.y2-o._viewBox.y1)/2},fill:null!==(i=null===(e=null===(t=this._spec.centerPoint)||void 0===t?void 0:t.style)||void 0===e?void 0:e.fill)&&void 0!==i?i:this.getColorAttribute(),fillOpacity:null!==(a=null===(r=null===(n=this._spec.centerPoint)||void 0===n?void 0:n.style)||void 0===r?void 0:r.fillOpacity)&&void 0!==a?a:1},hU.STATE_NORMAL,CU.Series)},i.prototype.initTooltip=function(){e.prototype.initTooltip.call(this),this._nodePointMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._nodePointMark)},i.prototype.initLabelMarkStyle=function(t){var e=this;t&&this.setMarkStyle(t,{fill:this.getColorAttribute(),text:function(t){return t[e._categoryField]},z:this.dataToPositionZ.bind(this)},hU.STATE_NORMAL,CU.Series)},i.prototype.initAnimation=function(){var t,e,i=null===(t=this._spec.animationAppear)||void 0===t?void 0:t.preset;this._nodePointMark.setAnimationConfig(cX(null===(e=kz.getAnimationInKey("correlation"))||void 0===e?void 0:e({},i),hX("nodePoint",this._spec,this._markAttributeContext)))},i.prototype.getGroupFields=function(){return[]},i.prototype.getStackGroupFields=function(){return[]},i.prototype.getStackValueField=function(){return""},i.prototype.getActiveMarks=function(){return[this._nodePointMark,this._centerPointMark]},i.prototype.getDimensionField=function(){return[this._categoryField]},i.prototype.getMeasureField=function(){return[this._valueField]},i.prototype.onLayoutEnd=function(t){e.prototype.onLayoutEnd.call(this,t),this._viewBox.set(0,0,this._region.getLayoutRect().width,this._region.getLayoutRect().height),this._rawData.reRunAllTransform(),this.getViewData().reRunAllTransform()},i.type=t.SeriesTypeEnum.correlation,i.mark=W2,i.transformerConstructor=t3,i}(RJ),i3=function(){LX(),Q2(),kz.registerSeries(e3.type,e3),kz.registerAnimation("correlation",(function(t,e){return A({appear:$2(0,e)},$Y)}))},n3={duration:2e3,loop:!0,channel:{wave:{from:0,to:1}}};function r3(t,e){switch(e){case"wave":default:return n3;case"grow":case"waveGrow":return function(t){return{duration:2e3,channel:{wave:{from:0,to:1},height:t.height,dy:t.dy}}}(t)}}function a3(t,e){switch(e){case"wave":default:return n3;case"grow":case"waveGrow":return function(t){return{duration:2e3,channel:{dy:t.dy}}}(t)}}var o3,s3=A(A({},WY),((o3={}).liquidGroup={name:"liquidGroup",type:"group"},o3.liquid={name:"liquid",type:"liquid"},o3.liquidBackground={name:"liquidBackground",type:"group"},o3.liquidOutline={name:"liquidOutline",type:"group"},o3)),l3=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return S(e,t),e.prototype._getDefaultStyle=function(){return A(A({},t.prototype._getDefaultStyle.call(this)),{wave:0})},e.prototype._initProduct=function(t){var e=this.getVGrammarView(),i=this.getProductId();this._product=e.glyph("wave",null!=t?t:e.rootMark).id(i),this._compiledProductId=i},e.type="liquid",e}(aY),u3=function(){kz.registerMark(l3.type,l3),xj.registerGlyph("wave",{wave0:"area",wave1:"area",wave2:"area"}).registerChannelEncoder("wave",(function(t,e,i,n,r){var a=new Array(21).fill(0).map((function(t,e){var n=e%2==0?20:0;return{x:50*e-500,y:i.y+n,y1:i.y+i.height}}));return{wave0:{points:a.map((function(t){return{x:t.x+100*e,y:t.y,y1:t.y1}})),x:0,y:0},wave1:{points:a.map((function(t){return{x:t.x+200*e-40,y:t.y,y1:t.y1}})),x:0,y:0},wave2:{points:a.map((function(t){return{x:t.x+300*e-20,y:t.y,y1:t.y1}})),x:0,y:0}}})).registerDefaultEncoder((function(){return{wave0:{curveType:"monotoneX",fillOpacity:1},wave1:{curveType:"monotoneX",fillOpacity:.66},wave2:{curveType:"monotoneX",fillOpacity:.33}}})),aV(),iV(),ZN()},c3=function(t,e){return"drop"===t?function(t,e,i){var n=4*i/3,r=Math.max(n,2*i),a=n/2,o=t,s=a+e-r/2,l=Math.asin(a/(.85*(r-a))),u=Math.sin(l)*a,c=Math.cos(l)*a,h=o-c,d=s+u,p=t,f=s+a/Math.sin(l);return"\n      M ".concat(h," ").concat(d,"\n      A ").concat(a," ").concat(a," 0 1 1 ").concat(h+2*c," ").concat(d,"\n      Q ").concat(p," ").concat(f," ").concat(t," ").concat(e+r/2,"\n      Q ").concat(p," ").concat(f," ").concat(h," ").concat(d,"\n      Z \n    ")}(0,0,e):t};var h3,d3=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.markTooltipKeyCallback=function(t){return e.series.getValueField()},e.markTooltipValueCallback=function(t){return t[e.series.getValueField()]},e.shapeStrokeCallback=function(t){return e.series.getMarkInName("liquid").getAttribute("fill",t)},e}return S(e,t),e}(PY),p3=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.liquid,i.transformerConstructor=DX,i._liquidBackgroundMark=null,i._liquidOutlineMark=null,i._getLiquidPosY=function(){var t=i._getLiquidBackPosAndSize(),e=t.height,n=t.startY;return(i._reverse?e*i._heightRatio:e*(1-i._heightRatio))+n},i._getLiquidHeight=function(){return i._getLiquidBackPosAndSize().height*i._heightRatio},i._getLiquidBackPosAndSize=function(t){var e,n;void 0===t&&(t=!1);var r=i._marginSpec,a=r.top,o=void 0===a?0:a,s=r.bottom,l=void 0===s?0:s,u=r.left,c=void 0===u?0:u,h=r.right,d=void 0===h?0:h,p=t?{}:i._paddingSpec,f=p.top,v=void 0===f?0:f,g=p.bottom,y=void 0===g?0:g,m=p.left,_=void 0===m?0:m,b=p.right,x=void 0===b?0:b;"triangle"===i._maskShape&&(l/=Math.sqrt(3),o=o/Math.sqrt(3)*2,y/=Math.sqrt(3),v=v/Math.sqrt(3)*2);var k=null!==(n=null===(e=i._region)||void 0===e?void 0:e.getLayoutRect())&&void 0!==n?n:{width:0,height:0},S=k.width,A=k.height,M=S/2+(c+_-(d+x))/2,w=A/2+(o+v-(l+y))/2,T=S-(c+d+_+x),C=A-(o+l+v+y),E=Math.min(T,C);return"rect"!==i._maskShape&&(T=E,C=E),{x:M,y:w,size:E,width:T,height:C,startX:M-T/2,startY:w-C/2,endX:M+T/2,endY:w+C/2}},i._getLiquidBackPath=function(t){var e,n;if(void 0===t&&(t=!1),"rect"===i._maskShape){var r=i._getLiquidBackPosAndSize(t),a=r.x,o=r.y,s=r.width,l=r.height;n=Xg({x:a-s/2,y:o-l/2,width:s,height:l,fill:!0})}else{var u=i._getLiquidBackPosAndSize(t),c=(a=u.x,o=u.y,u.size);n=Ng({x:a,y:o,size:c,symbolType:c3(null!==(e=i._spec.maskShape)&&void 0!==e?e:"circle",c),fill:!0})}return[n]},i}return S(i,e),i.prototype.setValueField=function(t){N(t)&&(this._valueField=t)},i.prototype.getValueField=function(){return this._valueField},i.prototype.setAttrFromSpec=function(){var t,i;e.prototype.setAttrFromSpec.call(this),this._marginSpec=bF(this._spec.outlineMargin),this._paddingSpec=bF(this._spec.outlinePadding),this.setValueField(this._spec.valueField),this._reverse=null!==(t=this._spec.reverse)&&void 0!==t&&t,this._maskShape=null!==(i=this._spec.maskShape)&&void 0!==i?i:"circle"},i.prototype.viewDataUpdate=function(t){var i=this;e.prototype.viewDataUpdate.call(this,t),this._heightRatio=he.apply(void 0,P([],E(this._data.getLatestData().map((function(t){return t[i._valueField]}))),!1))},i.prototype.initMark=function(){this._initLiquidOutlineMark(),this._initLiquidBackgroundMark(),this._initLiquidMark()},i.prototype.initMarkStyle=function(){this._initLiquidOutlineMarkStyle(),this._initLiquidBackgroundMarkStyle(),this._initLiquidMarkStyle()},i.prototype._initLiquidOutlineMark=function(){return this._liquidOutlineMark=this._createMark(i.mark.liquidOutline,{isSeriesMark:!0,skipBeforeLayouted:!1}),this._liquidOutlineMark},i.prototype._initLiquidBackgroundMark=function(){return this._liquidBackgroundMark=this._createMark(i.mark.liquidBackground,{isSeriesMark:!0,skipBeforeLayouted:!1}),this._liquidBackgroundMark},i.prototype._initLiquidMark=function(){return this._liquidGroupMark=this._createMark(i.mark.liquidGroup,{parent:this._liquidBackgroundMark,isSeriesMark:!0,skipBeforeLayouted:!1}),this._liquidMark=this._createMark(i.mark.liquid,{parent:this._liquidGroupMark,isSeriesMark:!0,skipBeforeLayouted:!1}),this._liquidMark},i.prototype._buildMarkAttributeContext=function(){e.prototype._buildMarkAttributeContext.call(this),this._markAttributeContext.getLiquidBackPosAndSize=this._getLiquidBackPosAndSize,this._markAttributeContext.getLiquidPosY=this._getLiquidPosY,this._markAttributeContext.getLiquidHeight=this._getLiquidHeight},i.prototype._initLiquidOutlineMarkStyle=function(){var t=this,e=this._liquidOutlineMark;e.created(),this.setMarkStyle(e,{stroke:this.getColorAttribute(),width:function(){return t._region.getLayoutRect().width},height:function(){return t._region.getLayoutRect().height},path:function(){return t._getLiquidBackPath(!0)}},"normal",CU.Series),this._liquidOutlineMark.setMarkConfig({interactive:!1,zIndex:this.layoutZIndex})},i.prototype._initLiquidBackgroundMarkStyle=function(){var t=this,e=this._liquidBackgroundMark;e.created(),this.setMarkStyle(e,{width:function(){return t._region.getLayoutRect().width},height:function(){return t._region.getLayoutRect().height},path:function(){return t._getLiquidBackPath()}},"normal",CU.Series),this._liquidBackgroundMark.setMarkConfig({interactive:!1,zIndex:this.layoutZIndex,clip:!0})},i.prototype._initLiquidMarkStyle=function(){var t=this,e=this._liquidMark,i=this._liquidGroupMark;i&&this.setMarkStyle(i,{x:function(){return t._region.getLayoutStartPoint().x+t._region.getLayoutRect().width/2},angle:this._reverse?-Math.PI:0,y:0,dy:this._getLiquidPosY}),e&&this.setMarkStyle(e,{y:0,dy:0,height:this._getLiquidHeight,fill:this.getColorAttribute(),wave:0},"normal",CU.Series)},i.prototype.initTooltip=function(){this._tooltipHelper=new d3(this),this._liquidMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._liquidMark)},i.prototype.initInteraction=function(){this._parseInteractionConfig(this._liquidMark?[this._liquidMark]:[])},i.prototype.initAnimation=function(){var t,e,i,n,r=this,a={height:{from:0,to:function(){return r._getLiquidHeight()}},dy:{from:function(){var t=r._getLiquidBackPosAndSize(),e=t.height,i=t.startY;return(r._reverse?0:e)+i}}},o=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this._liquidMark.setAnimationConfig(cX(null===(i=kz.getAnimationInKey("liquid"))||void 0===i?void 0:i(a,o),hX("liquid",this._spec,this._markAttributeContext))),this._liquidGroupMark.setAnimationConfig(cX(null===(n=kz.getAnimationInKey("liquidGroup"))||void 0===n?void 0:n(a,o),hX("liquidGroup",this._spec,this._markAttributeContext)))},i.prototype.initEvent=function(){var t=this;e.prototype.initEvent.call(this),this._spec.indicatorSmartInvert&&this._option.getChart().getComponentsByKey("indicator")&&this.event.on(cG.renderFinished,(function(){t._option.getChart().getComponentsByKey("indicator").forEach((function(e){var i,n,r=t._liquidMark.getProduct().elements[0].glyphGraphicItems.wave1,a=r.globalAABBBounds,o=a.y1,s=a.y2;o+=t._region.getLayoutStartPoint().y,s+=t._region.getLayoutStartPoint().y,null===(n=null===(i=null==e?void 0:e.getIndicatorComponent())||void 0===i?void 0:i.getChildren()[0])||void 0===n||n.getChildren().forEach((function(t){var e=t.globalAABBBounds,i=e.y1,n=e.y2;if(o<i&&s>n){var a=eR(t.attribute.fill,r.attribute.fill);t.setAttribute("fill",a)}}))}))}))},i.prototype.dataToPosition=function(t){return null},i.prototype.dataToPositionX=function(t){return null},i.prototype.dataToPositionY=function(t){return null},i.prototype.valueToPosition=function(t,e){return null},i.prototype.getStatisticFields=function(){return[]},i.prototype.getGroupFields=function(){return[]},i.prototype.getStackGroupFields=function(){return[]},i.prototype.getStackValueField=function(){return""},i.prototype.getActiveMarks=function(){return[this._liquidMark]},i.type=t.SeriesTypeEnum.liquid,i.mark=s3,i.transformerConstructor=DX,i}(_X),f3=function(){u3(),sY(),kz.registerAnimation("liquid",(function(t,e){return{appear:r3(t,e),enter:r3(t,e),exit:r3(t,e)}})),kz.registerAnimation("liquidGroup",(function(t,e){return{appear:a3(t,e),enter:a3(t,e),exit:a3(t,e)}})),kz.registerSeries(p3.type,p3)},v3=function(t){return xt(t).join(",")},g3=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dimensionTooltipTitleCallback=function(t){return v3(null==t?void 0:t[e.series.getDimensionField()[0]])},e.markTooltipKeyCallback=function(t){return v3(null==t?void 0:t[e.series.getDimensionField()[0]])},e}return S(e,t),e}(PY),y3=A(A({},WY),((h3={}).circle={name:"circle",type:"arc"},h3.overlap={name:"overlap",type:"path"},h3.overlapLabel={name:"overlapLabel",type:"text"},h3));function m3(t,e,i){return Math.min(t,e)*Math.min(t,e)*Math.PI<=i+Hi?Math.abs(t-e):function(t,e,i,n){var r,a,o=null!==(r=null==n?void 0:n.maxIterations)&&void 0!==r?r:100,s=null!==(a=null==n?void 0:n.tolerance)&&void 0!==a?a:1e-10,l=t(e),u=t(i),c=i-e;if(l*u>0)return Lt.getInstance().error("Initial bisect points must have opposite signs"),NaN;if(0===l)return e;if(0===u)return i;for(var h=0;h<o;++h){var d=e+(c/=2),p=t(d);if(p*l>=0&&(e=d),Math.abs(c)<s||0===p)return d}return e+c}((function(n){return Vi(t,e,n)-i}),0,t+e)}function _3(t,e){var i,n=(e=e||{}).restarts||10,r=[],a={};for(i=0;i<t.length;++i){var o=t[i];1===o.sets.length&&(a[o.sets[0]]=r.length,r.push(o))}var s=function(t,e,i){var n=nn(e.length,e.length),r=nn(e.length,e.length);return t.filter((function(t){return 2===t.sets.length})).map((function(t){var a=i[t.sets[0]],o=i[t.sets[1]],s=m3(Math.sqrt(e[a].size/Math.PI),Math.sqrt(e[o].size/Math.PI),t.size);n[a][o]=n[o][a]=s;var l=0;t.size+1e-10>=Math.min(e[a].size,e[o].size)?l=1:t.size<=1e-10&&(l=-1),r[a][o]=r[o][a]=l})),{distances:n,constraints:r}}(t,r,a),l=s.distances,u=s.constraints,c=rn(l.map(rn))/l.length;l=l.map((function(t){return t.map((function(t){return t/c}))}));var h,d,p=function(t,e){return function(t,e,i,n){var r,a=0;for(r=0;r<e.length;++r)e[r]=0;for(r=0;r<i.length;++r)for(var o=t[2*r],s=t[2*r+1],l=r+1;l<i.length;++l){var u=t[2*l],c=t[2*l+1],h=i[r][l],d=n[r][l],p=(u-o)*(u-o)+(c-s)*(c-s),f=Math.sqrt(p),v=p-h*h;d>0&&f<=h||d<0&&f>=h||(a+=2*v*v,e[2*r]+=4*v*(o-u),e[2*r+1]+=4*v*(s-c),e[2*l]+=4*v*(u-o),e[2*l+1]+=4*v*(c-s))}return a}(t,e,l,u)};for(i=0;i<n;++i){var f=en(2*l.length).map((function(t,e){return ie(e)}));d=un(p,f,e),(!h||d.fx<h.fx)&&(h=d)}var v=h.x,g={};for(i=0;i<r.length;++i){var y=r[i];g[y.sets[0]]={x:v[2*i]*c,y:v[2*i+1]*c,radius:Math.sqrt(y.size/Math.PI)}}if(e.history)for(i=0;i<e.history.length;++i)an(e.history[i].x,c);return g}function b3(t,e){for(var i=0,n=0;n<e.length;++n){var r=e[n],a=void 0;if(1!==r.sets.length){if(2===r.sets.length){var o=t[r.sets[0]],s=t[r.sets[1]];a=Vi(o.radius,s.radius,Me.distancePP(o,s))}else a=ji(r.sets.map((function(e){return t[e]})));i+=(r.hasOwnProperty("weight")?r.weight:1)*(a-r.size)*(a-r.size)}}return i}function x3(t,e){var i=function(t,e){for(var i=e&&e.lossFunction?e.lossFunction:b3,n={},r={},a=0;a<t.length;++a){var o=t[a];if(1===o.sets.length){var s=o.sets[0];n[s]={x:1e10,y:1e10,size:o.size,radius:Math.sqrt(o.size/Math.PI),setId:s},r[s]=[]}}t=t.filter((function(t){return 2===t.sets.length}));for(var l=0;l<t.length;++l){var u=t[l],c=u.hasOwnProperty("weight")?u.weight:1,h=u.sets[0],d=u.sets[1];u.size+Hi>=Math.min(n[h].size,n[d].size)&&(c=0),r[h].push({set:d,size:u.size,weight:c}),r[d].push({set:h,size:u.size,weight:c})}var p=[];for(var f in r)if(r.hasOwnProperty(f)){for(var v=0,g=0;g<r[f].length;++g)v+=r[f][g].size*r[f][g].weight;p.push({set:f,size:v})}function y(t,e){return e.size-t.size}p.sort(y);var m={};function _(t){return t.set in m}function b(t,e){n[e].x=t.x,n[e].y=t.y,m[e]=!0}b({x:0,y:0},p[0].set);for(var x=1;x<p.length;++x){var k=p[x].set,S=r[k].filter(_),A=n[k];if(S.sort(y),0===S.length)throw"ERROR: missing pairwise overlap information";for(var M=[],w=0;w<S.length;++w){var T=n[S[w].set],C=m3(A.radius,T.radius,S[w].size);M.push({x:T.x+C,y:T.y}),M.push({x:T.x-C,y:T.y}),M.push({y:T.y+C,x:T.x}),M.push({y:T.y-C,x:T.x});for(var E=w+1;E<S.length;++E)for(var P=n[S[E].set],R=m3(A.radius,P.radius,S[E].size),B=Wi({x:T.x,y:T.y,radius:C},{x:P.x,y:P.y,radius:R}),I=0;I<B.length;++I)M.push(B[I])}for(var L=1e50,D=M[0],O=0;O<M.length;++O){n[k].x=M[O].x,n[k].y=M[O].y;var F=i(n,t);F<L&&(L=F,D=M[O])}b(D,k)}return n}(t,e),n=e.lossFunction||b3;if(t.length>=8){var r=_3(t,e);n(r,t)+1e-8<n(i,t)&&(i=r)}return i}function k3(t,e,i){var n;if(null===i?t.sort((function(t,e){return e.radius-t.radius})):t.sort(i),t.length>0){var r=t[0].x,a=t[0].y;for(n=0;n<t.length;++n)t[n].x-=r,t[n].y-=a}if(2===t.length&&Me.distancePP(t[0],t[1])<Math.abs(t[1].radius-t[0].radius)&&(t[1].x=t[0].x+t[0].radius-t[1].radius-1e-10,t[1].y=t[0].y),t.length>1){var o,s,l=Math.atan2(t[1].x,t[1].y)-e,u=Math.cos(l),c=Math.sin(l);for(n=0;n<t.length;++n)o=t[n].x,s=t[n].y,t[n].x=u*o-c*s,t[n].y=c*o+u*s}if(t.length>2){for(var h=Math.atan2(t[2].x,t[2].y)-e;h<0;)h+=2*Math.PI;for(;h>2*Math.PI;)h-=2*Math.PI;if(h>Math.PI){var d=t[1].y/(1e-10+t[1].x);for(n=0;n<t.length;++n){var p=(t[n].x+d*t[n].y)/(1+d*d);t[n].x=2*p-t[n].x,t[n].y=2*p*d-t[n].y}}}}function S3(t){var e=function(e){return{max:Math.max.apply(null,t.map((function(t){return t[e]+t.radius}))),min:Math.min.apply(null,t.map((function(t){return t[e]-t.radius})))}};return{xRange:e("x"),yRange:e("y")}}function A3(t,e,i){null===e&&(e=Math.PI/2);var n=[];for(var r in t)if(t.hasOwnProperty(r)){var a=t[r];n.push({x:a.x,y:a.y,radius:a.radius,setId:r})}for(var o=function(t){function e(t){return t.parent!==t&&(t.parent=e(t.parent)),t.parent}t.map((function(t){t.parent=t}));for(var i=0;i<t.length;++i)for(var n=i+1;n<t.length;++n){var r=t[i].radius+t[n].radius;Me.distancePP(t[i],t[n])+1e-10<r&&(a=t[n],o=t[i],s=void 0,l=void 0,s=e(a),l=e(o),s.parent=l)}for(var a,o,s,l,u,c={},h=0;h<t.length;++h)(u=e(t[h]).parent.setId)in c||(c[u]=[]),c[u].push(t[h]);t.map((function(t){delete t.parent}));var d=[];for(u in c)c.hasOwnProperty(u)&&d.push(c[u]);return d}(n),s=0;s<o.length;++s){k3(o[s],e,i);var l=S3(o[s]);o[s].size=(l.xRange.max-l.xRange.min)*(l.yRange.max-l.yRange.min),o[s].bounds=l}o.sort((function(t,e){return e.size-t.size}));var u=(n=o[0]).bounds,c=(u.xRange.max-u.xRange.min)/50;function h(t,e,i){if(t){var r,a,o,s=t.bounds;e?r=u.xRange.max-s.xRange.min+c:(r=u.xRange.max-s.xRange.max,(o=(s.xRange.max-s.xRange.min)/2-(u.xRange.max-u.xRange.min)/2)<0&&(r+=o)),i?a=u.yRange.max-s.yRange.min+c:(a=u.yRange.max-s.yRange.max,(o=(s.yRange.max-s.yRange.min)/2-(u.yRange.max-u.yRange.min)/2)<0&&(a+=o));for(var l=0;l<t.length;++l)t[l].x+=r,t[l].y+=a,n.push(t[l])}}for(var d=1;d<o.length;)h(o[d],!0,!1),h(o[d+1],!1,!0),h(o[d+2],!0,!0),d+=3,u=S3(n);for(var p={},f=0;f<n.length;++f)p[n[f].setId]=n[f];return p}function M3(t,e){for(var i={},n=function(t){var e={},i=[];for(var n in t)i.push(n),e[n]=[];for(var r=0;r<i.length;r++)for(var a=t[i[r]],o=r+1;o<i.length;++o){var s=t[i[o]],l=Me.distancePP(a,s);l+s.radius<=a.radius+1e-10?e[i[o]].push(i[r]):l+a.radius<=s.radius+1e-10&&e[i[r]].push(i[o])}return e}(t),r=0;r<e.length;++r){for(var a=e[r].sets,o={},s={},l=0;l<a.length;++l){o[a[l]]=!0;for(var u=n[a[l]],c=0;c<u.length;++c)s[u[c]]=!0}var h=[],d=[];for(var p in t)p in o?h.push(t[p]):p in s||d.push(t[p]);var f=w3(h,d);i[a.toString()]=f,f.disjoint&&e[r].size>0&&Lt.getInstance().error("Area "+a+" not represented on screen")}return i}function w3(t,e){for(var i=[],n=0;n<t.length;++n){var r=t[n];i.push({x:r.x,y:r.y}),i.push({x:r.x+r.radius/2,y:r.y}),i.push({x:r.x-r.radius/2,y:r.y}),i.push({x:r.x,y:r.y+r.radius/2}),i.push({x:r.x,y:r.y-r.radius/2})}for(var a=i[0],o=T3(i[0],t,e),s=1;s<i.length;++s){var l=T3(i[s],t,e);l>=o&&(a=i[s],o=l)}for(var u=sn((function(i){return-1*T3({x:i[0],y:i[1]},t,e)}),[a.x,a.y],{maxIterations:500,minErrorDelta:1e-10}).x,c={x:u[0],y:u[1]},h=!0,d=0;d<t.length;++d)if(Me.distancePP(c,t[d])>t[d].radius){h=!1;break}for(var p=0;p<e.length;++p)if(Me.distancePP(c,e[p])<e[p].radius){h=!1;break}if(!h)if(1===t.length)c={x:t[0].x,y:t[0].y};else{var f={};ji(t,f),c=0===f.arcs.length?{x:0,y:-1e3,disjoint:!0}:1===f.arcs.length?{x:f.arcs[0].circle.x,y:f.arcs[0].circle.y}:e.length?w3(t,[]):Gi(f.arcs.map((function(t){return t.p1})))}return c}function T3(t,e,i){var n,r,a=e[0].radius-Me.distancePP(e[0],t);for(n=1;n<e.length;++n)(r=e[n].radius-Me.distancePP(e[n],t))<=a&&(a=r);for(n=0;n<i.length;++n)(r=Me.distancePP(i[n],t)-i[n].radius)<=a&&(a=r);return a}var C3,E3=function(t){var e={},i=Object.values(t);if(!i.length)return[];ji(i,e);for(var n=e.arcs.map((function(t){var e=t.p1,i=t.p2,n=t.circle,r=t.width;return{p1:e,p2:i,radius:n.radius,setId:n.setId,largeArcFlag:r>n.radius}})),r=[],a=0,o=n[0],s=function(){var t=o.p2;r.push(o),o=n.find((function(e){return Me.distancePP(e.p1,t)<Hi})),a++};a<n.length&&o;)s();return r},P3=function(t){if(!(null==t?void 0:t.length))return"";for(var e=0,i=t[0],n=i.p1,r="M".concat(n.x,",").concat(n.y);i;){var a=i,o=a.p2,s=a.radius,l=a.largeArcFlag;r+="A".concat(s,",").concat(s," 0 ").concat(l?1:0,",0 ").concat(o.x,",").concat(o.y),i=t[++e]}return r+=" Z"},R3=function(t){var e;return null!==(e=null==t?void 0:t.map((function(t){var e=t.p1,i=t.p2,n=t.radius,r=t.largeArcFlag,a=t.setId,o=e.x,s=e.y,l=i.x,u=i.y,c=Math.pow(Math.pow(l-o,2)+Math.pow(u-s,2),.5),h=(o+l)/2,d=(s+u)/2,p=Math.pow(Math.pow(n,2)-Math.pow(c/2,2),.5),f=h+p*(u-s)/c,v=d-p*(l-o)/c;return(me([l-o,u-s],[f-o,v-s])>0||r)&&(f=h-p*(u-s)/c,v=d+p*(l-o)/c),{x:f,y:v,radius:n,setId:a}})))&&void 0!==e?e:[]},B3=function(t,e){var i=t.x0,n=t.x1,r=t.y0,a=t.y1,o=t.setField,s=void 0===o?"sets":o,l=t.valueField,u=void 0===l?"size":l,c=t.orientation,h=void 0===c?Math.PI/2:c,d=t.orientationOrder,p=void 0===d?null:d,f={},v={};if(e.length>0){var g=e.map((function(t){return{sets:xt(t[s]),size:t[u]}})),y=function(t,e){(e=e||{}).maxIterations=e.maxIterations||500;var i=e.initialLayout||x3,n=e.lossFunction||b3,r=i(t=function(t){t=t.slice();for(var e=[],i={},n=0;n<t.length;++n){var r=t[n];if(1===r.sets.length)e.push(r.sets[0]);else if(2===r.sets.length){var a=r.sets[0],o=r.sets[1];i[[a,o].toString()]=!0,i[[o,a].toString()]=!0}}e.sort((function(t,e){return+(t>e)}));for(var s=0;s<e.length;++s)for(var l=e[s],u=s+1;u<e.length;++u){var c=e[u];[l,c].toString()in i||t.push({sets:[l,c],size:0})}return t}(t),e),a=[],o=[];for(var s in r)r.hasOwnProperty(s)&&(a.push(r[s].x),a.push(r[s].y),o.push(s));for(var l=sn((function(e){for(var i={},a=0;a<o.length;++a){var s=o[a];i[s]={x:e[2*a],y:e[2*a+1],radius:r[s].radius}}return n(i,t)}),a,e).x,u=0;u<o.length;++u){var c=o[u];r[c].x=l[2*u],r[c].y=l[2*u+1]}return r}(g,t);y=A3(y,h,p),f=function(t,e,i,n,r){e=Math.max(e,1),i=Math.max(i,1);var a=[],o=[];for(var s in t)t.hasOwnProperty(s)&&(o.push(s),a.push(t[s]));var l=S3(a),u=l.xRange,c=l.yRange;if(u.max===u.min||c.max===c.min)return console.log("not scaling solution: zero size detected"),t;for(var h=e/(u.max-u.min),d=i/(c.max-c.min),p=Math.min(d,h),f=(e-(u.max-u.min)*p)/2,v=(i-(c.max-c.min)*p)/2,g={},y=0;y<a.length;++y){var m=a[y];g[o[y]]={radius:p*m.radius,x:n+f+(m.x-u.min)*p,y:r+v+(m.y-c.min)*p,setId:m.setId}}return g}(y,n-i,a-r,i,r),v=M3(f,g)}return e.map((function(t){var e=xt(t[s]),i=e.toString(),n=v[i],r=Object.assign(Object.assign({},t),{datum:t,sets:e,key:i,size:t[u],labelX:null==n?void 0:n.x,labelY:null==n?void 0:n.y}),a=f[i];if(a)return Object.assign(Object.assign({},r),{type:"circle",x:a.x,y:a.y,radius:a.radius});var o=E3(e.map((function(t){return f[t]})));return Object.assign(Object.assign({},r),{type:"overlap",x:0,y:0,path:P3(o),arcs:o})}))},I3=function(t,e){return e.filter((function(e){return e.type===t.datumType}))},L3=function(t){function e(){return r(this,e),n(this,e,arguments)}return h(e,t),o(e,[{key:"onBind",value:function(){var t=this;this.fromCircles={},R3(this.from.arcs).forEach((function(e){t.fromCircles[e.setId]=e})),this.toCircles={},R3(this.to.arcs).forEach((function(e){t.toCircles[e.setId]=e}))}},{key:"onUpdate",value:function(t,e,i){var n=this,r=[];Object.keys(this.fromCircles).forEach((function(t){var i=n.fromCircles[t],a=n.toCircles[t];i&&a&&r.push({radius:i.radius+(a.radius-i.radius)*e,x:i.x+(a.x-i.x)*e,y:i.y+(a.y-i.y)*e,setId:t})}));var a=E3(r);i.arcs=a,i.path=P3(a)}}])}(Yh),D3=function(t){switch(t){case"fadeIn":default:return{type:"fadeIn"};case"growIn":return{type:"growRadiusIn"};case"scaleIn":return{type:"scaleIn"}}},O3=function(t){switch(t){case"fadeIn":default:return{type:"fadeIn"};case"scaleIn":return{type:"scaleIn"}}},F3=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"circle"),this._addMarkLabelSpec(t,"overlap","overlapLabel","initOverlapLabelMarkStyle")},e}(mX),z3=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.venn,i.transformerConstructor=F3,i._viewBox=new di,i}return S(i,e),i.prototype.getCategoryField=function(){return this._categoryField},i.prototype.setCategoryField=function(t){return this._categoryField=t,this._categoryField},i.prototype.getValueField=function(){return this._valueField},i.prototype.setValueField=function(t){return this._valueField=t,this._valueField},i.prototype.setAttrFromSpec=function(){var t,i,n;e.prototype.setAttrFromSpec.call(this),this.setCategoryField(null!==(t=this._spec.categoryField)&&void 0!==t?t:"sets"),this.setValueField(null!==(i=this._spec.valueField)&&void 0!==i?i:"size"),this.setSeriesField(null!==(n=this._spec.seriesField)&&void 0!==n?n:Yz)},i.prototype.compile=function(){e.prototype.compile.call(this),this._runVennTransform()},i.prototype._runVennTransform=function(t){void 0===t&&(t=!1);var e=this._data.getProduct();e&&e.transform([{type:"venn",x0:this._viewBox.x1,x1:this._viewBox.x2,y0:this._viewBox.y1,y1:this._viewBox.y2,setField:this._categoryField,valueField:this._valueField}]),t&&this.getCompiler().renderNextTick()},i.prototype.initMark=function(){var t=this._createMark(i.mark.circle,{isSeriesMark:!0});t&&(t.setTransform([{type:"vennMark",datumType:"circle"}]),this._circleMark=t);var e=this._createMark(i.mark.overlap,{isSeriesMark:!0});e&&(e.setTransform([{type:"vennMark",datumType:"overlap"}]),this._overlapMark=e)},i.prototype.initMarkStyle=function(){this._initCircleMarkStyle(),this._initOverlapMarkStyle()},i.prototype._initCircleMarkStyle=function(){this._circleMark&&this.setMarkStyle(this._circleMark,{x:function(t){return t.x},y:function(t){return t.y},innerRadius:0,outerRadius:function(t){return t.radius},startAngle:0,endAngle:2*Math.PI,fill:this.getColorAttribute(),stroke:this.getColorAttribute()},hU.STATE_NORMAL,CU.Series)},i.prototype._initOverlapMarkStyle=function(){this._overlapMark&&(this.setMarkStyle(this._overlapMark,{x:function(t){return t.x},y:function(t){return t.y},path:function(t){return t.path},arcs:function(t){return t.arcs},fill:this.getColorAttribute(),stroke:this.getColorAttribute(),zIndex:function(t){return 100*t.sets.length}},hU.STATE_NORMAL,CU.Series),this.setMarkStyle(this._overlapMark,{zIndex:function(t){return 100*t.sets.length+1}},hU.STATE_HOVER,CU.Series))},i.prototype.initLabelMarkStyle=function(t){t&&(this._labelMark=t,t.setRule("venn"),this.setMarkStyle(t,{x:function(t){return t.labelX},y:function(t){return t.labelY},text:function(t){return v3(t.sets)},maxLineWidth:function(t){var e=t,i=e.x,n=e.radius,r=e.labelX,a=i-n,o=i+n;return Math.min(r-a,o-r)}},hU.STATE_NORMAL,CU.Series))},i.prototype.initOverlapLabelMarkStyle=function(t){t&&(this._labelMark=t,t.setRule("venn"),this.setMarkStyle(t,{x:function(t){return t.labelX},y:function(t){return t.labelY},text:function(t){return v3(t.sets)}},hU.STATE_NORMAL,CU.Series))},i.prototype.initTooltip=function(){this._tooltipHelper=new g3(this),this._circleMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._circleMark),this._overlapMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._overlapMark)},i.prototype.getDimensionField=function(){return[this._categoryField]},i.prototype.getMeasureField=function(){return[this._valueField]},i.prototype.onLayoutEnd=function(t){e.prototype.onLayoutEnd.call(this,t),this._viewBox.set(0,0,this.getLayoutRect().width,this.getLayoutRect().height),this._runVennTransform()},i.prototype.getDefaultShapeType=function(){return"circle"},i.prototype.getActiveMarks=function(){return[this._circleMark,this._overlapMark]},i.prototype.getStatisticFields=function(){var t=[];return t.push({key:this._categoryField,operations:["values"]}),t.push({key:this._valueField,operations:["max","min"]}),t},i.prototype.getGroupFields=function(){return null},i.prototype.dataToPosition=function(t,e){return{x:t.x,y:t.y}},i.prototype.dataToPositionX=function(t){return t.x},i.prototype.dataToPositionY=function(t){return t.y},i.prototype.valueToPosition=function(t,e){throw new Error("Method not implemented.")},i.prototype.getStackGroupFields=function(){return[]},i.prototype.getStackValueField=function(){return null},i.prototype._getSeriesInfo=function(t,e){var i=this,n=this.getDefaultShapeType();return e.map((function(e){var r;return{key:v3(e),originalKey:e,style:i.getSeriesStyle((r={},r[t]=e,r)),shapeType:n}}))},i.prototype.getSeriesFieldValue=function(t,i){var n=e.prototype.getSeriesFieldValue.call(this,t,i);return v3(n)},i.prototype.legendSelectedFilter=function(t,e){if(t.type===B.discreteLegend){var i=t.getLegendDefaultData(!0);if(0===e.length&&i.length)return[];if(e.length===i.length)return e;var n={};e.forEach((function(t){n[t]=!0}));var r=i.filter((function(t){return!n[v3(t)]})),a=i.filter((function(t){return!r.includes(t)&&r.some((function(e){return xt(e).every((function(e){return t.includes(e)}))}))}));e=e.slice(),a.forEach((function(t){e.splice(e.indexOf(v3(t)),1)}))}return e},i.prototype.initAnimation=function(){var t=this;this.getMarksInType("arc").forEach((function(e){var i;e.setAnimationConfig(cX(null===(i=kz.getAnimationInKey("vennCircle"))||void 0===i?void 0:i(),hX(e.name,t._spec,t._markAttributeContext)))})),this.getMarksInType("path").forEach((function(e){var i;e.setAnimationConfig(cX(null===(i=kz.getAnimationInKey("vennOverlap"))||void 0===i?void 0:i(),hX(e.name,t._spec,t._markAttributeContext)))}))},i.type=t.SeriesTypeEnum.venn,i.mark=y3,i.transformerConstructor=F3,i}(_X),H3=function(){YJ(),dZ(),kz.registerAnimation("vennCircle",(function(t,e){return{appear:D3(e),enter:{type:"growRadiusIn"},exit:{type:"growRadiusOut"},disappear:{type:"growRadiusOut"}}})),kz.registerAnimation("vennOverlap",(function(t,e){return{appear:O3(e),update:{custom:L3},enter:{type:"fadeIn"},exit:{type:"fadeOut"},disappear:{type:"fadeOut"}}})),iX(),xj.registerTransform("venn",{transform:B3,markPhase:"beforeJoin"},!0),xj.registerTransform("vennMark",{transform:I3,markPhase:"beforeJoin"},!0),kz.registerSeries(z3.type,z3)},j3=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.mosaic,i.transformerConstructor=mq,i}return S(i,e),i.prototype.getStack=function(){return!0},i.prototype.getPercent=function(){return!!this.getSeriesField()},i.prototype.getGroupFields=function(){return"vertical"===this.direction?this._specXField:this._specYField},i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this);var t=this.getPercent();"horizontal"===this.direction?(t&&(this.setFieldX(sH),this.setFieldX2(oH)),this.setFieldY(uH),this.setFieldY2(lH)):(t&&(this.setFieldY(sH),this.setFieldY2(oH)),this.setFieldX(uH),this.setFieldX2(lH))},i.prototype.parseLabelStyle=function(t,e){if((null==e?void 0:e.filterByGroup)&&j(t.dataFilter)){var i=this.getGroupFields(),n=e.filterByGroup,r=n.field,a=n.type,o=void 0===a?"max":a,s=n.filter;delete t.filterField;var l=i.indexOf(r);if(l<0)return;var u=!!(l%2)?"min"===o?"horizontal"===this.direction?this._fieldY2:this._fieldX2:"horizontal"===this.direction?this._fieldY:this._fieldX:"min"===o?"horizontal"===this.direction?this._fieldX2:this._fieldY2:"horizontal"===this.direction?this._fieldX:this._fieldY,c="min"===o?function(t,e){var i,n;return(null===(i=t.data)||void 0===i?void 0:i[u])<(null===(n=e.data)||void 0===n?void 0:n[u])}:function(t,e){var i,n;return(null===(i=t.data)||void 0===i?void 0:i[u])>(null===(n=e.data)||void 0===n?void 0:n[u])};t.dataFilter=function(t){var e={};return t.forEach((function(t){var i=t.data,n=null==i?void 0:i[r];j(n)||s&&!s(t)||e[n]&&!c(t,e[n])||(e[n]=t)})),t.filter((function(t){var i,n=null===(i=t.data)||void 0===i?void 0:i[r];return e[n]&&e[n]===t}))}}return t},i.type=t.SeriesTypeEnum.mosaic,i.transformerConstructor=mq,i}(_q),N3=function(){pq(),dJ(),iX(),kK(),kz.registerSeries(j3.type,j3)},V3=A(A({},WY),((C3={}).pictogram={name:"pictogram",type:"group"},C3)),W3=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._getDefaultSpecFromChart=function(e){var i,n,r,a=null!==(i=t.prototype._getDefaultSpecFromChart.call(this,e))&&void 0!==i?i:{},o=e.svg,s=null===(r=null===(n=fY.get(o))||void 0===n?void 0:n.latestData)||void 0===r?void 0:r.elements;s&&s.length&&s.map((function(t){return t.name})).filter((function(t){return N(t)})).forEach((function(t){e[t]&&(a[t]=e[t])}));return a},e}(mX),G3=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dimensionTooltipTitleCallback=function(t){var i,n=e.series;return null!==(i=e._getDimensionData(t))&&void 0!==i?i:n.getDatumName(t)},e.markTooltipValueCallback=function(t,i){var n=e._seriesCacheInfo.measureFields;if(n[0]&&t.data)return t.data[n[0]]},e.markTooltipKeyCallback=function(t){var i;return null===(i=t.data)||void 0===i?void 0:i[e.series.getDimensionField()[0]]},e}return S(e,t),e}(PY);function U3(t){var e;return N(t)&&"none"!==t&&!(null===(e=t.includes)||void 0===e?void 0:e.call(t,"url"))}var Y3=function(t){var e=parseFloat(t.strokeWidth);if(!isNaN(e))return e;var i=t.stroke;return i&&U3(i)?1:0},X3=function(t,e){var i,n=null!==(i=t.fill)&&void 0!==i?i:e;return n&&U3(n)?n:void 0},K3=function(t,e){var i,n=null!==(i=t.stroke)&&void 0!==i?i:e;return!(!n||!U3(n))&&n},q3=function(t){return A(A({},t),{x:parseFloat(t.x)||void 0,y:parseFloat(t.y)||void 0,fillStrokeOrder:!1,fill:X3(t),lineWidth:Y3(t),stroke:K3(t)})},Z3={group:function(t){var e=q3(t);return A(A({},e),{visibleAll:!1!==e.visible})},rule:function(t){return A(A({},q3(t)),{x:parseFloat(t.x1),y:parseFloat(t.y1),x1:parseFloat(t.x2),y1:parseFloat(t.y2)})},rect:function(t){return A(A({},q3(t)),{fill:X3(t,"#000"),width:parseFloat(t.width),height:parseFloat(t.height)})},polygon:function(t){return A(A({},q3(t)),{fill:X3(t,"#000"),points:t.points.trim().split(/\s+/).map((function(t){var e=E(t.split(",").map(Number),2);return{x:e[0],y:e[1]}}))})},line:function(t){return A(A({},q3(t)),{points:t.points.trim().split(/\s+/).map((function(t){var e=E(t.split(",").map(Number),2);return{x:e[0],y:e[1]}}))})},path:function(t){return A(A({},q3(t)),{path:t.d,fillStrokeOrder:!1,fill:X3(t,"#000")})},arc:function(t){var e;return A(A({},q3(t)),{outerRadius:null!==(e=t.r)&&void 0!==e?e:t.ry,x:parseFloat(t.cx),y:parseFloat(t.cy),startAngle:0,endAngle:2*Math.PI,scaleX:parseFloat(t.rx)/parseFloat(t.ry)||1,fill:X3(t,"#000")})},text:function(t,e){var i,n;return A(A({},q3(t)),{text:e,textAlign:null!==(i=t.textAlign)&&void 0!==i?i:"left",textBaseLine:null!==(n=t.textAnchor)&&void 0!==n?n:"middle",anchor:[0,0],fill:X3(t,"#000")})}},J3=function(t){var e,i;if(!t||!t[0])return{};var n=t[0].latestData.elements;if(n&&n.length){n.forEach((function(t,e){var i;t[Uz]=e,t._uniqueId="".concat(t.id,"-").concat(e),t.data=void 0;var n=t.graphicType,r=t.transform,a={visible:"hidden"!==t.attributes.visibility&&"collapse"!==t.attributes.visibility};"text"===t.graphicType?ft(a,t._inheritStyle,null===(i=t.parent)||void 0===i?void 0:i._textGroupStyle,t.attributes):"group"!==t.graphicType&&ft(a,t._inheritStyle,t.attributes),Z3[n]?t._finalAttributes=Z3[n](a,t.value):t._finalAttributes=a,r&&(t._finalAttributes.postMatrix=A({},r))}));for(var r=n.filter((function(t){return"text"===t.tagName})),a=function(t){var a=r[t]._uniqueId,o=n.filter((function(t){for(var e=!1,i=t.parent;i;){if(i._uniqueId===a){e=!0;break}i=i.parent}return e}));if(o&&o.length)for(var s=null!==(i=null===(e=r[t]._textGroupStyle)||void 0===e?void 0:e.x)&&void 0!==i?i:0,l=s,u=0;u<o.length;u++){var c=o[u];if("group"===c.graphicType)l=s;else if(c.value&&void 0===c.parent._textGroupStyle.x){var h=o.slice(0,u).reverse().find((function(t){return"text"===t.graphicType&&t.value}));if(h)l+=Wz(h.value,h._finalAttributes).width;c._finalAttributes.x=l}}},o=0;o<r.length;o++)a(o)}return n},Q3=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.pictogram,i._idToMark=new Map,i}return S(i,e),i.prototype.setAttrFromSpec=function(){var t,i,n;e.prototype.setAttrFromSpec.call(this),this.svg=this._spec.svg,this._nameField=this._spec.nameField,this._valueField=this._spec.valueField,this.svg||null===(t=this._option)||void 0===t||t.onError("svg source is not specified !"),this._parsedSvgResult=null===(i=yY(this.svg))||void 0===i?void 0:i.latestData,this._parsedSvgResult||null===(n=this._option)||void 0===n||n.onError("'".concat(this.svg,"' is not registered !"))},i.prototype.getDatumCenter=function(t){return[Number.NaN,Number.NaN]},i.prototype.getDatumName=function(t){return t.name||t._nameFromParent},i.prototype.getMarksWithoutRoot=function(){var t=this;return this.getMarks().filter((function(e){return e.name&&!e.name.includes("seriesGroup")&&!e.name.includes("root")&&e!==t._pictogramMark}))},i.prototype._buildMarkAttributeContext=function(){e.prototype._buildMarkAttributeContext.call(this),this._markAttributeContext.getTransformMatrix=this.getRootMatrix.bind(this),this._markAttributeContext.coordToPosition=this.coordToPosition.bind(this),this._markAttributeContext.dataToPosition=this.dataToPosition.bind(this)},i.prototype._defaultHoverConfig=function(t,e){return{seriesId:this.id,regionId:this._region.id,selector:t,type:"element-highlight-by-graphic-name",trigger:e.trigger,triggerOff:"pointerout",blurState:hU.STATE_HOVER_REVERSE,highlightState:hU.STATE_HOVER}},i.prototype._defaultSelectConfig=function(t,e){var i="multiple"===e.mode,n=N(e.triggerOff)?e.triggerOff:i?["empty","self"]:["empty",e.trigger];return{type:"element-select-by-graphic-name",seriesId:this.id,regionId:this._region.id,selector:t,trigger:e.trigger,triggerOff:n,reverseState:hU.STATE_SELECTED_REVERSE,state:hU.STATE_SELECTED,isMultiple:i}},i.prototype.initMark=function(){var t,e,n;if(this._pictogramMark=this._createMark(i.mark.pictogram,{groupKey:this.getDimensionField()[0],isSeriesMark:!0,skipBeforeLayouted:!0,dataView:this._mapViewData.getDataView(),dataProductId:this._mapViewData.getProductId()},{morph:fX(this._spec,i.mark.pictogram.name)}),this._pictogramMark){this._pictogramMark.setUserId(i.mark.pictogram.name);var r=function(t){var e=t.graphicType,r=t.name,o=t.parent;t.id;var s=t._nameFromParent,l=t._uniqueId,u=a._createMark({type:e,name:null!=r?r:s},{groupKey:l,isSeriesMark:!1,skipBeforeLayouted:!0,dataView:a._mapViewData.getDataView(),dataProductId:a._mapViewData.getProductId(),parent:null!==(n=a._idToMark.get(null==o?void 0:o._uniqueId))&&void 0!==n?n:a._pictogramMark},{morph:fX(a._spec,i.mark.pictogram.name)});u&&(u.setUserId(l),a._idToMark.set(l,u),"group"!==u.type&&u.setMarkConfig({graphicName:u.name}),u.setTransform([{type:"filter",callback:function(t){return t._uniqueId===l}}]))},a=this;try{for(var o=C(this._mapViewData.getDataView().latestData),s=o.next();!s.done;s=o.next()){r(s.value)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}this._initLabelMark()}},i.prototype._initLabelMark=function(){if(!0===this._spec.label.visible){var t=this._createMark(i.mark.label,{isSeriesMark:!1,parent:this._pictogramMark,groupKey:"_uniqueId",skipBeforeLayouted:!0,depend:this.getMarksWithoutRoot()});t&&(this._labelMark=t,this._labelMark.setDataView(this._mapViewData.getDataView()))}},i.prototype.initLabelMarkStyle=function(){var t=this;this._labelMark&&this.setMarkStyle(this._labelMark,{visible:function(e){return!!t._validElement(e)},x:function(e){var i;return null===(i=t.dataToPosition(e,!0))||void 0===i?void 0:i.x},y:function(e){var i;return null===(i=t.dataToPosition(e,!0))||void 0===i?void 0:i.y},text:function(e){return e[t.nameField]},textAlign:"center",textBaseline:"middle"},hU.STATE_NORMAL,CU.Series)},i.prototype.initMarkStyle=function(){var t,e,i=this,n=this._parsedSvgResult,r=n.root,a=n.viewBoxRect,o=this._mapViewData.getDataView().latestData;r&&(this.setMarkStyle(this._pictogramMark,Z3.group(r.attributes),"normal",CU.Built_In),r.transform&&this.setMarkStyle(this._pictogramMark,{postMatrix:function(){return r.transform}},"normal",CU.Built_In),a&&this._pictogramMark.setMarkConfig({clip:!0,clipPath:[Xg(A(A({},a),{fill:!0}))]}));try{for(var s=C(o),l=s.next();!l.done;l=s.next()){var u=l.value,c=u,h=c._uniqueId,d=c._finalAttributes,p=this._idToMark.get(h),f=this._validElement(u);p&&(this.setMarkStyle(p,{keepStrokeScale:!0},"normal",CU.Built_In),f?(this.initMarkStyleWithSpec(p,ft({},this._spec.pictogram,this._spec[p.name])),this.setMarkStyle(p,d,"normal",CU.Series),p.setPostProcess("fill",(function(t,e){return N(t)?t:i._spec.defaultFillColor}))):(p.setMarkConfig({interactive:!1}),this.setMarkStyle(p,d,"normal",CU.Built_In)))}}catch(e){t={error:e}}finally{try{l&&!l.done&&(e=s.return)&&e.call(s)}finally{if(t)throw t.error}}this.initLabelMarkStyle()},i.prototype._validElement=function(t){return t.name||t._nameFromParent},i.prototype.initTooltip=function(){var t=this;this._tooltipHelper=new G3(this),this.getMarksWithoutRoot().forEach((function(e){e&&e.name&&t._tooltipHelper.activeTriggerSet.mark.add(e)}))},i.prototype.dataToPosition=function(t,e){if(void 0===e&&(e=!1),!t)return null;var i=t[this.nameField];if(!i)return null;var n=this.getMarksWithoutRoot().filter((function(t){return t.name===i}));if(!n||0===n.length)return null;var r=new di;e?n.forEach((function(t){r=r.union(t.getProduct().getGroupGraphicItem().globalAABBBounds)})):n.forEach((function(t){r=r.union(t.getProduct().getBounds())}));var a={x:(r.x1+r.x2)/2,y:(r.y1+r.y2)/2};if(e){var o=this.getLayoutStartPoint(),s=o.x,l=o.y;a.x-=s,a.y-=l}return a},i.prototype.coordToPosition=function(t){if(!t)return null;var e=t.x,i=t.y,n=this.getRootMatrix();if(!n)return null;var r={};return n.getInverse().transformPoint({x:e,y:i},r),r},i.prototype.getRootMatrix=function(){var t;return null===(t=this.getPictogramRootGraphic())||void 0===t?void 0:t.transMatrix},i.prototype.getPictogramRootGraphic=function(){var t;return null===(t=this._pictogramMark.getProduct())||void 0===t?void 0:t.getGroupGraphicItem()},i.prototype.initData=function(){var t,i,n=this;e.prototype.initData.call(this);var r=fY.get(this.svg);r||null===(t=this._option)||void 0===t||t.onError("no valid svg found!");var a=new Ms(this._dataSet,{name:"pictogram_".concat(this.id,"_data")});qG(this._dataSet,"pictogram",J3),qG(this._dataSet,"lookup",oZ),a.parse([r],{type:"dataview"}).transform({type:"pictogram"}).transform({type:"lookup",options:{from:function(){return n.getViewData().latestData},key:"name",fields:this._nameField,set:function(t,e){e&&(t.data=e)}}}).transform({type:"lookup",options:{from:function(){return n.getViewData().latestData},key:"_nameFromParent",fields:this._nameField,set:function(t,e){e&&(t.data=e)}}}),null===(i=this._data)||void 0===i||i.getDataView().target.addListener("change",a.reRunAllTransform),this._mapViewData=new DY(this._option,a)},i.prototype.mapViewDataUpdate=function(){this._mapViewData.updateData()},i.prototype.onLayoutEnd=function(t){var i;e.prototype.onLayoutEnd.call(this,t),null===(i=this._mapViewData)||void 0===i||i.getDataView().reRunAllTransform()},i.prototype.updateSVGSize=function(){var t=this.getLayoutRect(),e=t.width,i=t.height,n=e/2,r=i/2,a=this.getPictogramRootGraphic();if(a){var o=a.AABBBounds,s=a.AABBBounds,l=(s.x1+s.x2)/2,u=(s.y1+s.y2)/2,c=e/o.width(),h=i/o.height(),d=Math.min(c,h);a.scale(d,d,{x:l,y:u}),a.translate(n-l,r-u)}},i.prototype.initEvent=function(){var t;e.prototype.initEvent.call(this),null===(t=this._mapViewData.getDataView())||void 0===t||t.target.addListener("change",this.mapViewDataUpdate.bind(this)),this.event.on(DH.AFTER_MARK_LAYOUT_END,this.updateSVGSize.bind(this))},i.prototype.handleZoom=function(t){var e=t.scale,i=t.scaleCenter;if(1!==e){var n=this.getPictogramRootGraphic();n&&(n.attribute.postMatrix||n.setAttributes({postMatrix:new vi}),n.scale(e,e,i))}},i.prototype.handlePan=function(t){var e=t.delta;if(0!==e[0]||0!==e[1]){var i=this.getPictogramRootGraphic();i&&(i.attribute.postMatrix||i.setAttributes({postMatrix:new vi}),i.translate(e[0],e[1]))}},i.prototype.getMarkData=function(t){var e;return null!==(e=t.data)&&void 0!==e?e:{}},i.prototype.getMeasureField=function(){return[this.valueField]},i.prototype.getDimensionField=function(){return[this.nameField]},i.prototype._getSeriesInfo=function(t,e){var i=this,n=this.getDefaultShapeType();return e.map((function(e){var r;return{key:e,originalKey:e,style:i.getSeriesStyle({data:(r={},r[t]=e,r)}),shapeType:n}}))},i.prototype.release=function(){this._parsedSvgResult=null,this._idToMark.clear(),this._idToMark=null},i.type=t.SeriesTypeEnum.pictogram,i.mark=V3,i.transformerConstructor=W3,i}(sZ),$3=function(){kz.registerSeries(Q3.type,Q3),kz.registerImplement("registerSVG",vY),kz.registerImplement("unregisterSVG",gY),xj.registerInteraction(Uj.type,Uj),xj.registerInteraction(Yj.type,Yj)},t5=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return S(i,e),i.prototype._isValidSeries=function(e){return e===t.SeriesTypeEnum.map},i.prototype._getDefaultSeriesSpec=function(t){return e.prototype._getDefaultSeriesSpec.call(this,t,["type","nameField","valueField","map","nameProperty","centroidProperty","nameMap","area","defaultFillColor","showDefaultName"])},i.prototype.transformSpec=function(t){e.prototype.transformSpec.call(this,t),t.region.forEach((function(t){t.coordinate="geo"})),e.prototype.transformSeriesSpec.call(this,t)},i}(zK),e5=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=t5,i.type="map",i.seriesType=t.SeriesTypeEnum.map,i}return S(i,e),i.type="map",i.seriesType=t.SeriesTypeEnum.map,i.transformerConstructor=t5,i}(OK),i5=function(){MZ(),kz.registerChart(e5.type,e5)},n5=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._isValidSeries=function(t){return!this.seriesType||t===this.seriesType},e.prototype.getIndicatorSpec=function(t){var e,i,n,r=xt(t.indicator),a=null!==(e=t.innerRadius)&&void 0!==e?e:null===(n=null===(i=t.series)||void 0===i?void 0:i[0])||void 0===n?void 0:n.innerRadius;return N(a)&&r.forEach((function(t){j(t.limitRatio)&&(t.limitRatio=a)})),r},e.prototype._getDefaultSeriesSpec=function(e,i){return t.prototype._getDefaultSeriesSpec.call(this,e,["radius","outerRadius","innerRadius","startAngle","endAngle","sortDataByAxis"],i)},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),X(e.dataZoom)&&e.dataZoom.length>0&&e.dataZoom.forEach((function(t){"axis"===t.filterMode&&(t.filterMode="filter")})),this.transformSeriesSpec(e),N(e.indicator)&&(e.indicator=this.getIndicatorSpec(e))},e}(zK),r5=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype.needAxes=function(){return!1},e.prototype._getDefaultSeriesSpec=function(e){var i=t.prototype._getDefaultSeriesSpec.call(this,e,["startAngle","endAngle","centerX","centerY"]);return i.categoryField=e.categoryField||e.radiusField,i.valueField=e.valueField||e.angleField,i},e.prototype._transformProgressAxisSpec=function(t,e,i,n,r){var a,o;t.axes||(t.axes=[]);var s=(null!==(a=t.axes)&&void 0!==a?a:[]).find((function(t){return"radius"===t.orient})),l=(null!==(o=t.axes)&&void 0!==o?o:[]).find((function(t){return"angle"===t.orient}));l||(l=e,t.axes.push(l)),s||(s=i,t.axes.push(s)),j(l.type)&&(l.type="linear"),j(s.type)&&(s.type="band");var u=XX(l,{min:0,max:1});j(l.min)&&(l.min=u.min),j(l.max)&&(l.max=u.max),n&&Object.assign(l,xz({},n,l)),r&&Object.assign(s,xz({},r,s))},e}(n5),a5=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype.needAxes=function(){return!0},e.prototype._getDefaultSeriesSpec=function(e){var i=t.prototype._getDefaultSeriesSpec.call(this,e);return i.categoryField=e.categoryField||e.angleField,i.valueField=e.valueField||e.radiusField,i},e.prototype.transformSpec=function(e){var i;if(t.prototype.transformSpec.call(this,e),this.needAxes()){e.axes||(e.axes=[]);var n={radius:!1,angle:!1};(null!==(i=e.axes)&&void 0!==i?i:[]).forEach((function(t){var e=t.orient;"radius"===e&&(n.radius=!0),"angle"===e&&(n.angle=!0)})),n.angle||e.axes.push({orient:"angle"}),n.radius||e.axes.push({orient:"radius"})}},e}(n5),o5=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype.needAxes=function(){return!1},e.prototype._getDefaultSeriesSpec=function(e){var i,n=t.prototype._getDefaultSeriesSpec.call(this,e,["center","centerOffset","cornerRadius","padAngle","minAngle","emptyPlaceholder","showAllZero","supportNegative","layoutRadius"]);return n.categoryField=e.categoryField||e.seriesField,n.valueField=e.valueField||e.angleField,n.emptyCircle=null===(i=e.emptyPlaceholder)||void 0===i?void 0:i.emptyCircle,n},e}(n5),s5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.transformerConstructor=o5,e}return S(e,t),e.transformerConstructor=o5,e}(OK),l5=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=o5,i.type="pie",i.seriesType=t.SeriesTypeEnum.pie,i}return S(i,e),i.type="pie",i.seriesType=t.SeriesTypeEnum.pie,i.transformerConstructor=o5,i}(s5),u5=function(){tQ(),kz.registerChart(l5.type,l5)},c5=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),e.series.forEach((function(t){"pie3d"===t.type&&(t.angle3d=e.angle3d)}))},e}(o5),h5=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=c5,i.type="pie3d",i.seriesType=t.SeriesTypeEnum.pie3d,i}return S(i,e),i.type="pie3d",i.seriesType=t.SeriesTypeEnum.pie3d,i.transformerConstructor=c5,i}(s5),d5=function(){Rq(),aQ(),kz.registerChart(h5.type,h5)},p5=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i,n,r,a=t.prototype._getDefaultSeriesSpec.call(this,e);return a.radius=null!==(i=e.radius)&&void 0!==i?i:UF,a.outerRadius=null!==(n=e.outerRadius)&&void 0!==n?n:UF,a.innerRadius=null!==(r=e.innerRadius)&&void 0!==r?r:0,a.stack=e.stack,a.percent=e.percent,a},e.prototype.transformSpec=function(e){var i;t.prototype.transformSpec.call(this,e),(null!==(i=e.axes)&&void 0!==i?i:[]).forEach((function(t){["domainLine","grid","label","tick"].forEach((function(e){t[e]||(t[e]={visible:!1})})),"angle"===t.orient&&j(t.bandPosition)&&(t.bandPosition=.5)})),e.crosshair=xt(e.crosshair||{}).map((function(t){return xz({categoryField:{visible:!0,line:{visible:!0,type:"rect"}}},t)}))},e}(a5),f5=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=p5,i.type="rose",i.seriesType=t.SeriesTypeEnum.rose,i}return S(i,e),i.type="rose",i.seriesType=t.SeriesTypeEnum.rose,i.transformerConstructor=p5,i}(OK);bt(f5,WK);var v5=function(){kQ(),kz.registerChart(f5.type,f5)},g5=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i,n=t.prototype._getDefaultSeriesSpec.call(this,e);return n.line=e.line,n.point=e.point,n.stack=e.stack,n.percent=e.percent,n.area=xz({visible:!1},e.area),n.seriesMark=null!==(i=e.seriesMark)&&void 0!==i?i:"area",n.activePoint=e.activePoint,n.pointDis=e.pointDis,n.pointDisMul=e.pointDisMul,n.markOverlap=e.markOverlap,n},e.prototype.transformSpec=function(e){var i;t.prototype.transformSpec.call(this,e),(null!==(i=e.axes)&&void 0!==i?i:[]).forEach((function(t){"radius"===t.orient&&(["domainLine","label","tick"].forEach((function(e){t[e]||(t[e]={visible:!1})})),t.grid||(t.grid={visible:!0}))})),e.crosshair=xt(e.crosshair||{}).map((function(t){return xz({categoryField:{visible:!0,line:{visible:!0,type:"line"}}},t)}))},e}(a5),y5=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=g5,i.type="radar",i.seriesType=t.SeriesTypeEnum.radar,i}return S(i,e),i.type="radar",i.seriesType=t.SeriesTypeEnum.radar,i.transformerConstructor=g5,i}(OK);bt(y5,WK);var m5=function(){OQ(),kz.registerChart(y5.type,y5)},_5=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i=t.prototype._getDefaultSeriesSpec.call(this,e);return delete i.data,i},e.prototype._transformAxisSpec=function(t){var e=this;t.axes&&t.autoBandSize&&t.series.forEach((function(i,n){var r;if("bar"===i.type){var a=e._findBandAxisBySeries(i,n,t.axes);if(a&&!a.bandSize&&!a.maxBandSize&&!a.minBandSize){var o=V(i.autoBandSize)&&null!==(r=i.autoBandSize.extend)&&void 0!==r?r:0,s=i.barMaxWidth,l=i.barMinWidth,u=i.barWidth,c=i.barGapInGroup;e._applyAxisBandSize(a,o,{barMaxWidth:s,barMinWidth:l,barWidth:u,barGapInGroup:c})}}}))},e.prototype.transformSpec=function(e){var i=this;if(t.prototype.transformSpec.call(this,e),e.series&&e.series.length){var n=this._getDefaultSeriesSpec(e);e.series.forEach((function(t){i._isValidSeries(t.type)&&Object.keys(n).forEach((function(e){e in t||(t[e]=n[e])}))}))}e.axes&&e.axes.length&&e.axes.forEach((function(t){st(t,"trimPadding")&&xz(t,_U(i.type,e))})),this._transformAxisSpec(e)},e}(zK),b5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.transformerConstructor=_5,e.type="common",e}return S(e,t),e.type="common",e.transformerConstructor=_5,e}(OK);bt(b5,WK);var x5=function(){kz.registerChart(b5.type,b5)},k5=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return S(i,e),i.prototype._getSeriesDataLength=function(t,e){var i,n;if(e.data){var r=xt(e.data)[0];return r instanceof Ms?null===(i=r.latestData)||void 0===i?void 0:i.length:null===(n=r.values)||void 0===n?void 0:n.length}var a=xt(t.data).find((function(t,i){return e.dataId?t instanceof Ms?t.name===e.dataId:t.id===e.dataId:e.dataIndex===i}));return a?a instanceof Ms?a.latestData.length:a.values.length:0},i.prototype.addAttrToComponentSpec=function(t,e,i){return Array.isArray(t)?t[0][e]=i:t[e]=i,t},i.prototype.addPaddingRow=function(t,e,i){t.push({index:e,size:i})},i.prototype.addOrientAxes=function(t,e,i,n){t.push({id:"regionAxesRow".concat(i)}),e.push({modelId:"axesRow".concat(i),col:1,row:i}),n.axes[0].id="axesRow".concat(i),n.axes[0].regionIndex=Array.from(Array(n.series.length),(function(t,e){return"top"===n.axes[0].orient?e+1:e}))},i.prototype.transformSpec=function(i){var n,r,a,o,s,l,u,c,h,d,p,f,v,g,y,m=this;e.prototype.transformSpec.call(this,i);var _=0,b=[],x=[],k=[],S=[],M=[],w=(this._option.getCompiler().getVGrammarView().width(),this._option.getCompiler().getVGrammarView().height()),T=0;if(null==i?void 0:i.legends){b.push({modelId:"legendRow".concat(_),col:1,row:_}),this.addAttrToComponentSpec(i.legends,"id","legendRow".concat(_));var C=xt(i.legends),R=null!==(n=C[0].height)&&void 0!==n?n:40;if(C[0].padding){var B=bF(C[0].padding);R+=Number(null!==(r=null==B?void 0:B.bottom)&&void 0!==r?r:0),R+=Number(null!==(a=null==B?void 0:B.top)&&void 0!==a?a:0),C[0].offsetY=Number(null!==(s=null===(o=C[0])||void 0===o?void 0:o.offsetY)&&void 0!==s?s:0)+Number(null!==(l=null==B?void 0:B.top)&&void 0!==l?l:0)}M.push({index:_,size:R}),T+=R,_++}(null==i?void 0:i.dataZoom)&&(b.push({modelId:"dataZoomRow".concat(_),col:1,row:_}),this.addAttrToComponentSpec(i.dataZoom,"id","dataZoomRow".concat(_)),T+=60,_++,this.addPaddingRow(M,_,10),T+=10,_++),T+=60,null!==i.axes&&"top"!==(null===(c=null===(u=null==i?void 0:i.axes)||void 0===u?void 0:u[0])||void 0===c?void 0:c.orient)||(this.addOrientAxes(x,b,_,i),_++);var I=i.series.filter((function(e){return e.type!==t.SeriesTypeEnum.link})).length,L=(w-T-20*I)/I,D=(null===(h=null==i?void 0:i.appendPadding)||void 0===h?void 0:h.left)||0,O=(null===(d=null==i?void 0:i.appendPadding)||void 0===d?void 0:d.right)||0;null===(p=null==i?void 0:i.series)||void 0===p||p.forEach((function(e){var n,r;if([t.SeriesTypeEnum.bar,t.SeriesTypeEnum.line,t.SeriesTypeEnum.area,t.SeriesTypeEnum.dot].includes(e.type)){if(b.push({modelId:"".concat(e.type,"Row").concat(_),col:1,row:_}),b.push({modelId:"axesLeftRow".concat(_),col:0,row:_}),x.push({id:"".concat(e.type,"Row").concat(_),clip:!1}),M.push({index:_,size:(null==e?void 0:e.height)||L}),k.push({orient:"left",id:"axesLeftRow".concat(_),type:e.type===t.SeriesTypeEnum.dot?"band":"linear",visible:e.type!==t.SeriesTypeEnum.dot,title:{visible:!0,autoRotate:!1,style:{text:null==e?void 0:e.barTitle,dx:-20,textBaseline:"middle",textAlign:"end"}},grid:{visible:"boolean"!=typeof(null===(n=null==e?void 0:e.grid)||void 0===n?void 0:n.visible)||(null===(r=null==e?void 0:e.grid)||void 0===r?void 0:r.visible),style:function(t,i){var n,r,a,o,s,l=0;if(0===i){var u=null===(n=null==e?void 0:e.grid)||void 0===n?void 0:n.style;l=null!==(a=null!==(r=null==u?void 0:u.lineWidth)&&void 0!==r?r:null==u?void 0:u.strokeWidth)&&void 0!==a?a:1}return{lineWidth:l,stroke:(null===(s=null===(o=null==e?void 0:e.grid)||void 0===o?void 0:o.style)||void 0===s?void 0:s.stroke)||"#dfdfdf",lineDash:[0,0]}}},domainLine:{visible:!1},tick:{visible:!1},label:{visible:!1},regionIndex:x.length-1}),e.type===t.SeriesTypeEnum.dot){b.push({modelId:"scrollBarRightRow".concat(_),col:2,row:_});var a=m._getSeriesDataLength(i,e),o=0;a&&(o=((null==e?void 0:e.height)||L)/(30*a)),S.push(A({orient:"right",visible:e.type===t.SeriesTypeEnum.dot&&o<1,id:"scrollBarRightRow".concat(_),start:0,end:Math.min(o,1),filterMode:"axis",regionIndex:x.length-1,axisId:"axesLeftRow".concat(_)},xt(null==i?void 0:i.scrollBar)[0]))}e.regionIndex=x.length-1,_++,m.addPaddingRow(M,_,(null==e?void 0:e.padding)||20),_++,e.leftAppendPadding=D,e.type===t.SeriesTypeEnum.dot&&(e.title.style.dx=-D,e.subTitle.style.dx=-D)}})),this.addPaddingRow(M,_,20),_++,null===(f=null==i?void 0:i.series)||void 0===f||f.forEach((function(e){if(e.type===t.SeriesTypeEnum.link){var n=e.dotSeriesIndex+1;b.push({modelId:"".concat(e.type,"Row").concat(n),col:1,row:n-1}),e.regionIndex=i.series[e.dotSeriesIndex].regionIndex,e.leftAppendPadding=D,e.height=i.series[e.dotSeriesIndex].height,e.clipHeight=i.series[e.dotSeriesIndex].clipHeight}})),(null==i?void 0:i.legends)&&this.addAttrToComponentSpec(i.legends,"regionIndex",[x.length-1]),"bottom"===(null===(g=null===(v=null==i?void 0:i.axes)||void 0===v?void 0:v[0])||void 0===g?void 0:g.orient)&&(this.addOrientAxes(x,b,_,i),_++);var F={type:"grid",col:4,row:_,colWidth:[{index:0,size:D},{index:2,size:12},{index:3,size:O}],rowHeight:M,elements:b};i.layout=F,i.region=x,null===(y=i.axes)||void 0===y||y.push.apply(y,P([],E(k),!1)),i.scrollBar=S},i}(zK),S5=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.transformerConstructor=k5,t.type="sequence",t}return S(i,e),i.prototype._createSeries=function(e,i){if(e){var n,r=i.spec,a=M(i,["spec"]);if(r.type===t.SeriesTypeEnum.link&&(r.dotSeriesSpec=this._spec.series[r.dotSeriesIndex]),r.regionId&&(n=this.getRegionsInUserId(r.regionId)),n||(n=this.getRegionsInIndex(r.regionIndex?[r.regionIndex]:void 0)[0]),n){var o=new e(r,A(A(A({},this._modelOption),a),{region:n,specKey:"series",globalScale:this._globalScale}));o&&(o.created(),this._series.push(o),n.addSeries(o))}}},i.type="sequence",i.transformerConstructor=k5,i}(OK),A5=function(){VQ(),XQ(),MK(),kK(),kz.registerChart(S5.type,S5)},M5=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),e.axes.forEach((function(t){return t.type="linear"}))},e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["x2Field","y2Field","barMinHeight","barBackground"])},e}(HK),w5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.transformerConstructor=M5,e}return S(e,t),e.transformerConstructor=M5,e}(OK);bt(w5,WK);var T5=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),gU(e)},e}(M5),C5=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=T5,i.type="histogram",i.seriesType=t.SeriesTypeEnum.bar,i}return S(i,e),i.type="histogram",i.seriesType=t.SeriesTypeEnum.bar,i.transformerConstructor=T5,i}(w5),E5=function(){bq(),kz.registerChart(C5.type,C5)},P5=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=T5,i.type="histogram3d",i.seriesType=t.SeriesTypeEnum.bar3d,i}return S(i,e),i.type="histogram3d",i.seriesType=t.SeriesTypeEnum.bar3d,i.transformerConstructor=T5,i}(w5),R5=function(){Rq(),Eq(),kz.registerChart(P5.type,P5)},B5=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i,n,r=t.prototype._getDefaultSeriesSpec.call(this,e);return r.progress=e.progress,r.track=e.track,r.tickMask=e.tickMask,r.cornerRadius=null!==(i=e.cornerRadius)&&void 0!==i?i:0,r.roundCap=null!==(n=e.roundCap)&&void 0!==n&&n,r},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),this._transformProgressAxisSpec(e,{orient:"angle",visible:!1},{orient:"radius",visible:!1},{forceInitTick:e.tickMask&&!1!==e.tickMask.visible})},e}(r5),I5=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=B5,i.type="circularProgress",i.seriesType=t.SeriesTypeEnum.circularProgress,i}return S(i,e),i.type="circularProgress",i.seriesType=t.SeriesTypeEnum.circularProgress,i.transformerConstructor=B5,i}(OK);bt(I5,WK);var L5=function(){i$(),kz.registerChart(I5.type,I5)},D5=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return S(i,e),i.prototype._getDefaultSeriesSpec=function(t){var i=e.prototype._getDefaultSeriesSpec.call(this,t);return i.radiusField=t.radiusField,i.pin=t.pin,i.pinBackground=t.pinBackground,i.pointer=t.pointer,i},i.prototype._getDefaultCircularProgressSeriesSpec=function(i){var n=e.prototype._getDefaultSeriesSpec.call(this,i);return n.type=t.SeriesTypeEnum.circularProgress,n},i.prototype.transformSpec=function(i){var n,r,a,o,s;e.prototype.transformSpec.call(this,i);var l=null===(n=i.series)||void 0===n?void 0:n.find((function(e){return e.type===t.SeriesTypeEnum.gauge||e.type===t.SeriesTypeEnum.circularProgress}));j(l)&&("circularProgress"===(l=null!==(r=i.gauge)&&void 0!==r?r:this._getDefaultCircularProgressSeriesSpec(i)).type&&(j(l.radiusField)&&j(l.categoryField)&&(l.radiusField=null!==(o=null!==(a=i.radiusField)&&void 0!==a?a:i.categoryField)&&void 0!==o?o:i.seriesField),j(l.valueField)&&j(l.angleField)&&(l.valueField=null!==(s=i.valueField)&&void 0!==s?s:i.angleField)),1===i.series.length?i.series.push(l):i.series.forEach((function(t){t.type===l.type&&Object.keys(l).forEach((function(e){e in t||(t[e]=l[e])}))}))),l.type===t.SeriesTypeEnum.circularProgress?this._transformProgressAxisSpec(i,{orient:"angle",visible:!0,domainLine:{visible:!1},grid:{visible:!1}},{orient:"radius",visible:!1},{zIndex:wU.Region+50}):this._transformGaugeAxisSpec(i)},i.prototype._transformGaugeAxisSpec=function(t){var e;t.axes||(t.axes=[]);var i={radius:null,angle:null};(null!==(e=t.axes)&&void 0!==e?e:[]).forEach((function(t){var e=t.orient;"radius"===e&&(i.radius=t),"angle"===e&&(i.angle=t)})),i.angle||(i.angle={orient:"angle",visible:!0},t.axes.push(i.angle)),i.radius||(i.radius={orient:"radius",visible:!1},t.axes.push(i.radius)),j(i.angle.type)&&(i.angle.type="linear"),j(i.radius.type)&&(i.radius.type="linear"),j(i.angle.zIndex)&&(i.angle.zIndex=wU.Region+50)},i}(r5),O5=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=D5,i.type="gauge",i.seriesType=t.SeriesTypeEnum.gaugePointer,i}return S(i,e),i.type="gauge",i.seriesType=t.SeriesTypeEnum.gaugePointer,i.transformerConstructor=D5,i}(OK),F5=function(){E2(),B2(),i$(),kz.registerChart(O5.type,O5)},z5=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),this.transformSeriesSpec(e)},e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["nameField","valueField","fontFamilyField","fontWeightField","fontStyleField","colorHexField","colorMode","colorList","rotateAngles","fontWeightRange","fontSizeRange","maskShape","keepAspect","random","wordCloudConfig","wordCloudShapeConfig","word","fillingWord","wordMask"])},e}(zK),H5=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=z5,i.type="wordCloud",i.seriesType=t.SeriesTypeEnum.wordCloud,i}return S(i,e),i.transformerConstructor=z5,i}(OK),j5=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=z5,i.type="wordCloud",i.seriesType=t.SeriesTypeEnum.wordCloud,i}return S(i,e),i.type="wordCloud",i.seriesType=t.SeriesTypeEnum.wordCloud,i.transformerConstructor=z5,i}(H5),N5=function(){d0(),kz.registerChart(j5.type,j5)},V5=function(){c0(),d0(),N5()},W5=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i=t.prototype._getDefaultSeriesSpec.call(this,e);return i.depth_3d=e.depth_3d,i},e}(z5),G5=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=W5,i.type="wordCloud3d",i.seriesType=t.SeriesTypeEnum.wordCloud3d,i}return S(i,e),i.type="wordCloud3d",i.seriesType=t.SeriesTypeEnum.wordCloud3d,i.transformerConstructor=W5,i}(H5),U5=function(){Rq(),f0(),kz.registerChart(G5.type,G5)},Y5=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype.needAxes=function(){return!1},e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["categoryField","valueField","funnelAlign","funnelOrient","heightRatio","shape","funnel","transform","outerLabel","transformLabel","isTransform","maxSize","minSize","gap","isCone","range","transformRatioText"])},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),t.prototype.transformSeriesSpec.call(this,e)},e}(zK),X5=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=Y5,i.type="funnel",i.seriesType=t.SeriesTypeEnum.funnel,i}return S(i,e),i.type="funnel",i.seriesType=t.SeriesTypeEnum.funnel,i.transformerConstructor=Y5,i}(OK),K5=function(){D0(),kz.registerChart(X5.type,X5)},q5=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=Y5,i.type="funnel3d",i.seriesType=t.SeriesTypeEnum.funnel3d,i}return S(i,e),i.type="funnel3d",i.seriesType=t.SeriesTypeEnum.funnel3d,i.transformerConstructor=Y5,i}(OK),Z5=function(){Rq(),j0(),kz.registerChart(q5.type,q5)},J5=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype.needAxes=function(){return!1},e.prototype._getDefaultSeriesSpec=function(e){var i,n,r=t.prototype._getDefaultSeriesSpec.call(this,e,["bandWidth","progress","track","clamp"]);return r.direction=null!==(i=e.direction)&&void 0!==i?i:"horizontal",r.cornerRadius=null!==(n=e.cornerRadius)&&void 0!==n?n:0,r},e.prototype.transformSpec=function(e){var i,n;if(t.prototype.transformSpec.call(this,e),e.axes||(e.axes=[]),"vertical"===e.direction){var r=null,a=null;(null!==(i=e.axes)&&void 0!==i?i:[]).forEach((function(t){var e=t.orient;"left"===e&&(r=t),"bottom"===e&&(a=t)})),r||(r={orient:"left",visible:!1},e.axes.push(r)),a||(a={orient:"bottom",visible:!1},e.axes.push(a)),j(a.type)&&(a.type="band"),j(r.type)&&(r.type="linear");var o=XX(r,{min:0,max:1});j(r.min)&&(r.min=o.min),j(r.max)&&(r.max=o.max)}else{var s=null,l=null;(null!==(n=e.axes)&&void 0!==n?n:[]).forEach((function(t){var e=t.orient;"left"===e&&(s=t),"bottom"===e&&(l=t)})),s||(s={type:"band",orient:"left",visible:!1},e.axes.push(s)),l||(l={orient:"bottom",visible:!1},e.axes.push(l)),j(l.type)&&(l.type="linear"),j(s.type)&&(s.type="band");o=XX(l,{min:0,max:1});j(l.min)&&(l.min=o.min),j(l.max)&&(l.max=o.max)}},e}(HK),Q5=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=J5,i.type="linearProgress",i.seriesType=t.SeriesTypeEnum.linearProgress,i}return S(i,e),i.type="linearProgress",i.seriesType=t.SeriesTypeEnum.linearProgress,i.transformerConstructor=J5,i}(OK);bt(Q5,WK);var $5=function(){d$(),kz.registerChart(Q5.type,Q5)},t4=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i,n,r=t.prototype._getDefaultSeriesSpec.call(this,e,["barWidth","barMaxWidth","barMinWidth","barGapInGroup","barBackground","barMinHeight","stackCornerRadius","bar"]);return"horizontal"===e.direction?r.xField=null!==(i=e.xField)&&void 0!==i?i:[e.minField,e.maxField]:r.yField=null!==(n=e.yField)&&void 0!==n?n:[e.minField,e.maxField],r},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),gU(e)},e}(HK),e4=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=t4,i.type="rangeColumn",i.seriesType=t.SeriesTypeEnum.rangeColumn,i}return S(i,e),i.type="rangeColumn",i.seriesType=t.SeriesTypeEnum.rangeColumn,i.transformerConstructor=t4,i}(OK),i4=function(){AJ(),kz.registerChart(e4.type,e4)},n4=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i,n,r=t.prototype._getDefaultSeriesSpec.call(this,e,["bar3d","barGapInGroup"]);return"horizontal"===e.direction?r.xField=null!==(i=e.xField)&&void 0!==i?i:[e.minField,e.maxField]:r.yField=null!==(n=e.yField)&&void 0!==n?n:[e.minField,e.maxField],r},e}(HK),r4=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=n4,i.type="rangeColumn3d",i.seriesType=t.SeriesTypeEnum.rangeColumn3d,i}return S(i,e),i.type="rangeColumn3d",i.seriesType=t.SeriesTypeEnum.rangeColumn3d,i.transformerConstructor=n4,i}(OK),a4=function(){Rq(),wJ(),kz.registerChart(r4.type,r4)},o4=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i=N(e.startAngle)?e.startAngle:-90,n=N(e.endAngle)?e.endAngle:i+Te(2*Math.PI),r=t.prototype._getDefaultSeriesSpec.call(this,e,["categoryField","valueField","centerX","centerY","offsetX","offsetY","innerRadius","outerRadius","gap","labelLayout","label","labelAutoVisible","drill","drillField"]);return r.startAngle=i,r.endAngle=n,r},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),this.transformSeriesSpec(e)},e}(zK),s4=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=o4,i.type="sunburst",i.seriesType=t.SeriesTypeEnum.sunburst,i}return S(i,e),i.type="sunburst",i.seriesType=t.SeriesTypeEnum.sunburst,i.transformerConstructor=o4,i}(OK),l4=function(){L1(),kz.registerChart(s4.type,s4)},u4=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["categoryField","valueField","layoutPadding","circlePacking","drill","drillField"])},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),this.transformSeriesSpec(e)},e}(zK),c4=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=u4,i.type="circlePacking",i.seriesType=t.SeriesTypeEnum.circlePacking,i}return S(i,e),i.type="circlePacking",i.seriesType=t.SeriesTypeEnum.circlePacking,i.transformerConstructor=u4,i}(OK),h4=function(){j1(),kz.registerChart(c4.type,c4)},d4=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["categoryField","valueField","aspectRatio","splitType","maxDepth","gapWidth","nodePadding","minVisibleArea","minChildrenVisibleArea","minChildrenVisibleSize","roam","drill","drillField","leaf","nonLeaf","nonLeafLabel"])},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),this.transformSeriesSpec(e)},e}(zK),p4=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=d4,i.type="treemap",i.seriesType=t.SeriesTypeEnum.treemap,i}return S(i,e),i.type="treemap",i.seriesType=t.SeriesTypeEnum.treemap,i.transformerConstructor=d4,i}(OK),f4=function(){x2(),kz.registerChart(p4.type,p4)},v4=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),e.legends&&xt(e.legends).forEach((function(t){t.select=!1,t.hover=!1,t.filter=!1})),gU(e)},e.prototype._getDefaultSeriesSpec=function(e){var i=t.prototype._getDefaultSeriesSpec.call(this,e);return i.bar=e.bar,i.stackLabel=e.stackLabel,i.leaderLine=e.leaderLine,i.total=e.total,i},e}(xq),g4=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=v4,i.type="waterfall",i.seriesType=t.SeriesTypeEnum.waterfall,i}return S(i,e),i.type="waterfall",i.seriesType=t.SeriesTypeEnum.waterfall,i.transformerConstructor=v4,i}(kq),y4=function(){eJ(),kz.registerChart(g4.type,g4)},m4=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i,n=[e.maxField,e.medianField,e.q1Field,e.q3Field,e.minField,e.outliersField],r=t.prototype._getDefaultSeriesSpec.call(this,e,["boxPlot","minField","maxField","q1Field","medianField","q3Field","outliersField","outliersStyle"]);return r.direction=null!==(i=e.direction)&&void 0!==i?i:"vertical",r["horizontal"===r.direction?"xField":"yField"]=n,r},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),e.axes||(e.axes=[{orient:"bottom"},{orient:"left"}]),gU(e)},e}(HK),_4=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=m4,i.type="boxPlot",i.seriesType=t.SeriesTypeEnum.boxPlot,i}return S(i,e),i.type="boxPlot",i.seriesType=t.SeriesTypeEnum.boxPlot,i.transformerConstructor=m4,i}(OK),b4=function(){cJ(),kz.registerChart(_4.type,_4)},x4=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["categoryField","valueField","sourceField","targetField","direction","nodeAlign","crossNodeAlign","nodeGap","nodeWidth","linkWidth","minStepWidth","minNodeHeight","maxNodeHeight","minLinkHeight","maxLinkHeight","dropIsolatedNode","nodeHeight","linkHeight","equalNodeHeight","linkOverlap","iterations","nodeKey","linkSortBy","nodeSortBy","setNodeLayer","node","link","emphasis","inverse","overflow"])},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),this.transformSeriesSpec(e)},e}(zK),k4=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=x4,i.type="sankey",i.seriesType=t.SeriesTypeEnum.sankey,i}return S(i,e),i.prototype._setStateInDatum=function(t,e,i,n,r){var a=X(i)?i[0]:i;this.filterGraphicsByDatum(a,{filter:function(t,e){return"text"!==e.type&&e.getProduct()&&(!n||n(t,e))},region:r,getDatum:function(t){var e,i=null===(e=t.getDatum())||void 0===e?void 0:e.datum;return X(i)&&(i=i[0]),i},callback:function(t,e,i,n){var r,a,o,s=null===(r=e.getProduct())||void 0===r?void 0:r.id();s&&(s.includes("node")||s.includes("link"))&&(null===(o=(a=i)._handleEmphasisElement)||void 0===o||o.call(a,{item:t}))},regionCallback:function(i,n){a?i.length&&(i.forEach((function(e){n.interaction.startInteraction(t,e)})),e&&n.interaction.reverseEventElement(t)):n.interaction.clearEventElement(t,!0)}})},i.type="sankey",i.seriesType=t.SeriesTypeEnum.sankey,i.transformerConstructor=x4,i}(OK),S4=function(){Ac.load(KP),d2(),kz.registerChart(k4.type,k4)},A4=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i,n,r=t.prototype._getDefaultSeriesSpec.call(this,e);return r.area=e.area,"horizontal"===e.direction?r.xField=null!==(i=e.xField)&&void 0!==i?i:[e.minField,e.maxField]:r.yField=null!==(n=e.yField)&&void 0!==n?n:[e.minField,e.maxField],r.stack=!1,r},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),gU(e)},e}(HK),M4=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=A4,i.type="rangeArea",i.seriesType=t.SeriesTypeEnum.rangeArea,i}return S(i,e),i.type="rangeArea",i.seriesType=t.SeriesTypeEnum.rangeArea,i.transformerConstructor=A4,i}(OK),w4=function(){PJ(),kz.registerChart(M4.type,M4)},T4=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["valueField","cell"])},e}(HK),C4=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=T4,i.type="heatmap",i.seriesType=t.SeriesTypeEnum.heatmap,i}return S(i,e),i.type="heatmap",i.seriesType=t.SeriesTypeEnum.heatmap,i.transformerConstructor=T4,i}(OK),E4=function(){V2(),kz.registerChart(C4.type,C4)},P4=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["categoryField","valueField","sizeField","sizeRange","centerX","centerY","innerRadius","outerRadius","startAngle","endAngle","ripplePoint","centerPoint","centerLabel","nodePoint"])},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),this.transformSeriesSpec(e)},e}(zK),R4=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=P4,i.type="correlation",i.seriesType=t.SeriesTypeEnum.correlation,i}return S(i,e),i.type="correlation",i.seriesType=t.SeriesTypeEnum.correlation,i.transformerConstructor=P4,i}(OK),B4=function(){i3(),kz.registerChart(R4.type,R4)};function I4(t){var e,i,n=A({},t);return ot(t.style)||(n.textStyle=GH(t.style)),ot(t.textStyle)||xz(n.textStyle,GH(t.textStyle)),(null===(e=t.shape)||void 0===e?void 0:e.style)&&GH(n.shape.style),(null===(i=t.background)||void 0===i?void 0:i.style)&&GH(n.background.style),n}var L4=function(t,e){var i=[],n={},r=e.series,a=e.seriesField;return r().forEach((function(t){var e=a(t);(e===t.getSeriesField()?t.getSeriesInfoList():t.getSeriesInfoInField(e)).forEach((function(t){n[t.key]||(n[t.key]=!0,i.push(t))}))})),i},D4=function(t,e){var i,n,r,a=e.series,o=e.selected,s=e.field,l=e.data,u=e.customFilter,c=o(),h=l();if(0===c.length&&h.length)return[];if(c.length===h.length)return t;var d={};c.forEach((function(t){d[t]=!0}));var p=null!==(i=s())&&void 0!==i?i:Xz;return u?u(t,c,p):(X(t)&&(null===(n=t[0])||void 0===n?void 0:n.nodes)?(t[0].nodes=t[0].nodes.filter((function(t){return!0===d[t.key]})),(null===(r=t[0])||void 0===r?void 0:r.links)&&(t[0].links=t[0].links.filter((function(t){return!0===d[t.source]&&!0===d[t.target]})))):N(p)&&(t=t.filter((function(t){return!0===d[a.getSeriesFieldValue(t,p)]}))),t)},O4=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.layoutType="normal",e.layoutZIndex=wU.Legend,e.layoutLevel=TU.Legend,e.specKey="legends",e._orient="left",e._visible=!0,e._position="middle",e._preSelectedData=[],e._selectedData=[],e.effect={onSelectedDataChange:function(){XO(e._regions,(function(t){var e;null===(e=t.getViewData())||void 0===e||e.markRunning()}),{userId:e._seriesUserId,specIndex:e._seriesIndex}),XO(e._regions,(function(t){t.reFilterViewData()}),{userId:e._seriesUserId,specIndex:e._seriesIndex})}},e}return S(e,t),Object.defineProperty(e.prototype,"orient",{get:function(){return this._orient},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visible",{get:function(){return this._visible},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this._position},enumerable:!1,configurable:!0}),e.prototype.getLegendData=function(){return this._legendData.getLatestData()},e.prototype.getSelectedData=function(){return this._selectedData},e.prototype.setAttrFromSpec=function(){var e;t.prototype.setAttrFromSpec.call(this),this._orient=gF(this._spec.orient)?this._spec.orient:"left",this._position=null!==(e=this._spec.position)&&void 0!==e?e:"middle",this._visible=!1!==this._spec.visible;var i=this._spec,n=i.regionId,r=i.regionIndex,a=i.seriesId,o=i.seriesIndex;N(a)&&(this._seriesUserId=xt(a)),N(n)&&(this._regionUserId=xt(n)),N(o)&&(this._seriesIndex=xt(o)),N(r)&&(this._regionUserIndex=xt(r)),this._regions=this._option.getRegionsInUserIdOrIndex(this._regionUserId,this._regionUserIndex)},e.prototype.created=function(){t.prototype.created.call(this),this.initData()},e.prototype.onRender=function(t){},e.prototype._compareSpec=function(e,i){var n=t.prototype._compareSpec.call(this,e,i);return n.reRender=!0,(null==e?void 0:e.orient)!==(null==i?void 0:i.orient)?(n.reMake=!0,n):(mt(i,e)||(n.reCompile=!0),n)},e.prototype.changeRegions=function(t){},e.prototype._bindLegendDataChange=function(){this._preSelectedData=this._selectedData.slice(),this._initSelectedData()},e.prototype.initData=function(){var t=this,e=this._initLegendData();e.target.addListener("change",this._bindLegendDataChange.bind(this)),this._legendData=new iY(this._option,e),this._initSelectedData(),XO(this._regions,(function(e){e.event.on(cG.rawDataUpdate,{filter:function(t){var i=t.model;return(null==i?void 0:i.id)===e.id}},(function(){t._legendData.getDataView().reRunAllTransform()}))}),{userId:this._seriesUserId,specIndex:this._seriesIndex})},e.prototype.setSelectedData=function(t){var e,i,n,r=this,a=this._selectedData;j(t)||JSON.stringify(a)===JSON.stringify(t)||(XO(this._regions,(function(e){e.legendSelectedFilter&&(t=e.legendSelectedFilter(r,t))}),{userId:this._seriesUserId,specIndex:this._seriesIndex}),this._selectedData=P([],E(t),!1),null===(i=(e=this.effect).onSelectedDataChange)||void 0===i||i.call(e),this.event.emit(cG.legendSelectedDataChange,{model:this}),null===(n=this._legendComponent)||void 0===n||n.setSelected(this._selectedData))},e.prototype.afterSetLayoutStartPoint=function(e){if(t.prototype.afterSetLayoutStartPoint.call(this,e),this._legendComponent){var i=e.x,n=e.y;Q(i*n)&&this._legendComponent.setAttributes({x:i,y:n})}},e.prototype.getBoundsInRect=function(t,e){var i=this;if(!this._visible)return this._legendComponent&&this._legendComponent.parent&&(this._legendComponent.parent.removeChild(this._legendComponent),this._legendComponent=null),{x1:0,y1:0,x2:0,y2:0};var n={x1:this.getLayoutStartPoint().x,y1:this.getLayoutStartPoint().y,x2:0,y2:0},r=this._getLegendAttributes(t);if(r.disableTriggerEvent=this._option.disableTriggerEvent,this._legendComponent)mt(r,this._cacheAttrs)||this._legendComponent.setAttributes(xz({},r,{defaultSelected:this._selectedData}));else{var a=new(this._getLegendConstructor())(xz({},r,{defaultSelected:this._selectedData}));a.name="legend",this._legendComponent=a,this.getContainer().add(a),this._option.disableTriggerEvent||this._initEvent(),a.on("*",(function(t,e){return i._delegateEvent(i._legendComponent,t,e)}))}this._cacheAttrs=r;var o=isFinite(this._legendComponent.AABBBounds.width())?this._legendComponent.AABBBounds.width():0,s=isFinite(this._legendComponent.AABBBounds.height())?this._legendComponent.AABBBounds.height():0;if("normal-inline"!==this.layoutType){var l="bottom"===this.layoutOrient||"top"===this.layoutOrient?"horizontal":"vertical",u=this._position,c=e.width,h=e.height,d=0,p=0;"horizontal"===l?"middle"===u?d=(c-o)/2:"end"===u&&(d=c-o):"middle"===u?p=(h-s)/2:"end"===u&&(p=h-s),this._legendComponent.setAttributes({dx:d,dy:p})}return n.x2=n.x1+o,n.y2=n.y1+s,n},e.prototype.onDataUpdate=function(){var t,e,i;if(JSON.stringify(this._preSelectedData)!==JSON.stringify(this._selectedData)){if(this._legendComponent){var n=this._getLegendAttributes(this.getLayoutRect());mt(n,this._cacheAttrs)||this._legendComponent.setAttributes(xz({},n,{defaultSelected:this._selectedData}))}null===(e=(t=this.effect).onSelectedDataChange)||void 0===e||e.call(t),null===(i=this.getChart())||void 0===i||i.setLayoutTag(!0,null,!1),this.event.emit(cG.legendSelectedDataChange,{model:this})}},e.prototype._getNeedClearVRenderComponents=function(){return[this._legendComponent]},e.prototype.clear=function(){t.prototype.clear.call(this),this._cacheAttrs=null,this._preSelectedData=null},e.specKey="legends",e}(rK),F4=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=B.discreteLegend,e.name=B.discreteLegend,e}return S(e,t),e.getSpecInfo=function(t){return kY(t,this.specKey,this.type,(function(t){return!t.type||"discrete"===t.type}))},e.prototype.init=function(e){var i=this;t.prototype.init.call(this,e),XO(this._regions,(function(t){t.addViewDataFilter({type:"discreteLegendFilter",options:{series:t,selected:function(){return i._selectedData},field:function(){return i._getSeriesLegendField(t)},data:function(){return i.getLegendDefaultData()},customFilter:i._spec.customFilter},level:nU.legendFilter})}),{userId:this._seriesUserId,specIndex:this._seriesIndex})},e.prototype._initLegendData=function(){var t=this;qG(this._option.dataSet,"discreteLegendFilter",D4),qG(this._option.dataSet,"discreteLegendDataMake",L4);var e=new Ms(this._option.dataSet,{name:"".concat(this.type,"_").concat(this.id,"_data")});return e.transform({type:"discreteLegendDataMake",options:{series:function(){var e=[];return XO(t._regions,(function(t){e.push(t)}),{specIndex:t._spec.seriesIndex,userId:t._spec.seriesId}),e},seriesField:function(e){return t._getSeriesLegendField(e)}}}),e},e.prototype._getSeriesLegendField=function(t){var e,i,n,r=t.getSeriesField(),a=null!==(e=this._spec.scaleName)&&void 0!==e?e:this._spec.scale;if(j(a))return r;if(!t.getRawData())return r;var o=this._option.globalScale.getScaleSpec(a);if(!o)return r;if(this._spec.field)return this._spec.field;if(!Yk(o.domain))return r;var s=o.domain.find((function(e){return e.dataId===t.getRawData().name}));return s&&null!==(n=null===(i=s.fields)||void 0===i?void 0:i[0])&&void 0!==n?n:r},e.prototype._initSelectedData=function(){var t=this,e=this.getLegendDefaultData();if(this._unselectedData){var i=[],n=[];e.forEach((function(e){t._unselectedData.includes(e)?n.push(e):i.push(e)})),this._selectedData=i,this._unselectedData=n}else this._spec.defaultSelected?this._selectedData=P([],E(this._spec.defaultSelected),!1):this._selectedData=e},e.prototype.getLegendDefaultData=function(t){return H(this._spec.data)?this._getLegendItems().map((function(t){return t.label})):this._legendData.getLatestData().map(t?function(t){return t.originalKey}:function(t){return t.key})},e.prototype._addDefaultTitleText=function(t){var e,i,n,r;if((null===(e=t.title)||void 0===e?void 0:e.visible)&&j(t.title.text)&&j(null===(i=t.title.style)||void 0===i?void 0:i.text)){var a=null===(r=null===(n=this._regions)||void 0===n?void 0:n[0])||void 0===r?void 0:r.getSeries()[0];if(!a)return;t.title.text=fH(a.getRawData(),a.getSeriesField())}},e.prototype._getLegendAttributes=function(t){var e="bottom"===this.layoutOrient||"top"===this.layoutOrient?"horizontal":"vertical",i=A(A({layout:e,items:this._getLegendItems(),zIndex:this.layoutZIndex},function(t,e){var i=t.title,n=void 0===i?{}:i,r=t.item,a=void 0===r?{}:r,o=t.pager,s=void 0===o?{}:o,l=t.background,u=void 0===l?{}:l;t.type,t.id,t.visible,t.orient,t.position,t.data,t.filter,t.regionId,t.regionIndex,t.seriesIndex,t.seriesId,t.padding;var c=M(t,["title","item","pager","background","type","id","visible","orient","position","data","filter","regionId","regionIndex","seriesIndex","seriesId","padding"]);return n.visible?c.title=I4(n):c.title={visible:!1},ot(a.focusIconStyle)||GH(a.focusIconStyle),a.shape&&(a.shape=NH(a.shape)),a.label&&(a.label=NH(a.label)),a.value&&(a.value=NH(a.value)),a.background&&(a.background=NH(a.background)),yF(a.maxWidth)&&(a.maxWidth=Number(a.maxWidth.substring(0,a.maxWidth.length-1))*e.width/100),yF(a.width)&&(a.width=Number(a.width.substring(0,a.width.length-1))*e.width/100),yF(a.height)&&(a.height=Number(a.height.substring(0,a.height.length-1))*e.width/100),c.item=a,"scrollbar"===s.type?(ot(s.railStyle)||GH(s.railStyle),ot(s.sliderStyle)||GH(s.sliderStyle)):(ot(s.textStyle)||GH(s.textStyle),s.handler&&NH(s.handler)),c.pager=s,u.visible&&!ot(u.style)&&(xz(c,u.style),N(u.padding)&&(c.padding=u.padding)),c}(this._spec,t)),{maxWidth:t.width,maxHeight:t.height});return this._addDefaultTitleText(i),this._addLegendItemFormatMethods(i),i},e.prototype._getLegendConstructor=function(){return nO},e.prototype.setSelectedData=function(e){e&&(this._unselectedData=this.getLegendDefaultData().filter((function(t){return!e.includes(t)}))),t.prototype.setSelectedData.call(this,e)},e.prototype._initEvent=function(){var t=this;if(this._legendComponent){var e=!1!==this._spec.filter;this._legendComponent.addEventListener(qD.legendItemClick,(function(i){var n=st(i,"detail.currentSelected");e&&t.setSelectedData(n),t.event.emit(cG.legendItemClick,{model:t,value:n,event:i})})),this._legendComponent.addEventListener(qD.legendItemHover,(function(e){var i=st(e,"detail");t.event.emit(cG.legendItemHover,{model:t,value:i,event:e})})),this._legendComponent.addEventListener(qD.legendItemUnHover,(function(e){var i=st(e,"detail");t.event.emit(cG.legendItemUnHover,{model:t,value:i,event:e})}))}},e.prototype._getLegendItems=function(){var t=(this._legendData.getLatestData()||[]).map((function(t){var e,i,n=t.style("fillOpacity"),r=t.style("strokeOpacity"),a=t.style("opacity"),o=t.style("texture");return{label:t.key,shape:{symbolType:null!==(i=null!==(e=t.style("symbolType"))&&void 0!==e?e:t.shapeType)&&void 0!==i?i:"circle",fillOpacity:Q(n)?n:1,strokeOpacity:Q(r)?r:1,opacity:Q(a)?a:1,texturePadding:o?1:null,textureSize:o?4:null,texture:o,fill:t.style("fill"),stroke:t.style("stroke"),textureColor:t.style("textureColor"),innerBorder:t.style("innerBorder"),outerBorder:t.style("outerBorder"),lineDash:t.style("lineDash"),lineDashOffset:t.style("lineDashOffset"),lineWidth:t.style("lineWidth")}}}));return H(this._spec.data)?this._spec.data(t,this._option.globalScale.getScale("color"),this._option.globalScale):t},e.prototype._addLegendItemFormatMethods=function(t){var e,i,n,r,a=null!==(i=null===(e=this._spec.item)||void 0===e?void 0:e.label)&&void 0!==i?i:{},o=a.formatMethod,s=a.formatter,l=null!==(r=null===(n=this._spec.item)||void 0===n?void 0:n.value)&&void 0!==r?r:{},u=l.formatMethod,c=l.formatter,h=xY(o,s).formatFunc;s&&!o&&h&&(t.item.label.formatMethod=function(t,e){return h(t,e,s)});var d=xY(u,c).formatFunc;c&&!u&&d&&(t.item.value.formatMethod=function(t,e){return d(c,t,e,s)})},e.specKey="legends",e.type=B.discreteLegend,e}(O4),z4=function(){kz.registerComponent(F4.type,F4)},H4=function(t,e){var i=e.series,n=e.field,r=e.scale,a=n();if(n&&a){var o=1/0,s=-1/0;return i().forEach((function(t){var e=t.getRawDataStatisticsByField(a,!0),i=null==e?void 0:e.min,n=null==e?void 0:e.max;Q(i)&&(o=Math.min(i,o)),Q(n)&&(s=Math.max(n,s))})),[o,s]}if(r){var l=r();return l?l.domain():[]}return[]},j4=function(t,e){var i=e.selected,n=e.field,r=e.data,a=e.isHierarchyData,o=e.customFilter,s=i(),l=n(),u=a||function(t){return t&&t.some((function(t){return t&&(void 0===i&&(i="children"),!!V(e=t)&&!!e.hasOwnProperty(i)&&Array.isArray(e[i]));var e,i}))};if(s===r())return t;if(l&&!ot(s)){var c=E(s,2),h=c[0],d=c[1];return o?o(t,s,l):u(t)?jH(t,+h,+d,l):t.filter((function(t){return t[l]>=h&&t[l]<=d}))}return t};var N4={color:sO,size:uO},V4=["#C4E7FF","#98CAFF","#75ACFF","#518FF9","#2775DC","#005CBE","#00429F","#00287E"],W4=[2,10],G4=function(t){function e(e,i){var n=t.call(this,e,i)||this;n.type=B.colorLegend,n.name=B.colorLegend;var r="color"===n._spec.type?B.colorLegend:B.sizeLegend;return n.type=r,n.name=r,n}return S(e,t),e.getSpecInfo=function(t){var e=kY(t,this.specKey,this.type,(function(t){return"color"===(e=t.type)||"size"===e;var e}));return e&&e.forEach((function(t){t.type="color"===t.spec.type?B.colorLegend:B.sizeLegend})),e},e.prototype.setAttrFromSpec=function(){t.prototype.setAttrFromSpec.call(this),this._field=this._spec.field,this._legendType=this._spec.type},e.prototype.init=function(e){var i=this;t.prototype.init.call(this,e),XO(this._regions,(function(t){t.addViewDataFilter({type:"continuousLegendFilter",options:{selected:function(){return i._selectedData},field:function(){return i._field},data:function(){return i._legendData.getLatestData()},isHierarchyData:t.isHierarchyData,customFilter:i._spec.customFilter},level:nU.legendFilter})}),{userId:this._seriesUserId,specIndex:this._seriesIndex})},e.prototype._getScaleInGlobal=function(){var t=this._option.globalScale,e=this._spec.scale;return e||(e=this._legendType),t.getScale(e)},e.prototype._initLegendData=function(){var t=this;qG(this._option.dataSet,"continuousLegendFilter",j4),qG(this._option.dataSet,"continuousLegendDataMake",H4);var e=new Ms(this._option.dataSet,{name:"".concat(this.type,"_").concat(this.id,"_data")});return e.transform({type:"continuousLegendDataMake",options:{series:function(){return KO(t._regions,{userId:t._seriesUserId,specIndex:t._seriesIndex})},field:function(){return t._field},scale:this._getScaleInGlobal.bind(this)}}),e},e.prototype._initSelectedData=function(){this._spec.defaultSelected?this._selectedData=this._spec.defaultSelected.slice():this._selectedData=this._legendData.getLatestData()},e.prototype._addDefaultTitleText=function(t){var e,i,n,r;if((null===(e=t.title)||void 0===e?void 0:e.visible)&&j(t.title.text)&&j(null===(i=t.title.style)||void 0===i?void 0:i.text)){var a=this._field;if(a){var o=null===(r=null===(n=this._regions)||void 0===n?void 0:n[0])||void 0===r?void 0:r.getSeries()[0];if(!o)return;return void(t.title.text=fH(o.getRawData(),a))}var s=this._spec.scale;s||(s=this._legendType);var l=this._option.globalScale.getScaleSpec(s);if(!Yk(null==l?void 0:l.domain))return;var u=l.domain[0];if(0===u.fields.length)return;t.title.text=fH(this._option.dataSet.getDataView(u.dataId),u.fields[0])}else;},e.prototype._getLegendAttributes=function(t){var e,i,n,r="bottom"===this.layoutOrient||"top"===this.layoutOrient?"horizontal":"vertical",a="horizontal"===r?"bottom":this.layoutOrient,o=[],s=this._getScaleInGlobal();s&&"linear"===s.type&&(o=s.range()),ot(o)&&(o="color"===this._legendType?V4:W4);var l=null!==(i=this._legendData.getLatestData()[0])&&void 0!==i?i:0,u=null!==(n=this._legendData.getLatestData()[1])&&void 0!==n?n:1;this._legendData.getLatestData()[0]===this._legendData.getLatestData()[1]&&(l=Math.min(0,this._legendData.getLatestData()[0]),u=0===this._legendData.getLatestData()[0]?1:Math.max(0,this._legendData.getLatestData()[0]));var c=A(((e={layout:r,align:a,zIndex:this.layoutZIndex,min:l,max:u,value:this._spec.defaultSelected})["color"===this._legendType?"colors":"sizeRange"]=o,e),function(t){var e=xz({},t),i=e.title,n=void 0===i?{}:i,r=e.handler,a=void 0===r?{}:r,o=e.rail,s=void 0===o?{}:o,l=e.track,u=void 0===l?{}:l,c=e.startText,h=e.endText,d=e.handlerText,p=e.sizeBackground,f=e.background,v=void 0===f?{}:f;e.type,e.id,e.visible,e.orient,e.position,e.data,e.defaultSelected,e.field,e.filter,e.regionId,e.regionIndex,e.seriesIndex,e.seriesId,e.padding;var g=M(e,["title","handler","rail","track","startText","endText","handlerText","sizeBackground","background","type","id","visible","orient","position","data","defaultSelected","field","filter","regionId","regionIndex","seriesIndex","seriesId","padding"]);return n.visible?g.title=I4(n):g.title={visible:!1},g.showHandler=!1!==a.visible,ot(a.style)||(g.handlerStyle=GH(a.style)),N(s.width)&&(g.railWidth=s.width),N(s.height)&&(g.railHeight=s.height),ot(s.style)||(g.railStyle=GH(s.style)),ot(u.style)||(g.trackStyle=GH(u.style)),g.startText=NH(c),g.endText=NH(h),g.handlerText=NH(d),ot(p)||(g.sizeBackground=GH(p)),v.visible&&!ot(v.style)&&(xz(g,v.style),N(v.padding)&&(g.padding=v.padding)),g}(this._spec));return this._addDefaultTitleText(c),c},e.prototype._getLegendConstructor=function(){return N4[this._legendType]},e.prototype._initEvent=function(){var t=this;if(this._legendComponent){var e=!1!==this._spec.filter;this._legendComponent.addEventListener("change",qt((function(i){var n=st(i,"detail.value");e&&t.setSelectedData(n),t.event.emit(cG.legendFilter,{model:t,value:n,event:i})}),30))}},e.specKey="legends",e.type=B.continuousLegend,e}(O4),U4=function(){kz.registerComponent(G4.type,G4)},Y4=function(t,e){return N(e)?t.map((function(t){return e[t]})):void 0},X4=function(t,e){return function(i){return t.every((function(t,n){return i[t]===(null==e?void 0:e[n])}))}},K4=function(t){return!j(t)&&(X(t)?t.length>0&&t.every(N):Object.keys(t).length>0)};function q4(t,e,i){var n,r,a,o=A({regionIndex:0},e),s=i.getOption(),l=s.getRegionsInUserIdOrIndex(N(o.regionId)?[o.regionId]:void 0,N(o.regionIndex)?[o.regionIndex]:void 0)[0];if(!l)return"none";var u,c=Q4(t,l),h=null!==(n=o.activeType)&&void 0!==n?n:c.length>1?"dimension":"mark",d=l.getLayoutStartPoint(),p=l.getLayoutRect(),f=s.globalInstance.getContainer(),v=A({x:0,y:0},f?{x:(u=f.getBoundingClientRect()).x,y:u.y}:{}),g=function(t){var e,i=t.data,n=i.dimensionFields,r=i.dimensionData,a=i.measureFields,o=i.measureData,s=i.groupField,l=i.groupData,u=null===(e=t.series.getViewData())||void 0===e?void 0:e.latestData.find((function(t){return X4(n,r)(t)&&X4(a,o)(t)&&(j(s)||X4([s],[l])(t))}));return u},y=function(t){var e,i,n=function(t){return{x:Math.min(Math.max(t.x,0),p.width),y:Math.min(Math.max(t.y,0),p.height)}}(t),r=null!==(e=o.x)&&void 0!==e?e:d.x+n.x,a=null!==(i=o.y)&&void 0!==i?i:d.y+n.y;return{canvasX:r,canvasY:a,clientX:v.x+r,clientY:v.y+a}};if("dimension"===h){var m=c[0];if(!m)return"none";var _=new Map;c.forEach((function(t){var e;_.has(t.series)||_.set(t.series,[]),null===(e=_.get(t.series))||void 0===e||e.push(t)}));var b=[{value:t[m.data.dimensionFields[0]],data:P([],E(_.keys()),!1).map((function(t){var e,i;return{series:t,datum:null!==(i=null===(e=_.get(t))||void 0===e?void 0:e.map((function(t){return g(t)})))&&void 0!==i?i:[]}}))}];N(m.dimType)&&(b[0].position=m.pos[m.dimType],b[0].dimType=m.dimType);var x={changePositionOnly:!1,action:"enter",tooltip:null,dimensionInfo:b,chart:null!==(r=s.globalInstance.getChart())&&void 0!==r?r:void 0,datum:void 0,model:void 0,source:hG.chart,event:y({x:c.reduce((function(t,e){return t+e.pos.x}),0)/c.length,y:c.reduce((function(t,e){return t+e.pos.y}),0)/c.length}),item:void 0,itemMap:new Map};i.processor.dimension.showTooltip(b,x,!1);var k=s.globalInstance;return mY.globalConfig.uniqueTooltip&&mY.hideTooltip(k.id),h}if("mark"===h){var S=c[0];if(!S)return"none";var M=A(A({},g(S)),t),w=[{datum:[M],series:S.series}];x={changePositionOnly:!1,tooltip:null,dimensionInfo:b=[{value:M[S.data.dimensionFields[0]],data:w}],chart:null!==(a=s.globalInstance.getChart())&&void 0!==a?a:void 0,datum:M,model:S.series,source:hG.chart,event:y(S.pos),item:void 0,itemMap:new Map};i.processor.mark.showTooltip({datum:M,mark:null,series:S.series},x,!1);k=s.globalInstance;return mY.globalConfig.uniqueTooltip&&mY.hideTooltip(k.id),h}return"none"}var Z4,J4,Q4=function(e,i){var n=i.getSeries(),r=[];return n.forEach((function(i){var n,a,o,s,l,u,c,h=i.getDimensionField(),d=i.getMeasureField(),p=i.getSeriesField(),f=N(p)?e[p]:void 0,v=N(p)&&null!==(s=null===(o=null===(a=null===(n=i.getViewDataStatistics)||void 0===n?void 0:n.call(i))||void 0===a?void 0:a.latestData[p])||void 0===o?void 0:o.values)&&void 0!==s?s:[],g=Y4(h,e),y=Y4(d,e),m=K4(y),_=!m&&N(p)&&j(f)&&v.length>0,b=function(){var e,n=null===(e=i.getViewData())||void 0===e?void 0:e.latestData.find(X4(h,g));if(m||(y=Y4(d,n),K4(y))){var a=i.type===t.SeriesTypeEnum.pie?i.dataToCentralPosition(n):i.dataToPosition(n);j(a)||isNaN(a.x)||isNaN(a.y)||r.push({pos:a,data:{dimensionFields:h,dimensionData:g,measureFields:d,measureData:y,hasMeasureData:m,groupField:p,groupData:f},series:i})}};if("cartesian"===i.coordinate){var x=i,k=WB(null===(u=null===(l=i.getYAxisHelper())||void 0===l?void 0:l.getScale(0))||void 0===u?void 0:u.type)?"y":"x",S=h.map((function(t,e){return[t,e]})).filter((function(t){var e=E(t,2)[1];return j(null==g?void 0:g[e])})),A=[null!=g?g:[]];S.length>0&&S.forEach((function(t){var e,n,r,a,o=E(t,2),s=o[0],l=o[1],u=null!==(a=null===(r=null===(n=null===(e=i.getViewDataStatistics)||void 0===e?void 0:e.call(i))||void 0===n?void 0:n.latestData[s])||void 0===r?void 0:r.values)&&void 0!==a?a:[],c=[];A.forEach((function(t){u.forEach((function(e){var i,n=null!==(i=null==t?void 0:t.slice())&&void 0!==i?i:[];n[l]=e,c.push(n)}))})),A=c})),A.forEach((function(t){var e,n;if(_){var a=null===(e=x.getViewData())||void 0===e?void 0:e.latestData.filter(X4(h,t));v.forEach((function(e){var n=a.find((function(t){return t[p]===e}));if(y=Y4(d,n),K4(y)){var o=x.dataToPosition(n);j(o)||isNaN(o.x)||isNaN(o.y)||r.push({pos:o,data:{dimensionFields:h,dimensionData:t,measureFields:d,measureData:y,hasMeasureData:m,groupField:p,groupData:e},series:i,dimType:k})}}))}else{var o=null===(n=x.getViewData())||void 0===n?void 0:n.latestData.find(X4(h,t));if(!m&&(y=Y4(d,o),!K4(y)))return;var s=x.dataToPosition(o);if(j(s)||isNaN(s.x)||isNaN(s.y))return;r.push({pos:s,data:{dimensionFields:h,dimensionData:t,measureFields:d,measureData:y,hasMeasureData:m,groupField:p,groupData:f},dimType:k,series:i})}}))}else if("polar"===i.coordinate)if(i.type===t.SeriesTypeEnum.pie)b();else{var M=i;if(_){var w=(null===(c=M.getViewData())||void 0===c?void 0:c.latestData.filter(X4(h,g))).find((function(t){return t[p]===f}));v.forEach((function(t){if(y=Y4(d,w),K4(y)){var e=M.dataToPosition(w);j(e)||isNaN(e.x)||isNaN(e.y)||r.push({pos:e,data:{dimensionFields:h,dimensionData:g,measureFields:d,measureData:y,hasMeasureData:m,groupField:p,groupData:t},series:i})}}))}else b()}else"geo"===i.coordinate&&b()})),r},$4=["updateTitle","updateContent","updatePosition","maxLineCount","othersLine"],t8=function(t,e,i,n,r){var a,o,s,l={activeType:t};switch(t){case"mark":case"group":if(i){var u=null===(a=i.getSpec())||void 0===a?void 0:a.tooltip;return l.visible=!0,(null==u?void 0:u.handler)&&(l.handler=u.handler),(null===(o=l.handler)||void 0===o?void 0:o.showTooltip)?l:((null==u?void 0:u[t])&&$4.forEach((function(e){N(u[t][e])&&(l[e]=u[t][e])})),A(A({},l),i.tooltipHelper.getTooltipData(t,e,n,n[0].datum,r)))}break;case"dimension":if(null==n?void 0:n.length){if(e8(n).every((function(t){var e;return!MY("dimension",null===(e=t.tooltipHelper)||void 0===e?void 0:e.spec)}))?l.visible=!1:l.visible=!0,l.handler=e.handler,null===(s=l.handler)||void 0===s?void 0:s.showTooltip)return l;var c=[];return n.forEach((function(i){return i.data.forEach((function(i){var a=i.series.tooltipHelper.getTooltipData(t,e,n,i.datum,r);a&&c.push(a)}))})),function(t){if(!t||!t.length)return null;var e=[];return t.forEach((function(t){var i=t.content;i&&i.forEach((function(t){e.push(t)}))})),e.length?A(A({},t[0]),{content:e}):t[0]}(c)}}return null},e8=function(t){var e=[];return t.forEach((function(t){t.data.forEach((function(t){N(t.series)&&e.push(t.series)}))})),e},i8={dom:"".concat(BF,"_TOOLTIP_HANDLER_DOM"),canvas:"".concat(BF,"_TOOLTIP_HANDLER_CANVAS")},n8={key:"其他",value:"..."},r8=["group","mark","dimension"],a8=function(){function t(t){var e=this;this._showTooltipByHandler=function(t,i){var n,r,a;if(j(t))return 1;i.changePositionOnly||e.clearCache(),e._updateViewSpec(t,i);var o=e._cacheActiveSpec;if(j(o)||!1===o.visible)return 1;i.tooltipSpec=e.component.getSpec(),i.activeTooltipSpec=o;var s,l=o.title,u=o.content,c=j(null==l?void 0:l.key)&&j(null==l?void 0:l.value)&&!(null==u?void 0:u.length);return e.component.event.emit(cG.tooltipShow,A(A({},i),{isEmptyTooltip:c,tooltipData:t,activeType:e.activeType,tooltip:e.component})),c?1:((null===(n=o.handler)||void 0===n?void 0:n.showTooltip)?s=o.handler.showTooltip.bind(o.handler):(null===(r=e.component.tooltipHandler)||void 0===r?void 0:r.showTooltip)&&(s=e.component.tooltipHandler.showTooltip.bind(e.component.tooltipHandler)),s?null!==(a=s(e.activeType,t,i))&&void 0!==a?a:0:1)},this.component=t}return t.prototype._preprocessDimensionInfo=function(t){var e=[];if(null==t||t.forEach((function(t){var i=A(A({},t),{data:t.data.filter((function(t){var e,i;return!1!==(null===(i=null===(e=t.series.getSpec())||void 0===e?void 0:e.tooltip)||void 0===i?void 0:i.visible)}))});i.data.length>0&&e.push(i)})),e.length>0)return e},t.prototype._updateViewSpec=function(t,e){var i,n,r,a,o,s,l,u,c,h=e.changePositionOnly,d=e.model;if(!h||!this._cacheActiveSpec){var p=this.component.getSpec();if(this._cacheActiveSpec=t8(this.activeType,this.component.getSpec(),d,t,e),this._cacheActiveSpec){j(this._cacheActiveSpec.handler)&&N(p.handler)&&(this._cacheActiveSpec.handler=p.handler);var f=null!==(i=p[this.activeType])&&void 0!==i?i:{},v=null!==(n=this._cacheActiveSpec.updateTitle)&&void 0!==n?n:f.updateTitle,g=null!==(r=this._cacheActiveSpec.updateContent)&&void 0!==r?r:f.updateContent,y=null!==(o=null!==(a=this._cacheActiveSpec.maxLineCount)&&void 0!==a?a:f.maxLineCount)&&void 0!==o?o:20;if(v&&(this._cacheActiveSpec.title=null!==(s=v(this._cacheActiveSpec.title,t,e))&&void 0!==s?s:this._cacheActiveSpec.title),g)this._cacheActiveSpec.content=null!==(l=g(this._cacheActiveSpec.content,t,e))&&void 0!==l?l:this._cacheActiveSpec.content;else if(y>=1&&(null===(u=this._cacheActiveSpec.content)||void 0===u?void 0:u.length)>y){var m=null!==(c=this._cacheActiveSpec.othersLine)&&void 0!==c?c:f.othersLine,_=m?A(A({},n8),m):n8;this._cacheActiveSpec.content=P(P([],E(this._cacheActiveSpec.content.slice(0,y-1)),!1),[A(A({},this._cacheActiveSpec.content[y-1]),_)],!1)}}}},t.prototype.shouldHandleTooltip=function(t,e){var i,n;return!j(e)&&MY(this.activeType,null===(n=null===(i=t.model)||void 0===i?void 0:i.tooltipHelper)||void 0===n?void 0:n.spec)},t.prototype.clearCache=function(){this._cacheActiveSpec=void 0},t}(),o8=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.activeType="dimension",e}return S(e,t),e.prototype.showTooltip=function(t,e,i){var n=A(A({},e),{dimensionInfo:this._preprocessDimensionInfo(t),changePositionOnly:i,tooltip:this.component});return this._showTooltipByHandler(t,n)},e.prototype._getDimensionInfo=function(t){var e,i,n,r=this.component.getChart(),a=r.getCompiler().getStage().getLayer(void 0),o={x:t.event.viewX,y:t.event.viewY};if(a.globalTransMatrix.transformPoint({x:t.event.viewX,y:t.event.viewY},o),0===(n=P(P([],E(null!==(e=zG(r,o,!0))&&void 0!==e?e:[]),!1),E(null!==(i=AG(r,o))&&void 0!==i?i:[]),!1)).length)n=void 0;else if(n.length>1){var s=n.filter((function(t){var e,i,n,r,a,o,s=t.axis;if(s.getSpec().hasDimensionTooltip)return!0;if(!WB(s.getScale().type))return!1;try{for(var l=C(null!==(a=null==s?void 0:s.getRegions())&&void 0!==a?a:[]),u=l.next();!u.done;u=l.next()){var c=u.value;try{for(var h=(n=void 0,C(c.getSeries())),d=h.next();!d.done;d=h.next()){var p=d.value;if("cartesian"===p.coordinate){o=p;break}}}catch(t){n={error:t}}finally{try{d&&!d.done&&(r=h.return)&&r.call(h)}finally{if(n)throw n.error}}if(N(o))break}}catch(t){e={error:t}}finally{try{u&&!u.done&&(i=l.return)&&i.call(l)}finally{if(e)throw e.error}}return N(o)&&o.getDimensionField()[0]===o.fieldY[0]?"left"===s.getOrient()||"right"===s.getOrient():"bottom"===s.getOrient()||"top"===s.getOrient()}));if((n=s.length?s:n.slice(0,1)).length>1){var l=new Set;n.forEach((function(t){t.data=t.data.filter((function(t){var e=t.key;return!l.has(e)&&(l.add(e),!0)}))}))}}return n},e.prototype.getMouseEventData=function(t){return{tooltipInfo:this._getDimensionInfo(t),ignore:!1}},e}(a8),s8=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.activeType="mark",e}return S(e,t),e.prototype.showTooltip=function(t,e,i){var n,r,a,o=t.datum,s=t.series,l=this.component.getSpec(),u=[{datum:[o],series:s}],c=s.tooltipHelper,h=null===(n=s.getSpec())||void 0===n?void 0:n.tooltip,d=null===(r=null==h?void 0:h.mark)||void 0===r?void 0:r.checkOverlap,p=!1;if(!0===d||!0===(null===(a=l.mark)||void 0===a?void 0:a.checkOverlap)&&!1!==d){var f=null==c?void 0:c.activeTriggerSet.mark;if(f){p=!0;var v=this.component.getChart().getCompiler().getStage().getLayer(void 0),g={x:e.event.viewX,y:e.event.viewY};v.globalTransMatrix.transformPoint({x:e.event.viewX,y:e.event.viewY},g),f.forEach((function(t){t.getProductElements().forEach((function(t){var i=t.getGraphicItem();t!==e.item&&i&&i.containsPoint(g.x,g.y,Sl.GLOBAL,i.stage.getPickerService())&&u[0].datum.push(t.getDatum())}))}))}}var y=A(A({},e),{model:s,changePositionOnly:i,tooltip:this.component});if(i&&p){var m=this._cacheActiveSpec&&this._cacheActiveSpec.data;m&&m[0].series===u[0].series&&m[0].datum.length===u[0].datum.length&&!m[0].datum.some((function(t,e){return t!==u[0].datum[e]}))||(y.changePositionOnly=!1)}return this._showTooltipByHandler(u,y)},e.prototype.getMouseEventData=function(t){var e,i,n,r=null===(e=t.model)||void 0===e?void 0:e.modelType;if("series"===r){var a=null==(u=(p=t.model).tooltipHelper)?void 0:u.activeTriggerSet.mark,o=null==u?void 0:u.ignoreTriggerSet.mark;(null==a?void 0:a.has(t.mark))?i={mark:t.mark,datum:t.datum,series:p}:(null==o?void 0:o.has(t.mark))&&(n=!0)}else if("component"===r){var s=t.model,l=t.node;if("label"===s.name&&l){var u,c=s.getLabelInfoByTextGraphic(l),h=null!=c?c:{},d=h.baseMark,p=h.series,f=h.labelMark;a=null==(u=p.tooltipHelper)?void 0:u.activeTriggerSet.mark,o=null==u?void 0:u.ignoreTriggerSet.mark;(null==a?void 0:a.has(f))?i={mark:d,datum:l.attribute.data,series:p}:(null==o?void 0:o.has(f))&&(n=!0)}}return{tooltipInfo:i,ignore:n}},e}(a8),l8=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.activeType="group",e}return S(e,t),e.prototype.showTooltip=function(t,e,i){var n=t.datum,r=t.series,a=[{datum:xt(n),series:r}],o=A(A({},e),{groupDatum:this._getGroupDatum(e),changePositionOnly:i,tooltip:this.component});return this._showTooltipByHandler(a,o)},e.prototype.getMouseEventData=function(t){var e,i,n;if("series"===(null===(e=t.model)||void 0===e?void 0:e.modelType)){var r=t.model,a=r.tooltipHelper,o=null==a?void 0:a.activeTriggerSet.group;if(null==o?void 0:o.has(t.mark)){var s=this.component.getSpec()[this.activeType];((null==s?void 0:s.triggerMark)?xt(s.triggerMark):[]).includes(null===(i=t.mark)||void 0===i?void 0:i.name)&&(n={mark:t.mark,datum:t.datum,series:r})}}return{tooltipInfo:n,ignore:!1}},e.prototype._getGroupDatum=function(t){var e=t.model,i=t.mark,n=t.datum,r=e;if(["line","area"].includes(i.type))return xt(n);var a=r.getViewData().latestData,o=r.getSeriesField();if(!o)return a;var s=xt(n)[0][o];return a.filter((function(t){return t[o]===s}))},e}(a8),u8=function(t){return N(t)&&!X(t)},c8=function(t){return N(t)&&X(t)},h8=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._shouldMergeThemeToSpec=function(){return!1},e.prototype._initTheme=function(e,i){var n,r=t.prototype._initTheme.call(this,e,i),a=r.spec,o=r.theme;return a.style=xz({},this._theme,a.style),a.offset=xz({},o.offset,e.offset),a.transitionDuration=null!==(n=e.transitionDuration)&&void 0!==n?n:o.transitionDuration,{spec:a,theme:o}},e.prototype._transformSpecAfterMergingTheme=function(e,i,n){var r,a,o,s,l,u,c;t.prototype._transformSpecAfterMergingTheme.call(this,e,i,n),e.visible=null===(r=e.visible)||void 0===r||r,e.activeType=function(t){var e,i,n;if(!1===(null==t?void 0:t.visible))return[];var r={mark:!1!==(null===(e=null==t?void 0:t.mark)||void 0===e?void 0:e.visible),dimension:!1!==(null===(i=null==t?void 0:t.dimension)||void 0===i?void 0:i.visible),group:!1!==(null===(n=null==t?void 0:t.group)||void 0===n?void 0:n.visible)};return N(null==t?void 0:t.activeType)&&Object.keys(r).forEach((function(e){var i;r[e]=null===(i=null==t?void 0:t.activeType)||void 0===i?void 0:i.includes(e)})),Object.keys(r).filter((function(t){return r[t]}))}(e),e.renderMode=null!==(a=e.renderMode)&&void 0!==a?a:Vk(this._option.mode)||!jk(this._option.mode)?"canvas":"html",e.trigger=null!==(o=e.trigger)&&void 0!==o?o:"hover",e.className=null!==(s=e.className)&&void 0!==s?s:"vchart-tooltip-element",e.enterable=null!==(l=e.enterable)&&void 0!==l&&l,e.transitionDuration=null!==(u=e.transitionDuration)&&void 0!==u?u:150,e.confine=null!==(c=e.confine)&&void 0!==c?c:"canvas"===e.renderMode,N(e.parentElement)?Y(e.parentElement)&&(e.parentElement=ex.getElementById(e.parentElement)):jk(this._option.mode)&&(e.parentElement=null==Hk?void 0:Hk.body)},e}(nK),d8=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.layoutZIndex=1,e.type=B.tooltip,e.name=B.tooltip,e.transformerConstructor=h8,e.specKey="tooltip",e.layoutType="none",e._isReleased=!1,e._alwaysShow=!1,e._eventList=[],e._isTooltipShown=!1,e._clickLock=!1,e._mountEvent=function(t,i,n){e.event.on(t,i,n),e._eventList.push({eventType:t,handler:n})},e._handleClickToLock=function(t){e._clickLock?(e._handleChartMouseOut(t),e._clickLock=!1):e._clickLock=!0},e._getMouseOutHandler=function(t){return function(i){var n,r,a,o,s;if(!e._isReleased&&!e._alwaysShow&&!e._clickLock&&(e._isTooltipShown||(null===(r=null===(n=e.tooltipHandler)||void 0===n?void 0:n.isTooltipShown)||void 0===r?void 0:r.call(n)))){var l=jk(null===(a=e._option)||void 0===a?void 0:a.mode),u=i.event,c=u.clientX,h=u.clientY;l&&t&&e._isPointerInChart({x:c,y:h})||(e._enterable?e._outTimer=setTimeout((function(){e._handleChartMouseOut(i)}),null!==(s=null===(o=e._spec)||void 0===o?void 0:o.showDelay)&&void 0!==s?s:50):e._handleChartMouseOut(i))}}},e._handleChartMouseOut=function(t){e._alwaysShow||e._isReleased||e._isEnterTooltip||"none"!==e._spec.triggerOff&&(e._hideTooltipByHandler(A(A({},t),{tooltip:e})),e._handleMouseMove&&e._handleMouseMove.cancel&&e._handleMouseMove.cancel(),e._cacheEnterableRect=null,e._cacheInfo=void 0,e._cacheParams=void 0,e._cacheActiveType=void 0)},e._getMouseMoveHandler=function(t){return function(i){var n,r,a,o;e._isReleased||e._isEnterTooltip||(e._outTimer&&(clearTimeout(e._outTimer),e._outTimer=null),e.tooltipHandler||e._initHandler(),e.processor||e._initProcessor(),e._alwaysShow||(e._clickLock?t&&(e._handleChartMouseOut(i),e._clickLock=!1):!t&&e._enterable&&(null===(r=null===(n=e.tooltipHandler)||void 0===n?void 0:n.isTooltipShown)||void 0===r?void 0:r.call(n))?(e._showTimer&&clearTimeout(e._showTimer),e._showTimer=setTimeout((function(){e._handleChartMouseMove(i,t)}),null!==(o=null===(a=e._spec)||void 0===a?void 0:a.showDelay)&&void 0!==o?o:50)):e._handleChartMouseMove(i,t)))}},e._handleChartMouseMove=function(t,i){if(!e._isReleased){for(var n=e._getMouseEventData(t),r=n.tooltipInfo.dimension,a=n.ignore.mark,o={mark:!1,dimension:!1,group:!1},s=0,l=r8.length;s<l;s++){var u=r8[s];if(!!e.processor[u]&&e._showTooltipByMouseEvent(u,n,t,i)){o[u]=!0;break}}Object.values(o).every((function(t){return!t}))&&!function(t){return j(t.mark)&&j(t.model)&&j(t.datum)}(t)&&(a&&u8(e._cacheInfo)?o.mark=e._showTooltipByMouseEvent("mark",n,t,i,!0):N(r)&&(o.dimension=e._showTooltipByMouseEvent("dimension",n,t,i))),o.mark||o.group||o.dimension&&!j(r)?e._initEventOfTooltipContent():e._handleChartMouseOut(t)}},e._showTooltipByMouseEvent=function(t,i,n,r,a){var o,s,l=e.processor[t];if(!l.shouldHandleTooltip(n,i.tooltipInfo[t]))return!1;if(e._hideTimer&&clearTimeout(e._hideTimer),a)s=!l.showTooltip(e._cacheInfo,n,!0);else{var u=i.tooltipInfo[t],c=e._isSameAsCache(u,n,t);(s=!l.showTooltip(u,n,c))&&(e._cacheInfo=u,e._cacheParams=n,e._cacheActiveType=t)}s&&(e._isTooltipShown=!0,r&&e._spec.lockAfterClick&&!e._clickLock?e._clickLock=!0:Number.isFinite(e._spec.hideTimer)&&(e._hideTimer=setTimeout((function(){e._handleChartMouseOut()}),e._spec.hideTimer)));var h=null===(o=e._option)||void 0===o?void 0:o.globalInstance;return s&&mY.globalConfig.uniqueTooltip&&h&&mY.hideTooltip(h.id),s},e._getMouseEventData=function(t){var i={tooltipInfo:{},ignore:{}};return Object.keys(e.processor).forEach((function(n){var r=e.processor[n].getMouseEventData(t),a=r.tooltipInfo,o=r.ignore;i.tooltipInfo[n]=a,i.ignore[n]=o})),i},e._hideTooltipByHandler=function(t){var i,n,r;if(!e._isTooltipShown&&!(null===(n=null===(i=e.tooltipHandler)||void 0===i?void 0:i.isTooltipShown)||void 0===n?void 0:n.call(i)))return 0;e.event.emit(cG.tooltipHide,A(A({},t),{source:hG.chart,tooltip:e})),Object.values(e.processor).forEach((function(t){t.clearCache()}));var a=null!==(r=e._spec.handler)&&void 0!==r?r:e.tooltipHandler;if(a.hideTooltip){var o=a.hideTooltip.call(a,t);return o||(e._isTooltipShown=!1),o}return 1},e.hideTooltip=function(){if(e._isReleased)return!1;var t={changePositionOnly:!1,tooltip:e,item:void 0,datum:void 0,source:hG.chart};return e._alwaysShow=!1,!e._hideTooltipByHandler(t)},e}return S(e,t),e.prototype.isTooltipShown=function(){return this._isTooltipShown},e.prototype.changeRegions=function(t){},e.prototype._getNeedClearVRenderComponents=function(){return[]},e.prototype._registerEvent=function(){},e.prototype._releaseEvent=function(){},e.prototype.onLayout=function(t){},e.prototype.onLayoutEnd=function(t){},e.prototype.onRender=function(t){},e.prototype.created=function(){t.prototype.created.call(this),this._regions=this._option.getAllRegions(),this._initEvent()},e.prototype.release=function(){var e,i,n=this;t.prototype.release.call(this),this._isReleased=!0,this._hideTimer&&clearTimeout(this._hideTimer),this._eventList.forEach((function(t){var e=t.eventType,i=t.handler;n.event.off(e,i)})),this._eventList=[],null===(i=null===(e=this.tooltipHandler)||void 0===e?void 0:e.release)||void 0===i||i.call(e),this._isTooltipShown=!1},e.prototype.beforeRelease=function(){this.event.emit(cG.tooltipHide,{tooltip:this,chart:this.getChart()}),this.event.emit(cG.tooltipRelease,{tooltip:this,chart:this.getChart()})},e.prototype._initHandler=function(){var t,e,i,n=null!==(t=this._spec.renderMode)&&void 0!==t?t:"html",r=this._option.globalInstance.getTooltipHandlerByUser();if(r)this.tooltipHandler=r,this._enterable=!1;else{var a="canvas"===n?i8.canvas:i8.dom,o=kz.getComponentPluginInType(a);o||Ok("Can not find tooltip handler: "+a);var s=new o;s.name="".concat(this._spec.className,"-").concat(null!==(e=this._option.globalInstance.id)&&void 0!==e?e:0,"-").concat(this.getSpecIndex()),null===(i=this.pluginService)||void 0===i||i.load([s]),this.tooltipHandler=s,this._spec.enterable&&"html"===n&&this.tooltipHandler?(this._enterable=!0,this._needInitEventOfTooltip=!0):this._enterable=!1}},e.prototype._initEventOfTooltipContent=function(){var t,e,i=this;if(this._needInitEventOfTooltip){var n=null===(e=(t=this.tooltipHandler).getTooltipContainer)||void 0===e?void 0:e.call(t),r=null==n?void 0:n.firstChild;r&&(r.addEventListener("pointerenter",(function(){var t;if(i._enterable){i._isEnterTooltip=!0;var e=null===(t=r.getBoundingClientRect)||void 0===t?void 0:t.call(r);e&&(i._cacheEnterableRect={x:e.x,y:e.y,width:e.width,height:e.height}),i._outTimer&&(clearTimeout(i._outTimer),i._outTimer=null),i._showTimer&&(clearTimeout(i._showTimer),i._showTimer=null)}})),r.addEventListener("pointerleave",(function(){var t,e,n;if(i._enterable&&(i._isEnterTooltip=!1,i._cacheEnterableRect)){var a=null===(t=r.getBoundingClientRect)||void 0===t?void 0:t.call(r);a&&Object.keys(i._cacheEnterableRect).every((function(t){return i._cacheEnterableRect[t]===a[t]}))&&(i._cacheEnterableRect=null,i._outTimer=setTimeout(i.hideTooltip,null!==(n=null===(e=i._spec)||void 0===e?void 0:e.showDelay)&&void 0!==n?n:50))}})),this._needInitEventOfTooltip=!1)}},e.prototype._initProcessor=function(){var t=this._spec.activeType;this.processor={},t.includes("dimension")&&(this.processor.dimension=new o8(this)),t.includes("group")&&(this.processor.group=new l8(this)),t.includes("mark")&&(this.processor.mark=new s8(this))},e.prototype._initEvent=function(){var t,e=this;if(!this._option.disableTriggerEvent){var i=xt(null!==(t=this._spec.trigger)&&void 0!==t?t:"hover"),n=xt(this._spec.triggerOff),r=this._option.mode;i.forEach((function(t){var i;"hover"===t?(e._handleMouseMove=e._throttle(e._getMouseMoveHandler(!1)),e._mountEvent("pointermove",{source:"chart"},e._handleMouseMove),(Nk(r)||Vk(r))&&(e._mountEvent("pointerdown",{source:"chart"},e._getMouseMoveHandler(!1)),e._mountEvent("pointerup",{source:"window"},e._getMouseOutHandler(!0))),e._mountEvent("pointerleave",{source:"chart"},e._getMouseOutHandler(!1))):"click"===t?(e._mountEvent("pointertap",{source:"chart"},e._getMouseMoveHandler(!0)),e._mountEvent("pointerup",{source:"window"},e._getMouseOutHandler(!0))):V(t)&&e._mountEvent(t.eventType,{source:null!==(i=t.source)&&void 0!==i?i:"chart",consume:t.consume},e._getMouseMoveHandler(!0))})),n.filter((function(t){return V(t)})).forEach((function(t){var i,n;e._mountEvent(t.eventType,{source:null!==(i=t.source)&&void 0!==i?i:"chart",consume:t.consume},e._getMouseOutHandler(null!==(n=t.checkOutside)&&void 0!==n&&n))})),!i.includes("click")&&this._spec.lockAfterClick&&this._mountEvent("pointertap",{source:"chart"},this._handleClickToLock)}},e.prototype._throttle=function(t){return Zt(t,Z(this._spec.throttleInterval)?this._spec.throttleInterval:"html"===this._spec.renderMode&&this._spec.transitionDuration?50:10)},e.prototype.reInit=function(e){var i,n,r;if(t.prototype.reInit.call(this,e),this.tooltipHandler){var a=null!==(i=this._spec.renderMode)&&void 0!==i?i:"html",o=this._spec.enterable&&"html"===a;o&&!this._enterable&&(this._needInitEventOfTooltip=!0),this._enterable=o,null===(r=(n=this.tooltipHandler).reInit)||void 0===r||r.call(n)}else this._initHandler()},e.prototype.showTooltip=function(t,e){var i;if(this.tooltipHandler||this._initHandler(),this.processor||this._initProcessor(),!(null===(i=this.tooltipHandler)||void 0===i?void 0:i.showTooltip))return!1;var n=q4(t,e,this);return"none"!==n&&(this._alwaysShow=!!(null==e?void 0:e.alwaysShow)),n},e.prototype._isSameAsCache=function(t,e,i){if(i!==this._cacheActiveType)return!1;if(t===this._cacheInfo)return!0;if(j(this._cacheInfo)||j(t))return!1;if(c8(t)){if(u8(this._cacheInfo))return!1;var n=this._cacheInfo,r=n.length===t.length&&t.every((function(t,e){return bG(t,n[e])}));return r}if(c8(this._cacheInfo))return!1;var a=this._cacheInfo;if(!((null==t?void 0:t.datum)===a.datum&&(null==t?void 0:t.mark)===a.mark&&(null==t?void 0:t.series)===a.series))return!1;var o=this._cacheParams;return!j(o)&&!j(e)&&(o.mark===e.mark&&o.model===e.model&&o.datum===e.datum)},e.prototype._isPointerInChart=function(t){var e,i=null===(e=this._option)||void 0===e?void 0:e.globalInstance;if(!i)return!1;if(!i.getChart())return!1;var n=t.x,r=t.y,a=i.getCanvas().getBoundingClientRect(),o=a.x,s=a.y,l=a.width,u=a.height;return n>=o&&n<=o+l&&r>=s&&r<=s+u},e.prototype.getVisible=function(){return!1!==this._spec.visible},e.type=B.tooltip,e.transformerConstructor=h8,e.specKey="tooltip",e}(rK),p8=function(){kz.registerComponent(d8.type,d8)};t.TooltipResult=void 0,(Z4=t.TooltipResult||(t.TooltipResult={}))[Z4.success=0]="success",Z4[Z4.failed=1]="failed",function(t){t[t.ALL=3]="ALL",t[t.HORIZONTAL=2]="HORIZONTAL",t[t.VERTICAL=1]="VERTICAL"}(J4||(J4={}));var f8={x:["top","bottom"],y:["left","right"],category:["angle"],value:["radius"]},v8=function(e){function i(t,i){var n=e.call(this,t,i)||this;return n.specKey="crosshair",n.layoutType="none",n.gridZIndex=wU.CrossHair_Grid,n.labelZIndex=wU.CrossHair,n.trigger="hover",n._handleIn=function(t){if(n._option){var e=n.calculateTriggerPoint(t),i=e.x,r=e.y;n.showDefault=!1,n._layoutCrosshair(i,r);var a=n._getNeedClearVRenderComponents();n._hasActive=a.some((function(t){return t&&!1!==t.attribute.visible}))}},n._handleClickInEvent=function(t){if(!n._hasActive||!n._spec.lockAfterClick||n._clickLock)return n._clickLock?(n._clickLock=!1,void n._handleOutEvent()):void(n._onlyLockClick||(n._handleIn(t),Z(n.triggerOff)&&(n._timer&&clearTimeout(n._timer),n._timer=setTimeout((function(){n._handleOutEvent()}),n.triggerOff))));n._clickLock=!0},n._handleHoverInEvent=Zt((function(t){n._clickLock||n._handleIn(t)}),10),n._handleOutEvent=function(){n.enableRemain||n._clickLock||!n._hasActive||(n.clearOutEvent(),n.hide())},n._handleTooltipShow=function(t){var e=t.tooltipData;if(!t.isEmptyTooltip&&e&&e.length)if(V(n._spec.followTooltip)&&!1===n._spec.followTooltip[t.activeType])n._handleTooltipHideOrRelease();else{var i=n.calculateTriggerPoint(t),r=i.x,a=i.y;n.showDefault=!1,n._layoutCrosshair(r,a,e,t.activeType);var o=n._getNeedClearVRenderComponents();n._hasActive=o.some((function(t){return t&&!1!==t.attribute.visible}))}else n._handleTooltipHideOrRelease()},n._handleTooltipHideOrRelease=function(){n.clearOutEvent(),n.hide()},n.enable=!0,n.showDefault=!0,n}return S(i,e),Object.defineProperty(i.prototype,"enableRemain",{get:function(){return"none"===this.triggerOff},enumerable:!1,configurable:!0}),i.prototype._setAllAxisValues=function(t,e,i){var n=this,r=!1;if(t.forEach((function(t){WB(t.axis.getScale().type)&&(r?n.enable=!1:r=!0)})),!this.enable)return!1;var a=this._stateByField[i].currentValue;return t.forEach((function(t,i){var r=t.axis;a.set(i,{datum:n._getDatumAtPoint(r,e),axis:r})})),!0},i.prototype.clearAxisValue=function(){var t=this;Object.keys(this._stateByField).forEach((function(e){t._stateByField[e].currentValue.clear()}))},i.prototype.hideCrosshair=function(){this.clearAxisValue(),this.hide()},i.prototype.showCrosshair=function(t){var e=this;t&&t.length&&(this.showDefault=!1,this.clearAxisValue(),t.forEach((function(t){var i=t.axis,n=t.value;e.setAxisValue(n,i)})),this.layoutByValue(!1))},i.prototype._getLimitBounds=function(){var t,e;if(!this._limitBounds){var i=null!==(e=null===(t=this._option.globalInstance.getChart())||void 0===t?void 0:t.getViewRect())&&void 0!==e?e:{width:0,height:0},n=i.width,r=i.height;this._limitBounds={x1:0,y1:0,x2:n,y2:r}}return this._limitBounds},i.prototype._showDefaultCrosshairBySpec=function(){var t=this;Object.keys(this._stateByField).forEach((function(e){var i=t._spec[e];if(i&&i.visible&&i.defaultSelect){var n=i.defaultSelect,r=n.axisIndex,a=void 0===r?0:r,o=n.datum,s=t._option.getComponentsByKey("axes").find((function(t){return t.getSpecIndex()===a}));s&&(t._stateByField[e].currentValue.clear(),t._stateByField[e].currentValue.set(a,{axis:s,datum:o}))}}))},i.prototype._updateVisibleCrosshair=function(){var t=this,e=!1;Object.keys(this._stateByField).forEach((function(i){var n=t._spec[i];n&&n.visible&&t._stateByField[i].currentValue.size?e=!0:t._hideByField(i)})),e&&this.layoutByValue(!1)},i.prototype._showDefaultCrosshair=function(){this.showDefault?(this._showDefaultCrosshairBySpec(),this.layoutByValue(!1)):this._updateVisibleCrosshair()},i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),this._parseCrosshairSpec()},i.prototype.created=function(){e.prototype.created.call(this),this._initEvent()},i.prototype._compareSpec=function(t,i){var n=e.prototype._compareSpec.call(this,t,i);return n.reMake||mt(i,t)||(n.reRender=!0,n.reMake=!0),n},i.prototype._initEvent=function(){var t=this;if(!this._option.disableTriggerEvent)if(this._spec.followTooltip)this._registerTooltipEvent();else{var e=this._getTriggerEvent();e&&e.forEach((function(e){t._registerEvent(e.in,!1,e.click),e.out&&t._registerEvent(e.out,!0)}))}},i.prototype._registerEvent=function(t,e,i){var n=this,r=e?this._handleOutEvent:i?this._handleClickInEvent:this._handleHoverInEvent,a=e?{level:dG.chart}:{source:hG.chart};X(t)?t.forEach((function(t){n.event.on(t,a,r)})):this.event.on(t,a,r)},i.prototype._eventOff=function(t,e,i){var n=this,r=e?this._handleOutEvent:i?this._handleClickInEvent:this._handleHoverInEvent;X(t)?t.forEach((function(t){n.event.off(t,r)})):this.event.off(t,r)},i.prototype.updateLayoutAttribute=function(){this._limitBounds=null,this._showDefaultCrosshair()},i.prototype.calculateTriggerPoint=function(t){var e=t.event,i=this._option.getCompiler().getStage().getLayer(void 0),n={x:e.viewX,y:e.viewY};return i.globalTransMatrix.transformPoint({x:e.viewX,y:e.viewY},n),{x:n.x-this.getLayoutStartPoint().x,y:n.y-this.getLayoutStartPoint().y}},i.prototype._getTriggerEvent=function(){var e=this,i=this._option.mode,n=function(e){return e===t.RenderModeEnum["desktop-browser"]||e===t.RenderModeEnum["desktop-miniApp"]?{click:"pointertap",hover:"pointermove",hoverOut:"pointerleave",clickOut:"pointerleave"}:Nk(e)||Vk(e)?{click:"tap",hover:["pointerdown","pointermove"],hoverOut:"pointerleave",clickOut:"pointerleave"}:null}(void 0===i?t.RenderModeEnum["desktop-browser"]:i);if(n){var r=xt(this.trigger||"hover");this._spec.lockAfterClick&&!r.includes("click")?(r.push("click"),this._onlyLockClick=!0):this._onlyLockClick=!1;var a=[];return r.forEach((function(t){var i;a.push({click:"click"===t,in:n[t],out:(i=t,"click"===i?"none"===e.triggerOff?null:n.clickOut:n.hoverOut)})})),a}return null},i.prototype._registerTooltipEvent=function(){this.event.on(cG.tooltipHide,{source:hG.chart},this._handleTooltipHideOrRelease),this.event.on(cG.tooltipShow,{source:hG.chart},this._handleTooltipShow),this.event.on(cG.tooltipRelease,{source:hG.chart},this._handleTooltipHideOrRelease)},i.prototype._getAxisInfoByField=function(t){var e,i,n=null===(i=(e=this._option).getComponentsByKey)||void 0===i?void 0:i.call(e,"axes");if(!(null==n?void 0:n.length))return null;var r=st(this._spec,"".concat(t,"Field.bindingAxesIndex"));if(r||(r=[],n.forEach((function(e,i){f8[t].includes(e.getOrient())&&r.push(i)}))),!r.length)return null;var a=new Map,o=1/0,s=1/0,l=-1/0,u=-1/0,c=this.getLayoutStartPoint(),h=c.x,d=c.y;return r.forEach((function(t){o=1/0,s=1/0,l=-1/0,u=-1/0;var e=n.find((function(e){return e.getSpecIndex()===t}));e&&(e.getRegions().forEach((function(t){var e=t.getLayoutStartPoint(),i=e.x,n=e.y;o=Math.min(o,i-h),s=Math.min(s,n-d),l=Math.max(l,i+t.getLayoutRect().width-h),u=Math.max(u,n+t.getLayoutRect().height-d)})),a.set(t,{x1:o,y1:s,x2:l,y2:u,axis:e}))})),a},i.prototype.changeRegions=function(t){},i.prototype.onLayoutEnd=function(t){var i=this._regions[0];this.setLayoutRect(i.getLayoutRect()),this.setLayoutStartPosition(i.getLayoutStartPoint()),e.prototype.onLayoutEnd.call(this,t)},i.prototype.onRender=function(t){},i.prototype._releaseEvent=function(){var t=this;this.clearOutEvent();var e=this._getTriggerEvent();e&&e.forEach((function(e){t._eventOff(e.in,!1,e.click),e.out&&t._eventOff(e.out,!0)}))},i.prototype._parseFieldInfo=function(){var t=this;Object.keys(this._stateByField).forEach((function(e){var i,n=t._spec[e],r=t._stateByField[e].crosshairComp;if(n&&n.visible){if(t._stateByField[e].attributes=t._parseField(n,e),r){var a=t._stateByField[e].attributes,o=a.style,s="rect"===a.type?"rectStyle":"lineStyle";r.setAttributes(((i={})[s]=o,i))}}else r&&r.parent&&r.parent.removeChild(r)}))},i.prototype._parseCrosshairSpec=function(){this._parseFieldInfo();var t=this._spec,e=t.trigger,i=t.triggerOff,n=t.labelZIndex,r=t.gridZIndex;e&&(this.trigger=e),("none"===i||Z(i)&&i>0)&&(this.triggerOff=i),void 0!==n&&(this.labelZIndex=n),void 0!==r&&(this.gridZIndex=r)},i.prototype._parseField=function(t,e){var i,n,r={},a=t.line,o=void 0===a?{}:a,s=t.label,l=void 0===s?{}:s,u=t.visible;if(r.visible=u,r.type=o.type||"line",!1===o.visible)r.style={visible:!1};else{var c=o.style||{},h=c,d=h.stroke,p=h.fill,f=h.lineWidth,v=c,g=v.strokeOpacity,y=v.fillOpacity,m=v.opacity,_=M(v,["strokeOpacity","fillOpacity","opacity"]),b="line"===r.type,x=b?g:y;if(Z(m)&&(x=(null!=x?x:1)*m),r.style=A({opacity:x,pickable:!1,visible:!0},_),b)r.style.stroke=d||p,r.style.lineWidth=st(o,"width",f||2);else{r.style.fill=p||d,(null===(n=null===(i=null==t?void 0:t.line)||void 0===i?void 0:i.style)||void 0===n?void 0:n.stroke)&&(r.style.stroke=t.line.style.stroke);var k=st(o,"width");if("string"==typeof k){var S=parseInt(k.substring(0,k.length-1),10)/100;r.style.sizePercent=S}else"number"!=typeof k&&"function"!=typeof k||(r.style.size=k)}}if(l.visible){var w=l.labelBackground||{},T=l.style||{},C=w.style||{},E=C.fill,P=void 0===E?"rgba(47, 59, 82, 0.9)":E,R=C.stroke,B=C.outerBorder,I=M(C,["fill","stroke","outerBorder"]);r.label={visible:!0,formatMethod:l.formatMethod,formatter:l.formatter,minWidth:w.minWidth,maxWidth:w.maxWidth,padding:w.padding,textStyle:A(A({fontSize:14,pickable:!1},T),{fill:T.fill||"#fff",stroke:st(T,"stroke")}),panel:(z(w.visible)?w.visible:w)?A({visible:!0,pickable:!1,fill:P,stroke:R,outerBorder:A({stroke:P,distance:0,lineWidth:3},B)},I):{visible:!1},zIndex:this.labelZIndex,childrenPickable:!1,pickable:!1}}else r.label={visible:!1};return r},i.prototype._filterAxisByPoint=function(t,e,i){return t&&t.forEach((function(n){var r,a,o,s=n.axis;if(a=e,o=i,((r=n).x1>a||r.x2<a||r.y1>o||r.y2<o)&&t.delete(s.getSpecIndex()),s.type.startsWith("polarAxis")){var l=s.getCenter(),u=s.getInnerRadius(),c=s.getOuterRadius(),h=Me.distancePP({x:e,y:i},l);(h>c||h<u)&&t.delete(s.getSpecIndex())}})),t},i.prototype._updateCrosshairLabel=function(t,e,i){var n=this.getContainer();t?t.setAttributes(e):(t=new bR(e),null==n||n.add(t),i(t)),function(t,e){var i=e.x1,n=e.y1,r=e.x2,a=e.y2,o=t.AABBBounds,s=o.x1,l=o.y1,u=o.x2,c=o.y2,h=t.attribute,d=h.dx,p=void 0===d?0:d,f=h.dy,v=void 0===f?0:f,g=0,y=0;s<i&&(g=i-s),l<n&&(y=n-l),u>r&&(g=r-u),c>a&&(y=a-c),g&&t.setAttribute("dx",g+p),y&&t.setAttribute("dy",y+v)}(t,this._getLimitBounds())},i.prototype.clearOutEvent=function(){this._timer&&(clearTimeout(this._timer),this._timer=null),this._clickLock&&(this._clickLock=null),this._hasActive&&(this._hasActive=null)},i.prototype._hideByField=function(t){var e=this._stateByField[t],i=e.crosshairComp,n=e.labelsComp;i&&i.hideAll(),n&&Object.keys(n).forEach((function(t){n[t]&&n[t].hideAll()}))},i.prototype.hide=function(){var t=this;Object.keys(this._stateByField).forEach((function(e){t._hideByField(e)}))},i.prototype._getNeedClearVRenderComponents=function(){var t=this;return Object.keys(this._stateByField).reduce((function(e,i){var n=t._stateByField[i],r=n.crosshairComp,a=n.labelsComp;return r&&e.push(r),a&&Object.keys(a).forEach((function(t){a[t]&&e.push(a[t])})),e}),[])},i.specKey="crosshair",i}(rK),g8=function(t,e,i,n){return void 0===n&&(n=!1),i||(i={x:0,y:0}),Object.keys(t).forEach((function(r){var a=t[r],o=a.currentValue,s=a.cacheInfo,l=a.labelsComp,u=a.attributes,c=a.coordKey,h=null,d=0;if(o.size){var p=Array.from(o.values())[0];d=p.axis.getScale().scale(p.datum)+p.axis.getLayoutStartPoint()[c]-i[c],h=p.axis}var f,v=!!o.size&&Number.isFinite(d)&&!Number.isNaN(d),g=n&&!v&&N(s),y=g?s:{coordRange:[0,0],sizeRange:[0,0],coord:d,labelsTextStyle:{},labels:l?Object.keys(l).reduce((function(t,e){return t[e]={visible:!1,text:"",dx:0,dy:0},t}),{}):null,visible:v,axis:h};y&&(y._isCache=g);var m=0;if(u&&o.forEach((function(t){var i,n=t.axis,a=t.datum,o=void 0===a?"":a,s=null,l=n.getScale();if(WB(l.type))0===(f=l.bandwidth())&&l.step&&(m=l.step());else if(NB(l.type)){var c="xField"===r?e.fieldX[0]:e.fieldY[0],h="xField"===r?e.fieldX2:e.fieldY2,p=function(t,e,i,n){for(var r=0,a=t.length;r<a;r++){var o=t[r];if(o){var s=o[i],l=o[n||i];if(s<=e&&l>=e)return o}}return null}(e.getViewData().latestData,+o,c,h);if(p){var v="xField"===r?e.dataToPositionX(p):e.dataToPositionY(p);h?(f=Math.abs(v-("xField"===r?e.dataToPositionX1(p):e.dataToPositionY1(p))),o="".concat(p[c]," ~ ").concat(p[h])):f=1,d=v}s=n.niceLabelFormatter}if(y&&(null===(i=u.label)||void 0===i?void 0:i.visible)&&!g){var _=YX(n.getSpec()),b=n.getOrient();y.labels[b]&&(y.labels[b].visible=!0,y.labels[b].text=o,"left"===b?(y.labels[b].dx=-_,y.labelsTextStyle[b]={textAlign:"right",textBaseline:"middle"}):"right"===b?(y.labels[b].dx=_,y.labelsTextStyle[b]={textAlign:"left",textBaseline:"middle"}):"top"===b?(y.labels[b].y=0,y.labels[b].dy=-_,y.labelsTextStyle[b]={textAlign:"center",textBaseline:"bottom"}):"bottom"===b&&(y.labels[b].dy=_,y.labelsTextStyle[b]={textAlign:"center",textBaseline:"top"}),y.labels[b].defaultFormatter=s)}})),y&&!g){var _={x1:1/0,y1:1/0,x2:-1/0,y2:-1/0};m8(_,o),"xField"===r?(y.coordRange=[_.x1,_.x2],y.sizeRange=[_.y1,_.y2],y.coord=d+i.x,y.labels&&(y.labels.top.y=_.y1,y.labels.bottom.y=_.y2)):(y.coordRange=[_.y1,_.y2],y.sizeRange=[_.x1,_.x2],y.coord=d+i.y,y.labels&&(y.labels.left.x=_.x1,y.labels.right.x=_.x2)),(y.coord<y.coordRange[0]||y.coord>y.coordRange[1])&&(y.visible=!1),u&&u.label&&Object.keys(y.labels).forEach((function(t){y.labels[t].visible&&y8(y.labels[t],t,u.label)}))}t[r].bandSize=null!=f?f:0,t[r].offsetSize=m,t[r].cacheInfo=y})),t},y8=function(t,e,i){var n=xY(i.formatMethod,i.formatter,t.text,{label:t.text,position:e}),r=n.formatFunc,a=n.args;r?t.text=r.apply(void 0,P([],E(a),!1)):t.defaultFormatter&&(t.text=t.defaultFormatter(t.text))},m8=function(t,e){e.forEach((function(e){e.axis.getRegions().forEach((function(e){var i=e.getLayoutStartPoint(),n=i.x,r=i.y,a=e.getLayoutRect(),o=a.width,s=a.height;t.x1=Math.min(t.x1,n),t.y1=Math.min(t.y1,r),t.x2=Math.max(t.x2,n+o),t.y2=Math.max(t.y2,r+s)}))}))},_8=function(t){var e,i,n,r,a,o=t.cacheInfo,s=t.attributes,l=t.bandSize,u=t.offsetSize,c=t.coordKey,h=t.anotherAxisKey,d=o.coord,p=o.sizeRange,f=s.type;if("line"===f){var v=d+l/2;a={visible:!0,start:(e={},e[c]=v,e[h]=p[0],e),end:(i={},i[c]=v,i[h]=p[1],i)}}else if("rect"===f){var g=E(b8(s,l,u,o.axis),2),y=g[0],m=g[1],_=o.coordRange;a={visible:!0,start:(n={},n[c]=Math.max(d+y,_[0]),n[h]=p[0],n),end:(r={},r[c]=Math.min(d+m,_[1]),r[h]=p[1],r)}}return a},b8=function(t,e,i,n){var r,a,o,s=0===e?i:e,l=s;if(null===(r=t.style)||void 0===r?void 0:r.sizePercent)l=s*t.style.sizePercent;else if("number"==typeof(null===(a=t.style)||void 0===a?void 0:a.size))l=t.style.size;else if("function"==typeof(null===(o=t.style)||void 0===o?void 0:o.size)){var u=n.getLayoutRect();l=t.style.size(u,n)}return 0===e?[-l/2,l/2]:[e/2-l/2,l/2+e/2]},x8=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.type=B.cartesianCrosshair,n.name=B.cartesianCrosshair,n._stateByField={xField:{coordKey:"x",anotherAxisKey:"y",currentValue:new Map,labelsComp:{top:null,bottom:null}},yField:{coordKey:"y",anotherAxisKey:"x",currentValue:new Map,labelsComp:{left:null,right:null}}},n}return S(e,t),e.getSpecInfo=function(t){return kY(t,this.specKey,this.type,(function(t){return t.xField&&!1!==t.xField.visible||t.yField&&!1!==t.yField.visible}))},e.prototype._findAllAxisContains=function(t,e){var i=this._getAxisInfoByField("x"),n=this._getAxisInfoByField("y");return{xAxisMap:this._filterAxisByPoint(i,t,e),yAxisMap:this._filterAxisByPoint(n,t,e)}},e.prototype._getDatumAtPoint=function(t,e){var i=MG(t.getOrient())?"x":"y",n=e[i]-(t.getLayoutStartPoint()[i]-this.getLayoutStartPoint()[i]);return t.getScale().invert(n)},e.prototype.setAxisValue=function(t,e){MG(e.getOrient())?this._stateByField.xField.currentValue.set(e.getSpecIndex(),{datum:t,axis:e}):this._stateByField.yField.currentValue.set(e.getSpecIndex(),{datum:t,axis:e})},e.prototype._layoutCrosshair=function(t,e,i,n){var r,a=t,o=e;if(i&&i.length)if("dimension"===n){var s=i[0],l=s.data.findIndex((function(t){return t.datum.length>0})),u=void 0;if(l>-1)u=(c=s.data[l]).series.dataToPosition(c.datum[0]);(N(s.dimType)?"y"===s.dimType:wG(null===(r=null==s?void 0:s.axis)||void 0===r?void 0:r.getOrient()))?o=null==u?void 0:u.y:a=null==u?void 0:u.x}else if("mark"===n){var c;a=null==(u=(c=i[0]).series.dataToPosition(c.datum[0]))?void 0:u.x,o=null==u?void 0:u.y}this.clearAxisValue();var h=this._findAllAxisContains(a,o),d=h.xAxisMap,p=h.yAxisMap;if(d&&0===d.size||p&&0===p.size){if(this.enableRemain)return;this.hide()}else d&&d.size&&this._setAllAxisValues(d,{x:a,y:o},"xField"),p&&p.size&&this._setAllAxisValues(p,{x:a,y:o},"yField"),this.layoutByValue()},e.prototype.layoutByValue=function(t){var e=this;if(this.enable){var i=QO(this._regions,"cartesian");i&&(g8(this._stateByField,i,this.getLayoutStartPoint(),null!=t?t:this.enableRemain),Object.keys(this._stateByField).forEach((function(t){e._layoutByField(t)})))}},e.prototype._layoutByField=function(t){var e=this,i=this._stateByField[t],n=i.cacheInfo,r=i.attributes,a=i.labelsComp,o=i.bandSize,s=i.coordKey;if(r&&n&&(!n._isCache||!this.enableRemain)){var l=n.coord,u=n.labels,c=n.visible,h=n.labelsTextStyle;if(c){var d=_8(this._stateByField[t]);this._updateCrosshairByField(t,d),Object.keys(u).forEach((function(i){var n,c;if(u[i].visible){var d=A(A(A(((n={})[s]=l+o/2,n),u[i]),r.label),{textStyle:A(A({},null===(c=r.label)||void 0===c?void 0:c.textStyle),h[i]),zIndex:e.labelZIndex,visible:!0});e._updateCrosshairLabel(a[i],d,(function(e){e.name="crosshair-".concat(t.replace("Field",""),"-").concat(i,"-label"),a[i]=e}))}else a[i]&&a[i].hideAll()}))}else this._hideByField(t)}},e.prototype._updateCrosshairByField=function(t,e){var i=this.getContainer(),n=this._stateByField[t].attributes,r=this._stateByField[t].crosshairComp;if(r)r.setAttributes(e);else{var a=n.style;"line"===n.type?r=new HR(A(A({},e),{lineStyle:a,zIndex:this.gridZIndex+1,disableTriggerEvent:this._option.disableTriggerEvent,pickable:!1})):"rect"===n.type&&(r=new jR(A(A({},e),{rectStyle:a,zIndex:this.gridZIndex,disableTriggerEvent:this._option.disableTriggerEvent,pickable:!1}))),null==i||i.add(r),this._stateByField[t].crosshairComp=r}},e.specKey="crosshair",e.type=B.cartesianCrosshair,e}(v8),k8=function(){kz.registerComponent(x8.type,x8)},S8=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.type=B.polarCrosshair,n.name=B.polarCrosshair,n._stateByField={categoryField:{coordKey:"angle",anotherAxisKey:"radius",currentValue:new Map,labelsComp:{all:null}},valueField:{coordKey:"radius",anotherAxisKey:"angle",currentValue:new Map,labelsComp:{all:null}}},n}return S(e,t),e.getSpecInfo=function(t){return kY(t,this.specKey,this.type,(function(t){return t.categoryField&&!1!==t.categoryField.visible||t.valueField&&!1!==t.valueField.visible}))},e.prototype.setAxisValue=function(t,e){"radius"===e.getOrient()?this._stateByField.valueField.currentValue.set(e.getSpecIndex(),{datum:t,axis:e}):this._stateByField.categoryField.currentValue.set(e.getSpecIndex(),{datum:t,axis:e})},e.prototype._findAllAxisContains=function(t,e){var i=this._getAxisInfoByField("category"),n=this._getAxisInfoByField("value");return{angleAxisMap:this._filterAxisByPoint(i,t,e),radiusAxisMap:this._filterAxisByPoint(n,t,e)}},e.prototype._getDatumAtPoint=function(t,e){var i=t.getLayoutStartPoint(),n=i.x,r=i.y,a=this.getLayoutStartPoint(),o=a.x,s=a.y;return t.positionToData({x:e.x-(n-o),y:e.y-(r-s)})},e.prototype._layoutCrosshair=function(t,e,i,n){var r=t,a=e;if(i&&i.length)if("dimension"===n){var o=i[0];if(o.axis){var s=o.axis.pointToCoord({x:r,y:a}),l="radius"===o.axis.getOrient()?{radius:o.position,angle:s.angle}:{radius:s.radius,angle:o.position},u=o.axis.coordToPoint(l);r=u.x,a=u.y}}else if("mark"===n){var c=i[0],h=c.series.dataToPosition(c.datum[0]);r=h.x,a=h.y}this.clearAxisValue();var d=this._findAllAxisContains(r,a),p=d.angleAxisMap,f=d.radiusAxisMap;if(0!==p.size||0!==f.size)p&&this._setAllAxisValues(p,{x:r,y:a},"categoryField"),f&&this._setAllAxisValues(f,{x:r,y:a},"valueField"),this.layoutByValue();else{if(this.enableRemain)return;this.hide()}},e.prototype.layoutByValue=function(t){var e=this;if(this.enable){var i=QO(this._regions,"polar");i&&(!function(t,e,i){void 0===i&&(i=!1),Object.keys(t).forEach((function(n){var r=t[n],a=r.attributes,o=r.currentValue,s=r.cacheInfo,l=r.coordKey;if(a){var u=!!o.size,c=i&&!u&&N(s),h=c?s:{coord:0,axis:null,visible:u,coordRange:[0,0],sizeRange:[0,0],labels:{all:{visible:!1,text:"",offset:0}}};if(s&&(s._isCache=c),"valueField"===n&&(h.sides=e.angleAxisHelper.getScale(0).domain().length),o.forEach((function(t){var i,r=t.axis,o=t.datum,s=void 0===o?"":o,l=r.niceLabelFormatter;if((null===(i=a.label)||void 0===i?void 0:i.visible)&&(h.labels.all.visible=!0,h.labels.all.defaultFormatter=l,h.labels.all.text=s,h.labels.all.offset=YX(r.getSpec())),"categoryField"===n){var u=e.angleAxisHelper.dataToPosition([s]),c=e.angleAxisHelper.getBandwidth(0),d=r.getOuterRadius();h.coord=u,h.coordRange=[u-c/2,u+c/2],h.sizeRange=[d,d]}else u=r.startAngle,d=e.radiusAxisHelper.dataToPosition([s]),h.coord=d,h.coordRange=[d,d],h.sizeRange=[u,u];h.axis=r})),h&&!c&&h.labels.all.visible&&a&&a.label){var d=h.labels.all,p=a.label,f=xY(p.formatMethod,p.formatter,d.text,{label:d.text,orient:l}),v=f.formatFunc,g=f.args;v?d.text=v.apply(void 0,P([],E(g),!1)):d.defaultFormatter&&(d.text=d.defaultFormatter(d.text))}t[n].cacheInfo=h}}))}(this._stateByField,i,null!=t?t:this.enableRemain),Object.keys(this._stateByField).forEach((function(t){e._layoutByField(t)})))}},e.prototype._layoutByField=function(t){var e,i,n,r=this._stateByField[t],a=r.cacheInfo,o=r.attributes,s=r.crosshairComp,l=r.labelsComp,u=r.coordKey;if(!(!a||a._isCache&&this.enableRemain)){var c=this.getContainer(),h=a.visible,d=a.labels,p=a.coord,f=a.sizeRange,v=a.axis;if(h){var g=this.getLayoutStartPoint(),y=null===(i=null===(e=this._spec.valueField)||void 0===e?void 0:e.line)||void 0===i?void 0:i.smooth,m=function(t,e,i){var n=t.cacheInfo,r=t.coordKey,a=t.attributes,o=n.axis,s=n.coord,l=n.sizeRange,u=n.coordRange,c=o.getCenter(),h={x:c.x+e.x,y:c.y+e.y};if("angle"===r)return"sector"==("rect"===a.type?"sector":"line")?{center:h,innerRadius:o.getInnerRadius(),radius:o.getOuterRadius(),startAngle:u[0],endAngle:u[1]}:{start:Pe(h,o.getInnerRadius(),s),end:Pe(h,o.getOuterRadius(),s)};var d=o.startAngle,p=o.endAngle,f=n.sides,v=s;if(!i){var g=o.getCenter(),y=o.coordToPoint({angle:l[0],radius:s}),m=Be(g,y),_=(p-d)/f,b=Math.floor((m-d)/_),x=b*_+d,k=Math.min((b+1)*_+d,p),S=Pe(g,s,x),A=Pe(g,s,k),M=ze([A.x,A.y],[S.x,S.y],[g.x,g.y],[y.x,y.y]);M&&(v=Ut(Me.distancePN(y,M[0],M[1])+s,o.getInnerRadius(),o.getOuterRadius()))}return{center:h,startAngle:d,endAngle:p,radius:v,sides:f}}(this._stateByField[t],g,y);if(s)s.setAttributes(m);else{var _,b=void 0;if("angle"===u)"line"===(_="rect"===o.type?"sector":"line")?b=new HR(A(A({},m),{lineStyle:o.style,zIndex:this.gridZIndex,pickable:!1})):"sector"===_&&(b=new VR(A(A({},m),{sectorStyle:o.style,zIndex:this.gridZIndex,pickable:!1})));else b="polygon"===(_=y?"circle":"polygon")?new WR(A(A({},m),{lineStyle:o.style,zIndex:this.gridZIndex+1})):new NR(A(A({},m),{lineStyle:o.style,zIndex:this.gridZIndex}));this._stateByField[t].crosshairComp=b,c.add(b)}var x=d.all;if(x.visible){var k=v.getCenter(),S={x:k.x+g.x,y:k.y+g.y},M="angle"===u?function(t){return{align:(t=Ie(t))>=Math.PI*(5/3)||t<=Math.PI*(1/3)?"left":t>=Math.PI*(2/3)&&t<=Math.PI*(4/3)?"right":"center",baseline:t>=Math.PI*(7/6)&&t<=Math.PI*(11/6)?"bottom":t>=Math.PI*(1/6)&&t<=Math.PI*(5/6)?"top":"middle"}}(p):function(t){return{align:(t=Ie(t))>=Math.PI*(7/6)&&t<=Math.PI*(11/6)?"right":t>=Math.PI*(1/6)&&t<=Math.PI*(5/6)?"left":"center",baseline:t>=Math.PI*(5/3)||t<=Math.PI*(1/3)?"bottom":t>=Math.PI*(2/3)&&t<=Math.PI*(4/3)?"top":"middle"}}(v.startAngle),w="angle"===u?Pe(S,f[1]+x.offset,p):Pe(S,m.radius,v.startAngle),T=A(A(A(A({},w),o.label),x),{textStyle:A(A({},null===(n=o.label)||void 0===n?void 0:n.textStyle),{textAlign:M.align,textBaseline:M.baseline}),zIndex:this.labelZIndex});this._updateCrosshairLabel(l.all,T,(function(t){t.name="crosshair-".concat(u,"-label"),l.all=t}))}else l.all&&l.all.hideAll()}}},e.specKey="crosshair",e.type=B.polarCrosshair,e}(v8),A8=function(){kz.registerComponent(S8.type,S8)},M8=function(t,e){var i=e.getNewDomain,n=e.isContinuous,r=e.field,a=e.originalFields,o=r(),s=i();if(j(s)||j(o))return t;var l=a(),u=X(o)?o[0]:o;return t[u]&&l&&l[u]&&l[u].lockStatisticsByDomain&&!n()&&(t[u].values=s),t},w8=function(t,e){var i=e.getNewDomain,n=e.isContinuous,r=(0,e.field)(),a=i();if(j(a)||j(r))return t;if(0===a.length)return[];var o={};a.forEach((function(t){o[t]||(o[t]=1)}));var s=null;return s=n()?function(t){var e=!1;return xt(r).every((function(i){t[i]>=a[0]&&t[i]<=kt(a)&&(e=!0)})),e}:function(t){var e=!1;return xt(r).every((function(i){(o[t[i]+""]||o[t[i]])&&(e=!0)})),e},t.filter(s)},T8=function(t,e){var i=e.input,n=i.stateFields,r=i.valueFields,a=i.dataCollection,o=e.output,s=o.stateField,l=o.valueField,u={},c=[];return a.forEach((function(t,e){var i;if(!j(n[e])){var a=null===(i=t.getFields())||void 0===i?void 0:i[n[e]];a&&a.lockStatisticsByDomain&&a.domain.forEach((function(t){u[t]=0})),t.latestData.forEach((function(t){xt(n[e]).forEach((function(i){j(t[i])||(j(u[t[i]])&&(u[t[i]]=0),j(r[e])||(u[t[i]]+=isNaN(parseFloat(t[r[e]]))?1:parseFloat(t[r[e]])))}))}))}})),Object.keys(u).forEach((function(t,e){var i,n=((i={})[s]=t,i);l&&(n[l]=u[t]),c.push(n)})),c},C8=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.layoutType="none",n._orient="left",n._cacheVisibility=void 0,n._dataUpdating=!1,n._shouldChange=!0,n._stateField="x",n._activeRoam=!0,n._zoomAttr={enable:!0,rate:1,focus:!0},n._dragAttr={enable:!0,rate:1,reverse:!0},n._scrollAttr={enable:!0,rate:1,reverse:!0},n.effect={onZoomChange:function(t){var e,i,r=n._relatedAxisComponent;if(r&&"axis"===n._filterMode){var a=r.getScale(),o=r.getSpec();n._auto&&n._getAxisBandSize(o)&&n._spec.ignoreBandSize&&(a.bandwidth("auto"),a.maxBandwidth("auto"),a.minBandwidth("auto")),n._updateRangeFactor(t),n._auto&&(null===(i=null===(e=n._component)||void 0===e?void 0:e.setStartAndEnd)||void 0===i||i.call(e,n._start,n._end)),r.effect.scaleUpdate({value:"force"})}else XO(n._regions,(function(t){var e;null===(e=t.getViewData())||void 0===e||e.markRunning()}),{userId:n._seriesUserId,specIndex:n._seriesIndex}),XO(n._regions,(function(t){t.reFilterViewData()}),{userId:n._seriesUserId,specIndex:n._seriesIndex})}},n._visible=!0,n._handleStateChange=function(t,e,i){var r,a;return n._startValue=t,n._endValue=e,n._newDomain=n._parseDomainFromState(n._startValue,n._endValue),null===(a=(r=n.effect).onZoomChange)||void 0===a||a.call(r,i),!0},n._handleChartZoom=function(t,e){var i,r;if(n._activeRoam&&(!n._zoomAttr.filter||n._zoomAttr.filter(t,e))){var a=t.zoomDelta,o=t.zoomX,s=t.zoomY,l=n._regions[0].getLayoutStartPoint(),u=l.x,c=l.y,h=n._regions[0].getLayoutRect(),d=h.width,p=h.height,f=Math.abs(n._start-n._end),v=null!==(r=null===(i=n._spec.roamZoom)||void 0===i?void 0:i.rate)&&void 0!==r?r:1;if(!(f>=1&&a<1||f<=.01&&a>1)){var g=n._isHorizontal?o:s,y=f*(a-1)*v,m=y/2,_=y/2;if(g){var b=n._isHorizontal?u:c,x=n._isHorizontal?d:p;m=Math.abs(b-g)/Math.abs(x-b)*y,_=Math.abs(x-g)/Math.abs(x-b)*y}var k=Ut(n._start+m,0,1),S=Ut(n._end-_,0,1);n._handleChange(Math.min(k,S),Math.max(k,S),!0)}}},n._handleChartScroll=function(t,e){var i;if(!n._activeRoam||n._scrollAttr.filter&&!n._scrollAttr.filter(t,e))return!1;var r=t.scrollX,a=t.scrollY,o=n._isHorizontal?r:a,s=n._isHorizontal?le(r/a)>=.5:le(a/r)>=.5;n._scrollAttr.reverse||(o=-o),s&&n._handleChartMove(o,null!==(i=n._scrollAttr.rate)&&void 0!==i?i:1);var l=0!==n._start&&1!==n._end;return s&&l},n._handleChartDrag=function(t,e){var i;if(n._activeRoam&&(!n._dragAttr.filter||n._dragAttr.filter(t,e))){var r=E(t,2),a=r[0],o=r[1],s=n._isHorizontal?a:o;n._dragAttr.reverse&&(s=-s),n._handleChartMove(s,null!==(i=n._dragAttr.rate)&&void 0!==i?i:1)}},n._handleChartMove=function(t,e){var i=n._isHorizontal?n.getLayoutRect().width:n.getLayoutRect().height;if(Math.abs(t)>=1e-6)if(t>0&&n._end<1){var r=Math.min(1-n._end,t/i)*e;n._handleChange(n._start+r,n._end+r,!0)}else if(t<0&&n._start>0){r=Math.max(-n._start,t/i)*e;n._handleChange(n._start+r,n._end+r,!0)}return!1},n._orient=CG(e),n._isHorizontal="horizontal"===EG(n._orient),n}return S(e,t),Object.defineProperty(e.prototype,"relatedAxisComponent",{get:function(){return this._relatedAxisComponent},enumerable:!1,configurable:!0}),e.prototype.setStartAndEnd=function(t,e,i){void 0===i&&(i=["percent","percent"]);var n=E(i,2),r=n[0],a=void 0===r?"percent":r,o=n[1],s=void 0===o?"percent":o,l="percent"===a?t:this.dataToStatePoint(t),u="percent"===s?e:this.dataToStatePoint(e);this._handleChange(l,u,!0)},e.prototype.enableInteraction=function(){this._activeRoam=!0},e.prototype.disableInteraction=function(){this._activeRoam=!1},e.prototype.zoomIn=function(t){this._handleChartZoom({zoomDelta:1.2,zoomX:null==t?void 0:t.x,zoomY:null==t?void 0:t.y})},e.prototype.zoomOut=function(t){this._handleChartZoom({zoomDelta:.8,zoomX:null==t?void 0:t.x,zoomY:null==t?void 0:t.y})},e.prototype._handleChange=function(t,e,i){var n,r;null!==(r=null===(n=this._spec)||void 0===n?void 0:n.zoomLock)&&void 0!==r&&r||e-t!==this._spanCache&&(e-t<this._minSpan||e-t>this._maxSpan)?this._shouldChange=!1:(this._shouldChange=!0,this._spanCache=e-t)},e.prototype._isReverse=function(){var t=this._relatedAxisComponent;if(!t)return!1;var e=t.getScale();return e.range()[0]>e.range()[1]&&(!t.getInverse()||this._isHorizontal)},e.prototype._updateRangeFactor=function(t){var e=this._relatedAxisComponent.getScale(),i=this._isReverse(),n=i?[1-this._end,1-this._start]:[this._start,this._end];if(i)switch(t){case"startHandler":e.rangeFactorEnd(n[1]);break;case"endHandler":e.rangeFactorStart(n[0]);break;default:e.rangeFactorStart(n[0],!0),e.rangeFactorEnd(n[1])}else switch(t){case"startHandler":e.rangeFactorStart(n[0]);break;case"endHandler":e.rangeFactorEnd(n[1]);break;default:e.rangeFactorEnd(n[1],!0),e.rangeFactorStart(n[0])}var r=e.rangeFactor();r?(this._start=i?1-r[1]:r[0],this._end=i?1-r[0]:r[1]):(this._start=0,this._end=1)},Object.defineProperty(e.prototype,"visible",{get:function(){return this._visible},enumerable:!1,configurable:!0}),e.prototype.created=function(){t.prototype.created.call(this),this._setAxisFromSpec(),this._setRegionsFromSpec(),this._initEvent(),this._initData(),this._initStateScale(),this._setStateFromSpec()},e.prototype.initLayout=function(){t.prototype.initLayout.call(this),this._layout&&(this._layout.layoutOrient=this._orient)},e.prototype._setAxisFromSpec=function(){var t=this;if(N(this._spec.axisId)?this._relatedAxisComponent=this._option.getComponentByUserId(this._spec.axisId):N(this._spec.axisIndex)&&(this._relatedAxisComponent=this._option.getComponentByIndex("axes",this._spec.axisIndex)),j(this._spec.field)&&!this._relatedAxisComponent){var e=this._option.getComponentsByKey("axes"),i=e.find((function(e){return e._orient===t._orient}));if(i)this._relatedAxisComponent=i;else{var n=e.find((function(t){return!NB(t.getScale().type)}));this._relatedAxisComponent=n}}this._relatedAxisComponent&&"axis"===this._filterMode&&(this._relatedAxisComponent.autoIndentOnce=!0)},e.prototype._setRegionsFromSpec=function(){var t,e;this._regions=this._relatedAxisComponent?this._relatedAxisComponent.getRegions():this._option.getAllRegions();var i=this._relatedAxisComponent?null===(e=(t=this._relatedAxisComponent).getBindSeriesFilter)||void 0===e?void 0:e.call(t):null;if(N(i)&&(N(i.userId)&&(this._seriesUserId=xt(i.userId)),N(i.specIndex)&&(this._seriesIndex=xt(i.specIndex))),N(this._spec.seriesId)){var n=xt(this._spec.seriesId);this._seriesUserId?this._seriesUserId=this._seriesUserId.filter((function(t){return n.includes(t)})):this._seriesUserId=n}if(N(this._spec.seriesIndex)){var r=xt(this._spec.seriesIndex);this._seriesIndex?this._seriesIndex=this._seriesIndex.filter((function(t){return r.includes(t)})):this._seriesIndex=r}if(N(this._spec.regionIndex)){var a=this._option.getRegionsInIndex(xt(this._spec.regionIndex));this._regions=this._regions.filter((function(t){return a.includes(t)}))}else if(N(this._spec.regionId)){var o=xt(this._spec.regionId);this._regions=o.length?this._regions.filter((function(t){return o.includes(t.id)})):[]}else;},e.prototype.onDataUpdate=function(){var t,e=this._computeDomainOfStateScale(NB(this._stateScale.type));this._stateScale.domain(e,!1),this._handleChange(this._start,this._end,!0),this._spec.auto&&!mt(this._domainCache,e)&&(this._domainCache=e,this._dataUpdating=!0,null===(t=this.getChart())||void 0===t||t.setLayoutTag(!0,null,!1))},e.prototype._computeDomainOfStateScale=function(t){var e=this;if(this._spec.customDomain)return this._spec.customDomain;var i=this._data.getLatestData().map((function(t){return t[e._stateField]}));if(t){var n=i.map((function(t){return 1*t}));return i.length?[At(n),St(n)]:[-1/0,1/0]}return i},e.prototype._initEvent=function(){this._initCommonEvent()},e.prototype._initData=function(){var t=this,e=[],i=[],n=[];if(this._relatedAxisComponent){var r={};XO(this._regions,(function(a){var o,s,l="cartesian"===a.coordinate?a.getXAxisHelper():"polar"===a.coordinate?a.angleAxisHelper:null,u="cartesian"===a.coordinate?a.getYAxisHelper():"polar"===a.coordinate?a.radiusAxisHelper:null;if(l&&u){var c=l.getAxisId()===t._relatedAxisComponent.id?l:u.getAxisId()===t._relatedAxisComponent.id?u:t._isHorizontal?l:u,h=c===l?u:l,d=NB(h.getScale(0).type),p=NB(c.getScale(0).type);e.push(a.getRawData());var f=a.getSpec(),v="cartesian"===a.coordinate?xt(f.xField):xt(null!==(o=f.angleField)&&void 0!==o?o:f.categoryField),g="cartesian"===a.coordinate?xt(f.yField):xt(null!==(s=f.radiusField)&&void 0!==s?s:f.valueField);if(r[a.id]="link"===a.type?["from_xField"]:c===l?v:g,p?i.push(r[a.id]):i.push(r[a.id][0]),t._valueField){var y="link"===a.type?["from_yField"]:h===l?v:g;d&&n.push.apply(n,P([],E(y),!1))}}}),{userId:this._seriesUserId,specIndex:this._seriesIndex}),this._originalStateFields=r}else XO(this._regions,(function(r){e.push(r.getRawData()),i.push(t._field),t._valueField&&n.push(t._spec.valueField)}),{userId:this._seriesUserId,specIndex:this._seriesIndex});var a=this._option.dataSet;ZG(a,"dataview",os),qG(a,"dataFilterComputeDomain",T8);var o=new Ms(a,{name:"".concat(this.type,"_").concat(this.id,"_data")});o.transform({type:"dataFilterComputeDomain",options:{input:{dataCollection:e,stateFields:i,valueFields:n},output:{stateField:this._stateField,valueField:this._valueField}}},!1),this._data=new iY(this._option,o),o.reRunAllTransform(),a.multipleDataViewAddListener(e,"change",this._handleDataCollectionChange.bind(this))},e.prototype.setAttrFromSpec=function(){var e;t.prototype.setAttrFromSpec.call(this),!0===this._spec.roamZoom||this._spec.roamZoom?this._zoomAttr=ft({},this._zoomAttr,this._spec.roamZoom):this._zoomAttr.enable=!1,!0===this._spec.roamDrag||this._spec.roamDrag?this._dragAttr=ft({},this._dragAttr,this._spec.roamDrag):this._dragAttr.enable=!1,!0===this._spec.roamScroll||this._spec.roamScroll?this._scrollAttr=ft({},this._scrollAttr,this._spec.roamScroll):this._scrollAttr.enable=!1,this._field=this._spec.field,this._width=this._computeWidth(),this._height=this._computeHeight(),this._visible=null===(e=this._spec.visible)||void 0===e||e},e.prototype.statePointToData=function(t){var e=this._stateScale,i=e.domain();if(NB(e.type))return this._isReverse()?i[0]+(kt(i)-i[0])*(1-t):i[0]+(kt(i)-i[0])*t;var n=e.range();this._isReverse()&&(n=n.slice().reverse());var r=n[0]+(kt(n)-n[0])*t;return e.invert(r)},e.prototype.dataToStatePoint=function(t){var e=this._stateScale,i=e.scale(t),n=e.range();return!this._isHorizontal&&NB(e.type)&&(n=n.slice().reverse()),(i-n[0])/(kt(n)-n[0])},e.prototype._modeCheck=function(t,e){return"start"===t?"percent"===e&&N(this._spec.start)||"value"===e&&N(this._spec.startValue):"percent"===e&&N(this._spec.end)||"value"===e&&N(this._spec.endValue)},e.prototype._setStateFromSpec=function(){var t,e,i,n;if(this._auto=!!this._spec.auto,this._spec.rangeMode){var r=E(this._spec.rangeMode,2),a=r[0],o=r[1];this._modeCheck("start",a)&&this._modeCheck("end",o)&&(i="percent"===a?this._spec.start:this.dataToStatePoint(this._spec.startValue),n="percent"===o?this._spec.end:this.dataToStatePoint(this._spec.endValue))}else i=this._spec.start?this._spec.start:this._spec.startValue?this.dataToStatePoint(this._spec.startValue):0,n=this._spec.end?this._spec.end:this._spec.endValue?this.dataToStatePoint(this._spec.endValue):1;this._startValue=this.statePointToData(i),this._endValue=this.statePointToData(n),this._start=i,this._end=n,this._minSpan=null!==(t=this._spec.minSpan)&&void 0!==t?t:0,this._maxSpan=null!==(e=this._spec.maxSpan)&&void 0!==e?e:1,NB(this._stateScale.type)&&this._stateScale.domain()[0]!==kt(this._stateScale.domain())&&(this._spec.minValueSpan&&(this._minSpan=this._spec.minValueSpan/(kt(this._stateScale.domain())-this._stateScale.domain()[0])),this._spec.maxValueSpan&&(this._maxSpan=this._spec.maxValueSpan/(kt(this._stateScale.domain())-this._stateScale.domain()[0]))),this._minSpan=Math.max(0,this._minSpan),this._maxSpan=Math.min(this._maxSpan,1),this._relatedAxisComponent&&"axis"===this._filterMode||0===this._start&&1===this._end||(this._newDomain=this._parseDomainFromState(this._startValue,this._endValue))},e.prototype._parseFieldOfSeries=function(t){var e;return null===(e=this._originalStateFields)||void 0===e?void 0:e[t.id]},e.prototype._initStateScale=function(){var t=[0,1];if(this._relatedAxisComponent){var e=this._relatedAxisComponent.getScale(),i=NB(e.type),n=this._computeDomainOfStateScale(i);if(this._stateScale=e.clone(),i){var r=n.map((function(t){return 1*t}));this._stateScale.domain(n.length?[At(r),St(r)]:[0,1],!0).range(t)}else this._stateScale.domain(n,!0).range(t)}else this._stateScale=new dI,this._stateScale.domain(this._computeDomainOfStateScale(),!0).range(t)},e.prototype.init=function(e){t.prototype.init.call(this,e),this._addTransformToSeries(),0===this._start&&1===this._end||this.effect.onZoomChange()},e.prototype._addTransformToSeries=function(){var t=this;this._relatedAxisComponent&&"axis"===this._filterMode||(qG(this._option.dataSet,"dataFilterWithNewDomain",w8),qG(this._option.dataSet,"lockStatisticsFilter",M8),XO(this._regions,(function(e){e.getViewDataStatistics().transform({type:"lockStatisticsFilter",options:{originalFields:function(){return e.getViewDataStatistics().getFields()},getNewDomain:function(){return t._newDomain},field:function(){var i;return null!==(i=t._field)&&void 0!==i?i:t._parseFieldOfSeries(e)},isContinuous:function(){return NB(t._stateScale.type)}},level:1},!1),e.addViewDataFilter({type:"dataFilterWithNewDomain",options:{getNewDomain:function(){return t._newDomain},field:function(){var i;return null!==(i=t._field)&&void 0!==i?i:t._parseFieldOfSeries(e)},isContinuous:function(){return NB(t._stateScale.type)}},level:nU.dataZoomFilter})}),{userId:this._seriesUserId,specIndex:this._seriesIndex}))},e.prototype.onRender=function(t){},e.prototype._compareSpec=function(e,i){var n=t.prototype._compareSpec.call(this,e,i);return n.reMake||mt(i,e)||(n.reRender=!0,n.reMake=!0),n},e.prototype.reInit=function(e){var i=this;t.prototype.reInit.call(this,e),this._marks.forEach((function(t){t.getMarks().forEach((function(t){i.initMarkStyleWithSpec(t,i._spec[t.name])}))}))},e.prototype.changeRegions=function(){},e.prototype.update=function(t){},e.prototype.resize=function(t){},e.prototype._parseDomainFromState=function(t,e){if(NB(this._stateScale.type))return[Math.min(e,t),Math.max(e,t)];var i=this._stateScale.domain(),n=i.indexOf(t),r=i.indexOf(e);return i.slice(Math.min(n,r),Math.max(n,r)+1)},e.prototype._initCommonEvent=function(){var t,e,i,n,r,a,o,s={delayType:null!==(e=null===(t=this._spec)||void 0===t?void 0:t.delayType)&&void 0!==e?e:"throttle",delayTime:N(null===(i=this._spec)||void 0===i?void 0:i.delayType)?null!==(r=null===(n=this._spec)||void 0===n?void 0:n.delayTime)&&void 0!==r?r:30:0,realTime:null===(o=null===(a=this._spec)||void 0===a?void 0:a.realTime)||void 0===o||o,allowComponentZoom:!0};this._zoomAttr.enable&&this.initZoomEventOfRegions(this._regions,null,this._handleChartZoom,s),this._scrollAttr.enable&&this.initScrollEventOfRegions(this._regions,null,this._handleChartScroll,s),this._dragAttr.enable&&this.initDragEventOfRegions(this._regions,null,this._handleChartDrag,s)},e.prototype.updateLayoutAttribute=function(){this._visible&&this._createOrUpdateComponent(),t.prototype.updateLayoutAttribute.call(this)},e.prototype._autoVisible=function(t){var e,i;if(this._auto){t?this.show():this.hide();var n=this._isHorizontal?"height":"width";this.layout.setLayoutRect(((e={})[n]=t?this["_".concat(n)]:0,e),((i={})[n]=CU.Built_In,i))}},e.prototype.onLayoutStart=function(e,i,n){t.prototype.onLayoutStart.call(this,e,i,n);var r=this._autoUpdate(e);this._autoVisible(r),this._dataUpdating=!1},e.prototype.onLayoutEnd=function(e){var i=!(0===this._start&&1===this._end);this._autoVisible(i),t.prototype.onLayoutEnd.call(this,e)},e.prototype.getBoundsInRect=function(t){var e={x1:this.getLayoutStartPoint().x,y1:this.getLayoutStartPoint().y,x2:0,y2:0};return this._isHorizontal?(e.y2=e.y1+this._height,e.x2=e.x1+t.width):(e.x2=e.x1+this._width,e.y2=e.y1+t.height),e},e.prototype.hide=function(){var t;null===(t=this._component)||void 0===t||t.hideAll()},e.prototype.show=function(){var t;null===(t=this._component)||void 0===t||t.showAll()},e.prototype._getAxisBandSize=function(t){var e=null==t?void 0:t.bandSize,i=null==t?void 0:t.maxBandSize,n=null==t?void 0:t.minBandSize;if(e||n||i)return{bandSize:e,maxBandSize:i,minBandSize:n}},e.prototype._autoUpdate=function(t){var e,i,n,r,a,o;if(!this._auto)return this._cacheVisibility=void 0,!0;var s=this._relatedAxisComponent,l=null==s?void 0:s.getSpec(),u=null==s?void 0:s.getScale(),c=this._getAxisBandSize(l);if(!this._dataUpdating&&WB(u.type)&&(null==t?void 0:t.height)===(null===(e=this._cacheRect)||void 0===e?void 0:e.height)&&(null==t?void 0:t.width)===(null===(i=this._cacheRect)||void 0===i?void 0:i.width)&&this._fixedBandSize===(null==c?void 0:c.bandSize))return this._cacheVisibility;var h=!0;if(this._isHorizontal&&(null==t?void 0:t.width)!==(null===(n=this._cacheRect)||void 0===n?void 0:n.width)?u.range(s.getInverse()?[t.width,0]:[0,t.width]):(null==t?void 0:t.height)!==(null===(r=this._cacheRect)||void 0===r?void 0:r.height)&&u.range(s.getInverse()?[0,t.height]:[t.height,0]),this._cacheRect={width:null==t?void 0:t.width,height:null==t?void 0:t.height},this._fixedBandSize=null==c?void 0:c.bandSize,WB(u.type)){c&&(this._start||this._end)&&(this.type===B.scrollBar&&(this._start=0,this._end=1),this._updateRangeFactor());var d=E(null!==(a=u.rangeFactor())&&void 0!==a?a:[],2),p=d[0],f=d[1];h=(!j(p)||!j(f))&&!(0===p&&1===f)}else{var v=E(null!==(o=u.rangeFactor())&&void 0!==o?o:[this._start,this._end],2);p=v[0],f=v[1];h=!(0===p&&1===f)}return this.setStartAndEnd(this._start,this._end),this._cacheVisibility=h,h},e.prototype._getNeedClearVRenderComponents=function(){return[this._component]},e}(rK);bt(C8,_Z);var E8=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._mergeThemeToSpec=function(t,e){var i=this,n=this._theme,r=t;if(this._shouldMergeThemeToSpec()){var a=function(t){var e=xz({selectedBackgroundChart:{line:{},area:{}}},i._theme,t),n=t.selectedBackgroundChart,r=void 0===n?{}:n,a=r.line,o=r.area;return a&&!1!==a.visible&&(e.selectedBackgroundChart.line.style=A(A({},e.selectedBackgroundChart.line.style),{visible:!0})),o&&!1!==o.visible&&(e.selectedBackgroundChart.area.style=A(A({},e.selectedBackgroundChart.area.style),{visible:!0})),e},o=t;r=X(o)?o.map((function(t){return a(t)})):a(o)}return this._adjustPadding(r),{spec:r,theme:n}},e}(nK),P8=function(t){function e(e,i){var n,r=this;return(r=t.call(this,e,i)||this).type=B.dataZoom,r.name=B.dataZoom,r.transformerConstructor=E8,r.specKey="dataZoom",r.layoutZIndex=wU.DataZoom,r.layoutLevel=TU.DataZoom,r.layoutType="region-relative",r._isReverseCache=!1,r._dataToPositionX=function(t){var e="left"===r._orient?r._middleHandlerSize:0,i=r._isHorizontal?r._startHandlerSize/2:0,n=r._isHorizontal?r._stateScale:r._valueScale,a=r._isHorizontal?r._stateField:r._valueField;return n.scale(t[a])+r.getLayoutStartPoint().x+e+i},r._dataToPositionX2=function(t){var e="left"===r._orient?r._middleHandlerSize:0,i=r._isHorizontal?r._startHandlerSize/2:0,n=r._isHorizontal?r._stateScale:r._valueScale,a=n.domain()[0];return n.scale(a)+r.getLayoutStartPoint().x+e+i},r._dataToPositionY=function(t){var e=r._isHorizontal?r._middleHandlerSize:0,i=r._isHorizontal?0:r._startHandlerSize/2,n=r._isHorizontal?r._valueScale:r._stateScale,a=r._isHorizontal?r._valueField:r._stateField;return n.scale(t[a])+r.getLayoutStartPoint().y+e+i},r._dataToPositionY2=function(t){var e=r._isHorizontal?r._middleHandlerSize:0,i=r._isHorizontal?0:r._startHandlerSize/2,n=r._isHorizontal?r._valueScale:r._stateScale,a=n.domain()[0];return n.scale(a)+r.getLayoutStartPoint().y+e+i},r._valueField="y",r._filterMode=null!==(n=e.filterMode)&&void 0!==n?n:"filter",r}return S(e,t),e.prototype.created=function(){t.prototype.created.call(this),this._initValueScale()},e.prototype.setAttrFromSpec=function(){var e,i,n,r,a,o,s,l,u,c;t.prototype.setAttrFromSpec.call(this),z(this._spec.roam)&&(this._zoomAttr.enable=this._spec.roam,this._dragAttr.enable=this._spec.roam,this._scrollAttr.enable=this._spec.roam),(this._zoomAttr.enable||this._dragAttr.enable||this._scrollAttr.enable)&&this.initZoomable(this.event,this._option.mode),this._backgroundSize=null!==(i=null===(e=this._spec.background)||void 0===e?void 0:e.size)&&void 0!==i?i:30,this._middleHandlerSize=this._computeMiddleHandlerSize(),this._width=this._computeWidth(),this._height=this._computeHeight(),j(null===(a=null===(r=null===(n=this._spec)||void 0===n?void 0:n.startHandler)||void 0===r?void 0:r.style)||void 0===a?void 0:a.size)&&(this._spec.startHandler.style.size=this._isHorizontal?this._height-this._middleHandlerSize:this._width-this._middleHandlerSize),j(null===(l=null===(s=null===(o=this._spec)||void 0===o?void 0:o.endHandler)||void 0===s?void 0:s.style)||void 0===l?void 0:l.size)&&(this._spec.endHandler.style.size=this._isHorizontal?this._height-this._middleHandlerSize:this._width-this._middleHandlerSize);var h=null===(u=this._spec.startHandler.style.visible)||void 0===u||u,d=null===(c=this._spec.endHandler.style.visible)||void 0===c||c;this._startHandlerSize=h?this._spec.startHandler.style.size:0,this._endHandlerSize=d?this._spec.endHandler.style.size:0},e.prototype.onLayoutEnd=function(e){this._updateScaleRange(),this._isReverse()&&!this._isReverseCache&&(this._isReverseCache=this._isReverse(),this.effect.onZoomChange()),!1!==this._cacheVisibility&&t.prototype.onLayoutEnd.call(this,e)},e.prototype._initValueScale=function(){var t=this._computeDomainOfValueScale();if(t){var e=new II;e.domain(t),this._valueScale=e}},e.prototype._updateScaleRange=function(){var t,e,i=this._startHandlerSize+this._endHandlerSize;if(this._stateScale&&this._valueScale){var n,r=this._isHorizontal?this.getLayoutRect().width-i:this.getLayoutRect().height-i,a=null!==(e=null===(t=this._relatedAxisComponent)||void 0===t?void 0:t.getScale().range())&&void 0!==e?e:[this._startHandlerSize/2,r+this._startHandlerSize/2],o=this._computeWidth(),s=this._computeHeight();this._isHorizontal?(n=this._visible?[this._startHandlerSize/2,o-i+this._startHandlerSize/2]:a,this._stateScale.range(n),this._valueScale.range([s-this._middleHandlerSize,0])):(n=this._visible?[this._startHandlerSize/2,s-i+this._startHandlerSize/2]:a,this._stateScale.range(n),"left"===this.layoutOrient?this._valueScale.range([o-this._middleHandlerSize,0]):this._valueScale.range([0,o-this._middleHandlerSize])),this._component&&!1!==this._cacheVisibility&&this._component.setAttributes({size:{width:o,height:s},position:{x:this.getLayoutStartPoint().x,y:this.getLayoutStartPoint().y}})}},e.prototype._computeDomainOfValueScale=function(){var t=this,e=this._data.getLatestData().map((function(e){return e[t._valueField]})),i=e.map((function(t){return 1*t}));return e.length?[At(i),St(i)]:null},e.prototype._computeMiddleHandlerSize=function(){var t,e,i,n,r=0;if(null===(e=null===(t=this._spec)||void 0===t?void 0:t.middleHandler)||void 0===e?void 0:e.visible){var a=null!==(i=this._spec.middleHandler.icon.style.size)&&void 0!==i?i:8,o=null!==(n=this._spec.middleHandler.background.size)&&void 0!==n?n:40;r+=Math.max(a,o)}return r},e.prototype._computeWidth=function(){return!1===this._visible?0:Z(this._spec.width)?this._spec.width:this._isHorizontal?this.getLayoutRect().width:this._backgroundSize+this._middleHandlerSize},e.prototype._computeHeight=function(){return!1===this._visible?0:Z(this._spec.height)?this._spec.height:this._isHorizontal?this._backgroundSize+this._middleHandlerSize:this.getLayoutRect().height},e.prototype._isScaleValid=function(t){if(!t||!t.domain())return!1;var e,i=t.domain();return(!NB(t.type)||i[0]!==kt(i))&&(!WB(t.type)||1!==(e=i,e&&X(e)?Array.from(new Set(xt(e))):e).length)},e.prototype._getAttrs=function(t){var e,i,n,r,a,o=null!==(e=this._spec)&&void 0!==e?e:{};return A({zIndex:this.layoutZIndex,start:this._start,end:this._end,position:{x:this.getLayoutStartPoint().x,y:this.getLayoutStartPoint().y},orient:this._orient,size:{width:this._computeWidth(),height:this._computeHeight()},showDetail:o.showDetail,brushSelect:null!==(i=o.brushSelect)&&void 0!==i&&i,zoomLock:null!==(n=o.zoomLock)&&void 0!==n&&n,minSpan:this._minSpan,maxSpan:this._maxSpan,delayType:o.delayType,delayTime:N(o.delayType)?null!==(r=o.delayTime)&&void 0!==r?r:30:0,realTime:null===(a=o.realTime)||void 0===a||a,previewData:t&&this._data.getLatestData(),previewPointsX:t&&this._dataToPositionX,previewPointsY:t&&this._dataToPositionY,tolerance:this._spec.tolerance},this._getComponentAttrs(t))},e.prototype._createOrUpdateComponent=function(){var t=this;if(this._visible){var e=this._isHorizontal?this._stateScale:this._valueScale,i=this._isHorizontal?this._valueScale:this._stateScale,n=this._isScaleValid(e)&&this._isScaleValid(i)&&!1!==this._spec.showBackgroundChart,r=this._getAttrs(n);if(this._component)this._component.setAttributes(r);else{var a=this.getContainer();this._component=new nD(r),this._isHorizontal?n&&this._component.setPreviewPointsY1(this._dataToPositionY2):n&&this._component.setPreviewPointsX1(this._dataToPositionX2),this._component.setStatePointToData((function(e){return t.statePointToData(e)})),this._component.addEventListener("change",(function(e){var i=e.detail,n=i.start,r=i.end,a=i.tag;t._handleChange(n,r,void 0,a)})),a.add(this._component),this._updateScaleRange()}}},e.prototype._handleChange=function(e,i,n,r){if(t.prototype._handleChange.call(this,e,i,n),this._shouldChange){n&&this._component&&this._component.setStartAndEnd(e,i),this._start=e,this._end=i;var a=this.statePointToData(e),o=this.statePointToData(i);(H(this._spec.updateDataAfterChange)?this._spec.updateDataAfterChange(e,i,a,o):this._handleStateChange(a,o,r))&&this.event.emit(cG.dataZoomChange,{model:this,value:{filterData:"axis"!==this._filterMode,start:e,end:i,startValue:this._startValue,endValue:this._endValue,newDomain:this._newDomain}})}},e.prototype._handleDataCollectionChange=function(){var t,e=this._data.getDataView();if(e.reRunAllTransform(),null===(t=this._component)||void 0===t||t.setPreviewData(e.latestData),this._valueScale){var i=this._computeDomainOfValueScale();i&&this._valueScale.domain(i)}},e.prototype._getComponentAttrs=function(t){var e,i,n,r,a,o,s,l,u,c,h,d=this._spec,p=d.middleHandler,f=void 0===p?{}:p,v=d.startText,g=void 0===v?{}:v,y=d.endText,m=void 0===y?{}:y,_=d.backgroundChart,b=void 0===_?{}:_,x=d.selectedBackgroundChart,k=void 0===x?{}:x;return{backgroundStyle:GH(null===(e=this._spec.background)||void 0===e?void 0:e.style),startHandlerStyle:GH(null===(i=this._spec.startHandler)||void 0===i?void 0:i.style),middleHandlerStyle:f.visible?{visible:!0,icon:GH(null===(n=f.icon)||void 0===n?void 0:n.style),background:{size:null===(r=f.background)||void 0===r?void 0:r.size,style:GH(null===(a=f.background)||void 0===a?void 0:a.style)}}:{visible:!1},endHandlerStyle:GH(null===(o=this._spec.endHandler)||void 0===o?void 0:o.style),startTextStyle:{padding:g.padding,formatMethod:this._getHandlerTextFormatMethod(g),textStyle:GH(g.style)},endTextStyle:{padding:m.padding,formatMethod:this._getHandlerTextFormatMethod(m),textStyle:GH(m.style)},selectedBackgroundStyle:GH(this._spec.selectedBackground.style),dragMaskStyle:GH(null===(s=this._spec.dragMask)||void 0===s?void 0:s.style),backgroundChartStyle:t?{line:xz(GH(null===(l=b.line)||void 0===l?void 0:l.style),{fill:!1}),area:A({curveType:"basis",visible:!0},GH(null===(u=b.area)||void 0===u?void 0:u.style))}:{line:{visible:!1},area:{visible:!1}},selectedBackgroundChartStyle:t?{line:xz(GH(null===(c=k.line)||void 0===c?void 0:c.style),{fill:!1}),area:A({curveType:"basis",visible:!0},GH(null===(h=k.area)||void 0===h?void 0:h.style))}:{line:{visible:!1},area:{visible:!1}},disableTriggerEvent:this._option.disableTriggerEvent}},e.prototype._getHandlerTextFormatMethod=function(t){var e=t.formatMethod,i=t.formatter,n=xY(e,i).formatFunc;return n?function(t){return n(t,{label:t},i)}:void 0},e.prototype._getNeedClearVRenderComponents=function(){return[this._component]},e.prototype.clear=function(){if(this._component){var e=this.getContainer();this._component.removeAllChild(),e&&e.removeChild(this._component),this._component=null}t.prototype.clear.call(this)},e.type=B.dataZoom,e.transformerConstructor=E8,e.specKey="dataZoom",e}(C8),R8=function(){kz.registerComponent(P8.type,P8)},B8=function(t){function e(e,i){var n,r=this;return(r=t.call(this,e,i)||this).type=B.scrollBar,r.name=B.scrollBar,r.specKey="scrollBar",r.layoutZIndex=wU.DataZoom,r.layoutLevel=TU.DataZoom,r.layoutType="region-relative",r._filterMode=null!==(n=e.filterMode)&&void 0!==n?n:"axis",r}return S(e,t),e.prototype.setAttrFromSpec=function(){t.prototype.setAttrFromSpec.call(this),z(this._spec.roam)&&(this._zoomAttr.enable=!1,this._dragAttr.enable=this._spec.roam,this._scrollAttr.enable=this._spec.roam),(this._zoomAttr.enable||this._dragAttr.enable||this._scrollAttr.enable)&&this.initZoomable(this.event,this._option.mode)},e.prototype.onLayoutEnd=function(e){var i,n;this._updateScaleRange(),null===(n=(i=this.effect).onZoomChange)||void 0===n||n.call(i),t.prototype.onLayoutEnd.call(this,e)},e.prototype._updateScaleRange=function(){this._component&&this._component.setAttributes({x:this.getLayoutStartPoint().x,y:this.getLayoutStartPoint().y,width:this.getLayoutRect().width,height:this.getLayoutRect().height})},e.prototype._computeWidth=function(){return Z(this._spec.width)?this._spec.width:this._isHorizontal?this.getLayoutRect().width:12},e.prototype._computeHeight=function(){return Z(this._spec.height)?this._spec.height:this._isHorizontal?12:this.getLayoutRect().height},e.prototype._getAttrs=function(){var t,e,i,n,r,a;return A({zIndex:this.layoutZIndex,x:this.getLayoutStartPoint().x,y:this.getLayoutStartPoint().y,width:this.getLayoutRect().width,height:this.getLayoutRect().height,range:[this._start,this._end],direction:this._isHorizontal?"horizontal":"vertical",delayType:null===(t=this._spec)||void 0===t?void 0:t.delayType,delayTime:N(null===(e=this._spec)||void 0===e?void 0:e.delayType)?null!==(n=null===(i=this._spec)||void 0===i?void 0:i.delayTime)&&void 0!==n?n:30:0,realTime:null===(a=null===(r=this._spec)||void 0===r?void 0:r.realTime)||void 0===a||a},this._getComponentAttrs())},e.prototype._createOrUpdateComponent=function(){var t=this,e=this._getAttrs();if(this._component)this._component.setAttributes(e);else{var i=this.getContainer();this._component=new GP(e),this._component.addEventListener("scrollDrag",(function(e){var i=e.detail.value;t._handleChange(i[0],i[1])})),this._component.addEventListener("scrollUp",(function(e){var i=e.detail.value;t._handleChange(i[0],i[1])})),i.add(this._component)}},e.prototype._handleChange=function(e,i,n){t.prototype._handleChange.call(this,e,i,n);var r=zO(this._start,e)&&zO(this._end,i);if(this._shouldChange&&(!r||!1===this._spec.realTime)){n&&this._component&&this._component.setAttribute("range",[e,i]),this._start=e,this._end=i;var a=this.statePointToData(e),o=this.statePointToData(i);(H(this._spec.updateDataAfterChange)?this._spec.updateDataAfterChange(e,i,a,o):this._handleStateChange(this.statePointToData(e),this.statePointToData(i)))&&this.event.emit(cG.scrollBarChange,{model:this,value:{filterData:"axis"!==this._filterMode,start:this._start,end:this._end,startValue:this._startValue,endValue:this._endValue,newDomain:this._newDomain}})}},e.prototype._handleDataCollectionChange=function(){this._spec.auto&&this._data.getDataView().reRunAllTransform()},e.prototype._getComponentAttrs=function(){var t=this._spec,e=t.rail,i=t.slider,n=t.innerPadding,r={};return j(n)||(r.padding=n),ot(null==e?void 0:e.style)||(r.railStyle=GH(e.style)),ot(null==i?void 0:i.style)||(r.sliderStyle=GH(i.style)),r.disableTriggerEvent=this._option.disableTriggerEvent,r},e.prototype._getNeedClearVRenderComponents=function(){return[this._component]},e.type=B.scrollBar,e.specKey="scrollBar",e}(C8),I8=function(){kz.registerComponent(B8.type,B8)},L8=function(t,e){var i=e.datum,n=e.title,r=e.content,a=[],o=i.call(null);return n.visible&&a.push({type:"title",index:0,datum:o,spec:n}),xt(r).forEach((function(t,e){t.visible&&a.push({type:"content",index:e,datum:o,spec:t})})),a},D8=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=B.indicator,e.name=B.indicator,e.specKey="indicator",e.layoutType="none",e.layoutZIndex=wU.Indicator,e.layoutLevel=TU.Indicator,e._gap=0,e._activeDatum=null,e}return S(e,t),e.getSpecInfo=function(t){return kY(t,this.specKey,this.type,(function(t){return t&&!1!==t.visible}))},e.prototype.created=function(){t.prototype.created.call(this),this.initData(),this.initEvent()},e.prototype.setAttrFromSpec=function(){t.prototype.setAttrFromSpec.call(this),this._gap=this._spec.gap||0,this._title=this._spec.title,this._content=xt(this._spec.content),this._regions=this._option.getRegionsInUserIdOrIndex(xt(this._spec.regionId),xt(this._spec.regionIndex))},e.prototype.onRender=function(t){},e.prototype.changeRegions=function(t){},e.prototype.initEvent=function(){var t,e=this;if(!this._option.disableTriggerEvent&&"none"!==this._spec.trigger){var i=null===(t=this.getCompiler())||void 0===t?void 0:t.getVGrammarView();i&&("hover"===this._spec.trigger?(i.addEventListener("element-highlight:start",(function(t){e.isRelativeModel(t.options.regionId)&&e.updateDatum(t.elements[0].getDatum())})),i.addEventListener("element-highlight:reset",(function(t){e.isRelativeModel(t.options.regionId)&&e.updateDatum(null)}))):(i.addEventListener("element-select:start",(function(t){e.isRelativeModel(t.options.regionId)&&e.updateDatum(t.elements[0].getDatum())})),i.addEventListener("element-select:reset",(function(t){e.isRelativeModel(t.options.regionId)&&e.updateDatum(null)}))))}},e.prototype.updateDatum=function(t){this._activeDatum=t,this._displayData.updateData();var e=this._getIndicatorAttrs();this._createOrUpdateIndicatorComponent(e)},e.prototype.initData=function(){var t=this;qG(this._option.dataSet,"indicatorFilter",L8);var e=new Ms(this._option.dataSet,{name:"".concat(this.type,"_").concat(this.id,"_data")});e.transform({type:"indicatorFilter",options:{title:this._title,content:this._content,datum:function(){return t._activeDatum}}}),e.target.addListener("change",this.updateDatum.bind(this)),this._displayData=new iY(this._option,e)},e.prototype.updateLayoutAttribute=function(){var e=this._getIndicatorAttrs();this._createOrUpdateIndicatorComponent(e),t.prototype.updateLayoutAttribute.call(this)},e.prototype._getIndicatorAttrs=function(){var t=this;if(!1===this._spec.visible||!1===this._spec.fixed&&null===this._activeDatum)return{visible:!1};var e=this._regions[0],i=e.getLayoutRect(),n=i.width,r=i.height,a=e.getLayoutStartPoint(),o=a.x,s=a.y,l=this._spec,u=l.content,c=l.offsetX,h=l.offsetY,d=l.limitRatio,p=l.title,f=M(l,["content","offsetX","offsetY","limitRatio","title"]),v=[];return xt(u).forEach((function(e){var i=xz({},t._theme.content,e);v.push({visible:!1!==i.visible&&(!i.field||null!==t._activeDatum),space:i.space||t._gap,autoLimit:i.autoLimit,autoFit:i.autoFit,fitPercent:i.fitPercent,fitStrategy:i.fitStrategy,style:A(A({},WH(vt(i.style,["text"]),t._activeDatum)),{text:t._createText(i.field,i.style.text)})})})),A({visible:!0,size:{width:n,height:r},zIndex:this.layoutZIndex,x:o,y:s,dx:c?kF(c,this._computeLayoutRadius()):0,dy:h?kF(h,this._computeLayoutRadius()):0,limitRatio:d||1/0,title:{visible:!1!==p.visible&&(!N(p.field)||null!==this._activeDatum),space:p.space||this._gap,autoLimit:p.autoLimit,autoFit:p.autoFit,fitPercent:p.fitPercent,fitStrategy:p.fitStrategy,style:A(A({},WH(vt(p.style,["text"]),this._activeDatum)),{text:this._createText(p.field,p.style.text)})},content:v},f)},e.prototype._createOrUpdateIndicatorComponent=function(t){var e=this;if(!1===t.visible)return this._indicatorComponent&&this._indicatorComponent.parent&&this._indicatorComponent.parent.removeChild(this._indicatorComponent),void(this._indicatorComponent=null);if(this._indicatorComponent)mt(t,this._cacheAttrs)||this._indicatorComponent.setAttributes(t);else{var i=this.getContainer(),n=new fO(t);n.name="indicator",i.add(n),this._indicatorComponent=n,this._indicatorComponent.on("*",(function(t,i){return e._delegateEvent(e._indicatorComponent,t,i)}))}this._cacheAttrs=t},e.prototype._createText=function(t,e){var i;return t?this._activeDatum?this._activeDatum[t]:"":H(e)?null!==(i=e(this._activeDatum,void 0))&&void 0!==i?i:"":null!=e?e:""},e.prototype._computeLayoutRadius=function(){var t=this._regions[0].getLayoutRect(),e=t.width,i=t.height;return Math.min(e/2,i/2)},e.prototype.isRelativeModel=function(t){return this._regions.some((function(e){return e.id===t}))},e.prototype._getNeedClearVRenderComponents=function(){return[this._indicatorComponent]},e.prototype.clear=function(){this._cacheAttrs=null,t.prototype.clear.call(this)},e.prototype.getIndicatorComponent=function(){return this._indicatorComponent},e.type=B.indicator,e.specKey="indicator",e}(rK),O8=function(){kz.registerComponent(D8.type,D8)},F8=["sum","average","min","max","variance","standardDeviation","median"];function z8(t,e,i){if(!i)return!1;var n=t.map((function(t){return 1*t})),r=At(n),a=St(n);return e<r||e>a}function H8(t,e,i,n,r,a){var o,s,l=n.relativeSeries;return Z(t.x)&&z8(e,t.x,i)&&(null===(s=null==l?void 0:(o=l.getXAxisHelper()).setExtendDomain)||void 0===s||s.call(o,"marker_xAxis_extend",t.x)),yF(t.x)?W8(t.x,r)+a.x:l.getXAxisHelper().dataToPosition([t.x])+a.x}function j8(t,e,i,n,r,a){var o,s,l=n.relativeSeries;return Z(t.y)&&z8(e,t.y,i)&&(null===(s=null===(o=l.getYAxisHelper())||void 0===o?void 0:o.setExtendDomain)||void 0===s||s.call(o,"marker_yAxis_extend",t.y)),yF(t.y)?W8(t.y,r)+a.y:l.getYAxisHelper().dataToPosition([t.y])+a.y}function N8(t,e,i,n){var r,a,o=n.relativeSeries;return Z(t.angle)&&z8(e,t.angle,i)&&(null===(a=null===(r=o.angleAxisHelper)||void 0===r?void 0:r.setExtendDomain)||void 0===a||a.call(r,"marker_angleAxis_extend",t.angle)),o.angleAxisHelper.dataToPosition([t.angle])}function V8(t,e,i,n){var r,a,o=n.relativeSeries;return Z(t.radius)&&z8(e,t.radius,i)&&(null===(a=null===(r=o.radiusAxisHelper)||void 0===r?void 0:r.setExtendDomain)||void 0===a||a.call(r,"marker_radiusAxis_extend",t.radius)),o.radiusAxisHelper.dataToPosition([t.radius])}function W8(t,e){return Number(t.substring(0,t.length-1))*e/100}function G8(t){return F8.includes(t)}function U8(t,e,i,n,r){var a=e.getRegion(),o=a.getLayoutStartPoint(),s=i.getRegion(),l=s.getLayoutStartPoint(),u=Math.abs(Math.min(o.x,l.x)-Math.max(o.x+a.getLayoutRect().width,l.x+s.getLayoutRect().width)),c=Math.abs(Math.min(o.y,l.y)-Math.max(o.y+a.getLayoutRect().height,l.y+s.getLayoutRect().height)),h={relativeSeries:n,startRelativeSeries:e,endRelativeSeries:i},d=[],p=t.latestData[0]&&t.latestData[0].latestData?t.latestData[0].latestData:t.latestData,f=n.getXAxisHelper().getScale(0).domain(),v=n.getYAxisHelper().getScale(0).domain();return p.forEach((function(t){var e=N(t.x),i=N(t.y);if(e&&i){var n=H8(t,f,r,h,u,o),p=j8(t,v,r,h,c,o);d.push([{x:n,y:p}])}else if(e){n=H8(t,f,r,h,u,o),p=Math.max(o.y+a.getLayoutRect().height,l.y+s.getLayoutRect().height);var g=Math.min(o.y,l.y);d.push([{x:n,y:p},{x:n,y:g}])}else if(i){n=Math.min(o.x,l.x),p=j8(t,v,r,h,c,o);var y=Math.max(o.x+a.getLayoutRect().width,l.x+s.getLayoutRect().width);d.push([{x:n,y:p},{x:y,y:p}])}})),d}function Y8(t,e,i,n,r){var a={relativeSeries:n,startRelativeSeries:e,endRelativeSeries:i},o=[],s=t.latestData[0]&&t.latestData[0].latestData?t.latestData[0].latestData:t.latestData,l=n.angleAxisHelper.getScale(0).domain(),u=n.radiusAxisHelper.getScale(0).domain(),c=Math.min(n.getRegion().getLayoutRect().width/2,n.getRegion().getLayoutRect().height/2);return s.forEach((function(t){var e=N(t.angle),i=N(t.radius);if(e&&i){var n=N8(t,l,r,a),s=V8(t,u,r,a);o.push([{angle:n,radius:s}])}else if(e){n=N8(t,l,r,a);o.push([{angle:n,radius:-c},{angle:n,radius:c}])}else if(i){s=V8(t,u,r,a);o.push([{radius:s,angle:0},{radius:s,angle:2*Math.PI}])}})),o}function X8(t,e,i,n){var r=[],a=t.latestData[0]&&t.latestData[0].latestData?t.latestData[0].latestData:t.latestData,o=X(n);return a.forEach((function(t,a){var s,l,u,c,h=(null==t?void 0:t.getRefRelativeSeries)?t.getRefRelativeSeries():e,d=h.getRegion(),p=d.getLayoutStartPoint(),f=d.getLayoutRect(),v=f.width,g=f.height,y=0,m=0;if(n){var _=o?n[a]:n,b=_.x,x=_.y;b&&(y=yF(b)?Number(b.substring(0,b.length-1))*v/100:b),x&&(m=yF(x)?Number(x.substring(0,x.length-1))*g/100:x)}var k=h.getXAxisHelper().getScale(0).domain(),S=h.getYAxisHelper().getScale(0).domain(),A=xt(t.x),M=xt(t.y);1===A.length&&Z(A[0])&&z8(k,A[0],i)&&(null===(l=null===(s=h.getXAxisHelper())||void 0===s?void 0:s.setExtendDomain)||void 0===l||l.call(s,"marker_xAxis_extend",A[0])),1===M.length&&Z(M[0])&&z8(S,M[0],i)&&(null===(c=null===(u=h.getYAxisHelper())||void 0===u?void 0:u.setExtendDomain)||void 0===c||c.call(u,"marker_yAxis_extend",M[0])),r.push({x:h.getXAxisHelper().dataToPosition(A)+p.x+y,y:h.getYAxisHelper().dataToPosition(M)+p.y+m})})),r}function K8(t,e,i){var n=[];return(t.latestData[0]&&t.latestData[0].latestData?t.latestData[0].latestData:t.latestData).forEach((function(t){var r,a,o,s,l=(null==t?void 0:t.getRefRelativeSeries)?t.getRefRelativeSeries():e,u=l.angleAxisHelper.getScale(0).domain(),c=l.radiusAxisHelper.getScale(0).domain(),h=xt(t.angle),d=xt(t.radius);1===h.length&&Z(h[0])&&z8(u,h[0],i)&&(null===(a=null===(r=l.angleAxisHelper)||void 0===r?void 0:r.setExtendDomain)||void 0===a||a.call(r,"marker_xAxis_extend",h[0])),1===d.length&&Z(d[0])&&z8(c,d[0],i)&&(null===(s=null===(o=l.radiusAxisHelper)||void 0===o?void 0:o.setExtendDomain)||void 0===s||s.call(o,"marker_yAxis_extend",d[0])),n.push({angle:l.angleAxisHelper.dataToPosition(h),radius:l.radiusAxisHelper.dataToPosition(d)})})),n}function q8(t,e,i){var n=t.x,r=t.y;return yF(n)&&(n=W8(n,e)),yF(r)&&(r=W8(r,i)),{x:n,y:r}}function Z8(t,e,i){var n;if(n=H(t)?xt(t(e.getData().getLatestData(),e)):xt(t),i){var r=e.getRegion(),a=r.getLayoutStartPoint(),o=a.x,s=a.y,l=r.getLayoutRect(),u=l.width,c=l.height;return n.map((function(t){var e=q8(t,u,c),i=e.x,n=e.y;return{x:i+=o,y:n+=s}}))}var h=e.getOption().getChart().getViewRect(),d=h.width,p=h.height;return n.map((function(t){return q8(t,d,p)}))}function J8(t){var e=1/0,i=-1/0,n=1/0,r=-1/0;return t.forEach((function(t){var a=t.getLayoutStartPoint(),o=t.getLayoutRect();a.x<e&&(e=a.x),a.x+o.width>i&&(i=a.x+o.width),a.y<n&&(n=a.y),a.y+o.height>r&&(r=a.y+o.height)})),{minX:e,maxX:i,minY:n,maxY:r}}function Q8(t,e,i){var n=t.labelBackground,r=void 0===n?{}:n,a=t.style,o=t.shape,s=M(t,["labelBackground","style","shape"]);if(!1!==t.visible){var l=s;return(null==o?void 0:o.visible)?l.shape=A({visible:!0},GH(o.style)):l.shape={visible:!1},!1!==r.visible?(l.panel=A({visible:!0,customShape:r.customShape},t7(GH(r.style),e,i)),N(r.padding)&&(l.padding=Ei(r.padding))):(l.panel={visible:!1},l.padding=0),a&&(l.textStyle=t7(GH(a),e,i)),l}return{visible:!1}}function $8(t,e,i){for(var n in t)H(t[n])&&(t[n]=t[n](e,i));return t}function t7(t,e,i){return H(t)?t(e,i):t}function e7(t,e){return H(t)?t(e):t}function i7(t,e,i){return N(t)?"regionLeft"===e?i.getLayoutStartPoint().x-t.x:"regionRight"===e?i.getLayoutStartPoint().x+i.getLayoutRect().width-t.x:"regionTop"===e?i.getLayoutStartPoint().y-t.y:"regionBottom"===e?i.getLayoutStartPoint().y+i.getLayoutRect().height-t.y:e:e}function n7(t){return{isXProcess:N(t.x),isYProcess:N(t.y),isX1Process:N(t.x1),isY1Process:N(t.y1),isAngleProcess:N(t.angle),isRadiusProcess:N(t.radius),isAngle1Process:N(t.angle1),isRadius1Process:N(t.radius1),isCoordinatesProcess:N(t.coordinates),isValidProcess:N(t.process)}}function r7(t){var e=n7(t),i=e.isXProcess,n=e.isYProcess,r=e.isX1Process,a=e.isY1Process,o=e.isAngleProcess,s=e.isRadiusProcess,l=e.isAngle1Process,u=e.isRadius1Process,c=e.isCoordinatesProcess,h=e.isValidProcess;return{doXProcess:i&&!n&&!a,doXYY1Process:i&&n&&a,doYProcess:n&&!i&&!r,doYXX1Process:n&&i&&r,doXYProcess:i&&n&&r&&a,doAngleProcess:o&&!l&&!s&&!u,doRadiusProcess:s&&!u&&!o&&!l,doAngRadRad1Process:o&&!l&&s&&u,doRadAngAng1Process:s&&o&&l&&!u,doRadAngProcess:o&&s&&l&&u,doCoordinatesProcess:c&&(!h||"process"in t&&"xy"in t.process)}}function a7(t){var e=n7(t),i=e.isXProcess,n=e.isYProcess,r=e.isX1Process,a=e.isY1Process,o=e.isAngleProcess,s=e.isRadiusProcess,l=e.isAngle1Process,u=e.isRadius1Process;return{doXProcess:i&&r&&!n&&!a,doYProcess:n&&a&&!i&&!r,doXYProcess:i&&r&&n&&a,doAngleProcess:o&&l&&!s&&!u,doRadiusProcess:s&&u&&!o&&!l,doRadAngProcess:o&&s&&l&&u,doCoordinatesProcess:e.isCoordinatesProcess}}function o7(t){return{doXYProcess:N(t.x)&&N(t.y),doPolarProcess:N(t.angle)&&N(t.radius),doGeoProcess:N(t.areaName)}}function s7(t,e){var i;if(e.coordinates){var n,r=e,a=r.coordinates,o=r.coordinateType,s=r.getSeriesByIdOrIndex,l=M(r,["coordinates","coordinateType","getSeriesByIdOrIndex"]),u=void 0;if(H(a)){var c=e.getRelativeSeries();u=a(c.getData().getLatestData(),c)}else u=a;i=(u=xt(u)).map((function(t){var e=s(t.refRelativeSeriesId,t.refRelativeSeriesIndex);if("cartesian"===o){var i=e.getSpec(),r=i.xField,a=i.yField,u=t.xFieldDim,c=t.xFieldIndex,h=t.yFieldDim,d=t.yFieldIndex,p=r;N(c)&&(p=xt(r)[c]),u&&xt(r).includes(u)&&(p=u);var f=a;N(d)&&(f=xt(a)[d]),h&&xt(a).includes(h)&&(f=h),n=A({x:void 0,y:void 0},l),Y(t[p])&&G8(t[p])?n.x={field:p,aggrType:t[p]}:n.x=xt(p).map((function(e){return t[e]})),Y(t[f])&&G8(t[f])?n.y={field:f,aggrType:t[f]}:n.y=xt(f).map((function(e){return t[e]}))}else if("polar"===o){var v=e.getSpec(),g=v.valueField,y=v.categoryField,m=t.angleFieldDim,_=t.angleFieldIndex,b=y;N(_)&&(b=xt(y)[_]),m&&xt(y).includes(m)&&(b=m);var x=g;n=A({angle:void 0,radius:void 0},l),Y(t[b])&&G8(t[b])?n.angle={field:b,aggrType:t[b]}:n.angle=xt(b).map((function(e){return t[e]})),Y(t[x])&&G8(t[x])?n.radius={field:x,aggrType:t[x]}:n.radius=xt(x).map((function(e){return t[e]}))}return n.getRefRelativeSeries=function(){return e},n}))}else i=e;var h=[];return i.forEach((function(e){var i={x:null,y:null,angle:null,radius:null,areaName:null};if(N(e.x)){var n=e.x;X(n)?i.x=n.map((function(i){return u7(i,t,e)})):i.x=u7(n,t,e)}if(N(e.y)){var r=e.y;X(r)?i.y=r.map((function(i){return u7(i,t,e)})):i.y=u7(r,t,e)}if(N(e.angle)){var a=e.angle;X(a)?i.angle=a.map((function(i){return u7(i,t,e)})):i.angle=u7(a,t,e)}if(N(e.radius)){var o=e.radius;X(o)?i.radius=o.map((function(i){return u7(i,t,e)})):i.radius=u7(o,t,e)}if(N(e.areaName)){var s=e.areaName;i.areaName=u7(s,t,e)}e.getRefRelativeSeries&&(i.getRefRelativeSeries=e.getRefRelativeSeries),h.push(i)})),h}var l7={min:function(t,e){return HO(t[0].latestData,e.field)},max:function(t,e){return jO(t[0].latestData,e.field)},sum:function(t,e){return NO(t[0].latestData,e.field)},average:function(t,e){return VO(t[0].latestData,e.field)},variance:function(t,e){return WO(t[0].latestData,e.field)},standardDeviation:function(t,e){return function(t,e){return Math.sqrt(WO(t,e))}(t[0].latestData,e.field)},median:function(t,e){return function(t,e){return zt(t.map((function(t){return t[e]})))}(t[0].latestData,e.field)}};function u7(t,e,i){var n=i.getRelativeSeries(),r=i.getStartRelativeSeries(),a=i.getEndRelativeSeries(),o=n.getData().getLatestData(),s=r.getData().getLatestData(),l=a.getData().getLatestData();if(H(t))return t(o,s,l,n,r,a);if(G(t)){var u=t,c=u.aggrType,h=u.field;return l7[c](e,{field:h})}return t}function c7(t,e){if(e&&e.getRelativeSeries){var i=e.getRelativeSeries();if(i){var n=i.getViewData();return n&&n.latestData&&n.latestData.length?t:[]}}return t}var h7=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.layoutType="none",e._layoutOffsetX=0,e._layoutOffsetY=0,e}return S(e,t),e.prototype.getRelativeSeries=function(){return this._relativeSeries},e.prototype.getMarkerData=function(){return this._markerData},e._getMarkerCoordinateType=function(t){return"cartesian"},e.getSpecInfo=function(t){var e=this;return kY(t,this.specKey,this.type,(function(t){return!1!==t.visible&&e._getMarkerCoordinateType(t)===e.coordinateType}))},e.prototype.getMarkAttributeContext=function(){return this._markAttributeContext},e.prototype._buildMarkerAttributeContext=function(){this._markAttributeContext={relativeSeries:this._relativeSeries,startRelativeSeries:this._startRelativeSeries,endRelativeSeries:this._endRelativeSeries,vchart:this._option.globalInstance}},e.prototype.created=function(){t.prototype.created.call(this),this._bindSeries(),this._initDataView(),this.initEvent(),this._buildMarkerAttributeContext()},e.prototype._getAllRelativeSeries=function(){var t=this;return{getRelativeSeries:function(){return t._relativeSeries},getStartRelativeSeries:function(){return t._startRelativeSeries},getEndRelativeSeries:function(){return t._endRelativeSeries}}},e.prototype._getFieldInfoFromSpec=function(t,e,i){return Y(e)&&G8(e)?{field:i.getSpec()[{x:"xField",y:"yField",radius:"valueField",angle:"categoryField",areaName:"nameField"}[t]],aggrType:e}:e},e.prototype._processSpecByDims=function(t){var e=this,i=this._relativeSeries,n={};return t.forEach((function(t){return n[t.dim]=e._getFieldInfoFromSpec(t.dim,t.specValue,i)})),A(A({},n),this._getAllRelativeSeries())},e.prototype._processSpecCoo=function(t){var e=this;return A(A({coordinates:t.coordinates||t.coordinate},this._getAllRelativeSeries()),{getSeriesByIdOrIndex:function(t,i){return e._getSeriesByIdOrIndex(t,i)},coordinateType:this.coordinateType})},e.prototype._getRelativeDataView=function(){if(this._specifiedDataSeries){var t=[];xt(this._specifiedDataSeries).forEach((function(e){t=t.concat(e.getViewData().latestData)}));var e=new Ss;return e.registerParser("array",I),new Ms(e).parse(t,{type:"array"})}return this._relativeSeries.getViewData()},e.prototype.updateLayoutAttribute=function(){var e,i,n,r=this;if(null===(e=this._spec.visible)||void 0===e||e){if(!this._markerComponent){var a=this._createMarkerComponent();a.name=null!==(i=this._spec.name)&&void 0!==i?i:this.type,a.id=null!==(n=this._spec.id)&&void 0!==n?n:"".concat(this.type,"-").concat(this.id),this._markerComponent=a,this.getContainer().add(this._markerComponent),this._markerComponent.on("*",(function(t,e){r._delegateEvent(r._markerComponent,t,e,null,r.getMarkerData.bind(r))}))}this._markerLayout()}t.prototype.updateLayoutAttribute.call(this)},e.prototype._getSeriesByIdOrIndex=function(t,e){var i,n,r;return(r=null===(i=this._option.getSeriesInUserIdOrIndex(N(t)?[t]:[],[e]))||void 0===i?void 0:i[0])||(r=null!==(n=this._relativeSeries)&&void 0!==n?n:this._getFirstSeries()),r},e.prototype._bindSeries=function(){var t=this._spec;this._relativeSeries=this._getSeriesByIdOrIndex(t.relativeSeriesId,t.relativeSeriesIndex),this._startRelativeSeries=this._getSeriesByIdOrIndex(t.startRelativeSeriesId,t.startRelativeSeriesIndex),this._endRelativeSeries=this._getSeriesByIdOrIndex(t.endRelativeSeriesId,t.endRelativeSeriesIndex),t.specifiedDataSeriesIndex&&"all"===t.specifiedDataSeriesIndex||t.specifiedDataSeriesId&&"all"===t.specifiedDataSeriesId?this._specifiedDataSeries=this._option.getAllSeries():(t.specifiedDataSeriesIndex||t.specifiedDataSeriesId)&&(this._specifiedDataSeries=this._getSeriesByIdOrIndex(t.specifiedDataSeriesId,t.specifiedDataSeriesIndex))},e.prototype.initEvent=function(){"cartesian"!==this._relativeSeries.coordinate&&(this._relativeSeries.event.on("zoom",this._markerLayout.bind(this)),this._relativeSeries.event.on("panmove",this._markerLayout.bind(this)),this._relativeSeries.event.on("scroll",this._markerLayout.bind(this)))},e.prototype.onRender=function(t){},e.prototype.changeRegions=function(t){},e.prototype.clear=function(){t.prototype.clear.call(this),this._firstSeries=null},e.prototype._getFirstSeries=function(){var t;if(this._firstSeries)return this._firstSeries;var e=QO(this._regions);return e?(this._firstSeries=e,e):(null===(t=this._option)||void 0===t||t.onError("need at least one series"),null)},e.prototype._getNeedClearVRenderComponents=function(){return[this._markerComponent]},e.prototype.onLayoutStart=function(e,i,n){j(this._spec.offsetX)||(this._layoutOffsetX=mF(this._spec.offsetX,i.width,i)),j(this._spec.offsetY)||(this._layoutOffsetY=mF(this._spec.offsetY,i.height,i)),t.prototype.onLayoutStart.call(this,e,i,n)},e.prototype._compareSpec=function(e,i){var n=t.prototype._compareSpec.call(this,e,i);return mt(i,e)||(n.reRender=!0,n.reMake=!0,n.change=!0),n},e.prototype._initCommonDataView=function(){var t=this,e=this._computeOptions().options,i=this._getRelativeDataView();qG(this._option.dataSet,"markerAggregation",s7),qG(this._option.dataSet,"markerFilter",c7);var n=new Ms(this._option.dataSet,{name:"".concat(this.type,"_").concat(this.id,"_data")});n.parse([i],{type:"dataview"}),n.transform({type:"markerAggregation",options:e}),n.transform({type:"markerFilter",options:this._getAllRelativeSeries()}),n.target.on("change",(function(){t._markerLayout()})),this._markerData=n},e}(rK);function d7(t,e){return function(t,e,i){var n,r,a=nS(t,(function(t){return t[e]}),(function(t){return t[i]})).predict,o=HO(t,e),s=jO(t,e),l=a(o),u=a(s);return[(n={},n[e]=o,n[i]=l,n),(r={},r[e]=s,r[i]=u,r)]}(t[0].latestData,e.fieldX,e.fieldY)}var p7=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.specKey="markLine",e.layoutZIndex=wU.MarkLine,e}return S(e,t),e._getMarkerCoordinateType=function(t){var e=r7(t),i=e.doAngleProcess,n=e.doRadiusProcess,r=e.doAngRadRad1Process,a=e.doRadAngAng1Process,o=e.doRadAngProcess;return"polar"===t.coordinateType||i||n||r||a||o?"polar":"cartesian"},e.prototype._createMarkerComponent=function(){var t,e,i,n,r,a,o,s,l,u,c,h,d,p=this,f=this._spec,v=f.startSymbol,g=void 0===v?{}:v,y=f.endSymbol,m=void 0===y?{}:y,_=xt(null!==(t=this._spec.label)&&void 0!==t?t:{}),b={zIndex:this.layoutZIndex,interactive:null===(e=this._spec.interactive)||void 0===e||e,hover:null===(i=this._spec.interactive)||void 0===i||i,select:null===(n=this._spec.interactive)||void 0===n||n,points:[{x:0,y:0},{x:0,y:0}],center:{x:0,y:0},radius:0,startAngle:0,endAngle:0,lineStyle:t7(GH(null===(r=this._spec.line)||void 0===r?void 0:r.style),this._markerData,this._markAttributeContext),clipInRange:null!==(a=this._spec.clip)&&void 0!==a&&a,label:_.map((function(t){return Q8(t,p._markerData,p._markAttributeContext)})),state:{line:$8(null!==(s=null===(o=this._spec.line)||void 0===o?void 0:o.state)&&void 0!==s?s:{},this._markerData,this._markAttributeContext),lineStartSymbol:$8(null!==(u=null===(l=this._spec.startSymbol)||void 0===l?void 0:l.state)&&void 0!==u?u:{},this._markerData,this._markAttributeContext),lineEndSymbol:$8(null!==(h=null===(c=this._spec.endSymbol)||void 0===c?void 0:c.state)&&void 0!==h?h:{},this._markerData,this._markAttributeContext),label:_.map((function(t){var e;return $8(null!==(e=t.state)&&void 0!==e?e:{},p._markerData,p._markAttributeContext)})),labelBackground:_.map((function(t){var e,i;return $8(null!==(i=null===(e=t.labelBackground)||void 0===e?void 0:e.state)&&void 0!==i?i:{},p._markerData,p._markAttributeContext)}))},animation:null!==(d=this._spec.animation)&&void 0!==d&&d,animationEnter:this._spec.animationEnter,animationExit:this._spec.animationExit,animationUpdate:this._spec.animationUpdate};return g.visible?b.startSymbol=A(A({},g),{visible:!0,style:t7(GH(g.style),this._markerData,this._markAttributeContext)}):b.startSymbol={visible:!1},m.visible?b.endSymbol=A(A({},m),{visible:!0,style:t7(GH(m.style),this._markerData,this._markAttributeContext)}):b.endSymbol={visible:!1},this._newMarkLineComponent(b)},e.prototype._getUpdateMarkerAttrs=function(){var t,e,i,n=this._spec,r=this._markerData,a=this._startRelativeSeries,o=this._endRelativeSeries,s=this._relativeSeries,l=this._computePointsAttr(),u=s.getViewData().latestData,c=r.latestData[0]&&r.latestData[0].latestData?r.latestData[0].latestData:r.latestData;if(n.clip||xt(n.label).some((function(t){return null==t?void 0:t.confine}))){var h=J8([a.getRegion(),o.getRegion(),s.getRegion()]),d=h.minX,p=h.maxX,f=h.minY;i={x:d,y:f,width:p-d,height:h.maxY-f}}var v=xt((null!==(e=null===(t=this._markerComponent)||void 0===t?void 0:t.attribute)&&void 0!==e?e:{}).label),g=xt(this._spec.label),y=v.map((function(t,e){var i=g[e]||{};return A(A({},t),{text:i.formatMethod?i.formatMethod(c,u):null==t?void 0:t.text})}));return A(A({},l),{label:y,limitRect:i,dx:this._layoutOffsetX,dy:this._layoutOffsetY})},e.prototype._markerLayout=function(){var t,e=this._getUpdateMarkerAttrs();null===(t=this._markerComponent)||void 0===t||t.setAttributes(e)},e.prototype._initDataView=function(){var t=this,e=this._spec,i="coordinates"in e,n=r7(e),r=n.doXProcess,a=n.doYProcess,o=n.doXYY1Process,s=n.doYXX1Process,l=n.doXYProcess,u=n.doAngleProcess,c=n.doRadiusProcess,h=n.doAngRadRad1Process,d=n.doRadAngAng1Process,p=n.doRadAngProcess;if(this._markerData=this._getRelativeDataView(),r||a||o||s||l||u||c||h||d||p||i){qG(this._option.dataSet,"markerAggregation",s7),qG(this._option.dataSet,"markerRegression",d7),qG(this._option.dataSet,"markerFilter",c7);var f=this._computeOptions(),v=f.options,g=f.needAggr,y=f.needRegr,m=f.processData,_=new Ms(this._option.dataSet);_.parse([m],{type:"dataview"}),g&&_.transform({type:"markerAggregation",options:v}),y&&_.transform({type:"markerRegression",options:v}),_.transform({type:"markerFilter",options:this._getAllRelativeSeries()}),_.target.on("change",(function(){t._markerLayout()})),this._markerData=_}},e.specKey="markLine",e}(h7),f7=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=B.markLine,e.name=B.markLine,e.coordinateType="cartesian",e}return S(e,t),e.prototype._newMarkLineComponent=function(t){return new zD(t)},e.prototype._computePointsAttr=function(){var t,e=this._spec,i=this._markerData,n=this._startRelativeSeries,r=this._endRelativeSeries,a=this._relativeSeries,o=N(e.coordinates),s=N(e.process),l=s&&N(e.process.x),u=s&&N(e.process.y),c=N(e.positions),h=null!==(t=e.autoRange)&&void 0!==t&&t,d=r7(e),p=d.doXProcess,f=d.doYProcess,v=d.doXYY1Process,g=d.doYXX1Process,y=d.doXYProcess,m=d.doCoordinatesProcess,_=[];if(p||v||f||g||y||o&&l||o&&u){var b=U8(i,n,r,a,h);_=1===b.length?b[0]:b.map((function(t){return t[0]}))}else m?_=X8(i,a,h,e.coordinatesOffset):c&&(_=Z8(e.positions,a,e.regionRelative));return{points:_}},e.prototype._markerLayout=function(){var t,e,i,n,r=this._getUpdateMarkerAttrs();if("type-step"===this._spec.type){var a=this._startRelativeSeries,o=this._endRelativeSeries,s=this._spec.line||{},l=s.multiSegment,u=s.mainSegmentIndex,c=this._spec,h=c.connectDirection,d=c.expandDistance,p=void 0===d?0:d,f=void 0;if(yF(p)){var v=a.getRegion(),g=v.getLayoutStartPoint(),y=o.getRegion(),m=y.getLayoutStartPoint();if("bottom"===h||"top"===h){var _=Math.abs(Math.min(g.y,m.y)-Math.max(g.y+v.getLayoutRect().height,m.y+y.getLayoutRect().height));f=Number(p.substring(0,p.length-1))*_/100}else{var b=Math.abs(Math.min(g.x,m.x)-Math.max(g.x+v.getLayoutRect().width,m.x+y.getLayoutRect().width));f=Number(p.substring(0,p.length-1))*b/100}}else f=p;var x,k=r.points,S=r.limitRect,M=function(t,e,i,n){void 0===n&&(n=0);var r=[],a=t.y-e.y,o=t.x-e.x;switch(i){case"top":r.push(t),r.push({x:t.x,y:a>0?t.y-n-Math.abs(a):t.y-n}),r.push({x:e.x,y:a>0?e.y-n:e.y-n-Math.abs(a)}),r.push(e);break;case"bottom":r.push(t),r.push({x:t.x,y:a<0?t.y+n+Math.abs(a):t.y+n}),r.push({x:e.x,y:a<0?e.y+n:e.y+n+Math.abs(a)}),r.push(e);break;case"left":r.push(t),r.push({x:o>0?t.x-n-Math.abs(o):t.x-n,y:t.y}),r.push({x:o>0?e.x-n:e.x-n-Math.abs(o),y:e.y}),r.push(e);break;case"right":r.push(t),r.push({x:o>0?t.x+n:t.x+n+Math.abs(o),y:t.y}),r.push({x:o>0?e.x+n+Math.abs(o):e.x+n,y:e.y}),r.push(e)}return r}(k[0],k[1],h,f);x=l&&N(u)?{position:"middle",autoRotate:!1}:A({position:"start",autoRotate:!1},function(t,e,i,n){void 0===n&&(n=0);var r=t.y-e.y,a=t.x-e.x;return"bottom"===i?{dx:a>0?-a/2:Math.abs(a/2),dy:r>0?n:Math.abs(r)+n}:"top"===i?{dx:a>0?-Math.abs(a/2):+Math.abs(a/2),dy:r>0?-(Math.abs(r)+n):-n}:"left"===i?{dx:a>0?-a-n:-n,dy:r>0?-r/2:Math.abs(r/2)}:"right"===i?{dx:a>0?n:Math.abs(a)+n,dy:r>0?-r/2:Math.abs(r/2)}:{}}(k[0],k[1],h,f));var w=xt((null!==(e=null===(t=this._markerComponent)||void 0===t?void 0:t.attribute)&&void 0!==e?e:{}).label),T=xt(r.label),C=xt(this._spec.label);null===(i=this._markerComponent)||void 0===i||i.setAttributes({points:l?[[M[0],M[1]],[M[1],M[2]],[M[2],M[3]]]:M,label:T.map((function(t,e){var i,n,r,a,o=0,s=0,l=null!==(i=x.dx)&&void 0!==i?i:0,u=null!==(n=x.dy)&&void 0!==n?n:0,c=null!==(r=C[e])&&void 0!==r?r:C[0];return Q(null==c?void 0:c.refX)&&(o+=c.refX),Q(null==c?void 0:c.refY)&&(s+=c.refY),Q(null==c?void 0:c.dx)&&(l+=c.dx),Q(null==c?void 0:c.dy)&&(u+=c.dy),A(A(A({},t),x),{refX:o,refY:s,dx:l,dy:u,textStyle:A(A({},null===(a=w[e])||void 0===a?void 0:a.textStyle),{textAlign:"center",textBaseline:"middle"})})})),limitRect:S,multiSegment:l,mainSegmentIndex:u,dx:this._layoutOffsetX,dy:this._layoutOffsetY})}else null===(n=this._markerComponent)||void 0===n||n.setAttributes(r)},e.prototype._computeOptions=function(){var t,e=this._getRelativeDataView(),i=!0,n=!1,r=this._spec,a=this._relativeSeries,o=r7(r),s=o.doXProcess,l=o.doYProcess,u=o.doXYY1Process,c=o.doYXX1Process,h=o.doXYProcess,d=o.doCoordinatesProcess;if(h)t=[this._processSpecByDims([{dim:"x",specValue:r.x},{dim:"y",specValue:r.y}]),this._processSpecByDims([{dim:"x",specValue:r.x1},{dim:"y",specValue:r.y1}])];else if(s)t=[this._processSpecByDims([{dim:"x",specValue:r.x}])];else if(l)t=[this._processSpecByDims([{dim:"y",specValue:r.y}])];else if(u)t=[this._processSpecByDims([{dim:"x",specValue:r.x},{dim:"y",specValue:r.y}]),this._processSpecByDims([{dim:"x",specValue:r.x},{dim:"y",specValue:r.y1}])];else if(c)t=[this._processSpecByDims([{dim:"x",specValue:r.x},{dim:"y",specValue:r.y}]),this._processSpecByDims([{dim:"x",specValue:r.x1},{dim:"y",specValue:r.y}])];else if(d){if(t=this._processSpecCoo(r),i=!1,e=new Ms(this._option.dataSet,{name:"".concat(this.type,"_").concat(this.id,"_data")}).parse([a.getViewData()],{type:"dataview"}).transform({type:"markerAggregation",options:t}),r.process&&N(r.process.x)&&(t=[this._processSpecByDims([{dim:"x",specValue:r.process.x}])],i=!0),r.process&&N(r.process.y)&&(t=t=[this._processSpecByDims([{dim:"y",specValue:r.process.y}])],i=!0),r.process&&N(r.process.xy)){var p=a.getSpec();t={fieldX:p.xField,fieldY:p.yField},n=!0}}else i=!1;return{options:t,needAggr:i,needRegr:n,processData:e}},e.type=B.markLine,e.coordinateType="cartesian",e}(p7),v7=function(){kz.registerComponent(f7.type,f7),FD()},g7=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=B.polarMarkLine,e.name=B.polarMarkLine,e.coordinateType="polar",e}return S(e,t),e.prototype._newMarkLineComponent=function(t){var e=r7(this._spec),i=e.doRadiusProcess,n=e.doRadAngAng1Process;return i||n?new ND(t):new zD(t)},e.prototype._computePointsAttr=function(){var t,e=this._spec,i=this._markerData,n=this._startRelativeSeries,r=this._endRelativeSeries,a=this._relativeSeries,o=null!==(t=e.autoRange)&&void 0!==t&&t,s=r7(e),l=s.doAngleProcess,u=s.doRadiusProcess,c=s.doAngRadRad1Process,h=s.doRadAngAng1Process,d=s.doRadAngProcess,p=s.doCoordinatesProcess,f=[],v={},g={x:this._relativeSeries.getRegion().getLayoutStartPoint().x+this._relativeSeries.angleAxisHelper.center().x,y:this._relativeSeries.getRegion().getLayoutStartPoint().y+this._relativeSeries.angleAxisHelper.center().y};if(l||u||c||h||d){var y=Y8(i,n,r,a,o);f=1===y.length?y[0]:y.map((function(t){return t[0]})),v=f[0].radius===f[1].radius?{radius:f[0].radius,startAngle:f[0].angle,endAngle:f[1].angle,center:g}:{points:f.map((function(t){return Pe(g,t.radius,t.angle)}))}}else p&&(v={points:(f=K8(i,a,o)).map((function(t){return Pe(g,t.radius,t.angle)}))});return v},e.prototype._computeOptions=function(){var t,e=this._spec,i=r7(e),n=i.doAngleProcess,r=i.doRadiusProcess,a=i.doAngRadRad1Process,o=i.doRadAngAng1Process,s=i.doRadAngProcess,l=i.doCoordinatesProcess,u=this._getRelativeDataView();return s?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle1},{dim:"radius",specValue:e.radius1}])]:n?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle}])]:r?t=[this._processSpecByDims([{dim:"radius",specValue:e.radius}])]:a?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius1}])]:o?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle1},{dim:"radius",specValue:e.radius}])]:l&&(t=this._processSpecCoo(e)),{options:t,needAggr:!0,needRegr:!1,processData:u}},e.type=B.polarMarkLine,e.coordinateType="polar",e}(p7),y7=function(){kz.registerComponent(g7.type,g7),ND._animate=mD,FD()},m7=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.type=B.title,n.specKey=B.title,n.layoutType="normal",n.layoutZIndex=wU.Title,n.layoutLevel=TU.Title,n._orient="top",n._orient=gF(e.orient)?e.orient:"top",n}return S(e,t),Object.defineProperty(e.prototype,"orient",{get:function(){return this._orient},enumerable:!1,configurable:!0}),e.prototype.initLayout=function(){t.prototype.initLayout.call(this),this._layout&&(this._layout.layoutOrient=this._orient)},e.getSpecInfo=function(t){return kY(t,this.specKey,B.title,(function(t){return!1!==t.visible}))},e.prototype.onRender=function(t){},e.prototype._compareSpec=function(e,i){var n=t.prototype._compareSpec.call(this,e,i);return(null==i?void 0:i.orient)===(null==e?void 0:e.orient)&&(null==i?void 0:i.visible)===e.visible||(n.reMake=!0),n.change=!0,n.reRender=!0,n},e.prototype.changeRegions=function(t){},e.prototype.update=function(t){},e.prototype.resize=function(t){},e.prototype.afterSetLayoutStartPoint=function(e){Q(e.x)&&this._titleComponent&&this._titleComponent.setAttribute("x",e.x),Q(e.y)&&this._titleComponent&&this._titleComponent.setAttribute("y",e.y),t.prototype.afterSetLayoutStartPoint.call(this,e)},e.prototype.getBoundsInRect=function(t){var e;this.setLayoutRect(t);var i=this._getTitleAttrs();this._createOrUpdateTitleComponent(i),e=this._getTitleLayoutRect();var n=this.getLayoutStartPoint(),r=n.x,a=n.y;return{x1:r,y1:a,x2:r+e.width,y2:a+e.height}},e.prototype._getTitleLayoutRect=function(){var t=this._titleComponent.AABBBounds;return{width:this._spec.width?this._spec.width:Q(t.width())?t.width():0,height:this._spec.height?this._spec.height:Q(t.height())?t.height():0}},e.prototype._getTitleAttrs=function(){var t,e,i,n,r,a,o,s;if(!1===this._spec.visible)return{visible:!1};var l=this.getLayoutRect(),u=mF(this._spec.width,l.width,null,l.width),c=mF(this._spec.maxWidth,l.width,null,l.width),h=Math.max(Math.min(u,c,l.width),0),d=A(A({},vt(this._spec,["padding"])),{textType:null!==(t=this._spec.textType)&&void 0!==t?t:"text",text:null!==(e=this._spec.text)&&void 0!==e?e:"",subtextType:null!==(i=this._spec.subtextType)&&void 0!==i?i:"text",subtext:null!==(n=this._spec.subtext)&&void 0!==n?n:"",x:null!==(r=this._spec.x)&&void 0!==r?r:0,y:null!==(a=this._spec.y)&&void 0!==a?a:0,height:this._spec.height,minWidth:this._spec.minWidth,maxWidth:h,minHeight:this._spec.minHeight,maxHeight:this._spec.maxHeight,padding:this._spec.innerPadding,align:null!==(o=this._spec.align)&&void 0!==o?o:"left",verticalAlign:null!==(s=this._spec.verticalAlign)&&void 0!==s?s:"top",textStyle:A({width:h,maxLineWidth:h},this._spec.textStyle),subtextStyle:A({maxLineWidth:h},this._spec.subtextStyle)});return N(this._spec.width)&&(d.textStyle.width=Math.max(u,l.width),d.subtextStyle.width=d.textStyle.width),d},e.prototype._createOrUpdateTitleComponent=function(t){var e=this;if(this._titleComponent)mt(t,this._cacheAttrs)||this._titleComponent.setAttributes(t);else{var i=this.getContainer(),n=new cO(t);n.name="title",i.add(n),this._titleComponent=n,n.on("*",(function(t,i){return e._delegateEvent(n,t,i)}))}return this._cacheAttrs=t,this._titleComponent},e.prototype._getNeedClearVRenderComponents=function(){return[this._titleComponent]},e.prototype.clear=function(){t.prototype.clear.call(this),this._cacheAttrs=null},e.type=B.title,e.specKey=B.title,e}(rK),_7=function(){kz.registerComponent(m7.type,m7)},b7=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.specKey="markArea",e.layoutZIndex=wU.MarkArea,e}return S(e,t),e._getMarkerCoordinateType=function(t){var e=a7(t),i=e.doAngleProcess,n=e.doRadiusProcess,r=e.doRadAngProcess;return"polar"===t.coordinateType||i||n||r?"polar":"cartesian"},e.prototype._createMarkerComponent=function(){var t,e,i,n,r,a,o,s,l=this,u=xt(null!==(t=this._spec.label)&&void 0!==t?t:{}),c={zIndex:this.layoutZIndex,interactive:null===(e=this._spec.interactive)||void 0===e||e,hover:null===(i=this._spec.interactive)||void 0===i||i,select:null===(n=this._spec.interactive)||void 0===n||n,points:[{x:0,y:0}],center:{x:0,y:0},innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,areaStyle:t7(GH(null===(r=this._spec.area)||void 0===r?void 0:r.style),this._markerData,this._markAttributeContext),clipInRange:null!==(a=this._spec.clip)&&void 0!==a&&a,label:u.map((function(t){return Q8(t,l._markerData,l._markAttributeContext)})),state:{area:$8(null===(o=this._spec.area)||void 0===o?void 0:o.state,this._markerData,this._markAttributeContext),label:u.map((function(t){return $8(t.state,l._markerData,l._markAttributeContext)})),labelBackground:u.map((function(t){var e;return $8(null===(e=t.labelBackground)||void 0===e?void 0:e.state,l._markerData,l._markAttributeContext)}))},animation:null!==(s=this._spec.animation)&&void 0!==s&&s,animationEnter:this._spec.animationEnter,animationExit:this._spec.animationExit,animationUpdate:this._spec.animationUpdate};return this._newMarkAreaComponent(c)},e.prototype._markerLayout=function(){var t,e,i=this._spec,n=this._markerData,r=this._startRelativeSeries,a=this._endRelativeSeries,o=this._relativeSeries,s=this._computePointsAttr(),l=this._getRelativeDataView().latestData,u=n?n.latestData[0]&&n.latestData[0].latestData?n.latestData[0].latestData:n.latestData:l;if(i.clip||xt(i.label).some((function(t){return null==t?void 0:t.confine}))){var c=J8([r.getRegion(),a.getRegion(),o.getRegion()]),h=c.minX,d=c.maxX,p=c.minY;e={x:h,y:p,width:d-h,height:c.maxY-p}}if(this._markerComponent){var f=xt(null===(t=this._markerComponent.attribute)||void 0===t?void 0:t.label),v=xt(this._spec.label);this._markerComponent.setAttributes(A(A({},s),{label:f.map((function(t,e){var i=v[e]||{};return A(A({},t),{text:i.formatMethod?i.formatMethod(u,l):null==t?void 0:t.text})})),limitRect:e,dx:this._layoutOffsetX,dy:this._layoutOffsetY}))}},e.prototype._initDataView=function(){var t=a7(this._spec),e=t.doXProcess,i=t.doYProcess,n=t.doXYProcess,r=t.doAngleProcess,a=t.doRadiusProcess,o=t.doRadAngProcess,s=t.doCoordinatesProcess;if(!(e||i||n||r||a||o||s))return null;this._initCommonDataView()},e.specKey="markArea",e}(h7),x7=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=B.markArea,e.name=B.markArea,e.coordinateType="cartesian",e}return S(e,t),e.prototype._newMarkAreaComponent=function(t){return new jD(t)},e.prototype._computePointsAttr=function(){var t,e=this._spec,i=this._markerData,n=this._startRelativeSeries,r=this._endRelativeSeries,a=this._relativeSeries,o=a7(e),s=o.doXProcess,l=o.doYProcess,u=o.doXYProcess,c=o.doCoordinatesProcess,h=N(e.positions),d=null!==(t=e.autoRange)&&void 0!==t&&t,p=[];if(u){var f=E(U8(i,n,r,a,d),2),v=f[0],g=f[1];v&&v.length&&g&&g.length&&(p=[{x:v[0].x,y:g[0].y},v[0],{x:g[0].x,y:v[0].y},g[0]])}else if(s||l){var y=E(U8(i,n,r,a,d),2);v=y[0],g=y[1];v&&v.length&&g&&g.length&&(p=P(P([],E(v),!1),[g[1],g[0]],!1))}else c?p=X8(i,a,d,e.coordinatesOffset):h&&(p=Z8(e.positions,a,e.regionRelative));return{points:p}},e.prototype._computeOptions=function(){var t,e=this._spec,i=a7(e),n=i.doXProcess,r=i.doYProcess,a=i.doXYProcess,o=i.doCoordinatesProcess;return a?t=[this._processSpecByDims([{dim:"x",specValue:e.x},{dim:"y",specValue:e.y}]),this._processSpecByDims([{dim:"x",specValue:e.x1},{dim:"y",specValue:e.y1}])]:n?t=[this._processSpecByDims([{dim:"x",specValue:e.x}]),this._processSpecByDims([{dim:"x",specValue:e.x1}])]:r?t=[this._processSpecByDims([{dim:"y",specValue:e.y}]),this._processSpecByDims([{dim:"y",specValue:e.y1}])]:o&&(t=this._processSpecCoo(e)),{options:t}},e.type=B.markArea,e.coordinateType="cartesian",e}(b7),k7=function(){kz.registerComponent(x7.type,x7),HD()},S7=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=B.polarMarkArea,e.name=B.polarMarkArea,e.coordinateType="polar",e}return S(e,t),e.prototype._newMarkAreaComponent=function(t){var e=a7(this._spec),i=e.doRadiusProcess,n=e.doAngleProcess,r=e.doRadAngProcess;return n||i||r?new VD(t):new jD(t)},e.prototype._computePointsAttr=function(){var t,e=this._spec,i=this._markerData,n=this._startRelativeSeries,r=this._endRelativeSeries,a=this._relativeSeries,o=a7(e),s=o.doAngleProcess,l=o.doRadiusProcess,u=o.doRadAngProcess,c=o.doCoordinatesProcess,h=null!==(t=e.autoRange)&&void 0!==t&&t,d={},p={x:this._relativeSeries.getRegion().getLayoutStartPoint().x+this._relativeSeries.angleAxisHelper.center().x,y:this._relativeSeries.getRegion().getLayoutStartPoint().y+this._relativeSeries.angleAxisHelper.center().y};if(s||l||u){var f=Y8(i,n,r,a,h);u?d={innerRadius:f[0][0].radius,outerRadius:f[1][0].radius,startAngle:f[0][0].angle,endAngle:f[1][0].angle,center:p}:s?d={innerRadius:0,outerRadius:Math.abs(f[0][0].radius),startAngle:f[0][1].angle,endAngle:f[1][1].angle,center:p}:l&&(d={innerRadius:f[0][0].radius,outerRadius:f[1][0].radius,startAngle:f[0][0].angle,endAngle:f[1][1].angle,center:p})}else c&&(d={points:K8(i,a,h).map((function(t){return Pe(p,t.radius,t.angle)}))});return d},e.prototype._computeOptions=function(){var t,e=this._spec,i=a7(e),n=i.doAngleProcess,r=i.doRadiusProcess,a=i.doRadAngProcess,o=i.doCoordinatesProcess;return a?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle1},{dim:"radius",specValue:e.radius1}])]:n?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle1},{dim:"radius",specValue:e.radius}])]:r?t=[this._processSpecByDims([{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"radius",specValue:e.radius1}])]:o&&(t=this._processSpecCoo(e)),{options:t}},e.type=B.polarMarkArea,e.coordinateType="polar",e}(b7),A7=function(){kz.registerComponent(S7.type,S7),VD._animate=bD,HD()},M7=function(t){return GH(A({},t))},w7=function(t){return A(A({},t),{style:A({},GH(t.style))})},T7=function(t){var e,i,n,r,a,o,s,l,u,c,h,d,p,f,v,g,y=M7(null!==(i=null===(e=null==t?void 0:t.slider)||void 0===e?void 0:e.trackStyle)&&void 0!==i?i:{}),m=M7(null!==(r=null===(n=null==t?void 0:t.slider)||void 0===n?void 0:n.railStyle)&&void 0!==r?r:{}),_=(g=null!==(o=null===(a=null==t?void 0:t.slider)||void 0===a?void 0:a.handlerStyle)&&void 0!==o?o:{},GH(A({},g))),b=w7(null!==(l=null===(s=null==t?void 0:t.controller)||void 0===s?void 0:s.start)&&void 0!==l?l:{}),x=w7(null!==(c=null===(u=null==t?void 0:t.controller)||void 0===u?void 0:u.pause)&&void 0!==c?c:{}),k=w7(null!==(d=null===(h=null==t?void 0:t.controller)||void 0===h?void 0:h.backward)&&void 0!==d?d:{}),S=w7(null!==(f=null===(p=null==t?void 0:t.controller)||void 0===p?void 0:p.forward)&&void 0!==f?f:{}),M=A(A({},t),{direction:t.direction,interval:t.interval,visible:t.visible,orient:null!==(v=t.orient)&&void 0!==v?v:"bottom",slider:A(A({},t.slider),{trackStyle:y,railStyle:m,handlerStyle:_}),controller:A(A({},t.controller),{start:b,pause:x,backward:k,forward:S})});return t.visible||(M.controller.visible=!1,M.slider.visible=!1),M},C7=function(t){return"left"===t||"right"===t},E7=function(t){return"top"===t||"bottom"===t},P7=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.layoutZIndex=wU.Player,e.layoutLevel=TU.Player,e.specKey="player",e.type=B.player,e._orient="bottom",e._getPlayerAttrs=function(){var t,i,n,r,a,o,s,l,u=e._spec.type,c={size:{width:e._width,height:e._height},dx:null!==(t=e._spec.dx)&&void 0!==t?t:0+e._dx,dy:null!==(i=e._spec.dy)&&void 0!==i?i:0+e._dy};return"discrete"===u?A(A(A({},(s=e._spec,l=e._specs,A(A({},T7(s)),{data:l,type:"discrete"}))),c),{disableTriggerEvent:e._option.disableTriggerEvent,loop:null===(r=null===(n=e._spec)||void 0===n?void 0:n.loop)||void 0===r||r}):A(A(A({},function(t,e){return A(A({},T7(t)),{data:e,type:"continuous"})}(e._spec,e._specs)),c),{disableTriggerEvent:e._option.disableTriggerEvent,loop:null===(o=null===(a=e._spec)||void 0===a?void 0:a.loop)||void 0===o||o})},e._createOrUpdatePlayerComponent=function(){var t=A({},e._getPlayerAttrs()),i=e.getContainer();e._playerComponent?mt(t,e._cacheAttrs)||(e._cacheAttrs=t,e._playerComponent.setAttributes(t),e._playerComponent._initAttributes(),e._playerComponent.render()):("discrete"===t.type?e._playerComponent=new wO(t):e._playerComponent=new EO(t),e._cacheAttrs=t,e._playerComponent.name="player",i.add(e._playerComponent),e._initEvent())},e._maxSize=function(){var t,i,n,r,a,o,s,l,u;return Math.max.apply(Math,P(P(P(P(P([],E(xt(null===(i=null===(t=e._spec.controller.start)||void 0===t?void 0:t.style)||void 0===i?void 0:i.size)),!1),E(xt(null===(r=null===(n=e._spec.controller.pause)||void 0===n?void 0:n.style)||void 0===r?void 0:r.size)),!1),E(xt(null===(o=null===(a=e._spec.controller.backward)||void 0===a?void 0:a.style)||void 0===o?void 0:o.size)),!1),E(xt(null===(l=null===(s=e._spec.controller.forward)||void 0===s?void 0:s.style)||void 0===l?void 0:l.size)),!1),[null!==(u=C7(e._orient)?e._spec.slider.railStyle.width:e._spec.slider.railStyle.height)&&void 0!==u?u:10],!1))},e._sliderExceededSize=function(){var t,i,n,r,a,o,s,l,u,c=null!==(t=C7(e._orient)?e._spec.slider.railStyle.width:e._spec.slider.railStyle.height)&&void 0!==t?t:10,h=Math.max.apply(Math,P(P(P(P([],E(xt(null===(n=null===(i=e._spec.controller.start)||void 0===i?void 0:i.style)||void 0===n?void 0:n.size)),!1),E(xt(null===(a=null===(r=e._spec.controller.pause)||void 0===r?void 0:r.style)||void 0===a?void 0:a.size)),!1),E(xt(null===(s=null===(o=e._spec.controller.backward)||void 0===o?void 0:o.style)||void 0===s?void 0:s.size)),!1),E(xt(null===(u=null===(l=e._spec.controller.forward)||void 0===l?void 0:l.style)||void 0===u?void 0:u.size)),!1));return c>=h?c-h:0},e._initEvent=function(){e._option.disableTriggerEvent||(e._option.globalInstance.on(cG.rendered,(function(){var t;(null===(t=e._spec)||void 0===t?void 0:t.auto)&&e._playerComponent.play()})),e._playerComponent.addEventListener(mO.end,(function(){var t;e.event.emit(cG.playerEnd,{model:e}),e._alternate&&"discrete"===e._spec.type&&(e._direction="default"===e._direction?"reverse":"default",e._playerComponent.setAttributes({direction:e._direction,dataIndex:"reverse"===e._direction?e._specs.length-2:1})),(null===(t=e._spec)||void 0===t?void 0:t.loop)&&e._playerComponent.play()})),e._playerComponent.addEventListener(mO.change,(function(t){var i=t.detail.index;e.changePlayerIndex(i)})),e._playerComponent.addEventListener(mO.backward,(function(t){var i=t.detail.index,n=e._specs[i];e.event.emit(cG.playerBackward,{model:e,value:{spec:n,index:i,specs:e._specs}})})),e._playerComponent.addEventListener(mO.forward,(function(t){var i=t.detail.index,n=e._specs[i];e.event.emit(cG.playerForward,{model:e,value:{spec:n,index:i,specs:e._specs}})})),e._playerComponent.addEventListener(mO.play,(function(t){var i=t.detail.index,n=e._specs[i];e.event.emit(cG.playerPlay,{model:e,value:{spec:n,index:i,specs:e._specs}})})),e._playerComponent.addEventListener(mO.pause,(function(t){var i=t.detail.index,n=e._specs[i];e.event.emit(cG.playerPause,{model:e,value:{spec:n,index:i,specs:e._specs}})})))},e}return S(e,t),Object.defineProperty(e.prototype,"orient",{get:function(){return this._orient},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"layoutOrient",{set:function(t){this._orient=t},enumerable:!1,configurable:!0}),e.prototype.setAttrFromSpec=function(){var e,i,n,r,a,o,s,l;t.prototype.setAttrFromSpec.call(this),this._orient=null!==(e=this._spec.orient)&&void 0!==e?e:"bottom",this._specs=null!==(i=this._spec.specs)&&void 0!==i?i:[],this._direction=null!==(n=this._spec.direction)&&void 0!==n?n:"default",this._alternate=null!==(r=this._spec.alternate)&&void 0!==r&&r,this._dx=null!==(a=this._spec.dx)&&void 0!==a?a:0,this._dy=null!==(o=this._spec.dy)&&void 0!==o?o:0,this._position=null!==(s=this._spec.position)&&void 0!==s?s:"middle",this._visible=null===(l=this._spec.visible)||void 0===l||l},e.prototype.afterSetLayoutStartPoint=function(e){if(t.prototype.afterSetLayoutStartPoint.call(this,e),Q(e.x)){var i=C7(this._orient)?e.x+this._sliderExceededSize()/2:e.x;this._playerComponent&&this._playerComponent.setAttribute("x",i)}if(Q(e.y)){var n=E7(this._orient)?e.y+this._sliderExceededSize()/2:e.y;this._playerComponent&&this._playerComponent.setAttribute("y",n)}},e.prototype.getBoundsInRect=function(t,e){this._width=this._computeWidth(t),this._height=this._computeHeight(t),this._dx=this._computeDx(e),this._dy=this._computeDy(e);var i=this._computeLayoutRect(t,this._width,this._height);return this._createOrUpdatePlayerComponent(),i},e.prototype.changeRegions=function(t){},e.prototype.onRender=function(t){},e.prototype._getNeedClearVRenderComponents=function(){return[this._playerComponent]},e.prototype._computeLayoutRect=function(t,e,i){if(!1===this._visible)return{x1:0,x2:0,y1:0,y2:0};switch(this._orient){case"top":case"left":return{x1:0,y1:0,x2:e,y2:i};case"right":return{x1:t.width-e,y1:0,x2:t.width,y2:t.height};default:return{x1:0,y1:t.height-i,x2:t.width,y2:t.height}}},e.prototype._computeWidth=function(t){return Z(this._spec.width)?Math.min(t.width,Number(this._spec.width)):C7(this._orient)?this._maxSize():t.width},e.prototype._computeHeight=function(t){return Z(this._spec.height)?(this._height=this._spec.height,Math.min(t.height,Number(this._spec.height))):E7(this._orient)?this._maxSize():t.height},e.prototype._computeDx=function(t){return C7(this._orient)||"start"===this._position?0:"middle"===this._position?(t.width-this._width)/2:t.width-this._width},e.prototype._computeDy=function(t){return E7(this._orient)||"start"===this._position?0:"middle"===this._position?(t.height-this._height)/2:t.height-this._height},e.prototype.changePlayerIndex=function(t){var e=this,i=this._specs[t];xt(i.data).forEach((function(t){var i,n;null===(n=null===(i=e._option)||void 0===i?void 0:i.globalInstance)||void 0===n||n.updateData(t.id,t.values)})),this.event.emit(cG.playerChange,{model:this,value:{spec:i,index:t,specs:this._specs}})},e.specKey="player",e.type=B.player,e}(rK),R7=function(){kz.registerComponent(P7.type,P7)},B7=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.type=B.label,n.name=B.label,n.layoutType="none",n.layoutZIndex=wU.Label,n._regions=i.getRegionsInIndex(i.regionIndexes),n}return S(e,t),e.prototype._interactiveConfig=function(t){var e=t.interactive,i={hover:!1,select:!1,state:t.state};if(!0!==e)return i;var n=this._option.getChart().getSpec(),r=n.hover,a=n.select;return!1===r&&!1===r.enable||(i.hover=!0),!1===a&&!1===a.enable||(i.select=!0),i},e.prototype._compareSpec=function(e,i){var n=t.prototype._compareSpec.call(this,e,i);return n.reRender=!0,mt(i,e)||(n.reMake=!0),n},e.prototype.onRender=function(t){},e.prototype.changeRegions=function(t){},e.prototype._getNeedClearVRenderComponents=function(){return[]},e.type=B.label,e}(rK),I7=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.skipEncode=!1,e}return S(e,t),e.prototype.getRule=function(){return this._rule},e.prototype.setRule=function(t){this._rule=t},e.prototype.getTarget=function(){return this._target},e.prototype.setTarget=function(t){this._target=t,this._rule||this.setRule(t.type)},e.prototype.getComponent=function(){return this._component},e.prototype.setComponent=function(t){this._component=t},e.type="text",e.constructorType="label",e}(hJ),L7=function(){kz.registerMark(I7.constructorType,I7),eV()},D7=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._initTheme=function(t,e){return{spec:t,theme:this._theme}},e}(nK),O7=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.type=B.label,n.name=B.label,n.specKey="label",n.transformerConstructor=D7,n.layoutZIndex=wU.Label,n._layoutRule=e.labelLayout||"series",n}return S(e,t),e.getSpecInfo=function(t,e){var i=this,n=[],r=(null==e?void 0:e.region)||[];return r.forEach((function(r,a){var o=(r.seriesIndexes||[]).some((function(t){var i=e.series[t].markLabelSpec,n=void 0===i?{}:i;return Object.values(n).some((function(t){return Array.isArray(t)&&function(t){return t.some((function(t){return t.visible}))}(t)}))}));o&&n.push({spec:t,type:B.label,specInfoPath:["component",i.specKey,a],regionIndexes:[a]})})),n},e.prototype.init=function(e){t.prototype.init.call(this,e),this.initEvent(),this._initTextMark(),this._initLabelComponent(),this._initTextMarkStyle()},e.prototype.reInit=function(e){t.prototype.reInit.call(this,e),this._labelInfoMap&&this._labelInfoMap.clear(),this._initTextMark(),this._initTextMarkStyle()},e.prototype.initEvent=function(){var t=this;this.event.on(cG.dataZoomChange,(function(){t._labelComponentMap.forEach((function(t,e){var i=e.getProduct().getGroupGraphicItem();i&&i.disableAnimation()})),t.event.on(DH.AFTER_MARK_RENDER_END,e)}));var e=function(){t._labelComponentMap.forEach((function(t,e){var i=e.getProduct().getGroupGraphicItem();i&&i.enableAnimation()})),t.event.off(DH.AFTER_MARK_RENDER_END,e)}},e.prototype._initTextMark=function(){var t=this;this._labelInfoMap||(this._labelInfoMap=new Map),this._labelComponentMap||(this._labelComponentMap=new Map),XO(this._regions,(function(e){var i=e.getSpecInfo().markLabelSpec,n=void 0===i?{}:i,r=Object.keys(n),a=e.getRegion();t._labelInfoMap.get(a)||t._labelInfoMap.set(a,[]);for(var o=function(i){var o=r[i],s=e.getMarkInName(o);if(!s)return"continue";n[o].forEach((function(i,n){var r,l;if(i.visible){var u=t._labelInfoMap.get(a),c=t._createMark({type:"label",name:"".concat(o,"-label-").concat(n)},{noSeparateStyle:!0,attributeContext:e.getMarkAttributeContext()});i.showRelatedMarkTooltip&&(null===(l=null===(r=e.tooltipHelper)||void 0===r?void 0:r.activeTriggerSet.mark)||void 0===l||l.add(c)),c.setTarget(s),u.push({labelMark:c,baseMark:s,series:e,labelSpec:i})}}))},s=0;s<r.length;s++)o(s)}))},e.prototype._initLabelComponent=function(){var t=this;this._labelInfoMap.forEach((function(e,i){if("region"===t._layoutRule){var n=t._createMark({type:"component",name:"".concat(i.getGroupMark().name,"-label-component")},{componentType:"label",noSeparateStyle:!0},{support3d:t._spec.support3d});n&&(n.setSkipBeforeLayouted(!0),e[0]&&N(e[0].labelSpec.zIndex)&&n.setMarkConfig({zIndex:e[0].labelSpec.zIndex}),t._marks.addMark(n),t._labelComponentMap.set(n,(function(){return t._labelInfoMap.get(i)})))}else e.forEach((function(e,n){var r=t._createMark({type:"component",name:"".concat(e.labelMark.name,"-component")},{componentType:"label",noSeparateStyle:!0},{support3d:e.baseMark.getMarkConfig().support3d});r&&(N(e.labelSpec.zIndex)&&r.setMarkConfig({zIndex:e.labelSpec.zIndex}),r.setSkipBeforeLayouted(!0),t._marks.addMark(r),t._labelComponentMap.set(r,(function(){return t._labelInfoMap.get(i)[n]})))}))}))},e.prototype._initTextMarkStyle=function(){var t=this;this._labelComponentMap.forEach((function(t,e){xt(t()).forEach((function(t){t.labelMark.setComponent(e)}))})),this._labelInfoMap.forEach((function(e){e.forEach((function(e){var i,n,r=e.labelMark,a=e.labelSpec,o=e.series;if(t.initMarkStyleWithSpec(r,a,void 0),H(null==a?void 0:a.getStyleHandler)){var s=a.getStyleHandler(o);null==s||s.call(o,r,a)}(null===(n=null===(i=r.stateStyle)||void 0===i?void 0:i.normal)||void 0===n?void 0:n.lineWidth)&&r.setAttribute("stroke",o.getColorAttribute(),"normal",CU.Base_Series)}))}))},e.prototype.updateLayoutAttribute=function(){var e=this;t.prototype.updateLayoutAttribute.call(this),this._labelComponentMap.forEach((function(t,i){var n=t();X(n)?e._updateMultiLabelAttribute(n,i):e._updateSingleLabelAttribute(n,i)}))},e.prototype._updateMultiLabelAttribute=function(t,e){this._updateLabelComponentAttribute(e.getProduct(),t.map((function(t){return t.baseMark.getProduct()})),t)},e.prototype._updateSingleLabelAttribute=function(t,e){var i=t.baseMark;this._updateLabelComponentAttribute(e.getProduct(),i.getProduct(),[t])},e.prototype._updateLabelComponentAttribute=function(t,e,i){var n=this,r=this._option.getComponentsByType("totalLabel");t.target(e).configure({interactive:!1}).depend(r.map((function(t){return t.getMarks()[0].getProduct()}))).labelStyle((function(t,e){var a,o,s=i[e.labelIndex];if(s){var l=s.labelSpec,u=s.labelMark,c=s.series,h=u.getRule(),d=n._interactiveConfig(l),p=null!==(o=null===(a=n._spec)||void 0===a?void 0:a.centerOffset)&&void 0!==o?o:0,f=xz({textStyle:A({pickable:!0===l.interactive},l.style),overlap:{avoidMarks:r.map((function(t){return t.getMarks()[0].getProductId()}))}},WZ(h,s),A(A(A({},vt(l,["position","style","state","type","stackDataFilterType","getStyleHandler"])),d),{centerOffset:p}),l.stackDataFilterType?{dataFilter:"min"===l.stackDataFilterType?function(t){return t.filter((function(t){return t.data[aH]}))}:function(t){return t.filter((function(t){return t.data[rH]}))}}:{});return c&&c.parseLabelStyle&&(f=c.parseLabelStyle(f,l,u)),"line"!==h&&"area"!==h||(f.type=h),f}})).encode((function(t,e,n){if(i[n.labelIndex]){var r=i[n.labelIndex],a=r.labelSpec;return r.labelMark.skipEncode?{data:t}:GZ(i[n.labelIndex],t,a.formatMethod,a.formatter)}})).size((function(){var t;return A({padding:null===(t=i[0].labelSpec.overlap)||void 0===t?void 0:t.padding},i[0].series.getRegion().getLayoutRect())}))},e.prototype.compileMarks=function(){var t=this;this.getMarks().forEach((function(e){var i,n=t._labelComponentMap.get(e)();i=X(n)?n[0].series.getRegion().getGroupMark().getProduct():n.series.getRegion().getGroupMark().getProduct(),e.compile({group:i,context:{model:t,labelInfo:n}})}))},e.prototype.getVRenderComponents=function(){var t=[];return this._labelComponentMap.forEach((function(e,i){var n=i.getProduct().getGroupGraphicItem();n&&t.push(n)})),t},e.prototype.getLabelInfoByTextGraphic=function(t){var e,i=null==t?void 0:t.parent,n=null==i?void 0:i.parent;if(n){var r=n.getChildren().indexOf(i);this._labelComponentMap.forEach((function(t,i){i.getProduct().getGroupGraphicItem()===n&&(e=xt(t())[r])}))}return e},e.type=B.label,e.specKey="label",e.transformerConstructor=D7,e}(B7),F7=function(){EV(),L7(),oK(),kz.registerComponent(O7.type,O7,!0)},z7=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=B.totalLabel,e.name=B.totalLabel,e.specKey="totalLabel",e.layoutZIndex=wU.Label,e}return S(e,t),e.getSpecInfo=function(t,e){var i,n=this,r=[];return null===(i=null==e?void 0:e.region)||void 0===i||i.forEach((function(t,i){var a;null===(a=t.seriesIndexes)||void 0===a||a.forEach((function(t){var a=e.series[t].spec[n.specKey];(null==a?void 0:a.visible)&&r.push({spec:a,type:B.totalLabel,specPath:["series",t,n.specKey],specInfoPath:["component",n.specKey,t],regionIndexes:[i],seriesIndexes:[t]})}))})),r},e.prototype.init=function(e){t.prototype.init.call(this,e),this._initTextMark(),this._initLabelComponent()},e.prototype.reInit=function(e){t.prototype.reInit.call(this,e),this._initTextMark()},e.prototype._initTextMark=function(){var t,e=this._getSeries();if(null===(t=e.getSpec().totalLabel)||void 0===t?void 0:t.visible){var i=e.getSeriesMark();if(i){var n=this._createMark({type:"label",name:"".concat(i.name,"-total-label")});this._baseMark=i,this._textMark=n,this._initTextMarkStyle()}}},e.prototype._initTextMarkStyle=function(){var e;t.prototype.initMarkStyleWithSpec.call(this,this._textMark,this._spec),this.setMarkStyle(this._textMark,{text:function(t){return t[iH]}},"normal",CU.Default);var i=this._getSeries();null===(e=i.initTotalLabelMarkStyle)||void 0===e||e.call(i,this._textMark)},e.prototype._initLabelComponent=function(){var t=this._getSeries(),e=this._createMark({type:"component",name:"".concat(t.name,"-total-label-component")},{componentType:"label",noSeparateStyle:!0},{support3d:this._spec.support3d});e&&this._marks.addMark(e)},e.prototype.updateLayoutAttribute=function(){var e=this;t.prototype.updateLayoutAttribute.call(this);var i=this._getSeries();this._marks.forEach((function(t,n){t.getProduct().target(e._baseMark.getProduct()).configure({interactive:!1}).labelStyle((function(){var t,n;if(e._baseMark){var r=e._spec,a=r.offset,o=r.animation,s=r.overlap,l=r.position,u=void 0===l?"top":l,c=e._interactiveConfig(e._spec);return xz({textStyle:{pickable:!0===e._spec.interactive},position:H7(i,e._baseMark.type,u),x:0,y:0},null!==(n=null===(t=i.getTotalLabelComponentStyle)||void 0===t?void 0:t.call(i,{baseMark:e._baseMark,labelMark:e._textMark}))&&void 0!==n?n:{},A({offset:a,animation:o,overlap:s,dataFilter:function(t){return t.filter((function(t){return"bottom"===u?t.data[aH]:t.data[rH]}))}},c))}})).encode((function(t){return GZ({baseMark:e._baseMark,labelMark:e._textMark,series:i,labelSpec:i.getSpec().totalLabel},t,e._spec.formatMethod)})).size((function(){var t;return A({padding:null===(t=e._spec.overlap)||void 0===t?void 0:t.padding},e._regions[0].getLayoutRect())}))}))},e.prototype.compileMarks=function(){var t=this;this.getMarks().forEach((function(e){var i=t._regions[0].getGroupMark().getProduct();e.compile({group:i,context:{model:t}})}))},e.prototype.getVRenderComponents=function(){var t=[];return this.getMarks().forEach((function(e){var i=e.getProduct().getGroupGraphicItem();i&&t.push(i)})),t},e.prototype._getSeries=function(){return this._option.getSeriesInIndex([this.getSpecPath()[1]])[0]},e.type=B.totalLabel,e.specKey="totalLabel",e}(B7);function H7(t,e,i){var n,r,a;void 0===i&&(i="top");var o,s=t.direction;o="bottom"===i?{vertical:["bottom","top"],horizontal:["left","right"]}:{vertical:["top","bottom"],horizontal:["right","left"]};var l=("horizontal"===s?null===(n=t.getXAxisHelper())||void 0===n?void 0:n.isInverse():null===(r=t.getYAxisHelper())||void 0===r?void 0:r.isInverse())?1:0;switch(e){case"rect":case"symbol":a=o[s][l];break;default:a="top"}return a}var j7=function(){EV(),L7(),oK(),kz.registerComponent(z7.type,z7,!0)},N7=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.specKey="markPoint",e.layoutZIndex=wU.MarkPoint,e}return S(e,t),e._getMarkerCoordinateType=function(t){var e=o7(t),i=e.doPolarProcess,n=e.doGeoProcess;return"polar"===t.coordinateType||i?"polar":"geo"===t.coordinateType||n?"geo":"cartesian"},e.prototype._createMarkerComponent=function(){var t,e,i,n,r,a,o,s,l,u,c,h,d,p,f,v,g,y,m,_,b,x,k,S,w,T,C,E,P=this._spec,R=P.itemContent,B=void 0===R?{}:R,I=P.itemLine,L=void 0===I?{}:I,D=P.targetSymbol,O=void 0===D?{}:D,F=B.text,z=void 0===F?{}:F,H=B.symbol,j=B.image,N=B.richText,V=M(B,["text","symbol","image","richText"]),W={zIndex:this.layoutZIndex,interactive:null===(t=this._spec.interactive)||void 0===t||t,hover:null===(e=this._spec.interactive)||void 0===e||e,select:null===(i=this._spec.interactive)||void 0===i||i,position:{x:0,y:0},clipInRange:null!==(n=this._spec.clip)&&void 0!==n&&n,itemContent:A({offsetX:e7(B.offsetX,this._relativeSeries.getRegion()),offsetY:e7(B.offsetX,this._relativeSeries.getRegion())},V),targetSymbol:{offset:null!==(r=O.offset)&&void 0!==r?r:0,visible:null!==(a=O.visible)&&void 0!==a&&a,size:null!==(o=O.size)&&void 0!==o?o:20,style:t7(O.style,this._markerData,this._markAttributeContext)},state:{line:$8(null!==(l=null===(s=this._spec.itemLine.line)||void 0===s?void 0:s.state)&&void 0!==l?l:{},this._markerData,this._markAttributeContext),lineStartSymbol:$8(null!==(c=null===(u=this._spec.itemLine.startSymbol)||void 0===u?void 0:u.state)&&void 0!==c?c:{},this._markerData,this._markAttributeContext),lineEndSymbol:$8(null!==(d=null===(h=this._spec.itemLine.endSymbol)||void 0===h?void 0:h.state)&&void 0!==d?d:{},this._markerData,this._markAttributeContext),symbol:$8(null!==(f=null===(p=this._spec.itemContent.symbol)||void 0===p?void 0:p.state)&&void 0!==f?f:{},this._markerData,this._markAttributeContext),image:$8(null!==(g=null===(v=this._spec.itemContent.image)||void 0===v?void 0:v.state)&&void 0!==g?g:{},this._markerData,this._markAttributeContext),text:$8(null!==(m=null===(y=this._spec.itemContent.text)||void 0===y?void 0:y.state)&&void 0!==m?m:{},this._markerData,this._markAttributeContext),textBackground:$8(null===(b=null===(_=this._spec.itemContent.text)||void 0===_?void 0:_.labelBackground)||void 0===b?void 0:b.state,this._markerData,this._markAttributeContext),richText:$8(null!==(k=null===(x=this._spec.itemContent.richText)||void 0===x?void 0:x.state)&&void 0!==k?k:{},this._markerData,this._markAttributeContext),customMark:$8(null!==(w=null===(S=this._spec.itemContent.customMark)||void 0===S?void 0:S.state)&&void 0!==w?w:{},this._markerData,this._markAttributeContext),targetItem:$8(null!==(C=null===(T=this._spec.targetSymbol)||void 0===T?void 0:T.state)&&void 0!==C?C:{},this._markerData,this._markAttributeContext)},animation:null!==(E=this._spec.animation)&&void 0!==E&&E,animationEnter:this._spec.animationEnter,animationExit:this._spec.animationExit,animationUpdate:this._spec.animationUpdate};(null==H?void 0:H.style)&&(W.itemContent.symbolStyle=GH(t7(H.style,this._markerData,this._markAttributeContext))),(null==j?void 0:j.style)&&(W.itemContent.imageStyle=t7(j.style,this._markerData,this._markAttributeContext)),z&&(W.itemContent.textStyle=Q8(z,this._markerData,this._markAttributeContext)),(null==N?void 0:N.style)&&(W.itemContent.richTextStyle=t7(N.style,this._markerData,this._markAttributeContext));var G=L.visible,U=L.line,Y=void 0===U?{}:U,X=M(L,["visible","line"]);return W.itemLine=!1!==G?A(A({},X),{visible:!0,lineStyle:GH(Y.style)}):{visible:!1},new GD(W)},e.prototype._markerLayout=function(){var t,e,i,n,r,a,o=this._spec,s=this._markerData,l=this._relativeSeries,u=this._computePointsAttr().point,c=this._getRelativeDataView().latestData,h=s?s.latestData[0]&&s.latestData[0].latestData?s.latestData[0].latestData:s.latestData:c;if(o.clip||(null===(t=o.itemContent)||void 0===t?void 0:t.confine)){var d=J8([l.getRegion()]),p=d.minX,f=d.maxX,v=d.minY;a={x:p,y:v,width:f-p,height:d.maxY-v}}if(this._markerComponent){var g=null!==(e=this._markerComponent.attribute)&&void 0!==e?e:{},y=null!==(n=null===(i=g.itemContent)||void 0===i?void 0:i.textStyle)&&void 0!==n?n:{};this._markerComponent.setAttributes({position:void 0===u?{x:null,y:null}:u,itemContent:A(A({},g.itemContent),{textStyle:A(A({},y),{text:(null===(r=this._spec.itemContent.text)||void 0===r?void 0:r.formatMethod)?this._spec.itemContent.text.formatMethod(h,c):y.text}),offsetX:i7(u,g.itemContent.offsetX,this._relativeSeries.getRegion()),offsetY:i7(u,g.itemContent.offsetY,this._relativeSeries.getRegion())}),limitRect:a,dx:this._layoutOffsetX,dy:this._layoutOffsetY})}},e.prototype._initDataView=function(){var t=this._spec,e=o7(t),i=e.doXYProcess,n=e.doPolarProcess,r=e.doGeoProcess;(N(t.coordinate)||i||n||r)&&this._initCommonDataView()},e.specKey="markPoint",e}(h7),V7=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=B.markPoint,e.name=B.markPoint,e.coordinateType="cartesian",e}return S(e,t),e.prototype._computePointsAttr=function(){var t,e,i=this._spec,n=this._markerData,r=this._relativeSeries,a=N(i.x)&&N(i.y),o=N(i.coordinate),s=N(i.position),l=null!==(t=null==i?void 0:i.autoRange)&&void 0!==t&&t;return a?e=U8(n,r,r,r,l)[0][0]:o?e=X8(n,r,l,i.coordinatesOffset)[0]:s&&(e=Z8(i.position,r,i.regionRelative)[0]),{point:e}},e.prototype._computeOptions=function(){var t,e=this._spec,i=o7(e).doXYProcess,n=N(e.coordinate);return i?t=[this._processSpecByDims([{dim:"x",specValue:e.x},{dim:"y",specValue:e.y}])]:n&&(t=this._processSpecCoo(e)),{options:t}},e.type=B.markPoint,e.coordinateType="cartesian",e}(N7),W7=function(){kz.registerComponent(V7.type,V7),WD()},G7=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=B.polarMarkPoint,e.name=B.polarMarkPoint,e.coordinateType="polar",e}return S(e,t),e.prototype._computePointsAttr=function(){var t,e,i=this._markerData,n=this._relativeSeries,r=Y8(i,n,n,n,null!==(e=null===(t=this._spec)||void 0===t?void 0:t.autoRange)&&void 0!==e&&e)[0][0];return{point:Pe({x:this._relativeSeries.getRegion().getLayoutStartPoint().x+this._relativeSeries.angleAxisHelper.center().x,y:this._relativeSeries.getRegion().getLayoutStartPoint().y+this._relativeSeries.angleAxisHelper.center().y},r.radius,r.angle)}},e.prototype._computeOptions=function(){var t=this._spec;return{options:[this._processSpecByDims([{dim:"radius",specValue:t.radius},{dim:"angle",specValue:t.angle}])]}},e.type=B.polarMarkPoint,e.coordinateType="polar",e}(N7),U7=function(){kz.registerComponent(G7.type,G7),WD()},Y7=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=B.geoMarkPoint,e.name=B.geoMarkPoint,e.coordinateType="geo",e}return S(e,t),e.prototype._computePointsAttr=function(){var t=function(t,e){var i=[];return(t.latestData[0]&&t.latestData[0].latestData?t.latestData[0].latestData:t.latestData).forEach((function(t){N(t.areaName)&&i.push([{x:e.nameValueToPosition(t.areaName).x+e.getRegion().getLayoutStartPoint().x,y:e.nameValueToPosition(t.areaName).y+e.getRegion().getLayoutStartPoint().y}])})),i}(this._markerData,this._relativeSeries)[0][0];return{point:t}},e.prototype._computeOptions=function(){var t=this._spec;return{options:[this._processSpecByDims([{dim:"areaName",specValue:t.areaName}])]}},e.type=B.geoMarkPoint,e.coordinateType="geo",e}(N7),X7=function(){kz.registerComponent(Y7.type,Y7),WD()},K7="inBrush",q7="outOfBrush",Z7=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.layoutType="none",e.type=B.brush,e.name=B.brush,e.specKey="brush",e.layoutZIndex=wU.Brush,e._linkedSeries=[],e._itemMap={},e._linkedItemMap={},e._inBrushElementsMap={},e._outOfBrushElementsMap={},e._linkedInBrushElementsMap={},e._linkedOutOfBrushElementsMap={},e._cacheInteractiveRangeAttrs=[],e._needDisablePickable=!1,e._releatedAxes=[],e._regionAxisMap={},e._axisDataZoomMap={},e._zoomRecord=[],e}return S(e,t),e.getSpecInfo=function(t){return kY(t,this.specKey,this.type,(function(t){return!1!==t.visible}))},e.prototype.init=function(){var t=this._transformBrushedMarkAttr(this._spec.inBrush),e=this._transformBrushedMarkAttr(this._spec.outOfBrush);this._option.getAllSeries().forEach((function(i){i.getActiveMarks().forEach((function(n){n&&(i.setMarkStyle(n,A({},t),K7,CU.Series),i.setMarkStyle(n,A({},e),q7,CU.Series))}))}))},e.prototype._initNeedOperatedItem=function(){var t=this,e=this._spec.seriesId,i=this._spec.seriesIndex;this._relativeRegions.forEach((function(n){var r=[];n.getSeries().forEach((function(a){(e&&xt(e).includes(a.userId.toString())||i&&xt(i).includes(a.getSpecIndex())||!i&&!e)&&r.push.apply(r,P([],E(a.getMarksWithoutRoot()),!1)),t._itemMap[n.id]=r}))})),this._linkedSeries.forEach((function(e){t._linkedItemMap[e.id]=e.getMarksWithoutRoot()}))},e.prototype.created=function(){t.prototype.created.call(this),this.initEvent(),this._bindRegions(),this._bindLinkedSeries(),this._initRegionAxisMap(),this._initAxisDataZoomMap(),this._initNeedOperatedItem()},e.prototype._bindRegions=function(){N(this._spec.regionId)||N(this._spec.regionIndex)?this._relativeRegions=this._option.getRegionsInUserIdOrIndex(xt(this._spec.regionId),xt(this._spec.regionIndex)):this._relativeRegions=this._option.getAllRegions()},e.prototype._bindLinkedSeries=function(){(N(this._spec.brushLinkSeriesId)||N(this._spec.brushLinkSeriesIndex))&&(this._linkedSeries=this._option.getSeriesInUserIdOrIndex(xt(this._spec.brushLinkSeriesId),xt(this._spec.brushLinkSeriesIndex)))},e.prototype._initRegionAxisMap=function(){var t=this;N(this._spec.axisId)?xt(this._spec.axisId).forEach((function(e){t._releatedAxes.push(t._option.getComponentByUserId(e))})):N(this._spec.axisIndex)?xt(this._spec.axisIndex).forEach((function(e){t._releatedAxes.push(t._option.getComponentByIndex("axes",e))})):this._releatedAxes=this._option.getComponentsByKey("axes"),this._releatedAxes.forEach((function(e){null==e||e.getRegions().forEach((function(i){t._regionAxisMap["region_"+i.id]?t._regionAxisMap["region_"+i.id].push(e):t._regionAxisMap["region_"+i.id]=[e]}))}))},e.prototype._initAxisDataZoomMap=function(){var t=this;this._option.getComponentsByKey("dataZoom").forEach((function(e){e.relatedAxisComponent&&(t._axisDataZoomMap[e.relatedAxisComponent.id]=e)}))},e.prototype.initEvent=function(){},e.prototype.onRender=function(t){},e.prototype.changeRegions=function(t){},e.prototype._compareSpec=function(e,i){var n=this;this._brushComponents&&this._relativeRegions.forEach((function(t,e){n._updateBrushComponent(t,e)}));var r=t.prototype._compareSpec.call(this,e,i);return mt(i,e)||(r.reRender=!0,r.reMake=!0),r},e.prototype.onLayoutEnd=function(e){var i,n=this;(t.prototype.onLayoutEnd.call(this,e),this._option.disableTriggerEvent)||(null===(i=this._spec.visible)||void 0===i||i)&&(this._brushComponents?this._relativeRegions.forEach((function(t,e){n._updateBrushComponent(t,e)})):(this._brushComponents=[],this._relativeRegions.forEach((function(t,e){n._createBrushComponent(t,e)}))))},e.prototype._updateBrushComponent=function(t,e){var i=this._getBrushInteractiveAttr(t),n=this._brushComponents[e];n.setAttributes(i),this._initMarkBrushState(e,""),n.children[0].removeAllChild()},e.prototype._createBrushComponent=function(t,e){var i,n,r=this,a=this._getBrushInteractiveAttr(t),o=new BO(A(A(A({zIndex:this.layoutZIndex,brushStyle:GH(null===(i=this._spec)||void 0===i?void 0:i.style)},a),this._spec),{disableTriggerEvent:this._option.disableTriggerEvent}));o.id=null!==(n=this._spec.id)&&void 0!==n?n:"brush-".concat(this.id),this.getContainer().add(o),this._brushComponents.push(o),this._cacheInteractiveRangeAttrs.push(a),o.addEventListener(CO.brushActive,(function(i){r._initMarkBrushState(e,q7),r._emitEvent(cG.brushActive,t)})),o.addEventListener(CO.drawStart,(function(e){r._emitEvent(cG.brushStart,t)})),o.addEventListener(CO.moveStart,(function(e){r._emitEvent(cG.brushStart,t)})),o.addEventListener(CO.drawing,(function(e){r._needDisablePickable=!0,r._handleBrushChange(t,e),r._emitEvent(cG.brushChange,t)})),o.addEventListener(CO.moving,(function(e){r._handleBrushChange(t,e),r._emitEvent(cG.brushChange,t)})),o.addEventListener(CO.brushClear,(function(i){r._initMarkBrushState(e,""),r._needDisablePickable=!1,r._emitEvent(cG.brushClear,t)})),o.addEventListener(CO.drawEnd,(function(i){var n;r._needDisablePickable=!1;var a=i.detail.operateMask;if(null===(n=r._spec)||void 0===n?void 0:n.onBrushEnd)!0===r._spec.onBrushEnd(i)?(r.clearGraphic(),r._initMarkBrushState(e,""),r._needDisablePickable=!1,r._emitEvent(cG.brushClear,t)):(r._spec.onBrushEnd(i),r._emitEvent(cG.brushEnd,t));else{var o=r._extendDataInBrush(r._inBrushElementsMap);!r._spec.zoomWhenEmpty&&o.length>0&&r._setAxisAndDataZoom(a,t),r._emitEvent(cG.brushEnd,t)}})),o.addEventListener(CO.moveEnd,(function(e){var i=e.detail.operateMask,n=r._extendDataInBrush(r._inBrushElementsMap);!r._spec.zoomWhenEmpty&&n.length>0&&r._setAxisAndDataZoom(i,t),r._emitEvent(cG.brushEnd,t)}))},e.prototype._getBrushInteractiveAttr=function(t){var e=t.getLayoutStartPoint(),i=t.getLayoutRect(),n=e.x,r=n+i.width,a=e.y,o=a+i.height;return{interactiveRange:{minY:a,maxY:o,minX:n,maxX:r},xRange:[n,r],yRange:[a,o]}},e.prototype._transformBrushedMarkAttr=function(t){var e={};return(null==t?void 0:t.symbol)&&(e.symbolType=t.symbol),(null==t?void 0:t.symbolSize)&&(e.size=t.symbolSize),(null==t?void 0:t.color)&&(e.fill=t.color),(null==t?void 0:t.colorAlpha)&&(e.fillOpacity=t.colorAlpha),A(A({},GH(t)),e)},e.prototype._handleBrushChange=function(t,e){var i=e.detail.operateMask;this._reconfigItem(i,t),this._reconfigLinkedItem(i,t)},e.prototype._extendDataInBrush=function(t){var e,i,n=[];for(var r in t)for(var a in t[r])n.push(A({},null===(i=null===(e=t[r][a])||void 0===e?void 0:e.data)||void 0===i?void 0:i[0]));return n},e.prototype._extendDatumOutOfBrush=function(t){var e,i=[];for(var n in t)i.push(null===(e=t[n].data)||void 0===e?void 0:e[0]);return i},e.prototype._emitEvent=function(t,e){var i;this.event.emit(t,{model:this,value:{operateType:t,operateRegion:e,inBrushData:this._extendDataInBrush(this._inBrushElementsMap),outOfBrushData:this._extendDatumOutOfBrush(this._outOfBrushElementsMap),linkInBrushData:this._extendDataInBrush(this._linkedInBrushElementsMap),linkOutOfBrushData:this._extendDatumOutOfBrush(this._linkedOutOfBrushElementsMap),inBrushElementsMap:this._inBrushElementsMap,outOfBrushElementsMap:this._outOfBrushElementsMap,linkedInBrushElementsMap:this._linkedInBrushElementsMap,linkedOutOfBrushElementsMap:this._linkedOutOfBrushElementsMap,zoomRecord:this._zoomRecord},vchart:null===(i=this._option)||void 0===i?void 0:i.globalInstance})},e.prototype._reconfigItem=function(t,e){var i,n,r,a=this;if((null==t?void 0:t.globalTransMatrix)&&(null===(i=null==t?void 0:t.attribute)||void 0===i?void 0:i.points)){var o=null!==(r=null===(n=null==t?void 0:t.attribute)||void 0===n?void 0:n.points)&&void 0!==r?r:[],s=t.globalTransMatrix,l=s.a,u=s.b,c=s.c,h=s.d,d=s.e,p=s.f,f=o.map((function(t){return{x:l*t.x+c*t.y+d,y:u*t.x+h*t.y+p}})),v=this._spec.markTypeFilter,g=void 0===v?[]:v;this._itemMap[e.id].forEach((function(e){if(!g.includes(e.type)){var i=e.getProduct();if(i&&i.elements&&i.elements.length)i.elements.forEach((function(i){var n,r,o,s=i.getGraphicItem(),l=e.id+"_"+i.key,u=a._isBrushContainItem(t.globalAABBBounds,f,s);(null===(n=a._outOfBrushElementsMap)||void 0===n?void 0:n[l])&&u?(i.addState(K7),a._inBrushElementsMap[null==t?void 0:t.name]||(a._inBrushElementsMap[null==t?void 0:t.name]={}),a._inBrushElementsMap[null==t?void 0:t.name][l]=i,delete a._outOfBrushElementsMap[l]):(null===(o=null===(r=a._inBrushElementsMap)||void 0===r?void 0:r[null==t?void 0:t.name])||void 0===o?void 0:o[l])&&!u&&(i.removeState(K7),i.addState(q7),a._outOfBrushElementsMap[l]=i,delete a._inBrushElementsMap[t.name][l]),s.setAttribute("pickable",!a._needDisablePickable)}))}}))}},e.prototype._reconfigLinkedItem=function(t,e){var i,n=this;if((null==t?void 0:t.globalTransMatrix)&&(null===(i=null==t?void 0:t.attribute)||void 0===i?void 0:i.points)){var r=e.getLayoutStartPoint(),a=e.getSeries().map((function(t){return t.id}));this._linkedSeries.forEach((function(e){var i,o;if(!a.includes(e.id)){var s=e.getRegion().getLayoutStartPoint(),l=s.x-r.x,u=s.y-r.y,c=null!==(o=null===(i=null==t?void 0:t.attribute)||void 0===i?void 0:i.points)&&void 0!==o?o:[],h=t.globalTransMatrix,d=h.a,p=h.b,f=h.c,v=h.d,g=h.e,y=h.f,m=l||0,_=u||0,b=c.map((function(t){return{x:d*t.x+f*t.y+g+m,y:p*t.x+v*t.y+y+_}}));t.globalAABBBounds.clone().set(t.globalAABBBounds.x1+m,t.globalAABBBounds.y1+_,t.globalAABBBounds.x2+m,t.globalAABBBounds.y2+_);var x=n._spec.markTypeFilter,k=void 0===x?[]:x;n._linkedItemMap[e.id].forEach((function(e){if(!k.includes(e.type)){var i=e.getProduct();if(i&&i.elements&&i.elements.length)i.elements.forEach((function(i){var r,a,o,s=i.getGraphicItem(),l=e.id+"_"+i.key;(null===(r=n._linkedOutOfBrushElementsMap)||void 0===r?void 0:r[l])&&n._isBrushContainItem(t.globalAABBBounds,b,s)?(i.addState(K7),n._linkedInBrushElementsMap[null==t?void 0:t.name]||(n._linkedInBrushElementsMap[null==t?void 0:t.name]={}),n._linkedInBrushElementsMap[null==t?void 0:t.name][l]=i,delete n._linkedOutOfBrushElementsMap[l]):(null===(o=null===(a=n._linkedInBrushElementsMap)||void 0===a?void 0:a[null==t?void 0:t.name])||void 0===o?void 0:o[l])&&!n._isBrushContainItem(t.globalAABBBounds,b,s)&&(i.removeState(K7),i.addState(q7),n._linkedOutOfBrushElementsMap[l]=i),s.setAttribute("pickable",!n._needDisablePickable)}))}}))}}))}},e.prototype._isBrushContainItem=function(t,e,i){if(["symbol","rect"].includes(i.type)){var n=null==i?void 0:i.globalAABBBounds,r=n.x1,a=n.x2,o=n.y1,s=n.y2;return function(t,e){for(var i=0;i<e.length;i++){if(ii(t,e[i].x,e[i].y))return!0;if(i>0&&ei(e[i-1].x,e[i-1].y,e[i].x,e[i].y,t))return!0}return!1}(e,[{x:r,y:o},{x:a,y:o},{x:a,y:s},{x:r,y:s}])}return t.intersects(i.globalAABBBounds)},e.prototype._initMarkBrushState=function(t,e){var i=this;this._brushComponents.forEach((function(e,i){i!==t&&e.children[0].removeAllChild()})),this._inBrushElementsMap={},this._outOfBrushElementsMap={},this._linkedInBrushElementsMap={},this._linkedOutOfBrushElementsMap={};var n=this._spec.markTypeFilter,r=void 0===n?[]:n;Object.entries(this._itemMap).forEach((function(t){var n=E(t,2);n[0],n[1].forEach((function(t){if(!r.includes(t.type)){var n=t.getProduct();if(n&&n.elements&&n.elements.length)n.elements.forEach((function(n){var r=t.id+"_"+n.key;n.removeState(K7),n.removeState(q7),n.addState(e),i._outOfBrushElementsMap[r]=n}))}}))})),Object.entries(this._linkedItemMap).forEach((function(t){var n=E(t,2);n[0],n[1].forEach((function(t){if(!r.includes(t.type)){var n=t.getProduct();if(n&&n.elements&&n.elements.length)n.elements.forEach((function(n){var r=t.id+"_"+n.key;n.removeState(K7),n.removeState(q7),n.addState(e),i._linkedOutOfBrushElementsMap[r]=n}))}}))}))},e.prototype._stateClamp=function(t){return Math.min(Math.max(0,t),1)},e.prototype._setAxisAndDataZoom=function(t,e){var i,n=this;if(this._zoomRecord=[],this._spec.zoomAfterBrush){var r=t.AABBBounds;null===(i=this._regionAxisMap["region_"+e.id])||void 0===i||i.forEach((function(t){var i,a,o="bottom"===t.layoutOrient||"top"===t.layoutOrient,s=null!==(i=n._spec.axisRangeExpand)&&void 0!==i?i:0,l=r.x1,u=r.x2,c=r.y1,h=r.y2,d=o?"x":"y",p=o?l:c,f=o?u:h;if(n._axisDataZoomMap[t.id]){var v=n._axisDataZoomMap[t.id],g=v.relatedAxisComponent,y=g.getScale().invert(p-e.getLayoutStartPoint()[d]),m=g.getScale().invert(f-e.getLayoutStartPoint()[d]),_=v.dataToStatePoint(y),b=v.dataToStatePoint(m),x=n._stateClamp(_-s),k=n._stateClamp(b+s);v.setStartAndEnd(Math.min(x,k),Math.max(x,k),["percent","percent"]),n._zoomRecord.push({operateComponent:v,start:x,end:k,startValue:v.statePointToData(x),endValue:v.statePointToData(k)})}else{var S=t.getScale().range(),A=null!==(a=t.getScale().rangeFactor())&&void 0!==a?a:[0,1],M=kt(S)<S[0],w=p-e.getLayoutStartPoint()[d],T=f-e.getLayoutStartPoint()[d],C=M?Math.min(w,T):Math.max(w,T),E=M?Math.max(w,T):Math.min(w,T),P=(E-S[0])/(kt(S)-S[0])*(A[1]-A[0])+A[0],R=(C-S[0])/(kt(S)-S[0])*(A[1]-A[0])+A[0],B=n._stateClamp(P-s),I=n._stateClamp(R+s);t.getScale().rangeFactor([B,I]),t.effect.scaleUpdate(),n._zoomRecord.push({operateComponent:t,start:B,end:I,startValue:t.getScale().invert(E),endValue:t.getScale().invert(C)})}}))}},e.prototype._getNeedClearVRenderComponents=function(){return this._brushComponents},e.prototype.clearGraphic=function(){this._brushComponents&&this._brushComponents.forEach((function(t){t._container.incrementalClearChild()}))},e.prototype.clear=function(){var t=this;if(this._brushComponents){var e=this.getContainer();this._brushComponents.forEach((function(i,n){t._initMarkBrushState(n,""),t._needDisablePickable=!1,i.removeAllChild(),i.releaseBrushEvents(),e&&e.removeChild(i)})),this._brushComponents=null}},e.type=B.brush,e.specKey="brush",e}(rK),J7=function(){kz.registerComponent(Z7.type,Z7)},Q7=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=B.customMark,e.specKey="customMark",e.layoutType="none",e.layoutZIndex=wU.CustomMark,e.layoutLevel=TU.CustomMark,e}return S(e,t),e.prototype.created=function(){t.prototype.created.call(this),this.initMarks(),this.initEvent()},e.prototype.getMarkAttributeContext=function(){return this._markAttributeContext},e.prototype._buildMarkAttributeContext=function(){var t=this;this._markAttributeContext={vchart:this._option.globalInstance,globalScale:function(e,i){var n;return null===(n=t._option.globalScale.getScale(e))||void 0===n?void 0:n.scale(i)}}},e.prototype.initMarks=function(){var t=this;if(this._spec){var e=this._option&&this._option.getAllSeries(),i=!1!==this._option.animation,n=[];e&&e.length&&e.forEach((function(t){var e=t&&t.getMarksWithoutRoot();e&&e.length&&e.forEach((function(t){n.push(t)}))}));var r=null;if(this._spec.parent){var a=this.getChart().getAllMarks().find((function(e){return e.getUserId()===t._spec.parent}));"group"===a.type&&(r=a)}this._createExtensionMark(this._spec,r,"".concat(BF,"_series_").concat(this.id,"_extensionMark"),0,{depend:n,hasAnimation:i})}},e.prototype._createExtensionMark=function(t,e,i,n,r){var a,o=this;void 0===n&&(n=0);var s=this._createMark({type:t.type,name:N(t.name)?"".concat(t.name):"".concat(i,"_").concat(n)},{skipBeforeLayouted:!0,attributeContext:this._getMarkAttributeContext(),componentType:t.componentType,key:t.dataKey});if(s){if(N(t.id)&&s.setUserId(t.id),r.hasAnimation&&t.animation){var l=cX({},hX(t.type,t,this._markAttributeContext));s.setAnimationConfig(l)}if(r.depend&&r.depend.length&&s.setDepend.apply(s,P([],E(r.depend),!1)),j(e)?this._marks.addMark(s):e&&e.addMark(s),this.initMarkStyleWithSpec(s,t),"group"===t.type&&(i="".concat(i,"_").concat(n),null===(a=t.children)||void 0===a||a.forEach((function(t,e){o._createExtensionMark(t,s,i,e,r)}))),N(t.dataId)||Q(t.dataIndex)){var u=this.getChart().getSeriesData(t.dataId,t.dataIndex);u&&(u.target.addListener("change",(function(){s.getData().updateData()})),s.setDataView(u))}}},e.prototype.initEvent=function(){},e.prototype._compareSpec=function(e,i){var n=t.prototype._compareSpec.call(this,e,i);return mt(i,e)||(n.reMake=!0),n.change=!0,n.reRender=!0,n},e.prototype.changeRegions=function(t){},e.prototype._getNeedClearVRenderComponents=function(){return[]},e.prototype.onRender=function(t){},e.prototype._getMarkAttributeContext=function(){var t=this;return{vchart:this._option.globalInstance,chart:this.getChart(),globalScale:function(e,i){var n;return null===(n=t._option.globalScale.getScale(e))||void 0===n?void 0:n.scale(i)},getLayoutBounds:function(){var e=t.getLayoutStartPoint(),i=e.x,n=e.y,r=t.getLayoutRect(),a=r.width,o=r.height;return(new di).set(i,n,i+a,n+o)}}},e.prototype._getLayoutRect=function(){var t=new di;return this.getMarks().forEach((function(e){var i=e.getProduct();i&&t.union(i.getBounds())})),t.empty()?{width:0,height:0}:{width:t.width(),height:t.height()}},e.prototype.getBoundsInRect=function(t){this.setLayoutRect(t);var e=this._getLayoutRect(),i=this.getLayoutStartPoint(),n=i.x,r=i.y;return{x1:n,y1:r,x2:n+e.width,y2:r+e.height}},e.prototype.getVRenderComponents=function(){var t=[],e=function(i){var n;if(i&&"group"===i.type)i.getMarks().forEach((function(t){e(t)}));else if("component"===i.type){var r=null===(n=null==i?void 0:i.getProduct())||void 0===n?void 0:n.getGroupGraphicItem();r&&t.push(r)}};return this.getMarks().forEach((function(t){e(t)})),t},e.type=B.customMark,e.specKey="customMark",e}(rK),$7=function(){kz.registerComponent(Q7.type,Q7)};function t6(t,e,i){return void 0===i&&(i=0),i>Math.max(e.x1-t.x2,t.x1-e.x2,e.y1-t.y2,t.y1-e.y2)}function e6(t){return{x1:t.x,x2:t.x+t.width,y1:t.y,y2:t.y+t.height}}function i6(t){var e;if(!t||0===t.length)return[];if(1===t.length)return[t[0].rect];var i=t.map((function(t){var e;return A(A({},t),{bound:e6(t.rect),anchorCandidates:l6(null!==(e=t.anchors)&&void 0!==e?e:[],t.point,t.rect,t.offset)})})),n=[];n.push(i[0].bound);for(var r=function(t){var r=i[t],a=r.bound,o=n.some((function(t){return t6(t,a)}));if(!r.anchorCandidates)return"continue";if(o&&(null===(e=r.anchorCandidates)||void 0===e?void 0:e.length)>0){for(var s=function(t){var e=r.anchorCandidates[t],i={x1:e.x,y1:e.y,x2:e.x+a.x2-a.x1,y2:e.y+a.y2-a.y1,anchor:e};if(!n.some((function(t){return t6(t,i)})))return n.push(i),o=!1,"break"},l=0;l<r.anchorCandidates.length;l++){if("break"===s(l))break}o&&n.push(r.bound)}else n.push(r.bound)},a=1;a<=i.length-1;a++)r(a);return n.map((function(t){return function(t){return{x:t.x1,y:t.y1,width:t.x2-t.x1,height:t.y2-t.y1}}(t)}))}function n6(t,e,i){var n=t.map((function(t){return t.pointCoord})),r=$e(n),a=r.x1,o=r.x2,s=r.y1,l=r.y2,u=i([(a+o)/2,(s+l)/2]);if(!u)return[];var c=t.map((function(t){var n=t.rect,r=o6(e,t.pointCoord)?i(function(t,e,i,n){void 0===n&&(n=200);for(var r=5621/n,a=e,o=1;o<=r;o++){var s=zi(a,n,i);if(!o6(t,s))return[s.x,s.y];a=[s.x,s.y]}return e}(e,[t.pointCoord.x,t.pointCoord.y],r6(a6(t.point,u)))):t.point;r&&(n.x=r.x,n.y=r.y);var a,o=r6(a6(t.point,u)),s=[];return o>=-45&&o<45?(a="top",s.push("left","right")):o>=45&&o<135?a="right":o>=-135&&o<-45?(a="left",s.push("left")):(a="bottom",s.push("left","right")),t.anchors=s,t.offset=20,t.rect=s6(t.rect,a,0),t}));return i6(c)}function r6(t){return t>180?t-360:t}function a6(t,e){return 180*Math.atan2(t.y-e.y,t.x-e.x)/Math.PI+90}function o6(t,e){for(var i=0;i<t.length;i++){if(Fi(e,t[i]))return!0}return!1}function s6(t,e,i){void 0===i&&(i=0);var n=A({},t);return"top"===e?(n.x-=t.width/2,n.y-=i+t.height/2):"bottom"===e?(n.x-=t.width/2,n.y+=i-t.height/2):"left"===e?(n.x-=i+t.width,n.y-=t.height/2):"right"===e&&(n.x+=i,n.y-=t.height/2),n}function l6(t,e,i,n){void 0===n&&(n=0);var r=[];return t.forEach((function(t){var a=s6(A(A({},e),{width:i.width,height:i.height}),t,n),o=a.x,s=a.y;r.push({x:o,y:s})})),r}var u6=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=B.mapLabel,e.name=B.mapLabel,e.specKey="mapLabel",e.layoutType="none",e.layoutZIndex=wU.MarkPoint,e._activeDatum=[],e}return S(e,t),e.getSpecInfo=function(t){return kY(t,this.specKey,this.type,(function(t){return t.visible&&N(t.seriesId)}))},e.prototype.setAttrFromSpec=function(){var t,e,i,n;this.nameField=null!==(t=this._spec.nameField)&&void 0!==t?t:null===(e=this._series)||void 0===e?void 0:e.getDimensionField()[0],this.valueField=null!==(i=this._spec.valueField)&&void 0!==i?i:null===(n=this._series)||void 0===n?void 0:n.getMeasureField()[0]},e.prototype.created=function(){t.prototype.created.call(this),!1!=!!this._spec.visible&&(this.initRelatedInfo(),this.initData(),this.initEvent())},e.prototype.initRelatedInfo=function(){var t,e,i,n,r,a,o,s;this._series=this._option.getSeriesInUserIdOrIndex([this._spec.seriesId])[0],"outer"===this._spec.position&&(this._map=null===(e=null===(t=this._regions[0].getSeriesInType("map")[0])||void 0===t?void 0:t.getMapViewData())||void 0===e?void 0:e.latestData,this._longitudeField=null===(r=null===(n=(i=this._regions[0]).getSpec)||void 0===n?void 0:n.call(i))||void 0===r?void 0:r.longitudeField,this._latitudeField=null===(s=null===(o=(a=this._regions[0]).getSpec)||void 0===o?void 0:o.call(a))||void 0===s?void 0:s.latitudeField)},e.prototype.initData=function(){var t=this,e=this._series;if(e){var i=e.getViewData();if(i){var n=new Ms(this._option.dataSet,{name:"".concat(this.name,"_data")});n.parse([i],{type:"dataview"}),n.transform({type:"copyDataView",level:nU.copyDataView},!1),this._data=new iY(this._option,n),n.target.addListener("change",(function(){"hover"!==t._spec.trigger&&"click"!==t._spec.trigger&&(t._activeDatum=t._data.getLatestData())}))}}},e.prototype.initEvent=function(){var t,e=this;this.event.on("zoom",{filter:function(t){return e._isRelativeModel(t.model)}},(function(t){return e.handleZoom(t),!0})),this.event.on("panmove",{filter:function(t){return e._isRelativeModel(t.model)}},(function(t){return e.handlePan(t),!0}));var i=this._spec.trigger;if("none"!==i){var n=null===(t=this.getCompiler())||void 0===t?void 0:t.getVGrammarView();n&&("hover"===i?(n.addEventListener("element-highlight:start",(function(t){e._isRelativeSeries(t.options.seriesId)&&e._updateDatum(t.elements[0].getDatum())})),n.addEventListener("element-highlight:reset",(function(t){e._isRelativeSeries(t.options.seriesId)&&e._updateDatum(null)}))):"click"===i&&(n.addEventListener("element-select:start",(function(t){e._isRelativeSeries(t.options.seriesId)&&e._updateDatum(t.elements[0].getDatum())})),n.addEventListener("elementSelectReset",(function(t){e._isRelativeSeries(t.options.seriesId)&&e._updateDatum([])}))))}},e.prototype.handlePan=function(t){var e=t.delta;this._markerComponents.forEach((function(t){t.translate(e[0],e[1])}))},e.prototype.handleZoom=function(t){this._updateMarkerLayoutAttribute()},e.prototype._updateDatum=function(t){var e=this;this._activeDatum=t,this._markerComponents.forEach((function(t,i){var n,r=null===(n=e._data)||void 0===n?void 0:n.getLatestData()[i];e._activeDatum.includes(r)?t.setAttribute("visible",!0):t.setAttribute("visible",!1)}))},e.prototype.dataToPosition=function(t){return this._series.dataToPosition(t)},e.prototype.updateLayoutAttribute=function(){var e,i=null===(e=this._data)||void 0===e?void 0:e.getLatestData();i&&0!==i.length&&(t.prototype.updateLayoutAttribute.call(this),this._updateMarkerLayoutAttribute())},e.prototype._updateMarkerLayoutAttribute=function(){var t,e=this,i=[],n=[];this._markerComponents||(this._markerComponents=null===(t=this._data)||void 0===t?void 0:t.getLatestData().map((function(t,i){var n,r=new GD({position:void 0,animation:!1});return r&&(r.name="".concat(e.name,"_marker_").concat(i),r.id=null!==(n=e._spec.id)&&void 0!==n?n:"".concat(e.name,"_marker_").concat(e.id),r.setAttribute("zIndex",e.layoutZIndex)),r}))),this._markerComponents.forEach((function(t,r){t.removeAllChild();var a=e._evaluateMarker(e._data.getLatestData()[r],r),o=a.pairInfo,s=a.contentMarks;o&&i.push(o),s&&n.push(s)}));var r=this._layoutLabels(i);this._layoutMarkers(r,n),this._renderMarkers()},e.prototype._evaluateMarker=function(t,e){var i,n,r,a,o,s,l,u,c,h,d,p,f=0,v=0,g=0,y=0,m=0,_=this._spec.position||"top",b=this._spec.offset,x=bF(null===(i=this._spec.background)||void 0===i?void 0:i.padding),k=this._spec.space||0;v+=((null==x?void 0:x.left)||0)+((null==x?void 0:x.right)||0),g+=((null==x?void 0:x.top)||0)+((null==x?void 0:x.bottom)||0);var S={},M=this.dataToPosition(t),w=Iv({});if(w.name="".concat(this.name,"_marker_itemContainer_").concat(e),S.container=w,null===(n=this._spec.background)||void 0===n?void 0:n.visible){var T=Xg(GH(A({},this._spec.background.style)));T.setAttributes(M),S.labelBackground=T,w.appendChild(T)}if(null===(r=this._spec.icon)||void 0===r?void 0:r.visible){var C=Ng(GH(A({},this._spec.icon.style)));C.setAttributes(M),C.setAttribute("symbolType",null===(a=this._spec.icon.style)||void 0===a?void 0:a.shape);var E=C.AABBBounds,P=null!==(o=(null==E?void 0:E.y2)-(null==E?void 0:E.y1))&&void 0!==o?o:0,R=null!==(s=(null==E?void 0:E.x2)-(null==E?void 0:E.x1))&&void 0!==s?s:0;S.icon=C,w.appendChild(C),m=P,y+=R,f++}if(null===(l=this._spec.nameLabel)||void 0===l?void 0:l.visible){var B=zg(GH(A({},this._spec.nameLabel.style)));B.setAttributes(M),B.setAttribute("text",t[this.nameField]);var I=B.AABBBounds,L=null!==(u=(null==I?void 0:I.y2)-(null==I?void 0:I.y1))&&void 0!==u?u:0,D=null!==(c=(null==I?void 0:I.x2)-(null==I?void 0:I.x1))&&void 0!==c?c:0;S.nameLabel=B,w.appendChild(B),m=Math.max(m,L),y+=D,f++}if((null===(h=this._spec.valueLabel)||void 0===h?void 0:h.visible)&&N(t[this.valueField])){var O=zg(GH(A({},this._spec.valueLabel.style)));O.setAttributes(M),O.setAttribute("text",t[this.valueField]);var F=O.AABBBounds,z=null!==(d=(null==F?void 0:F.y2)-(null==F?void 0:F.y1))&&void 0!==d?d:0,H=null!==(p=(null==F?void 0:F.x2)-(null==F?void 0:F.x1))&&void 0!==p?p:0;S.valueLabel=O,w.appendChild(O),m=Math.max(m,z),y+=H,f++}var j=Object.values(S).find((function(t){return!!t&&"group"!==t.type})),V={x:null==j?void 0:j.getComputedAttribute("x"),y:null==j?void 0:j.getComputedAttribute("y")},W={x:V.x,y:V.y,width:0,height:0};W.width=v+y+(f-1)*k,W.height=g+m;var G={rect:W,point:V,index:e};if("outer"!==_){var U=["top","right","left","bottom"].filter((function(t){return t!==_}));G.rect=s6(W,_,b),G.anchors=U,G.offset=b}else G.pointCoord={x:+(null==t?void 0:t[this._longitudeField]),y:+(null==t?void 0:t[this._latitudeField])};return{pairInfo:G,contentMarks:S}},e.prototype._layoutMarkers=function(t,e){for(var i,n,r,a=function(a){if(!t[a]||!e[a])return{value:void 0};var s=e[a],l=s.icon,u=s.nameLabel,c=s.valueLabel,h=s.labelBackground,d=s.container,p=t[a],f=bF(null===(i=o._spec.background)||void 0===i?void 0:i.padding),v=o._spec.space||0,g=p.height/2,y=(null==f?void 0:f.left)||0;[l,u,c].forEach((function(t,e){var i,n;if(t){var r=t.AABBBounds,a=0;"symbol"===t.type&&(a+=(null!==(i=r.x2-r.x1)&&void 0!==i?i:0)/2),t.setAttributes({x:y+a,y:g}),y+=null!==(n=r.x2-r.x1)&&void 0!==n?n:0,2!==e&&(y+=v)}})),null==h||h.setAttributes({x:0,y:0,width:p.width,height:p.height}),null==d||d.setAttributes({dx:-p.width/2,dy:-p.height/2});var m=o._data.getLatestData()[a],_=o.dataToPosition(m),b=o.getRegions()[0].getLayoutStartPoint(),x=!(!(null===(n=o._spec.leader)||void 0===n?void 0:n.visible)||!(l||u||c));o._markerComponents[a].setAttributes({x:b.x,y:b.y,position:_,visible:o._activeDatum.includes(m),itemContent:{refX:0,type:"custom",renderCustomCallback:function(){return d},autoRotate:!1,offsetX:p.x+p.width/2-_.x,offsetY:p.y+p.height/2-_.y},itemLine:{visible:x,type:"type-po",lineStyle:GH(A({},null===(r=o._spec.leader)||void 0===r?void 0:r.style)),startSymbol:{visible:!1}}})},o=this,s=0;s<e.length;s++){var l=a(s);if("object"==typeof l)return l.value}},e.prototype._renderMarkers=function(){if(this._markerComponents&&this._markerComponents.length)for(var t=0;t<this._markerComponents.length;t++)this.getContainer().add(this._markerComponents[t])},e.prototype._layoutLabels=function(t){var e=this,i="outer"===this._spec.position&&this._map?n6(t,this._map,(function(t){var i;return e._series.dataToPosition(((i={})[e._longitudeField]=t[0],i[e._latitudeField]=t[1],i))})):i6(t);return i},e.prototype._isRelativeModel=function(t){var e,i,n,r=null!==(i=null===(e=this._series.getXAxisHelper())||void 0===e?void 0:e.getAxisId())&&void 0!==i?i:null===(n=this._series.getCoordinateHelper())||void 0===n?void 0:n.getCoordinateId();return(null==t?void 0:t.id)===r},e.prototype._isRelativeSeries=function(t){return(null==t?void 0:t.id)===this._series.id},e.prototype.onRender=function(t){},e.prototype.changeRegions=function(){},e.prototype._getNeedClearVRenderComponents=function(){return this._markerComponents},e.type=B.mapLabel,e.specKey="mapLabel",e}(rK),c6=function(){kz.registerComponent(u6.type,u6)},h6=function(){function t(t,e){this._chartLayoutRect={x:0,y:0,width:1,height:1},this._col=1,this._row=1,this._elementMap=new Map,this.standardizationSpec(t),this._gridInfo=t,this._col=t.col,this._row=t.row,this._colSize=new Array(this._col).fill(null),this._rowSize=new Array(this._row).fill(null),this._colElements=new Array(this._col).fill([]),this._rowElements=new Array(this._row).fill([]),this._onError=null==e?void 0:e.onError,this.initUserSetting()}return t.prototype.standardizationSpec=function(t){var e,i,n;t.col=null!==(e=t.col)&&void 0!==e?e:1,t.row=null!==(i=t.row)&&void 0!==i?i:1,t.elements=null!==(n=t.elements)&&void 0!==n?n:[]},t.prototype.initUserSetting=function(){var t=this;this._gridInfo.colWidth&&this.setSizeFromUserSetting(this._gridInfo.colWidth,this._colSize,this._col,this._chartLayoutRect.width),this._gridInfo.rowHeight&&this.setSizeFromUserSetting(this._gridInfo.rowHeight,this._rowSize,this._row,this._chartLayoutRect.height),this._colSize.forEach((function(e,i){e||(t._colSize[i]={value:0,isUserSetting:!1,isLayoutSetting:!1})})),this._rowSize.forEach((function(e,i){e||(t._rowSize[i]={value:0,isUserSetting:!1,isLayoutSetting:!1})}))},t.prototype.setSizeFromUserSetting=function(t,e,i,n){t.forEach((function(t){t.index<0&&t.index>=i||(Q(t.size)?e[t.index]={value:+t.size,isUserSetting:!0,isLayoutSetting:!1}:H(t.size)&&(e[t.index]={value:t.size(n),isUserSetting:!0,isLayoutSetting:!1}))}))},t.prototype.clearLayoutSize=function(){this._colSize.forEach((function(t){t.isLayoutSetting=!1,t.isUserSetting||(t.value=0)})),this._rowSize.forEach((function(t){t.isLayoutSetting=!1,t.isUserSetting||(t.value=0)}))},t.prototype.getItemGridInfo=function(t){var e,i,n=this._elementMap.get(t);return n||((i=null===(e=this._gridInfo.elements)||void 0===e?void 0:e.find((function(e){var i;if("modelId"in e&&N(e.modelId)){if(N(t.model.userId)&&t.model.userId===e.modelId)return!0}else if("modelKey"in e&&N(e.modelKey)&&"modelIndex"in e&&N(e.modelIndex)){if((null!==(i=t.model.specKey)&&void 0!==i?i:t.model.type)===e.modelKey&&t.model.getSpecIndex()===e.modelIndex)return!0}return!1})))||(i={col:0,colSpan:1,row:0,rowSpan:1}),this._elementMap.set(t,i),i)},t.prototype.getSizeFromGrid=function(t,e){for(var i,n="col"===e?this._colSize:this._rowSize,r=0,a=t[e];a<t[e]+(null!==(i=t["".concat(e,"Span")])&&void 0!==i?i:1);a++)r+=n[a].value;return r},t.prototype.getSizeFromUser=function(t,e){var i,n,r="col"===e?this._colSize:this._rowSize;if(null===(i=r[t[e]])||void 0===i?void 0:i.isUserSetting){for(var a=0,o=t[e];o<t[e]+(null!==(n=t["".concat(e,"Span")])&&void 0!==n?n:1);o++){if(!r[o].isUserSetting)return;a+=r[o].value}return a}},t.prototype.setItemLayoutSizeToGrid=function(t,e){if(d6(t)){if(e.colSpan&&e.colSpan>1)return;if(this._colSize[e.col].isUserSetting)return;this._colSize[e.col].value=Math.max(this._colSize[e.col].value,t.getLayoutRect().width+t.layoutPaddingLeft+t.layoutPaddingRight),this._colSize[e.col].isLayoutSetting=!0}else{if(e.rowSpan&&e.rowSpan>1)return;if(this._rowSize[e.row].isUserSetting)return;this._rowSize[e.row].value=Math.max(this._rowSize[e.row].value,t.getLayoutRect().height+t.layoutPaddingTop+t.layoutPaddingBottom),this._rowSize[e.row].isLayoutSetting=!0}},t.prototype.layoutGrid=function(t){var e="col"===t?this._colSize:this._rowSize,i="col"===t?this._chartLayoutRect.width:this._chartLayoutRect.height,n=[];e.forEach((function(t){t.isUserSetting||t.isLayoutSetting?i-=t.value:n.push(t)})),i<0&&console.warn("layout content ".concat(t," size bigger than chart")),n.forEach((function(t){return t.value=i/n.length}))},t.prototype.getItemPosition=function(t){for(var e=this.getItemGridInfo(t),i={x:this._chartLayoutRect.x,y:this._chartLayoutRect.y},n=0;n<e.col;n++)i.x+=this._colSize[n].value;for(var r=0;r<e.row;r++)i.y+=this._rowSize[r].value;return i.x+=t.layoutPaddingLeft+t.layoutOffsetX,i.y+=t.layoutPaddingTop+t.layoutOffsetY,i},t.prototype.getItemLayoutRect=function(t){var e,i,n=this.getItemGridInfo(t);return{width:(null!==(e=this.getSizeFromGrid(n,"col"))&&void 0!==e?e:this._chartLayoutRect.width)-t.layoutPaddingLeft-t.layoutPaddingRight,height:(null!==(i=this.getSizeFromGrid(n,"row"))&&void 0!==i?i:this._chartLayoutRect.height)-t.layoutPaddingTop-t.layoutPaddingBottom}},t.prototype.layoutItems=function(t,e,i,n){var r=this;this._chartLayoutRect=i,this._chartViewBox=n,this.clearLayoutSize(),e.sort((function(t,e){return e.layoutLevel-t.layoutLevel}));var a=e.filter((function(t){return"normal"===t.layoutType&&!1!==t.getModelVisible()})),o=a.filter((function(t){return d6(t)})),s=a.filter((function(t){return!d6(t)}));a.forEach((function(t){r.layoutOneItem(t,"user",!1)}));var l=e.filter((function(t){return"region-relative"===t.layoutType})),u=l.filter((function(t){return d6(t)})),c=l.filter((function(t){return!d6(t)}));u.forEach((function(t){return r.layoutOneItem(t,"user",!1)})),this.layoutGrid("col"),s.forEach((function(t){return r.layoutOneItem(t,"colGrid",!1)})),c.forEach((function(t){r.layoutOneItem(t,"colGrid",!1)})),this.layoutGrid("row"),c.forEach((function(t){r.layoutOneItem(t,"grid",!1)})),o.forEach((function(t){return r.layoutOneItem(t,"grid",!1)})),u.forEach((function(t){r.layoutOneItem(t,"grid",!0)})),this.layoutGrid("col"),e.filter((function(t){return"region"===t.layoutType})).forEach((function(t){return r.layoutOneItem(t,"grid",!1)})),this.layoutAbsoluteItems(e.filter((function(t){return"absolute"===t.layoutType}))),e.filter((function(t){return"absolute"!==t.layoutType})).forEach((function(t){t.setLayoutStartPosition(r.getItemPosition(t))}))},t.prototype.layoutAbsoluteItems=function(t){var e=this;t.forEach((function(t){t.absoluteLayoutInRect(e._chartLayoutRect)}))},t.prototype.layoutOneItem=function(t,e,i){var n,r,a="rowGrid"===e||"grid"===e?this.getSizeFromGrid.bind(this):this.getSizeFromUser.bind(this),o="colGrid"===e||"grid"===e?this.getSizeFromGrid.bind(this):this.getSizeFromUser.bind(this),s=this.getItemGridInfo(t),l={width:(null!==(n=o(s,"col"))&&void 0!==n?n:this._chartLayoutRect.width)-t.layoutPaddingLeft-t.layoutPaddingRight,height:(null!==(r=a(s,"row"))&&void 0!==r?r:this._chartLayoutRect.height)-t.layoutPaddingTop-t.layoutPaddingBottom},u=t.computeBoundsInRect(l);Q(u.width)||(u.width=l.width),Q(u.height)||(u.height=l.height),t.setLayoutRect("grid"!==e?u:l),this.setItemLayoutSizeToGrid(t,s)},t.type="grid",t}();function d6(t){return"left"===t.layoutOrient||"right"===t.layoutOrient}var p6=function(){kz.registerLayout(h6.type,h6)},f6=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype.layoutItems=function(t,e,i,n){this._layoutInit(t,e,i,n),this._layoutNormalItems(e);var r={left:this.leftCurrent,top:this.topCurrent,right:this.rightCurrent,bottom:this.bottomCurrent},a=e.filter((function(t){return"absolute"===t.layoutType})),o=a.filter((function(t){return"z"===t.layoutOrient})),s={width:0,height:0};o.length&&(s=o[0].getLayoutRect());this.leftCurrent+=s.width/8,this.rightCurrent-=s.width/8,this.topCurrent+=s.height/8,this.bottomCurrent-=s.height/8;var l=this._groupItems(e),u=l.regionItems,c=l.relativeItems,h=l.relativeOverlapItems,d=l.allRelatives,p=l.overlapItems;this.layoutRegionItems(u,c,h,p),this._processAutoIndent(u,c,h,p,d,r);var f=a.filter((function(t){return"z"!==t.layoutOrient}));this.layoutAbsoluteItems(f);var v=c.filter((function(t){return"axes"===t.model.specKey&&MG(t.layoutOrient)}))[0],g=c.filter((function(t){return"axes"===t.model.specKey&&wG(t.layoutOrient)}))[0];if(v&&o.length){var y=v.getLayoutStartPoint(),m=v.getLayoutRect(),_={x:"left"===g.layoutOrient?y.x+m.width:y.x,y:y.y,width:this._chartLayoutRect.width,height:this._chartLayoutRect.height};o[0].model.directionStr="left"===g.layoutOrient?"r2l":"l2r";var b=v.getLayoutRect(),x=g.getLayoutRect(),k={length:o[0].getLayoutRect().width,width:b.width,height:x.height};v.model.setLayout3dBox&&v.model.setLayout3dBox(k),g.model.setLayout3dBox&&g.model.setLayout3dBox(k),o[0].model.setLayout3dBox&&o[0].model.setLayout3dBox(k),this.layoutZAxisItems(o,_)}},e.prototype.layoutZAxisItems=function(t,e){t.forEach((function(t){t.absoluteLayoutInRect(e)}))},e.prototype.getItemComputeLayoutRect=function(t,e){return e||(e={offsetLeft:0,offsetRight:0,offsetTop:0,offsetBottom:0}),{width:this.rightCurrent-this.leftCurrent-t.layoutPaddingLeft-t.layoutPaddingRight-(e.offsetLeft+e.offsetRight),height:this.bottomCurrent-this.topCurrent-t.layoutPaddingTop-t.layoutPaddingBottom-(e.offsetTop+e.offsetBottom)}},e.prototype._checkAutoIndent=function(t){var e=this,i={top:0,left:0,bottom:0,right:0},n=this._chartViewBox.x2-this._chartViewBox.x1-this.rightCurrent,r=this._chartViewBox.y2-this._chartViewBox.y1-this.bottomCurrent;return t.forEach((function(t){if(t.getModelVisible()&&t.autoIndent){var a="left"===t.layoutOrient||"right"===t.layoutOrient,o=t.getLastComputeOutBounds();a?(i.top=Math.max(i.top,o.y1-e.topCurrent),i.bottom=Math.max(i.bottom,o.y2-r)):(i.left=Math.max(i.left,o.x1-e.leftCurrent),i.right=Math.max(i.right,o.x2-n))}})),i},e.type="layout3d",e}(qU),v6=function(){kz.registerLayout(f6.type,f6)},g6=function(){Ac.load(FR)},y6="vchart-tooltip",m6="".concat(y6,"-container"),_6="".concat(y6,"-title"),b6="".concat(y6,"-content-box"),x6={offsetX:10,offsetY:10},k6="99999999999999";function S6(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\(/g,"&#40;").replace(/  /g," &nbsp;")}var A6=function(t,e){return t?(e||(e=t.getBoundingClientRect()),t.offsetWidth>0?e.width/t.offsetWidth:t.offsetHeight>0?e.height/t.offsetHeight:1):1},M6=function(t){return Y(t)&&""!==(null==t?void 0:t.trim())||Z(t)?S6(t):""},w6=function(t,e){var i;if(N(t))if(Z(t))i=t;else if(H(t)){var n=t(e);Z(n)&&(i=n)}return i},T6={left:[-2,0],right:[2,0],top:[0,-2],lt:[-2,-2],tl:[-2,-2],rt:[2,-2],tr:[2,-2],bottom:[0,2],bl:[-2,2],lb:[-2,2],br:[2,2],rb:[2,2],inside:[0,0],center:[0,0],centerBottom:[0,1],centerTop:[0,-1],centerLeft:[-1,0],centerRight:[1,0]},C6=function(t,e,i){var n,r;return void 0===i&&(i=2),null!==(r=null===(n=T6[t])||void 0===n?void 0:n["x"===e?0:1])&&void 0!==r?r:i},E6=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._visible=!0,e._isReleased=!1,e.showTooltip=function(t,i,n){return n.changePositionOnly?e.changeTooltipPosition(n,i):e.changeTooltip(!0,n,i)},e.changeTooltip=function(t,i,n){return e._isReleased?1:t?e.changeTooltipPosition(i,n):(e._updateTooltip(!1,i),0)},e.changeTooltipPosition=function(t,i){var n,r,a,o,s;if(e._isReleased)return 1;var l=t.event,u=t.tooltipSpec,c=t.activeTooltipSpec,h=t.changePositionOnly;if(!c)return 1;var d=c.activeType;if(c.handler)return null!==(a=null===(r=(n=c.handler).showTooltip)||void 0===r?void 0:r.call(n,d,i,t))&&void 0!==a?a:0;var p=c,f=e._getActualTooltipPosition(c,t,e._getTooltipBoxSize(c,h));c.position=f;var v=null!==(o=c.updatePosition)&&void 0!==o?o:null===(s=u[d])||void 0===s?void 0:s.updatePosition;v&&(c.position=v(c.position,i,t));var g=!1!==(null==p?void 0:p.visible);return i&&"pointerout"!==l.type&&c.visible&&(c.title||c.content)||(g=!1),e._updateTooltip(g,A(A({},t),{changePositionOnly:h})),0},e._getActualTooltipPosition=function(t,i,n){var r,a,o,s,l,u,c,h,d,p=i.tooltipSpec,f={x:1/0,y:1/0};if(!p)return f;var v,g=i.event,y=t.activeType,m=t.data,_="dimension"===y?null===(a=null===(r=m[0])||void 0===r?void 0:r.data)||void 0===a?void 0:a[0]:null==m?void 0:m[0],b=e._option,x=b.offsetX,k=b.offsetY,S=p[y],A=AY(null==S?void 0:S.position,m,i),M=null!==(o=AY(null==S?void 0:S.positionMode,m,i))&&void 0!==o?o:"mark"===y?"mark":"pointer",w=null!=n?n:{},T=w.width,C=void 0===T?0:T,E=w.height,P=void 0===E?0:E,R="canvas"===p.renderMode,B=null===(s=null==i?void 0:i.chart)||void 0===s?void 0:s.getCanvasRect(),I=null!==(l=null==B?void 0:B.width)&&void 0!==l?l:IF,L=null!==(u=null==B?void 0:B.height)&&void 0!==u?u:LF,D=!1,O={width:0,height:0},F={x:0,y:0},z={x:0,y:0},j=1,W=1,G=jk(e._env);if(G&&!p.confine?(O.width=window.innerWidth,O.height=window.innerHeight):(O.width=I,O.height=L),G&&!R){var U=e._getParentElement(p);z=null!==(h=null===(c=null==U?void 0:U.getBoundingClientRect)||void 0===c?void 0:c.call(U))&&void 0!==h?h:f;var Y=null!==(d=e._compiler.getCanvas())&&void 0!==d?d:e._chartContainer;v=null==Y?void 0:Y.getBoundingClientRect(),F={x:v.x-z.x,y:v.y-z.y},j=A6(Y,v),W=A6(U,z)}var X,K=W/j,q={},J={x:A,y:A},$={x:["left","right"],y:["top","bottom"]},tt=function(t,e){var n,r,a,o=t.orient,s=t.mode,l=t.offset,u=i.model,c=null==u?void 0:u.getLayoutStartPoint(),h=null!=l?l:"x"===e?x:k;if("mark"===s){D=!0;var d=i.item,p=null==d?void 0:d.getBounds();p&&c&&(r=("x"===e?p.x1:p.y1)+c[e],a=("x"===e?p.x2:p.y2)+c[e])}else if("crosshair"===s&&"cartesian"===(null===(n=null==_?void 0:_.series)||void 0===n?void 0:n.coordinate)&&_.datum&&_.datum.length){D=!0;var f=function(t,e){var i,n=new Map,r=new Map,a=t.series,o=t.datum,s="horizontal"===a.direction,l=(s?a.getYAxisHelper():a.getXAxisHelper()).getAxisId(),u=a.getChart().getComponentsByKey("axes").find((function(t){return t.id===l}));if(u){(s?r:n).set(u.getSpecIndex(),{datum:null===(i=a.getDatumPositionValues(o[0],a.getDimensionField()))||void 0===i?void 0:i[0],axis:u});var c={xField:{coordKey:"x",anotherAxisKey:"y",currentValue:n,attributes:{visible:!!n.size,type:"rect"}},yField:{coordKey:"y",anotherAxisKey:"x",currentValue:r,attributes:{visible:!!r.size,type:"rect"}}};return g8(c,a,e),c.xField.cacheInfo?_8(c.xField):c.yField.cacheInfo?_8(c.yField):void 0}}(_,c);f&&(r=f.start[e],a=f.end[e])}else J[e]=o;if(D){var v=$[e][0],g="x"===e?C:P;switch(C6(o,e)){case-2:q[v]=r-g*K-h;break;case 0:q[v]=(r+a)/2-g*K/2;break;case-1:q[v]=(r+a)/2-g*K-h;break;case 1:q[v]=(r+a)/2+h;break;case 2:q[v]=a+h}}},et=["x","y"];if(V(A))if(V(X=A)&&(N(X.left)||N(X.right)||N(X.top)||N(X.bottom))){var it=A,nt=it.left,rt=it.right,at=it.top,ot=it.bottom;q.left=w6(nt,g),q.top=w6(at,g),q.right=w6(rt,g),q.bottom=w6(ot,g)}else(function(t){return V(t)&&(N(t.x)||N(t.y))})(A)&&et.forEach((function(t){var e=A[t];Z(e)||H(e)?q[$[t][0]]=w6(e,g):tt(e,t)}));else N(A)&&(tt({orient:A,mode:M},"x"),tt({orient:A,mode:M},"y"));var st={x:null,y:null};return et.forEach((function(t){var e,i="x"===t?C:P,n="x"===t?I:L,r="x"===t?x:k,a=C6(J[t],t);if(Q(q[$[t][0]]))st[t]=q[$[t][0]];else if(Q(q[$[t][1]]))st[t]=n-i*K-q[$[t][1]];else{var o="x"===t?g.canvasX:g.canvasY;st[t]=a>0?o+r:0===a?o-i*K/2:o-i*K-r}st[t]*=j,G&&(st[t]+=F[t]),st[t]/=W;var s="x"===t?O.width:O.height,l=p.confine?-(z[t]-(null!==(e=null==v?void 0:v[t])&&void 0!==e?e:0)/j)/W:-z[t]/W,u=s/W+l-i;2!==a&&st[t]<l?D?st[t]=l:(st[t]+=0===a?r+i/2:2*r+i,st[t]>u&&(st[t]=u)):-2!==a&&st[t]>u&&(D?st[t]=u:(st[t]-=0===a?r+i/2:2*r+i,st[t]<l&&(st[t]=l)))})),st},e}return S(e,t),Object.defineProperty(e.prototype,"env",{get:function(){return this._env},enumerable:!1,configurable:!0}),e.prototype.onAdd=function(e){t.prototype.onAdd.call(this,e);var i=e.component;this._component=i,this._chartOption=i.getOption(),this._env=this._chartOption.mode,this._chartContainer=this._chartOption.globalInstance.getContainer(),this._compiler=i.getCompiler(),this._initFromSpec()},e.prototype.hideTooltip=function(t){return this.changeTooltip(!1,t)},e.prototype.release=function(){var t,e,i,n=null!==(t=this._component.getSpec())&&void 0!==t?t:{};n.handler?null===(i=(e=n.handler).release)||void 0===i||i.call(e):(this._removeTooltip(),this._isReleased=!0)},e.prototype._getDefaultOption=function(){var t,e,i=this._component.getSpec().offset;return i?{offsetX:null!==(t=i.x)&&void 0!==t?t:x6.offsetX,offsetY:null!==(e=i.y)&&void 0!==e?e:x6.offsetY}:x6},e.prototype._getParentElement=function(t){return t.parentElement},e.prototype.getTooltipContainer=function(){return this._container},e.prototype._initFromSpec=function(){this._option=this._getDefaultOption()},e.prototype.reInit=function(){this._initFromSpec()},e.specKey="tooltip",e}(WX),P6=function(t,e){return N(t)?X(t)?t.map((function(t){return"".concat(t,"px")})).join(" "):"".concat(t,"px"):null!=e?e:"initial"},R6=function(t,e){var i,n;void 0===t&&(t={}),void 0===e&&(e={}),N(t.fontFamily)&&(e.fontFamily=t.fontFamily);var r=null!==(i=t.fill)&&void 0!==i?i:t.fontColor;return N(r)&&(e.color=r),N(t.fontWeight)&&(e.fontWeight=t.fontWeight),N(t.textAlign)&&(e.textAlign=t.textAlign),N(t.fontSize)&&(e.fontSize=P6(t.fontSize)),N(t.maxWidth)&&(e.maxWidth=P6(t.maxWidth)),t.multiLine||N(t.maxWidth)&&!1!==t.multiLine?(e.whiteSpace="initial",e.wordBreak=null!==(n=t.wordBreak)&&void 0!==n?n:"break-word"):(e.wordBreak="normal",e.whiteSpace="nowrap"),e},B6=function(t){void 0===t&&(t={});var e=t.lineHeight;return t.fontSize?mF(e,t.fontSize):0},I6=function(t){var e,i=t.backgroundColor,n=t.border,r=t.shadow,a=t.padding,o={borderWidth:"".concat(null!==(e=null==n?void 0:n.width)&&void 0!==e?e:0,"px")},s=null;(null==n?void 0:n.color)&&(o.borderColor=n.color),i&&(o.backgroundColor=i),o.boxShadow=r?"".concat(r.x,"px ").concat(r.y,"px ").concat(r.blur,"px ").concat(r.spread,"px ").concat(r.color):"initial";var l=(null!=n?n:{}).radius;return N(l)&&(o.borderRadius=Q(l)?"".concat(l,"px"):"".concat(l)),a&&(s=Ei(a),o.padding=P6(s)),{panelStyle:o,panelPadding:s}};function L6(t,e){t&&t.style&&e&&Object.keys(e).forEach((function(i){t.style[i]=e[i]}))}var D6=function(t){kz.registerComponentPlugin(t.type,t)};var O6=function(t){function e(){var i=t.call(this,e.type)||this;return i.type=i8.dom,i._tooltipContainer=null==Hk?void 0:Hk.body,i}return S(e,t),e.prototype.getVisibility=function(){return!!this._rootDom&&"visible"===this._rootDom.style.visibility},e.prototype.setVisibility=function(t){t!==this.getVisibility()&&this._rootDom&&(this._rootDom.style.visibility=t?"visible":"hidden")},e.prototype.onAdd=function(e){t.prototype.onAdd.call(this,e),this._initStyle(),this.initEl()},e.prototype.initEl=function(){var t=this._component.getSpec().parentElement;if(Hk&&t&&t.children&&t.children.length){for(var e=0;e<t.children.length;e++)if(t.children[e].classList.contains(m6)){this._container=t.children[e];break}this._container||(this._container=Hk.createElement("div"),this._container.style.position="relative",this._container.style.zIndex=k6,this._container.classList.add(m6),t.appendChild(this._container))}},e.prototype.initRootDom=function(){var t,e,i,n=this._component.getSpec(),r=document.createElement("div"),a=null!==(e=null===(t=this._chartOption)||void 0===t?void 0:t.getTheme())&&void 0!==e?e:{};L6(r,A({left:"0",top:"0",pointerEvents:"none",padding:"12px",position:"absolute",zIndex:k6,fontFamily:null!==(i=null==a?void 0:a.fontFamily)&&void 0!==i?i:fz.fontFamily,fontSize:"11px",borderRadius:"3px",borderStyle:"solid",lineHeight:"initial",background:"#fff",boxShadow:"2px 2px 4px rgba(0, 0, 0, 0.1)",maxWidth:"100wh",maxHeight:"100vh",visibility:"hidden"},this._domStyle.panel)),r.classList.add(n.className),r.setAttribute("vchart-tooltip-id","".concat(this.id)),this._container.appendChild(r),this._rootDom=r},e.prototype._getTooltipBoxSize=function(t,e){var i;this._rootDom||this.initRootDom(),e||this._updateDomStringByCol(t),this._updateDomStyle("height");var n=null===(i=this._rootDom)||void 0===i?void 0:i.getBoundingClientRect();return{width:null==n?void 0:n.width,height:null==n?void 0:n.height}},e.prototype._removeTooltip=function(){this._rootDom&&this._rootDom.parentNode&&(this._rootDom.parentNode.removeChild(this._rootDom),this._rootDom=null),this._container=null},e.prototype._updateTooltip=function(t,e){var i,n,r;if(t&&this._rootDom){var a=e.tooltipSpec,o=e.activeTooltipSpec;e.changePositionOnly||(this._tooltipActual=o);var s=this.getVisibility(),l=this._rootDom;if(l){var u=null!==(i=o.position)&&void 0!==i?i:{},c=u.x,h=void 0===c?0:c,d=u.y,p=void 0===d?0:d;if(a.updateElement){this._updatePosition(null!==(n=this._cacheCustomTooltipPosition)&&void 0!==n?n:{x:h,y:p}),a.updateElement(l,o,e);var f=this._getActualTooltipPosition(o,e,{width:l.offsetWidth,height:l.offsetHeight});this._updatePosition(f),this._cacheCustomTooltipPosition=f}else this._rootDom.style.transitionDuration=s?null!==(r=this._domStyle.panel.transitionDuration)&&void 0!==r?r:"initial":"0ms",this._updatePosition({x:h,y:p})}this.setVisibility(t)}else this.setVisibility(t),this._cacheCustomTooltipPosition=void 0},e.prototype._initStyle=function(){var t=this._component.getSpec();this._domStyle=function(t){var e,i,n,r;void 0===t&&(t={});var a=t.style,o=void 0===a?{}:a,s=t.enterable,l=t.transitionDuration,u=o.panel,c=void 0===u?{}:u,h=o.titleLabel,d=o.shape,p=o.keyLabel,f=o.valueLabel,v=o.spaceRow,g=o.align,y=I6(c),m=y.panelStyle,_=y.panelPadding,b={marginTop:"0px",marginBottom:"0px"};m.pointerEvents=s?"auto":"none",l&&(m.transitionDuration=l?"".concat(l,"ms"):"initial",m.transitionProperty=l?"transform":"initial",m.transitionTimingFunction=l?"ease-out":"initial"),Q(v)&&(b.marginBottom="".concat(v,"px"));var x={width:P6(null!==(e=null==d?void 0:d.size)&&void 0!==e?e:8)},k=R6(h),S=R6(p),A=R6(f),M="right"===g?"marginLeft":"marginRight";"right"===g?(m.direction="rtl",k.textAlign="right",S.textAlign="right",A.textAlign="left"):(k.textAlign="left",S.textAlign="left",A.textAlign="right"),x[M]=P6(null!==(i=d.spacing)&&void 0!==i?i:8),S[M]=P6(null!==(n=p.spacing)&&void 0!==n?n:26),A[M]=P6(null!==(r=f.spacing)&&void 0!==r?r:0);var w=Math.max(B6(f),B6(p));return b.lineHeight=w>0?"".concat(w,"px"):"20px",{panelPadding:_,row:b,panel:m,title:k,shape:x,key:S,value:A}}(t)},e.prototype._updateDomStringByCol=function(t){var e,i=this,n=t.title,r=void 0===n?{}:n,a=t.content,o=a&&a.length,s=this._domStyle.row,l=P([],E(this._rootDom.children),!1),u=l.find((function(t){return t.className.includes(_6)}));if(!u&&!1!==r.visible){u=document.createElement("h2");var c=document.createElement("span");u.appendChild(c),u.classList.add(_6),this._rootDom.appendChild(u)}u&&!1!==r.visible?(L6(u,A(A(A({},this._domStyle.title),o?s:{marginBottom:"0px"}),{marginTop:"0px"})),u.firstChild.innerHTML="".concat(null!==(e=r.value)&&void 0!==e?e:"")):u&&!1===r.visible&&u.parentNode.removeChild(u);var h=l.find((function(t){return t.className.includes(b6)})),d=["shape","key","value"];if(!h&&o&&(h=document.createElement("div"),d.forEach((function(t){var e=document.createElement("div");e.classList.add("".concat(y6,"-column")),e.classList.add("".concat(y6,"-").concat(t,"-column")),e.setAttribute("data-col",t),h.appendChild(e)})),h.classList.add(b6),this._rootDom.appendChild(h)),h&&o){var p=P([],E(h.children),!1);L6(h,{whiteSpace:"nowrap"}),p.forEach((function(t,e){var n=t.getAttribute("data-col");if(n&&d.includes(n)){var r="shape"===n&&a.every((function(t){return!t.hasShape||!t.shapeType}));L6(t,A(A({},i._domStyle[n]),{display:r?"none":"inline-block",verticalAlign:"top"}));var o=P([],E(t.children),!1);o.slice(a.length).forEach((function(t){t.parentNode.removeChild(t)})),a.forEach((function(e,r){var l=o[r];l||((l=document.createElement("div")).classList.add("".concat(y6,"-").concat(n)),t.appendChild(l));var u=A({},s);r===a.length-1&&(u.marginBottom="0px"),u.display=!1===e.visible?"none":"block",u.height="initial","key"===n?(l.innerHTML=M6(e.key),e.keyStyle&&R6(e.keyStyle,u)):"value"===n?(l.innerHTML=M6(e.value),e.valueStyle&&R6(e.valueStyle,u)):"shape"===n&&(l.innerHTML=function(t,e){var i,n,r,a,o,s;if(!t||!t.hasShape||!t.shapeType)return"";var l,u,c='style="display:inline-block;vertical-align:middle;"',h=t.shapeType,d=t.shapeFill,p=t.shapeStroke,f=t.shapeHollow,v=void 0!==f&&f,g=null!==(i=t.shapeSize)&&void 0!==i?i:8,y=t.shapeLineWidth?S6(t.shapeLineWidth)+"px":"0px",m="currentColor",_=function(){return p?S6(p):m},b=g,x=function(t){return new jg({symbolType:t,size:b,fill:!0})},k=x(h),S=k.getParsedPath();if(!S.path&&S.pathStr&&(k=x(S.pathStr)),k.getParsedPath().path){var A=k.getParsedPath().path;u=A.toString(),l=A.bounds}else S.isSvg&&S.svgCache&&(u=S.svgCache.map((function(t){return t.path.toString()})).join(),l=S.svgCache.reduce((function(t,e){return t.union(e.path.bounds)}),new di));var M="".concat(l.x1," ").concat(l.y1," ").concat(l.width()," ").concat(l.height());if("0px"!==y){var w=E(M.split(" ").map((function(t){return Number(t)})),4),T=w[0],C=w[1],P=w[2],R=w[3],B=Number(y.slice(0,-2));M="".concat(T-B/2," ").concat(C-B/2," ").concat(P+B," ").concat(R+B)}if(!d||Y(d)||v)return m=v?"none":d?S6(d):"currentColor","\n    <svg ".concat(c,' width="').concat(g,'" height="').concat(g,'" viewBox="').concat(M,'">\n      <path\n        d="').concat(u,'"\n        style="fill: ').concat(m,"; stroke: ").concat(_(),"; stroke-width: ").concat(y,'"\n      >\n      </path>\n    </svg>');if(V(d)){m="gradientColor"+(null!=e?e:"");var I="",L=(null!==(n=d.stops)&&void 0!==n?n:[]).map((function(t){return'<stop offset="'.concat(S6(t.offset.toString()),'" stop-color="').concat(S6(t.color),'"/>')})).join("");return"radial"===d.gradient?I='<radialGradient id="'.concat(m,'" cx="50%" cy="50%" r="50%" fx="0%" fy="0%">\n      ').concat(L,"\n      </radialGradient>"):"linear"===d.gradient&&(I='<linearGradient id="'.concat(m,'" x1="').concat(100*(null!==(r=d.x0)&&void 0!==r?r:0),'%" y1="').concat(100*(null!==(a=d.y0)&&void 0!==a?a:0),'%" x2="').concat(100*(null!==(o=d.x1)&&void 0!==o?o:0),'%" y2="').concat(100*(null!==(s=d.y1)&&void 0!==s?s:0),'%">\n      ').concat(L,"\n      </linearGradient>")),"\n    <svg ".concat(c,' width="').concat(g,'" height="').concat(g,'" viewBox="-0.5 -0.5 1 1">\n      ').concat(I,'\n      <path\n        d="').concat(u,'"\n        style="fill: url(#').concat(m,"); stroke: ").concat(_(),"; stroke-width: ").concat(y,'"\n      >\n      </path>\n    </svg>')}return""}(e,"".concat(i.id,"_").concat(r))),L6(l,u)}))}}))}else h&&!o&&h.parentNode.removeChild(h)},e.prototype._updateDomStyle=function(t){var e,i,n,r,a;void 0===t&&(t="width");var o=this._rootDom,s=P([],E(o.children),!1).find((function(t){return t.className.includes(b6)})),l=P([],E(o.children),!1).find((function(t){return t.className.includes(_6)}));if(s){var u=this._component.getSpec(),c={},h=null===(e=u.style)||void 0===e?void 0:e.titleLabel;if(h&&h.autoWidth&&!1!==h.multiLine&&l){var d=P([],E(s.children),!1).reduce((function(e,i){return"height"===t?e+i.getBoundingClientRect().width:Math.max(e,i.getBoundingClientRect().width)}),0);d>0&&(l.style.maxWidth="".concat(d,"px"),l.style.maxWidth="".concat(Math.ceil(s.getBoundingClientRect().width),"px"))}if(N(null===(i=null==u?void 0:u.style)||void 0===i?void 0:i.maxContentHeight)){var p=l&&l.className.includes(_6)?l.getBoundingClientRect().height+(null!==(n=u.style.spaceRow)&&void 0!==n?n:0):0,f=this._chartOption.getChartViewRect(),v=mF(u.style.maxContentHeight,Math.min(f.height,document.body.clientHeight)-p-(this._domStyle.panelPadding?this._domStyle.panelPadding[0]+this._domStyle.panelPadding[1]:0));v>0&&(c.maxHeight="".concat(v,"px"),c.overflowY="auto",c.width="calc(100% + ".concat(this._domStyle.panelPadding?this._domStyle.panelPadding[1]+"px":"10px",")"),L6(s,c))}var g=s.children,y=[];if(g){for(var m=0;m<g.length;m++)for(var _=null!==(r=g[m].children)&&void 0!==r?r:[],b=0;b<_.length;b++){var x=_[b].getBoundingClientRect()[t];(void 0===y[b]||y[b]<x)&&(y[b]=x)}for(m=0;m<g.length;m++)for(_=null!==(a=g[m].children)&&void 0!==a?a:[],b=0;b<_.length;b++)_[b].style[t]="".concat(y[b],"px")}}},e.prototype._getParentElement=function(e){var i;return null!==(i=this._container)&&void 0!==i?i:t.prototype._getParentElement.call(this,e)},e.prototype.isTooltipShown=function(){return this.getVisibility()},e.prototype.reInit=function(){t.prototype.reInit.call(this),this._initStyle(),this._rootDom&&L6(this._rootDom,this._domStyle.panel),this.getVisibility()&&(this._updateDomStringByCol(this._tooltipActual),this._updateDomStyle("height"))},e.prototype._updatePosition=function(t){var e=t.x,i=t.y;this._rootDom&&(this._rootDom.style.transform="translate3d(".concat(e,"px, ").concat(i,"px, 0)"))},e.type=i8.dom,e}(E6),F6=function(){D6(O6)},z6={fontFamily:fz.fontFamily,spacing:10,wordBreak:"break-word"},H6=function(t,e){var i,n,r;"rich"!==(null==t?void 0:t.type)&&"html"!==(null==t?void 0:t.type)?(t=(null!=t?t:"").toString(),n=e.multiLine?(n=t.split("\n")).map((function(t,e){return e<n.length-1?t+"\n":t})):[t],r=n.map((function(t){return A(A({},e),{text:t})}))):(r=t.text,n=t);var a,o=(a={wordBreak:null!==(i=e.wordBreak)&&void 0!==i?i:"break-word",maxWidth:e.maxWidth?e.maxWidth:void 0,width:0,height:0,textConfig:r},Ry||(Ry=By.CreateGraphic("richtext",{})),Ry.setAttributes(a),Ry.AABBBounds);return{width:o.width(),height:o.height(),text:n}};function j6(t,e,i){var n,r;return void 0===t&&(t={}),A(A({},null!=i?i:z6),{fill:null!==(n=t.fill)&&void 0!==n?n:t.fontColor,textAlign:t.textAlign,textBaseline:t.textBaseline,fontFamily:null!==(r=t.fontFamily)&&void 0!==r?r:null==e?void 0:e.fontFamily,fontSize:t.fontSize,fontWeight:t.fontWeight,lineHeight:t.lineHeight,spacing:t.spacing,multiLine:N(t.maxWidth)?!1!==t.multiLine:t.multiLine,maxWidth:t.maxWidth,wordBreak:t.wordBreak,autoWidth:t.autoWidth})}var N6=function(t){var e,i=t.backgroundColor,n=t.border,r=t.shadow,a={lineWidth:null!==(e=null==n?void 0:n.width)&&void 0!==e?e:0,shadow:!!r};(null==n?void 0:n.color)&&(a.stroke=n.color),i&&(a.fill=i),r&&(a.shadowColor=r.color,a.shadowBlur=r.blur,a.shadowOffsetX=r.x,a.shadowOffsetY=r.y,a.shadowSpread=r.spread);var o=(null!=n?n:{}).radius;return N(o)&&(a.cornerRadius=[o,o,o,o]),a},V6=function(t){function e(){var i=t.call(this,e.type)||this;return i.type=i8.canvas,i._attributes=null,i}return S(e,t),e.prototype.onAdd=function(e){var i;t.prototype.onAdd.call(this,e),this._tooltipCanvasId=null===(i=this._chartOption.modeParams)||void 0===i?void 0:i.tooltipCanvasId},e.prototype._initTooltipComponent=function(t){var e=this._getLayer(t);this._tooltipComponent=new FO({autoCalculatePosition:!1,autoMeasure:!1}),e.add(this._tooltipComponent)},e.prototype._getLayer=function(t){if(this._layer)return this._layer;this._layer=t.createLayer(this._tooltipCanvasId);var e=this._layer.layerHandler.canvas.nativeCanvas;return e&&e.style&&(e.style.touchAction="none",e.style.pointerEvents="none"),this._layer},e.prototype._getTooltipBoxSize=function(t,e){var i,n,r;if(!e||j(this._attributes)){var a=null!==(n=null===(i=this._chartOption)||void 0===i?void 0:i.getTheme())&&void 0!==n?n:{};this._attributes=function(t,e,i){var n,r,a,o,s,l=e.style,u=void 0===l?{}:l,c=e.enterable,h=e.transitionDuration,d=u.panel,p=void 0===d?{}:d,f=u.titleLabel,v=u.shape,g=u.keyLabel,y=u.valueLabel,m=u.spaceRow,_=u.align,b=Ei(p.padding),x=bF(p.padding),k=j6(A({textAlign:"right"===_?"right":"left"},f),i),S=j6(A({textAlign:"right"===_?"right":"left"},g),i),M=j6(y,i),w={fill:!0,size:null!==(n=null==v?void 0:v.size)&&void 0!==n?n:8,spacing:null!==(r=null==v?void 0:v.spacing)&&void 0!==r?r:6},T={panel:N6(p),padding:b,title:{},content:[],titleStyle:{value:k,spaceRow:m},contentStyle:{shape:w,key:S,value:M,spaceRow:m},hasContentShape:!1,keyWidth:0,valueWidth:0,enterable:c,transitionDuration:h,align:_},C=t.title,E=void 0===C?{}:C,P=t.content,R=void 0===P?[]:P,B=x.left+x.right,I=x.top+x.bottom,L=0,D=!!R.length,O=0,F=0,z=0,H=0;if(D){var j=[],V=[],W=[],G=[],U=0;T.content=R.map((function(t,e){var i=0,n=t.hasShape,r=t.key,a=t.shapeType,o=void 0===a?"":a,s=t.shapeFill,l=t.shapeStroke,u=t.shapeLineWidth,c=t.shapeSize,h=t.value,d=t.isKeyAdaptive,p=t.spaceRow,f=t.keyStyle,v=t.valueStyle,g=t.shapeHollow,y={height:0,spaceRow:null!=p?p:m};if(N(r)){var _=xz({},S,j6(f,void 0,{})),b=H6(r,_),x=b.width,k=b.height,T=b.text;y.key=A(A({width:x,height:k},_),{text:T}),d?V.push(x):j.push(x),i=Math.max(i,k)}if(N(h)){var C=xz({},M,j6(v,void 0,{})),E=H6(h,C);x=E.width,k=E.height,T=E.text,y.value=A(A({width:x,height:k},C),{text:T}),W.push(x),i=Math.max(i,k)}if(n){var P={visible:!0,symbolType:o};g?P.stroke=s:P.fill=s,P.stroke=null!=l?l:s,P.lineWidth=u,y.shape=P;var B=null!=c?c:w.size;i=Math.max(B,i),G.push(B)}else y.shape={visible:!1};return y.height=i,U+=i,e<R.length-1&&(U+=y.spaceRow),y})),I+=U,O=j.length?St(j):0,F=V.length?St(V):0,z=W.length?St(W):0,H=G.length?St(G)+w.spacing:0,L=Math.max(H+O+S.spacing+z+M.spacing,H+F,L),T.hasContentShape=!!G.length,T.keyWidth=O,T.valueWidth=z}var Y=0,X=0,K=0,q=E.visible,Z=void 0===q||q,J=E.value,Q=void 0===J?"":J,$=E.valueStyle,tt=E.spaceRow;T.title.visible=Z,T.title.spaceRow=null!=tt?tt:m;var et={},it=function(){return et.autoWidth&&!1!==et.multiLine};if(Z){et=xz({},k,j6($,void 0,{})),it()&&(et.multiLine=null===(a=et.multiLine)||void 0===a||a,et.maxWidth=null!==(o=et.maxWidth)&&void 0!==o?o:D?Math.ceil(L):void 0);var nt=H6(Q,et),rt=nt.text,at=nt.width,ot=nt.height;T.title.value=A(A({width:it()?Math.min(at,null!==(s=et.maxWidth)&&void 0!==s?s:Number.MAX_VALUE):at,height:ot},et),{text:rt}),Y=T.title.value.width,K=(X=T.title.value.height)+(D?T.title.spaceRow:0)}return I+=K,T.title.width=Y,T.title.height=X,it()?B+=L||Y:B+=Math.max(Y,L),D&&T.content.forEach((function(t){var e,i=t.value;i&&(null===(e=i.autoWidth)||void 0===e||e)&&(i.width=B-x.left-x.right-H-O-S.spacing-M.spacing,i.maxWidth||(i.maxWidth=Math.ceil(i.width)),T.valueWidth=Math.max(T.valueWidth,i.width))})),T.panel.width=B,T.panel.height=I,T}(t,this._component.getSpec(),a)}var o=(null!==(r=this._attributes)&&void 0!==r?r:{}).panel;return{width:o.width+o.lineWidth,height:o.height+o.lineWidth}},e.prototype._removeTooltip=function(){this._layer&&this._layer.removeAllChild(),this._attributes=null},e.prototype._updateTooltip=function(t,e){this._visible=t;var i=this._compiler.getStage();if(i)if(t){this._tooltipComponent||this._initTooltipComponent(i);var n=e.activeTooltipSpec.position;e.changePositionOnly?N(n)&&this._tooltipComponent.setAttributes(n):this._tooltipComponent.setAttributes(A(A({},this._attributes),n)),this._tooltipComponent.attribute.visible||(this._tooltipComponent.showAll(),this._tooltipComponent.setAttributes({visibleAll:!0}))}else this._tooltipComponent&&this._tooltipComponent.attribute.visible&&(this._tooltipComponent.hideAll(),this._tooltipComponent.setAttributes({visibleAll:!1}))},e.prototype.isTooltipShown=function(){var t;return null===(t=this._tooltipComponent)||void 0===t?void 0:t.attribute.visibleAll},e.prototype.release=function(){var e;t.prototype.release.call(this),null===(e=this._layer)||void 0===e||e.release()},e.type=i8.canvas,e}(E6),W6=function(){D6(V6)},G6=function(t){kz.registerChartPlugin(t.type,t)},U6=/\{([^}]+)\}/,Y6=/\{([^}]+)\}/g,X6=/:/,K6=function(t){function e(){var i=t.call(this,e.type)||this;return i.type="formatterPlugin",i._timeModeFormat={utc:Yi.getInstance().timeUTCFormat,local:Yi.getInstance().timeFormat},i._formatter=i._format,i._timeFormatter=i._timeModeFormat.local,i._numericFormatter=$i.getInstance().format,i._numericSpecifier=$i.getInstance().formatter,i._numericFormatterCache=new Map,i._isNumericFormatterCache=new Map,i}return S(e,t),e.prototype.onInit=function(t,i){var n;if(t.globalInstance){this._spec=null!==(n=null==i?void 0:i[e.specKey])&&void 0!==n?n:{};var r=this._spec,a=r.timeMode,o=r.customFormatter,s=r.numericFormatter,l=r.timeFormatter;H(o)?this._formatter=o:(this._formatter=this._format.bind(this),H(l)?this._timeFormatter=l:a&&this._timeModeFormat[a]&&(this._timeFormatter=this._timeModeFormat[a]),s&&(this._numericFormatter=s,this._numericSpecifier=null,this._numericFormatterCache=null)),kz.registerFormatter(this._formatter)}},e.prototype._format=function(t,e,i){var n=this;return X(t)?t.map((function(t,r){var a=X(i)?i[r]:i;return a?n._formatSingleLine(t,e,a):t})):X(i)?i.map((function(i){return n._formatSingleLine(t,e,i)})):this._formatSingleLine(t,e,i)},e.prototype._formatSingleLine=function(t,e,i){var n,r=this;if(this._isNumericFormatterCache&&(this._isNumericFormatterCache.get(i)?n=this._isNumericFormatterCache.get(i):(n=U6.test(i),this._isNumericFormatterCache.set(i,n))),n){var a=i.replace(Y6,(function(t,i){if(!X6.test(i)){var n=e[i.trim()];return void 0!==n?n:t}var a=i.split(":"),o=e[a.shift()],s=a.join(":");return r._formatSingleText(o,s)}));return a}return this._formatSingleText(t,i)},e.prototype._formatSingleText=function(t,e){if(Zi.test(e)&&this._numericFormatter){var i=void 0;return this._numericFormatterCache&&this._numericSpecifier?(this._numericFormatterCache.get(e)?i=this._numericFormatterCache.get(e):(i=this._numericSpecifier(e),this._numericFormatterCache.set(e,i)),i(Number(t))):this._numericFormatter(e,Number(t))}return e.includes("%")&&this._timeFormatter?this._timeFormatter(e,t):t},e.prototype.release=function(){t.prototype.release.call(this),this._format=null,this._timeFormatter=null,this._numericFormatter=null,this._numericSpecifier=null,this._numericFormatterCache=null,this._isNumericFormatterCache=null},e.pluginType="chart",e.specKey="formatter",e.type="formatterPlugin",e}(WX),q6=function(){G6(K6)},Z6=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return S(e,t),e.prototype._getDefaultStyle=function(){return A(A({},t.prototype._getDefaultStyle.call(this)),{width:void 0,height:void 0,lineWidth:0})},e.type="image",e}(aY),J6=function(){kz.registerMark(Z6.type,Z6),CP(),dP(),xj.registerGraphic(MH.image,ry)},Q6=function(){sY(),RX(),LX(),OZ(),dJ(),KK(),pq(),dZ(),YJ(),P0(),J6(),Q2(),oK(),iQ(),wq(),F0()};mY.useRegisters([YK,nq,Aq,Kq,u5,v5,m5,E5,i5,F5,N5,V5,K5,y4,b4,L5,$5,i4,w4,l4,h4,f4,S4,E4,A5,B4,x5,Dq,d5,R5,Z5,a4,U5,function(){Rq(),c0(),f0(),U5()},kK,MK,TK,EK,RK,bQ,mQ,z4,U4,p8,k8,A8,R8,I8,O8,kZ,v7,k7,W7,y7,A7,U7,X7,_7,R7,F7,j7,J7,$7,c6,g6,p6,v6,Q6,F6,W6,q6,function(){xj.registerInteraction(Dj.type,Dj)},function(){xj.registerInteraction(Vj.type,Vj)},function(){xj.registerInteraction(Wj.type,Wj)},function(){xj.registerInteraction(Gj.type,Gj)},function(){xj.registerInteraction(Nj.type,Nj)},function(){xj.registerInteraction(jj.type,jj)},Bq,Bk,Pk]);var $6=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["valueField","maskShape","reverse","outlineMargin","outlinePadding","indicatorSmartInvert","liquidBackground","liquidOutline"])},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),this.transformSeriesSpec(e)},e}(zK),t9=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=$6,i.type="liquid",i.seriesType=t.SeriesTypeEnum.liquid,i}return S(i,e),i.type="liquid",i.seriesType=t.SeriesTypeEnum.liquid,i.transformerConstructor=$6,i}(OK),e9=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["categoryField","valueField","circle","overlap","overlapLabel"])},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),this.transformSeriesSpec(e)},e}(zK),i9=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=e9,i.type="venn",i.seriesType=t.SeriesTypeEnum.venn,i}return S(i,e),i.type="venn",i.seriesType=t.SeriesTypeEnum.venn,i.transformerConstructor=e9,i}(OK),n9=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype._getDefaultSeriesSpec=function(e){return t.prototype._getDefaultSeriesSpec.call(this,e,["barWidth","barMaxWidth","barMinWidth","barGapInGroup","barBackground","barMinHeight","stackCornerRadius","bar"])},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),gU(e)},e.prototype._setDefaultXAxisSpec=function(t){return{orient:"bottom",type:"linear",label:{visible:!1}}},e.prototype._setDefaultYAxisSpec=function(t){return{orient:"left",type:"linear"}},e}(HK),r9=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=n9,i.type="mosaic",i.seriesType=t.SeriesTypeEnum.mosaic,i.handleAfterStackRegion=function(t,e){t.getSeries().forEach((function(t){var i=t.getStackData(),n=t.getStackValue(),r=t.getStackValueField();i&&r&&(mH(e[n],r),_H(t,e[n]))}))},i}return S(i,e),i.prototype._beforeInit=function(){this._dataSet&&qG(this._dataSet,"stackSplit",NK)},i.prototype._initStack=function(){this._stack=new VK(this,{afterStackRegion:this.handleAfterStackRegion}),this._stack.init()},i.type="mosaic",i.seriesType=t.SeriesTypeEnum.mosaic,i.transformerConstructor=n9,i}(OK),a9=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return S(i,e),i.prototype._isValidSeries=function(e){return e===t.SeriesTypeEnum.pictogram},i.prototype._getDefaultSeriesSpec=function(t){return e.prototype._getDefaultSeriesSpec.call(this,t,["type","nameField","valueField","svg","pictogram","defaultFillColor"])},i.prototype.transformSpec=function(t){e.prototype.transformSpec.call(this,t),t.region.forEach((function(t){t.coordinate="geo"})),e.prototype.transformSeriesSpec.call(this,t)},i}(zK),o9=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=a9,i.type="pictogram",i.seriesType=t.SeriesTypeEnum.pictogram,i}return S(i,e),i.type="pictogram",i.seriesType=t.SeriesTypeEnum.pictogram,i.transformerConstructor=a9,i}(OK),s9=function(e,i,n){var r,a,o,s,l,u,c,h,d,p,f;void 0===e&&(e="chart");var v={modelInfo:[]};if("chart"===e)v.isChart=!0,v.modelInfo.push({spec:i,type:"chart"});else if("region"===e)v.modelType="region",v.specKey="region",null===(r=i.region)||void 0===r||r.forEach((function(t,e){v.modelInfo.push({spec:t,specPath:["region",e],type:"region"})}));else if("series"===e)v.modelType="series",v.specKey="series",null===(a=i.series)||void 0===a||a.forEach((function(t,e){v.modelInfo.push({spec:t,specPath:["series",e],type:t.type})}));else if(Object.values(t.SeriesTypeEnum).includes(e))v.modelType="series",v.specKey="series",v.type=e,null===(o=i.series)||void 0===o||o.forEach((function(t,i){t.type===e&&v.modelInfo.push({spec:t,specPath:["series",i],type:e})}));else if(Object.values(B).includes(e)){v.modelType="component",v.type=e,v.specKey=null===(s=kz.getComponentInKey(e))||void 0===s?void 0:s.specKey;var g=v.specKey,y=xt(null!==(u=null===(l=n.component)||void 0===l?void 0:l[g])&&void 0!==u?u:[]);null===(h=xt(null!==(c=i[g])&&void 0!==c?c:[]))||void 0===h||h.forEach((function(t,i){var n=y[i];n&&n.type===e?v.modelInfo.push(A(A({},n),{spec:t})):t&&!1===t.visible&&v.modelInfo.push({type:e,spec:t})}))}else{var m=kz.getComponents().filter((function(t){return t.cmp.specKey===e})).map((function(t){return t.cmp.type}));if(m.length>0){v.modelType="component";g=e;v.specKey=g;var _=xt(null!==(p=null===(d=n.component)||void 0===d?void 0:d[g])&&void 0!==p?p:[]);xt(null!==(f=i[g])&&void 0!==f?f:[]).forEach((function(t,e){var i=_[e];i&&m.includes(i.type)&&v.modelInfo.push(A(A({},i),{spec:t}))}))}}return v},l9=function(t,e,i,n){var r,a,o=t.spec,s=t.filter,l=t.filterType,u=t.forceAppend,c=function(t,e,i,n,r,a){void 0===t&&(t="chart");var o=s9(t,r,a);return A(A({},o),{modelInfo:o.modelInfo.filter((function(t){return!!j(e)||xt(e).some((function(e){return H(e)?e(t,i,n):yz(t.spec,e)}))}))})}(l,s,t,e,i,n),h=c.isChart,d=c.modelType,p=c.specKey,f=c.type,v=c.modelInfo;if(0===v.length&&!u)return{chartSpec:i,hasChanged:!1};var g=xz({},i),y=H(o)?o(v,t,e):o;try{for(var m=C(v),_=m.next();!_.done;_=m.next()){var b=_.value,x=b.spec,k=b.specPath;if(h)return{chartSpec:xz(g,y),hasChanged:!0};var S=xz({},x,y);mz(g,k,S)}}catch(t){r={error:t}}finally{try{_&&!_.done&&(a=m.return)&&a.call(m)}finally{if(r)throw r.error}}if(0===v.length&&u){var M=A({type:f},y);X(g[p])?g[p].push(M):j(g[p])?g[p]="component"===d?M:[M]:g[p]=[g[p],M]}return{chartSpec:g,hasChanged:!0}},u9=function(t){function e(){var i=t.call(this,e.type)||this;return i.type="MediaQueryPlugin",i._currentMediaInfo={},i.currentActiveItems=new Set,i._initialized=!1,i}return S(e,t),e.prototype.onInit=function(t,i){if(null==i?void 0:i[e.specKey]){var n=t.globalInstance;this._option={globalInstance:t.globalInstance,updateSpec:function(t,e,i){i?n.updateSpecSync(t):e?n.updateSpecAndRecompile(t,!1,{transformSpec:!0}):n.setRuntimeSpec(t)}},this._spec=i[e.specKey],this._initialized=!0}},e.prototype.onBeforeResize=function(t,e,i){this._initialized&&this._changeSize(e,i,!0,!1)},e.prototype.onAfterChartSpecTransform=function(t,e,i){this._initialized&&"setCurrentTheme"===i&&this._reInit(!1,!1)},e.prototype.onAfterModelSpecTransform=function(t,e,i,n){this._initialized&&"updateSpec"===n&&this.onBeforeInitChart(t,e,"setCurrentTheme")},e.prototype.onBeforeInitChart=function(t,e,i){if(this._initialized){var n,r;switch(i){case"render":case"updateModelSpec":n=!1,r=!0;break;case"setCurrentTheme":n=!0,r=!1;break;case"updateSpecAndRecompile":n=!1,r=!1}if(n&&this.release(),this._initialized||this.onInit(t,e),n||r){var a=this._option.globalInstance.getCurrentSize(),o=a.width,s=a.height;this._changeSize(o,s,!1,!1)}}},e.prototype._changeSize=function(t,e,i,n){return(this._currentMediaInfo.width!==t||this._currentMediaInfo.height!==e)&&(this._currentMediaInfo.width=t,this._currentMediaInfo.height=e,this._applyQueries(i,n))},e.prototype._applyQueries=function(t,i){var n,r,a=this,o=[],s=[];if(this._spec.forEach((function(t){var e=a._check(t),i=e.hasChanged,n=e.isActive;i&&(n?o.push(t):s.push(t))})),!o.length&&!s.length)return!1;this._baseChartSpec||(this._baseChartSpec=bz(this._option.globalInstance.getSpec(),["data",e.specKey]),this._baseChartSpecInfo=this._option.globalInstance.getSpecInfo());var l=!1;return s.length>0?(n=bz(this._baseChartSpec,["data",e.specKey]),r=this._baseChartSpecInfo,Array.from(this.currentActiveItems).forEach((function(t){if(s.includes(t))a.currentActiveItems.delete(t);else{var e=a._apply(t,n,r);n=e.chartSpec}})),l=!0):(n=this._option.globalInstance.getSpec(),r=this._option.globalInstance.getSpecInfo()),o.forEach((function(t){a.currentActiveItems.add(t);var e=a._apply(t,n,r);n=e.chartSpec,l||(l=e.hasChanged)})),l&&this._option.updateSpec(n,t,i),!0},e.prototype._check=function(t){var e=this._option.globalInstance,i=function(t,e,i){for(var n in t)switch(n){case"maxHeight":if(N(t.maxHeight)&&e.height>t.maxHeight)return!1;break;case"minHeight":if(N(t.minHeight)&&e.height<t.minHeight)return!1;break;case"maxWidth":if(N(t.maxWidth)&&e.width>t.maxWidth)return!1;break;case"minWidth":if(N(t.minWidth)&&e.width<t.minWidth)return!1;break;case"onResize":if(N(t.onResize)&&!t.onResize(e,i))return!1}return!0}(t.query,this._currentMediaInfo,e);return{isActive:i,hasChanged:i!==this.currentActiveItems.has(t)}},e.prototype._apply=function(t,e,i){var n=t.query,r=t.action,a=!1;return xt(r).forEach((function(t){var r=l9(t,n,e,i);e=r.chartSpec,a||(a=r.hasChanged)})),{chartSpec:e,hasChanged:a}},e.prototype._reInit=function(t,i){var n=this,r=this._option.globalInstance.getSpec();this._baseChartSpec=bz(r,["data",e.specKey]),this._baseChartSpecInfo=this._option.globalInstance.getSpecInfo();var a=!1;this.currentActiveItems.forEach((function(t){var e=n._apply(t,r,n._baseChartSpecInfo);r=e.chartSpec,a||(a=e.hasChanged)})),a&&this._option.updateSpec(r,t,i)},e.prototype.release=function(){t.prototype.release.call(this),this._initialized=!1,this._spec=[],this._option=void 0,this._currentMediaInfo={},this.currentActiveItems.clear()},e.pluginType="chart",e.specKey="media",e.type="MediaQueryPlugin",e}(WX);t.Arc3dMark=eQ,t.ArcMark=UJ,t.AreaChart=iq,t.AreaMark=XK,t.AreaSeries=$K,t.AxisSyncPlugin=GX,t.Bar3dChart=Lq,t.Bar3dSeries=Cq,t.BarChart=kq,t.BarSeries=_q,t.BaseChart=OK,t.BaseChartSpecTransformer=zK,t.BaseMark=aY,t.BaseSeries=_X,t.BoxPlotChart=_4,t.BoxPlotSeries=uJ,t.Brush=Z7,t.CanvasTooltipHandler=V6,t.CartesianAxis=hK,t.CartesianBandAxis=AK,t.CartesianChartSpecTransformer=HK,t.CartesianCrossHair=x8,t.CartesianLinearAxis=xK,t.CartesianLogAxis=CK,t.CartesianMarkArea=x7,t.CartesianMarkLine=f7,t.CartesianMarkPoint=V7,t.CartesianSeries=SX,t.CartesianSymlogAxis=PK,t.CartesianTimeAxis=wK,t.CirclePackingChart=c4,t.CirclePackingSeries=H1,t.CircularProgressChart=I5,t.CircularProgressSeries=e$,t.CommonChart=b5,t.CommonChartSpecTransformer=_5,t.ComponentMark=aK,t.ComposedEventMapper=GG,t.ContinuousLegend=G4,t.CorrelationChart=R4,t.CorrelationSeries=e3,t.CustomMark=Q7,t.DEFAULT_CHART_HEIGHT=LF,t.DEFAULT_CHART_WIDTH=IF,t.DEFAULT_DATA_INDEX=Uz,t.DEFAULT_DATA_KEY=Yz,t.DEFAULT_DATA_SERIES_FIELD=Xz,t.DEFAULT_MEASURE_CANVAS_ID=Gz,t.DEFAULT_SERIES_STYLE_NAME=Kz,t.DataZoom=P8,t.DimensionClickEvent=VG,t.DimensionHoverEvent=WG,t.DiscreteLegend=F4,t.DomTooltipHandler=O6,t.DotSeries=NQ,t.Event=UG,t.Factory=kz,t.FormatterPlugin=K6,t.Funnel3dChart=q5,t.Funnel3dSeries=H0,t.FunnelChart=X5,t.FunnelSeries=L0,t.GaugeChart=O5,t.GaugePointerSeries=C2,t.GaugeSeries=R2,t.GeoCoordinate=xZ,t.GeoMarkPoint=Y7,t.GridLayout=h6,t.GroupMark=oY,t.HeatmapChart=C4,t.HeatmapSeries=N2,t.Histogram3dChart=P5,t.HistogramChart=C5,t.ImageMark=Z6,t.Indicator=D8,t.Label=O7,t.Layout=qU,t.Layout3d=f6,t.LineChart=GK,t.LineMark=PX,t.LineSeries=BK,t.LinearProgressChart=Q5,t.LinearProgressSeries=h$,t.LinkSeries=YQ,t.LiquidChart=t9,t.LiquidSeries=p3,t.MOSAIC_CAT_END_PERCENT=uH,t.MOSAIC_CAT_START_PERCENT=lH,t.MOSAIC_VALUE_END_PERCENT=sH,t.MOSAIC_VALUE_START_PERCENT=oH,t.MapChart=e5,t.MapLabelComponent=u6,t.MapSeries=AZ,t.MediaQuery=u9,t.MosaicChart=r9,t.MosaicSeries=j3,t.PREFIX=BF,t.PathMark=hZ,t.PictogramChart=o9,t.PictogramSeries=Q3,t.Pie3dChart=h5,t.Pie3dSeries=rQ,t.PieChart=l5,t.PieSeries=$J,t.Player=P7,t.PolarAxis=gQ,t.PolarBandAxis=_Q,t.PolarCrossHair=S8,t.PolarLinearAxis=yQ,t.PolarMarkArea=S7,t.PolarMarkLine=g7,t.PolarMarkPoint=G7,t.PolarSeries=RJ,t.PolygonMark=E0,t.ProgressLikeSeries=qQ,t.Pyramid3dMark=O0,t.RadarChart=y5,t.RadarSeries=RQ,t.RangeAreaChart=M4,t.RangeAreaSeries=EJ,t.RangeColumn3dChart=r4,t.RangeColumn3dSeries=MJ,t.RangeColumnChart=e4,t.RangeColumnSeries=SJ,t.Rect3dMark=Mq,t.RectMark=dq,t.RippleMark=J2,t.RoseChart=f5,t.RoseLikeSeries=pQ,t.RoseSeries=xQ,t.RuleMark=DZ,t.SEGMENT_FIELD_END=hH,t.SEGMENT_FIELD_START=cH,t.STACK_FIELD_END=Jz,t.STACK_FIELD_END_OffsetSilhouette=eH,t.STACK_FIELD_END_PERCENT=$z,t.STACK_FIELD_KEY=qz,t.STACK_FIELD_START=Zz,t.STACK_FIELD_START_OffsetSilhouette=tH,t.STACK_FIELD_START_PERCENT=Qz,t.STACK_FIELD_TOTAL=iH,t.STACK_FIELD_TOTAL_BOTTOM=aH,t.STACK_FIELD_TOTAL_PERCENT=nH,t.STACK_FIELD_TOTAL_TOP=rH,t.SankeyChart=k4,t.SankeySeries=h2,t.ScatterChart=Xq,t.ScatterSeries=Gq,t.ScrollBar=B8,t.SequenceChart=S5,t.SunburstChart=s4,t.SunburstSeries=B1,t.SymbolMark=IX,t.TextMark=hJ,t.ThemeManager=Hz,t.Title=m7,t.Tooltip=d8,t.TotalLabel=z7,t.TreemapChart=p4,t.TreemapSeries=m2,t.VChart=mY,t.VennChart=i9,t.VennSeries=z3,t.WaterfallChart=g4,t.WaterfallSeries=tJ,t.WordCloud3dChart=G5,t.WordCloud3dSeries=p0,t.WordCloudChart=j5,t.WordCloudSeries=h0,t.alternatingWave=function(t,e,i,n,r,a,o){var s=e/n,l=i/r,u=(arguments.length>7&&void 0!==arguments[7]?arguments[7]:0)+(arguments.length>8&&void 0!==arguments[8]?arguments[8]:1)*(Math.sin(2*a*Math.PI-2*s*Math.PI)*Math.sin(2*a*Math.PI-2*l*Math.PI)+1)/2;return Math.min(1,Math.max(0,u))},t.builtinThemes=Cz,t.centerToCorner=function(t,e,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=n/2,c=r/2,h=Math.sqrt(Math.pow((e-u)/u,2)+Math.pow((i-c)/c,2)),d=1-Math.min(h,1),p=s+l*(Math.sin(2*a*Math.PI-2*d*Math.PI)+1)/2;return Math.min(1,Math.max(0,p))},t.columnCenterToEdge=function(t,e,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=r/2,c=Math.abs(i-u)/u,h=s+l*(Math.sin(2*a*Math.PI-2*c*Math.PI)+1)/2;return Math.min(1,Math.max(0,h))},t.columnEdgeToCenter=function(t,e,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=r/2,c=1-Math.abs(i-u)/u,h=s+l*(Math.sin(2*a*Math.PI-2*c*Math.PI)+1)/2;return Math.min(1,Math.max(0,h))},t.columnLeftToRight=function(t,e,i,n,r,a,o){var s=i/r,l=(arguments.length>7&&void 0!==arguments[7]?arguments[7]:0)+(arguments.length>8&&void 0!==arguments[8]?arguments[8]:1)*(Math.sin(2*a*Math.PI-2*s*Math.PI)+1)/2;return Math.min(1,Math.max(0,l))},t.columnRightToLeft=function(t,e,i,n,r,a,o){var s=(r-1-i)/r,l=(arguments.length>7&&void 0!==arguments[7]?arguments[7]:0)+(arguments.length>8&&void 0!==arguments[8]?arguments[8]:1)*(Math.sin(2*a*Math.PI-2*s*Math.PI)+1)/2;return Math.min(1,Math.max(0,l))},t.computeActualDataScheme=rF,t.cornerToCenter=function(t,e,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=n/2,c=r/2,h=Math.sqrt(Math.pow((e-u)/u,2)+Math.pow((i-c)/c,2)),d=Math.min(h,1),p=s+l*(Math.sin(2*a*Math.PI-2*d*Math.PI)+1)/2;return Math.min(1,Math.max(0,p))},t.createArc=by,t.createArea=yy,t.createGroup=Iv,t.createLine=Gg,t.createRect=Xg,t.createRichText=hy,t.createSymbol=Ng,t.createText=zg,t.darkTheme=gz,t.dataScheme=SF,t.default=mY,t.defaultThemeName=Ez,t.diagonalCenterToEdge=function(t,e,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=n/2,c=r/2,h=Math.sqrt(Math.pow((e-u)/n,2)+Math.pow((i-c)/r,2)),d=s+l*(Math.sin(2*a*Math.PI-2*h*Math.PI)+1)/2;return Math.min(1,Math.max(0,d))},t.diagonalTopLeftToBottomRight=function(t,e,i,n,r,a,o){var s=(e/n+i/r)/2,l=(arguments.length>7&&void 0!==arguments[7]?arguments[7]:0)+(arguments.length>8&&void 0!==arguments[8]?arguments[8]:1)*(Math.sin(2*a*Math.PI-2*s*Math.PI)+1)/2;return Math.min(1,Math.max(0,l))},t.functionTransform=Vz,t.getActualColor=oF,t.getCartesianDimensionInfo=zG,t.getColorSchemeBySeries=cF,t.getDataScheme=nF,t.getFieldAlias=fH,t.getMergedTheme=Fz,t.getPolarDimensionInfo=AG,t.getRegionStackGroup=vH,t.getTheme=Lz,t.hasThemeMerged=Bz,t.isColorKey=sF,t.isProgressiveDataColorScheme=lF,t.isTokenKey=pz,t.lightTheme=vz,t.mergeFields=dH,t.particleEffect=function(t,e,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=e*r+i,c=2*IP(u,0)*Math.PI,h=.5*IP(u,1)+.5,d=2*IP(u,2)*Math.PI,p=n/2,f=r/2,v=Math.sqrt(Math.pow((e-p)/p,2)+Math.pow((i-f)/f,2)),g=Math.min(v,1),y=(a-.4)/.6,m=Math.sin(y*h*8*Math.PI+c+d*y),_=Math.cos(g*Math.PI+y*Math.PI),b=s+l*((m+1)/2*Math.max(0,1-1.2*y)*(.3+.7*_));return Math.min(1,Math.max(0,b))},t.pulseWave=function(t,e,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=n/2,c=r/2,h=Math.sqrt(Math.pow((e-u)/u,2)+Math.pow((i-c)/c,2)),d=Math.min(h,1),p=2*a*Math.PI*3,f=Math.max(0,1-d),v=s+l*((Math.sin(p-4*d*Math.PI)+1)/2)*(.7*f+.3);return Math.min(1,Math.max(0,v))},t.queryColorFromColorScheme=aF,t.queryToken=dz,t.randomOpacity=function(t,e,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=2*IP(e*r+i)*Math.PI,c=s+l*(Math.sin(2*a*Math.PI+u)+1)/2;return Math.min(1,Math.max(0,c))},t.register3DPlugin=Rq,t.registerAllEnv=function(){BT()},t.registerAllMarks=Q6,t.registerAnimate=Bq,t.registerArc3dMark=iQ,t.registerArcMark=YJ,t.registerAreaChart=nq,t.registerAreaMark=KK,t.registerAreaSeries=tq,t.registerBar3dChart=Dq,t.registerBar3dSeries=Eq,t.registerBarChart=Aq,t.registerBarSeries=bq,t.registerBoxplotChart=b4,t.registerBoxplotSeries=cJ,t.registerBrowserEnv=cY,t.registerBrush=J7,t.registerCanvasTooltipHandler=W6,t.registerCartesianBandAxis=MK,t.registerCartesianCrossHair=k8,t.registerCartesianLinearAxis=kK,t.registerCartesianLogAxis=EK,t.registerCartesianSymlogAxis=RK,t.registerCartesianTimeAxis=TK,t.registerChartPlugin=G6,t.registerCirclePackingChart=h4,t.registerCirclePackingSeries=j1,t.registerCircularProgressChart=L5,t.registerCircularProgressSeries=i$,t.registerCommonChart=x5,t.registerComponentMark=oK,t.registerContinuousLegend=U4,t.registerCorrelationChart=B4,t.registerCustomMark=$7,t.registerDataZoom=R8,t.registerDiscreteLegend=z4,t.registerDomTooltipHandler=F6,t.registerDotSeries=VQ,t.registerDragPlugin=function(){xj.registerStageEventPlugin("drag",XS)},t.registerFormatPlugin=q6,t.registerFunnel3dChart=Z5,t.registerFunnel3dSeries=j0,t.registerFunnelChart=K5,t.registerFunnelSeries=D0,t.registerGaugeChart=F5,t.registerGaugePointerSeries=E2,t.registerGaugeSeries=B2,t.registerGeoCoordinate=kZ,t.registerGeoMarkPoint=X7,t.registerGesturePlugin=gG,t.registerGridLayout=p6,t.registerGroupMark=sY,t.registerHarmonyEnv=function(){pC(Ac)},t.registerHeatmapChart=E4,t.registerHeatmapSeries=V2,t.registerHistogram3dChart=R5,t.registerHistogramChart=E5,t.registerHtmlAttributePlugin=Pk,t.registerImageMark=J6,t.registerIndicator=O8,t.registerLabel=F7,t.registerLarkEnv=function(){vw(Ac)},t.registerLayout3d=v6,t.registerLineChart=YK,t.registerLineMark=RX,t.registerLineSeries=IK,t.registerLinearProgressChart=$5,t.registerLinearProgressSeries=d$,t.registerLinkSeries=XQ,t.registerLiquidChart=function(){f3(),kz.registerChart(t9.type,t9)},t.registerLiquidSeries=f3,t.registerLynxEnv=function(){Iw(Ac)},t.registerMapChart=i5,t.registerMapLabel=c6,t.registerMapSeries=MZ,t.registerMarkArea=k7,t.registerMarkLine=v7,t.registerMarkPoint=W7,t.registerMediaQuery=function(){G6(u9)},t.registerMorph=Iq,t.registerMosaicChart=function(){N3(),kz.registerChart(r9.type,r9)},t.registerMosaicSeries=N3,t.registerNodeEnv=hY,t.registerPathMark=dZ,t.registerPictogramChart=function(){$3(),kz.registerChart(o9.type,o9)},t.registerPictogramSeries=$3,t.registerPie3dChart=d5,t.registerPie3dSeries=aQ,t.registerPieChart=u5,t.registerPieSeries=tQ,t.registerPlayer=R7,t.registerPolarBandAxis=bQ,t.registerPolarCrossHair=A8,t.registerPolarLinearAxis=mQ,t.registerPolarMarkArea=A7,t.registerPolarMarkLine=y7,t.registerPolarMarkPoint=U7,t.registerPolygonMark=P0,t.registerPoptip=g6,t.registerPyramid3dMark=F0,t.registerRadarChart=m5,t.registerRadarSeries=OQ,t.registerRangeAreaChart=w4,t.registerRangeAreaSeries=PJ,t.registerRangeColumn3dChart=a4,t.registerRangeColumn3dSeries=wJ,t.registerRangeColumnChart=i4,t.registerRangeColumnSeries=AJ,t.registerReactAttributePlugin=Bk,t.registerRect3dMark=wq,t.registerRectMark=pq,t.registerRippleMark=Q2,t.registerRoseChart=v5,t.registerRoseSeries=kQ,t.registerRuleMark=OZ,t.registerSankeyChart=S4,t.registerSankeySeries=d2,t.registerScatterChart=Kq,t.registerScatterSeries=Uq,t.registerScrollBar=I8,t.registerSequenceChart=A5,t.registerSunBurstSeries=L1,t.registerSunburstChart=l4,t.registerSymbolMark=LX,t.registerTTEnv=function(){ZT(Ac)},t.registerTaroEnv=function(){dT(Ac)},t.registerTextMark=dJ,t.registerTheme=Iz,t.registerTitle=_7,t.registerTooltip=p8,t.registerTotalLabel=j7,t.registerTreemapChart=f4,t.registerTreemapSeries=x2,t.registerVennChart=function(){H3(),kz.registerChart(i9.type,i9)},t.registerVennSeries=H3,t.registerWXEnv=function(){PT(Ac)},t.registerWaterfallChart=y4,t.registerWaterfallSeries=eJ,t.registerWordCloud3dChart=U5,t.registerWordCloud3dSeries=f0,t.registerWordCloudChart=N5,t.registerWordCloudSeries=d0,t.registerWordCloudShapeChart=V5,t.removeTheme=Dz,t.rippleEffect=function(t,e,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=n/2,c=r/2,h=Math.sqrt(Math.pow(e-u,2)+Math.pow(i-c,2))/Math.sqrt(Math.pow(n/2,2)+Math.pow(r/2,2)),d=s+l*(Math.sin(2*a*Math.PI*3-2*h*Math.PI)+1)/2;return Math.min(1,Math.max(0,d))},t.rotationScan=function(t,e,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=n/2,c=r/2,h=Math.atan2(e-u,i-c),d=(h<0?h+2*Math.PI:h)/(2*Math.PI),p=s+l*(Math.sin(2*a*Math.PI-2*d*Math.PI)+1)/2;return Math.min(1,Math.max(0,p))},t.rowBottomToTop=function(t,e,i,n,r,a,o){var s=(n-1-e)/n,l=(arguments.length>7&&void 0!==arguments[7]?arguments[7]:0)+(arguments.length>8&&void 0!==arguments[8]?arguments[8]:1)*(Math.sin(2*a*Math.PI-2*s*Math.PI)+1)/2;return Math.min(1,Math.max(0,l))},t.rowCenterToEdge=function(t,e,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=n/2,c=Math.abs(e-u)/u,h=s+l*(Math.sin(2*a*Math.PI-2*c*Math.PI)+1)/2;return Math.min(1,Math.max(0,h))},t.rowEdgeToCenter=function(t,e,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=n/2,c=1-Math.abs(e-u)/u,h=s+l*(Math.sin(2*a*Math.PI-2*c*Math.PI)+1)/2;return Math.min(1,Math.max(0,h))},t.rowTopToBottom=function(t,e,i,n,r,a,o){var s=e/n,l=(arguments.length>7&&void 0!==arguments[7]?arguments[7]:0)+(arguments.length>8&&void 0!==arguments[8]?arguments[8]:1)*(Math.sin(2*a*Math.PI-2*s*Math.PI)+1)/2;return Math.min(1,Math.max(0,l))},t.snakeWave=function(t,e,i,n,r,a,o){var s=(e+i)%(n+r)/(n+r),l=(arguments.length>7&&void 0!==arguments[7]?arguments[7]:0)+(arguments.length>8&&void 0!==arguments[8]?arguments[8]:1)*(Math.sin(2*a*Math.PI-4*s*Math.PI)+1)/2;return Math.min(1,Math.max(0,l))},t.sortStackValueGroup=gH,t.specTransform=Nz,t.spiralEffect=function(t,e,i,n,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=n/2,c=r/2,h=Math.sqrt(Math.pow(e-u,2)+Math.pow(i-c,2)),d=Math.atan2(e-u,i-c),p=(h/Math.sqrt(Math.pow(n/2,2)+Math.pow(r/2,2))+d/(2*Math.PI))/2,f=s+l*(Math.sin(2*a*Math.PI-4*p*Math.PI)+1)/2;return Math.min(1,Math.max(0,f))},t.stack=xH,t.stackGroup=kH,t.stackMosaic=_H,t.stackMosaicTotal=mH,t.stackOffsetSilhouette=bH,t.stackTotal=yH,t.themeExist=Oz,t.themes=Pz,t.token=fz,t.transformColorSchemeToStandardStruct=uF,t.version="1.13.9",t.vglobal=ex,Object.defineProperty(t,"__esModule",{value:!0})}));
